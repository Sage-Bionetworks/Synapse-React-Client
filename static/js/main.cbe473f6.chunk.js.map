{"version":3,"sources":["lib/utils/functions/getEndpoint.ts","lib/assets/ButtonContent.tsx","lib/assets/GoogleIcon.tsx","lib/utils/SynapseConstants.ts","lib/utils/functions/dispatchDownloadListChangeEvent.ts","lib/utils/SynapseClient.ts","lib/containers/Login.tsx","lib/utils/functions/colorPalette.ts","lib/containers/ColorGradient.tsx","lib/utils/functions/facetUtils.ts","lib/containers/table/SynapseTableConstants.ts","lib/utils/functions/getUserData.ts","lib/containers/UserCardSmall.tsx","lib/containers/UserCardContextMenu.tsx","lib/assets/icons/CertifiedUser.tsx","lib/containers/UserCardLarge.tsx","lib/assets/icons/IconCopy.tsx","lib/assets/icons/ValidatedProfile.tsx","lib/containers/UserCardMedium.tsx","lib/containers/UserCard.tsx","lib/containers/widgets/Bookmarks.tsx","lib/containers/widgets/SynapseImage.tsx","lib/containers/row_renderers/utils/CardFooter.tsx","lib/containers/row_renderers/utils/ChipContainer.tsx","lib/assets/themed_icons/Project.tsx","lib/containers/row_renderers/utils/Icon.tsx","lib/assets/themed_icons/Database.tsx","lib/assets/themed_icons/Publication.tsx","lib/assets/themed_icons/Study.tsx","lib/assets/themed_icons/ToolExperimental.tsx","lib/assets/themed_icons/ToolComputational.tsx","lib/assets/themed_icons/ToolClinical.tsx","lib/assets/themed_icons/Explore.tsx","lib/assets/themed_icons/Search.tsx","lib/assets/themed_icons/Chart.tsx","lib/assets/themed_icons/Filter.tsx","lib/assets/themed_icons/Download.tsx","lib/assets/themed_icons/Expand.tsx","lib/assets/themed_icons/Collapse.tsx","lib/assets/themed_icons/Close.tsx","lib/assets/themed_icons/SortUp.tsx","lib/assets/themed_icons/SortDown.tsx","lib/assets/themed_icons/Settings.tsx","lib/assets/themed_icons/Columns.tsx","lib/assets/themed_icons/ColumnsDark.tsx","lib/assets/themed_icons/VerticalDots.tsx","lib/containers/HeaderCard.tsx","lib/containers/row_renderers/utils/ShowMore.tsx","lib/utils/functions/unCamelCase.ts","lib/containers/widgets/FileHandleLink.tsx","lib/containers/GenericCard.tsx","lib/utils/functions/sqlFunctions.ts","lib/containers/widgets/SynapsePlot.tsx","lib/containers/widgets/SynapseVideo.tsx","lib/containers/SignInButton.tsx","lib/containers/Error.tsx","lib/containers/MarkdownSynapse.tsx","lib/utils/functions/queryUtils.ts","lib/utils/functions/deepLinkingUtils.ts","lib/containers/QueryWrapper.tsx","lib/utils/functions/getDataFromFromStorage.ts","lib/containers/widgets/ElementWithTooltip.tsx","lib/containers/widgets/Checkbox.tsx","lib/utils/hooks/useGetInfoFromIds.ts","lib/containers/widgets/query-filter/FacetFilterHeader.tsx","lib/containers/widgets/query-filter/EnumFacetFilter.tsx","lib/containers/widgets/Range.tsx","lib/containers/widgets/RangeSlider.tsx","lib/containers/widgets/query-filter/RangeFacetFilter.tsx","lib/containers/widgets/RadioGroup.tsx","lib/containers/widgets/query-filter/QueryFilter.tsx","lib/containers/LoadingScreen.tsx","lib/containers/widgets/facet-nav/FacetNavPanel.tsx","lib/containers/widgets/facet-nav/FacetNav.tsx","lib/utils/functions/calculateFriendlyFileSize.ts","lib/containers/row_renderers/Dataset.tsx","lib/containers/row_renderers/Funder.tsx","lib/containers/UserCardList.tsx","lib/containers/CardContainer.tsx","lib/utils/functions/testDownloadSpeed.ts","lib/containers/download_list/DownloadDetails.tsx","lib/utils/hooks/usePrevious.ts","lib/utils/hooks/useCompare.ts","lib/containers/access_requirement_list/AccessApprovalCheckMark.tsx","lib/containers/access_requirement_list/AcceptedRequirements.tsx","lib/containers/access_requirement_list/SelfSignAccessRequirement.tsx","lib/containers/access_requirement_list/TermsOfUseAccessRequirement.tsx","lib/containers/access_requirement_list/ManagedACTAccessRequirement.tsx","lib/containers/access_requirement_list/ACTAccessRequirement.tsx","lib/containers/access_requirement_list/AccessRequirementList.tsx","lib/containers/HasAccess.tsx","lib/containers/download_list/CreatePackage.tsx","lib/containers/download_list/DownloadListTable.tsx","lib/containers/download_list/DownloadConfirmation.tsx","lib/containers/table/table-top/DownloadLoginModal.tsx","lib/containers/table/table-top/EllipsisDropdown.tsx","lib/containers/table/table-top/ExpandTable.tsx","lib/containers/table/table-top/ProgrammaticOptions.tsx","lib/containers/ModalDownload.FormSchema.ts","lib/containers/ModalDownload.tsx","lib/containers/table/table-top/DownloadOptions.tsx","lib/containers/table/table-top/ColumnSelection.tsx","lib/containers/EntityLink.tsx","lib/containers/synapse_table_functions/getUniqueEntities.ts","lib/containers/synapse_table_functions/getColumnIndiciesWithType.ts","lib/containers/table/SynapseTable.tsx","lib/utils/synapseTypes/Table/QueryFilter.ts","lib/containers/synapse_table_functions/renderTableCell.tsx","lib/containers/query_wrapper_plot_nav/FilterAndView.tsx","lib/containers/QueryCount.tsx","lib/containers/query_wrapper_plot_nav/TopLevelControls.tsx","lib/containers/SearchV2.tsx","lib/containers/query_wrapper_plot_nav/QueryWrapperPlotNav.tsx","lib/containers/StackedBarChart.tsx","lib/containers/EntityForm.tsx","lib/containers/ExternalFileHandleLink.tsx","lib/containers/synapse_form_wrapper/types.ts","lib/containers/synapse_form_wrapper/Header.tsx","lib/containers/synapse_form_wrapper/StepsSideNav.tsx","lib/containers/synapse_form_wrapper/NavButtons.tsx","lib/containers/synapse_form_wrapper/DataDebug.tsx","lib/containers/synapse_form_wrapper/SummaryTable.tsx","lib/containers/synapse_form_wrapper/WarningModal.tsx","lib/containers/synapse_form_wrapper/SynapseForm.tsx","lib/containers/synapse_form_wrapper/SynapseFormWrapper.tsx","lib/containers/synapse_form_wrapper/SynapseFormSubmissionsGrid.tsx","lib/containers/CardContainerLogic.tsx","lib/containers/download_list/ShowDownload.tsx","lib/utils/hooks/useGetQueryResultBundle.ts","lib/utils/hooks/useShowDesktop.ts","lib/containers/home_page/ExpandableContent.tsx","lib/containers/home_page/goals/Goals.Mobile.tsx","lib/containers/home_page/goals/Goals.tsx","lib/containers/home_page/goals/Goals.Desktop.tsx","lib/containers/home_page/programs/Programs.Mobile.tsx","lib/containers/home_page/programs/Programs.Desktop.tsx","lib/containers/home_page/programs/Programs.tsx","lib/containers/home_page/resources/Resources.tsx","lib/containers/home_page/resources/Resources.Desktop.tsx","lib/containers/home_page/resources/Resources.Mobile.tsx","lib/containers/RssFeed.tsx","lib/containers/TwitterFeed.tsx","lib/containers/NewsFeedMenu.tsx","lib/containers/RssFeedCards.tsx","lib/containers/widgets/themes-plot/DotPlot.tsx","lib/containers/widgets/themes-plot/BarPlot.tsx","lib/containers/widgets/themes-plot/ThemesPlot.tsx","lib/containers/UpsetPlot.tsx","lib/containers/UserCardListRotate.tsx","lib/containers/home_page/featured-data/FacetPlotsCard.tsx","lib/containers/home_page/featured-data/QueryWrapperFacetPlotsCard.tsx","lib/containers/home_page/featured-data/FeaturedDataPlots.tsx","lib/containers/home_page/featured-data/FeaturedDataTabs.tsx","lib/containers/widgets/facet-nav/SelectionCriteriaPill.tsx","lib/containers/TotalQueryResults.tsx","lib/containers/Facets.tsx","lib/containers/Search.tsx","lib/containers/QueryWrapperMenu.tsx","lib/containers/Uploader.tsx","lib/containers/FileContentDownloadUploadDemo.tsx","lib/containers/StatisticsPlot.tsx","demo/containers/Demo.tsx","demo/containers/playground/QueryWrapperMenuDemo.tsx","demo/containers/playground/CardContainerLogicDemo.tsx","demo/containers/playground/SearchDemo.tsx","demo/containers/playground/ModalDownloadDemo.tsx","demo/containers/playground/UserCardDemo.tsx","demo/containers/playground/MarkdownSynapseDemo.tsx","demo/containers/playground/ShowDownloadDemo.tsx","demo/containers/playground/NewsFeedDemo.tsx","lib/containers/SingleNewsFeedPost.tsx","demo/containers/playground/SingleNewsFeedPostDemo.tsx","demo/containers/playground/FormServicesIntegrationDemo.tsx","demo/containers/playground/QueryWrapperPlotNavDemo.tsx","demo/containers/playground/WidgetDemo.tsx","demo/containers/playground/AccessRequirementDemo.tsx","lib/containers/TemplateComponent.tsx","demo/containers/playground/TemplateComponentDemo.tsx","demo/containers/playground/ThemesPlotDemo.tsx","demo/containers/playground/GoalsDemo.tsx","demo/containers/playground/ProgramsDemo.tsx","demo/containers/playground/UpsetPlotDemo.tsx","demo/containers/playground/SynapsePlotDemo.tsx","demo/containers/playground/PeopleProfileDemo.tsx","demo/containers/playground/FeaturedDataTabsDemo.tsx","demo/containers/playground/Playground.tsx","demo/containers/App.tsx","index.tsx","lib/utils/synapseTypes/index.ts","lib/utils/synapseTypes/EvaluationQueryTable/index.ts","images/logo.svg","lib/assets/icons/Data2.svg","lib/assets/icons/subscribe_plus.svg","lib/utils/synapseTypes/Download/index.ts","lib/utils/synapseTypes/Table/index.ts","lib/utils/synapseTypes/Table/ColumnType.ts","lib/utils/synapseTypes/Table/SelectColumn.ts","lib/utils/synapseTypes/AccessRequirement/index.ts","lib/utils/synapseTypes/AccessRequirement/AccessRequirement.ts","lib/utils/synapseTypes/BulkFileDownloadRequest.ts","lib/utils/synapseTypes/FileDownloadSummary.ts","lib/utils/synapseTypes/FileEntity.ts","lib/utils/synapseTypes/FileHandleAssociation.ts","lib/utils/synapseTypes/ExternalFileHandleInterface.ts","lib/utils/synapseTypes/Forms.ts","lib/utils/synapseTypes/RestrictionInformation.ts","lib/utils/synapseTypes/AccessApproval.ts","lib/utils/synapseTypes/WikiPageKey.ts","lib/assets/icons/study-active.svg","lib/assets/icons/study-complete.svg","lib/assets/icons/DNA_Two.svg","lib/assets/icons/organizations.svg","lib/assets/icons/person.svg","lib/assets/icons/mouse.svg","lib/assets/icons/icon_plus.svg","lib/assets/icons/icon_minus.svg","lib/assets/icons/file-dotted.svg","lib/assets/icons/json-form-tool-no-submissions.svg","demo/containers/playground/icons/brain.svg","demo/containers/playground/icons/circle.svg","demo/containers/playground/icons/mouse.svg","demo/containers/playground/icons/resiliencead.svg"],"names":["BackendDestinationEnum","children","style","paddingRight","fontWeight","paddingLeft","icon","paddingTop","paddingBottom","textAlign","width","active","background","borderRadius","height","xmlns","fill","fillRule","d","BUNDLE_MASK_QUERY_RESULTS","BUNDLE_MASK_QUERY_COUNT","BUNDLE_MASK_QUERY_SELECT_COLUMNS","BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE","BUNDLE_MASK_QUERY_COLUMN_MODELS","BUNDLE_MASK_QUERY_FACETS","BUNDLE_MASK_SUM_FILES_SIZE_BYTES","ENTITY_BUNDLE_MASK_ENTITY","ENTITY_BUNDLE_MASK_ANNOTATIONS","ENTITY_BUNDLE_MASK_PERMISSIONS","ENTITY_BUNDLE_MASK_ENTITY_PATH","ENTITY_BUNDLE_MASK_HAS_CHILDREN","ENTITY_BUNDLE_MASK_ACL","ENTITY_BUNDLE_MASK_FILE_HANDLES","ENTITY_BUNDLE_MASK_TABLE_DATA","ENTITY_BUNDLE_MASK_ROOT_WIKI_ID","ENTITY_BUNDLE_MASK_BENEFACTOR_ACL","ENTITY_BUNDLE_MASK_DOI","ENTITY_BUNDLE_MASK_FILE_NAME","ENTITY_BUNDLE_MASK_THREAD_COUNT","ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION","STUDY","VALUE_NOT_SET","STUDY_ACTIVE","STUDY_COMPLETE","DATABASE","DATASET","AMP_CONSORTIUM","FUNDER","PUBLICATION","TOOL","GENERIC_CARD","COMPUTATIONAL","EXPERIMENTAL","CLINICAL","PROJECT","GRANT","ORGANIZATION","PERSON","MOUSE","EXPLORE","SEARCH","CHART","FILTER","DOWNLOAD","EXPAND","COLLAPSE","CLOSE","SORTUP","SORTDOWN","SETTINGS","COLUMNS","COLUMNSDARK","VERTICAL_DOTS","PAGE_SIZE","SMALL_USER_CARD","MEDIUM_USER_CARD","LARGE_USER_CARD","SEPERATOR","AUTHENTICATED_USERS","_TIME_DELAY","SRC_SIGN_IN_CLASS","USER_BUNDLE_MASK_USER_PROFILE","USER_BUNDLE_MASK_ORCID","USER_BUNDLE_MASK_VERIFICATION_SUBMISSION","USER_BUNDLE_MASK_IS_CERTIFIED","USER_BUNDLE_MASK_IS_VERIFIED","USER_BUNDLE_MASK_IS_ACT_MEMBER","USER_PROFILE_STORAGE_KEY","ENTITY_HEADER_STORAGE_KEY","PRODUCTION_ENDPOINT_CONFIG","REPO","PORTAL","getEndpoint","endpoint","endpoint_config","window","SRC","OVERRIDE_ENDPOINT_CONFIG","Error","PORTAL_ENDPOINT","dispatchDownloadListChangeEvent","downloadList","downloadEvent","CustomEvent","detail","document","dispatchEvent","cookies","UniversalCookies","IS_OUTSIDE_SYNAPSE_ORG","location","hostname","toLowerCase","includes","SESSION_TOKEN_COOKIE_KEY","AUTH_PROVIDER","SYNAPSE_STORAGE_LOCATION_ID","getRootURL","portString","port","protocol","delay","t","Promise","resolve","setTimeout","bind","RETRY_STATUS_CODES","fetchWithExponentialTimeout","url","options","delayMs","fetch","then","resp","text","json","JSON","parse","ok","reject","error","catch","reason","status","indexOf","doPost","requestJsonObject","sessionToken","initCredentials","body","stringify","headers","Accept","method","mode","credentials","usedEndpoint","doGet","doDelete","undefined","doPut","putRefreshSessionToken","REPO_ENDPOINT","getVersion","addFilesToDownloadList","request","updateParentState","requestUrl","token","getAsyncResultFromJobId","data","getDownloadFromTableRequest","entityId","getFileHandleById","handleId","getActualFileHandleByIdURL","fileAssociateType","fileAssociateId","redirect","open","err","console","getFileHandleByIdURL","urlRequest","jobState","asyncJobStatus","getQueryTableResults","queryBundleRequest","getFullQueryTableResults","a","initMaxPageSize","offset","query","rest","queryRequest","limit","partMask","SynapseConstants","response","isDone","queryResult","queryResults","rows","length","maxRowsPerPage","push","login","username","password","authenticationReceipt","oAuthUrlRequest","provider","redirectUrl","oAuthSessionRequest","authenticationCode","createEntity","entity","createProject","name","concreteType","getUserProfile","getUserProfileById","ownerId","getUserBundle","id","mask","getGroupHeadersBatch","ids","join","getUserProfiles","list","getEntityChildren","lookupChildEntity","getFiles","getBulkFiles","bulkFileDownloadRequest","asyncJobId","getEntity","versionNumber","getEntityHeader","references","updateEntity","deleteEntity","getEntityBundleForVersion","version","partsMask","getObjectTypeToString","key","ObjectType","getEntityWiki","wikiId","objectType","ENTITY","objectTypeString","toLocaleLowerCase","getUserFavorites","getUserTeamList","getTeamList","fragment","getWikiPageKey","getWikiAttachmentsFromEntity","getWikiAttachmentsFromEvaluation","setSessionTokenCookie","sessionCallback","remove","path","set","maxAge","_","getSessionTokenFromCookie","get","getPrincipalAliasRequest","alias","type","detectSSOCode","redirectURL","code","URL","href","searchParams","synToken","originalUrl","localStorage","getItem","removeItem","replace","signOut","uploadFile","filename","file","fileUploadResolve","fileUploadReject","partSize","Math","max","size","contentType","fileName","fileSizeBytes","partSizeBytes","storageLocationId","calculateMd5","md5","contentMD5Hex","startMultipartUpload","fileBlob","blobSlice","File","prototype","slice","chunks","ceil","spark","SparkMD5","ArrayBuffer","fileReader","FileReader","currentChunk","onload","e","log","append","result","loadNext","end","info","onerror","warn","start","readAsArrayBuffer","call","processFilePart","partNumber","multipartUploadStatus","clientSidePartsState","uploadId","presignedUploadUrlRequest","partNumbers","presignedUrlUrl","presignedUrlResponse","presignedUrl","partPresignedUrls","uploadPresignedUrl","startByte","endByte","fileSlice","uploadFilePart","addPartUrl","addPartResponse","addPartState","checkUploadComplete","fileHandleName","every","v","newStatus","fileHandleId","resultFileHandleId","partsState","split","map","bit","i","getFileEntityContent","fileEntity","fileHandleAssociationList","associateObjectId","associateObjectType","dataFileHandleId","includeFileHandles","includePreSignedURLs","includePreviewPreSignedURLs","requestedFiles","preSignedURL","fileHandle","getFileHandleContent","content","getFileEntityFileHandle","FileHandleAssociateType","FileEntity","failureCode","getFileHandleContentFromID","getFileHandleByIdPromise","getFileHandlePresignedUrlPromis","all","values","contentSize","cache","createACL","acl","submitToEvaluation","submission","etag","getEvaluation","evalId","getEvaluationSubmissions","encodeURI","getOAuth2RequestDescription","oidcAuthRequest","hasUserAuthorizedOAuthClient","getOAuth2Client","clientId","consentToOAuth2Request","createFormGroup","getFormACL","formGroupId","updateFormACL","newAcl","createFormData","newFormData","updateFormData","formDataId","updatedFormData","deleteFormData","submitFormData","listFormData","listFormDataAsFormAdmin","acceptFormData","rejectFormData","formRejection","getProjectStatistics","getRestrictionInformation","getAccessRequirement","getAccessRequirementStatus","requirementId","getAllAccessRequirements","getAllOfPaginatedService","getAccessApproval","approvalId","postAccessApproval","accessApproval","getDownloadList","getDownloadOrder","zipFileName","baseURL","fn","existsMoreData","results","deleteDownloadListFiles","deleteDownloadList","updateTable","tableUpdateRequest","getTransformSqlWithFacetsRequest","transformSqlWithFacetsRequest","Login","props","authenticationReceiptKey","state","email","errorMessage","hasLoginInFailed","isSignedIn","handleChange","handleLogin","getLoginFailureView","onGoogleSignIn","event","target","currentTarget","value","newState","this","setState","clickEvent","preventDefault","SynapseClient","setItem","className","googleRedirectUrl","authUrl","authorizationUrl","theme","googleTheme","onClick","GoogleIcon","ButtonContent","marginRight","alt","src","onSubmit","autoComplete","placeholder","onChange","React","COLOR_PALETTE_EVEN","COLOR_PALETTE_ODD","getColorPallette","colorPalleteSelection","textColors","colorPalette","textColor","color","getIsValueSelected","isLoading","lastFacetSelection","curFacetSelection","columnName","facetValue","isSelected","selector","SELECT_SINGLE_FACET","ICON_STATE","getUserProfileWithProfilePicAttached","principalIds","withProfilePic","filter","profilePicureFileHandleId","fileHandleList","forEach","matchingPersonIndex","findIndex","el","clientPreSignedURL","getUserProfileWithProfilePic","userProfile","UserProfileAttachment","firstElement","COLORS","getColor","userName","hashedUserName","val","reduce","prevHash","currVal","charCodeAt","abs","hash","library","add","faCircle","UserCardSmall","img","marginLeft","hideText","hideTooltip","link","extraSmall","linkLocation","label","displayName","firstName","lastName","position","imgClassName","backgroundImage","data-for","data-tip","delayShow","multiline","whiteSpace","UserCardContextMenu","menuActions","aria-labelledby","menuAction","index","callback","field","listStyle","onKeyPress","svg","viewBox","UserCardLarge","isCertified","summary","industry","CertifiedUserIcon","faEllipsisV","faCopy","UserCardMedium","htmlDivRef","copyToClipboard","createElement","setAttribute","left","current","appendChild","select","execCommand","removeChild","showModal","toggleContextMenu","_event","isContextMenuOpen","pageClick","addEventListener","removeEventListener","isLarge","hideEmail","disableLink","isValidated","company","validatedUserProfileTooltipId","mediumCard","classNames","timeout","enter","exit","tabIndex","place","effect","ValidatedProfileIcon","ref","IconCopy","outline","fixedWidth","padding","border","backgroundColor","UserCard","aliasData","principalId","userProfileAtRender","preSignedURLAtRender","propsForChild","Bookmarks","renderBookmarks","matchedGroup","copyFootnotes","String","footnotes","regex","output","exec","isBeforeLastElement","dangerouslySetInnerHTML","__html","SynapseImage","getSynapseFiles","synapseId","fileResults","WikiAttachment","params","align","altText","scale","Number","alignLowerCase","faLongArrowAltUp","faLongArrowAltDown","CardFooter","renderRowValue","match","DOI_REGEX","data-search-handle","rel","renderRows","isDesktop","kv","hideClass","isShowMoreOn","toggleShowMore","updatePredicate","innerWidth","secondaryLabelLimit","valuesFiltered","hasMoreValuesThanLimit","Infinity","isHeader","margin","ChipContainer","chipsFormatted","chips","Project","clipPath","defaultIcons","Data2Svg","DNA_TwoSvg","studyActiveSvg","studyCompleteSvg","clipRule","transform","organizationsSvg","personSvg","mouseSvg","mask-type","maskUnits","x","y","stroke","Icon","iconOptions","cssClass","iconSet","datasetIconClass","HeaderCard","title","subTitle","description","iconValue","isAlignToLeftNav","descriptionLinkConfig","rgbIndex","descriptionElement","querySelector","useState","docTitle","getAttribute","docDescription","useEffect","markdown","borderTop","marginTop","unCamelCase","str","facetAliases","toUpperCase","FileHandleLink","showDownloadIcon","tableEntityConcreteType","rowId","tableId","displayValue","isFileView","TableEntity","SYNAPSE_REGX","renderValueOrMultiValue","selectColumns","columnModels","strList","selectedColumnOrUndefined","find","columnType","renderLabel","args","labelLink","isMarkdown","renderInline","URLColumnName","wrapValueWithParens","GenericCard","getCutoff","previewText","summarySplit","trim","hasClickedShowMore","renderTitle","titleSearchHandle","getTitleParams","renderLongDescription","renderShortDescription","titleLink","schema","matchColumnName","indexInData","genericCardSchema","titleLinkConfig","labelLinkConfig","genericCardSchemaDefined","titleColumnModel","titleColumnType","linkValue","secondaryLabels","keyValue","showFooter","marginBottom","stubTitleSearchHandle","descriptionSubTitle","ColumnType","FILEHANDLEID","show","fontSize","cursor","GROUP_BY_REGEX","isGroupByInSql","sql","test","generateTokenUsingOperator","literal","operator","usedMatchForLike","substring","matchForHas","getWhereInsertIndex","tokens","existingWhereIndex","targetIndex","insertConditionsFromSearchParams","isQueryWrapperKey","startsWith","searchParamKeys","Object","keys","lexer","tokenize","foundIndex","whereClauseIndex","indexAfterWhereClause","splice","searchParamsLen","unshift","formatSQLFromParser","dotIndex","synId","synIdWithVersion","newSql","parser","toString","synIdWithBackticks","parseEntityIdFromSqlStatement","matches","substr","resultToJson","headerColumns","rowColumns","row","column","cellIndex","Plot","createPlotlyComponent","Plotly","SynapsePlot","isLoaded","queryData","fetchPlotlyData","showPlot","widgetparamsMapped","xtitle","ytitle","xaxistype","showlegend","isHorizontal","horizontal","layout","xaxis","yaxis","plotData","orientation","j","rowValues","SynapseVideo","video","setVideo","videoUrl","setVideoUrl","videoWidth","videoHeight","videoId","vimeoId","videoKey","oggSynapseId","mp4SynapseId","webmSynapseId","getVideo","RenderVideo","controls","SignInButton","ClientError","loginError","accessDenied","synapseClientError","jsError","stringError","isSynapseClientError","message","isError","isString","Alert","dismissible","variant","transition","TOC_CLASS","1","2","3","4","5","6","md","markdownit","html","MarkdownSynapse","markupRef","markdownitSynapse","init_markdown_it","markdownitSub","markdownitSup","markdownitCentertext","markdownitSynapseHeading","markdownitSynapseTable","markdownitStrikethroughAlt","markdownitContainer","markdownitEmphasisAlt","markdownitInlineComments","markdownitBr","use","markdownitMath","fileHandles","handleLinkClicks","renderMarkdown","recursiveRender","processMath","getWikiAttachments","getWikiPageMarkdown","renderWidget","renderSynapseButton","renderSynapseImage","renderVideo","renderSynapsePlot","renderSynapseTOC","createHTML","addBookmarks","addIdsToReferenceWidgets","addIdsToTocWidgets","genericElement","tagName","anchor","referenceNumber","goTo","scrollIntoView","behavior","block","inline","idOfContent","initText","render","sanitizeHtml","allowedAttributes","button","div","h1","h2","h3","h4","h5","h6","li","ol","span","table","th","thead","ul","allowedTags","querySelectorAll","element","textContent","katex","throwOnError","resetFootnotes","footnotesHtml","wikiPage","referenceCount","tocIdCount","curTocId","markup","DOMParser","parseFromString","nodeType","Node","TEXT_NODE","ELEMENT_NODE","HTMLElement","widgetParams","processHTMLWidgetMapping","attributes","attribute","item","childNodes","Array","from","xml","escapedOneToXmlSpecialMap","originalMarkup","decodedWidgetParams","decodeXml","questionIndex","widgetType","keyPair","decodeURIComponent","reactKey","renderUserBadge","buttonClasses","highlight","role","elements","p1","p2","p3","p4","data-anchor","prevProps","bookmarks","getNextPageOfData","newData","oldData","cloneDeep","hasMoreData","getComponentSearchHashId","componentName","componentIndex","updateUrlWithNewSearchParam","stringifiedQuery","searchString","componentSearchHashId","search","searchFragment","patchSearchString","newURL","pathname","history","pushState","getQueryRequestFromLink","searchParamValue","getSearchParamValue","getSearchParamValueFromUrl","initQueryRequest","QueryWrapper","executeInitialQueryRequest","executeQueryRequest","getLastQueryRequest","getInitQueryRequest","isLoadingNewData","chartSelectionIndex","isAllFilterSelectedForFacet","loadNowStarted","lastQueryRequest","topLevelControlsState","showColumnFilter","showFacetFilter","showFacetVisualization","showSearchBar","showDownloadConfirmation","showColumnSelectDropdown","isColumnSelected","selectedRowIndices","loadNow","DeepLinkingUtils","clonedQueryRequest","encodeURIComponent","shouldDeepLink","finally","facet","facets","facetType","facetValues","isAllFalse","isAllTrue","isByDefaultSelected","sort","b","count","visibleColumnCount","update","lockedFacet","childrenWithProps","child","queryWrapperChildProps","removeLockedFacetData","loadingCusrorClass","getStoredEntityHeaders","sessionStorage","getStoredUserProfiles","ElementWithTooltip","tooltipTrigger","image","idForToolTip","callbackFn","tooltipText","imageColor","tooltipVisualProps","darkTheme","iconComponent","tooltipTriggerContents","svgImg","getTooltipTriggerContents","outerChild","cloneElement","aria-label","Dropdown","Toggle","Checkbox","checked","propsChecked","isSelectAll","setChecked","UserProfileTemplate","entityHeaderTemplate","versionLabel","benefactorId","createdOn","modifiedOn","createdBy","modifiedBy","getEntityHeaderItems","lookupList","notFound","targetId","notFoundPlaceholders","getUserProfileItems","useGetInfoFromIds","setData","idProp","storageKey","curList","incomingList","newValues","uniq","without","saveToSessionStorage","dataInStorage","dataInStorageAsObjectArr","dataObject","useDeepCompareEffect","newIds","newReferences","newReferencesChunks","chunk","totalData","concat","getData","FacetFilterHeader","isCollapsed","iconPlus","iconMinus","valueToLabel","profiles","entityHeaders","profile","eh","faArrowLeft","EnumFacetFilter","columnModel","onClear","containerAs","isShowAll","setIsShowAll","setIsCollapsed","isShowDropdown","setIsShowDropdown","showSearch","setShowSearch","searchTerm","setSearchText","filteredSet","setFilteredSet","timer","textInput","selectedValuesMap","userProfiles","isDropdown","focus","inputValue","filtered","obj","handleTextInputFilterEvent","visibleItemsCount","formatFacetValuesForDisplay","isChecked","clearTimeout","onToggle","_show","metadata","source","Menu","display","Range","setError","initialValues","min","moment","format","setValues","isValid","Date","flexWrap","callBackFn","handleAppyChanges","errorText","Handle","domain","handle","percent","getHandleProps","aria-valuemin","aria-valuemax","aria-valuenow","Track","getTrackProps","Tick","tick","getInitialValues","RadioValuesEnum","RangeSlider","doUpdateOnApply","stringArrToNumArr","inputArr","numDomain","ticksCount","maxTickCount","step","handleSliderChange","getRailProps","handles","right","tracks","ticks","RadioGroup","option","RangeFacetFilter","facetResult","NOT_SET","ANY","RANGE","columnMin","columnMax","selectedMin","selectedMax","hasAnyValue","rangeType","radioValue","setRadioValue","onChangeCallback","handleRadioGroupChange","convertFacetToFacetColumnValuesRequest","patchRequestFacets","changedFacet","lastRequest","selections","selectedFacets","changedFacetIndex","isEmptyValuesFacet","applyChangesToValuesColumn","onChangeFn","facetName","applyMultipleChangesToValuesColumn","facetNameMap","facetNames","applyChangesToRangeColumn","convertFacetColumnRangeRequest","QueryFilter","applyChanges","model","facetNamesMap","loadingScreen","loading","annotations","l","r","pad","visible","showgrid","formatPercent","ratio","n","round","pow","toFixed","truncate","trimmedStr","extractPlotDataArray","facetToPlot","plotType","getLabels","truncateFlag","getLabel","labels","singleChartData","facetEnumerationValues","hovertemplate","textinfo","marker","colors","line","pull","getPlotStyle","parentWidth","maxHeight","renderLegend","isExpanded","numLegendItems","totalCount","curValue","curFacet","labelDisplay","getClassNameForPlotDiv","FacetNavPanel","onHide","onExpand","onCollapse","applyChangesToFacetFilter","applyChangesToGraphSlice","setPlotData","setIsExpanded","setPlotType","getColumnType","changePlotType","Item","as","monitorHeight","config","displayModeBar","evt","allFacetValues","callbackApplyFn","points","plotPointData","facetValueClickedValue","pointNumber","facetValueClicked","applyFacetFilter","getFacets","facetsToPlot","FacetNav","showNotch","facetUiStateArray","setFacetUiStateArray","isFirstTime","setIsFirstTime","isHidden","applyChangesFromQueryFilter","toggleExpandFacet","doExpand","setUiPropertyForFacet","propName","hasSelectedFacets","expandedFacets","uiState","restOfFacets","colorTracker","colorIndex","showMoreState","progressMessage","hideExpandedFacet","hideFacetInGrid","shouldShowMore","unitDescription","frontText","sufixes","calculateFriendlyFileSize","bytes","floor","Dataset","handleLinkClick","datasetName","tumorType","diseaseFocus","fundingAgency","fileCount","fileSize","Funder","organizationName","organizationPath","website","logoHref","logo","websiteDisplayName","charAt","showOrgLink","isOnOrgPath","UserCardList","userProfileMap","priorListOfIds","newEntries","firstNameIndex","lastNameIndex","institutionIndex","fauxUserProfilesList","manuallyExtractData","fauxUserProfileIndex","fauxUserProfile","CardContainer","showBarChart","cards","showViewMore","showViewMoreButton","userIdColumnIndex","listIds","rowData","renderCard","testDownloadSpeed","cachedSpeedExpireTime","cachedSpeed","getTime","startMs","now","DownloadDetails","downloadSpeed","numFiles","numBytes","speed","timeEstimateInSeconds","friendlyTime","duration","humanize","isInactive","iconClassName","faFile","faDatabase","faClock","usePrevious","useRef","useCompare","AccessApprovalCheckMark","isCompleted","faCheck","faLock","AcceptedRequirements","user","accessRequirement","accessRequirementStatus","showButton","isHide","setIsHide","propsIsApproved","isApproved","setIsApproved","acceptButtonText","SUPPORTED_ACCESS_REQUIREMENTS","ManagedACTAccessRequirement","ACTAccessRequirement","gotoSynapseAccessRequirementPage","termsOfUse","actContactInfo","isTermsOfUse","TermsOfUseAccessRequirement","isActContactInfo","isActOrTermsOfUse","wikiPageId","ownerObjectId","ownerObjectType","isManagedActAr","accessApprovalRequest","submitterId","accessorId","ApprovalState","APPROVED","SelfSignAccessRequirementComponent","setWikiPage","userBundle","setUserBundle","setIsLoading","wikiPageRequirment","certificationOrVerification","bundle","getSelfSignAccessData","isCertifiedUserRequired","isValidatedProfileRequired","isVerified","TermsOfUseAccessRequirementComponent","wikiPageRequirement","getTermsOfUseData","ManagedACTAccessRequirementComponent","wikipageRequirement","getManagedACTAccessData","ACTAccessRequirementComponent","getACTAccessData","GoogleCloudFileHandleEnum","isARUnsupported","SelfSignAccessRequirement","AccessRequirementList","accessRequirementFromProps","renderAsModal","accessRequirements","setAccessRequirements","setUser","entityHeaderProps","shouldUpdateData","entityInformation","sortAccessRequirementByCompletion","requirements","statuses","req","accessRequirementStatuses","requirementsAndStatuses","accessRequirementId","sortedRequirementsAndStatuses","sortBy","reqAndStatus","sortedAccessRequirements","getAccessRequirements","Boolean","Header","closeButton","Title","Body","Fragment","renderAccessRequirement","animation","centered","scrollable","faUnlockAlt","FileHandleDownloadTypeEnum","GIGABYTE_SIZE","getDownloadTypeForFileHandle","isInDownloadList","Accessible","TooLarge","GoogleCloudFileHandle","ExternalCloudFile","implementsExternalFileHandleInterface","ExternalFileLink","HasAccess","refresh","forceRefresh","isGettingEntityInformation","isGettingRestrictionInformation","errorOnGetRestrictionInformation","updateStateFileHandleAccessBlocked","fileHandleDownloadType","AccessBlockedByACL","AccessBlockedToAnonymous","entityVersionNumber","hasOwnProperty","NoFileHandle","restrictionInformation","restrictableObjectType","RestrictableObjectType","objectId","renderIconHelper","iconProp","classColor","renderIcon","downloadType","hasUnmetAccessRequirement","faLink","handleGetAccess","set_arPropsFromHasAccess","displayAccessRequirement","renderARsLink","restrictionLevel","linkText","RestrictionLevel","OPEN","AccessBlockedByRestriction","viewARsLink","iconContainer","ev","isTrusted","MouseEvent","bubbles","faDownload","faFolder","CreatePackage","setZipFileName","alert","setAlert","bulkFileDownloadResponse","setBulkFileDownloadResponse","updateDownloadList","createPackageHandler","fileNameWithZipExtension","downloadOrder","files","zipFileFormat","ZipFileFormat","Flat","downloadPackageHandler","resultZipFileHandleId","fileSummary","numfilesDownloaded","FileDownloadStatus","SUCCESS","faTrash","StatusEnum","DownloadListTable","batchFileResult","isDescending","sortedColumn","setSortedColumn","arPropsFromHasAccess","fileBeingDeleted","setFileBeingDeleted","forceSamePage","listUpdatedCallback","ownerIdsFromHeaders","ownerIdsFromFileHandles","ownerIds","fetchData","useCallback","filesToDownload","batchFileRequest","referenceCall","batchFile","clearDownloadList","deleteFileFromList","sortColumn","itemA","itemB","sortDownLoadList","getFileHandleInfo","fileResult","fileRes","requestedFile","fileName_A","createdBy_A","createdOn_A","contentSize_A","fileName_B","createdBy_B","createdOn_B","contentSize_B","direction","localeCompare","striped","responsive","faSortAmountDown","faSortAmountUp","isCurrentlyBeingDeletedClass","canDownload","onHideModal","dialogClassName","top","zIndex","addToDownload","ERROR","StatusConstruct","INFO","infoText","closeText","PROCESSING","LOADING_INFO","SIGNED_OUT","DownloadConfirmation","fnClose","onExportTable","showDownloadList","setShowDownloadList","getFilesInformation","queryBundleRequestSizeInformation","queryCount","sumFileSizes","estimatedDownloadBytesPerSecond","durationSeconds","downloadEstimate","onCancel","triggerAddToDownload","getContent","DownloadLoginModal","Modal","ModalHeader","ModalBody","ModalFooter","Button","EllipsisDropdown","onDownloadFiles","onDownloadTableOnly","onShowColumns","onFullScreen","setShowModal","alignRight","isGroupedQuery","isUnauthenticated","Divider","ExpandTable","faQuestionCircle","ProgrammaticOptions","queryResultBundle","generatedSql","setGeneratedSql","sqlToTransform","res","transformedSql","csvOption","formSchemaArray","properties","oneOf","const","Contents","items","enum","uniqueItems","formSchemaUIArray","faTimes","ModalDownload","handleSubmit","handleDownloadSetup","onDownload","formData","fileType","contents","separator","writeHeader","includeRowIdAndRowVersion","downloadFromTableRequest","csvTableDescriptor","resultsFileHandleId","onClose","uiSchema","backgroundSize","DownloadOptions","showLoginModal","setShowLoginModal","showExportMetadata","setShowExportMetadata","showProgrammaticOptions","setShowProgrammaticOptions","ColumnSelection","toggleColumnSelection","showFromProps","setShow","usedShow","usedSetShow","onDropdownClick","drop","header","isCurrentColumnSelected","iconStyle","visibility","maybeShowPrimaryColor","faListAlt","faTable","faThList","faArchive","EntityTypeIcon","splitType","iconType","getIconTypeForEntity","EntityLink","entityHeader","getUniqueEntities","mapIdToHeader","indicies","distinctEntities","Set","colIndex","getColumnIndiciesWithType","columnTypes","columnsOfTypeEntity","EMPTY_HEADER","faColumns","faSort","faFilter","faUsers","faGlobeAmericas","ColumnSingleValueFilterOperator","SORT_STATE","RESIZER_OPTIONS","resizeMode","partialRefresh","liveDrag","headerOnly","SynapseTable","resizer","tableElement","showGroupRowData","selectedRow","queryCopy","parsed","getSqlUnderlyingDataForRow","queryJSON","encodedQuery","btoa","renderDropdownDownloadOptions","showDownload","hideDownload","renderColumnSelection","isColumnSelectionOpen","renderTable","pastZero","showAccessColumn","isRowSelectionVisible","zeroMarginRight","nextBtn","handlePaginationClick","previousBtn","isShowingAccessColumn","minHeight","isDownloadConfirmationOpen","isFilterAndViewChild","node","createTableHeader","createTableRows","renderTableTop","advancedSearch","isExportTableDownloadOpen","eventType","currentOffset","handleColumnSortPress","dict","columnIconSortState","getLengthOfPropsData","sortedColumnSelection","findSelectionIndex","isUserModifiedQuery","componentDidMount","componentWillUnmount","componentDidUpdate","shouldComponentUpdate","configureFacetDropdown","enableResize","disableResize","mapEntityIdToHeader","mapUserIdToHeader","isFetchingEntityHeaders","isFetchingEntityVersion","getEntityHeadersInData","nextProps","nextState","nextContext","getTableConcreteType","currentTableId","previousTableId","entityData","reset","ColumnResizer","disable","entityIdColumnIndicies","EntityColumnType","ENTITYID","userIdColumnIndicies","USERID","distinctEntityIds","distinctUserIds","referenceList","userPorfileIds","isIndividual","enableLeftFacetFilter","NoData","fontStyle","newFacets","originalSql","indexes","selectIndex","fromIndex","columnIndex","columnReferences","foundFunctionForColumn","rowValue","pop","rowsFormatted","columnLinks","entityColumnIndicies","userColumnIndicies","dateColumnIndicies","DATE","dateListColumnIndicies","DATE_LIST","booleanListColumnIndicies","BOOLEAN_LIST","otherListColumnIndicies","STRING_LIST","INTEGER_LIST","countColumnIndexes","getCountFunctionColumnIndexes","rowIndex","rowContent","columnValue","isColumnActive","columnLinkConfig","isCountColumn","isBold","jsonData","toLocaleString","s","maxCharCount","isShortString","noop","renderTableCell","rowSynapseId","cloneSelectedRowIndices","rowFormatted","tableColumnHeaderElements","facetIndex","facetColumnResult","isFacetSelection","isSelectedIconClass","sortSpanBackgoundClass","displayColumnName","isSortableColumn","synTable","FilterAndView","tableConfiguration","cardConfiguration","QueryCount","parens","storedSqlQueryCount","setStoredSqlQueryCount","isCalculatingQueryCountForSql","setIsCalculatingQueryCountForSql","mounted","newIsCalculatingQueryCountForSql","newStoredSqlQueryCount","calculateRowCount","localCount","TopLevelControls","showColumnSelection","customControls","setIsFileView","getIsFileView","customControl","buttonText","control","updatedTopLevelControlsState","setControlState","isColumnSelectedCopy","faCaretDown","faCaretUp","faSearch","Search","searchFormRef","radioFormRef","handleClickOutsideForm","contains","didUpdateRanLast","searchText","searchable","isSupportedColumnAndInProps","isSupportedColumn","lastQueryRequestDeepClone","additionalFilters","indexOfColumn","columnSingleValueQueryFilter","LIKE","some","defaultColumn","searchColumns","in","addEscapeCharacters","escapedSearchText","QueryWrapperPlotNav","sqlOperator","searchConfiguration","sqlUsed","SearchV2","faAngleLeft","faAngleRight","StackedBarChart","handleClick","handleArrowClick","extractPropsData","handleHover","handleExit","getTextForChartSelection","onMeasureResize","dimensions","bounds","bottom","boxShadow","xData","facetValueDisplay","filterDisplay","total","originalColor","onResize","contentRect","measureRef","rectStyle","rgbColor","svgWidth","tooltipId","numCharsInValue","svgHeight","onMouseEnter","onMouseLeave","textAnchor","fontFamily","getFileCount","faExternalLinkAlt","StepStateEnum","NavActionEnum","ExternalFileHandleLink","assertIsFileEntity","externalFileHandle","assertIsExternalFileHandle","externalURL","bodyText","isSubmitted","StepsSideNav","nonChildSteps","stepList","getIcon","isExcluded","isStatic","isSubmit","iconDef","flip","faBan","COMPLETED","faCheckCircle","faExclamationCircle","getItemClass","isInProgress","liClassName","getListItem","isWizard","isRenderChild","renderStepName","inProgress","final","excluded","static","itemClass","onStepChange","flex","isWizardMode","stepChildId","childStep","NavButtons","previousButton","previousStepIds","steps","currentStep","canGoBack","onNavAction","PREVIOUS","faChevronLeft","nextButton","NEXT","faChevronRight","saveButton","disabled","isFormSubmitted","SAVE","NextStepLink","nextStep","nextStepId","DataDebug","myData","hidden","findLabel","regex1","propArr","labelFromSchema","labelFromUi","arrayLabelFromSchema","arrayLabelFromUiSchema","indexMatch","first","isNaN","parseInt","SummaryTable","flatFormData","flatData","flatten","object","flattenedObject","prefix","isArray","isObject","prevVal","isDate","boundary","screen","order","getFlatData","prevScreenId","print","WarningModal","copy","Footer","onOK","callbackArgs","confirmCopy","SynapseForm","excludeWarningText","excludeWarningHeader","unsavedDataWarning","formRef","formDivRef","navAction","NONE","extraErrors","isNewForm","getFirstStep","onUnload","hasUnsavedChanges","returnValue","setupBeforeUnloadListener","_setIncludedPropInFormDataNonWizard","currentState","schemaScreens","currentStateFormData","_setIncludedPropInFormDataWizard","firstStepId","newStateData","getSchema","pick","getNextStepId","rules","default","engine","Engine","run","events","next","moveStep","previousStack","errorSchema","isMoveForwardInWizardMode","currentStepState","TODO","included","saveStepState","hasValidated","doShowErrors","goPrevious","previousStepId","isSubmitScreen","currentIndex","isUndefined","triggerAction","onSave","runCustomValidation","submit","triggerStepChange","GO_TO_STEP","onError","VALIDATE","modifiedSteps","setStepStatusForFailedValidation","scrollTo","isLoadingSaved","errors","currentSchemaProperties","stepsWithError","trimStart","property","stepsInCurrentSchema","performAction","showExcludeStateWarningModal","stepId","isUpdateFlattenedData","modalContext","action","toggleExcludeStep","arguments","isExclude","prevState","stp","formDataUpdated","renderNotification","SAVE_SUCCESS","SUBMIT_SUCCESS","PROGRESS","renderTextForStaticScreen","renderOptionalFormSubheader","renderHelpToggle","showHelp","checkedIcon","uncheckedIcon","offColor","allSteps","validationRules","acc","allRules","rule","paramProp","newRule","allowUndefinedFacts","stack","transformErrors","extraError","SUBMIT","parentPath","lastIndexOf","renderErrorListTemplate","currentLis","propPath","arrayLabelFromUI","renderTransformedErrorObject","stringToElementForProp","srcObject","k","navSchema","doShowHelp","shouldUpdate","callbackStatus","isSuccess","back","isEqual","hasError","when","formTitle","liveValidate","handleOnChange","form","showErrorList","ErrorList","screenId","formClass","SynapseFormWrapper","getFileEntityData","entityContent","newError","getFileEntityDataDereferenced","$RefParser","dereference","derefContent","formSchemaVersion","uiSchemaVersion","navSchemaVersion","submitted","fileData","promises","formSchemaEntityId","formUiSchemaEntityId","formNavSchemaEntityId","configData","formSchema","formUiSchema","formNavSchema","finishedProcessing","notification","submitForm","saveToFile","createOrUpdateFormDataFile","fileContentsBlob","fileUploadComplete","newFileHandleId","fileNamePath","errorTitle","fileContent","Blob","isReadyToDisplayForm","ERROR_CRITICAL","renderLoader","Heading","renderUnauthenticatedView","SynapseFormSubmissionGrid","modalTitle","listingText","subhead","noRecords","modalCopy","getTypeFileListing","nextPageToken","groupId","cleanUpName","filterByState","fileList","page","getMore","fileListType","statusList","requestFilter","SUBMITTED","IN_PROGRESS","getUserFileListing","deleteFile","setModalConfirmationState","renderLoading","renderSubmissionsTable","pathpart","textSource","tableTitleRow","viewMore","dataFileRecord","calendar","aria-hidden","submissionStatus","isShowInfoModal","faPhone","renderSubmissionsTables","NoSubmissionsIcon","itemNoun","WAITING_FOR_SUBMISSION","SUBMITTED_WAITING_FOR_REVIEW","ACCEPTED","REJECTED","CardContainerLogic","defaultState","prevSearchParams","currentSearchParams","hasSearchParamsChanged","hasTokenChanged","hasSqlChanged","queryRequestWithoutCount","totalResultsNoFacet","defaultProps","withRouter","to","setDownloadList","showDownloadModal","setShowDownloadModal","positionClass","useGetQueryResultBundle","useShowDesktop","breakpoint","usedBreakpoint","showDesktop","setShowDesktop","listener","updatedValue","ExpandableContent","ExpectedColumns","titleElement","GoalsDesktop","asset","getFieldIndex","assets","setAssets","assetColumnIndex","ASSET","fileId","tableIdColumnIndex","TABLEID","titleColumnIndex","TITLE","summaryColumnIndex","SUMMARY","linkColumnIndex","LINK","goalsDataProps","exploreLink","borderBottom","ProgramsDesktop","titleColumnName","linkColumnName","summaryColumnName","iconColumnName","linkConfig","iconColumnIndex","matchColIndex","baseExploreUrl","matchValue","ProgramsDataProps","ResourcesDesktop","setIndex","curIndex","ResourcesMobile","Resources","nameIndex","NAME","wikiIndex","WIKI","rssParser","Parser","RssFeed","_isMounted","onToggleReadMore","itemId","feedItemContentDiv","getElementById","itemId2MoreItem","isShow","foundMoreItem","classList","newText","newIcon","onClickShowMoreItems","isShowingMoreItems","rssFeed","isLoadingError","responseData","parseString","rss","parsedHtml","bodyElement","moreElement","showMoreElements","foundMoreElement","isItemVisible","defaultItemsToShow","showMoreText","showMoreIcon","guid","documentElement","innerHTML","TwitterFeed","twttr","widgets","load","data-height","data-theme","RssFeedCards","onClickSubscribe","isShowingSubscribeUI","mailChimpUrl","subscribePlus","mailChimpListName","itemsToShow","categoryName","categoryNameLowerCase","allowCategories","getLayout","dotPlotLayoutConfig","layoutOptions","plot_bgcolor","showticklabels","range","maxValue","isXAxis","isLegend","zeroline","showline","createArrayOfGroupValues","getPlotDataPoints","graphItems","plotStyle","ySorted","markerSymbols","isFakeData","groups","group","defaultSymbols","markerFill","markerLine","symbol","markerSize","DotPlot","optionsConfig","layoutConfig","xMax","pointsTypes","getBarPlotDataPoints","defaultColors","isTop","paper_bgcolor","hoverlabel","font","BarPlot","scrollZoom","editable","autosizable","dragmode","legend","xanchor","fixedrange","linecolor","autotick","tickcolor","gridcolor","automargin","hovermode","barLayoutConfig","barmode","xField","yField","groupField","whereClause","infoField","getTotalsByProp","prop","resultObject","getClickTargetData","swap","pointData","fadeColors","opacity","ThemesPlot","dotPlot","topBarPlot","sideBarPlot","tooltipProps","onPointClick","dotPlotYAxisLabel","setIsLoaded","dotPlotQueryData","setDotPlotQueryData","topBarPlotData","setTopBarQueryData","sideBarPlotData","setSideBarQueryData","dotPlotData","xLabels","yLabelsForDotPlot","xLabelsForTopBarPlot","xMaxForDotPlot","xMaxForSideBarPlot","topBarPlotDataSorted","totalsByDotPlotY","orderBy","staticPlot","float","countLabel","UpsetPlot","maxBarCount","setName","combinationName","summaryLinkText","summaryLink","selection","setSelection","updateFontSizes","setLabel","isCancelled","keyValuesMap","caseInsensitiveSetNames","newValue","sets","elems","extractSets","combinations","generateCombinations","getPlotData","onHover","selectionColor","hasSelectionOpacity","fontSizes","exportButtons","notMemberColor","STORED_UID_KEY","getDisplayIds","storedIds","storedIdsStr","part","UserCardListRotate","useQueryResultUserData","userIds","setUserIds","setQueryData","ownerIdColumnIndex","FacetPlotsCard","detailsPagePath","facetPlotDataArray","setFacetPlotDataArray","facetDataArray","setFacetDataArray","selectedFacetValue","setSelectedFacetValue","facetsDataToPlot","newPlotData","selectedFacet","detailsPageLink","QueryWrapperFacetPlotsCard","selectFacetColumnName","selectFacetColumnValue","getQueryRequest","FeaturedDataPlots","configs","FeaturedDataTabs","selectedTabIndex","setSelectedTabIndex","exploreObjectType","explorePagePath","selectedTabProps","isSelectedTabIndex","borderBottomColor","exploreFacetColumnName","exploreFacetColumnValue","plotsConfig","SelectionCriteriaPill","innerText","facetWithSelection","onRemove","filterValue","endsWith","TotalQueryResults","parentLoading","setTotal","facetsWithSelection","setFacetsWithSelection","getEnumFacetsWithSelections","transformEnumFacetsForSelectionDisplay","lookUpEntityHeaders","lookUpUserProfiles","filteredEnumWithSelectedValuesOnly","getDisplayValueForEntityColumn","getDisplayValueUserIdColumn","selectedValue","cloneLastQueryRequest","rangeFacetsWithSelections","enumFacetsWithSelections","rangeFacetsForDisplay","enumFacetsForDisplay","calculateTotal","removeFacetSelection","searchSelectionCriteriaPill","removeSearchQuerySelection","faPlus","CheckboxGroup","showAllFacets","isAllFilterSelected","facetColumnResultValues","curColor","backgroundClass","childrenView","Facets","htmlCheckboxes","newQueryRequest","checkbox","specificFacet","facetColumnValuesRequest","readFacetValues","showButtons","curFacetsLength","curFacetsIndex","inputRef","toggleDropdown","setDropdownIndex","dropdownIndex","highlightText","submittedSearchText","isQueryWrapperMenuChild","searchItem","outerHTML","searchItemView","SEARCH_CLASS_CSS","textElement","RegExp","clearSearchText","lastQueryRequestDeepCopy","lastSearchedFacet","searchableItem","fieldStyle","alignItems","curFacetDisplayText","lastSearchedFacetDisplayText","usedUnitDescription","borderRight","justifyContent","onSelect","hintText","QueryWrapperMenu","handleHoverLogic","switchFacet","menuIndexIn","accordionIndexIn","activeMenuIndices","accordionGroupIndex","menuConfig","toggleGroupAccordionIndex","accordionGroupIndexIn","accordionConfig","menuIndex","facetIndexFromFacetSearchParam","indexFromURLOrDefaultZero","getUnitDescription","getPartMask","getSelectedFacets","getSqlWithAdditionalClause","_prevState","stackedBarChartConfiguration","globalQueryCountSql","hasGroupByInSql","menuDropdown","renderMenuDropdown","queryWrapper","renderQueryChildren","queryConfig","groupIndex","facetValueFromSearchParams","aliasedFacet","searchClass","isSelectedFromURL","queryFromUrl","isAccordionConfigDefined","renderQueryChild","isActive","primaryColor","indicatorClasses","borderTopColor","hoverEnter","hoverLeave","component","appear","renderFacetMenu","curLevel","defaultColor","searchIconStyle","isSearchConfig","selectedStyling","borderLeftColor","infoEnter","infoLeave","facetDisplayValue","Uploader","inputOpenFileRef","showOpenFileDlg","click","handleFilesChanged","finishedProcessingOneFile","incrementedFilesUploadedCount","filesUploadedCount","isStillUploading","totalFilesToUploadCount","isUploading","successfullyUploaded","handleUploadError","selectorFiles","newFileEntity","parentId","parentContainerId","entityLookupRequest","entityName","existingEntity","updateEntityFile","isCreate","multiple","FileContentDownloadUploadDemo","updateFileContent","targetEntity","newFileContent","handleContentChange","targetEntityId","months","StatisticsPlot","getTrace","traceName","stats","markerColor","trace","statPoint","statPointDate","rangeStart","getUTCMonth","getUTCFullYear","filesCount","traces","fileDownloads","fileUploads","displaylogo","modeBarButtonsToRemove","useResizeHandler","Demo","entityFormRef","searchParamsProps","showMarkdown","showTabOne","tabOne","tabTwo","onRunDownloadSpeedTest","URLSearchParams","userFormDataSynId","QueryWrapperMenuDemo","experimentalSql","computationalSql","activeTab","tabFour","tabThree","grant","removeHandler","updatedState","circleSvg","brainSvg","resilienceadSvg","CardContainerLogicDemo","Program","SearchDemo","contributor","diagnosis","ModalDownloadDemo","onOpen","UserBadgeSmallDemo","_el","MarkdownSynapseDemo","markdownPropsArray","ShowDownloadDemo","NewsFeedDemo","SingleNewsFeedPost","updatedModifiedFeedUrl","feedUrl","urlParams","SingleNewsFeedPostDemo","FormServicesIntegrationDemo","listMyFormData","formGroup","myFormDataList","listFormAdminFormData","formAdminFormDataList","onReadFormDataFileHandleContents","onCreateFormGroup","onCreateFormData","onUpdateFormData","onSubmitFormData","TokenContext","Consumer","rejectionMessage","QueryWrapperPlotNavDemo","showCards","propsWithTable","propsWithCards","propsWithCustomCommands","targetColumn","cm","rowUpdates","changes","toAppend","HTMLButtonElement","propsForPlotNav","WidgetDemo","check1","setCheck1","check2","setCheck2","optionValue","setOptionValue","rangeNumberValue","setRangeNumberValue","toISOString","rangeDateValue","setRangeDateValue","rangeSliderValue","setRangeSliderValue","CSBC","tools","datasets","publications","AccessRequirementDemo","setDisplayAccessRequirement","currentWindowLocation","setInputValue","TemplateComponent","userId","setCount","TemplateComponentDemo","ThemesPlotDemo","shiftKey","ctrlKey","altKey","metaKey","ICBP","TEC","Goals","Programs","UpsetPlotDemo","SynapsePlotDemo","PeopleProfileDemo","FeaturedDataTabsDemo","App","exact","GoalsDemo","ProgramsDemo","getSession","getSessionCalled","signedInState","notSignedInState","Provider","basename","process","logoSvg","renderLoginAndSignout","Playground","ReactDOM","module","exports","ACCESS_TYPE","FileDownloadCode","AssertionError","ExternalFileHandleConcreteTypeEnum","ExternalFileHandle"],"mappings":"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CbC,YAAY,WACZd,UAAU,mCACVlP,GAAG,kBACHN,KAAK,WACLuD,KAAK,WACLyL,MAAOE,KAAKd,MAAM9O,SAClBiR,SAAUrB,KAAKT,eAEhBS,KAAKP,sBACN,0BACEyB,SAAUlB,KAAKR,YACfnL,KAAK,SACLiM,UAAU,+GAGV,gBAACQ,EAAD,CAAerd,KAAMA,GAArB,aAGJ,2BACE,qBACEiR,KAAI,UAAK3L,GACP5F,EAAuBmG,iBADrB,qBAGJgX,UAAU,wCAJZ,oBAQA,wBAAMA,UAAU,wCAAhB,kBAGA,qBACE5L,KAAI,UAAK3L,GACP5F,EAAuBmG,iBADrB,uBAGJgX,UAAU,yCAJZ,kB,GAzLUgB,a,yDCrCdC,GAA+B,CACnC,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,gBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,gBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBAGIC,GAA8B,CAClC,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,kBACA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","file":"static/js/main.cbe473f6.chunk.js","sourcesContent":["export enum BackendDestinationEnum {\n  REPO_ENDPOINT,\n  PORTAL_ENDPOINT,\n}\n\n// Encodes the portal and repo service destinations\ntype EndpointObject = {\n  REPO: string\n  PORTAL: string\n}\n\nexport const PRODUCTION_ENDPOINT_CONFIG: EndpointObject = {\n  REPO: 'https://repo-prod.prod.sagebase.org/',\n  PORTAL: 'https://www.synapse.org/',\n}\n\n// Given an endpoint will return the specific stack object\nexport const getEndpoint = (endpoint: BackendDestinationEnum): string => {\n  let endpoint_config = PRODUCTION_ENDPOINT_CONFIG\n  // @ts-ignore if overriding endpoint config\n  if (window.SRC && window.SRC.OVERRIDE_ENDPOINT_CONFIG) {\n    // @ts-ignore\n    endpoint_config = window.SRC && window.SRC.OVERRIDE_ENDPOINT_CONFIG\n  }\n  const { PORTAL, REPO } = endpoint_config\n  if (!PORTAL || !REPO) {\n    throw Error('Error failed to specify endpoints, cannot make call')\n  }\n  if (endpoint === BackendDestinationEnum.PORTAL_ENDPOINT) {\n    return PORTAL\n  }\n  return REPO\n}\n","import * as React from 'react'\n\nexport default ({ children, icon }: { children: any; icon?: any }) => {\n  const style: React.CSSProperties = {\n    paddingRight: 10,\n    fontWeight: 500,\n    paddingLeft: icon ? 0 : 10,\n    paddingTop: 10,\n    paddingBottom: 10,\n    textAlign: 'center',\n    width: '100%',\n  }\n  return <span style={style}>{children}</span>\n}\n","import * as React from 'react'\n// @ts-nocheck\nexport default ({ active }: { active: boolean }) => (\n  <div\n    style={{\n      background: active ? '#fff' : '#eee',\n      paddingTop: 7,\n      paddingRight: 10,\n      paddingBottom: 4,\n      paddingLeft: 10,\n      borderRadius: 2,\n    }}\n  >\n    <svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g fill=\"#000\" fillRule=\"evenodd\">\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\"\n          fill=\"#EA4335\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\"\n          fill=\"#4285F4\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\"\n          fill=\"#FBBC05\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\"\n          fill=\"#34A853\"\n        />\n        <path fill=\"none\" d=\"M0 0h18v18H0z\" />\n      </g>\n    </svg>\n  </div>\n)\n","import { UserCardSize } from '../containers/UserCard'\n\n/** QueryBundleRequest constants */\nexport const BUNDLE_MASK_QUERY_RESULTS: number = 1\nexport const BUNDLE_MASK_QUERY_COUNT: number = 2\nexport const BUNDLE_MASK_QUERY_SELECT_COLUMNS: number = 4\nexport const BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE: number = 8\nexport const BUNDLE_MASK_QUERY_COLUMN_MODELS: number = 16\nexport const BUNDLE_MASK_QUERY_FACETS: number = 32\nexport const BUNDLE_MASK_SUM_FILES_SIZE_BYTES: number = 64\n/** EntityBundle constants */\nexport const ENTITY_BUNDLE_MASK_ENTITY: number = 1\nexport const ENTITY_BUNDLE_MASK_ANNOTATIONS: number = 2\nexport const ENTITY_BUNDLE_MASK_PERMISSIONS: number = 4\nexport const ENTITY_BUNDLE_MASK_ENTITY_PATH: number = 8\nexport const ENTITY_BUNDLE_MASK_HAS_CHILDREN: number = 32\nexport const ENTITY_BUNDLE_MASK_ACL: number = 64\nexport const ENTITY_BUNDLE_MASK_FILE_HANDLES: number = 2048\nexport const ENTITY_BUNDLE_MASK_TABLE_DATA: number = 4096\nexport const ENTITY_BUNDLE_MASK_ROOT_WIKI_ID: number = 8192\nexport const ENTITY_BUNDLE_MASK_BENEFACTOR_ACL: number = 16384\nexport const ENTITY_BUNDLE_MASK_DOI: number = 32768\nexport const ENTITY_BUNDLE_MASK_FILE_NAME: number = 65536\nexport const ENTITY_BUNDLE_MASK_THREAD_COUNT: number = 131072\nexport const ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION: number = 262144\n/** Row Types  */\nexport const STUDY: string = 'study'\n/** Unannotated value for query */\nexport const VALUE_NOT_SET = 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n// for study icons\nexport const STUDY_ACTIVE: string = 'study active'\nexport const STUDY_COMPLETE: string = 'study complete'\nexport const DATABASE: string = 'database'\nexport const DATASET: string = 'dataset'\nexport const AMP_CONSORTIUM: string = 'AMP_Consortium'\nexport const FUNDER: string = 'funder'\nexport const PUBLICATION: string = 'publication'\nexport const TOOL: string = 'tool'\nexport const GENERIC_CARD: string = 'GENERIC_CARD'\nexport const COMPUTATIONAL: string = 'computational'\nexport const EXPERIMENTAL: string = 'experimental'\nexport const CLINICAL: string = 'clinical'\nexport const PROJECT: string = 'Project'\nexport const GRANT: string = 'Grant'\nexport const ORGANIZATION: string = 'ORGANIZATION'\nexport const PERSON: string = 'PERSON'\nexport const MOUSE: string = 'MOUSE'\nexport const EXPLORE: string = 'explore'\nexport const SEARCH: string = 'search'\nexport const CHART: string = 'chart'\nexport const FILTER: string = 'filter'\nexport const DOWNLOAD: string = 'download'\nexport const EXPAND: string = 'expand'\nexport const COLLAPSE: string = 'collapse'\nexport const CLOSE: string = 'close'\nexport const SORTUP: string = 'sortup'\nexport const SORTDOWN: string = 'sortdown'\nexport const SETTINGS: string = 'settings'\nexport const COLUMNS: string = 'columns'\nexport const COLUMNSDARK: string = 'columnsdark'\nexport const VERTICAL_DOTS: string = 'verticaldots'\n\nexport const PAGE_SIZE: number = 25\n// For User Profile Cards\nexport const SMALL_USER_CARD: UserCardSize = 'SMALL USER CARD'\nexport const MEDIUM_USER_CARD: UserCardSize = 'MEDIUM USER CARD'\nexport const LARGE_USER_CARD: UserCardSize = 'LARGE USER CARD'\nexport const SEPERATOR = 'SEPERATOR'\nexport const AUTHENTICATED_USERS = 'AUTHENTICATED_USERS'\n// For internal testing only\nexport const _TIME_DELAY = 75\nexport const SRC_SIGN_IN_CLASS = 'SRC-SIGN-IN-CLASS'\n\n// UserBundle constants\nexport const USER_BUNDLE_MASK_USER_PROFILE = 0x1\nexport const USER_BUNDLE_MASK_ORCID = 0x2\nexport const USER_BUNDLE_MASK_VERIFICATION_SUBMISSION = 0x4\nexport const USER_BUNDLE_MASK_IS_CERTIFIED = 0x8\nexport const USER_BUNDLE_MASK_IS_VERIFIED = 0x10\nexport const USER_BUNDLE_MASK_IS_ACT_MEMBER = 0x2\n// SessionStorage keys for info from ids\nexport const USER_PROFILE_STORAGE_KEY = 'INFO_FROM_IDS_USER_PROFILE'\nexport const ENTITY_HEADER_STORAGE_KEY = 'INFO_FROM_IDS_ENTITY_HEADER'\n","import { DownloadList } from '../synapseTypes'\n\nexport const DOWNLOAD_LIST_CHANGE_EVENT = 'DOWNLOAD_LIST_UPDATED_EVENT'\n\nexport const dispatchDownloadListChangeEvent = (\n  downloadList: DownloadList | undefined,\n) => {\n  const downloadEvent = new CustomEvent(DOWNLOAD_LIST_CHANGE_EVENT, {\n    detail: downloadList,\n  })\n  document.dispatchEvent(downloadEvent)\n}\n","import SparkMD5 from 'spark-md5'\nimport { BackendDestinationEnum, getEndpoint } from './functions/getEndpoint'\nimport {\n  AccessCodeResponse,\n  AccessControlList,\n  AddFilesToDownloadListRequest,\n  AddFilesToDownloadListResponse,\n  AddPartResponse,\n  AsyncJobId,\n  BatchFileRequest,\n  BatchFileResult,\n  BatchPresignedUploadUrlRequest,\n  BatchPresignedUploadUrlResponse,\n  BulkFileDownloadRequest,\n  BulkFileDownloadResponse,\n  DownloadFromTableRequest,\n  DownloadFromTableResult,\n  DownloadList,\n  DownloadOrder,\n  Entity,\n  EntityHeader,\n  EntityLookupRequest,\n  FileEntity,\n  FileHandle,\n  FileHandleAssociation,\n  FileHandleResults,\n  FileUploadComplete,\n  FormChangeRequest,\n  FormData,\n  FormGroup,\n  FormRejection,\n  ListRequest,\n  ListResponse,\n  LoginResponse,\n  MultipartUploadRequest,\n  MultipartUploadStatus,\n  OAuthClientPublic,\n  OAuthConsentGrantedResponse,\n  OIDCAuthorizationRequest,\n  OIDCAuthorizationRequestDescription,\n  PaginatedResults,\n  ProjectFilesStatisticsRequest,\n  ProjectFilesStatisticsResponse,\n  QueryBundleRequest,\n  QueryResultBundle,\n  QueryTableResults,\n  ReferenceList,\n  RestrictionInformationRequest,\n  RestrictionInformationResponse,\n  Submission,\n  SynapseVersion,\n  UserBundle,\n  UserGroupHeaderResponsePage,\n  UserProfile,\n  WikiPage,\n  AccessRequirement,\n  AccessApproval,\n  EntityId,\n  WikiPageKey,\n  ObjectType,\n  AccessRequirementStatus,\n  FileHandleAssociateType,\n} from './synapseTypes/'\nimport UniversalCookies from 'universal-cookie'\nimport { dispatchDownloadListChangeEvent } from './functions/dispatchDownloadListChangeEvent'\nimport { TableUpdateTransactionRequest } from './synapseTypes/Table/TableUpdate'\nimport {\n  TransformSqlWithFacetsRequest,\n  SqlTransformResponse,\n} from './synapseTypes/Table/TransformSqlWithFacetsRequest'\nimport { SynapseConstants } from '.'\n\nconst cookies = new UniversalCookies()\n\n// TODO: Create JSON response types for all return types\nexport const IS_OUTSIDE_SYNAPSE_ORG = window.location.hostname\n  .toLowerCase()\n  .includes('.synapse.org')\n  ? false\n  : true\n\nexport const SESSION_TOKEN_COOKIE_KEY =\n  'org.sagebionetworks.security.user.login.token'\n\n// Max size file that we will allow the caller to read into memory (5MB)\nconst MAX_JS_FILE_DOWNLOAD_SIZE = 5242880\nexport const AUTH_PROVIDER = 'GOOGLE_OAUTH_2_0'\n// This corresponds to the Synapse-managed S3 storage location:\nexport const SYNAPSE_STORAGE_LOCATION_ID = 1\nexport const getRootURL = () => {\n  const portString = window.location.port ? `:${window.location.port}` : ''\n  return `${window.location.protocol}//${window.location.hostname}${portString}/`\n}\n\n/**\n * Waits t number of milliseconds\n *\n * @export\n * @param {number} t milliseconds\n * @returns after t milliseconds\n */\nexport function delay(t: number) {\n  return new Promise(resolve => {\n    setTimeout(resolve.bind(null, {}), t)\n  })\n}\n\ntype SynapseError = {\n  reason: string\n}\n\nexport type SynapseClientError = {\n  reason: string\n  status: number\n}\n\n/*\n  0 - no internet connection\n  429 - too many concurrent requests\n  500>= - any status code of 500 or more is a server side error\n*/\nconst RETRY_STATUS_CODES = [0, 429, 500, 502, 503, 504]\n\nconst fetchWithExponentialTimeout = <T>(\n  url: RequestInfo,\n  options: RequestInit,\n  delayMs: number = 1000,\n): Promise<T> => {\n  return fetch(url, options)\n    .then(resp => {\n      return resp\n        .text()\n        .then(text => {\n          // try to parse it as json\n          try {\n            const json = JSON.parse(text)\n            return resp.ok ? Promise.resolve(json) : Promise.reject<T>(json)\n          } catch (error) {\n            // failed to parse json, return text\n            return resp.ok ? Promise.resolve(text) : Promise.reject<T>(text)\n          }\n        })\n        .catch((error: SynapseError) => {\n          if (resp.ok) {\n            // possible empty response\n            return Promise.resolve({\n              reason: error,\n              status: resp.status,\n            })\n          }\n          if (error.reason && resp.status) {\n            // successful return from server but invalid call\n            return Promise.reject({\n              ...error,\n              status: resp.status,\n            })\n          }\n          // This occurs if the response is not ok and does not have json or is empty\n          return Promise.reject({\n            reason: error,\n            status: resp.status,\n          })\n        })\n    })\n    .catch(error => {\n      if (error.status && RETRY_STATUS_CODES.indexOf(error.status) !== -1) {\n        return delay(delayMs).then(() => {\n          return fetchWithExponentialTimeout<T>(url, options, delayMs * 2)\n        })\n      } else {\n        return Promise.reject(error)\n      }\n    })\n}\n\nexport const doPost = <T>(\n  url: string,\n  requestJsonObject: any,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n): Promise<T> => {\n  const options: RequestInit = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n      'Content-Type': 'application/json',\n    },\n    method: 'POST',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout<T>(usedEndpoint + url, options)\n}\nexport const doGet = <T>(\n  url: string,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n) => {\n  const options: RequestInit = {\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n    },\n    method: 'GET',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout<T>(usedEndpoint + url, options)\n}\n\nexport const doDelete = (\n  url: string,\n  requestJsonObject: any | undefined = undefined,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n) => {\n  const options: RequestInit = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n    },\n    method: 'DELETE',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout(usedEndpoint + url, options)\n}\n\nexport const doPut = (\n  url: string,\n  requestJsonObject: any,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n): Promise<any> => {\n  const options: RequestInit = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n      'Content-Type': 'application/json',\n    },\n    method: 'PUT',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout(usedEndpoint + url, options)\n}\n\nexport const putRefreshSessionToken = (sessionToken: string) => {\n  return doPut(\n    '/auth/v1/session',\n    { sessionToken },\n    undefined,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getVersion = (): Promise<SynapseVersion> => {\n  return doGet<SynapseVersion>(\n    '/repo/v1/version',\n    undefined,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * https://docs.synapse.org/rest/POST/download/list/add/async/start.html\n */\n//Start an asynchronous job to add files to a user's download list.\nexport const addFilesToDownloadList = (\n  request: AddFilesToDownloadListRequest,\n  sessionToken: string,\n  updateParentState?: any,\n) => {\n  return doPost<AsyncJobId>(\n    `file/v1/download/list/add/async/start`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((resp: AsyncJobId) => {\n      const requestUrl = `file/v1/download/list/add/async/get/${resp.token}`\n      return getAsyncResultFromJobId<AddFilesToDownloadListResponse>(\n        requestUrl,\n        sessionToken,\n        updateParentState,\n      ).then(data => {\n        dispatchDownloadListChangeEvent(data.downloadList)\n        return data\n      })\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n\n/**\n * https://docs.synapse.org/rest/POST/entity/id/table/download/csv/async/start.html\n */\nexport const getDownloadFromTableRequest = (\n  request: DownloadFromTableRequest,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n) => {\n  return doPost<AsyncJobId>(\n    `/repo/v1/entity/${request.entityId}/table/download/csv/async/start`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((resp: AsyncJobId) => {\n      const requestUrl = `/repo/v1/entity/${request.entityId}/table/download/csv/async/get/${resp.token}`\n      return getAsyncResultFromJobId<DownloadFromTableResult>(\n        requestUrl,\n        sessionToken,\n        updateParentState,\n      )\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n\n/**\n * https://docs.synapse.org/rest/GET/fileHandle/handleId.html\n * Get a FileHandle using its ID.\n * Note: Only the user that created the FileHandle can access it directly.\n * @return FileHandle\n **/\nexport const getFileHandleById = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n): Promise<FileHandle> => {\n  return doGet<FileHandle>(\n    `file/v1/fileHandle/${handleId}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * http://rest-docs.synapse.org/rest/GET/file/id.html\n * Get the actual URL of the file from with an associated object .\n * @return a short lived presignedURL to be redirected with\n **/\nexport const getActualFileHandleByIdURL = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n  fileAssociateType: FileHandleAssociateType,\n  fileAssociateId: string,\n  redirect: boolean = true,\n) => {\n  // get the presigned URL for this file handle and open it in a new tab\n  doGet<string>(\n    `/file/v1/file/${handleId}?fileAssociateType=${fileAssociateType}&fileAssociateId=${fileAssociateId}&redirect=${redirect}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then(url => {\n      window.open(url, '_blank')\n    })\n    .catch(err => {\n      console.error('Error on retrieving file handle url ', err)\n    })\n}\n\n/**\n * https://docs.synapse.org/rest/GET/fileHandle/handleId/url.html\n * Note: Only the user that created the FileHandle can use this method for download.\n * @return a short lived presignedURL to be redirected with\n **/\nexport const getFileHandleByIdURL = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n) => {\n  // get the presigned URL for this file handle\n  return doGet<string>(\n    `file/v1/fileHandle/${handleId}/url?redirect=false`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getAsyncResultFromJobId = <T>(\n  urlRequest: string,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n): Promise<T> => {\n  return doGet(\n    urlRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((resp: any) => {\n      // is this the job status?\n      if (resp.jobState && resp.jobState !== 'FAILED') {\n        updateParentState &&\n          updateParentState({\n            asyncJobStatus: resp,\n          })\n        // still processing, wait for a second and try again\n        return delay(500).then(() => {\n          return getAsyncResultFromJobId<T>(\n            urlRequest,\n            sessionToken,\n            updateParentState,\n          )\n        })\n      }\n      // these must be the query results!\n      return resp\n    })\n    .catch(error => {\n      throw error\n    })\n}\n\n/**\n * http://docs.synapse.org/rest/POST/entity/id/table/query/nextPage/async/start.html\n * @param {*} queryBundleRequest\n * @param {*} sessionToken\n * @param {*} endpoint\n */\nexport const getQueryTableResults = (\n  queryBundleRequest: QueryBundleRequest,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n): Promise<QueryResultBundle> => {\n  return doPost<AsyncJobId>(\n    `/repo/v1/entity/${queryBundleRequest.entityId}/table/query/async/start`,\n    queryBundleRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then(resp => {\n      return getAsyncResultFromJobId<QueryResultBundle>(\n        `/repo/v1/entity/${queryBundleRequest.entityId}/table/query/async/get/${resp.token}`,\n        sessionToken,\n        updateParentState,\n      )\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n/**\n *  Run and return results from queryBundleRequest, queryBundle request must be of the\n *  form:\n *     {\n *        concreteType: String,\n *        query: {\n *           sql: String,\n *           partMask: Number\n *        }\n *     }\n * @param {*} queryBundleRequest\n * @param {*} [sessionToken=undefined]\n * @param {boolean} [onlyGetFacets=false] Specify if the query only needs facets and no\n * data-- (internally this limits the row count to 1 on the request)\n * @returns Full dataset from synapse table query\n */\n\nexport const getFullQueryTableResults = async (\n  queryBundleRequest: QueryBundleRequest,\n  sessionToken: string | undefined = undefined,\n  initMaxPageSize: number = 2500,\n): Promise<QueryResultBundle> => {\n  let data: QueryResultBundle\n  // get first page\n  let offset = 0\n  const { query, ...rest } = queryBundleRequest\n  const queryRequest: QueryBundleRequest = {\n    ...rest,\n    query: { ...query, limit: initMaxPageSize, offset: offset },\n    partMask:\n      queryBundleRequest.partMask |\n      SynapseConstants.BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE,\n  }\n  let response = await getQueryTableResults(queryRequest, sessionToken)\n  data = response\n  // we are done if we return less than a pagesize.\n  // however, if the initMaxPageSize provided by the caller is larger than the maxRowsPerPage that the backend is willing to return for this Table/View,\n  // then the first page length will be less than the initMaxPageSize but we should keep going.\n  let isDone =\n    response.queryResult.queryResults.rows.length < initMaxPageSize &&\n    initMaxPageSize <= data.maxRowsPerPage!\n  offset += response.queryResult.queryResults.rows.length\n  queryRequest.query.limit = data.maxRowsPerPage // set the limit to the actual max rows per page\n\n  while (!isDone) {\n    queryRequest.query.offset = offset\n    // update the maxPageSize to the largest possible value after the first page is complete.  This is a no-op after the second page.\n\n    let response = await getQueryTableResults(queryRequest, sessionToken)\n    data.queryResult.queryResults.rows.push(\n      ...response.queryResult.queryResults.rows, // ... spread operator to push all elements on\n    )\n    isDone =\n      response.queryResult.queryResults.rows.length < queryRequest.query.limit!\n    offset += response.queryResult.queryResults.rows.length\n  }\n  return data\n}\n\n/**\n *  Log-in using the given username and password.  Will return a session token that must be used in\n *  authenticated requests.\n *  http://docs.synapse.org/rest/POST/login.html\n */\nexport const login = (\n  username: string,\n  password: string,\n  authenticationReceipt: string | null,\n  endpoint = BackendDestinationEnum.REPO_ENDPOINT,\n): Promise<LoginResponse> => {\n  return doPost(\n    '/auth/v1/login',\n    { username, password, authenticationReceipt },\n    undefined,\n    undefined,\n    endpoint,\n  )\n}\n/**\n * Get redirect url\n * https://docs.synapse.org/rest/POST/oauth2/authurl.html\n * @param {*} provider\n * @param {*} redirectUrl\n * @param {*} endpoint\n */\nexport const oAuthUrlRequest = (\n  provider: string,\n  redirectUrl: string,\n  endpoint = BackendDestinationEnum.REPO_ENDPOINT,\n) => {\n  return doPost(\n    '/auth/v1/oauth2/authurl',\n    { provider, redirectUrl },\n    undefined,\n    undefined,\n    endpoint,\n  )\n}\n/**\n * Get session token from SSO\n * https://docs.synapse.org/rest/POST/oauth2/session.html\n * @param {*} provider\n * @param {*} authenticationCode\n * @param {*} redirectUrl\n * @param {*} endpoint\n */\nexport const oAuthSessionRequest = (\n  provider: string,\n  authenticationCode: string | number,\n  redirectUrl: string,\n  endpoint: any = BackendDestinationEnum.REPO_ENDPOINT,\n) => {\n  return doPost(\n    '/auth/v1/oauth2/session',\n    { provider, authenticationCode, redirectUrl },\n    undefined,\n    undefined,\n    endpoint,\n  )\n}\n/**\n * Create an entity (Project, Folder, File, Table, View)\n * http://docs.synapse.org/rest/POST/entity.html\n */\nexport const createEntity = <T extends Entity>(\n  entity: T,\n  sessionToken: string | undefined,\n) => {\n  return doPost<T>(\n    '/repo/v1/entity',\n    entity,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Create a project with the given name.\n * http://docs.synapse.org/rest/POST/entity.html\n */\nexport const createProject = (\n  name: string,\n  sessionToken: string | undefined,\n): Promise<Entity> => {\n  return createEntity(\n    {\n      name,\n      concreteType: 'org.sagebionetworks.repo.model.Project',\n    },\n    sessionToken,\n  )\n}\n\n/**\n * Return this user's UserProfile\n * http://docs.synapse.org/rest/GET/userProfile.html\n */\nexport const getUserProfile = (sessionToken: string | undefined) => {\n  return doGet<UserProfile>(\n    '/repo/v1/userProfile',\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return this user's UserProfile\n * http://docs.synapse.org/rest/GET/userProfile.html\n */\nexport const getUserProfileById = (\n  sessionToken: string | undefined,\n  ownerId: string,\n) => {\n  return doGet<UserProfile>(\n    `/repo/v1/userProfile/${ownerId}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return this user's profile bundle\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserBundle.html\n */\nexport const getUserBundle = (\n  id: string,\n  mask: number,\n  sessionToken: string | undefined,\n): Promise<UserBundle> => {\n  return doGet<UserBundle>(\n    `repo/v1/user/${id}/bundle?mask=${mask}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return batch of user group headers\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserGroupHeaderResponsePage.html\n */\nexport const getGroupHeadersBatch = (\n  ids: string[],\n  sessionToken: string | undefined,\n): Promise<UserGroupHeaderResponsePage> => {\n  return doGet<UserGroupHeaderResponsePage>(\n    `repo/v1/userGroupHeaders/batch?ids=${ids.join(',')}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport type UserProfileList = { list: UserProfile[] }\n/**\n * Return the User Profiles for the given list of user IDs\n * http://docs.synapse.org/rest/POST/userProfile.html\n */\nexport const getUserProfiles = (\n  list: string[],\n  sessionToken: string | undefined = undefined,\n): Promise<UserProfileList> => {\n  return doPost(\n    '/repo/v1/userProfile',\n    { list },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return the children (Files/Folders) of the given entity (Project or Folder).\n * http://docs.synapse.org/rest/POST/entity/children.html\n */\nexport const getEntityChildren = (\n  request: any,\n  sessionToken: string | undefined = undefined,\n) => {\n  return doPost(\n    '/repo/v1/entity/children',\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Retrieve an entityId for a given parent ID and entity name.\n * https://docs.synapse.org/rest/POST/entity/child.html\n */\nexport const lookupChildEntity = (\n  request: EntityLookupRequest,\n  sessionToken: string | undefined = undefined,\n) => {\n  return doPost<EntityId>(\n    '/repo/v1/entity/child',\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get a batch of pre-signed URLs and/or FileHandles for the given list of FileHandleAssociations.\n * http://docs.synapse.org/rest/POST/fileHandle/batch.html\n */\nexport const getFiles = (\n  request: BatchFileRequest,\n  sessionToken: string | undefined = undefined,\n): Promise<BatchFileResult> => {\n  return doPost(\n    '/file/v1/fileHandle/batch',\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get a batch of pre-signed URLs and/or FileHandles for the given list of FileHandleAssociations.\n * http://docs.synapse.org/rest/POST/fileHandle/batch.html\n */\nexport const getBulkFiles = (\n  bulkFileDownloadRequest: BulkFileDownloadRequest,\n  sessionToken: string | undefined = undefined,\n): Promise<BulkFileDownloadResponse> => {\n  return doPost<AsyncJobId>(\n    'file/v1/file/bulk/async/start',\n    bulkFileDownloadRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((asyncJobId: AsyncJobId) => {\n      const urlRequest = `/file/v1/file/bulk/async/get/${asyncJobId.token}`\n      return getAsyncResultFromJobId<BulkFileDownloadResponse>(\n        urlRequest,\n        sessionToken,\n      )\n    })\n    .catch(err => {\n      console.error('Error on getBulkFiles ', err)\n      return err\n    })\n}\n/**\n * Bundled access to Entity and related data components.\n * An EntityBundle can be used to create, fetch, or update an Entity and associated\n * objects with a single web service request.\n * See SynapseClient.test.js for an example partsMask.\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/Entity.html\n */\ntype GetEntity = <T extends Entity>(\n  sessionToken: string | undefined,\n  entityId: string | number,\n  versionNumber?: string,\n) => Promise<T>\n\nexport const getEntity: GetEntity = <T>(\n  sessionToken: string | undefined = undefined,\n  entityId: string | number,\n  versionNumber?: string,\n) => {\n  const url = versionNumber\n    ? `/repo/v1/entity/${entityId}/version/${versionNumber}`\n    : `/repo/v1/entity/${entityId}`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<T>\n}\n\n/**\n * Get the EntityHeader for a list of references with a POST.\n * If any item in the batch fails (e.g., with a 404) it will be EXCLUDED in the result set.\n * https://docs.synapse.org/rest/POST/entity/header.html\n */\nexport const getEntityHeader = (\n  references: ReferenceList,\n  sessionToken: string | undefined = undefined,\n) => {\n  return doPost(\n    'repo/v1/entity/header',\n    { references },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<PaginatedResults<EntityHeader>>\n}\n\nexport const updateEntity = <T extends Entity>(\n  entity: T,\n  sessionToken: string | undefined = undefined,\n): Promise<T> => {\n  const url = `/repo/v1/entity/${entity.id}`\n  return doPut(\n    url,\n    entity,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const deleteEntity: GetEntity = <T>(\n  sessionToken: string | undefined = undefined,\n  entityId: string | number,\n) => {\n  const url = `/repo/v1/entity/${entityId}`\n  return doDelete(\n    url,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<T>\n}\n\n/**\n * Bundled access to Entity and related data components.\n * An EntityBundle can be used to create, fetch, or update an Entity and\n * associated objects with a single web service request.\n * See SynapseClient.test.js for an example partsMask.\n * http://docs.synapse.org/rest/GET/entity/id/version/versionNumber/bundle.html\n */\nexport const getEntityBundleForVersion = (\n  entityId: string | number,\n  version: string | number | undefined,\n  partsMask: string | number,\n  sessionToken: string | undefined = undefined,\n) => {\n  let url = `/repo/v1/entity/${entityId}`\n  if (version) {\n    url += `/version/ + ${version}`\n  }\n  url += `/bundle?mask= ${partsMask}`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<any>\n}\n\n/**\n * Get a corresponding string value of ObjectType:\n **/\nfunction getObjectTypeToString(key: ObjectType) {\n  return ObjectType[key]\n}\n\n/**\n * Get Wiki page contents, call is of the form:\n * http://docs.synapse.org/rest/GET/entity/ownerId/wiki.html\n */\nexport const getEntityWiki = (\n  sessionToken: string | undefined,\n  ownerId: string | undefined,\n  wikiId: string | undefined = '',\n  objectType: ObjectType = ObjectType.ENTITY,\n) => {\n  const objectTypeString = getObjectTypeToString(objectType!)\n\n  const url = `/repo/v1/${objectTypeString?.toLocaleLowerCase()}/${ownerId}/wiki/${wikiId}`\n  return doGet<WikiPage>(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Returns synapse user favorites list given their session token\n * http://docs.synapse.org/rest/GET/favorite.html\n */\nexport const getUserFavorites = (sessionToken: string | undefined) => {\n  const url = 'repo/v1/favorite?offset=0&limit=200'\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<any>\n}\n\n/**\n * Get the user's list of teams they are on\n *\n * @param {*} id ownerID of the synapse user see - http://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserProfile.html\n */\nexport const getUserTeamList = (\n  sessionToken: string | undefined,\n  id: string | number,\n) => {\n  const url = `repo/v1/user/${id}/team?offset=0&limit=200`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Get the user's list of teams they are on\n *\n * @param {*} id ownerID of the synapse user see -https://docs.synapse.org/rest/GET/teamMembers/id.html\n * @param {*} fragment (optional) a prefix of the user's first or last name or email address (optional)\n * @param {*} limit    (optional) the maximum number of members to return (default 10, max limit 50)\n * @param {*} offset   (optional) the starting index of the returned results (default 0)\n *\n */\nexport const getTeamList = (\n  sessionToken: string | undefined,\n  id: string | number,\n  fragment: string = '',\n  limit: number = 10,\n  offset: number = 0,\n) => {\n  const url = `repo/v1/teamMembers/${id}?limit=${limit}&offset=${offset}${\n    fragment ? `&fragment=${fragment}` : ''\n  }`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * https://rest-docs.synapse.org/rest/GET/access_requirement/ownerId/wikikey.html\n * Get the root WikiPageKey for an Access Requirement.\n * Note: The caller must be granted the ACCESS_TYPE.READ permission on the owner.\n * @return WikiPageKey\n **/\n\nexport const getWikiPageKey = (\n  sessionToken: string | undefined,\n  ownerId: string | number,\n): Promise<WikiPageKey> => {\n  const url = `repo/v1/access_requirement/${ownerId}/wikikey`\n  return doGet<WikiPageKey>(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getWikiAttachmentsFromEntity = (\n  sessionToken: string | undefined,\n  id: string | number,\n  wikiId: string | number,\n  objectType: ObjectType = ObjectType.ENTITY,\n): Promise<FileHandleResults> => {\n  const objectTypeString = getObjectTypeToString(objectType!)\n  const url = `repo/v1/${objectTypeString.toLocaleLowerCase()}/${id}/wiki2/${wikiId}/attachmenthandles`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\nexport const getWikiAttachmentsFromEvaluation = (\n  sessionToken: string | undefined,\n  id: string | number,\n  wikiId: string | number,\n) => {\n  const url = `repo/v1/evaluation/${id}/wiki/${wikiId}/attachmenthandles`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Set the session token cookie.  Note that this will only succeed if your app is running on\n * a .synapse.org subdomain.\n *\n * @param {*} token Session token.  If undefined, then call should instruct the browser to delete the cookie.\n */\nexport const setSessionTokenCookie = async (\n  token: string | undefined,\n  sessionCallback: Function,\n) => {\n  if (IS_OUTSIDE_SYNAPSE_ORG) {\n    if (!token) {\n      cookies.remove(SESSION_TOKEN_COOKIE_KEY, { path: '/' })\n      // See - https://github.com/reactivestack/cookies/issues/189\n      await delay(100)\n    } else {\n      // set's cookie in session storage\n      cookies.set(SESSION_TOKEN_COOKIE_KEY, token, {\n        // expires in a day\n        maxAge: 60 * 60 * 24,\n        path: '/',\n      })\n    }\n    sessionCallback()\n  } else {\n    // will set cookie in the http header\n    doPost(\n      'Portal/sessioncookie',\n      { sessionToken: token },\n      undefined,\n      'include',\n      BackendDestinationEnum.PORTAL_ENDPOINT,\n    )\n      .then(_ => {\n        sessionCallback()\n      })\n      .catch(err => {\n        console.error('Error on setting session token ', err)\n      })\n  }\n}\n/**\n * Get the current session token from a cookie.  Note that this will only succeed if your app is running on\n * a .synapse.org subdomain.\n */\nexport const getSessionTokenFromCookie = async () => {\n  if (IS_OUTSIDE_SYNAPSE_ORG) {\n    return cookies.get(SESSION_TOKEN_COOKIE_KEY)\n  }\n  return doGet<string>(\n    'Portal/sessioncookie',\n    undefined,\n    'include',\n    BackendDestinationEnum.PORTAL_ENDPOINT,\n  )\n}\n\nexport const getPrincipalAliasRequest = (\n  sessionToken: string | undefined,\n  alias: string,\n  type: string,\n) => {\n  const url = 'repo/v1/principal/alias'\n  return doPost(\n    url,\n    { alias, type },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/*\nDuring SSO login, the authorization provider (Google) will\nsend the user back to the portal with an authorization code,\nwhich can be exchanged for a Synapse user session.\nThis function should be called whenever the root App is initialized\n(to look for this code parameter and complete the round-trip).\n*/\nexport const detectSSOCode = () => {\n  const redirectURL = getRootURL()\n  // 'code' handling (from SSO) should be preformed on the root page, and then redirect to original route.\n  let code: URL | null | string = new URL(window.location.href)\n  // in test environment the searchParams isn't defined\n  const { searchParams } = code\n  if (!searchParams) {\n    return\n  }\n  code = searchParams.get('code')\n  if (code) {\n    oAuthSessionRequest(\n      AUTH_PROVIDER,\n      code,\n      `${redirectURL}?provider=${AUTH_PROVIDER}`,\n      BackendDestinationEnum.REPO_ENDPOINT,\n    )\n      .then((synToken: any) => {\n        setSessionTokenCookie(synToken.sessionToken, () => {\n          // go back to original route after successful SSO login\n          const originalUrl = localStorage.getItem('after-sso-login-url')\n          localStorage.removeItem('after-sso-login-url')\n          if (originalUrl) {\n            window.location.replace(originalUrl)\n          }\n        })\n      })\n      .catch((err: any) => {\n        if (err.status === 404) {\n          // Synapse account not found, send to registration page\n          window.location.replace('https://www.synapse.org/#!RegisterAccount:0')\n        }\n        console.error('Error on sso sign in ', err)\n      })\n  }\n}\n\nexport const signOut = (sessionCallback: Function) => {\n  setSessionTokenCookie(undefined, sessionCallback)\n}\n\n/**\n * Upload file.  Note that this currently only supports Synapse storage (Sage s3 bucket)\n * @param sessionToken\n * @param file\n * @param endpoint\n */\nexport const uploadFile = (\n  sessionToken: string | undefined,\n  filename: string,\n  file: Blob,\n) => {\n  return new Promise<FileUploadComplete>(\n    (fileUploadResolve, fileUploadReject) => {\n      const partSize: number = Math.max(5242880, file.size / 10000)\n      const request: MultipartUploadRequest = {\n        contentType: file.type,\n        fileName: filename,\n        fileSizeBytes: file.size,\n        partSizeBytes: partSize,\n        storageLocationId: SYNAPSE_STORAGE_LOCATION_ID,\n      }\n      calculateMd5(file).then((md5: string) => {\n        request.contentMD5Hex = md5\n        startMultipartUpload(\n          sessionToken,\n          filename,\n          file,\n          request,\n          fileUploadResolve,\n          fileUploadReject,\n        )\n      })\n    },\n  )\n}\n\nconst calculateMd5 = (fileBlob: File | Blob): Promise<string> => {\n  // code taken from md5 example from library\n  return new Promise((resolve, reject) => {\n    const blobSlice = File.prototype.slice,\n      file = fileBlob,\n      chunkSize = 2097152, // Read in chunks of 2MB\n      chunks = Math.ceil(file.size / chunkSize),\n      spark = new SparkMD5.ArrayBuffer(),\n      fileReader = new FileReader()\n    let currentChunk = 0\n\n    fileReader.onload = function (e) {\n      console.log('read chunk nr', currentChunk + 1, 'of', chunks)\n      spark.append(fileReader.result as ArrayBuffer) // Append array buffer\n      currentChunk++\n\n      if (currentChunk < chunks) {\n        loadNext()\n      } else {\n        console.log('finished loading')\n        const md5: string = spark.end()\n        console.info('computed hash', md5) // Compute hash\n        resolve(md5)\n      }\n    }\n\n    fileReader.onerror = function () {\n      console.warn('oops, something went wrong.')\n      reject(fileReader.error)\n    }\n\n    const loadNext = () => {\n      const start = currentChunk * chunkSize,\n        end = start + chunkSize >= file.size ? file.size : start + chunkSize\n\n      fileReader.readAsArrayBuffer(blobSlice.call(file, start, end))\n    }\n    loadNext()\n  })\n}\n\nconst processFilePart = (\n  partNumber: number,\n  multipartUploadStatus: MultipartUploadStatus,\n  sessionToken: string | undefined,\n  fileName: string,\n  file: Blob,\n  request: MultipartUploadRequest,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n) => {\n  if (multipartUploadStatus.clientSidePartsState![partNumber - 1]) {\n    // no-op. this part has already been processed!\n    return\n  }\n\n  const uploadId = multipartUploadStatus.uploadId\n  const presignedUploadUrlRequest: BatchPresignedUploadUrlRequest = {\n    uploadId,\n    contentType: 'application/octet-stream', // each part is binary\n    partNumbers: [partNumber],\n  }\n  const presignedUrlUrl = `/file/v1/file/multipart/${uploadId}/presigned/url/batch`\n  doPost<BatchPresignedUploadUrlResponse>(\n    presignedUrlUrl,\n    presignedUploadUrlRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ).then(async (presignedUrlResponse: BatchPresignedUploadUrlResponse) => {\n    const presignedUrl =\n      presignedUrlResponse.partPresignedUrls[0].uploadPresignedUrl\n    // calculate the byte range\n    const startByte = (partNumber - 1) * request.partSizeBytes\n    let endByte = partNumber * request.partSizeBytes - 1\n    if (endByte >= request.fileSizeBytes) {\n      endByte = request.fileSizeBytes - 1\n    }\n    const fileSlice = file.slice(\n      startByte,\n      endByte + 1,\n      presignedUploadUrlRequest.contentType,\n    )\n    await uploadFilePart(\n      presignedUrl,\n      fileSlice,\n      presignedUploadUrlRequest.contentType,\n    )\n    // uploaded the part.  calculate md5 of the part and add the part to the upload\n    calculateMd5(fileSlice).then((md5: string) => {\n      const addPartUrl = `/file/v1/file/multipart/${uploadId}/add/${partNumber}?partMD5Hex=${md5}`\n      doPut(\n        addPartUrl,\n        undefined,\n        sessionToken,\n        undefined,\n        BackendDestinationEnum.REPO_ENDPOINT,\n      ).then((addPartResponse: AddPartResponse) => {\n        if (addPartResponse.addPartState === 'ADD_SUCCESS') {\n          // done with this part!\n          multipartUploadStatus.clientSidePartsState![partNumber - 1] = true\n          checkUploadComplete(\n            multipartUploadStatus,\n            fileName,\n            sessionToken,\n            fileUploadResolve,\n            fileUploadReject,\n          )\n        } else {\n          // retry after a brief delay\n          delay(1000).then(() => {\n            processFilePart(\n              partNumber,\n              multipartUploadStatus,\n              sessionToken,\n              fileName,\n              file,\n              request,\n              fileUploadResolve,\n              fileUploadReject,\n            )\n          })\n        }\n      })\n    })\n  })\n}\nexport const checkUploadComplete = (\n  status: MultipartUploadStatus,\n  fileHandleName: string,\n  sessionToken: string | undefined,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n) => {\n  // if all client-side parts are true (uploaded), then complete the upload and get the file handle!\n  if (\n    status.clientSidePartsState!.every(v => {\n      return v\n    })\n  ) {\n    const url = `/file/v1/file/multipart/${status.uploadId}/complete`\n    doPut(\n      url,\n      undefined,\n      sessionToken,\n      undefined,\n      BackendDestinationEnum.REPO_ENDPOINT,\n    )\n      .then((newStatus: MultipartUploadStatus) => {\n        // success!\n        fileUploadResolve({\n          fileHandleId: newStatus.resultFileHandleId,\n          fileName: fileHandleName,\n        })\n      })\n      .catch(error => {\n        fileUploadReject(error)\n      })\n  }\n}\nconst uploadFilePart = async (\n  presignedUrl: string,\n  file: any,\n  contentType: string,\n) => {\n  // TODO: could try using axios to get upload progress, then update the client-side part state (change to numbers from 0-1)\n  // This would give progress for the single file (across all parts).\n  // The parent would still need to figure out progress (for the total file set).\n  await fetch(presignedUrl, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': contentType,\n    },\n    body: file,\n  })\n}\nexport const startMultipartUpload = (\n  sessionToken: string | undefined,\n  fileName: string,\n  file: Blob,\n  request: MultipartUploadRequest,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n) => {\n  const url = 'file/v1/file/multipart'\n  doPost<MultipartUploadStatus>(\n    url,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then(async (status: MultipartUploadStatus) => {\n      // started the upload\n      // keep track of the part state client-side\n      const clientSidePartsState: boolean[] = status.partsState\n        .split('')\n        .map(bit => bit === '1')\n      status.clientSidePartsState = clientSidePartsState\n      for (let i = 0; i < clientSidePartsState.length; i = i + 1) {\n        if (!clientSidePartsState[i]) {\n          // upload this part.  note that partNumber is always the index+1\n          await processFilePart(\n            i + 1,\n            status,\n            sessionToken,\n            fileName,\n            file,\n            request,\n            fileUploadResolve,\n            fileUploadReject,\n          )\n        }\n      }\n      // in case there is no upload work to do!\n      checkUploadComplete(\n        status,\n        fileName,\n        sessionToken,\n        fileUploadResolve,\n        fileUploadReject,\n      )\n    })\n    .catch(error => {\n      fileUploadReject(error)\n    })\n}\n\n/**\n * Return the content of the file (latest version) associated to the given FileEntity.\n * Be aware that if the target file size > 5MB, this method will throw an error.\n * @param sessionToken\n * @param fileEntity\n * @param endpoint\n */\nexport const getFileEntityContent = (\n  sessionToken: string,\n  fileEntity: FileEntity,\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    const fileHandleAssociationList = [\n      {\n        associateObjectId: fileEntity.id,\n        associateObjectType: 'FileEntity',\n        fileHandleId: fileEntity.dataFileHandleId,\n      },\n    ]\n    const request: any = {\n      includeFileHandles: true,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    getFiles(request, sessionToken)\n      .then((data: BatchFileResult) => {\n        const presignedUrl: string = data.requestedFiles[0].preSignedURL!\n        const fileHandle: FileHandle = data.requestedFiles[0].fileHandle!\n        return getFileHandleContent(fileHandle, presignedUrl).then(\n          (content: string) => {\n            resolve(content)\n          },\n        )\n      })\n      .catch(err => {\n        reject(err)\n      })\n  })\n}\n\n/**\n * Return the FileHandle of the file associated to the given FileEntity.\n * * @param fileEntity: FileEntity\n * @param sessionToken\n * @param endpoint\n */\nexport const getFileEntityFileHandle = (\n  fileEntity: FileEntity,\n  sessionToken?: string,\n): Promise<FileHandle> => {\n  return new Promise((resolve, reject) => {\n    const fileHandleAssociationList: FileHandleAssociation[] = [\n      {\n        associateObjectId: fileEntity.id!,\n        associateObjectType: FileHandleAssociateType.FileEntity,\n        fileHandleId: fileEntity.dataFileHandleId,\n      },\n    ]\n    const request: BatchFileRequest = {\n      includeFileHandles: true,\n      includePreSignedURLs: false,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    getFiles(request, sessionToken)\n      .then((data: BatchFileResult) => {\n        if (\n          data.requestedFiles.length > 0 &&\n          data.requestedFiles[0].fileHandle\n        ) {\n          return resolve(data.requestedFiles[0].fileHandle)\n        } else {\n          // not found, or not allowed to access\n          reject(data.requestedFiles[0].failureCode)\n        }\n      })\n      .catch(err => {\n        reject(err)\n      })\n  })\n}\n\nexport const getFileHandleContentFromID = (\n  fileHandleId: string,\n  sessionToken: string,\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    // get the file handle and url\n    const getFileHandleByIdPromise = getFileHandleById(\n      fileHandleId,\n      sessionToken,\n    )\n    const getFileHandlePresignedUrlPromis = getFileHandleByIdURL(\n      fileHandleId,\n      sessionToken,\n    )\n    Promise.all([getFileHandleByIdPromise, getFileHandlePresignedUrlPromis])\n      .then(values => {\n        const fileHandle: FileHandle = values[0]\n        const presignedUrl: string = values[1]\n        return getFileHandleContent(fileHandle, presignedUrl).then(\n          (content: string) => {\n            resolve(content)\n          },\n        )\n      })\n      .catch(err => {\n        reject(err)\n      })\n  })\n}\n\nexport const getFileHandleContent = (\n  fileHandle: FileHandle,\n  presignedUrl: string,\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    // sanity check!  must be less than 5MB\n    if (fileHandle.contentSize < MAX_JS_FILE_DOWNLOAD_SIZE) {\n      fetch(presignedUrl, {\n        method: 'GET',\n        mode: 'cors',\n        cache: 'no-cache',\n        headers: {\n          'Content-Type': fileHandle.contentType,\n        },\n      }).then(response => {\n        // the response is always decoded using UTF-8\n        response.text().then(text => {\n          resolve(text)\n        })\n      })\n    } else {\n      reject('File size exceeds max (5MB)')\n    }\n  })\n}\n\n/**\n * Create an ACL\n * https://docs.synapse.org/rest/POST/entity/id/acl.html\n */\nexport const createACL = (\n  entityId: string,\n  acl: AccessControlList,\n  sessionToken: string | undefined,\n) => {\n  return doPost(\n    `/repo/v1/entity/${entityId}/acl`,\n    acl,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Submit an entity to an evaluation queue\n * https://docs.synapse.org/rest/POST/evaluation/submission.html\n */\nexport const submitToEvaluation = (\n  submission: Submission,\n  etag: string,\n  sessionToken: string | undefined,\n) => {\n  return doPost(\n    `/repo/v1/evaluation/submission?etag=${etag}`,\n    submission,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get an evaluation queue\n * https://docs.synapse.org/rest/GET/evaluation/evalId.html\n */\nexport const getEvaluation = (\n  evalId: string,\n  sessionToken: string | undefined,\n) => {\n  return doGet(\n    `/repo/v1/evaluation/${evalId}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Executes a user-defined query over the Submissions of a specific Evaluation.\n * https://docs.synapse.org/rest/GET/evaluation/submission/query.html\n */\nexport const getEvaluationSubmissions = (\n  query: string,\n  sessionToken: string | undefined,\n): Promise<QueryTableResults> => {\n  return doGet(\n    `/repo/v1/evaluation/submission/query?query=${encodeURI(query)}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get user-friendly OAuth2 request information (to present to the user so they can choose if they want to give consent).\n * http://rest-docs.synapse.org/rest/POST/oauth2/description.html\n */\nexport const getOAuth2RequestDescription = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n): Promise<OIDCAuthorizationRequestDescription> => {\n  return doPost(\n    '/auth/v1/oauth2/description',\n    oidcAuthRequest,\n    undefined, // sessionToken: this is not an authenticated call\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Check whether user has already granted consent for the given OAuth client, scope, and claims.\n * Consent persists for one year.\n */\nexport const hasUserAuthorizedOAuthClient = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n  sessionToken: string,\n): Promise<OAuthConsentGrantedResponse> => {\n  return doPost(\n    '/auth/v1/oauth2/consentcheck',\n    oidcAuthRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get OAuth2 Client information (available to the public)\n */\nexport const getOAuth2Client = (\n  clientId: string,\n): Promise<OAuthClientPublic> => {\n  return doGet(\n    `/auth/v1/oauth2/client/${clientId}`,\n    undefined,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * User consents to the given OIDCAuthorizationRequest (after being presented with all information returned by getOAuth2RequestDescription())\n * @param oidcAuthRequest\n * @param sessionToken\n * @param endpoint\n */\nexport const consentToOAuth2Request = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n  sessionToken: string | undefined,\n): Promise<AccessCodeResponse> => {\n  return doPost(\n    '/auth/v1/oauth2/consent',\n    oidcAuthRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/***********************\n * FORM SERVICES\n * https://docs.synapse.org/rest/#org.sagebionetworks.repo.web.controller.FormController\n *************************/\n/**\n * Create a FormGroup\n * https://docs.synapse.org/rest/POST/form/group.html\n * @param name\n * @param sessionToken\n * @param endpoint\n */\nexport const createFormGroup = (\n  name: string,\n  sessionToken: string,\n): Promise<FormGroup> => {\n  return doPost(\n    `/repo/v1/form/group?name=${encodeURI(name)}`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get FormGroup ACL\n * https://docs.synapse.org/rest/GET/form/group/id/acl.html\n */\nexport const getFormACL = (\n  formGroupId: string,\n  sessionToken: string | undefined,\n): Promise<AccessControlList> => {\n  return doGet(\n    `/repo/v1/form/group/${formGroupId}/acl`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Update FormGroup ACL\n * https://docs.synapse.org/rest/PUT/form/group/id/acl.html\n */\nexport const updateFormACL = (\n  formGroupId: string,\n  newAcl: AccessControlList,\n  sessionToken: string | undefined,\n): Promise<AccessControlList> => {\n  return doPut(\n    `/repo/v1/form/group/${formGroupId}/acl`,\n    newAcl,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Create a new FormData object\n * https://docs.synapse.org/rest/POST/form/data.html\n * @param formGroupId\n * @param name\n * @param sessionToken\n * @param endpoint\n */\nexport const createFormData = (\n  formGroupId: string,\n  name: string,\n  dataFileHandleId: string,\n  sessionToken: string,\n): Promise<FormData> => {\n  const newFormData: FormChangeRequest = {\n    name,\n    fileHandleId: dataFileHandleId,\n  }\n  return doPost(\n    `/repo/v1/form/data?groupId=${formGroupId}`,\n    newFormData,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Update FormData object\n * https://docs.synapse.org/rest/PUT/form/data.html\n */\nexport const updateFormData = (\n  formDataId: string,\n  name: string,\n  dataFileHandleId: string,\n  sessionToken: string,\n): Promise<FormData> => {\n  const updatedFormData: FormChangeRequest = {\n    name,\n    fileHandleId: dataFileHandleId,\n  }\n  return doPut(\n    `/repo/v1/form/data/${formDataId}`,\n    updatedFormData,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Delete FormData object\n * https://docs.synapse.org/rest/DELETE/form/data.html\n */\nexport const deleteFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n) => {\n  return doDelete(\n    `/repo/v1/form/data/${formDataId}`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Submit the identified FormData for review.\n * https://docs.synapse.org/rest/POST/form/data/id/submit.html\n */\nexport const submitFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n): Promise<FormData> => {\n  return doPost(\n    `/repo/v1/form/data/${formDataId}/submit`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * List FormData objects and their associated status that match the filters of the provided request that are\n * owned by the caller. Note: Only objects owned by the caller will be returned.\n * https://docs.synapse.org/rest/POST/form/data/list.html\n */\nexport const listFormData = (\n  request: ListRequest,\n  sessionToken: string | undefined,\n): Promise<ListResponse> => {\n  return doPost(\n    `/repo/v1/form/data/list`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * List FormData objects and their associated status that match the filters of the provided request for the entire\n * group. This is used by service accounts to process submissions.\n * https://docs.synapse.org/rest/POST/form/data/list/reviewer.html\n */\nexport const listFormDataAsFormAdmin = (\n  request: ListRequest,\n  sessionToken: string | undefined,\n): Promise<ListResponse> => {\n  return doPost(\n    `/repo/v1/form/data/list/reviewer`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Called by the form processing service to accept a submitted data.\n * https://docs.synapse.org/rest/PUT/form/data/id/accept.html\n */\nexport const acceptFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n): Promise<FormData> => {\n  return doPut(\n    `/repo/v1/form/data/${formDataId}/accept`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Called by the form processing service to reject a submitted data.\n * https://docs.synapse.org/rest/PUT/form/data/id/reject.html\n */\nexport const rejectFormData = (\n  formDataId: string,\n  reason: string,\n  sessionToken: string | undefined,\n): Promise<FormData> => {\n  const formRejection: FormRejection = {\n    reason,\n  }\n  return doPut(\n    `/repo/v1/form/data/${formDataId}/reject`,\n    formRejection,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get Statistics\n * https://docs.synapse.org/rest/POST/statistics.html\n * Generic endpoint to retrieve statistics about objects. The user should have VIEW_STATISTICS access on the object referenced by the objectId in the request.\n */\nexport const getProjectStatistics = (\n  request: ProjectFilesStatisticsRequest,\n  sessionToken: string | undefined,\n): Promise<ProjectFilesStatisticsResponse> => {\n  return doPost(\n    `/repo/v1/statistics`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n// see https://docs.synapse.org/rest/POST/restrictionInformation.html\nexport const getRestrictionInformation = (\n  request: RestrictionInformationRequest,\n  sessionToken: string | undefined,\n): Promise<RestrictionInformationResponse> => {\n  return doPost(\n    `/repo/v1/restrictionInformation`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Returns a paginated result of access requirements associated for an entity\n *\n * See https://rest-docs.synapse.org/rest/GET/entity/id/accessRequirement.html\n *\n * @param {(string | undefined)} sessionToken token of user\n * @param {string} id id of entity\n * @param {number} [limit=50]\n * @param {number} [offset=0]\n * @returns {Promise<PaginatedResults<AccessRequirement>>}\n */\nexport const getAccessRequirement = (\n  sessionToken: string | undefined,\n  id: string,\n  limit: number = 50,\n  offset: number = 0,\n): Promise<PaginatedResults<AccessRequirement>> => {\n  const url = `/repo/v1/entity/${id}/accessRequirement?limit=${limit}&offset=${offset}`\n  return doGet<PaginatedResults<AccessRequirement>>(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Retrieve an access requirement status for a given access requirement ID.\n *\n * @param {string} requirementId id of entity to lookup\n * @returns {AccessRequirementStatus}\n */\n\nexport const getAccessRequirementStatus = (\n  sessionToken: string | undefined,\n  requirementId: string | number,\n): Promise<AccessRequirementStatus> => {\n  const url = `repo/v1/accessRequirement/${requirementId}/status`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Returns all the access requirements associated to an entity {id}, calling the\n * paginated getAccessRequirement service until all results are returned.\n *\n * @param {(string | undefined)} sessionToken token of user\n * @param {string} id id of entity to lookup\n * @returns {Promise<Array<AccessRequirement>>}\n */\nexport const getAllAccessRequirements = (\n  sessionToken: string | undefined,\n  id: string,\n): Promise<Array<AccessRequirement>> => {\n  // format function to be callable by getAllOfPaginatedService\n  const fn = (limit: number, offset: number) => {\n    const url = `/repo/v1/entity/${id}/accessRequirement?limit=${limit}&offset=${offset}`\n    return doGet<PaginatedResults<AccessRequirement>>(\n      url,\n      sessionToken,\n      undefined,\n      BackendDestinationEnum.REPO_ENDPOINT,\n    )\n  }\n  return getAllOfPaginatedService(fn)\n}\n\n/**\n *\n *\n * @param {(string | undefined)} sessionToken user session token\n * @param {(number | undefined)} id the unique immutable ID\n * @returns {AccessApproval}\n */\nexport const getAccessApproval = async (\n  sessionToken: string | undefined,\n  approvalId: number | undefined,\n): Promise<AccessApproval> => {\n  const url = `repo/v1/accessApproval/${approvalId}`\n  return doGet<AccessApproval>(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n *\n *\n * @param {(string | undefined)} sessionToken user session token\n * @param {AccessApproval} accessApproval access approval request object\n * @returns {AccessApproval}\n */\nexport const postAccessApproval = async (\n  sessionToken: string | undefined,\n  accessApproval: AccessApproval,\n): Promise<AccessApproval> => {\n  return doPost<AccessApproval>(\n    'repo/v1/accessApproval',\n    accessApproval,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n// https://rest-docs.synapse.org/rest/GET/download/list.html\nexport const getDownloadList = (sessionToken: string | undefined) => {\n  return doGet<DownloadList>(\n    '/file/v1/download/list',\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getDownloadOrder = (\n  zipFileName: string | undefined,\n  sessionToken: string | undefined,\n): Promise<DownloadOrder> => {\n  const baseURL = '/file/v1/download/order'\n  const url = zipFileName ? `${baseURL}?zipFileName=${zipFileName}` : baseURL\n  return doPost(\n    url,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport type FunctionReturningPaginatedResults<T> = (\n  limit: number,\n  offset: number,\n) => Promise<PaginatedResults<T>>\n/**\n * Utility function to get all the results of a paginated service\n *\n * @template T Type of paginated service\n * @param {FunctionReturningPaginatedResults<T>} fn Function that returns a paginated synapse object, accepts a limit and offset\n * @returns\n */\nexport const getAllOfPaginatedService = async <T>(\n  fn: FunctionReturningPaginatedResults<T>,\n) => {\n  const limit = 50\n  let offset = 0\n  let existsMoreData = true\n  const results: T[] = []\n\n  while (existsMoreData) {\n    try {\n      const data = await fn(limit, offset)\n      results.push(...data.results)\n      offset += data.results.length\n      if (data.results.length < limit) {\n        existsMoreData = false\n      }\n    } catch (e) {\n      throw Error(`Error on getting paginated results ${e}`)\n    }\n  }\n\n  return results\n}\n\n// https://rest-docs.synapse.org/rest/POST/download/list/remove.html\nexport const deleteDownloadListFiles = (\n  list: FileHandleAssociation[],\n  sessionToken: string | undefined,\n): Promise<DownloadList> => {\n  return doPost<DownloadList>(\n    '/file/v1/download/list/remove',\n    { list },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ).then(data => {\n    dispatchDownloadListChangeEvent(data)\n    return data\n  })\n}\n\n// https://rest-docs.synapse.org/rest/DELETE/download/list.html ?\nexport const deleteDownloadList = (sessionToken: string | undefined) => {\n  return doDelete(\n    '/file/v1/download/list',\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ).then(_ => {\n    dispatchDownloadListChangeEvent(undefined)\n  })\n}\n\n/**\n * http://rest-docs.synapse.org/rest/POST/entity/id/table/transaction/async/start.html\n * @param {*} tableUpdateRequest\n * @param {*} sessionToken\n * @param {*} endpoint\n * // technically returns a TableUpdateTransactionResponse, but I don't see any reason we need this\n */\nexport const updateTable = (\n  tableUpdateRequest: TableUpdateTransactionRequest,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n): Promise<any> => {\n  return doPost<AsyncJobId>(\n    `/repo/v1/entity/${tableUpdateRequest.entityId}/table/transaction/async/start`,\n    tableUpdateRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then(resp => {\n      return getAsyncResultFromJobId<any>(\n        `/repo/v1/entity/${tableUpdateRequest.entityId}/table/transaction/async/get/${resp.token}`,\n        sessionToken,\n        updateParentState,\n      )\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n\nexport const getTransformSqlWithFacetsRequest = (\n  transformSqlWithFacetsRequest: TransformSqlWithFacetsRequest,\n) => {\n  return doPost<SqlTransformResponse>(\n    '/repo/v1/table/sql/transform',\n    transformSqlWithFacetsRequest,\n    undefined, // no auth needed\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n","import * as React from 'react'\nimport ButtonContent from '../assets/ButtonContent'\nimport GoogleIcon from '../assets/GoogleIcon'\nimport { SynapseClient } from '../utils'\nimport {\n  getEndpoint,\n  BackendDestinationEnum,\n} from '../utils/functions/getEndpoint'\n\ntype State = {\n  username: string\n  password: string\n  email: string\n  isSignedIn: boolean\n  hasLoginInFailed: boolean\n  errorMessage: string\n}\n\ntype Props = {\n  theme: string\n  icon: boolean\n  googleRedirectUrl?: string\n  redirectUrl?: string // will redirect here after a successful login. if unset, reload the current page url.\n  sessionCallback: Function // Callback is invoked after login\n}\n\n/**\n *  Demo of user session, show login screen and handling user login submission.\n *\n *  To support Google SSO in your portal, you must add your domain to the Authorized Redirect URIs\n *  for Synapse authentication.\n *  This can be done by contacting synapseInfo@sagebionetworks.org to form a collaboration.\n *  Synapse engineers must add your redirect URL in the Google API console found at https://console.cloud.google.com/ for this functionality to work.\n *\n * @class Login\n * @extends {React.Component}\n */\nclass Login extends React.Component<Props, State> {\n  authenticationReceiptKey = 'last_user_authentication_receipt'\n\n  /**\n   * Creates a user session, maintaining credentials\n   * @param {*} props\n   * @memberof Login\n   */\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      email: '',\n      errorMessage: '',\n      hasLoginInFailed: false,\n      isSignedIn: false,\n      password: '',\n      username: '',\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.handleLogin = this.handleLogin.bind(this)\n    this.getLoginFailureView = this.getLoginFailureView.bind(this)\n    this.onGoogleSignIn = this.onGoogleSignIn.bind(this)\n  }\n  /**\n   * Updates internal state with the event that was triggered\n   *\n   * @param {*} event Form update\n   */\n  public handleChange(event: React.FormEvent<HTMLInputElement>): void {\n    const target = event.currentTarget\n    const name = target.name\n    const value = target.value\n    const newState: Pick<any, any> = { [name]: value }\n    this.setState(newState)\n  }\n  /**\n   * Handle user login on click\n   *\n   * @param {*} clickEvent Userclick event\n   */\n  public async handleLogin(clickEvent: React.FormEvent<HTMLElement>) {\n    clickEvent.preventDefault() // avoid page refresh\n    try {\n      // get last valid receipt\n      const authenticationReceipt = localStorage.getItem(\n        this.authenticationReceiptKey,\n      )\n      const data = await SynapseClient.login(\n        this.state.username,\n        this.state.password,\n        authenticationReceipt,\n      )\n      // now get session token from cookie has to be called in the portals repo\n      await SynapseClient.setSessionTokenCookie(\n        data.sessionToken,\n        this.props.sessionCallback,\n      )\n      // Set the new receipt\n      localStorage.setItem(\n        this.authenticationReceiptKey,\n        data.authenticationReceipt,\n      )\n    } catch (err) {\n      console.log('Error on login: ', err.reason)\n      this.setState({\n        errorMessage: err.reason,\n        hasLoginInFailed: true,\n        isSignedIn: false,\n      })\n    }\n  }\n\n  /**\n   * Shows user login failure view on login failure\n   *\n   * @returns view to be displayed on user sign in error.\n   */\n  public getLoginFailureView(): JSX.Element | boolean {\n    if (this.state.hasLoginInFailed) {\n      return (\n        <div>\n          <small className=\"form-text text-danger\">\n            {this.state.errorMessage}\n          </small>\n          <div className=\"invalid-feedback\" />\n        </div>\n      )\n    }\n    return false\n  }\n\n  public onGoogleSignIn(event: React.MouseEvent<HTMLButtonElement>) {\n    // save current route (so that we can go back here after SSO)\n    localStorage.setItem('after-sso-login-url', window.location.href)\n    event.preventDefault()\n    const redirectUrl = this.props.googleRedirectUrl\n      ? this.props.googleRedirectUrl\n      : `${SynapseClient.getRootURL()}?provider=${SynapseClient.AUTH_PROVIDER}`\n    SynapseClient.oAuthUrlRequest(SynapseClient.AUTH_PROVIDER, redirectUrl)\n      .then((data: any) => {\n        const authUrl = data.authorizationUrl\n        window.location = authUrl // ping the url\n      })\n      .catch((err: any) => {\n        console.log('Error on oAuth url ', err)\n      })\n  }\n  public render() {\n    const { theme, icon } = this.props\n    const googleTheme =\n      theme === 'dark'\n        ? 'SRC-google-button-dark-color'\n        : 'SRC-google-button-light-color'\n    return (\n      <div\n        id=\"loginPage\"\n        className=\"container loginContainer SRC-syn-border-spacing\"\n      >\n        <form>\n          <button\n            onClick={this.onGoogleSignIn}\n            className={`SRC-google-button ${googleTheme} SRC-marginBottomTen`}\n          >\n            <GoogleIcon key={1} active={true} />\n            <ButtonContent icon={icon} key={2}>\n              Sign in with Google\n            </ButtonContent>\n          </button>\n        </form>\n        <div className=\"SRC-center-text SRC-deemphasized-text SRC-marginBottomTen\">\n          or\n        </div>\n\n        <div className=\"SRC-centerAndJustifyContent SRC-marginBottomTen\">\n          <img\n            height=\"20px\"\n            style={{ marginRight: '10px' }}\n            alt={'sage bionetworks logo'}\n            src=\"https://s3.amazonaws.com/static.synapse.org/sage-bionetworks-logo.svg\"\n          />\n          Sign in with your Sage Bionetworks Synapse account\n        </div>\n        <form onSubmit={this.handleLogin} className=\"form-group\">\n          <input\n            autoComplete=\"username\"\n            placeholder=\"username or email\"\n            className=\"form-control SRC-marginBottomTop\"\n            id=\"exampleEmail\"\n            name=\"username\"\n            type=\"text\"\n            value={this.state.username}\n            onChange={this.handleChange}\n          />\n          <input\n            autoComplete=\"password\"\n            placeholder=\"password\"\n            className=\"form-control SRC-marginBottomTop\"\n            id=\"examplePassword\"\n            name=\"password\"\n            type=\"password\"\n            value={this.state.password}\n            onChange={this.handleChange}\n          />\n          {this.getLoginFailureView()}\n          <button\n            onSubmit={this.handleLogin}\n            type=\"submit\"\n            className=\"btn SRC-primary-background-color SRC-hoverWhiteText\n              SRC-whiteText m-1 SRC-google-button SRC-marginBottomTen\"\n          >\n            <ButtonContent icon={icon}>Sign in</ButtonContent>\n          </button>\n        </form>\n        <div>\n          <a\n            href={`${getEndpoint(\n              BackendDestinationEnum.PORTAL_ENDPOINT,\n            )}#!PasswordReset:0`}\n            className=\"SRC-floatLeft SRC-primary-text-color\"\n          >\n            Forgot password?\n          </a>\n          <span className=\"SRC-deemphasized-text SRC-floatRight\">\n            &nbsp;It's free!\n          </span>\n          <a\n            href={`${getEndpoint(\n              BackendDestinationEnum.PORTAL_ENDPOINT,\n            )}#!RegisterAccount:0`}\n            className=\"SRC-floatRight SRC-primary-text-color\"\n          >\n            Register\n          </a>\n        </div>\n      </div>\n    )\n  }\n}\nexport default Login\n","const COLOR_PALETTE_EVEN: string[] = [\n  'rgb(91,176,181)',\n  'rgb(124,192,196)',\n  'rgb(157,208,211)',\n  'rgb(189,223,225)',\n  'rgb(222,239,240)',\n  'rgb(217,229,236)',\n  'rgb(179,202,217)',\n  'rgb(140,176,198)',\n  'rgb(102,149,179)',\n  'rgb(64,123,160)',\n  'rgb(201,66,129)',\n  'rgb(212,104,154)',\n  'rgb(223,142,179)',\n  'rgb(233,179,205)',\n  'rgb(244,217,230)',\n  'rgb(218,214,229)',\n  'rgb(181,173,203)',\n  'rgb(145,133,177)',\n  'rgb(108,92,151)',\n  'rgb(71,51,125)',\n  'rgb(222,154,31)',\n  'rgb(229,174,76)',\n  'rgb(235,194,121)',\n  'rgb(242,215,165)',\n  'rgb(248,235,210)',\n  'rgb(207,234,231)',\n  'rgb(159,212,207)',\n  'rgb(112,191,184)',\n  'rgb(64,169,160)',\n  'rgb(16,148,136)',\n  'rgb(60,74,99)',\n  'rgb(99,110,130)',\n  'rgb(138,146,161)',\n  'rgb(177,183,193)',\n  'rgb(216,219,224)',\n  'rgb(246,226,210)',\n  'rgb(238,197,165)',\n  'rgb(229,167,120)',\n  'rgb(221,138,75)',\n  'rgb(212,109,30)',\n  'rgb(88,161,88)',\n  'rgb(121,180,121)',\n  'rgb(155,199,155)',\n  'rgb(188,217,188)',\n  'rgb(222,236,222)',\n  'rgb(220,227,242)',\n  'rgb(185,198,230)',\n  'rgb(151,170,217)',\n  'rgb(116,141,205)',\n  'rgb(81,113,192)',\n  'rgb(178,36,42)',\n  'rgb(193,80,85)',\n  'rgb(209,124,127)',\n  'rgb(224,167,170)',\n  'rgb(240,211,212)',\n  'rgb(222,239,240)',\n  'rgb(189,223,225)',\n  'rgb(157,208,211)',\n  'rgb(124,192,196)',\n  'rgb(91,176,181)',\n  'rgb(64,123,160)',\n  'rgb(102,149,179)',\n  'rgb(140,176,198)',\n  'rgb(179,202,217)',\n  'rgb(217,229,236)',\n  'rgb(244,217,230)',\n  'rgb(233,179,205)',\n  'rgb(223,142,179)',\n  'rgb(212,104,154)',\n  'rgb(201,66,129)',\n  'rgb(71,51,125)',\n  'rgb(108,92,151)',\n  'rgb(145,133,177)',\n  'rgb(181,173,203)',\n  'rgb(218,214,229)',\n  'rgb(248,235,210)',\n  'rgb(242,215,165)',\n  'rgb(235,194,121)',\n  'rgb(229,174,76)',\n  'rgb(222,154,31)',\n  'rgb(16,148,136)',\n  'rgb(64,169,160)',\n  'rgb(112,191,184)',\n  'rgb(159,212,207)',\n  'rgb(207,234,231)',\n  'rgb(216,219,224)',\n  'rgb(177,183,193)',\n  'rgb(138,146,161)',\n  'rgb(99,110,130)',\n  'rgb(60,74,99)',\n  'rgb(212,109,30)',\n  'rgb(221,138,75)',\n  'rgb(229,167,120)',\n  'rgb(238,197,165)',\n  'rgb(246,226,210)',\n  'rgb(222,236,222)',\n  'rgb(188,217,188)',\n  'rgb(155,199,155)',\n  'rgb(121,180,121)',\n  'rgb(88,161,88)',\n  'rgb(81,113,192)',\n  'rgb(116,141,205)',\n  'rgb(151,170,217)',\n  'rgb(185,198,230)',\n  'rgb(220,227,242)',\n  'rgb(240,211,212)',\n  'rgb(224,167,170)',\n  'rgb(209,124,127)',\n  'rgb(193,80,85)',\n  'rgb(178,36,42)',\n]\n\nconst COLOR_PALETTE_ODD: string[] = [\n  'rgb(64,123,160)',\n  'rgb(102,149,179)',\n  'rgb(140,176,198)',\n  'rgb(179,202,217)',\n  'rgb(217,229,236)',\n  'rgb(244,217,230)',\n  'rgb(233,179,205)',\n  'rgb(223,142,179)',\n  'rgb(212,104,154)',\n  'rgb(201,66,129)',\n  'rgb(71,51,125)',\n  'rgb(108,92,151)',\n  'rgb(145,133,177)',\n  'rgb(181,173,203)',\n  'rgb(218,214,229)',\n  'rgb(248,235,210)',\n  'rgb(242,215,165)',\n  'rgb(235,194,121)',\n  'rgb(229,174,76)',\n  'rgb(222,154,31)',\n  'rgb(16,148,136)',\n  'rgb(64,169,160)',\n  'rgb(112,191,184)',\n  'rgb(159,212,207)',\n  'rgb(207,234,231)',\n  'rgb(216,219,224)',\n  'rgb(177,183,193)',\n  'rgb(138,146,161)',\n  'rgb(99,110,130)',\n  'rgb(60,74,99)',\n  'rgb(212,109,30)',\n  'rgb(221,138,75)',\n  'rgb(229,167,120)',\n  'rgb(238,197,165)',\n  'rgb(246,226,210)',\n  'rgb(222,236,222)',\n  'rgb(188,217,188)',\n  'rgb(155,199,155)',\n  'rgb(121,180,121)',\n  'rgb(88,161,88)',\n  'rgb(81,113,192)',\n  'rgb(116,141,205)',\n  'rgb(151,170,217)',\n  'rgb(185,198,230)',\n  'rgb(220,227,242)',\n  'rgb(240,211,212)',\n  'rgb(224,167,170)',\n  'rgb(209,124,127)',\n  'rgb(193,80,85)',\n  'rgb(178,36,42)',\n  'rgb(91,176,181)',\n  'rgb(124,192,196)',\n  'rgb(157,208,211)',\n  'rgb(189,223,225)',\n  'rgb(222,239,240)',\n  'rgb(217,229,236)',\n  'rgb(179,202,217)',\n  'rgb(140,176,198)',\n  'rgb(102,149,179)',\n  'rgb(64,123,160)',\n  'rgb(201,66,129)',\n  'rgb(212,104,154)',\n  'rgb(223,142,179)',\n  'rgb(233,179,205)',\n  'rgb(244,217,230)',\n  'rgb(218,214,229)',\n  'rgb(181,173,203)',\n  'rgb(145,133,177)',\n  'rgb(108,92,151)',\n  'rgb(71,51,125)',\n  'rgb(222,154,31)',\n  'rgb(229,174,76)',\n  'rgb(235,194,121)',\n  'rgb(242,215,165)',\n  'rgb(248,235,210)',\n  'rgb(207,234,231)',\n  'rgb(159,212,207)',\n  'rgb(112,191,184)',\n  'rgb(64,169,160)',\n  'rgb(16,148,136)',\n  'rgb(60,74,99)',\n  'rgb(99,110,130)',\n  'rgb(138,146,161)',\n  'rgb(177,183,193)',\n  'rgb(216,219,224)',\n  'rgb(246,226,210)',\n  'rgb(238,197,165)',\n  'rgb(229,167,120)',\n  'rgb(221,138,75)',\n  'rgb(212,109,30)',\n  'rgb(88,161,88)',\n  'rgb(121,180,121)',\n  'rgb(155,199,155)',\n  'rgb(188,217,188)',\n  'rgb(222,236,222)',\n  'rgb(220,227,242)',\n  'rgb(185,198,230)',\n  'rgb(151,170,217)',\n  'rgb(116,141,205)',\n  'rgb(81,113,192)',\n  'rgb(178,36,42)',\n  'rgb(193,80,85)',\n  'rgb(209,124,127)',\n  'rgb(224,167,170)',\n  'rgb(240,211,212)',\n  'rgb(222,239,240)',\n  'rgb(189,223,225)',\n  'rgb(157,208,211)',\n  'rgb(124,192,196)',\n  'rgb(91,176,181)',\n]\n\nexport { COLOR_PALETTE_EVEN, COLOR_PALETTE_ODD }\n","import {\n  COLOR_PALETTE_EVEN,\n  COLOR_PALETTE_ODD,\n} from '../utils/functions/colorPalette'\n\nexport function rgba2rgb(background: number[], color: number[]) {\n  const alpha = color[3]\n  return [\n    Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5),\n    Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5),\n    Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5),\n  ]\n}\n\nexport function getColorPallette(\n  start: number,\n  end: number,\n): { colorPalette: string[]; textColors: string[] } {\n  let colorPalleteSelection = []\n  const textColors = []\n  let offset = -1\n\n  if (start % 2 === 0) {\n    colorPalleteSelection = COLOR_PALETTE_EVEN\n    offset = start * 5\n  } else {\n    colorPalleteSelection = COLOR_PALETTE_ODD\n    offset = (start - 1) * 5\n  }\n\n  const colorPalette: string[] = []\n\n  for (let i = 0; i < end; i += 1) {\n    const textColor: string = i % 10 < 2 || i % 10 > 7 ? 'white' : 'black'\n    const color: string = `${\n      colorPalleteSelection[(offset + i) % colorPalleteSelection.length]\n    }`\n    colorPalette.push(color)\n    textColors.push(textColor)\n  }\n  return { colorPalette, textColors }\n}\n\nexport default getColorPallette\n","import { FacetSelection } from '../../containers/QueryWrapper'\nimport { QueryBundleRequest } from '../synapseTypes/'\nimport { FacetColumnValuesRequest } from '../synapseTypes/'\nimport { SELECT_SINGLE_FACET } from '../../containers/Facets'\nimport { FacetColumnResultValueCount } from '../synapseTypes/'\n\n/*\n  TODO: This code is deprecated, delete once stackedbarchart.tsx and facets.tsx are no longer used\n*/\n\n/**\n *  Calculates the state of a specific facet value given the current state\n *  of the application.\n *\n * @param\n *     isLoading: boolean | undefined,\n *     lastFacetSelection: FacetSelection | undefined,\n *     curFacetSelection: any,\n *     columnName: string\n * @returns boolean\n */\n\nexport const getIsValueSelected = ({\n  isLoading,\n  lastFacetSelection,\n  curFacetSelection,\n  columnName,\n}: {\n  isLoading: boolean | undefined\n  lastFacetSelection: FacetSelection | undefined\n  curFacetSelection: FacetColumnResultValueCount\n  columnName: string\n}) => {\n  if (isLoading && columnName === lastFacetSelection!.columnName) {\n    // indicates there is a selection made with this current facet value\n    if (lastFacetSelection!.facetValue === curFacetSelection.value) {\n      return !curFacetSelection.isSelected\n    }\n    if (lastFacetSelection!.selector === SELECT_SINGLE_FACET) {\n      return false\n    }\n  }\n  /*\n    else, the information has come back from the server and we can\n    rely on that\n  */\n  return curFacetSelection.isSelected\n}\n\nexport type SyntheticHTMLInputElement = {\n  value: string\n  checked: boolean\n}\n\n/**\n * Function reads over a set of checkboxes and then returns a corresponding\n * queryRequest given the state of the prior queryRequest\n *   htmlCheckboxes: any,\n *   selector : string,\n *   queryRequest: QueryBundleRequest,\n *   facet: string,\n *   value?: string\n * }\n * @returns\n */\nexport const readFacetValues = ({\n  htmlCheckboxes,\n  selector,\n  queryRequest,\n  facet,\n  value,\n}: {\n  htmlCheckboxes: SyntheticHTMLInputElement[]\n  selector: string\n  queryRequest: QueryBundleRequest\n  facet: string\n  value?: string\n}) => {\n  const facetValues: string[] = []\n\n  if (!selector) {\n    // no selector was clicked -- read over facet values as normal and see what was clicked\n    for (let i = 0; i < htmlCheckboxes.length; i += 1) {\n      const checkbox = htmlCheckboxes[i]\n      const isSelected = checkbox.checked\n      if (isSelected) {\n        facetValues.push(checkbox.value)\n      }\n    }\n  } else if (selector === SELECT_SINGLE_FACET) {\n    // SELECT_SINGLE_FACET acts as a radio selection, thats the only selection\n    facetValues.push(value!)\n  } // else selector === SELECT_ALL, we don't add any values, empty is treated as SELECT_ALL\n  const newQueryRequest: QueryBundleRequest = queryRequest\n  const { selectedFacets = [] } = newQueryRequest.query\n\n  const specificFacet = selectedFacets!.find(el => el.columnName === facet)!\n  if (!specificFacet) {\n    const facetColumnValuesRequest: FacetColumnValuesRequest = {\n      facetValues,\n      concreteType:\n        'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n      columnName: facet,\n    }\n    selectedFacets.push(facetColumnValuesRequest)\n    // align the reference to selectedFacets\n    newQueryRequest.query.selectedFacets = selectedFacets\n  } else {\n    specificFacet.facetValues = facetValues\n  }\n\n  return { newQueryRequest }\n}\n","export const TOOLTIP_DELAY_SHOW = 500\nexport const SELECT_ALL = 'SELECT_ALL';\nexport const DESELECT_ALL = 'DESELECT_ALL';\nexport const DOWNLOAD_FILES_MENU_TEXT = 'Download Files'; // double check these icons!\nexport const ICON_STATE: string[] = ['sortdown', 'sortdown', 'sortup'];\n  ","import { SynapseClient } from '..'\nimport { UserProfile, FileHandleAssociateType } from '../synapseTypes/'\n\n/*\n  Utility functions for UserCards\n*/\n\nfunction getUserProfileWithProfilePicAttached(\n  principalIds: string[],\n  token?: string,\n) {\n  return SynapseClient.getUserProfiles(principalIds).then((data) => {\n    // people will either have a profile pic file handle id\n    // or they won't. Have to break this down into two groups.\n    const withProfilePic = data.list.filter((value: any) => {\n      return value.profilePicureFileHandleId !== undefined\n    })\n    if (withProfilePic.length === 0) {\n      return data\n    }\n    const fileHandleAssociationList = withProfilePic.map((value) => {\n      return {\n        associateObjectId: value.ownerId,\n        associateObjectType: 'UserProfileAttachment',\n        fileHandleId: value.profilePicureFileHandleId,\n      }\n    })\n    const request: any = {\n      includeFileHandles: false,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    return SynapseClient.getFiles(request, token)\n      .then((fileHandleList) => {\n        // we retrieve all the persons with profile pic file handles\n        // so we next loop through them, find the original person in the data.list\n        // and add a field with their pre-signed url\n        fileHandleList.requestedFiles.forEach((fileHandle) => {\n          const matchingPersonIndex = data.list.findIndex((el) => {\n            return fileHandle.fileHandleId === el.profilePicureFileHandleId\n          })\n          data.list[matchingPersonIndex].clientPreSignedURL =\n            fileHandle.preSignedURL\n        })\n        return Promise.resolve(data)\n      })\n      .catch((err) => {\n        throw Error(`Err on getting user data ${err}`)\n      })\n  })\n}\n\ntype UserProfileAndImg = {\n  userProfile: UserProfile\n  preSignedURL: string\n}\nfunction getUserProfileWithProfilePic(\n  ownerId: string,\n  token?: string,\n): Promise<UserProfileAndImg> {\n  return SynapseClient.getUserProfileById(token, ownerId).then(\n    (userProfile: UserProfile) => {\n      // people will either have a profile pic file handle id\n      // or they won't. Have to break this down into two groups.\n      if (!userProfile.profilePicureFileHandleId) {\n        return Promise.resolve({ userProfile }) as any\n      }\n\n      const fileHandleAssociationList = [\n        {\n          associateObjectId: ownerId,\n          associateObjectType: FileHandleAssociateType.UserProfileAttachment,\n          fileHandleId: userProfile.profilePicureFileHandleId,\n        },\n      ]\n\n      const request = {\n        includeFileHandles: false,\n        includePreSignedURLs: true,\n        includePreviewPreSignedURLs: false,\n        requestedFiles: fileHandleAssociationList,\n      }\n\n      return SynapseClient.getFiles(request, token)\n        .then((fileHandleList) => {\n          // we retrieve all the persons with profile pic file handles\n          // so we next loop through them, find the original person in the data.list\n          // and add a field with their pre-signed url\n          const firstElement = fileHandleList.requestedFiles[0]\n          return Promise.resolve({\n            userProfile,\n            preSignedURL: firstElement.preSignedURL,\n          })\n        })\n        .catch((err) => {\n          console.log({ err })\n        })\n    },\n  )\n}\n\nconst COLORS: string[] = [\n  'chocolate',\n  'black',\n  'firebrick',\n  'maroon',\n  'olive',\n  'green',\n  'forestgreen',\n  'darkturquoise',\n  'teal',\n  'blue',\n  'navy',\n  'darkmagenta',\n  'purple',\n  'blue',\n  'orangered',\n  'blueviolet',\n]\n\nconst hash = (userName: string) => {\n  const val = userName\n    .split('')\n    .reduce(\n      (prevHash, currVal) =>\n        ((prevHash << 5) - prevHash + currVal.charCodeAt(0)) | 0,\n      0,\n    )\n  return Math.abs(val)\n}\n\nconst getColor = (userName: string) => {\n  const hashedUserName = hash(userName)\n  return COLORS[hashedUserName % COLORS.length]\n}\n\nexport {\n  getUserProfileWithProfilePicAttached,\n  getColor,\n  getUserProfileWithProfilePic,\n}\nexport default {\n  getUserProfileWithProfilePicAttached,\n  getColor,\n  getUserProfileWithProfilePic,\n}\n","import * as React from 'react'\n// ignore because this is rollup requiring imports be named a certain way\n// tslint:disable-next-line\nimport ReactTooltip from 'react-tooltip'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faCircle } from '@fortawesome/free-solid-svg-icons'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport { getColor } from '../utils/functions/getUserData'\n\nlibrary.add(faCircle)\n\nexport type UserCardSmallProps = {\n  userProfile: UserProfile\n  preSignedURL?: string\n  hideText?: boolean\n  hideTooltip?: boolean\n  link?: string\n  extraSmall?: boolean\n}\n\nexport const UserCardSmall: React.FunctionComponent<UserCardSmallProps> = ({\n  userProfile,\n  hideText = false,\n  hideTooltip = false,\n  preSignedURL,\n  link,\n  extraSmall = false,\n}) => {\n  const linkLocation = link\n    ? link\n    : `https://www.synapse.org/#!Profile:${userProfile.ownerId}`\n  let img\n  let marginLeft\n  let label = ''\n  if (!hideTooltip) {\n    if (userProfile.displayName) {\n      label += userProfile.displayName\n    } else if (userProfile.firstName && userProfile.lastName) {\n      label += `${userProfile.firstName} ${userProfile.lastName}`\n    }\n    if (userProfile.userName) {\n      label += ` (${userProfile.userName})`\n    }\n    if (userProfile.position) {\n      label += ` <br/>${userProfile.position}`\n    }\n    if (userProfile.location) {\n      label += ` <br/>${userProfile.location}`\n    }\n  }\n\n  const imgClassName = `SRC-userImgSmall ${extraSmall ? 'extraSmall' : ''} ${\n    preSignedURL ? '' : 'SRC-centerContentInline'\n  } `\n  if (preSignedURL) {\n    marginLeft = '3px'\n    img = (\n      <div\n        className={imgClassName}\n        style={{ backgroundImage: `url(${preSignedURL})` }}\n        data-for={label}\n        data-tip={label}\n      />\n    )\n  } else {\n    const color = getColor(userProfile.userName)\n    marginLeft = '3px'\n    img = (\n      <div style={{ background: color }} className={imgClassName}>\n        {(userProfile.firstName && userProfile.firstName[0]) ||\n          userProfile.userName[0]}\n      </div>\n    )\n  }\n  return (\n    <a\n      href={linkLocation}\n      className={\n        'SRC-userCard UserCardSmall SRC-primary-text-color SRC-no-underline-on-hover '\n      }\n    >\n      {img}\n      <ReactTooltip delayShow={1000} id={label} multiline={true} />\n      {!hideText && (\n        <span\n          className=\"SRC-primary-text-color SRC-underline-on-hover\"\n          style={{ marginLeft, whiteSpace: 'nowrap' }}\n        >{`@${userProfile.userName}`}</span>\n      )}\n    </a>\n  )\n}\n","import * as React from 'react'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport { SEPERATOR } from '../utils/SynapseConstants'\n\nexport type MenuAction = {\n  field: string\n  callback?: (userProfile: UserProfile) => void\n}\n\nexport type UserCardContextMenuProps = {\n  userProfile: UserProfile\n  menuActions: MenuAction[]\n}\n\nconst UserCardContextMenu: React.SFC<UserCardContextMenuProps> = (\n  props: UserCardContextMenuProps,\n) => {\n  const { menuActions = [], userProfile } = props\n  return (\n    <div className=\"dropdown open\">\n      <ul\n        className=\"dropdown-menu dropdown-menu-right\"\n        aria-labelledby=\"dropdownMenu1\"\n      >\n        {menuActions.map((menuAction, index) => {\n          const callback = () => menuAction.callback!(userProfile)\n          if (menuAction.field === SEPERATOR) {\n            return <hr className=\"SRC-break\" key={menuAction.field + index} />\n          }\n          return (\n            <li\n              key={menuAction.field}\n              style={{ listStyle: 'none' }}\n              className=\"SRC-menu-item SRC-table-dropdown-list SRC-primary-background-color-hover\"\n              onClick={callback}\n              onKeyPress={callback}\n            >\n              <button className=\"SRC-menuAction\">{menuAction.field}</button>\n            </li>\n          )\n        })}\n      </ul>\n    </div>\n  )\n}\n\nexport default UserCardContextMenu\n","import * as React from 'react'\n\nconst svg = (\n  <span className='SRC-certified-user-icon'>\n  <svg width=\"17\" height=\"20\" viewBox=\"0 0 17 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M5.63578 14.1759C5.53042 14.0916 5.40399 14.0284 5.27756 14.0284L4.39256 13.9652C3.48648 13.902 2.68576 13.4384 2.15897 12.7641L0.0518096 17.2523C-0.137835 17.6738 0.220382 18.1584 0.683957 18.0741L2.5804 17.7159C2.81219 17.6738 3.06505 17.7791 3.19148 18.0109L4.11862 19.6966C4.35041 20.1181 4.94042 20.097 5.13006 19.6545L7.174 15.2927C6.85793 15.1663 6.584 14.9977 6.31007 14.7659L5.63578 14.1759Z\" fill=\"#58A158\"/>\n    <path d=\"M16.6564 17.2523L14.5492 12.7641C14.0224 13.4384 13.2217 13.8809 12.3156 13.9652L11.4306 14.0284C11.2831 14.0495 11.1778 14.0916 11.0724 14.1759L10.3981 14.7448C10.1453 14.9555 9.85025 15.1452 9.53418 15.2716L11.5781 19.6334C11.7678 20.0549 12.3788 20.0759 12.5896 19.6756L13.5167 17.9899C13.6431 17.7791 13.8749 17.6527 14.1278 17.6948L16.0242 18.0531C16.4878 18.1374 16.8671 17.6738 16.6564 17.2523Z\" fill=\"#58A158\"/>\n    <path d=\"M10.2503 13.2277C10.5453 12.9748 10.9246 12.8063 11.3249 12.7852L12.2099 12.722C13.1371 12.6588 13.8746 11.9212 13.9378 10.9941L14.001 10.1091C14.0221 9.70873 14.1906 9.32944 14.4435 9.03444L15.0335 8.36015C15.6446 7.64372 15.6446 6.61121 15.0335 5.91585L14.4435 5.24156C14.1906 4.94655 14.0221 4.56727 14.001 4.16691L13.9378 3.2819C13.8746 2.35475 13.1371 1.61724 12.2099 1.55403L11.3249 1.49081C10.9246 1.46974 10.5453 1.30117 10.2503 1.04831L9.57597 0.458307C8.85954 -0.152769 7.82703 -0.152769 7.13167 0.458307L6.45738 0.985097C6.16237 1.23796 5.78309 1.40653 5.38273 1.4276L4.49772 1.49081C3.57057 1.55403 2.83306 2.29153 2.76985 3.21868L2.70664 4.10369C2.68556 4.50405 2.51699 4.88334 2.26413 5.17834L1.67413 5.85263C1.06305 6.56907 1.06305 7.60157 1.67413 8.29694L2.26413 8.97123C2.51699 9.26623 2.68556 9.64552 2.70664 10.0459L2.76985 10.9309C2.83306 11.858 3.57057 12.5955 4.49772 12.6588L5.38273 12.722C5.78309 12.743 6.16237 12.9116 6.45738 13.1645L7.13167 13.7545C7.8481 14.3656 8.88061 14.3656 9.57597 13.7545L10.2503 13.2277ZM4.39236 7.11693C4.39236 4.92548 6.16237 3.15547 8.35382 3.15547C10.5453 3.15547 12.3153 4.92548 12.3153 7.11693C12.3153 9.30837 10.5453 11.0784 8.35382 11.0784C6.16237 11.0784 4.39236 9.2873 4.39236 7.11693Z\" fill=\"#58A158\"/>\n    <path d=\"M10.5875 6.0844L9.49182 5.87368C9.38646 5.85261 9.28111 5.7894 9.23896 5.68404L8.6911 4.69367C8.5436 4.44081 8.16431 4.44081 8.03788 4.69367L7.49002 5.68404C7.42681 5.7894 7.34252 5.85261 7.23716 5.87368L6.14144 6.0844C5.84644 6.14761 5.74108 6.50583 5.93072 6.71654L6.6893 7.53834C6.77359 7.62262 6.79466 7.72798 6.79466 7.83334L6.66823 8.95013C6.62609 9.24513 6.94216 9.45585 7.19502 9.32942L8.20646 8.84477C8.31181 8.80263 8.41717 8.80263 8.52253 8.84477L9.53396 9.32942C9.8079 9.45585 10.1029 9.24513 10.0608 8.95013L9.93433 7.83334C9.91325 7.72798 9.9554 7.60155 10.0397 7.53834L10.7983 6.71654C10.9879 6.48476 10.8825 6.14761 10.5875 6.0844Z\" fill=\"#C94281\"/>\n  </svg>\n  </span>\n)\nexport default svg\n\n","import * as React from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCircle,\n  faEllipsisV,\n  faCopy,\n} from '@fortawesome/free-solid-svg-icons'\nimport CertifiedUserIcon from '../assets/icons/CertifiedUser'\nimport { UserProfile } from '../utils/synapseTypes/'\n\nlibrary.add(faCircle)\nlibrary.add(faEllipsisV)\nlibrary.add(faCopy)\n\ntype UserCardLargeProps = {\n  userProfile: UserProfile\n  isCertified?: boolean\n}\n\n/**\n * UserCardLarge wraps around UserCardMedium\n *\n * @export UserCardLarge\n * @param {UserCardLargeProps} { userProfile }\n */\n// Disable function name because compiler has to know that its a class\n// tslint:disable-next-line:function-name\nexport function UserCardLarge({ userProfile, isCertified }: UserCardLargeProps) {\n  const { summary, industry, location, url } = userProfile\n\n  return (\n    <div className=\"SRC-cardMetaData\">\n      <div className=\"SRC-cardMetaData-scroll\">\n        {summary && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> Bio </p>\n            <p>{summary}</p>\n          </div>\n        )}\n        {url && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> More Info </p>\n            <p>{url}</p>\n          </div>\n        )}\n        {industry && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> Industry </p>\n            <p>{industry}</p>\n          </div>\n        )}\n        {location && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> Location </p>\n            <p>{location}</p>\n          </div>\n        )}\n        {isCertified && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> Access </p>\n            <p>{CertifiedUserIcon} Certified Account</p>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n","import * as React from 'react'\n\nconst svg = (\n  <svg width=\"12\" height=\"14\" viewBox=\"0 0 12 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      // tslint:disable-next-line:max-line-length\n      d=\"M10.7368 12.7273H3.78947V3.81818H10.7368V12.7273ZM10.7368 2.54545H3.78947C3.45446 2.54545 3.13317 2.67954 2.89629 2.91823C2.6594 3.15691 2.52632 3.48063 2.52632 3.81818V12.7273C2.52632 13.0648 2.6594 13.3885 2.89629 13.6272C3.13317 13.8659 3.45446 14 3.78947 14H10.7368C11.0719 14 11.3931 13.8659 11.63 13.6272C11.8669 13.3885 12 13.0648 12 12.7273V3.81818C12 3.48063 11.8669 3.15691 11.63 2.91823C11.3931 2.67954 11.0719 2.54545 10.7368 2.54545V2.54545ZM8.8421 0H1.26316C0.928148 0 0.606858 0.134091 0.36997 0.372773C0.133082 0.611456 0 0.935179 0 1.27273V10.1818H1.26316V1.27273H8.8421V0Z\"\n      fill=\"#DCDCDC\"\n    />\n  </svg>\n)\nexport default svg\n","import * as React from 'react'\n\nconst svg = (\n  <span className='SRC-validatedProfileIcon'>\n    <svg width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <path d=\"M1.21612 12.9284C1.00431 13.5978 1.46323 14.3024 2.16925 14.4081L2.62816 14.4786C3.12238 14.5491 3.51069 14.9366 3.61659 15.4299L3.68719 15.8879C3.7931 16.5925 4.49912 17.0153 5.20514 16.8039L5.66405 16.663C6.15827 16.5221 6.68778 16.6982 6.97019 17.121L7.2526 17.5086C7.67621 18.0723 8.48813 18.178 9.01765 17.6847L9.37066 17.3676C9.75897 17.0153 10.2885 16.9448 10.7474 17.1915L11.171 17.4029C11.8064 17.7552 12.5831 17.4733 12.8302 16.8039L13.0067 16.3811C13.1832 15.9231 13.6774 15.606 14.1716 15.6413L14.6305 15.6765C15.3365 15.7117 15.9367 15.1128 15.8661 14.4081L15.8307 13.9501C15.7954 13.4569 16.0779 12.9636 16.5721 12.7875L16.9957 12.6113C17.6664 12.3294 17.9135 11.5543 17.5605 10.9554L17.2428 10.5678C16.9957 10.145 17.0663 9.58133 17.384 9.19378L17.7017 8.84145C18.1606 8.31297 18.09 7.50264 17.4899 7.07985L17.1016 6.83322C16.678 6.55137 16.5015 6.02289 16.6427 5.52964L16.7839 5.07162C16.9957 4.40221 16.5368 3.69757 15.8307 3.59187L15.3718 3.52141C14.8776 3.45094 14.4893 3.06339 14.3834 2.57014L14.3128 2.11212C14.2069 1.40748 13.5009 0.984696 12.7949 1.19609L12.3359 1.33702C11.8417 1.47795 11.3122 1.30179 11.0298 0.879L10.7474 0.491447C10.3238 -0.072267 9.51186 -0.177963 8.98235 0.315286L8.62934 0.632375C8.24103 0.984696 7.71151 1.05516 7.2526 0.808536L6.82899 0.597143C6.19357 0.244822 5.41694 0.526679 5.16984 1.19609L4.99333 1.61887C4.81683 2.07689 4.32261 2.39398 3.8284 2.35875L3.44009 2.28828C2.73407 2.25305 2.13395 2.852 2.20455 3.55664L2.23985 4.01466C2.27515 4.50791 1.99274 5.00116 1.49853 5.17732L1.07492 5.35348C0.404196 5.63533 0.15709 6.41044 0.5101 7.00939L0.757207 7.39694C1.00431 7.81972 0.933712 8.38344 0.616003 8.77099L0.298294 9.12331C-0.16062 9.65179 -0.0900176 10.4621 0.5101 10.8849L0.898411 11.1315C1.32202 11.4134 1.49853 11.9419 1.35732 12.4351L1.21612 12.9284ZM6.37007 7.6788L7.92332 9.26424L11.6652 5.56487L13.2891 7.18555L9.54716 10.8497L7.92332 12.4704L6.29947 10.8497L4.74622 9.29947L6.37007 7.6788Z\" fill=\"#28A745\"/>\n    </svg>\n  </span>\n)\nexport default svg\n\n","import * as React from 'react'\nimport { CSSTransition, TransitionGroup } from 'react-transition-group'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCircle,\n  faEllipsisV,\n  faCopy,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { getColor } from '../utils/functions/getUserData'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport UserCardContextMenu, { MenuAction } from './UserCardContextMenu'\nimport { UserCardLarge } from './UserCardLarge'\nimport IconCopy from '../assets/icons/IconCopy'\nimport ValidatedProfileIcon from '../assets/icons/ValidatedProfile'\nimport ReactTooltip from 'react-tooltip'\n\nlibrary.add(faCircle)\nlibrary.add(faEllipsisV)\nlibrary.add(faCopy)\n\ntype UserCardState = {\n  showModal: boolean\n  isContextMenuOpen: boolean\n}\n\nexport type UserCardMediumProps = {\n  userProfile: UserProfile\n  menuActions?: MenuAction[]\n  preSignedURL?: string\n  hideEmail?: boolean\n  isLarge?: boolean\n  link?: string\n  disableLink?: boolean\n  isCertified?: boolean\n  isValidated?: boolean\n}\n\nexport default class UserCardMedium extends React.Component<\n  UserCardMediumProps,\n  UserCardState\n> {\n  public htmlDivRef = React.createRef<HTMLDivElement>()\n\n  constructor(props: UserCardMediumProps) {\n    super(props)\n    this.state = {\n      showModal: false,\n      isContextMenuOpen: false,\n    }\n  }\n\n  /**\n   * Function handles copying to clipboard the user's email address\n   *\n   * @param {string} value the email address of the user\n   * @returns\n   */\n  public copyToClipboard = (value: string) => (event: React.SyntheticEvent) => {\n    event.preventDefault()\n    // https://hackernoon.com/copying-text-to-clipboard-with-javascript-df4d4988697f\n    // this copies the email to the clipoard\n    const el = document.createElement('textarea')\n    el.value = value\n    el.setAttribute('readonly', '')\n    el.style.position = 'absolute'\n    el.style.left = '-9999px'\n    this.htmlDivRef.current!.appendChild(el)\n    el.select()\n    document.execCommand('copy')\n    this.htmlDivRef.current!.removeChild(el)\n    // show modal and hide after 4 seconds, the timing is per Material Design\n    this.setState({ showModal: true })\n    // hide after 4 seconds\n    setTimeout(() => {\n      this.setState({ showModal: false })\n    }, 4000)\n  }\n\n  public toggleContextMenu = (_event: any) => {\n    this.setState({ isContextMenuOpen: !this.state.isContextMenuOpen })\n  }\n\n  public componentDidMount() {\n    // SWC-4778: https://stackoverflow.com/questions/23821768/how-to-listen-for-click-events-that-are-outside-of-a-component\n    window.addEventListener('mouseup', this.pageClick, false)\n  }\n\n  public componentWillUnmount() {\n    window.removeEventListener('mouseup', this.pageClick, false)\n  }\n\n  public pageClick = (_event: any) => {\n    if (!this.state.isContextMenuOpen) {\n      return\n    }\n    // hide content menu (deferred, to allow menu action to process)\n    setTimeout(() => {\n      if (this.state.isContextMenuOpen) {\n        this.toggleContextMenu(_event)\n      }\n    }, 10)\n  }\n\n  render() {\n    const {\n      userProfile,\n      menuActions,\n      isLarge = false,\n      preSignedURL,\n      hideEmail = false,\n      disableLink = false,\n      link,\n      isValidated,\n      isCertified\n    } = this.props\n    const { isContextMenuOpen, showModal } = this.state\n    const {\n      displayName,\n      userName,\n      firstName,\n      lastName,\n      position,\n      company,\n    } = userProfile\n    const validatedUserProfileTooltipId = `${userName}-tooltip`\n    let img\n    let name = ''\n    const linkLocation = link\n      ? link\n      : `https://www.synapse.org/#!Profile:${userProfile.ownerId}`\n    // linkLocation is overriden by custom click handler\n    const email = `${userName}@synapse.org`\n    if (displayName) {\n      name = displayName\n    } else if (firstName && lastName) {\n      name = `${firstName} ${lastName}`\n    } else if (userName) {\n      name = userName\n    }\n    if (preSignedURL) {\n      img = (\n        <div\n          style={{ backgroundImage: `url(${preSignedURL})` }}\n          className=\"SRC-userImg\"\n        />\n      )\n    } else {\n      img = (\n        <div\n          style={{ background: getColor(userName) }}\n          className=\"SRC-userImg SRC-centerContentInline\"\n        >\n          {userProfile.firstName &&\n            (userProfile.firstName[0] || userProfile.userName[0])}\n        </div>\n      )\n    }\n    const mediumCard = (\n      <React.Fragment>\n        {!hideEmail && (\n          <TransitionGroup>\n            {showModal && (\n              <CSSTransition\n                key={email}\n                classNames=\"SRC-card\"\n                timeout={{ enter: 500, exit: 300 }}\n              >\n                <div key={email} className=\"SRC-modal\">\n                  Email address copied to clipboard\n                </div>\n              </CSSTransition>\n            )}\n          </TransitionGroup>\n        )}\n        {disableLink && img}\n        {!disableLink && (\n          <a\n            href={linkLocation}\n            className={`SRC-no-underline-on-hover ${\n              isLarge ? 'SRC-isLargeCard' : ''\n            }`}\n          >\n            {img}\n          </a>\n        )}\n        <div className=\"SRC-cardContent\">\n          <p className=\"SRC-eqHeightRow SRC-userCardName\">\n            {/*\n              if its a medium component the header should be clickable (unless disableLink is set),\n              if its large then it should NOT be clickable\n            */}\n            {/* make SRC-whiteText overridable with a good name! */}\n            {isLarge || disableLink ? (\n              <span className={isLarge ? 'SRC-whiteText' : 'SRC-blackText'}>\n                {name}\n              </span>\n            ) : (\n              // consolidate click events\n              <a\n                href={linkLocation}\n                tabIndex={0}\n                className={'SRC-hand-cursor SRC-primary-text-color'}\n              >\n                {name}\n              </a>\n            )}\n            {isValidated && (\n              <span\n                data-for={validatedUserProfileTooltipId}\n                data-tip=\"This user profile has been validated.\"\n              >\n                <ReactTooltip\n                  delayShow={300}\n                  place=\"bottom\"\n                  type=\"dark\"\n                  effect=\"solid\"\n                  id={validatedUserProfileTooltipId}\n                />\n                {ValidatedProfileIcon}\n              </span>\n            \n              \n            )}\n          </p>\n          {(position || company) && (\n            <p className={`${isLarge ? 'SRC-whiteText' : ''}`}>\n              {position} {position ? ' / ' : ''} {company}\n            </p>\n          )}\n          {!hideEmail && (\n            <p\n              className={`${\n                isLarge\n                  ? 'SRC-whiteText'\n                  : 'SRC-primary-text-color SRC-primary-color-hover'\n              }\n              SRC-hand-cursor SRC-eqHeightRow SRC-inlineFlex SRC-emailText SRC-cardSvg`}\n              onClick={this.copyToClipboard(email)}\n              onKeyPress={this.copyToClipboard(email)}\n              tabIndex={0}\n              ref={this.htmlDivRef}\n            >\n              <span style={{ paddingRight: '5px' }}>\n                {`${userName}@synapse.org`}\n              </span>\n              {IconCopy}\n            </p>\n          )}\n        </div>\n        {/* conditionally render menu actions, if its not defined then we don't show the button */}\n        {menuActions && (\n          <React.Fragment>\n            <span\n              className={`SRC-extraPadding SRC-hand-cursor SRC-primary-background-color-hover SRC-inlineBlock\n              SRC-cardMenuButton ${\n                isContextMenuOpen ? 'SRC-primary-background-color' : ''\n              }`}\n              style={{ outline: 'none' }}\n              tabIndex={0}\n              onClick={this.toggleContextMenu}\n              onKeyPress={this.toggleContextMenu}\n            >\n              <FontAwesomeIcon\n                className={\n                  isContextMenuOpen || isLarge\n                    ? 'SRC-whiteText'\n                    : 'SRC-primary-text-color'\n                }\n                icon=\"ellipsis-v\"\n                fixedWidth={true}\n              />\n            </span>\n            {isContextMenuOpen && (\n              <UserCardContextMenu\n                menuActions={menuActions}\n                userProfile={userProfile}\n              />\n            )}\n          </React.Fragment>\n        )}\n        {!menuActions && <span style={{ padding: '0px 0px 0px 35px' }} />}\n      </React.Fragment>\n    )\n\n    if (!isLarge) {\n      return (\n        <div\n          style={{ border: '1px solid #DDDDDF', backgroundColor: 'white' }}\n          className={`SRC-userCard SRC-userCardMediumUp ${\n            isContextMenuOpen ? 'SRC-hand-cursor' : ''\n          }`}\n          onClick={isContextMenuOpen ? this.toggleContextMenu : undefined}\n        >\n          {mediumCard}\n        </div>\n      )\n    }\n    // else return medium card inside large component\n    // when the component is large we have to set the click handler to wrap both the top and bottom portion\n    return (\n      <div\n        className={isContextMenuOpen ? 'SRC-hand-cursor cardContainer' : 'cardContainer'}\n        onClick={isContextMenuOpen ? this.toggleContextMenu : undefined}\n      >\n        <div\n          className={`SRC-primary-background-color SRC-userCard SRC-userCardMediumUp ${\n            isContextMenuOpen ? 'SRC-hand-cursor' : ''\n          }`}\n        >\n          {mediumCard}\n        </div>\n        {isLarge ? <UserCardLarge userProfile={userProfile} isCertified={isCertified} /> : false}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { getUserProfileWithProfilePic } from '../utils/functions/getUserData'\nimport { getPrincipalAliasRequest } from '../utils/SynapseClient'\nimport { MenuAction } from './UserCardContextMenu'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport { SynapseConstants } from '../utils/'\nimport { UserCardSmall } from './UserCardSmall'\nimport UserCardMedium from './UserCardMedium'\n\ntype UserCardState = {\n  userProfile: UserProfile | undefined\n  preSignedURL: string\n  isLoading: boolean\n}\n\nexport type UserCardSize =\n  | 'SMALL USER CARD'\n  | 'MEDIUM USER CARD'\n  | 'LARGE USER CARD'\n\nexport type UserCardProps = {\n  // Note - either specify userProfile OR (alias or ownerId)\n  userProfile?: UserProfile\n  hideEmail?: boolean\n  preSignedURL?: string\n  alias?: string\n  ownerId?: string\n  size: UserCardSize\n  hideText?: boolean\n  hideTooltip?: boolean\n  menuActions?: MenuAction[]\n  link?: string\n  token?: string\n  disableLink?: boolean\n  extraSmall?: boolean\n  isCertified?: boolean\n  isValidated?: boolean\n}\n\nexport default class UserCard extends React.Component<\n  UserCardProps,\n  UserCardState\n> {\n  constructor(props: UserCardProps) {\n    super(props)\n    this.state = { userProfile: undefined, isLoading: true, preSignedURL: '' }\n    this.getUserProfile = this.getUserProfile.bind(this)\n  }\n\n  public componentDidMount() {\n    const { userProfile, ownerId, alias, token } = this.props\n    if (userProfile) {\n      return\n    }\n    if (alias) {\n      getPrincipalAliasRequest(token, alias, 'USER_NAME').then(\n        (aliasData: any) => {\n          this.getUserProfile(aliasData.principalId!)\n        },\n      )\n    } else {\n      // check for ownerId!\n      this.getUserProfile(ownerId!)\n    }\n  }\n\n  public getUserProfile(ownerId: string) {\n    getUserProfileWithProfilePic(ownerId!, this.props.token)\n      .then((data) => {\n        const { userProfile, preSignedURL } = data\n        this.setState({ userProfile, preSignedURL, isLoading: false })\n      })\n      .catch((err) => {\n        console.log('failed to get user bundle ', err)\n      })\n  }\n\n  public render() {\n    const {\n      userProfile,\n      preSignedURL,\n      size,\n      ...rest\n    } = this.props\n    let userProfileAtRender\n    let preSignedURLAtRender\n    if (!userProfile) {\n      // userProfile wasn't passed in from props\n      if (this.state.isLoading) {\n        // still making the API call\n        return <></>\n      }\n      userProfileAtRender = this.state.userProfile\n      preSignedURLAtRender = this.state.preSignedURL\n    } else {\n      // otherwise we have the profile from props\n      userProfileAtRender = userProfile\n      preSignedURLAtRender = preSignedURL\n    }\n    const propsForChild = {\n      userProfile: userProfileAtRender!,\n      preSignedURL: preSignedURLAtRender,\n      ...rest,\n    }\n    switch (size) {\n      case SynapseConstants.SMALL_USER_CARD:\n        return <UserCardSmall {...propsForChild} />\n      case SynapseConstants.MEDIUM_USER_CARD:\n        return <UserCardMedium {...propsForChild} />\n      case SynapseConstants.LARGE_USER_CARD:\n        return <UserCardMedium isLarge={true} {...propsForChild} />\n      default:\n        return <span />\n    }\n  }\n}\n","import * as React from 'react'\n\ntype BookmarksProps = {\n  footnotes: string\n}\n\nclass Bookmarks extends React.Component<BookmarksProps, {}> {\n  constructor(props: BookmarksProps) {\n    super(props)\n    this.renderBookmarks = this.renderBookmarks.bind(this)\n  }\n\n  /**\n   * Returns bookmarks\n   *\n   * @returns JSX for the embedded bookmarks in the markdown passed in as a prop\n   * @memberof Bookmarks\n   */\n  public renderBookmarks() {\n    const copyFootnotes: string = String(this.props.footnotes)\n\n    // find all the links embedded in the markdown below\n    const regex = /Synapse widget&gt;<\\/span>(.*)</g\n    let matchedGroup: RegExpExecArray | null\n    const output = []\n    // below we use regex.exec to find the find matched group containing the citation source\n    while ((matchedGroup = regex.exec(copyFootnotes))) {\n      output.push(matchedGroup[1])\n    }\n\n    // return all the links formatted accordingly\n    return output.map((el, index) => {\n      const isBeforeLastElement = index < output.length - 1\n      return (\n        <React.Fragment key={index}>\n          <button className=\"SRC-markdown-bookmark\" id={`bookmark${index}`}>\n            [{index + 1}]\n          </button>\n          <span dangerouslySetInnerHTML={{ __html: el }} />\n          {isBeforeLastElement && <br />}\n        </React.Fragment>\n      )\n    })\n  }\n\n  public render() {\n    return (\n      <React.Fragment>\n        <hr />\n        {this.renderBookmarks()}\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Bookmarks\n","import * as React from 'react'\nimport { getEntity, getFiles } from '../../utils/SynapseClient'\nimport {\n  BatchFileRequest,\n  BatchFileResult,\n  FileEntity,\n  FileHandle,\n  FileHandleAssociateType,\n  FileHandleAssociation,\n} from '../../utils/synapseTypes/'\n\ntype SynapseImageProps = {\n  wikiId?: string\n  synapseId?: string\n  token?: string\n  fileName?: string\n  fileResults?: FileHandle[]\n  params: {\n    align: string\n    scale: string\n    // this should be treated as a boolean, but the actual type that will come through\n    // is a string which I don't want to mis-represent\n    responsive: string\n    altText: string\n  }\n}\n\ntype SynapseImageState = {\n  preSignedURL: string\n}\n\nclass SynapseImage extends React.Component<\n  SynapseImageProps,\n  SynapseImageState\n> {\n  constructor(props: SynapseImageProps) {\n    super(props)\n    this.getEntity = this.getEntity.bind(this)\n    this.getSynapseFiles = this.getSynapseFiles.bind(this)\n    this.state = {\n      preSignedURL: '',\n    }\n  }\n\n  public getEntity() {\n    const { token, synapseId } = this.props\n    if (synapseId) {\n      getEntity<FileEntity>(token, synapseId).then(\n        // https://docs.synapse.org/rest/org/sagebionetworks/repo/model/FileEntity.html\n        (data: FileEntity) => {\n          const fileHandleAssociationList = [\n            {\n              associateObjectId: synapseId,\n              associateObjectType: FileHandleAssociateType.FileEntity,\n              fileHandleId: data.dataFileHandleId,\n            },\n          ]\n          this.getSynapseFiles(fileHandleAssociationList, data.dataFileHandleId)\n        },\n      )\n    }\n  }\n  public getSynapseFiles(\n    fileHandleAssociationList: FileHandleAssociation[],\n    id: string,\n  ) {\n    // overload the method for two different use cases, one where\n    // the image is attached to an entity and creates a list on the spot,\n    // the other where list is passed in from componentDidMount in MarkdownSynapse\n    const request: BatchFileRequest = {\n      includeFileHandles: false,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    getFiles(request, this.props.token)\n      .then((data: BatchFileResult) => {\n        const { preSignedURL } = data.requestedFiles.filter(\n          el => el.fileHandleId === id,\n        )[0]\n        this.setState({\n          preSignedURL: preSignedURL!,\n        })\n      })\n      .catch(err => {\n        console.error('Error on getting image ', err)\n      })\n  }\n  public componentDidMount() {\n    if (!this.props.wikiId) {\n      // Get file handle as external attachment\n      this.getEntity()\n    } else {\n      // Can get presigned url right away from wiki association\n      const { fileName, fileResults = [] } = this.props\n      const { id } = fileResults.filter(el => el.fileName === fileName)[0]\n      const fileHandleAssociationList: FileHandleAssociation[] = [\n        {\n          associateObjectId: this.props.wikiId,\n          associateObjectType: FileHandleAssociateType.WikiAttachment,\n          fileHandleId: id,\n        },\n      ]\n      this.getSynapseFiles(fileHandleAssociationList, id)\n    }\n  }\n\n  public render() {\n    const { params } = this.props\n    const { align = '', altText = 'synapse image' } = params\n    let scale = `${Number(params.scale) ?? 100}%`\n    const alignLowerCase = align.toLowerCase()\n    let className = ''\n    if (alignLowerCase === 'left') {\n      className = 'floatLeft'\n    }\n    if (alignLowerCase === 'right') {\n      className = 'floatright'\n    }\n    if (alignLowerCase === 'center') {\n      className = 'align-center'\n    }\n    let style: React.CSSProperties = {\n      width: scale,\n      height: scale,\n    }\n    if (!this.state.preSignedURL) {\n      return null\n    }\n    return (\n      <React.Fragment>\n        <img\n          alt={altText}\n          className={'img-fluid  ' + className}\n          src={this.state.preSignedURL}\n          style={style}\n        />\n      </React.Fragment>\n    )\n  }\n}\nexport default SynapseImage\n","import * as React from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faLongArrowAltUp,\n  faLongArrowAltDown,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { DOI_REGEX } from '../../../containers/GenericCard'\nlibrary.add(faLongArrowAltUp)\nlibrary.add(faLongArrowAltDown)\n\ntype State = {\n  isShowMoreOn: boolean\n  isDesktop: boolean\n}\n\ntype CardFooterProps = {\n  values: any[]\n  isHeader: boolean\n  secondaryLabelLimit?: number\n}\n\nclass CardFooter extends React.Component<CardFooterProps, State> {\n  constructor(props: CardFooterProps) {\n    super(props)\n    this.state = {\n      isShowMoreOn: false,\n      isDesktop: false,\n    }\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n    this.updatePredicate = this.updatePredicate.bind(this)\n  }\n\n  toggleShowMore() {\n    this.setState({\n      isShowMoreOn: !this.state.isShowMoreOn,\n    })\n  }\n\n  componentDidMount() {\n    this.updatePredicate()\n    window.addEventListener('resize', this.updatePredicate)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updatePredicate)\n  }\n\n  updatePredicate() {\n    this.setState({ isDesktop: window.innerWidth > 600 })\n  }\n\n  renderRowValue = (columnName: string, value: string) => {\n    if (!value.match) {\n      // value can sometimes be a react element, so it doesn't have a .match function, interestingly I didn't\n      // see typeof return 'object' for that case which would be a better check.\n      return value\n    }\n    if (value.match(DOI_REGEX)) {\n      return (\n        <a\n          data-search-handle={columnName}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          href={`https://dx.doi.org/${value}`}\n        >\n          {value}\n        </a>\n      )\n    }\n    return value\n  }\n\n  renderRows = (values: string[][], limit: number, isDesktop: boolean) => {\n    return values.map((kv, index) => {\n      const hideClass = index >= limit ? 'SRC-hidden' : ''\n      const columnName = kv[0]\n      const value = this.renderRowValue(columnName, kv[1])\n      if (isDesktop) {\n        return (\n          <tr className={'SRC-cardRowDesktop ' + hideClass} key={index}>\n            <td className={'SRC-verticalAlignTop SRC-row-label'}>\n              {columnName}\n            </td>\n            <td\n              data-search-handle={columnName}\n              className={'SRC-row-data SRC-limitMaxWidth '}\n            >\n              {value}\n            </td>\n          </tr>\n        )\n      }\n      return (\n        <React.Fragment key={index}>\n          <tr className={'SRC-cardRowMobile ' + hideClass}>\n            <td className={'SRC-verticalAlignTop SRC-row-label'}>\n              {columnName}\n            </td>\n          </tr>\n          <tr className={'SRC-cardRowMobile ' + hideClass}>\n            <td\n              data-search-handle={columnName}\n              className=\"SRC-row-data SRC-limitMaxWidth\"\n            >\n              {value}\n            </td>\n          </tr>\n        </React.Fragment>\n      )\n    })\n  }\n\n  render() {\n    const { values, secondaryLabelLimit = 3 } = this.props\n    const { isShowMoreOn, isDesktop } = this.state\n    const valuesFiltered = values.filter(el => el[1])\n    const hasMoreValuesThanLimit = valuesFiltered.length > secondaryLabelLimit\n    const limit =\n      !hasMoreValuesThanLimit || isShowMoreOn ? Infinity : secondaryLabelLimit\n    return (\n      <div\n        className={`SRC-cardMetadata ${\n          this.props.isHeader ? 'SRC-card-footer-header' : ''\n        }`}\n      >\n        <table>\n          <tbody>\n            {this.renderRows(valuesFiltered, limit, isDesktop)}\n            {hasMoreValuesThanLimit && (\n              <tr className=\"SRC-cardRow\">\n                <td>\n                  <button\n                    style={{ textAlign: 'left', margin: 0, padding: 0 }}\n                    className=\"SRC-primary-text-color SRC-basicButton\"\n                    onClick={this.toggleShowMore}\n                  >\n                    Show {isShowMoreOn ? 'Less' : 'More'}\n                    <FontAwesomeIcon\n                      style={{ marginLeft: '5px' }}\n                      icon={\n                        isShowMoreOn\n                          ? 'long-arrow-alt-up'\n                          : 'long-arrow-alt-down'\n                      }\n                    />\n                  </button>\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n    )\n  }\n}\nexport default CardFooter\n","import * as React from 'react'\n\ntype ChipContainerProps = {\n  chips: any[]\n}\n\nconst ChipContainer: React.SFC<ChipContainerProps> = ({ chips }) => {\n  const chipsFormatted = chips.map((el, index) => {\n    if (!el) {\n      return false\n    }\n    return <span key={index}> {el}</span>\n  })\n  return <React.Fragment>{chipsFormatted}</React.Fragment>\n}\nexport default ChipContainer\n","import * as React from 'react'\n\nexport const Project = () => (\n  <svg width=\"60\" height=\"60\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <path\n        d=\"M30 22a7.99 7.99 0 0 0-5.757 13.54 4.99 4.99 0 0 1 2.355-2.9 5 5 0 1 1 6.8 0 4.99 4.99 0 0 1 2.355 2.9A7.99 7.99 0 0 0 30 22z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M30 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM26.008 36.922a7.93 7.93 0 0 0 7.984 0A3 3 0 0 0 31 34h-2a3 3 0 0 0-2.992 2.922zM50.62 8.805a2.973 2.973 0 0 1 .259-3.926A3 3 0 0 1 56 6.999a2.972 2.972 0 0 1-.619 1.8 4 4 0 0 1 1.273 1.584 5 5 0 1 0-7.308 0 4 4 0 0 1 1.273-1.578z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M53 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM51.04 11.6a4.973 4.973 0 0 0 3.919 0 2 2 0 0 0-3.918 0zM53 54a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM53 56a2 2 0 0 0-1.96 1.6 4.978 4.978 0 0 0 3.914 0A1.994 1.994 0 0 0 53 56z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M53 48a4.983 4.983 0 0 0-3.654 8.388 4 4 0 0 1 1.273-1.583 2.972 2.972 0 0 1 .26-3.926A3 3 0 0 1 55.998 53a2.967 2.967 0 0 1-.618 1.8c.554.409.993.955 1.273 1.584A4.982 4.982 0 0 0 53 48zM5.04 11.6a4.973 4.973 0 0 0 3.919 0 2 2 0 0 0-3.918 0zM7 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M4.619 8.805a2.972 2.972 0 0 1 .26-3.926A3 3 0 0 1 10 6.999a2.972 2.972 0 0 1-.619 1.8 4 4 0 0 1 1.273 1.584 5 5 0 1 0-7.308 0 4 4 0 0 1 1.273-1.578z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M29.562 9.981a5 5 0 1 0 0 0zM28.072 2.7a2.976 2.976 0 0 1 2.196-.688 3 3 0 1 1-2.144 5.328 3 3 0 0 1-.051-4.64z\"\n        className=\"SRC-header-only-fill\"\n        fill=\"#DDDDDF\"\n      />\n      <path\n        d=\"M7 56a2 2 0 0 0-1.96 1.6 4.973 4.973 0 0 0 3.919 0 2 2 0 0 0-1.96-1.6zM7 54a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M7 48a4.983 4.983 0 0 0-3.654 8.388 4 4 0 0 1 1.273-1.583 2.972 2.972 0 0 1 .26-3.926A3 3 0 0 1 9.999 53a2.972 2.972 0 0 1-.618 1.8 4 4 0 0 1 1.273 1.583A4.981 4.981 0 0 0 7 48z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M18 29h-2v2h2v-2zM14 29h-2v2h2v-2zM48 29h-2v2h2v-2zM44 29h-2v2h2v-2zM31 16h-2v2h2v-2zM31 12h-2v2h2v-2zM31 46h-2v2h2v-2zM31 42h-2v2h2v-2zM29.562 50.019a5 5 0 1 0 .876 9.96 5 5 0 1 0-.876-9.96zm3.426 4.718a3 3 0 1 1-5.978.527 3 3 0 0 1 5.978-.528zM10 30a5 5 0 1 0-5 5 5.006 5.006 0 0 0 5-5zm-8 0a3 3 0 1 1 6 0 3 3 0 0 1-6 0zM55 25a5 5 0 1 0 5 5 5.006 5.006 0 0 0-5-5zm0 8a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM40.7 22.787a16.249 16.249 0 0 0 9.258-10.512l-1.922-.55a14.263 14.263 0 0 1-8.124 9.224l-.309.132.788 1.838.309-.132zM49.961 47.725A16.248 16.248 0 0 0 40.7 37.213l-.309-.132-.788 1.838.309.132a14.261 14.261 0 0 1 8.124 9.224l1.925-.55zM11.961 11.725l-1.922.55A16.248 16.248 0 0 0 19.3 22.787l.31.132.787-1.838-.309-.132a14.263 14.263 0 0 1-8.127-9.224zM19.3 37.213a16.247 16.247 0 0 0-9.258 10.512l1.922.55a14.264 14.264 0 0 1 8.124-9.224l.309-.132-.788-1.838-.31.132z\"\n        fill=\"#DDDDDF\"\n        className=\"SRC-header-only-fill\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <path fill=\"#fff\" d=\"M0 0h60v60H0z\" />\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import * as React from 'react'\nimport {\n  DATABASE,\n  DATASET,\n  FUNDER,\n  PUBLICATION,\n  STUDY_ACTIVE,\n  STUDY_COMPLETE,\n  TOOL,\n  STUDY,\n  EXPERIMENTAL,\n  COMPUTATIONAL,\n  CLINICAL,\n  PROJECT,\n  GRANT,\n  ORGANIZATION,\n  PERSON,\n  MOUSE,\n  EXPLORE,\n  SEARCH,\n  CHART,\n  FILTER,\n  DOWNLOAD,\n  EXPAND,\n  COLLAPSE,\n  CLOSE,\n  SORTUP,\n  SORTDOWN,\n  SETTINGS,\n  COLUMNS,\n  COLUMNSDARK,\n  VERTICAL_DOTS,\n} from '../../../utils/SynapseConstants'\n\nimport Data2Svg from '../../../assets/icons/Data2.svg'\nimport studyActiveSvg from '../../../assets/icons/study-active.svg'\nimport studyCompleteSvg from '../../../assets/icons/study-complete.svg'\nimport DNA_TwoSvg from '../../../assets/icons/DNA_Two.svg'\nimport organizationsSvg from '../../../assets/icons/organizations.svg'\nimport personSvg from '../../../assets/icons/person.svg'\nimport mouseSvg from '../../../assets/icons/mouse.svg'\n\nimport {\n  Project,\n  Publication,\n  Study,\n  ToolClinical,\n  ToolComputational,\n  ToolExperimental,\n  Database,\n  Explore,\n  Search,\n  Chart,\n  Filter,\n  Download,\n  Expand,\n  Collapse,\n  Close,\n  SortUp,\n  SortDown,\n  Settings,\n  Columns,\n  ColumnsDark,\n  VerticalDots,\n} from '../../../assets/themed_icons'\n\nimport { KeyValue } from '../../../utils/functions/sqlFunctions'\n\ntype IconProps = {\n  type: string\n  iconOptions?: KeyValue\n  value?: string\n  isHeader?: boolean\n  cssClass?: string\n}\n\nconst defaultIcons = {\n  [DATABASE]: Database,  // this returns svg tag\n  [DATASET]: Data2Svg, // this returns img tag link to svg\n  [FUNDER]: Data2Svg,\n  [TOOL]: DNA_TwoSvg,\n  [STUDY_ACTIVE]: studyActiveSvg,\n  [STUDY_COMPLETE]: studyCompleteSvg,\n  // new icons\n  [PUBLICATION]: Publication,\n  [STUDY]: Study,\n  [EXPERIMENTAL]: ToolExperimental,\n  [COMPUTATIONAL]: ToolComputational,\n  [CLINICAL]: ToolClinical,\n  [PROJECT]: Project,\n  [GRANT]: Project,\n  [ORGANIZATION]: organizationsSvg,\n  [PERSON]: personSvg,\n  [MOUSE]: mouseSvg,\n  [EXPLORE]: Explore,\n  [SEARCH]: Search,\n  [CHART]: Chart,\n  [FILTER]: Filter,\n  [DOWNLOAD]: Download,\n  [EXPAND]: Expand,\n  [COLLAPSE]: Collapse,\n  [CLOSE]: Close,\n  [SORTUP]: SortUp,\n  [SORTDOWN]: SortDown,\n  [SETTINGS]: Settings,\n  [COLUMNS]: Columns,\n  [COLUMNSDARK]: ColumnsDark,\n  [VERTICAL_DOTS]: VerticalDots,\n}\nconst Icon: React.FunctionComponent<IconProps> = ({\n  type,\n  value = '',\n  iconOptions,\n  cssClass\n}) => {\n  const iconSet = { ...defaultIcons, ...iconOptions }\n  // see if the value has a corresponding icon, e.g. 'Active' in a studies table\n  // or if the type of card has a corresponding icon, e.g. 'Publication'\n  const Icon = iconSet[value] || iconSet[type]\n  // TODO: get rid of dataset icon class, none of the icons should be special cased\n  const datasetIconClass =\n    value === DATASET || type === DATASET ? 'SRC-datasetIcon' : ''\n  if (typeof Icon == 'function') {\n    return <span className={cssClass}><Icon /></span>\n  }\n  return <img src={Icon} className={`iconImg ${datasetIconClass}`} />\n}\nexport default Icon\n","import * as React from 'react'\n\nexport const Database = () => (\n  <svg width=\"28\" height=\"32\" viewBox=\"0 0 28 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <path d=\"M25.9411 5.79833C25.9411 5.87044 25.9373 5.94255 25.9259 6.01466C25.9411 5.91219 25.9526 5.81351 25.9678 5.71104C25.945 5.88183 25.8993 6.04123 25.8345 6.20063C25.8726 6.10955 25.9107 6.01846 25.9488 5.92737C25.8993 6.04503 25.8383 6.15509 25.7698 6.26515C25.7355 6.31829 25.6974 6.36763 25.6632 6.42076C25.5946 6.52703 25.8383 6.21202 25.7545 6.3069C25.7317 6.32967 25.7127 6.35624 25.6898 6.38281C25.5946 6.49287 25.488 6.59914 25.3814 6.69782C25.328 6.74716 25.2709 6.79649 25.2138 6.84204C25.2024 6.84963 25.1262 6.90276 25.1262 6.91415C25.1262 6.89138 25.3737 6.72818 25.1948 6.86101C24.6502 7.26332 24.0409 7.57074 23.4202 7.83641C23.5116 7.79845 23.603 7.7605 23.6943 7.72255C21.9997 8.43606 20.1718 8.82318 18.3553 9.06988C18.4582 9.0547 18.5572 9.04331 18.66 9.02813C15.6592 9.42664 12.5898 9.42664 9.58899 9.02433C9.69181 9.03952 9.79082 9.0509 9.89364 9.06608C8.09239 8.81939 6.28353 8.43227 4.60033 7.73393C4.69173 7.77189 4.78312 7.80984 4.87452 7.84779C4.24237 7.58212 3.62545 7.27091 3.06946 6.86481C2.87524 6.72059 3.25606 7.01662 3.07327 6.86481C3.01614 6.81927 2.95902 6.76993 2.90571 6.72059C2.79527 6.62191 2.69245 6.51564 2.59344 6.40558C2.57059 6.37901 2.55155 6.35624 2.5287 6.32967C2.42588 6.21581 2.6201 6.43594 2.61629 6.44733C2.6201 6.43215 2.52109 6.3107 2.50966 6.29172C2.43731 6.17786 2.37257 6.06021 2.31925 5.93876C2.35734 6.02984 2.39542 6.12093 2.4335 6.21202C2.36876 6.05641 2.32306 5.89321 2.29641 5.72622C2.31164 5.82869 2.32306 5.92737 2.33829 6.02984C2.31925 5.87803 2.31925 5.72242 2.33829 5.57061C2.32306 5.67309 2.31164 5.77176 2.29641 5.87424C2.31925 5.71104 2.36495 5.55164 2.42969 5.39603C2.39161 5.48712 2.35353 5.5782 2.31545 5.66929C2.36114 5.55923 2.41827 5.45296 2.483 5.35049C2.51728 5.29356 2.55917 5.23663 2.59725 5.18349C2.65437 5.10379 2.75719 5.0127 2.49062 5.32012C2.50966 5.29735 2.5287 5.27458 2.54774 5.24801C2.63533 5.14174 2.73434 5.04307 2.83335 4.94818C2.89048 4.89505 2.9476 4.84192 3.00853 4.78878C3.06184 4.74324 3.28271 4.57245 3.08469 4.72426C2.88286 4.87987 3.12277 4.69769 3.17609 4.65974C3.24463 4.6142 3.31318 4.56486 3.38173 4.52311C3.52643 4.42823 3.67495 4.34094 3.82728 4.25744C4.17001 4.06768 4.52036 3.90068 4.88213 3.74887C4.79074 3.78682 4.69934 3.82478 4.60795 3.86273C6.29114 3.1606 8.10382 2.77348 9.90507 2.53058C9.80225 2.54576 9.70324 2.55715 9.60042 2.57233C11.9653 2.25732 14.372 2.19659 16.7483 2.37118C17.3919 2.42052 18.0354 2.48504 18.679 2.57233C18.5762 2.55715 18.4772 2.54576 18.3744 2.53058C20.1756 2.77348 21.9845 3.1606 23.6677 3.86273C23.5763 3.82478 23.4849 3.78682 23.3935 3.74887C23.7477 3.89689 24.0942 4.06008 24.4293 4.24605C24.5816 4.32955 24.7302 4.42064 24.8749 4.51172C24.951 4.56106 25.0234 4.6104 25.0957 4.65974C25.1529 4.69769 25.3852 4.87607 25.1871 4.72426C24.9853 4.56866 25.2138 4.75083 25.2633 4.78878C25.3204 4.83433 25.3737 4.88366 25.427 4.9368C25.5261 5.03168 25.6251 5.13036 25.7127 5.23663C25.7355 5.26319 25.7545 5.29735 25.7812 5.32012C25.7698 5.31253 25.5718 5.03927 25.6746 5.18349C25.7089 5.23663 25.7469 5.28597 25.7812 5.3391C25.8459 5.44537 25.9069 5.55543 25.9526 5.66929C25.9145 5.5782 25.8764 5.48712 25.8383 5.39603C25.9031 5.54784 25.9488 5.70724 25.9716 5.87424C25.9564 5.77176 25.945 5.67309 25.9297 5.57061C25.9335 5.64652 25.9373 5.72242 25.9411 5.79833C25.945 6.39419 26.4629 6.96349 27.0836 6.93692C27.7005 6.91035 28.2298 6.43594 28.226 5.79833C28.2146 4.27642 27.0341 3.14162 25.8079 2.41292C24.197 1.45271 22.3082 0.925168 20.4803 0.579796C18.0659 0.120565 15.5944 -0.0540191 13.142 0.0142962C10.8076 0.0788163 8.44274 0.344487 6.18071 0.940349C4.48609 1.38819 2.75338 2.0258 1.40149 3.16819C0.853121 3.63122 0.426609 4.21569 0.182888 4.88746C-0.117955 5.72242 0.053411 6.70541 0.529428 7.4417C1.18062 8.43606 2.22024 9.12681 3.28271 9.6202C4.36042 10.125 5.49524 10.4969 6.65292 10.7778C9.12821 11.3698 11.7063 11.6051 14.2463 11.5975C16.7978 11.59 19.3835 11.3395 21.8588 10.717C22.948 10.4438 24.0142 10.0794 25.0272 9.59742C26.0782 9.10024 27.1293 8.40191 27.7538 7.39615C28.0509 6.91794 28.2108 6.36383 28.2222 5.79833C28.2336 5.20247 27.6891 4.63317 27.0798 4.65974C26.4552 4.6901 25.9488 5.16072 25.9411 5.79833Z\" fill=\"#DDDDDF\"/>\n      <path d=\"M25.9334 5.97679C25.9334 6.74723 25.9334 7.52147 25.9334 8.29192C25.9334 9.51021 25.9334 10.7285 25.9334 11.9468C25.9334 12.2276 25.9639 12.5313 25.9296 12.8121C25.9449 12.7096 25.9563 12.611 25.9715 12.5085C25.9449 12.6755 25.8992 12.8387 25.8344 12.9981C25.8725 12.907 25.9106 12.8159 25.9487 12.7248C25.8992 12.8425 25.8382 12.9525 25.7697 13.0626C25.7583 13.0816 25.644 13.2258 25.6478 13.2372C25.644 13.2296 25.8382 13.0057 25.7354 13.1233C25.7126 13.1499 25.6935 13.1727 25.6707 13.1992C25.5717 13.3093 25.4688 13.4156 25.3584 13.5142C25.2975 13.5712 25.2327 13.6243 25.168 13.6774C25.1528 13.6888 25.0804 13.7306 25.0804 13.7496C25.0842 13.7154 25.3203 13.5712 25.149 13.6964C24.612 14.0873 24.0141 14.3872 23.4048 14.6452C23.4962 14.6073 23.5876 14.5693 23.679 14.5314C21.9844 15.2411 20.1641 15.6244 18.3514 15.8711C18.4542 15.8559 18.5533 15.8446 18.6561 15.8294C16.3179 16.1406 13.9454 16.2013 11.592 16.0305C10.9522 15.985 10.3124 15.9167 9.67268 15.8332C9.7755 15.8484 9.87451 15.8597 9.97733 15.8749C8.13038 15.6244 6.27201 15.2297 4.54692 14.5048C4.63831 14.5428 4.72971 14.5807 4.82111 14.6187C4.46695 14.4707 4.07852 14.2164 3.6939 14.2164C3.8843 14.2695 4.07852 14.3189 4.26893 14.372C3.99093 14.2316 3.71294 14.0797 3.45018 13.9128C3.32831 13.8368 3.21026 13.7571 3.09602 13.6736C2.8523 13.4953 3.24454 13.7989 3.09602 13.6774C3.04651 13.6357 2.99701 13.5939 2.9475 13.5522C2.8561 13.4725 2.76471 13.3852 2.67712 13.2979C2.63523 13.2562 2.59715 13.2106 2.55907 13.1689C2.5286 13.1347 2.3839 12.9525 2.5248 13.1347C2.66189 13.3131 2.5286 13.1347 2.50195 13.0968C2.47148 13.0512 2.44483 13.0057 2.41436 12.9601C2.35724 12.8653 2.30773 12.7666 2.26584 12.6641C2.30392 12.7552 2.34201 12.8463 2.38009 12.9374C2.31535 12.778 2.27346 12.6186 2.2468 12.4516C2.26204 12.554 2.27346 12.6527 2.28869 12.7552C2.26204 12.5313 2.28488 12.2884 2.28488 12.0606C2.28488 11.5179 2.28488 10.9752 2.28488 10.4325C2.28488 9.21038 2.28488 7.98829 2.28488 6.76621C2.28488 6.48156 2.28488 6.20071 2.28488 5.91606C1.52326 5.91606 0.761628 5.91606 0 5.91606C0.0723547 6.49674 0.232297 7.04326 0.575029 7.52906C0.959652 8.07179 1.41282 8.48548 1.94977 8.8726C3.00462 9.63925 4.28797 10.1099 5.52942 10.4856C5.26285 10.2199 4.99628 9.95426 4.72971 9.68859C4.88584 10.3338 5.58273 10.607 6.18061 10.6526C6.07779 10.6374 5.97878 10.626 5.87596 10.6108C5.94831 10.626 6.01305 10.6412 6.08541 10.6602C6.43956 10.7589 6.79753 10.6754 7.08314 10.4552C7.38398 10.2237 7.50204 9.93149 7.5325 9.55955C7.5325 9.55575 7.5325 9.55575 7.5325 9.55196C7.04887 9.9163 6.56904 10.2844 6.08541 10.6488C6.29486 10.6981 6.5043 10.7361 6.72137 10.7627C6.61855 10.7475 6.51954 10.7361 6.41672 10.7209C6.8318 10.8348 7.28878 10.941 7.68483 10.7019C7.3916 10.7399 7.09837 10.7778 6.80515 10.8158C9.84023 11.5141 13.0048 11.7191 16.1084 11.5483C17.7383 11.4572 19.372 11.2636 20.9714 10.9259C22.3995 10.626 23.8085 10.1972 25.1223 9.55955C25.8611 9.19899 26.5884 8.73976 27.1635 8.1477C27.4224 7.87823 27.6661 7.57461 27.8413 7.24441C28.0622 6.82314 28.1574 6.44361 28.2183 5.98058C28.2526 5.71111 28.066 5.35815 27.8832 5.17598C27.6852 4.97862 27.3615 4.8306 27.0759 4.84199C26.7788 4.85338 26.4742 4.95205 26.2685 5.17598C26.0477 5.40749 25.9753 5.65798 25.9334 5.97679C25.9334 5.99197 25.9296 6.00335 25.9296 6.01853C25.9449 5.91606 25.9563 5.81738 25.9715 5.71491C25.9449 5.8857 25.8992 6.0451 25.8344 6.2045C25.8725 6.11342 25.9106 6.02233 25.9487 5.93124C25.8992 6.0489 25.8382 6.15896 25.7697 6.26902C25.7354 6.32216 25.6973 6.3715 25.6631 6.42463C25.5945 6.5309 25.8382 6.21589 25.7544 6.31077C25.7316 6.33354 25.7126 6.36011 25.6897 6.38668C25.5945 6.49674 25.4917 6.60301 25.3813 6.70169C25.3279 6.75103 25.2708 6.80036 25.2137 6.84591C25.1832 6.86868 25.1566 6.89525 25.1261 6.91802C24.9814 7.03567 25.3089 6.78518 25.1947 6.86488C24.631 7.26339 24.0294 7.5822 23.3934 7.85166C23.4848 7.81371 23.5762 7.77576 23.6676 7.7378C21.9806 8.44373 20.1641 8.83085 18.3552 9.07375C18.4581 9.05857 18.5571 9.04718 18.6599 9.032C15.6591 9.43051 12.5897 9.43051 9.5889 9.0282C9.69172 9.04339 9.79073 9.05477 9.89355 9.06995C9.42134 9.00543 8.94532 8.92953 8.47692 8.84224C8.25986 8.80049 8.0466 8.75874 7.83334 8.7132C7.39922 8.62211 6.94986 8.48168 6.53477 8.73597C6.828 8.69801 7.12122 8.66006 7.41445 8.62211C7.17454 8.56518 6.9232 8.48168 6.67567 8.48168C6.77849 8.49686 6.8775 8.50825 6.98032 8.52343C6.88892 8.49307 6.79372 8.47789 6.69852 8.45511C6.33674 8.37162 5.99782 8.43234 5.70079 8.66006C5.39994 8.89157 5.28189 9.18381 5.25142 9.55575C5.25142 9.55955 5.25142 9.55955 5.25142 9.56334C5.73506 9.19899 6.21488 8.83085 6.69852 8.4665C6.51192 8.41716 6.31009 8.37162 6.11587 8.37162C6.21869 8.3868 6.3177 8.39818 6.42052 8.41337C6.32913 8.37541 6.23773 8.34126 6.14634 8.31089C6.41291 8.57656 6.67948 8.84224 6.94605 9.10791C6.81657 8.6259 6.4548 8.3868 6.00163 8.24637C5.84169 8.19703 5.67794 8.1439 5.51799 8.09077C5.1943 7.9807 4.87442 7.85925 4.55834 7.73021C4.64974 7.76817 4.74113 7.80612 4.83253 7.84407C4.50122 7.70365 4.17372 7.55183 3.85765 7.37725C3.70532 7.29375 3.5568 7.20646 3.41209 7.11158C3.34355 7.06604 3.275 7.02049 3.20645 6.97495C3.13029 6.92181 2.89038 6.72446 3.17599 6.95977C2.95512 6.77759 2.74186 6.59162 2.55526 6.37529C2.55145 6.3677 2.49052 6.30318 2.49052 6.29939C2.49433 6.29559 2.66951 6.54228 2.58192 6.41704C2.54384 6.36011 2.50195 6.30318 2.46387 6.24246C2.39532 6.13619 2.3382 6.02233 2.28869 5.90847C2.32677 5.99956 2.36486 6.09064 2.40294 6.18173C2.33058 6.01094 2.28108 5.83636 2.25442 5.65418C2.26965 5.75666 2.28108 5.85534 2.29631 5.95781C2.29631 5.94263 2.2925 5.93124 2.2925 5.91606C2.25442 5.60105 2.18968 5.34297 1.95738 5.11146C1.75936 4.9141 1.43567 4.76608 1.15006 4.77747C0.529331 4.80404 0.00761616 5.27845 0.00761616 5.91606C0.00761616 7.06604 0.00761616 8.21981 0.00761616 9.36978C0.00761616 10.1516 0.00761616 10.9296 0.00761616 11.7115C0.00761616 12.1669 -0.0190407 12.6224 0.0571221 13.074C0.175174 13.8027 0.624535 14.4707 1.14244 14.9792C1.45471 15.2867 1.80887 15.5523 2.17445 15.7952C2.34581 15.9091 2.51718 16.0116 2.69616 16.114C3.00462 16.2848 3.33974 16.4936 3.70151 16.4936C3.51111 16.4404 3.31689 16.3911 3.12648 16.3379C5.63986 17.5449 8.45788 18.0458 11.2188 18.2773C14.3986 18.5468 17.6469 18.395 20.7772 17.765C22.0796 17.5031 23.3439 17.1312 24.5663 16.6112C25.168 16.3569 25.7544 16.0609 26.2876 15.6814C26.8931 15.2487 27.4681 14.7401 27.8337 14.0797C28.0622 13.6661 28.2183 13.1992 28.2297 12.7248C28.2335 12.554 28.2297 12.3795 28.2297 12.2049C28.2297 11.4951 28.2297 10.7854 28.2297 10.0757C28.2297 8.73597 28.2297 7.40002 28.2297 6.06028C28.2297 6.03371 28.2297 6.00715 28.2297 5.98058C28.2297 5.38472 27.7042 4.81542 27.0873 4.84199C26.4551 4.86476 25.9334 5.33917 25.9334 5.97679Z\" fill=\"#DDDDDF\"/>\n      <path d=\"M25.9336 12.7703C25.9336 13.5407 25.9336 14.315 25.9336 15.0854C25.9336 16.3037 25.9336 17.522 25.9336 18.7403C25.9336 19.0211 25.9641 19.3247 25.9298 19.6056C25.9451 19.5031 25.9565 19.4044 25.9717 19.302C25.9451 19.469 25.8994 19.6322 25.8346 19.7916C25.8727 19.7005 25.9108 19.6094 25.9489 19.5183C25.8994 19.636 25.8384 19.746 25.7699 19.8561C25.7585 19.8751 25.6442 20.0193 25.648 20.0307C25.6442 20.0231 25.8384 19.7992 25.7356 19.9168C25.7128 19.9434 25.6937 19.9662 25.6709 19.9927C25.5719 20.1028 25.469 20.2091 25.3586 20.3077C25.2977 20.3647 25.2329 20.4178 25.1682 20.4709C25.153 20.4823 25.0806 20.5241 25.0806 20.543C25.0844 20.5089 25.3205 20.3647 25.1492 20.4899C24.6122 20.877 24.0143 21.1806 23.405 21.4387C23.4964 21.4008 23.5878 21.3628 23.6792 21.3249C21.9884 22.0346 20.1681 22.4217 18.3592 22.6646C18.4621 22.6494 18.5611 22.638 18.6639 22.6229C16.3143 22.9341 13.9304 22.9948 11.5655 22.824C10.9105 22.7785 10.2593 22.7102 9.61194 22.6229C9.71476 22.638 9.81377 22.6494 9.91659 22.6646C8.10011 22.4179 6.2722 22.0308 4.57758 21.3249C4.66898 21.3628 4.76037 21.4008 4.85177 21.4387C4.23104 21.1769 3.63697 20.8656 3.0886 20.4747C2.95912 20.3798 3.17619 20.5279 3.17999 20.5468C3.17619 20.5279 3.10764 20.4899 3.09241 20.4747C3.02767 20.4216 2.96674 20.3685 2.90581 20.3115C2.79537 20.2128 2.69255 20.1066 2.59354 19.9965C2.56688 19.9662 2.54023 19.932 2.51357 19.9016C2.42598 19.8105 2.67351 20.1218 2.60116 20.0193C2.56307 19.9624 2.51738 19.9054 2.4793 19.8447C2.40694 19.7308 2.34601 19.6132 2.28889 19.4879C2.32697 19.579 2.36505 19.6701 2.40313 19.7612C2.33078 19.5904 2.28127 19.4158 2.25462 19.2337C2.26985 19.3361 2.28127 19.4348 2.2965 19.5373C2.26985 19.3134 2.2927 19.0705 2.2927 18.8427C2.2927 18.3 2.2927 17.7573 2.2927 17.2146C2.2927 15.9925 2.2927 14.7742 2.2927 13.5521C2.2927 13.2674 2.2927 12.9866 2.2927 12.7019C1.53107 12.7019 0.769441 12.7019 0.0078125 12.7019C0.0687427 13.1764 0.167754 13.5749 0.396243 14.0037C0.579033 14.3453 0.834179 14.6641 1.10456 14.9374C1.41682 15.2524 1.7786 15.5257 2.14418 15.7723C2.32316 15.89 2.50595 16.0039 2.69255 16.1063C2.9972 16.2771 3.33994 16.4859 3.6979 16.4859C3.50749 16.4327 3.31328 16.3834 3.12287 16.3303C4.50903 16.9982 5.99421 17.4423 7.49842 17.7459C9.34537 18.1216 11.2342 18.319 13.1154 18.3759C15.1147 18.4328 17.1026 18.3228 19.0828 18.0495C20.686 17.8294 22.2854 17.4878 23.8011 16.9185C25.5985 16.243 27.8034 15.1537 28.188 13.0739C28.2452 12.7665 28.2337 12.4742 28.0738 12.1972C27.9367 11.9619 27.6625 11.7341 27.3921 11.6734C26.8323 11.5482 26.1012 11.8404 25.9869 12.4704C25.9527 12.664 25.907 12.85 25.8346 13.0321C25.8727 12.9411 25.9108 12.85 25.9489 12.7589C25.8917 12.8879 25.8232 13.0094 25.7432 13.127C25.7242 13.1536 25.7051 13.1802 25.6899 13.2067C25.6252 13.313 25.8651 12.998 25.7813 13.0929C25.7356 13.1422 25.6937 13.1953 25.6518 13.2447C25.549 13.3585 25.4424 13.461 25.3281 13.5635C25.271 13.6128 25.2139 13.6622 25.153 13.7077C25.0349 13.8026 25.2253 13.6546 25.2444 13.6356C25.2101 13.6698 25.1606 13.6963 25.1225 13.7229C24.5894 14.1024 23.9991 14.3947 23.3974 14.6489C23.4888 14.611 23.5802 14.573 23.6716 14.5351C21.9808 15.241 20.1605 15.6281 18.3478 15.871C18.4506 15.8558 18.5496 15.8445 18.6525 15.8293C16.3181 16.1405 13.9494 16.1898 11.6036 16.019C10.9638 15.9735 10.3241 15.9052 9.6843 15.8217C9.78712 15.8369 9.88613 15.8483 9.98895 15.8634C8.142 15.6129 6.28363 15.2182 4.55854 14.4933C4.64994 14.5313 4.74133 14.5692 4.83273 14.6072C4.47857 14.4592 4.09014 14.2049 3.70552 14.2049C3.89592 14.258 4.09014 14.3074 4.28055 14.3605C4.00255 14.2201 3.72456 14.0683 3.4618 13.9013C3.33993 13.8254 3.22188 13.7457 3.10764 13.6622C2.86392 13.4838 3.25616 13.7874 3.10764 13.666C3.05813 13.6242 3.00863 13.5825 2.95912 13.5407C2.86773 13.461 2.77633 13.3737 2.68874 13.2864C2.64685 13.2447 2.60877 13.1991 2.57069 13.1574C2.54023 13.1232 2.39552 12.9411 2.53642 13.1232C2.67351 13.3016 2.54023 13.1232 2.51357 13.0853C2.4831 13.0397 2.45645 12.9942 2.42598 12.9486C2.36886 12.8538 2.31935 12.7551 2.27746 12.6526C2.31555 12.7437 2.35363 12.8348 2.39171 12.9259C2.32697 12.7665 2.28508 12.6071 2.25842 12.4401C2.27366 12.5425 2.28508 12.6412 2.30031 12.7437C2.30031 12.7285 2.2965 12.7171 2.2965 12.7019C2.25842 12.3869 2.19369 12.1289 1.96139 11.8973C1.76337 11.7 1.43967 11.552 1.15406 11.5634C0.533336 11.5899 0.0116209 12.0643 0.0116209 12.7019C0.0116209 13.4269 0.0116209 14.148 0.0116209 14.8729C0.0116209 16.076 0.0116209 17.2791 0.0116209 18.4822C0.0116209 18.801 0.00781273 19.1198 0.0116209 19.4386C0.0268534 20.2584 0.449557 21.0099 0.978888 21.6095C1.66435 22.3876 2.62781 22.9379 3.57223 23.3478C4.47095 23.7387 5.39252 24.0537 6.34075 24.2928C8.5647 24.8583 10.8762 25.1164 13.1687 25.1771C15.5869 25.2416 18.0165 25.0746 20.3966 24.6306C21.3486 24.4522 22.293 24.2245 23.2146 23.9209C24.1514 23.6096 25.092 23.2339 25.9336 22.7102C26.8857 22.1181 27.7501 21.3249 28.1119 20.2394C28.2299 19.8789 28.2337 19.5221 28.2337 19.154C28.2337 18.0571 28.2337 16.9641 28.2337 15.8672C28.2337 14.8918 28.2337 13.9126 28.2337 12.9373C28.2337 12.8803 28.2337 12.8272 28.2337 12.7703C28.2337 12.1744 27.7082 11.6051 27.0913 11.6317C26.4553 11.6582 25.9336 12.1327 25.9336 12.7703Z\" fill=\"#DDDDDF\"/>\n      <path d=\"M25.9335 26.1867C25.9335 26.2626 25.9259 26.3423 25.9183 26.4183C25.9335 26.3158 25.945 26.2171 25.9602 26.1146C25.9373 26.2778 25.8916 26.4372 25.8269 26.5928C25.865 26.5017 25.9031 26.4107 25.9411 26.3196C25.8954 26.4296 25.8383 26.5359 25.7774 26.6384C25.7431 26.6953 25.7012 26.7522 25.6632 26.8054C25.606 26.8851 25.5032 26.9762 25.7698 26.6687C25.7507 26.6915 25.7317 26.7143 25.7127 26.7409C25.6251 26.8471 25.5299 26.9458 25.427 27.0407C25.3699 27.0938 25.3128 27.1469 25.2519 27.2001C25.1986 27.2456 24.9815 27.4164 25.1757 27.2646C25.3775 27.109 25.1376 27.2912 25.0843 27.3291C25.0158 27.3747 24.9472 27.424 24.8787 27.4658C24.734 27.5606 24.5854 27.6479 24.4331 27.7314C24.0942 27.9212 23.74 28.0882 23.3821 28.24C23.4735 28.202 23.5649 28.1641 23.6563 28.1261C21.9769 28.8283 20.168 29.2154 18.3668 29.4583C18.4696 29.4431 18.5686 29.4317 18.6714 29.4165C16.3066 29.7315 13.9036 29.7923 11.5235 29.6177C10.8761 29.5683 10.2326 29.5038 9.5928 29.4165C9.69562 29.4317 9.79463 29.4431 9.89745 29.4583C8.07716 29.2116 6.24926 28.8207 4.55082 28.1072C4.64222 28.1451 4.73362 28.1831 4.82501 28.221C4.47466 28.073 4.12812 27.9098 3.79301 27.72C3.64068 27.6365 3.49216 27.5455 3.34745 27.4506C3.27891 27.405 3.21036 27.3595 3.14181 27.3139C3.05042 27.2494 2.8067 27.0407 3.15324 27.3291C2.93237 27.1432 2.7153 26.961 2.5287 26.7371C2.50966 26.7143 2.49062 26.6915 2.47158 26.6649C2.36876 26.5473 2.6658 26.9306 2.57821 26.8016C2.54013 26.7446 2.49824 26.6915 2.46396 26.6346C2.39923 26.5321 2.34591 26.4258 2.29641 26.3158C2.33449 26.4069 2.37257 26.498 2.41065 26.589C2.34591 26.4372 2.30021 26.2778 2.27737 26.1108C2.2926 26.2133 2.30402 26.312 2.31925 26.4145C2.2926 26.2019 2.27737 25.9894 2.25071 25.7806C2.26594 25.8831 2.27737 25.9818 2.2926 26.0843C2.2926 25.3404 2.2926 24.5965 2.2926 23.8526C2.2926 22.6723 2.2926 21.492 2.2926 20.3154C2.2926 20.0422 2.2926 19.7689 2.2926 19.4956C1.53097 19.4956 0.769342 19.4956 0.00771404 19.4956C0.0762606 20.0346 0.209546 20.5279 0.506581 20.9948C0.776958 21.4198 1.1235 21.807 1.51955 22.122C2.37257 22.8013 3.3208 23.272 4.33757 23.6667C6.21117 24.3916 8.21426 24.7483 10.2059 24.976C12.4984 25.2379 14.8252 25.2645 17.1291 25.0709C19.1969 24.8963 21.2838 24.5699 23.2564 23.9096C24.2732 23.5718 25.3014 23.1543 26.1887 22.5433C26.7485 22.1599 27.2283 21.7311 27.632 21.1845C27.9899 20.6987 28.1537 20.1598 28.2298 19.5715C27.4682 19.5715 26.7066 19.5715 25.945 19.5715C25.945 20.3078 25.945 21.0479 25.945 21.7842C25.945 22.9456 25.945 24.1069 25.945 25.2683C25.9335 25.5719 25.9335 25.8793 25.9335 26.1867C25.9335 26.7826 26.4591 27.3519 27.076 27.3253C27.6967 27.2988 28.2184 26.8243 28.2184 26.1867C28.2184 25.4277 28.2184 24.6648 28.2184 23.9058C28.2184 22.733 28.2184 21.5641 28.2184 20.3913C28.2184 20.1181 28.2184 19.8448 28.2184 19.5715C28.2184 18.9757 27.6929 18.4064 27.076 18.4329C26.7789 18.4443 26.4743 18.543 26.2686 18.7669C26.0478 19.006 25.9754 19.2527 25.9335 19.5715C25.9335 19.5867 25.9297 19.5981 25.9297 19.6133C25.945 19.5108 25.9564 19.4121 25.9716 19.3097C25.945 19.4767 25.8993 19.6398 25.8345 19.7993C25.8726 19.7082 25.9107 19.6171 25.9488 19.526C25.8993 19.6436 25.8383 19.7537 25.7698 19.8638C25.7584 19.8827 25.6441 20.027 25.6479 20.0384C25.6441 20.0308 25.8383 19.8068 25.7355 19.9245C25.7127 19.9511 25.6936 19.9738 25.6708 20.0004C25.5718 20.1105 25.4689 20.2167 25.3585 20.3154C25.2976 20.3723 25.2328 20.4255 25.1681 20.4786C25.1529 20.49 25.0805 20.5317 25.0767 20.5507C25.0843 20.5166 25.3166 20.3723 25.1452 20.4976C24.6083 20.8847 24.0104 21.1883 23.4011 21.4464C23.4925 21.4085 23.5839 21.3705 23.6753 21.3326C21.9845 22.0423 20.1642 22.4294 18.3515 22.6723C18.4543 22.6571 18.5534 22.6457 18.6562 22.6305C16.3066 22.9418 13.9227 23.0025 11.5578 22.8317C10.9066 22.7862 10.2554 22.7178 9.60423 22.6305C9.70705 22.6457 9.80606 22.6571 9.90888 22.6723C8.09239 22.4256 6.2683 22.0385 4.57367 21.3326C4.66507 21.3705 4.75646 21.4085 4.84786 21.4464C4.22713 21.1845 3.63306 20.8733 3.08469 20.4824C2.95521 20.3875 3.17228 20.5355 3.17609 20.5545C3.17228 20.5355 3.10373 20.4976 3.0885 20.4824C3.02376 20.4293 2.96283 20.3761 2.9019 20.3192C2.79146 20.2205 2.68864 20.1143 2.58963 20.0042C2.56298 19.9738 2.53632 19.9397 2.50966 19.9093C2.42207 19.8182 2.6696 20.1294 2.59725 20.027C2.55917 19.97 2.51347 19.9131 2.47539 19.8524C2.40303 19.7385 2.3421 19.6209 2.28498 19.4956C2.32306 19.5867 2.36114 19.6778 2.39923 19.7689C2.32687 19.5981 2.27737 19.4235 2.25071 19.2413C2.26594 19.3438 2.27737 19.4425 2.2926 19.545C2.2926 19.5298 2.28879 19.5184 2.28879 19.5032C2.25071 19.1882 2.18597 18.9301 1.95367 18.6986C1.75565 18.5013 1.43196 18.3532 1.14635 18.3646C0.525621 18.3912 0.00390625 18.8656 0.00390625 19.5032C0.00390625 20.2585 0.00390625 21.0175 0.00390625 21.7728C0.00390625 22.9607 0.00390625 24.1525 0.00390625 25.3404C0.00390625 25.7389 0.00390602 26.107 0.05722 26.5017C0.0419874 26.3993 0.0305628 26.3006 0.0153302 26.1981C0.0267546 27.9136 1.51193 29.1243 2.91713 29.8454C4.98495 30.9081 7.30411 31.3977 9.5928 31.7013C12.289 32.0581 15.0384 32.096 17.7422 31.8114C20.1452 31.5609 22.5367 31.1017 24.753 30.1187C25.5489 29.7657 26.3105 29.3179 26.9579 28.7334C27.5025 28.2438 27.9899 27.5796 28.1423 26.8509C28.1879 26.6346 28.2184 26.4107 28.2222 26.1905C28.226 25.5947 27.6929 25.0254 27.0798 25.0519C26.4514 25.0747 25.9373 25.5453 25.9335 26.1867Z\" fill=\"#DDDDDF\"/>\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <rect width=\"28\" height=\"32\" fill=\"white\"/>\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import * as React from 'react'\n\nexport const Publication = () => (\n  <svg width=\"61\" height=\"76\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M60.047 0H.953C.427 0 0 .387 0 .864v74.272c0 .477.427.864.953.864h59.094c.526 0 .953-.387.953-.864V.864C61 .387 60.573 0 60.047 0zm-.953 74.273H1.906V1.727h57.188v72.546z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n    <path\n      d=\"M11.438 44.91c1.51 0 2.802-.802 3.42-1.955l8.988 1.629c-.006.108-.018.215-.018.325 0 1.666.745 3.175 1.948 4.268l-5.867 7.088a3.09 3.09 0 0 0-.846-.129c-1.58 0-2.86 1.16-2.86 2.591 0 1.431 1.28 2.591 2.86 2.591 1.58 0 2.86-1.16 2.86-2.59 0-.532-.178-1.025-.481-1.436l5.859-7.078c.95.472 2.04.74 3.2.74 1.233 0 2.385-.309 3.376-.837l8.83 10.003c-.477.576-.77 1.285-.77 2.062 0 1.908 1.708 3.454 3.813 3.454 2.106 0 3.813-1.546 3.813-3.454 0-1.908-1.707-3.455-3.813-3.455a4.11 4.11 0 0 0-1.557.308l-8.828-9.999c1.118-1.08 1.807-2.53 1.807-4.127 0-.49-.071-.963-.192-1.418l9.52-3.45c.694.853 1.803 1.414 3.063 1.414 2.105 0 3.812-1.547 3.812-3.455 0-1.908-1.707-3.455-3.812-3.455-2.106 0-3.813 1.547-3.813 3.455 0 .149.029.29.049.434l-9.527 3.452c-.823-1.288-2.153-2.277-3.746-2.737l2.123-11.544c1.945-.156 3.476-1.62 3.476-3.423 0-1.908-1.707-3.455-3.812-3.455-2.106 0-3.813 1.547-3.813 3.455 0 1.408.933 2.614 2.267 3.152L30.645 38.87c-.049 0-.096-.006-.145-.006-.734 0-1.438.111-2.099.31l-3.469-6.288c.495-.466.803-1.097.803-1.795 0-1.431-1.28-2.591-2.86-2.591-1.58 0-2.86 1.16-2.86 2.59 0 1.432 1.28 2.592 2.86 2.592.12 0 .232-.02.347-.032l3.474 6.296c-1.134.715-2.008 1.743-2.478 2.944L15.23 41.26C15.116 39.445 13.47 38 11.438 38c-2.106 0-3.813 1.547-3.813 3.455 0 1.907 1.707 3.454 3.813 3.454z\"\n      className=\"SRC-icon-fill\"\n    />\n    <path\n      d=\"M30.5 6.045H7.625v1.728H30.5V6.045zM22.875 9.932H7.625v.864h15.25v-.864z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n  </svg>\n)\n","import * as React from 'react'\n\nexport const Study = () => (\n  <svg width=\"61\" height=\"76\" viewBox=\"0 0 61 76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M39.456 57.627a2.799 2.799 0 0 0 2.79 2.801 2.798 2.798 0 0 0 2.787-2.8 2.798 2.798 0 0 0-2.788-2.803 2.8 2.8 0 0 0-2.789 2.802zm3.628 0a.843.843 0 0 1-.84.844.843.843 0 0 1-.84-.844c0-.467.376-.845.84-.845.464 0 .84.379.84.845z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n    <path\n      d=\"M37.349 21.019H28.92v1.957h8.428V21.02zM26.25 21H12v1.958h14.25V21zM26.34 24.933h-9.107v1.957h9.107v-1.957zM34.678 24.933h-5.757v1.958h5.757v-1.958zM14.667 24.933h-2.576v1.958h2.576v-1.958zM31.537 28.849h-5.213v1.957h5.212V28.85zM23.741 28.849h-11.65v1.957h11.65V28.85zM19.848 32.764H12.11v1.957h7.738v-1.957zM30.828 32.764h-8.4v1.958h8.4v-1.958zM20.533 36.678h-8.442v1.958h8.442v-1.958zM12.006 40.604l.004 1.957 5.874-.011-.004-1.958-5.874.012zM36.447 11.23H15v1.958h21.447V11.23zM32.674 16H19v1.958h13.674V16z\"\n      className=\"SRC-icon-fill\"\n    />\n    <path\n      d=\"M50.885 60.866h-2.834v-3.45C55.071 54.356 60 47.334 60 39.166c0-6.868-3.531-13.209-9.277-16.838l2.065-3.593 1.682.976.974-1.695-1.682-.976-8.757-5.081-1.693-.982-.974 1.695 1.692.982-1.824 3.174V6.054L7.791 6v25.527H0v14.87c0 2.24 1.59 4.112 3.694 4.538v.092l31.436.042-2.903 6.34.978.371c1.03.392 2.085.69 3.157.901v2.185H24.674V70h26.211c2.526 0 4.58-2.05 4.58-4.568s-2.054-4.566-4.58-4.566zM7.791 46.398a2.667 2.667 0 0 1-2.658 2.67h-.528a2.667 2.667 0 0 1-2.657-2.67V33.485h5.843v12.913zm41.19-7.232a8.82 8.82 0 0 1-6.775 8.58V37.153l2.998-5.219a8.789 8.789 0 0 1 3.776 7.232zM38.39 36.171l-2.063 3.59-2.612-1.517 2.062-3.59 2.613 1.517zM51.1 17.757L40.964 35.404l-5.385-3.124 10.14-17.647.538.313 4.845 2.81zM8.888 49.076a4.61 4.61 0 0 0 .852-2.678V7.96l30.52.048v12.21l-7.342 12.779 1.173.68-3.036 5.285 5.986 3.472 3.037-5.284.182.106v10.729l-.056.002a8.768 8.768 0 0 1-1.643-.161l1.164-2.026-13.412-7.781a1.87 1.87 0 0 0-.94-.254 1.89 1.89 0 0 0-1.633.945l-.451.787a1.901 1.901 0 0 0 .69 2.586L36.04 49.08l-.014.032-27.139-.036zm27.79-1.887l-11.67-6.77.387-.672 11.67 6.77-.388.672zm1.226 2.506c.753.166 1.523.25 2.3.25 5.914 0 10.726-4.835 10.726-10.779a10.75 10.75 0 0 0-4.266-8.606l2.619-5.723.474-.824a17.968 17.968 0 0 1 8.296 15.153c0 7.166-4.21 13.353-10.27 16.222-.708-2.176-2.74-3.756-5.135-3.756h-.88c-2.847 0-5.18 2.23-5.383 5.046a16.918 16.918 0 0 1-1.5-.388l3.019-6.595zm8.2 7.382v7.052h-7.792v-7.053c0-1.921 1.55-3.485 3.456-3.485h.88c1.906 0 3.456 1.564 3.456 3.486zm4.782 10.965H26.623v-5.219h9.74v3.263H48.05v-3.263h2.835c1.45 0 2.631 1.17 2.631 2.61.001 1.44-1.18 2.61-2.63 2.61z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n  </svg>\n)\n","import * as React from 'react'\n\nexport const ToolExperimental = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <g clipPath=\"url(#clip1)\">\n        <g clipPath=\"url(#clip2)\">\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M23.602 4c-.599 0-1.077.4-1.077.902v1.904c0 .602.478 1.003 1.077 1.003V26.85L10.556 46.496c-3.35 4.41-1.077 7.917 5.147 7.917h31.595c6.224 0 8.498-3.507 5.147-7.917L39.4 26.85V7.81c.598 0 1.077-.401 1.077-1.003V4.902c0-.501-.479-.902-1.077-.902H23.602zm.598 30.669l-9.335 14.032-.12.1c-.12.2-.598.902-.718 1.303.36.1 1.436.1 1.676.1h31.595c.24 0 1.317 0 1.676-.1-.12-.401-.598-1.103-.838-1.303v-.2l-9.335-13.932h-14.6zm3.232-27.462v20.446L13.787 48.1v.1c-1.676 2.205-1.197 3.007 1.915 3.007h31.595c3.112 0 3.591-.802 1.915-3.007v-.1L35.45 27.653V7.207h-8.019z\"\n            fill=\"#DCDCDC\"\n            className=\"SRC-header-only-fill\"\n          />\n          <path\n            d=\"M38.5 34.5h-14L14.5 50h34l-10-15.5z\"\n            fill=\"#5BB0B5\"\n            className=\"SRC-icon-fill\"\n          />\n        </g>\n      </g>\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <path fill=\"#fff\" d=\"M0 0h61v76H0z\" />\n      </clipPath>\n      <clipPath id=\"clip1\">\n        <path\n          fill=\"#fff\"\n          transform=\"matrix(.69 0 0 .69 2 4)\"\n          d=\"M0 0h85.507v85.507H0z\"\n        />\n      </clipPath>\n      <clipPath id=\"clip2\">\n        <path\n          fill=\"#fff\"\n          transform=\"matrix(.69 0 0 .69 9 4)\"\n          d=\"M0 0h65.217v73.063H0z\"\n        />\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import * as React from 'react'\n\nexport const ToolComputational = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <path\n        d=\"M55.513 13H4.537A2.518 2.518 0 0 0 2 15.537V51.94c0 1.357 1.121 2.537 2.537 2.537h20.532v4.602h-4.543c-.708 0-1.239.59-1.239 1.239v2.36c0 .708.59 1.239 1.239 1.239h19.057c.708 0 1.239-.59 1.239-1.239v-2.36c0-.708-.59-1.239-1.239-1.239H35.04v-4.602h20.532a2.518 2.518 0 0 0 2.537-2.537V15.537C58.05 14.121 56.929 13 55.513 13zM30.025 51.704c-.944 0-1.77-.767-1.77-1.77 0-.944.767-1.77 1.77-1.77.944 0 1.77.767 1.77 1.77 0 1.003-.826 1.77-1.77 1.77zm23.482-6.077H6.543V17.543h46.964v28.084z\"\n        fill=\"#DCDCDC\"\n        className=\"SRC-header-only-fill\"\n      />\n      <path\n        d=\"M20.29 38.827a.68.68 0 0 0 .908 0l1.623-1.57a.627.627 0 0 0 0-.878l-4.01-3.879 4.01-3.88a.627.627 0 0 0 0-.877l-1.623-1.57a.68.68 0 0 0-.908 0l-6.111 5.865a.627.627 0 0 0 0 .878l6.111 5.91zM38.226 37.257l1.614 1.57c.238.23.665.23.903 0l6.079-5.911a.63.63 0 0 0 0-.878l-6.127-5.865a.674.674 0 0 0-.902 0l-1.615 1.57a.63.63 0 0 0 0 .878l3.99 3.879-3.99 3.88c-.19.23-.19.646.048.877z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M27.558 39h1.74c.255 0 .467-.167.51-.376l4.159-11.872c.127-.376-.127-.752-.51-.752h-1.74c-.254 0-.466.167-.509.376l-4.16 11.872c-.169.376.128.752.51.752z\"\n        fill=\"#DCDCDC\"\n        className=\"SRC-header-only-fill\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <path\n          fill=\"#fff\"\n          transform=\"matrix(.69 0 0 .69 2 13)\"\n          d=\"M0 0h82.609v73.913H0z\"\n        />\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import * as React from 'react'\n\nexport const ToolClinical = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M54.878 1.124A3.804 3.804 0 0 0 52.175 0H45.8c-.705 0-1.274.573-1.274 1.279v2.557c0 .707.57 1.279 1.274 1.279h5.1v9.913c0 3.083-1.976 5.705-3.573 8.181-2.511 3.894-8.191 3.894-10.703.002-1.652-2.56-3.573-4.99-3.573-8.183V5.115h5.1c.705 0 1.275-.572 1.275-1.279V1.279C39.426.573 38.856 0 38.15 0h-6.374a3.81 3.81 0 0 0-2.705 1.124 3.828 3.828 0 0 0-1.12 2.713v8.549c0 4.436 1.34 8.565 3.598 12.379 4.024 6.794 7.877 9.084 7.77 12.776-.07 2.368 0 4.742 0 7.113 0 5.64-4.577 10.23-10.2 10.23h-2.444c-5.624 0-10.2-4.59-10.2-10.23v-9.223a8.945 8.945 0 0 0 6.375-8.576c0-4.943-3.997-8.952-8.925-8.952-4.93 0-8.925 4.009-8.925 8.952a8.944 8.944 0 0 0 6.375 8.576v9.222C11.377 53.13 18.225 60 26.675 60h2.445c8.449 0 15.3-6.871 15.3-15.346v-4.139c0-1.953-.054-5.56.797-7.319 2.834-2.275 6.055-4.642 7.755-8.099C55.375 21.373 56 16.822 56 12.387v-8.55a3.83 3.83 0 0 0-1.122-2.713zM9.145 26.855c0-2.642 2.146-4.795 4.781-4.795s4.781 2.153 4.781 4.795c0 2.644-2.146 4.796-4.78 4.796-2.637 0-4.782-2.152-4.782-4.796z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M14 36a9 9 0 1 0 0-18 9 9 0 0 0 0 18zm0-4a5 5 0 1 0 0-10 5 5 0 0 0 0 10z\"\n      className=\"SRC-icon-fill\"\n    />\n  </svg>\n)\n","import * as React from 'react'\n\nexport const Explore = () => (\n  <svg viewBox=\"0 0 24 24\" fill=\"#ffffff\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-5.5-2.5l7.51-3.49L17.5 6.5 9.99 9.99 6.5 17.5zm5.5-6.6c.61 0 1.1.49 1.1 1.1s-.49 1.1-1.1 1.1-1.1-.49-1.1-1.1.49-1.1 1.1-1.1z\"></path>\n  </svg>\n)","import * as React from 'react'\n\nexport const Search = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M5.94286 0C7.519 0 9.03059 0.62612 10.1451 1.74062C11.2596 2.85512 11.8857 4.36671 11.8857 5.94286C11.8857 7.41486 11.3463 8.768 10.4594 9.81029L10.7063 10.0571H11.4286L16 14.6286L14.6286 16L10.0571 11.4286V10.7063L9.81029 10.4594C8.768 11.3463 7.41486 11.8857 5.94286 11.8857C4.36671 11.8857 2.85512 11.2596 1.74062 10.1451C0.62612 9.03059 0 7.519 0 5.94286C0 4.36671 0.62612 2.85512 1.74062 1.74062C2.85512 0.62612 4.36671 0 5.94286 0V0ZM5.94286 1.82857C3.65714 1.82857 1.82857 3.65714 1.82857 5.94286C1.82857 8.22857 3.65714 10.0571 5.94286 10.0571C8.22857 10.0571 10.0571 8.22857 10.0571 5.94286C10.0571 3.65714 8.22857 1.82857 5.94286 1.82857Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const Chart = () => (\n  <svg width=\"20\" height=\"16\" viewBox=\"0 0 20 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M20 16H0V0H2V14.2222H4V6.22222H8V14.2222H10V2.66667H14V14.2222H16V9.77778H20V16Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const Filter = () => (\n  <svg width=\"13\" height=\"16\" viewBox=\"0 0 13 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M0 0H12.8V1.53037H12.7431L7.82222 6.82544V16L4.97778 12.9393V6.81779L0.0639999 1.53037H0V0Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const Download = () => (\n  <svg width=\"12\" height=\"16\" viewBox=\"0 0 12 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M0 16H11.9216V14.1176H0V16ZM11.9216 5.64706H8.51541V0H3.40616V5.64706H0L5.96078 12.2353L11.9216 5.64706Z\" fill=\"#47337D\"/>\n  </svg>\n)\n","import * as React from 'react'\n\nexport const Expand = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M6.22222 16V14.2222H3.03111L7.03111 10.2222L5.77778 8.96889L1.77778 12.9689V9.77778H0V16H6.22222ZM10.2222 7.03111L14.2222 3.03111V6.22222H16V0H9.77778V1.77778H12.9689L8.96889 5.77778L10.2222 7.03111Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const Collapse = () => (\n  <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M14.734 -7.70646e-08L10.6936 4.0404V0.81706H8.89787V7.10213H15.1829V5.3064H11.9596L16 1.26599L14.734 -7.70646e-08ZM0.81706 8.89787V10.6936H4.0404L-7.70646e-08 14.734L1.26599 16L5.3064 11.9596V15.1829H7.10213V8.89787H0.81706Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const Close = () => (\n  <svg width=\"13\" height=\"12\" viewBox=\"0 0 13 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M12.3887 1.20857L11.1801 0L6.38867 4.79143L1.59724 0L0.388672 1.20857L5.1801 6L0.388672 10.7914L1.59724 12L6.38867 7.20857L11.1801 12L12.3887 10.7914L7.59724 6L12.3887 1.20857Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const SortUp = () => (\n  <svg width=\"21\" height=\"17\" viewBox=\"0 0 21 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M8.5 7.5V9.5H16.5V7.5H8.5ZM8.5 1.5V3.5H12.5V1.5H8.5ZM8.5 13.5V15.5H20.5V13.5H8.5ZM4.5 3.5H7L3.5 0L0 3.5H2.5V16.5H4.5V3.5Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const SortDown = () => (\n  <svg width=\"21\" height=\"17\" viewBox=\"0 0 21 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M8.5 9V7H16.5V9H8.5ZM8.5 15V13H12.5V15H8.5ZM8.5 3V1H20.5V3H8.5ZM4.5 13H7L3.5 16.5L0 13H2.5V0H4.5V13Z\" fill=\"#47337D\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const Settings = () => (\n  <svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <mask id=\"mask0\" mask-type=\"alpha\" maskUnits=\"userSpaceOnUse\" x=\"10\" y=\"10\" width=\"20\" height=\"20\">\n      <path d=\"M27.4301 20.98C27.4701 20.66 27.5001 20.34 27.5001 20C27.5001 19.66 27.4701 19.34 27.4301 19.02L29.5401 17.37C29.7301 17.22 29.7801 16.95 29.6601 16.73L27.6601 13.27C27.5401 13.05 27.2701 12.97 27.0501 13.05L24.5601 14.05C24.0401 13.65 23.4801 13.32 22.8701 13.07L22.4901 10.42C22.4601 10.18 22.2501 10 22.0001 10H18.0001C17.7501 10 17.5401 10.18 17.5101 10.42L17.1301 13.07C16.5201 13.32 15.9601 13.66 15.4401 14.05L12.9501 13.05C12.7201 12.96 12.4601 13.05 12.3401 13.27L10.3401 16.73C10.2101 16.95 10.2701 17.22 10.4601 17.37L12.5701 19.02C12.5301 19.34 12.5001 19.67 12.5001 20C12.5001 20.33 12.5301 20.66 12.5701 20.98L10.4601 22.63C10.2701 22.78 10.2201 23.05 10.3401 23.27L12.3401 26.73C12.4601 26.95 12.7301 27.03 12.9501 26.95L15.4401 25.95C15.9601 26.35 16.5201 26.68 17.1301 26.93L17.5101 29.58C17.5401 29.82 17.7501 30 18.0001 30H22.0001C22.2501 30 22.4601 29.82 22.4901 29.58L22.8701 26.93C23.4801 26.68 24.0401 26.34 24.5601 25.95L27.0501 26.95C27.2801 27.04 27.5401 26.95 27.6601 26.73L29.6601 23.27C29.7801 23.05 29.7301 22.78 29.5401 22.63L27.4301 20.98V20.98ZM20.0001 23.5C18.0701 23.5 16.5001 21.93 16.5001 20C16.5001 18.07 18.0701 16.5 20.0001 16.5C21.9301 16.5 23.5001 18.07 23.5001 20C23.5001 21.93 21.9301 23.5 20.0001 23.5Z\" fill=\"#9E9E9E\"/>\n    </mask>\n    <g mask=\"url(#mask0)\">\n      <rect width=\"40\" height=\"40\" fill=\"#ffffff\"/>\n    </g>\n  </svg>\n)","import * as React from 'react'\n\nexport const Columns = () => (\n  <svg width=\"19\" height=\"16\" viewBox=\"0 0 19 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <rect width=\"5.33333\" height=\"16\" fill=\"#ffffff\"/>\n    <rect x=\"6.66797\" width=\"5.33333\" height=\"16\" fill=\"#ffffff\"/>\n    <rect x=\"13.832\" y=\"0.5\" width=\"4.33333\" height=\"15\" fill=\"none\" stroke=\"#ffffff\"/>\n  </svg>\n)","import * as React from 'react'\n\nexport const ColumnsDark = () => (\n  <svg\n    className=\"SRC-column-dark-theme\"\n    width=\"27\"\n    height=\"28\"\n    viewBox=\"0 0 27 28\"\n    fill=\"#white\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n  >\n    <rect\n      className=\"SRC-primary-fill-color\"\n      x=\"4\"\n      y=\"6\"\n      width=\"5.66667\"\n      height=\"17\"\n    />\n    <rect\n      className=\"SRC-primary-fill-color\"\n      x=\"11.0837\"\n      y=\"6\"\n      width=\"5.66667\"\n      height=\"17\"\n    />\n    <rect\n      style={{ fill: 'none' }}\n      className=\"SRC-primary-stroke-color\"\n      x=\"18.6663\"\n      y=\"6.5\"\n      width=\"4.66667\"\n      height=\"16\"\n    />\n  </svg>\n)","import * as React from 'react'\n\nexport const VerticalDots = () => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"></path>\n  </svg>\n)","import { CardFooter, Icon } from './row_renderers/utils'\nimport { MarkdownValue } from './CardContainerLogic'\nimport MarkdownSynapse from './MarkdownSynapse'\nimport React, { useState, useEffect } from 'react'\nimport getColorPallette from './ColorGradient'\n\nexport type IconOptions = {\n  [index: string]: string\n}\nexport type HeaderCardProps = {\n  iconOptions?: IconOptions\n  backgroundColor?: string\n  rgbIndex?: number\n  type: string\n  title: string\n  subTitle: string\n  description: string\n  iconValue: string\n  secondaryLabelLimit?: number\n  values?: string[][]\n  isAlignToLeftNav?: boolean\n  descriptionLinkConfig?: MarkdownValue\n  href?: string\n  target?: string\n}\n\nconst HeaderCard: React.FunctionComponent<HeaderCardProps> = ({\n  type,\n  title,\n  subTitle,\n  description,\n  iconOptions,\n  iconValue,\n  backgroundColor,\n  values,\n  secondaryLabelLimit,\n  isAlignToLeftNav,\n  descriptionLinkConfig,\n  href,\n  target,\n  rgbIndex,\n}) => {\n  // store old document title and description so that we can restore when this component is removed\n  const descriptionElement: Element | null = document.querySelector(\n    'meta[name=\"description\"]',\n  )\n  const [docTitle] = useState<string>(document.title)\n  const [docDescription] = useState<string>(\n    descriptionElement ? descriptionElement.getAttribute('content')! : '',\n  )\n  useEffect(() => {\n    // update page title and description based on header card values\n    if (title && document.title !== title) {\n      document.title = title\n    }\n\n    if (description || subTitle) {\n      descriptionElement?.setAttribute(\n        'content',\n        description ? description : subTitle,\n      )\n    }\n\n    return function cleanup() {\n      document.title = docTitle\n      descriptionElement?.setAttribute('content', docDescription)\n    }\n  })\n\n  const backgroundColorUsed =\n    rgbIndex !== undefined\n      ? getColorPallette(rgbIndex, 1).colorPalette[0]\n      : backgroundColor\n  const style: React.CSSProperties = {\n    background: backgroundColorUsed,\n  }\n  return (\n    <div\n      style={style}\n      className={`SRC-portalCardHeader ${\n        isAlignToLeftNav ? 'isAlignToLeftNav' : ''\n      }`}\n    >\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <div\n            className={`iconContainer${\n              isAlignToLeftNav ? ' col-md-offset-1 col-md-2' : ' col-md-1'\n            }`}\n          >\n            <Icon value={iconValue} iconOptions={iconOptions} type={type} />\n          </div>\n          <div\n            className={`SRC-cardContent${\n              isAlignToLeftNav ? ' col-md-8' : ' col-md-10'\n            }`}\n          >\n            <div className=\"SRC-type\">{type}</div>\n            <div>\n              <h3\n                className=\"SRC-boldText SRC-blackText\"\n                style={{ margin: 'none' }}\n              >\n                {href ? (\n                  <a target={target} href={href}>\n                    {title}\n                  </a>\n                ) : (\n                  <span> {title} </span>\n                )}\n              </h3>\n            </div>\n            {subTitle && <div className=\"SRC-author\"> {subTitle} </div>}\n            {description && (\n              <span className=\"SRC-font-size-base\">\n                {descriptionLinkConfig ? (\n                  <MarkdownSynapse markdown={description} />\n                ) : (\n                  description\n                )}\n              </span>\n            )}\n            <div\n              style={{\n                borderTop: '1px solid rgba(26, 28, 41, 0.2)',\n                marginTop: '15px',\n                paddingTop: '5px',\n              }}\n            >\n              {values && (\n                <CardFooter\n                  isHeader={true}\n                  secondaryLabelLimit={secondaryLabelLimit}\n                  values={values}\n                />\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default HeaderCard\n","import * as React from 'react'\nconst CHAR_COUNT_CUTOFF = 400\n\ntype ShowMoreState = {\n  showMore: boolean\n}\n\ntype ShowMoreProps = {\n  summary: string\n}\n\nexport default class ShowMore extends React.Component<\n  ShowMoreProps,\n  ShowMoreState\n> {\n  constructor(props: ShowMoreProps) {\n    super(props)\n    this.state = {\n      showMore: false,\n    }\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n  }\n\n  public toggleShowMore(event: React.MouseEvent<HTMLAnchorElement>) {\n    event.preventDefault()\n    this.setState({\n      showMore: true,\n    })\n  }\n\n  getCutoff = (summary: string) => {\n    let previewText = ''\n    if (!summary) {\n      return { previewText }\n    }\n    let hiddenText = ''\n    const summarySplit = summary!.split(' ')\n    // find num words to join such that its >= char_count_cutoff\n    let i = 0\n    while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n      previewText += `${summarySplit[i]} `\n      i += 1\n    }\n    if (i < summarySplit.length - 1) {\n      hiddenText = summarySplit.slice(i).join(' ')\n    }\n    return { previewText, hiddenText }\n  }\n\n  public render() {\n    const { summary } = this.props\n    const meetsCharRequirements = summary && summary.length >= CHAR_COUNT_CUTOFF\n    let { previewText, hiddenText } = this.getCutoff(summary)\n    const showMoreButton = meetsCharRequirements && (\n      <a\n        style={{ fontSize: '14px', cursor: 'pointer', marginLeft: '1px' }}\n        className=\"SRC-primary-text-color\"\n        onClick={this.toggleShowMore}\n      >\n        ...Show More\n      </a>\n    )\n    return (\n      <React.Fragment>\n        <span>\n          {previewText}\n          <span className={this.state.showMore ? '' : 'SRC-hidden'}>\n            {hiddenText}\n          </span>\n        </span>\n        {!this.state.showMore && showMoreButton}\n      </React.Fragment>\n    )\n  }\n}\n","export const unCamelCase = (\n  str: string | undefined,\n  facetAliases?: {},\n): string | undefined => {\n  // https://stackoverflow.com/questions/4149276/how-to-convert-camelcase-to-camel-case\n  if (!str) {\n    return str\n  }\n  if (facetAliases?.[str]) {\n    return facetAliases[str]\n  }\n  return (\n    str\n      // insert a space between lower & upper\n      .replace(/([a-z])([A-Z])/g, '$1 $2')\n      // space before last upper in a sequence followed by lower\n      .replace(/\\b([A-Z]+)([A-Z])([a-z])/, '$1 $2$3')\n      // uppercase the first character\n      .replace(/^./, (str: string) => {\n        return str.toUpperCase()\n      })\n  )\n}\n","import { FileHandleAssociateType } from '../../utils/synapseTypes'\nimport React from 'react'\nimport { SynapseConstants, SynapseClient } from '../../utils'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\ntype FileHandleLinkProps = {\n  token: string | undefined\n  fileHandleId: string\n  redirect?: boolean\n  showDownloadIcon: boolean\n  tableEntityConcreteType: string | undefined\n  rowId: string | undefined\n  tableId: string | undefined\n  displayValue: string | undefined\n}\nexport const FileHandleLink = (props: FileHandleLinkProps) => {\n  const {\n    token,\n    fileHandleId,\n    showDownloadIcon,\n    tableEntityConcreteType,\n    rowId,\n    tableId,\n    redirect = false,\n    displayValue,\n  } = props\n\n  if (!tableEntityConcreteType) {\n    // still loading\n    return <></>\n  }\n  const isFileView = tableEntityConcreteType.includes('EntityView')\n  const fileAssociateType: FileHandleAssociateType = isFileView\n    ? FileHandleAssociateType.FileEntity\n    : FileHandleAssociateType.TableEntity\n  const fileAssociateId = isFileView ? rowId : tableId\n  return (\n    <button\n      // @ts-ignore\n      onClick={() => {\n        if (token && fileAssociateId) {\n          SynapseClient.getActualFileHandleByIdURL(\n            fileHandleId,\n            token,\n            fileAssociateType,\n            fileAssociateId,\n            redirect,\n          )\n        }\n      }}\n      className={`SRC-primary-text-color ${SynapseConstants.SRC_SIGN_IN_CLASS}`}\n      type=\"button\"\n      style={{ padding: 0 }}\n    >\n      {displayValue ?? fileHandleId}\n      {showDownloadIcon && (\n        <FontAwesomeIcon style={{ marginLeft: 5 }} icon=\"download\" />\n      )}\n    </button>\n  )\n}\n","import * as React from 'react'\nimport HeaderCard from './HeaderCard'\nimport { CardFooter, Icon } from './row_renderers/utils'\nimport {\n  CardLink,\n  CommonCardProps,\n  MarkdownLink,\n  MarkdownValue,\n} from './CardContainerLogic'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport MarkdownSynapse from './MarkdownSynapse'\nimport { SelectColumn, ColumnModel, ColumnType } from '../utils/synapseTypes'\nimport { SynapseConstants } from '../utils'\nimport { FileHandleLink } from './widgets/FileHandleLink'\n\nexport type KeyToAlias = {\n  key: string\n  alias?: string\n}\n\nexport type KeyToAliasMap = {\n  [index: number]: KeyToAlias\n  [index: string]: KeyToAlias\n}\n\nexport type GenericCardSchema = {\n  type: string\n  title: string\n  subTitle?: string\n  description?: string\n  icon?: string\n  secondaryLabels?: any[]\n  link?: string\n}\n\nexport type IconOptions = {\n  [index: string]: string\n}\n\nexport type GenericCardProps = {\n  selectColumns?: SelectColumn[]\n  columnModels?: ColumnModel[]\n  facetAliases?: {}\n  iconOptions?: IconOptions\n  backgroundColor?: string\n  isHeader?: boolean\n  isAlignToLeftNav?: boolean\n  schema: any\n  data: any\n  token?: string\n  tableEntityConcreteType: string | undefined\n  tableId: string | undefined\n} & CommonCardProps\n\nexport type GenericCardState = {\n  hasClickedShowMore: boolean\n}\n\nconst CHAR_COUNT_CUTOFF = 400\nexport const CARD_SHORT_DESCRIPTION_CSS = 'SRC-short-description'\nexport const CARD_LONG_DESCRIPTION_CSS = 'SRC-long-description'\n\n// doi regex here - https://www.crossref.org/blog/dois-and-matching-regular-expressions/\n// note - had to add an escape character for the second slash in the regex above\nexport const DOI_REGEX = /^10.\\d{4,9}\\/[-._;()/:a-z0-9]+$/i\n// check for 'syn' followed and ended by a digit of unlimited length, must also begin the line\nexport const SYNAPSE_REGX = /^syn\\d+\\.?\\d+$/\n\n// This function isn't in the class only for ease of testing with renderShortDescription\nexport const getCutoff = (summary: string) => {\n  let previewText = ''\n  const summarySplit = summary!.split(' ')\n  // find num words to join such that its >= char_count_cutoff\n  let i = 0\n  while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n    previewText += `${summarySplit[i]} `\n    i += 1\n  }\n  previewText = previewText.trim()\n  return { previewText }\n}\n\nexport const renderValueOrMultiValue = ({\n  columnName,\n  value,\n  selectColumns,\n  columnModels,\n}: {\n  columnName: string | undefined\n  value: string\n  selectColumns?: SelectColumn[]\n  columnModels?: ColumnModel[]\n}): ValueOrMultiValue => {\n  if (!value) {\n    return {\n      str: '',\n      strList: undefined,\n    }\n  }\n  const selectedColumnOrUndefined =\n    selectColumns?.find(el => el.name === columnName) ||\n    columnModels?.find(el => el.name === columnName)\n  const isMultiValue =\n    selectedColumnOrUndefined?.columnType === 'STRING_LIST' ||\n    selectedColumnOrUndefined?.columnType === 'INTEGER_LIST'\n\n  if (isMultiValue) {\n    let val: any = value\n    let strList: any\n    try {\n      strList = JSON.parse(val)\n      val = (strList as string[]).join(', ')\n      return {\n        strList,\n        str: val,\n      }\n    } catch (e) {\n      console.error(\n        'Could not parse multivalue string ',\n        val,\n        ' caught err ',\n        e,\n      )\n    }\n  }\n  return { str: value }\n}\n\nexport const renderLabel = (args: {\n  value: string\n  columnName: string\n  labelLink: CardLink | MarkdownLink | undefined\n  selectColumns: SelectColumn[] | undefined\n  columnModels: ColumnModel[] | undefined\n  isHeader: boolean\n}) => {\n  const {\n    value,\n    columnName,\n    labelLink,\n    selectColumns,\n    columnModels,\n    isHeader,\n  } = args\n  if (!value) {\n    return value\n  }\n  const { strList, str } = renderValueOrMultiValue({\n    columnName,\n    value,\n    selectColumns,\n    columnModels,\n  })\n\n  if (!labelLink || !str) {\n    // they either don't need a link or the array came back empty\n    return str\n  }\n\n  if (labelLink.isMarkdown) {\n    if (strList) {\n      return strList.map((el, index) => {\n        return (\n          <>\n            <MarkdownSynapse key={el} renderInline={true} markdown={el} />\n            {index < strList.length - 1 && ','}\n          </>\n        )\n      })\n    } else {\n      return <MarkdownSynapse renderInline={true} markdown={value} />\n    }\n  }\n  const split = strList ? strList : str.split(',')\n  let className = ''\n  const style: React.CSSProperties = {}\n  if (isHeader) {\n    className = 'SRC-lightLink'\n  } else {\n    className = 'SRC-primary-text-color'\n  }\n  return split.map((el, index) => {\n    const { baseURL, URLColumnName, wrapValueWithParens } = labelLink\n    const value = wrapValueWithParens ? `(${el})` : el\n    const href = `/${baseURL}?${URLColumnName}=${value}`\n    return (\n      <React.Fragment key={el}>\n        <a href={href} key={el} className={className} style={style}>\n          {el}\n        </a>\n        {index < split.length - 1 && <span style={{ marginRight: 4 }}>, </span>}\n      </React.Fragment>\n    )\n  })\n}\n\ntype ValueOrMultiValue = {\n  str: string\n  strList?: string[]\n}\n\nexport default class GenericCard extends React.Component<\n  GenericCardProps,\n  GenericCardState\n> {\n  constructor(props: GenericCardProps) {\n    super(props)\n    this.state = {\n      hasClickedShowMore: false,\n    }\n    this.getTitleParams = this.getTitleParams.bind(this)\n    this.renderLongDescription = this.renderLongDescription.bind(this)\n    this.renderShortDescription = this.renderShortDescription.bind(this)\n  }\n\n  public getTitleParams(\n    link: string,\n    titleLink: CardLink | undefined,\n    data: string[] | undefined,\n    schema: any | undefined,\n  ): {\n    href: string\n    target: string\n  } {\n    let href = link\n    let target = '_self'\n    if (link.match(SYNAPSE_REGX)) {\n      // its a synId\n      href = `https://www.synapse.org/#!Synapse:${link}`\n    } else if (link.match(DOI_REGEX)) {\n      target = '_blank'\n      href = `https://dx.doi.org/${link}`\n    } else if (!titleLink) {\n      target = '_blank'\n    } else if (titleLink) {\n      if (!data || !schema) {\n        throw Error('Must specify CardLink and data for linking to work')\n      }\n      const { matchColumnName, URLColumnName } = titleLink\n      const indexInData = schema[matchColumnName]\n      if (indexInData === undefined) {\n        console.error(\n          `Could not find match for data: ${data} with columnName ${matchColumnName}`,\n        )\n      } else {\n        const value = data[indexInData]\n        href = `/${titleLink.baseURL}?${URLColumnName}=${value}`\n      }\n    }\n    return { href, target }\n  }\n\n  getCutoff = (summary: string) => {\n    let previewText = ''\n    const summarySplit = summary!.split(' ')\n    // find num words to join such that its >= char_count_cutoff\n    let i = 0\n    while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n      previewText += `${summarySplit[i]} `\n      i += 1\n    }\n    previewText = previewText.trim()\n    return { previewText }\n  }\n\n  toggleShowMore = () => {\n    this.setState({\n      hasClickedShowMore: true,\n    })\n  }\n\n  renderTitle = ({\n    href,\n    target,\n    titleSearchHandle,\n    title,\n  }: {\n    target: string\n    titleSearchHandle: string | undefined\n    title: string\n    href: string\n  }) => {\n    if (href) {\n      return (\n        <a\n          data-search-handle={titleSearchHandle}\n          className=\"SRC-primary-text-color\"\n          target={target}\n          href={href}\n        >\n          {title}\n        </a>\n      )\n    } else {\n      return <span data-search-handle={titleSearchHandle}> {title} </span>\n    }\n  }\n\n  render() {\n    const {\n      schema,\n      data,\n      genericCardSchema,\n      secondaryLabelLimit,\n      backgroundColor,\n      selectColumns,\n      columnModels,\n      iconOptions,\n      isHeader = false,\n      titleLinkConfig,\n      labelLinkConfig,\n      facetAliases = {},\n      descriptionLinkConfig,\n      rgbIndex,\n      tableId,\n      tableEntityConcreteType,\n      token,\n    } = this.props\n    // GenericCard inherits properties from CommonCardProps so that the properties have the same name\n    // and type, but theres one nuance which is that we can't override if one specific property will be\n    // defined, so we assert genericCardSchema is not null and assign to genericCardSchemaDefined\n    const genericCardSchemaDefined = genericCardSchema!\n    const { hasClickedShowMore } = this.state\n    const { link = '', type } = genericCardSchemaDefined\n    const title = data[schema[genericCardSchemaDefined.title]]\n    let subTitle =\n      genericCardSchemaDefined.subTitle &&\n      data[schema[genericCardSchemaDefined.subTitle]]\n    subTitle =\n      genericCardSchemaDefined?.subTitle &&\n      renderValueOrMultiValue({\n        value: subTitle,\n        columnName: genericCardSchemaDefined?.subTitle,\n        selectColumns,\n        columnModels,\n      }).str\n    const description = data[schema[genericCardSchemaDefined.description || '']]\n    const iconValue = data[schema[genericCardSchemaDefined.icon || '']]\n    const titleColumnModel = columnModels?.find(\n      el => genericCardSchemaDefined.link === el.name,\n    )\n    const titleColumnType = titleColumnModel?.columnType\n    // wrap link in parens because undefined would throw an error\n    const linkValue: string = data[schema[link]] || ''\n    const { href, target } = this.getTitleParams(\n      linkValue,\n      titleLinkConfig,\n      data,\n      schema,\n    )\n    const values: string[][] = []\n    const { secondaryLabels = [] } = genericCardSchemaDefined\n    for (let i = 0; i < secondaryLabels.length; i += 1) {\n      const columnName = secondaryLabels[i]\n      let value = data[schema[columnName]]\n      if (value) {\n        const labelLink = labelLinkConfig?.find(\n          el => el.matchColumnName === columnName,\n        )\n        value = renderLabel({\n          value,\n          columnName,\n          labelLink,\n          isHeader,\n          selectColumns,\n          columnModels,\n        })\n        const columnDisplayName = unCamelCase(columnName, facetAliases)\n        const keyValue = [columnDisplayName, value]\n        values.push(keyValue)\n      }\n    }\n\n    const showFooter = values.length > 0\n\n    const style: React.CSSProperties = {\n      background: backgroundColor,\n      // undefined, take default value from class\n      marginTop: isHeader ? '0px' : undefined,\n      marginBottom: isHeader ? '0px' : undefined,\n      paddingBottom: showFooter ? undefined : '15px',\n    }\n\n    if (isHeader) {\n      return (\n        <HeaderCard\n          descriptionLinkConfig={descriptionLinkConfig}\n          type={type}\n          title={title}\n          subTitle={subTitle}\n          backgroundColor={backgroundColor}\n          description={description}\n          iconValue={iconValue}\n          iconOptions={iconOptions}\n          values={values}\n          href={href}\n          target={target}\n          isAlignToLeftNav={true}\n          secondaryLabelLimit={secondaryLabelLimit}\n          rgbIndex={rgbIndex}\n        />\n      )\n    }\n\n    const titleSearchHandle = unCamelCase(\n      genericCardSchemaDefined.title,\n      facetAliases,\n    )\n    const stubTitleSearchHandle = unCamelCase(\n      genericCardSchemaDefined.subTitle,\n      facetAliases,\n    )\n    const descriptionSubTitle = unCamelCase(\n      genericCardSchemaDefined.description,\n      facetAliases,\n    )\n\n    return (\n      <div style={style} className={'SRC-portalCard'}>\n        <div className=\"SRC-cardThumbnail\">\n          <Icon iconOptions={iconOptions} value={iconValue} type={type} />\n        </div>\n        <div className=\"SRC-cardContent\">\n          <div className=\"SRC-type\">{type}</div>\n          <div>\n            <h3\n              className=\"SRC-boldText SRC-blackText\"\n              style={{ margin: 'none' }}\n            >\n              {!titleLinkConfig &&\n              titleColumnType === ColumnType.FILEHANDLEID ? (\n                <FileHandleLink\n                  token={token}\n                  fileHandleId={linkValue}\n                  tableEntityConcreteType={tableEntityConcreteType}\n                  showDownloadIcon={type !== SynapseConstants.EXPERIMENTAL}\n                  rowId={data![schema.id]}\n                  tableId={tableId}\n                  displayValue={title}\n                />\n              ) : (\n                this.renderTitle({\n                  href,\n                  target,\n                  titleSearchHandle,\n                  title,\n                })\n              )}\n            </h3>\n          </div>\n          {subTitle && (\n            <div\n              data-search-handle={stubTitleSearchHandle}\n              className=\"SRC-author\"\n            >\n              {subTitle}\n            </div>\n          )}\n          {/* \n            Below is a hack that allows word highlighting to work, the Search component insert's\n            html elements outside of the React DOM which if detected would break the app,\n            but as written below this avoids that reconcilliation process.\n          */}\n          {description &&\n            this.renderShortDescription(\n              description,\n              hasClickedShowMore,\n              descriptionSubTitle,\n              descriptionLinkConfig,\n            )}\n          {description &&\n            this.renderLongDescription(\n              description,\n              hasClickedShowMore,\n              descriptionSubTitle,\n              descriptionLinkConfig,\n              this.props.token,\n            )}\n        </div>\n        {showFooter && (\n          <CardFooter\n            isHeader={false}\n            secondaryLabelLimit={secondaryLabelLimit}\n            values={values}\n          />\n        )}\n      </div>\n    )\n  }\n\n  public renderLongDescription(\n    description: string,\n    hasClickedShowMore: boolean,\n    descriptionSubTitle: any,\n    descriptionLinkConfig?: MarkdownValue,\n    token?: string,\n  ): React.ReactNode {\n    let content: JSX.Element | string = description\n    if (descriptionLinkConfig?.isMarkdown) {\n      content = <MarkdownSynapse token={token} markdown={content} />\n    }\n    const show = hasClickedShowMore || descriptionLinkConfig\n    return (\n      <div className={show ? '' : 'SRC-hidden'}>\n        <span\n          data-search-handle={descriptionSubTitle}\n          className={`SRC-font-size-base ${CARD_LONG_DESCRIPTION_CSS}`}\n        >\n          {content}\n        </span>\n      </div>\n    )\n  }\n\n  public renderShortDescription(\n    description: string,\n    hasClickedShowMore: boolean,\n    descriptionSubTitle: any,\n    descriptionLinkConfig?: MarkdownValue,\n  ): React.ReactNode {\n    if (descriptionLinkConfig) {\n      return <></>\n    }\n    return (\n      <div className={hasClickedShowMore ? 'SRC-hidden' : ''}>\n        <span\n          data-search-handle={descriptionSubTitle}\n          className={`SRC-font-size-base ${CARD_SHORT_DESCRIPTION_CSS} SRC-short-description`}\n        >\n          {getCutoff(description).previewText}\n        </span>\n        {description.length >= CHAR_COUNT_CUTOFF && (\n          <button\n            style={{\n              fontSize: '14px',\n              cursor: 'pointer',\n              marginLeft: '-2px',\n            }}\n            className=\"SRC-primary-text-color\"\n            onClick={this.toggleShowMore}\n          >\n            ...Show More\n          </button>\n        )}\n      </div>\n    )\n  }\n}\n","import { lexer, parser } from 'sql-parser'\nimport { SYNAPSE_REGX } from '../../containers/GenericCard'\nimport { SelectColumn, Row } from '../synapseTypes'\n\nexport type KeyValue = {\n  [index: string]: string\n}\n\nexport type SQLOperator = 'LIKE' | '=' | 'HAS'\n\n// look for \"group by\", multi-line and case insensitive\nconst GROUP_BY_REGEX = /group by/im\nexport const isGroupByInSql = (sql: string): boolean => {\n  return GROUP_BY_REGEX.test(sql)\n}\nconst WITHOUT_SYN_PREFIX = 3\n\nconst generateTokenUsingOperator = (\n  literal: string,\n  operator: SQLOperator,\n  match: string,\n) => {\n  let usedMatchForLike = match\n  if (match.match(SYNAPSE_REGX)) {\n    // If we use a LIKE statement with a synId the backend will look for a string with the first three\n    // characters being 'syn', however, it stores synIds without 'syn', so the query will fail\n    // The backend usually parses 'syn' out, but not with the LIKE clause since its expecting a regex, so we\n    // parse this out. This will cause a bug if something matches the synId regex but is in free text.\n    usedMatchForLike = match.substring(WITHOUT_SYN_PREFIX)\n  }\n  // form the has clause, e.g sql = \".... HAS ('condition1', 'condition2',...,'conditionN')\n  const matchForHas = match\n    .split(',')\n    // NOTE - Using single quotes to surround the search term is necessary for the backend parser.\n    .map(el => `'${el}'`)\n    .join(',')\n  switch (operator) {\n    case 'LIKE':\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        ['STRING', `%${usedMatchForLike}%`, '1'],\n      ]\n    case 'HAS':\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        /* \n          Using PARAMETER as hack, the parser will use the exact value for a PARAMETER value,\n          it won't add quotes around the argument or remove parens (which is the standard behavior\n          for type STRING) that would cause an error on the backend\n        */\n        ['PARAMETER', `(${matchForHas})`, '1'],\n      ]\n    default:\n      // default use operator as-is\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        ['STRING', match, '1'],\n      ]\n  }\n}\n\nexport const getWhereInsertIndex = (\n  tokens: string[][]\n):number => {\n  const existingWhereIndex = tokens.findIndex(el => el[0] === 'WHERE')\n  if (existingWhereIndex !== -1) {\n    return existingWhereIndex\n  }\n  let targetIndex = tokens.findIndex(el => el[0] === 'GROUP')\n  if (targetIndex !== -1) {\n    return targetIndex\n  }\n  targetIndex = tokens.findIndex(el => el[0] === 'HAVING')\n  if (targetIndex !== -1) {\n    return targetIndex\n  }\n  targetIndex = tokens.findIndex(el => el[0] === 'ORDER')\n  if (targetIndex !== -1) {\n    return targetIndex\n  }\n  //else insert it at the end\n  targetIndex = tokens.findIndex(el => el[0] === 'EOF')\n  return targetIndex\n}\n// This will construct a sql query by adding the conditions in searchParams\n// to the WHERE clause, preserving all other clauses\nexport const insertConditionsFromSearchParams = (\n  searchParams: KeyValue,\n  sql: string,\n  operator: SQLOperator = 'LIKE',\n) => {\n  // if there are no search params, or if all search params are QueryWrapper queries\n  const isQueryWrapperKey = (key: string) => key.startsWith('QueryWrapper')\n  let searchParamKeys = Object.keys(searchParams)\n  if (searchParamKeys.length === 0 || searchParamKeys.every(isQueryWrapperKey)) {\n    return sql\n  }\n  const tokens: string[][] = lexer.tokenize(sql)\n  // we want to either create a where clause or insert into the where clause\n  const foundIndex = tokens.findIndex(el => el[0] === 'WHERE')\n  const whereClauseIndex = getWhereInsertIndex(tokens)\n  const indexAfterWhereClause = whereClauseIndex + 1\n  if (foundIndex === -1) {\n    // insert a where clause\n    tokens.splice(whereClauseIndex, 0, ['WHERE', 'WHERE', '1'])\n  } else {\n    // if this is inserting into a where clause then we have to make sure that the logic is chained\n    tokens.splice(indexAfterWhereClause, 0, ['CONDITIONAL', 'AND', '1'])\n  }\n  const searchParamsLen = Object.keys(searchParams).length\n  Object.keys(searchParams).forEach((key, index) => {\n    const token = generateTokenUsingOperator(key, operator, searchParams[key])\n    if (index < searchParamsLen - 1) {\n      // make sure to chain the ANDs until the last one\n      token.unshift(['CONDITIONAL', 'AND', '1'])\n    }\n    tokens.splice(indexAfterWhereClause, 0, ...token)\n  })\n  return formatSQLFromParser(tokens)\n}\n\nexport const formatSQLFromParser = (tokens: string[][]) => {\n  // replace all DBLSTRINGs (escaped strings) with LITERALs\n  tokens.forEach(value => {\n    if (value[0] === 'DBLSTRING') {\n      value[0] = 'LITERAL'\n    }\n  })\n  // if synId has a DOT (e.g. 'syn123.2') then we have to alter the sql produced\n  const dotIndex = tokens.findIndex(val => val[0] === 'DOT')\n  if (dotIndex !== -1) {\n    // Given sql with a versioned entity, e.g. \"select * from syn123.2\"\n    // Tokens has the form:\n    /*\n    [\n      [\"SELECT\" , \"select\"],\n      ..\n      [\"FROM\", \"from\"],\n      [\"LITERAL\", \"syn123\"],\n      [\"DOT\", \".\"],\n      [\"LITERAL\", \"2\"],\n\n      which we need to transform to\n\n      [\"SELECT\" , \"select\"],\n      ..\n      [\"FROM\", \"from\"],\n      [\"LITERAL\", \"syn123.2\"],\n    */\n\n    const synId = tokens[dotIndex - 1][1]\n    const version = tokens[dotIndex + 1][1]\n    const synIdWithVersion = `${synId}.${version}`\n    tokens.splice(dotIndex, 2)\n    tokens[dotIndex - 1] = ['LITERAL', synIdWithVersion]\n  }\n  const newSql = parser.parse(tokens).toString() as string\n  // construct the sql using their formatter and then alter it to remove erroneous\n  // backticks from the table identifier: e.g. (their output) `syn1234` ->  (our output) syn1234\n  const synId = tokens[tokens.findIndex(el => el[0] === 'FROM') + 1][1]\n  const synIdWithBackticks = `\\`${synId}\\``\n  return newSql.replace(synIdWithBackticks, synId)\n}\n\n//parses synapse entity id from a sql query string\n//look for a pattern of 'from[some number of spaces]syn[somenumbers]` case insensitive\nexport const parseEntityIdFromSqlStatement = (sql: string): string => {\n  const matches = sql.match(/(from)\\s+(syn)\\d+/gi)\n  return matches && matches[0] ? matches[0].substr(5).trim() : ''\n}\n\nexport const resultToJson = <T>(\n  headerColumns: SelectColumn[],\n  rowColumns: Row[],\n): T[] => {\n  const result: T[] = []\n  const rows = rowColumns.map(row => row.values)\n  const headers = headerColumns.map(column => column.name)\n  rows.forEach((row, index) => {\n    result[index] = {} as T\n    row.forEach((text, cellIndex) => {\n      result[index][headers[cellIndex]] = text\n    })\n  })\n  return result\n}\n","import Plotly from 'plotly.js-basic-dist'\nimport * as React from 'react'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SynapseConstants } from '../../utils/'\nimport { getFullQueryTableResults } from '../../utils/SynapseClient'\nimport {\n  QueryResultBundle,\n  QueryBundleRequest,\n} from '../../utils/synapseTypes/'\nimport { parseEntityIdFromSqlStatement } from '../../utils/functions/sqlFunctions'\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type SynapsePlotProps = {\n  token?: string\n  ownerId?: string\n  wikiId?: string\n  widgetparamsMapped?: any\n}\n\ntype SynapsePlotState = {\n  isLoaded: boolean\n  queryData: QueryResultBundle\n}\n\nclass SynapsePlot extends React.Component<SynapsePlotProps, SynapsePlotState> {\n  constructor(props: SynapsePlotProps) {\n    super(props)\n    this.state = {\n      isLoaded: false,\n      queryData: {} as QueryResultBundle,\n    }\n    this.fetchPlotlyData = this.fetchPlotlyData.bind(this)\n    this.showPlot = this.showPlot.bind(this)\n  }\n\n  public componentDidMount() {\n    this.fetchPlotlyData()\n  }\n  /**\n   * Get data for plotly\n   *\n   * @returns data corresponding to plotly widget\n   */\n  public fetchPlotlyData() {\n    const { token } = this.props\n    const { query } = this.props.widgetparamsMapped\n    const queryRequest: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask: SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n      entityId: parseEntityIdFromSqlStatement(query),\n      query: {\n        sql: query,\n      },\n    }\n\n    getFullQueryTableResults(queryRequest, token)\n      .then((data: QueryResultBundle) => {\n        this.setState({\n          isLoaded: true,\n          queryData: data,\n        })\n      })\n      .catch((err: any) => {\n        console.log('Error on full table query ', err)\n      })\n  }\n\n  public showPlot() {\n    if (!this.state.isLoaded) {\n      return\n    }\n    const {\n      title,\n      xtitle,\n      ytitle,\n      type,\n      xaxistype,\n      showlegend,\n    } = this.props.widgetparamsMapped\n    const queryData = this.state\n    const isHorizontal = this.props.widgetparamsMapped.horizontal.toLowerCase()\n    const layout: any = {\n      showlegend,\n      title,\n    }\n    if (xtitle) {\n      layout.xaxis = {\n        title: xtitle,\n      }\n    }\n    if (xaxistype) {\n      layout.xaxis = {\n        ...layout.xaxis,\n        xaxistype: xaxistype.toLowerCase(),\n      }\n    }\n    if (ytitle) {\n      layout.yaxis = {\n        title: ytitle,\n      }\n    }\n    // init plot_data\n    const plotData: any = []\n    const orientation = isHorizontal ? 'v' : 'h'\n    const headers = queryData.queryData.queryResult.queryResults.headers\n    for (let i = 0; i < headers.length - 1; i += 1) {\n      // make an entry for each set of data points\n      plotData[i] = {\n        orientation,\n        name: headers[i + 1].name,\n        type: type.toLowerCase(),\n        x: [],\n        y: [],\n      }\n    }\n    // grab all the data\n    for (const row of queryData.queryData.queryResult.queryResults.rows) {\n      for (let j = 1; j < row.values.length; j += 1) {\n        // create pairs of data\n        const rowValues: any = row.values\n        plotData[j - 1].x.push(rowValues[0])\n        plotData[j - 1].y.push(rowValues[j])\n      }\n    }\n    return <Plot layout={layout} data={plotData} />\n  }\n\n  public render() {\n    if (!this.state.isLoaded) {\n      return null\n    }\n    return this.showPlot()\n  }\n}\nexport default SynapsePlot\n","import * as React from 'react'\nimport { useEffect, useState } from 'react'\nimport { getEntity, getFiles } from '../../utils/SynapseClient'\nimport {\n  FileEntity,\n  FileHandleAssociateType,\n  FileHandleAssociation,\n  BatchFileRequest,\n  BatchFileResult,\n} from '../../utils/synapseTypes'\nimport { SynapseConstants } from '../../utils/'\n\nexport type Props = {\n  params: any\n  token?: string\n}\n\nexport default function SynapseVideo({ params, token }: Props) {\n  const [video, setVideo] = useState<string>()\n  const [videoUrl, setVideoUrl] = useState<string>()\n\n  const videoWidth = params.width ?? ''\n  const videoHeight = params.height ?? ''\n  useEffect(() => {\n    const getVideo = () => {\n      if (params.videoId)\n        setVideo(`https://www.youtube.com/embed/${params.videoId}`)\n      else if (params.vimeoId)\n        setVideo(`https://player.vimeo.com/video/${params.vimeoId}`)\n      else {\n        const videoKey =\n          params.oggSynapseId || params.mp4SynapseId || params.webmSynapseId\n\n        getEntity<FileEntity>(token, videoKey).then((data: FileEntity) => {\n          const fileHandleAssociationList: FileHandleAssociation[] = [\n            {\n              associateObjectId: videoKey,\n              associateObjectType: FileHandleAssociateType.FileEntity,\n              fileHandleId: data.dataFileHandleId,\n            },\n          ]\n          getSynapseFiles(fileHandleAssociationList, data.dataFileHandleId)\n        })\n      }\n    }\n\n    const getSynapseFiles = (\n      fileHandleAssociationList: FileHandleAssociation[],\n      id: string,\n    ) => {\n      const request: BatchFileRequest = {\n        includeFileHandles: false,\n        includePreSignedURLs: true,\n        includePreviewPreSignedURLs: false,\n        requestedFiles: fileHandleAssociationList,\n      }\n\n      getFiles(request, token)\n        .then((data: BatchFileResult) => {\n          const { preSignedURL } = data.requestedFiles.filter(\n            el => el.fileHandleId === id,\n          )[0]\n          setVideoUrl(preSignedURL)\n        })\n        .catch(err => {\n          console.error('Error on getting video ', err)\n        })\n    }\n    getVideo()\n  }, [video, params, token, videoHeight, videoWidth])\n\n  const RenderVideo = () => {\n    return (\n      <div>\n        {videoUrl ? (\n          <video\n            controls\n            src={videoUrl}\n            width={videoWidth}\n            height={videoHeight}\n          >\n            It does not support the HTML5 Video element.\n          </video>\n        ) : (\n          <iframe\n            title=\"video frame\"\n            src={video}\n            width={videoWidth}\n            height={videoHeight}\n          ></iframe>\n        )}\n      </div>\n    )\n  }\n  return (\n    <div>\n      {token ? (\n        <RenderVideo />\n      ) : (\n        <p>\n          You will need to\n          <button\n            className={`${SynapseConstants.SRC_SIGN_IN_CLASS} sign-in-btn default\n                `}\n          >\n            Sign in\n          </button>\n          in for access to that resource.\n        </p>\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { SRC_SIGN_IN_CLASS } from '../utils/SynapseConstants'\n\nexport type SignInProps = {\n  className?: string\n  style?: React.CSSProperties\n}\n// An event listener for the class SRC_SIGN_IN_CLASS is needed to trigger a download\n// modal\nconst SignInButton = ({ className, style }: SignInProps) => {\n  return (\n    <button\n      type=\"button\"\n      style={style}\n      className={`SignInButton ${SRC_SIGN_IN_CLASS} SRC-primary-text-color ${className}`}\n    >\n      Sign In\n    </button>\n  )\n}\n\nexport default SignInButton\n","import * as React from 'react'\nimport { SynapseClientError } from '../utils/SynapseClient'\nimport SignInButton from './SignInButton'\nimport { Alert } from 'react-bootstrap'\ntype ErrorProps = {\n  token?: string\n  error?: string | Error | SynapseClientError\n}\n\nfunction isSynapseClientError(\n  error: string | Error | SynapseClientError,\n): error is SynapseClientError {\n  return (error as any).status !== undefined\n}\n\nfunction isError(error: string | Error | SynapseClientError): error is Error {\n  return (error as any).message !== undefined\n}\n\nfunction isString(error: string | Error | SynapseClientError): error is string {\n  return typeof error === 'string'\n}\n\nexport const ClientError = (props: {\n  error: SynapseClientError\n  token?: string\n}) => {\n  const { error, token } = props\n  const loginError = error.status === 403 && !token\n  const accessDenied = error.status === 403 && token\n\n  return (\n    <>\n      {loginError && (\n        <>\n          Please <SignInButton /> to view this resource.\n        </>\n      )}\n      {accessDenied && <>You are not authorized to access this resource.</>}\n      {\n        // if we don't have a friendly error message then show the error\n        !accessDenied && !loginError && <>{error.reason}</>\n      }\n    </>\n  )\n}\n\nexport const Error = (props: ErrorProps) => {\n  const { error, token } = props\n\n  if (!error) {\n    return <></>\n  }\n\n  let synapseClientError: SynapseClientError | undefined = undefined\n  let jsError: Error | undefined = undefined\n  let stringError: string | undefined = undefined\n  if (isSynapseClientError(error)) {\n    synapseClientError = error\n  } else if (isError(error)) {\n    jsError = error\n  } else if (isString(error)) {\n    stringError = error\n  }\n  return (\n    <div className=\"Error\">\n      <Alert\n        dismissible={false}\n        show={true}\n        variant={'danger'}\n        transition={false}\n      >\n        <p>\n          {synapseClientError && (\n            <ClientError error={synapseClientError} token={token} />\n          )}\n          {jsError && jsError.message}\n          {stringError && stringError}\n        </p>\n      </Alert>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { SynapseClient, SynapseConstants } from '../utils'\nimport { FileHandleResults, WikiPage } from '../utils/synapseTypes/'\nimport UserCard from './UserCard'\nimport Bookmarks from './widgets/Bookmarks'\nimport SynapseImage from './widgets/SynapseImage'\nimport SynapsePlot from './widgets/SynapsePlot'\nimport SynapseVideo from './widgets/SynapseVideo'\nimport { ObjectType } from '../utils/synapseTypes/WikiPageKey'\nimport { Error } from '../containers/Error'\nimport { SynapseClientError } from '../utils/SynapseClient'\n\nconst TOC_CLASS = {\n  1: 'toc-indent1',\n  2: 'toc-indent2',\n  3: 'toc-indent3',\n  4: 'toc-indent4',\n  5: 'toc-indent5',\n  6: 'toc-indent6',\n}\n\ndeclare var katex: any\n\ndeclare var markdownitSynapse: any\ndeclare var markdownit: any\ndeclare var markdownitSub: any\ndeclare var markdownitSup: any\ndeclare var markdownitCentertext: any\ndeclare var markdownitSynapseHeading: any\ndeclare var markdownitSynapseTable: any\ndeclare var markdownitStrikethroughAlt: any\ndeclare var markdownitContainer: any\ndeclare var markdownitEmphasisAlt: any\ndeclare var markdownitInlineComments: any\ndeclare var markdownitBr: any\ndeclare var sanitizeHtml: any\n\ndeclare var markdownitMath: any\n\nexport type MarkdownSynapseProps = {\n  token?: string\n  ownerId?: string\n  wikiId?: string\n  markdown?: string\n  renderInline?: boolean\n  objectType?: ObjectType\n}\nconst md = markdownit({ html: true })\n\ntype MarkdownSynapseState = {\n  md: any\n  data: Partial<WikiPage>\n  fileHandles?: FileHandleResults\n  error: SynapseClientError | undefined\n  isLoading: boolean\n}\n/**\n * Basic Markdown functionality for Synapse, supporting Images/Plots/References/Bookmarks/buttonlinks\n *\n * @class Markdown\n * @extends {React.Component}\n */\nexport default class MarkdownSynapse extends React.Component<\n  MarkdownSynapseProps,\n  MarkdownSynapseState\n> {\n  public markupRef: React.RefObject<HTMLInputElement>\n\n  /**\n   * Creates an instance of Markdown.\n   * @param {*} props\n   */\n  constructor(props: MarkdownSynapseProps) {\n    super(props)\n    // markdownitSynapse wraps around markdownit object and uses its own dependencies\n    markdownitSynapse.init_markdown_it(\n      md,\n      markdownitSub,\n      markdownitSup,\n      markdownitCentertext,\n      markdownitSynapseHeading,\n      markdownitSynapseTable,\n      markdownitStrikethroughAlt,\n      markdownitContainer,\n      markdownitEmphasisAlt,\n      markdownitInlineComments,\n      markdownitBr,\n    )\n\n    const mathSuffix = ''\n    // Update the internal markdownit object with the wrapped synapse object\n    md.use(markdownitSynapse, mathSuffix, 'https://synapse.org').use(\n      markdownitMath,\n      mathSuffix,\n    )\n    const data: any = {}\n    if (this.props.markdown) {\n      data.markdown = this.props.markdown\n    }\n    this.state = {\n      md,\n      error: undefined,\n      fileHandles: undefined,\n      data,\n      isLoading: true,\n    }\n    this.markupRef = React.createRef()\n    this.handleLinkClicks = this.handleLinkClicks.bind(this)\n    // handle widgets and math markdown\n    this.renderMarkdown = this.renderMarkdown.bind(this)\n    this.recursiveRender = this.recursiveRender.bind(this)\n    this.processMath = this.processMath.bind(this)\n    // handle init calls to get wiki related items\n    this.getWikiAttachments = this.getWikiAttachments.bind(this)\n    this.getWikiPageMarkdown = this.getWikiPageMarkdown.bind(this)\n    // handle rendering widgets\n    this.renderWidget = this.renderWidget.bind(this)\n    this.renderSynapseButton = this.renderSynapseButton.bind(this)\n    this.renderSynapseImage = this.renderSynapseImage.bind(this)\n    this.renderVideo = this.renderVideo.bind(this)\n    this.renderSynapsePlot = this.renderSynapsePlot.bind(this)\n    this.renderSynapseTOC = this.renderSynapseTOC.bind(this)\n    this.createHTML = this.createHTML.bind(this)\n    this.addBookmarks = this.addBookmarks.bind(this)\n    this.addIdsToReferenceWidgets = this.addIdsToReferenceWidgets.bind(this)\n    this.addIdsToTocWidgets = this.addIdsToTocWidgets.bind(this)\n  }\n\n  public componentWillUnmount() {\n    // @ts-ignore TODO: find better documentation on typescript/react event params\n    this.markupRef.current &&\n      // @ts-ignore TODO: find better documentation on typescript/react event params\n      this.markupRef.current.removeEventListener('click', this.handleLinkClicks)\n  }\n\n  // Manually handle clicks to anchor tags where the scrollto isn't handled by page hash\n  public handleLinkClicks(event: React.MouseEvent<HTMLElement>) {\n    const genericElement = event.target as HTMLElement\n    if (genericElement.tagName === 'A' || genericElement.tagName === 'BUTTON') {\n      const anchor = event.target as HTMLAnchorElement\n      if (anchor.id.substring(0, 3) === 'ref') {\n        event.preventDefault()\n        // its a reference, so we scroll to the appropriate bookmark\n        const referenceNumber = Number(event.currentTarget.id.substring(3)) // e.g. ref2 => '2'\n        const goTo = this.markupRef.current!.querySelector(\n          `#bookmark${referenceNumber}`,\n        )\n        try {\n          goTo!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center',\n          })\n        } catch (e) {\n          console.log('error on scroll', e)\n        }\n      } else if (\n        event.currentTarget.id !== null &&\n        anchor.getAttribute('data-anchor')\n      ) {\n        event.preventDefault()\n        // handle table of contents widget\n        const idOfContent = anchor.getAttribute('data-anchor')\n        const goTo = this.markupRef.current!.querySelector(`#${idOfContent}`)\n        try {\n          goTo!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center',\n          })\n        } catch (e) {\n          console.log('error on scroll', e)\n        }\n      }\n    }\n  }\n\n  /**\n   * Given input text, generate markdown object to be passed onto inner html of some container.\n   * @param {String} markdown The text being written in plain markdown\n   * @returns {Object} Dictionary to be passed into dangerouslySetInnerHTML with markdown text\n   */\n  public createHTML(markdown?: string) {\n    if (!markdown) {\n      return { __html: '' }\n    }\n    // Note - renderInline parses out any block level elements contained in the markdown\n    const initText = this.props.renderInline\n      ? this.state.md.renderInline(markdown)\n      : this.state.md.render(markdown)\n    const cleanText = sanitizeHtml(initText, {\n      allowedAttributes: {\n        a: ['href', 'target'],\n        button: ['class'],\n        div: ['class'], // PORTALS-1450: including 'style' in the allow-list will cause string values to come through, which crashes the app when used (because it uses jsx).\n        h1: ['toc'],\n        h2: ['toc'],\n        h3: ['toc'],\n        h4: ['toc'],\n        h5: ['toc'],\n        h6: ['toc'],\n        li: ['class'],\n        ol: ['class'],\n        span: ['*'],\n        table: ['class'],\n        th: ['colspan'],\n        thead: ['class'],\n        ul: ['class'],\n        img: ['src', 'alt'],\n      },\n      allowedTags: [\n        'span',\n        'code',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'p',\n        'b',\n        'i',\n        'em',\n        'strong',\n        'a',\n        'id',\n        'table',\n        'tr',\n        'td',\n        'tbody',\n        'th',\n        'thead',\n        'button',\n        'div',\n        'img',\n        'image',\n        'ol',\n        'ul',\n        'li',\n        'svg',\n        'g',\n        'br',\n        'hr',\n        'summary',\n        'details',\n        'strong',\n      ],\n    })\n    return { __html: cleanText }\n  }\n\n  /**\n   * Find all math identified elements of the form [id^=\\\"mathjax-\\\"]\n   * (e.g. <dom element id=\"mathjax-10\"> text </dom element>)\n   * and transform them to their math markedown equivalents\n   */\n  public processMath() {\n    if (!this.markupRef.current) {\n      return\n    }\n    // use regex to grab all elements\n    const mathExpressions = this.markupRef.current.querySelectorAll<\n      HTMLElement\n    >('[id^=\"mathjax-\"]')\n    // go through all obtained elements and transform them with katex\n    mathExpressions.forEach(element => {\n      element.textContent &&\n        katex.render(element.textContent, element, {\n          // @ts-ignore\n          output: 'html',\n          throwOnError: false,\n        })\n    })\n  }\n  /**\n   * Process all the corresponding bookmark tags of the references made throughout the page\n   *\n   * @memberof MarkdownSynapse\n   */\n  public addBookmarks() {\n    markdownitSynapse.resetFootnotes()\n    this.createHTML(this.state.data.markdown)\n    const footnotesHtml = this.createHTML(markdownitSynapse.footnotes()).__html\n    if (footnotesHtml.length > 0) {\n      return <Bookmarks footnotes={footnotesHtml} />\n    }\n    return\n  }\n\n  /**\n   * Get wiki page markdown and file attachment handles\n   */\n  public async getWikiPageMarkdown() {\n    const { ownerId, wikiId, token, objectType } = this.props\n    if (!ownerId && !wikiId) {\n      return\n    }\n    try {\n      const wikiPage = await SynapseClient.getEntityWiki(\n        token,\n        ownerId,\n        wikiId,\n        objectType,\n      )\n      try {\n        const fileHandles = await this.getWikiAttachments(\n          wikiId ? wikiId : wikiPage.id,\n        )\n        this.setState({\n          data: wikiPage,\n          fileHandles,\n          error: undefined,\n        })\n      } catch (fileHandlesErr) {\n        console.error('fileHandlesErr = ', fileHandlesErr)\n      }\n    } catch (err) {\n      console.error('Error on wiki markdown load\\n', err)\n      this.setState({\n        error: err,\n      })\n    }\n  }\n  public async getWikiAttachments(wikiId: string) {\n    const { token, ownerId, objectType } = this.props\n    if (!ownerId) {\n      console.error(\n        'Cannot get wiki attachments without ownerId on Markdown Component',\n      )\n      return undefined\n    }\n    return await SynapseClient.getWikiAttachmentsFromEntity(\n      token,\n      ownerId,\n      wikiId,\n      objectType,\n    )\n      .then(data => {\n        return data\n      })\n      .catch(err => {\n        console.error('Error on wiki attachment load ', err)\n        return undefined\n      })\n  }\n\n  public addIdsToReferenceWidgets(text: string) {\n    const referenceRegex = /<span id=\"wikiReference.*?<span data-widgetparams.*?span>/g\n    let referenceCount = 1\n\n    return text.replace(referenceRegex, () => {\n      // replace all reference tags with id's of the form id=\"ref<number>\"\" that we can read onClick\n      const current = referenceCount\n      referenceCount += 1\n      return `<a href=\"\" id=\"ref${current}\">[${current}]</a>`\n    })\n  }\n\n  public addIdsToTocWidgets(text: string) {\n    const tocId = 'SRC-header-'\n    let tocIdCount = 1\n    const TOC_HEADER_REGEX = /<h[1-6] toc=\"true\">.*<\\/h[1-6]>/gm\n\n    return text.replace(TOC_HEADER_REGEX, (match: string) => {\n      // replace with id of the form id=\"toc\" so we can read them with onclick events\n      const curTocId = tocIdCount\n      tocIdCount += 1\n      const matchWithId = `${match.substring(\n        0,\n        3,\n      )} id=\"${tocId}${curTocId}\"${match.substring(3)}`\n      return matchWithId\n    })\n  }\n\n  /**\n   * The 'main' method of this class that process all the markdown and transforms it to the appropriate\n   * Synapse widgets.\n   *\n   * @returns JSX of the markdown into widgets\n   * @memberof MarkdownSynapse\n   */\n  public renderMarkdown() {\n    // create initial markup\n    let markup = this.createHTML(this.state.data.markdown).__html\n    // process reference widgets\n    markup = this.addIdsToReferenceWidgets(markup)\n    // process table of contents widgets\n    markup = this.addIdsToTocWidgets(markup)\n    if (markup.length > 0) {\n      const domParser = new DOMParser()\n      const document = domParser.parseFromString(markup, 'text/html')\n      return <>{this.recursiveRender(document.body, markup)}</>\n    }\n    return\n  }\n\n  /**\n   * recursiveRender will render react tree from HTML tree\n   *\n   * @param {Node} element This will be either a text Node or an HTMLElement\n   * @param {string} markdown The original markdown, its kept as a special case for the table of contents widget\n   * @returns {*}\n   * @memberof MarkdownSynapse\n   */\n  public recursiveRender(element: Node, markdown: string): any {\n    /*\n      Recursively render the html tree created from the markdown, there are a few cases:\n      1. element is Node and is text in which case it is simply rendered\n      2. element is an HTMLElement and is: a self closing tag, has no children (e.g. <br>), or its a synapse widget and is \n      rendered accordingly\n      3. element is an HTMLElement and has children so we loop through its childNodes, recurively render those, and then render its own tag\n      as the parent of those child nodes. Note - childNodes was specifically chosen over .children because text Nodes\n      would not come through .children\n    */\n    if (element.nodeType === Node.TEXT_NODE) {\n      // case 1.\n      return <> {element.textContent} </>\n    } else if (\n      element.nodeType === Node.ELEMENT_NODE &&\n      element instanceof HTMLElement\n    ) {\n      const tagName =\n        element.tagName.toLowerCase() === 'body'\n          ? 'span'\n          : element.tagName.toLowerCase()\n      const widgetParams = element.getAttribute('data-widgetparams')\n      if (widgetParams) {\n        // case 2\n        // process widget\n        return this.processHTMLWidgetMapping(widgetParams, markdown)\n      }\n      // manually add on props, depending on what comes through the markdown their could\n      // be unforseen issues with attributes being misnamed according to what react will respect\n      // e.g. class instead of className\n      const attributes = element.attributes\n      const props = {}\n      for (let i = 0; i < attributes.length; i++) {\n        let name = ''\n        let value = ''\n        const attribute = attributes.item(i)\n        if (attribute) {\n          name = attribute.name\n          value = attribute.value\n        }\n        if (name && value) {\n          props[name] = value\n        }\n      }\n      if (element.childNodes.length === 0) {\n        // case 2\n        // e.g. self closing tag like <br/> or <img>\n        return React.createElement(tagName, props)\n      }\n      // case 3\n      // recursively render children\n      const children = Array.from(element.childNodes).map((el, index) => {\n        return (\n          <React.Fragment key={index}>\n            {this.recursiveRender(el, markdown)}\n          </React.Fragment>\n        )\n      })\n      // Render tagName as parent element of the children below\n      return React.createElement(tagName, props, <>{children}</>)\n    }\n  }\n\n  /**\n   *  When the markdown string is transfered over the network certain characters get transformed,\n   * this does a simple transformation back to the original user's string.\n   *\n   * @param {string} xml\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public decodeXml(xml: string) {\n    const escapedOneToXmlSpecialMap = {\n      '&amp;': '&',\n      '&gt;': '>',\n      '&lt;': '<',\n      '&quot;': '\"',\n    }\n    return xml.replace(/(&quot;|&lt;|&gt;|&amp;)/g, (str, item) => {\n      return escapedOneToXmlSpecialMap[item]\n    })\n  }\n\n  /**\n   * Given widgetMap renders it in a React component (or originalMarkup in special cases.)\n   *\n   * @param {string} widgetMatch The synapse widget to be rendered\n   * @param {string} originalMarkup The original markup text, this is a special case for widgets that\n   * are html specific.\n   * @returns JSX of the widget to render\n   * @memberof MarkdownSynapse\n   */\n  public processHTMLWidgetMapping(\n    widgetParams: string,\n    originalMarkup: string,\n  ) {\n    // General workflow -\n    //   1. Capture widget parameters\n    //   2. Transform any widget xml parameters to standard text\n    //   3. Split those parameters into a map\n    //   4. Render that widget based on its parameters\n\n    // steps 1,2\n    const decodedWidgetParams = this.decodeXml(widgetParams)\n\n    // decodedWidgetParams look like {<widget>?param1=xxx&param2=yyy}\n    const questionIndex = decodedWidgetParams.indexOf('?')\n    if (questionIndex === -1) {\n      // e.g. toc is passed, there are no params\n      return this.renderWidget(decodedWidgetParams, {}, originalMarkup)\n    }\n    const widgetType = decodedWidgetParams.substring(0, questionIndex)\n    const widgetparamsMapped = {}\n    // map out params and their values\n    decodedWidgetParams\n      .substring(questionIndex + 1)\n      .split('&')\n      .forEach(keyPair => {\n        let [key, value] = keyPair.split('=')\n        value = decodeURIComponent(value)\n        widgetparamsMapped[key] = value\n      })\n    return this.renderWidget(widgetType, widgetparamsMapped, originalMarkup)\n  }\n\n  /**\n   *  Given widgetType renders the apppropriate widget\n   *\n   * @param {string} widgetType The type of synapse widget. (e.g. 'image', 'plot')\n   * @param {*} widgetparamsMapped The parameters for this widget\n   * @param {string} originalMarkup The original markup.\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public renderWidget(\n    widgetType: string,\n    widgetparamsMapped: any,\n    originalMarkup: string,\n  ) {\n    // we make keys out of the widget params\n    const key = JSON.stringify(widgetparamsMapped)\n    widgetparamsMapped.reactKey = key\n\n    switch (widgetType) {\n      case 'buttonlink':\n        return this.renderSynapseButton(widgetparamsMapped)\n      case 'image':\n        return this.renderSynapseImage(widgetparamsMapped)\n      case 'plot':\n        return this.renderSynapsePlot(widgetparamsMapped)\n      case 'toc':\n        return this.renderSynapseTOC(originalMarkup)\n      case 'badge':\n        return this.renderUserBadge(widgetparamsMapped)\n      case 'video':\n      case 'vimeo':\n      case 'youtube':\n        return this.renderVideo(widgetparamsMapped)\n      default:\n        return\n    }\n  }\n\n  public renderSynapseButton(widgetparamsMapped: any) {\n    let buttonClasses = ''\n    const { align = '', highlight = '' } = widgetparamsMapped\n    const alignLowerCase = align.toLowerCase()\n    if (alignLowerCase === 'left') {\n      buttonClasses += 'floatLeft '\n    }\n    if (alignLowerCase === 'right') {\n      buttonClasses += 'floatright '\n    }\n    if (highlight === 'true') {\n      buttonClasses += ' SRC-primary-button '\n    } else {\n      buttonClasses += 'SRC-light-button '\n    }\n    if (alignLowerCase === 'center') {\n      return (\n        <div key={widgetparamsMapped.reactKey} style={{ textAlign: 'center' }}>\n          <a\n            href={widgetparamsMapped.url}\n            className={'SRC-standard-button-shape ' + buttonClasses}\n            role=\"button\"\n          >\n            {widgetparamsMapped.text}\n          </a>\n        </div>\n      )\n    }\n    return (\n      <a\n        key={widgetparamsMapped.reactKey}\n        href={widgetparamsMapped.url}\n        className={'SRC-standard-button-shape ' + buttonClasses}\n        role=\"button\"\n      >\n        {widgetparamsMapped.text}\n      </a>\n    )\n  }\n  public renderSynapsePlot(widgetparamsMapped: any) {\n    return (\n      <SynapsePlot\n        key={widgetparamsMapped.reactKey}\n        token={this.props.token}\n        ownerId={this.props.ownerId}\n        wikiId={this.props.wikiId || this.state.data.id}\n        widgetparamsMapped={widgetparamsMapped}\n      />\n    )\n  }\n\n  public renderVideo(widgetparamsMapped: any) {\n    const { token } = this.props\n\n    return <SynapseVideo token={token} params={widgetparamsMapped} />\n  }\n\n  public renderSynapseImage(widgetparamsMapped: any) {\n    const { reactKey } = widgetparamsMapped\n    if (widgetparamsMapped.fileName) {\n      if (!this.state.fileHandles) {\n        // ensure files are loaded\n        return\n      }\n      // if file name is attached then the fileHandle ID is located\n      // in this wiki's file attachment list\n      return (\n        <SynapseImage\n          params={widgetparamsMapped}\n          key={reactKey}\n          token={this.props.token}\n          fileName={widgetparamsMapped.fileName}\n          wikiId={this.props.wikiId || this.state.data.id}\n          fileResults={this.state.fileHandles.list}\n        />\n      )\n    }\n    if (widgetparamsMapped.synapseId) {\n      // otherwise this image's fileHandle ID is not located\n      // in the file attachment list and will be loaded first\n      return (\n        <SynapseImage\n          params={widgetparamsMapped}\n          key={reactKey}\n          token={this.props.token}\n          synapseId={widgetparamsMapped.synapseId}\n        />\n      )\n    }\n    return\n  }\n  public renderSynapseTOC(originalMarkup: string) {\n    const elements: any[] = []\n    const TOC_HEADER_REGEX_WITH_ID = /<h([1-6]) id=\"(.*)\" .*toc=\"true\">(.*)<\\/h[1-6]>/gm\n    let text = ''\n    originalMarkup.replace(TOC_HEADER_REGEX_WITH_ID, (p1, p2, p3, p4) => {\n      text += p4\n      elements.push(\n        <div key={p4}>\n          <a className={`link ${TOC_CLASS[Number(p2)]}`} data-anchor={p3}>\n            {p4}\n          </a>\n        </div>,\n      )\n      return ''\n    })\n    return <div key={text}>{elements}</div>\n  }\n\n  public renderUserBadge(widgetparamsMapped: any) {\n    return (\n      <UserCard\n        key={JSON.stringify(widgetparamsMapped)}\n        size={SynapseConstants.SMALL_USER_CARD}\n        alias={widgetparamsMapped.alias}\n      />\n    )\n  }\n\n  public async componentDidMount() {\n    if (this.state.data.markdown) {\n      this.setState({ isLoading: false })\n      return\n    }\n    // we use this.markupRef.current && because in testing environment refs aren't defined\n    // @ts-ignore\n    this.markupRef.current &&\n      // @ts-ignore\n      this.markupRef.current!.addEventListener('click', this.handleLinkClicks)\n    // unpack and set default value if not specified\n    // get wiki attachments\n    await this.getWikiPageMarkdown()\n    this.processMath()\n    this.setState({ isLoading: false })\n  }\n\n  // on component update find and re-render the math/widget items accordingly\n  public async componentDidUpdate(prevProps: MarkdownSynapseProps) {\n    let shouldUpdate = this.props.token !== prevProps.token\n    shouldUpdate = shouldUpdate || this.props.ownerId !== prevProps.ownerId\n    shouldUpdate = shouldUpdate || this.props.wikiId !== prevProps.wikiId\n\n    // we have to carefully update the component so it doesn't encounter an infinite loop\n    if (shouldUpdate) {\n      await this.getWikiPageMarkdown()\n    }\n    this.processMath()\n  }\n\n  public render() {\n    const { renderInline, token } = this.props\n    const { isLoading, error } = this.state\n\n    if (error) {\n      return <Error token={token} error={error} />\n    }\n    const bookmarks = this.addBookmarks()\n    const content = (\n      <>\n        {isLoading && <span className=\"spinner\" />}\n        {this.renderMarkdown()}\n        {bookmarks && <div>{this.addBookmarks()}</div>}\n      </>\n    )\n    if (renderInline) {\n      return (\n        <span className=\"markdown markdown-inline\" ref={this.markupRef}>\n          {content}\n        </span>\n      )\n    }\n    return (\n      <div className=\"markdown\" ref={this.markupRef}>\n        {content}\n      </div>\n    )\n  }\n}\n","import { QueryBundleRequest } from '../synapseTypes/'\nimport { SynapseClient, SynapseConstants } from '..'\nimport { QueryResultBundle } from '../synapseTypes/'\nimport { cloneDeep } from 'lodash-es'\n\ntype PartialStateObject = {\n  hasMoreData: boolean\n  data: QueryResultBundle\n}\n\n/**\n * Grab the next page of data, pulling in 25 more rows.\n *\n * @param {*} queryRequest Query request as specified by\n *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n */\nexport const getNextPageOfData = async (\n  queryRequest: QueryBundleRequest,\n  data: QueryResultBundle,\n  token?: string,\n) => {\n  return await SynapseClient.getQueryTableResults(queryRequest, token)\n    .then((newData: QueryResultBundle) => {\n      const oldData: QueryResultBundle = cloneDeep(data)!\n      // push on the new data retrieved from the API call\n      const hasMoreData =\n        newData.queryResult.queryResults.rows.length ===\n        SynapseConstants.PAGE_SIZE\n      oldData.queryResult.queryResults.rows.push(\n        ...newData.queryResult.queryResults.rows,\n      )\n      const newState: PartialStateObject = {\n        hasMoreData,\n        data: oldData,\n      }\n      return newState\n    })\n    .catch(err => {\n      console.log('Failed to get data ', err)\n      return {} as PartialStateObject\n    })\n}\n","import { QueryBundleRequest } from '../synapseTypes/Table/QueryBundleRequest'\nimport { Query } from '../synapseTypes'\nimport { SynapseConstants } from '..'\nimport { parseEntityIdFromSqlStatement } from './sqlFunctions'\n\n//id consists of a component class/function name and it's index\nfunction getComponentSearchHashId(\n  componentName: string,\n  componentIndex: number,\n): string {\n  return `${componentName}${componentIndex}`\n}\n\n//returns updated search string with the component's info\nfunction patchSearchString(\n  componentSearchHashId: string,\n  stringifiedQuery: string,\n): string | undefined {\n  const searchString = window.location.search\n\n  const searchFragment = `${componentSearchHashId}=${stringifiedQuery}`\n  if (!searchString) {\n    return searchFragment\n  }\n\n  if (!searchString.includes(`${componentSearchHashId}=`)) {\n    //substr(1) because we don't want '?' character\n    return `${searchString.substr(1)}&${searchFragment}`\n  }\n  const searchHashes = window.location.search\n    .slice(searchString.indexOf('?') + 1)\n    .split('&')\n\n  const searchHashesUpdated = searchHashes\n    .map(item => {\n      const split = item.split('=')\n      if (split[0] === componentSearchHashId) {\n        return `${searchFragment}`\n      } else return item\n    })\n    .join('&')\n  return searchHashesUpdated\n}\n\n//gets a value for the search param for the component from the url\nexport function getSearchParamValueFromUrl(\n  componentName: string,\n  componentIndex: number,\n): string | undefined {\n  if (!window.location.search) {\n    return undefined\n  }\n  const componentSearchHashId = getComponentSearchHashId(\n    componentName,\n    componentIndex,\n  )\n  const hashes = window.location.search\n    .slice(window.location.search.indexOf('?') + 1)\n    .split('&')\n  const getSearchParamValue = hashes\n    .filter(item => {\n      const hash = item.split('=')\n      return hash[0] === componentSearchHashId\n    })\n    .map(item => item.split('=')[1])[0]\n  return getSearchParamValue\n    ? decodeURIComponent(getSearchParamValue)\n    : undefined\n}\n\n//updates the url with the components new search params\nexport function updateUrlWithNewSearchParam(\n  componentName: string,\n  componentIndex: number | undefined,\n  stringifiedQuery: string,\n) {\n  const componentSearchHashId =\n    componentIndex !== undefined\n      ? getComponentSearchHashId(componentName, componentIndex)\n      : componentName\n  const searchString = patchSearchString(\n    componentSearchHashId,\n    stringifiedQuery,\n  )\n  const location = window.location\n  const newURL = `${location.protocol}//${location.hostname}${\n    location.port ? ':' + location.port : ''\n  }${location.pathname}?${searchString}`\n\n  window.history.pushState('object or string', 'Title', newURL)\n}\n\nexport function getQueryRequestFromLink(\n  componentName: string,\n  componentIndex: number,\n): QueryBundleRequest | undefined {\n  const searchParamValue = getSearchParamValueFromUrl(\n    componentName,\n    componentIndex,\n  )\n\n  let initQueryRequest: QueryBundleRequest | undefined = undefined\n  if (searchParamValue) {\n    const query = JSON.parse(searchParamValue) as Query\n    if (query.sql) {\n      initQueryRequest = {\n        concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n        partMask:\n          SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n          SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n          SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n          SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n        entityId: parseEntityIdFromSqlStatement(query.sql),\n        query,\n      }\n    }\n  }\n  return initQueryRequest\n}\n","import * as React from 'react'\n\nimport { SynapseClient, SynapseConstants } from '../utils/'\nimport { getNextPageOfData } from '../utils/functions/queryUtils'\nimport * as DeepLinkingUtils from '../utils/functions/deepLinkingUtils'\nimport {\n  AsynchronousJobStatus,\n  FacetColumnResultValues,\n  QueryBundleRequest,\n  QueryResultBundle,\n} from '../utils/synapseTypes/'\nimport { cloneDeep } from 'lodash-es'\nimport { SynapseClientError } from '../utils/SynapseClient'\nexport type QueryWrapperProps = {\n  visibleColumnCount?: number\n  initQueryRequest: QueryBundleRequest\n  rgbIndex?: number\n  token?: string\n  facet?: string\n  unitDescription?: string\n  facetAliases?: {}\n  loadNow?: boolean\n  showBarChart?: boolean\n  componentIndex?: number //used for deep linking\n  shouldDeepLink?: boolean\n  hiddenColumns?: string[]\n  lockedFacet?: LockedFacet\n}\n\nexport type TopLevelControlsState = {\n  showFacetVisualization: boolean\n  showFacetFilter: boolean\n  showColumnFilter: boolean\n  showSearchBar: boolean\n  showDownloadConfirmation: boolean\n  showColumnSelectDropdown: boolean\n}\n\nexport type SearchQuery = {\n  columnName: string\n  searchText: string\n}\n\nexport type QueryWrapperState = {\n  /*\n    isAllFilterSelectedForFacet tracks whether for a particular\n     facet if the 'All' button has been selected, this tracks the\n     click event and syncs Facets.tsx and SynapseTable.tsx\n  */\n  isAllFilterSelectedForFacet: {}\n  data: QueryResultBundle | undefined\n  isLoadingNewData: boolean // occurs when props change\n  isLoading: boolean // occurs when state changes\n  lastQueryRequest: QueryBundleRequest\n  hasMoreData: boolean\n  // TODO: Delete lastFacetSelection once StackedBarChart.tsx/Facets.tsx are deleted\n  lastFacetSelection: FacetSelection\n  chartSelectionIndex: number\n  asyncJobStatus?: AsynchronousJobStatus\n  facetAliases?: {}\n  loadNowStarted: boolean\n  topLevelControlsState?: TopLevelControlsState\n  isColumnSelected: string[]\n  selectedRowIndices?: number[]\n  error: SynapseClientError | undefined\n}\n\n/*\n  For details page: to lock a facet name (e.g. study, grant) so that the facet name\n  and its all possible values will not appear on the details page. The facet name is\n  given by the url's search param. The type is defined here so that other child components\n  in SRC won't generate type errors.\n */\nexport type LockedFacet = {\n  facet?: string,\n  value?: string\n}\n\nexport type FacetSelection = {\n  columnName: string\n  facetValue: string\n  selector: string\n}\n\n// Since the component is an HOC we export the props passed down\nexport type QueryWrapperChildProps = {\n  isAllFilterSelectedForFacet?: {}\n  isLoading?: boolean\n  token?: string\n  entityId?: string\n  isLoadingNewData?: boolean\n  executeQueryRequest?: (param: QueryBundleRequest) => void\n  executeInitialQueryRequest?: () => void\n  getNextPageOfData?: (queryRequest: QueryBundleRequest) => void\n  getLastQueryRequest?: () => QueryBundleRequest\n  getInitQueryRequest?: () => QueryBundleRequest\n  data?: QueryResultBundle\n  facet?: string\n  updateParentState?: <K extends keyof QueryWrapperState>(\n    param: Pick<QueryWrapperState, K>,\n  ) => void\n  rgbIndex?: number\n  unitDescription?: string\n  facetAliases?: {}\n  lastFacetSelection?: FacetSelection\n  chartSelectionIndex?: number\n  asyncJobStatus?: AsynchronousJobStatus\n  showBarChart?: boolean\n  hasMoreData?: boolean\n  topLevelControlsState?: TopLevelControlsState\n  isColumnSelected?: string[]\n  selectedRowIndices?: number[]\n  error?: SynapseClientError | undefined,\n  lockedFacet?: LockedFacet\n}\n\n/**\n * Class wraps around any Synapse views that are dependent on a query bundle\n * Those classes then take in as props:\n *\n * @class QueryWrapper\n * @extends {React.Component}\n */\nexport default class QueryWrapper extends React.Component<\n  QueryWrapperProps,\n  QueryWrapperState\n> {\n  private componentIndex: number\n  constructor(props: QueryWrapperProps) {\n    super(props)\n    this.executeInitialQueryRequest = this.executeInitialQueryRequest.bind(this)\n    this.executeQueryRequest = this.executeQueryRequest.bind(this)\n    this.getLastQueryRequest = this.getLastQueryRequest.bind(this)\n    this.getNextPageOfData = this.getNextPageOfData.bind(this)\n    this.updateParentState = this.updateParentState.bind(this)\n    this.getInitQueryRequest = this.getInitQueryRequest.bind(this)\n    this.state = {\n      data: undefined,\n      isLoading: true,\n      isLoadingNewData: true,\n      hasMoreData: true,\n      lastFacetSelection: {\n        columnName: '',\n        facetValue: '',\n        selector: '',\n      },\n      chartSelectionIndex: 0,\n      isAllFilterSelectedForFacet: {},\n      loadNowStarted: false,\n      lastQueryRequest: cloneDeep(this.props.initQueryRequest!),\n      topLevelControlsState: {\n        showColumnFilter: true,\n        showFacetFilter: true,\n        showFacetVisualization: true,\n        showSearchBar: false,\n        showDownloadConfirmation: false,\n        showColumnSelectDropdown: false,\n      },\n      isColumnSelected: [],\n      selectedRowIndices: [],\n      error: undefined,\n    }\n    this.componentIndex = props.componentIndex || 0\n  }\n\n  /**\n   * Compute default query request\n   *\n   * @memberof QueryWrapper\n   */\n  public componentDidMount() {\n    const { loadNow = true } = this.props\n    const query = DeepLinkingUtils.getQueryRequestFromLink(\n      'QueryWrapper',\n      this.componentIndex,\n    )\n\n    if (loadNow) {\n      this.executeInitialQueryRequest(query)\n    }\n  }\n\n  /**\n   * @memberof QueryWrapper\n   */\n  public componentDidUpdate(prevProps: QueryWrapperProps) {\n    /**\n     *  If component updates and the token has changed (they signed in) then the data should be pulled in. Or if the\n     *  sql query has changed of the component then perform an update.\n     */\n\n    const { loadNow = true } = this.props\n    if (loadNow && !this.state.loadNowStarted) {\n      this.executeInitialQueryRequest()\n    } else if (loadNow && this.props.token !== prevProps.token) {\n      // if loadNow is true and they've logged in with a token that is not undefined, null, or an empty string when it was before\n      this.executeQueryRequest(this.getLastQueryRequest())\n    } else if (\n      prevProps.initQueryRequest.query.sql !==\n      this.props.initQueryRequest!.query.sql\n    ) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * last query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getLastQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.state.lastQueryRequest)\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * first query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getInitQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.props.initQueryRequest)\n  }\n  /**\n   * Execute the given query\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeQueryRequest(queryRequest: QueryBundleRequest) {\n    const clonedQueryRequest = cloneDeep(queryRequest)\n    this.setState({\n      isLoading: true,\n      lastQueryRequest: clonedQueryRequest,\n      selectedRowIndices: [], // reset selected row indices any time the query is re-run\n    })\n\n    if (clonedQueryRequest.query) {\n      const stringifiedQuery = encodeURIComponent(\n        JSON.stringify(clonedQueryRequest.query),\n      )\n      if (this.props.shouldDeepLink) {\n        DeepLinkingUtils.updateUrlWithNewSearchParam(\n          'QueryWrapper',\n          this.componentIndex,\n          stringifiedQuery,\n        )\n      }\n    }\n    return SynapseClient.getQueryTableResults(\n      clonedQueryRequest,\n      this.props.token,\n      this.updateParentState,\n    )\n      .then((data: QueryResultBundle) => {\n        const hasMoreData =\n          data.queryResult.queryResults.rows.length ===\n          SynapseConstants.PAGE_SIZE\n        const newState = {\n          hasMoreData,\n          data,\n          asyncJobStatus: undefined,\n        }\n        this.setState(newState)\n      })\n      .catch(error => {\n        console.error('Failed to get data ', error)\n        this.setState(error)\n      })\n      .finally(() => {\n        this.setState({ isLoading: false, isLoadingNewData: false })\n      })\n  }\n\n  /**\n   * Grab the next page of data, pulling in 25 more rows.\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public async getNextPageOfData(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true,\n    })\n\n    await getNextPageOfData(\n      queryRequest,\n      this.state.data!,\n      this.props.token,\n    ).then(newState => {\n      this.setState({\n        ...newState,\n        isLoading: false,\n        lastQueryRequest: cloneDeep(queryRequest),\n      })\n    })\n  }\n\n  /**\n   * Execute the initial query passed into the component\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeInitialQueryRequest(\n    initQueryRequest: QueryBundleRequest = this.props.initQueryRequest,\n  ) {\n    const lastQueryRequest: QueryBundleRequest = cloneDeep(initQueryRequest)\n    this.setState({\n      isLoading: true,\n      chartSelectionIndex: 0,\n      loadNowStarted: true,\n      lastQueryRequest,\n    })\n    SynapseClient.getQueryTableResults(\n      initQueryRequest,\n      this.props.token,\n      this.updateParentState,\n    )\n      .then((data: QueryResultBundle) => {\n        const hasMoreData =\n          data.queryResult.queryResults.rows.length ===\n          SynapseConstants.PAGE_SIZE\n        const isAllFilterSelectedForFacet = cloneDeep(\n          this.state.isAllFilterSelectedForFacet,\n        )\n        let { chartSelectionIndex } = this.state\n        if (this.props.facet) {\n          if (!data.facets) {\n            throw Error(\n              'Error on query request, must include facets in partmask to show facets',\n            )\n          }\n          const enumFacets = data.facets.filter(\n            el => el.facetType === 'enumeration',\n          ) as FacetColumnResultValues[]\n          enumFacets.forEach(el => {\n            // isAll is only true iff there are no facets selected or all elements are selected\n            const { facetValues } = el\n            const isAllFalse = facetValues.every(facet => !facet.isSelected)\n            const isAllTrue = facetValues.every(facet => facet.isSelected)\n            const isByDefaultSelected = isAllFalse || isAllTrue\n            isAllFilterSelectedForFacet[el.columnName] = isByDefaultSelected\n            if (el.columnName === this.props.facet && !isAllFalse) {\n              // Note - this picks the first selected facet\n              chartSelectionIndex = facetValues\n                .sort((a, b) => b.count - a.count)\n                .findIndex(facet => facet.isSelected)\n            }\n          })\n        }\n        const newState = {\n          isAllFilterSelectedForFacet,\n          hasMoreData,\n          data,\n          chartSelectionIndex,\n          asyncJobStatus: undefined,\n          isColumnSelected:\n            data?.selectColumns\n              ?.slice(0, this.props.visibleColumnCount ?? Infinity)\n              .map(el => el.name) ?? [],\n        }\n        this.setState(newState)\n      })\n      .catch(error => {\n        console.error('Failed to get data ', error)\n        this.setState({\n          error,\n        })\n      })\n      .finally(() => {\n        this.setState({\n          isLoading: false,\n          isLoadingNewData: false,\n        })\n      })\n  }\n\n  public updateParentState<K extends keyof QueryWrapperState>(\n    update: Pick<QueryWrapperState, K>,\n  ) {\n    this.setState(update)\n  }\n\n  /**\n   * remove a particular facet name (e.g. study) and its all possible values based on the parameter specified in the url\n   * this is to remove the facet from the charts, search and filter.\n   * @return data: QueryResultBundle\n   */\n  public removeLockedFacetData (){\n    const lockedFacet = this.props.lockedFacet?.facet\n    if (lockedFacet && this.state.data) {  // for details page, return data without the \"locked\" facet\n      const data = cloneDeep(this.state.data)\n      const facets = data.facets?.filter( item => item.columnName !== lockedFacet)\n      data.facets = facets\n      return data\n    } else {  // for other pages, just return the data\n      return this.state.data\n    }\n  }\n\n  /**\n   * Render the children without any formatting\n   */\n  public render() {\n    const { isLoading } = this.state\n    const { children, ...rest } = this.props\n    // inject props in children of this component\n    const childrenWithProps = React.Children.map(children, (child: any) => {\n      if (!child) {\n        return child\n      }\n      const queryWrapperChildProps: QueryWrapperChildProps = {\n        isAllFilterSelectedForFacet: this.state.isAllFilterSelectedForFacet,\n        data: this.removeLockedFacetData(),\n        hasMoreData: this.state.hasMoreData,\n        lastFacetSelection: this.state.lastFacetSelection,\n        chartSelectionIndex: this.state.chartSelectionIndex,\n        isLoading: this.state.isLoading,\n        isLoadingNewData: this.state.isLoadingNewData,\n        asyncJobStatus: this.state.asyncJobStatus,\n        topLevelControlsState: this.state.topLevelControlsState,\n        isColumnSelected: this.state.isColumnSelected,\n        selectedRowIndices: this.state.selectedRowIndices,\n        error: this.state.error,\n        executeInitialQueryRequest: this.executeInitialQueryRequest,\n        executeQueryRequest: this.executeQueryRequest,\n        getLastQueryRequest: this.getLastQueryRequest,\n        getNextPageOfData: this.getNextPageOfData,\n        updateParentState: this.updateParentState,\n        getInitQueryRequest: this.getInitQueryRequest,\n        ...rest,\n      }\n      return React.cloneElement(child, queryWrapperChildProps)\n    })\n\n    const loadingCusrorClass = isLoading ? 'SRC-logo-cursor' : ''\n    return (\n      <div className={`SRC-wrapper ${loadingCusrorClass}`}>\n        {childrenWithProps}\n      </div>\n    )\n  }\n}\n","import { EntityHeader, UserProfile } from '../synapseTypes'\nimport { SynapseConstants } from '..'\n\nexport const getStoredEntityHeaders = (): EntityHeader[] => {\n    try {\n      const lookUpEntityHeaders: EntityHeader[] = JSON.parse(\n        sessionStorage.getItem(SynapseConstants.ENTITY_HEADER_STORAGE_KEY) || '',\n      )\n      return lookUpEntityHeaders\n    } catch (e) {\n      return []\n    }\n  }\n\n  export const getStoredUserProfiles = (): UserProfile[] => {\n    try {\n      const lookUpUserIds: UserProfile[] = JSON.parse(\n        sessionStorage.getItem(SynapseConstants.USER_PROFILE_STORAGE_KEY) || '',\n      )\n      return lookUpUserIds\n    } catch (e) {\n      return []\n    }\n  }","import React, { FunctionComponent } from 'react'\nimport {\n  FontAwesomeIcon,\n  FontAwesomeIconProps,\n} from '@fortawesome/react-fontawesome'\nimport ReactTooltip from 'react-tooltip'\nimport { TOOLTIP_DELAY_SHOW } from '../table/SynapseTableConstants'\nimport { IconDefinition } from '@fortawesome/fontawesome-svg-core'\nimport { Dropdown } from 'react-bootstrap'\nimport { Icon } from '../row_renderers/utils'\n\ntype CustomImageProps = {\n  svgImg: React.ComponentElement<any, any>\n  altText: string\n}\n\nexport type TooltipVisualProps = {\n  delayShow: number\n  place: 'top' | 'right' | 'bottom' | 'left'\n  type: 'dark' | 'success' | 'warning' | 'error' | 'info' | 'light'\n  effect: 'float' | 'solid'\n  border?: boolean\n}\n\n/*****************************************\n *  The control needs to either have a child element or needs to have an image supplied\n *  If the child element is supplied the control renders the child applying additional properties\n *  If the image is supplied the control renders a clickable image\n *  If there are no children and callback Fn is not supplied it is assumed to be a a dropdown trigger\n */\n\ntype ElementWithTooltipProps = {\n  image?: IconDefinition | CustomImageProps\n  imageColor?: string\n  idForToolTip: string\n  tooltipText: string\n  callbackFn?: Function\n  className?: string\n  tooltipVisualProps?: TooltipVisualProps\n  darkTheme?: boolean\n  size?: FontAwesomeIconProps['size']\n  icon?: string\n}\n\nfunction getTooltipTriggerContents(\n  image: IconDefinition | CustomImageProps,\n  imageColor: string | undefined,\n  size: FontAwesomeIconProps['size'] | undefined,\n): JSX.Element {\n  if ('svgImg' in image) {\n    return image.svgImg\n  } else {\n    return (\n      <FontAwesomeIcon\n        size={size ?? '1x'}\n        color={imageColor || 'white'}\n        icon={image}\n      />\n    )\n  }\n}\n\nexport const ElementWithTooltip: FunctionComponent<ElementWithTooltipProps> = ({\n  image,\n  idForToolTip,\n  callbackFn,\n  tooltipText,\n  className = '',\n  imageColor,\n  tooltipVisualProps = { place: 'top', type: 'dark', effect: 'solid' },\n  children,\n  darkTheme,\n  size,\n  icon\n}) => {\n  const { place, type, effect, border } = tooltipVisualProps\n  const iconComponent = icon ? (<Icon type={icon}></Icon>) : undefined\n  const tooltipTriggerContents = iconComponent ? iconComponent : image\n    ? getTooltipTriggerContents(image, imageColor, size)\n    : children || <></>\n\n  //if there is no callbackFn - assume it's a toggle\n\n  let tooltipTrigger: JSX.Element\n  if (!children) {\n    tooltipTrigger = callbackFn ? (\n      <button\n        tabIndex={0}\n        id={idForToolTip}\n        data-for={idForToolTip}\n        data-tip={tooltipText}\n        className={`ElementWithTooltip SRC-hand-cursor SRC-primary-background-color-hover ${className} ${\n          darkTheme ? 'dark-theme' : ''\n        } `}\n        onKeyPress={() => callbackFn()}\n        onClick={() => callbackFn()}\n        aria-label={tooltipText}\n      >\n        {tooltipTriggerContents}\n      </button>\n    ) : (\n      <Dropdown.Toggle\n        data-for={idForToolTip}\n        data-tip={tooltipText}\n        id={idForToolTip}\n        className={`ElementWithTooltip SRC-hand-cursor SRC-primary-background-color-hover ${className} ${\n          darkTheme ? 'dark-theme' : ''\n        } `}\n        variant={'light'}\n      >\n        {tooltipTriggerContents}\n      </Dropdown.Toggle>\n    )\n  } else {\n    const outerChild = children as JSX.Element\n    tooltipTrigger = React.cloneElement(outerChild, {\n      className: `${outerChild.props.className} SRC-hand-cursor`,\n      id: idForToolTip,\n      'data-for': idForToolTip,\n      'data-tip': tooltipText,\n    })\n  }\n\n  return (\n    <>\n      {tooltipTrigger}\n      <ReactTooltip\n        delayShow={TOOLTIP_DELAY_SHOW}\n        place={place}\n        type={type}\n        effect={effect}\n        border={border ? true : false}\n        id={idForToolTip}\n      />\n    </>\n  )\n}\n","import * as React from 'react'\nimport { useState, useEffect } from 'react'\nexport type CheckboxProps = {\n  label: string\n  id: string\n  checked?: boolean\n  className?: string\n  onChange: Function\n  isSelectAll?: boolean\n}\n\nexport const Checkbox: React.FunctionComponent<CheckboxProps> = (\n  props: CheckboxProps,\n) => {\n  const { checked: propsChecked = false, isSelectAll = false } = props\n  const [checked, setChecked] = useState<boolean>(propsChecked)\n\n  useEffect(() => {\n    setChecked(propsChecked)\n  }, [propsChecked])\n\n  const handleCheckboxChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    props.onChange(event.target.checked)\n    if (isSelectAll && event.target.checked === false) {\n      /* \n         You can click the all checkbox from off -> on\n         but clicking it off is a no-op\n      */\n      setChecked(true)\n    } else {\n      setChecked(event.target.checked)\n    }\n  }\n\n  const className = props.className ? `checkbox ${props.className}` : `checkbox`\n\n  return (\n    <div className={className}>\n      <label>\n        <span>\n          <input\n            type=\"checkbox\"\n            checked={checked}\n            id={props.id}\n            onChange={handleCheckboxChange}\n          />\n          <span>{props.label}</span>\n        </span>\n      </label>\n    </div>\n  )\n}\n","import { useState } from 'react'\nimport { EntityHeader, Reference, ReferenceList } from '../synapseTypes'\nimport { getEntityHeader } from '../SynapseClient'\nimport { getUserProfileWithProfilePicAttached } from '../functions/getUserData'\nimport { UserProfile } from '../synapseTypes'\nimport { SynapseConstants } from '..'\nimport { without, chunk, uniq } from 'lodash-es'\nimport useDeepCompareEffect from 'use-deep-compare-effect'\n\nexport type HookType = 'ENTITY_HEADER' | 'USER_PROFILE'\nexport type UseGetInfoFromIdsProps = {\n  ids: string[]\n  token: string | undefined\n  type: HookType\n}\n\ntype LookupRequestType = string | Reference\n\nconst UserProfileTemplate: UserProfile = {\n  ownerId: '', // A foreign key to the ID of the 'principal' object for the user\n  firstName: 'Unknown', // This person's given name (forename)\n  lastName: 'Unknown', // This person's family name (surname)\n  userName: 'Unknown', // A name chosen by the user that uniquely identifies them\n}\n\nconst entityHeaderTemplate: EntityHeader = {\n  name: 'Unknown', //\tThe name of the entity\n  id: 'unknown', //\tThe id of the entity\n  type: 'unknown', //\tThe type of the entity\n  versionNumber: 0, //\tThe version number of the entity\n  versionLabel: 'placeholder', //\tThe user defined version label of the entity\n  benefactorId: 0, //\tThe ID of the entity that this Entity's ACL is inherited from.\n  createdOn: 'null', //\tThe date this entity was created.\n  modifiedOn: 'null', //\tThe date this entity was last modified.\n  createdBy: 'null', //\tThe ID of the user that created this entity.\n  modifiedBy: 'null', //\tThe ID of the user that last modified this entity.\n}\n\nconst getEntityHeaderItems = async (\n  lookupList: ReferenceList,\n  token: string | undefined,\n): Promise<EntityHeader[]> => {\n  const newData = await getEntityHeader(lookupList, token)\n  const notFound = lookupList.filter(\n    item => newData.results.map(item => item.id).indexOf(item.targetId) === -1,\n  )\n  const notFoundPlaceholders = notFound.map(item => ({\n    ...entityHeaderTemplate,\n    id: item.targetId,\n    name: `${item.targetId}`,\n  }))\n\n  return [...newData.results, ...notFoundPlaceholders]\n}\n\nconst getUserProfileItems = async (\n  lookupList: string[],\n  token: string | undefined,\n): Promise<UserProfile[]> => {\n  const newData = await getUserProfileWithProfilePicAttached(lookupList, token)\n  const notFound = lookupList.filter(\n    item => newData.list.map(item => item.ownerId).indexOf(item) === -1,\n  )\n  const notFoundPlaceholders = notFound.map(item => ({\n    ...UserProfileTemplate,\n    ownerId: item,\n    name: `Unknown User (${item})`,\n  }))\n\n  return [...newData.list, ...notFoundPlaceholders]\n}\n\n// React hook to get user profiles or entities\n//******************************************************************************************* */\nexport default function useGetInfoFromIds<T extends EntityHeader | UserProfile>(\n  props: UseGetInfoFromIdsProps,\n) {\n  const { token, ids, type } = props\n  const [data, setData] = useState<Array<T>>([])\n\n  const idProp = (type: HookType) =>\n    type === 'USER_PROFILE' ? 'ownerId' : 'id'\n\n  const storageKey = (type: HookType) =>\n    type === 'USER_PROFILE'\n      ? SynapseConstants.USER_PROFILE_STORAGE_KEY\n      : SynapseConstants.ENTITY_HEADER_STORAGE_KEY\n\n  // look at current list of data, see if incoming ids has new data,\n  // if so grab those ids\n  const curList = data.map(el => el[idProp(type)])\n  const incomingList = ids.filter(el => el !== SynapseConstants.VALUE_NOT_SET)\n  const newValues = uniq(without(incomingList, ...curList))\n\n  const saveToSessionStorage = (data: T[], type: HookType) => {\n    if (!data.length) {\n      return\n    }\n    //get what's there\n    const dataInStorage = sessionStorage.getItem(storageKey(type))\n    try {\n      const dataInStorageAsObjectArr: T[] = dataInStorage\n        ? JSON.parse(dataInStorage)\n        : []\n      //get an array of ids for items already in storage\n      const ids = dataInStorageAsObjectArr.map(item => item[idProp(type)])\n      //push all the new data if ids are new\n      for (const dataObject of data) {\n        if (!ids.includes(dataObject[idProp(type)])) {\n          dataInStorageAsObjectArr.push(dataObject)\n        }\n      }\n      sessionStorage.setItem(\n        storageKey(type),\n        JSON.stringify(dataInStorageAsObjectArr),\n      )\n    } catch (e) {\n      sessionStorage.setItem(storageKey(type), JSON.stringify(data))\n    }\n  }\n\n  // Alina TODO: check if the items are already in Local Storage before making server call.\n\n  // Michael TODO: There's a bug where the data held in useGetInfoFromIds will be stale if the user token changes,\n  // this can be solved by using the useCompare hook on the token to track when it changes\n  useDeepCompareEffect(() => {\n    const getData = async () => {\n      if (newValues.length > 0) {\n        try {\n          const newIds = Array.from<string>(newValues)\n          const newReferences: LookupRequestType[] =\n            type === 'USER_PROFILE'\n              ? newIds\n              : newIds.map(el => ({ targetId: el }))\n          const newReferencesChunks = chunk(newReferences, 45)\n          const totalData: T[] = []\n          for (const newReferences of newReferencesChunks) {\n            const newData =\n              type === 'USER_PROFILE'\n                ? await getUserProfileItems(newReferences as string[], token)\n                : await getEntityHeaderItems(\n                    newReferences as ReferenceList,\n                    token,\n                  )\n            totalData.push(...(newData as T[]))\n          }\n          setData(oldData => oldData.concat(...(totalData as T[])))\n        } catch (error) {\n          console.error('Error on data retrieval', error)\n        }\n      }\n      saveToSessionStorage(data, type)\n    }\n    getData()\n  }, [token, type, newValues])\n  return data\n}\n","import * as React from 'react'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\nimport iconPlus from '../../../assets/icons/icon_plus.svg'\nimport iconMinus from '../../../assets/icons/icon_minus.svg'\nimport '../../../style/components/query_filter/_facet-filter-header.scss'\n\nexport type FacetFilterHeaderProps = {\n  label: string\n  isCollapsed: boolean\n  onClick: Function\n  facetAliases: {} | undefined\n}\nexport const FacetFilterHeader: React.FunctionComponent<FacetFilterHeaderProps> = ({\n  label,\n  isCollapsed,\n  onClick,\n  facetAliases,\n}: FacetFilterHeaderProps) => {\n  return (\n    <div className=\"FacetFilterHeader\">\n      <label className=\"FacetFilterHeader__label\">\n        {unCamelCase(label, facetAliases)}\n      </label>\n      <button\n        className=\"FacetFilterHeader__collapseToggleBtn\"\n        onClick={() => onClick(!isCollapsed)}\n      >\n        {isCollapsed ? <img src={iconPlus} alt=\"Expand Menu\" className=\"icon-plus\" /> : <img src={iconMinus} alt=\"Collapse Menu\"  className=\"icon-minus\" />}\n      </button>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport {\n  FacetColumnResultValueCount,\n  ColumnModel,\n} from '../../../utils/synapseTypes/Table'\nimport { Checkbox } from '../Checkbox'\nimport { SynapseConstants } from '../../../utils'\nimport { useState } from 'react'\nimport { EntityHeader } from '../../../utils/synapseTypes/EntityHeader'\nimport { UserProfile } from '../../../utils/synapseTypes'\nimport useGetInfoFromIds from '../../../utils/hooks/useGetInfoFromIds'\nimport { faArrowLeft } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { FacetFilterHeader } from './FacetFilterHeader'\nimport { ElementWithTooltip } from '../../../containers/widgets/ElementWithTooltip'\nimport useDeepCompareEffect from 'use-deep-compare-effect'\n\nlibrary.add(faArrowLeft)\n\nexport type EnumFacetFilterProps = {\n  facetValues: FacetColumnResultValueCount[]\n  columnModel: ColumnModel\n  token?: string\n  onChange: Function\n  onClear: Function\n  facetAliases: {} | undefined\n  containerAs?: 'Collapsible' | 'Dropdown'\n}\n\nfunction valueToId(value: string): string {\n  return value.replace(/\\s/g, '').toLowerCase()\n}\n\nfunction valueToLabel(\n  facet: FacetColumnResultValueCount,\n  profiles: UserProfile[] = [],\n  entityHeaders: EntityHeader[] = [],\n): string {\n  const { value } = facet\n  let displayValue = value\n  if (value === SynapseConstants.VALUE_NOT_SET) {\n    displayValue = 'Unannotated'\n  }\n  const profile = profiles.find(profile => profile.ownerId === value)\n  if (profile) {\n    displayValue = profile ? profile.userName : `unknown (${value})`\n  }\n\n  const eh = entityHeaders.find(eh => eh.id === value)\n  if (eh) {\n    displayValue = eh ? eh.name : `unknown (${value})`\n  }\n\n  return `${displayValue}`\n}\n\nfunction formatFacetValuesForDisplay(\n  facetValues: FacetColumnResultValueCount[],\n  isShowAll: boolean,\n  visibleItemsCount: number,\n) {\n  //sort facets by count\n  const facets = [...facetValues.sort((a, b) => b.count - a.count)]\n  if (isShowAll || facets.length <= visibleItemsCount) {\n    return facets\n  } else {\n    //if we are not hiding elected facets\n    if (facets.slice(visibleItemsCount).find(item => item.isSelected)) {\n      return facets\n    } else {\n      return facets.splice(0, visibleItemsCount)\n    }\n  }\n}\n\n/************* QUERY ENUM CONMPONENT  *************/\n\nexport const EnumFacetFilter: React.FunctionComponent<EnumFacetFilterProps> = ({\n  token,\n  facetValues,\n  columnModel,\n  onClear,\n  onChange,\n  facetAliases,\n  containerAs = 'Collapsible',\n}: EnumFacetFilterProps) => {\n  const [isShowAll, setIsShowAll] = useState<boolean>(false)\n  const [isCollapsed, setIsCollapsed] = useState<boolean>(false)\n  const [isShowDropdown, setIsShowDropdown] = useState<boolean>(false)\n  const [showSearch, setShowSearch] = useState<boolean>(false)\n  const [searchTerm, setSearchText] = useState<string>('')\n  const [filteredSet, setFilteredSet] = useState<FacetColumnResultValueCount[]>(\n    facetValues,\n  )\n\n  useDeepCompareEffect(() => {\n    setFilteredSet(facetValues)\n  }, [facetValues])\n\n  const visibleItemsCount = 5\n  const selectionDelay = 1500 // in ms\n  const textInput: React.RefObject<HTMLInputElement> = React.createRef()\n  const selectedValuesMap = {}\n  let timer: ReturnType<typeof setTimeout>\n\n  const userIds =\n    columnModel?.columnType === 'USERID'\n      ? facetValues.map(facet => facet.value)\n      : []\n  const userProfiles = useGetInfoFromIds<UserProfile>({\n    ids: userIds,\n    token,\n    type: 'USER_PROFILE',\n  })\n\n  const entityIds =\n    columnModel?.columnType === 'ENTITYID'\n      ? facetValues.map(facet => facet.value)\n      : []\n  const entityHeaders = useGetInfoFromIds<EntityHeader>({\n    ids: entityIds,\n    token,\n    type: 'ENTITY_HEADER',\n  })\n\n  const handleTextInputFilterEvent = (\n    e: React.ChangeEvent<HTMLInputElement>,\n  ) => {\n    const inputValue: string = e.target.value\n    setSearchText(inputValue)\n    setIsShowAll(true) // While in filter search mode, display all filtered values\n\n    if (!inputValue) {\n      // if input field is empty, display all facet values\n      facetValues.forEach(obj => {\n        obj.isSelected = false\n      })\n      setFilteredSet(facetValues)\n    } else {\n      // display only facet values that contain text from the text input field\n      const filtered = facetValues.filter(obj => {\n        const label = valueToLabel(obj, userProfiles, entityHeaders)\n        return label.toLowerCase().indexOf(inputValue.trim().toLowerCase()) > -1\n          ? obj\n          : null\n      })\n      setFilteredSet(filtered)\n    }\n  }\n\n  if (!columnModel) {\n    return <></>\n  }\n  const isDropdown = containerAs === 'Dropdown'\n  const content = (\n    <div className={isDropdown ? 'EnumFacetFilter__dropdown_menu' : ''}>\n      <div className=\"EnumFacetFilter__checkboxContainer--forAll\">\n        <div\n          className={\n            showSearch\n              ? 'EnumFacetFilter__search active'\n              : 'EnumFacetFilter__search'\n          }\n        >\n          <button // Close Search Button\n            className=\"EnumFacetFilter__closeSearch\"\n            onClick={() => {\n              setFilteredSet(facetValues)\n              setShowSearch(false)\n              setIsShowAll(false)\n            }}\n          >\n            <FontAwesomeIcon\n              className=\"EnumFacetFilter__previous\"\n              icon={faArrowLeft}\n            />\n          </button>\n          {searchTerm.length > 0 && (\n            <button // Clear Search Filter Text Button\n              className=\"EnumFacetFilter__resetSearch\"\n              onClick={() => {\n                setSearchText('')\n                textInput.current?.focus()\n              }}\n            >\n              <FontAwesomeIcon\n                className=\"EnumFacetFilter__reset\"\n                icon={'times'}\n              />\n            </button>\n          )}\n          <input // Search Filter Text\n            type=\"text\"\n            placeholder=\"Find values\"\n            value={searchTerm}\n            ref={textInput}\n            onChange={e => {\n              handleTextInputFilterEvent(e)\n            }}\n          />\n        </div>\n        {!showSearch && (\n          <div className=\"EnumFacetFilter__checkAll\">\n            <Checkbox\n              className=\"EnumFacetFilter__checkbox\"\n              onChange={() => {\n                onClear()\n              }}\n              key=\"select_all\"\n              checked={facetValues.filter(item => item.isSelected).length === 0}\n              label=\"All\"\n              id=\"select_all\"\n              isSelectAll={true}\n            ></Checkbox>\n            <button\n              className=\"EnumFacetFilter__searchbtn\"\n              onClick={() => {\n                setSearchText('')\n                setShowSearch(true)\n                textInput.current?.focus()\n              }}\n            >\n              <FontAwesomeIcon\n                className=\"EnumFacetFilter__searchicon\"\n                icon={'search'}\n              />\n            </button>\n          </div>\n        )}\n      </div>\n      <div>\n        {filteredSet.length > 0 &&\n          formatFacetValuesForDisplay(\n            filteredSet,\n            isShowAll || isDropdown,\n            visibleItemsCount,\n          ).map((facet, index: number) => {\n            const id = valueToId(facet.value)\n            return (\n              <div\n                className=\"EnumFacetFilter__checkboxContainer\"\n                key={`checkLabel${index}`}\n              >\n                <Checkbox\n                  className=\"EnumFacetFilter__checkbox\"\n                  onChange={(isChecked: boolean) => {\n                    selectedValuesMap[facet.value] = isChecked\n                    clearTimeout(timer)\n                    timer = setTimeout(() => {\n                      onChange(selectedValuesMap)\n                    }, selectionDelay)\n                  }}\n                  key={id + index}\n                  checked={facet.isSelected}\n                  label={valueToLabel(facet, userProfiles, entityHeaders)}\n                  id={id}\n                ></Checkbox>\n                {isDropdown && (\n                  <span className=\"EnumFacetFilter__count\">\n                    ({facet.count})\n                  </span>\n                )}\n                {!isDropdown && (\n                  <div className=\"EnumFacetFilter__count\">{facet.count}</div>\n                )}\n              </div>\n            )\n          })}\n        {!isDropdown && (\n          <>\n            {!isShowAll && filteredSet.length > visibleItemsCount && (\n              <button\n                className=\"EnumFacetFilter__showMoreFacetsBtn\"\n                onClick={() => setIsShowAll(true)}\n              >\n                <div className=\"EnumFacetFilter__checkboxContainer\">\n                  <div className=\"EnumFacetFilter__showMoreFacetsLabel\">\n                    Show more\n                  </div>\n                  <div className=\"EnumFacetFilter__howMoreFacetsCount\">\n                    {filteredSet.length}\n                  </div>\n                </div>\n              </button>\n            )}\n            {isShowAll && filteredSet.length > visibleItemsCount && (\n              <button\n                className=\"EnumFacetFilter__showMoreFacetsBtn\"\n                onClick={() => setIsShowAll(false)}\n              >\n                <div className=\"EnumFacetFilter__checkboxContainer\">\n                  <div className=\"EnumFacetFilter__showMoreFacetsLabel\">\n                    Show Less\n                  </div>\n                </div>\n              </button>\n            )}\n          </>\n        )}\n        {filteredSet.length <= 0 && (\n          <div className=\"EnumFacetFilter__noMatch\">No match found</div>\n        )}\n      </div>\n    </div>\n  )\n\n  // Any click event for the Dropdown will close the dropdown (assuming its open), so we have\n  // to handle the onToggle event and manually manage the dropdown open state. If metadata\n  // is defined the event occuring is inside the dropdown which we then want to keep open, otherwise\n  // we close it.\n  const onToggle = (_show: boolean, _event: any, metadata: any) => {\n    if (metadata.source) {\n      setIsShowDropdown(true)\n    } else {\n      setIsShowDropdown(false)\n    }\n  }\n\n  if (isDropdown) {\n    return (\n      <Dropdown\n        className=\"EnumFacetFilter\"\n        show={isShowDropdown}\n        onToggle={onToggle}\n      >\n        <ElementWithTooltip\n          idForToolTip=\"facetFilterTooltip\"\n          tooltipText=\"Filter by specific facet\"\n          key=\"facetFilterTooltip\"\n          darkTheme={true}\n          icon={\"filter\"}\n        />\n        <Dropdown.Menu>{content}</Dropdown.Menu>\n      </Dropdown>\n    )\n  } else {\n    return (\n      <>\n        <FacetFilterHeader\n          facetAliases={facetAliases}\n          isCollapsed={isCollapsed}\n          label={columnModel.name}\n          onClick={(isCollapsed: boolean) => setIsCollapsed(isCollapsed)}\n        />\n        <div\n          className=\"EnumFacetFilter\"\n          style={{ display: isCollapsed ? 'none' : 'block' }}\n        >\n          {content}\n        </div>\n      </>\n    )\n  }\n}\n","import React, { useState } from 'react'\nimport moment from 'moment'\n\ntype ControlType = 'number' | 'date'\n\nexport type RangeValues = {\n  min?: string\n  max?: string\n}\n\nexport type RangeProps = {\n  type: ControlType\n  initialValues?: RangeValues\n  className?: string\n  errorText?: string\n  onChange: Function\n}\n\nexport const Range: React.FunctionComponent<RangeProps> = (\n  props: RangeProps,\n) => {\n  const errorText = 'Min value should be less then max value'\n  const [error, setError] = useState(false)\n  const [values, setValues] = useState(() =>\n    props.type === 'number' && props.initialValues\n      ? props.initialValues\n      : (props.initialValues && {\n          min: moment(props.initialValues.min).format('YYYY-MM-DD'),\n          max: moment(props.initialValues.max).format('YYYY-MM-DD'),\n        }) || {\n          min: undefined,\n          max: undefined,\n        },\n  )\n\n  const className = props.className ? `range ${props.className}` : `range`\n\n  const isValid = (\n    { min, max }: RangeValues,\n\n    type: ControlType = 'number',\n  ) => {\n    if (\n      min === null ||\n      min === undefined ||\n      max === null ||\n      max === undefined\n    ) {\n      setError(false)\n      return true\n    }\n\n    if (type === 'number') {\n      if (Number(min) > Number(max)) {\n        setError(true)\n        return false\n      }\n    }\n    if (Date.parse(min) > Date.parse(max)) {\n      setError(true)\n      return false\n    }\n    setError(false)\n    return true\n  }\n\n  const handleAppyChanges = (\n    values: RangeValues,\n    callBackFn: Function,\n    type: ControlType = 'number',\n  ) => {\n    if (isValid(values, type)) {\n      callBackFn(values)\n    }\n  }\n\n  return (\n    <div className={className} style={{ display: 'flex', flexWrap: 'wrap' }}>\n      <div style={{ marginRight: '10px' }}>\n        <input\n          key=\"range_min\"\n          type={props.type}\n          value={values.min}\n          onChange={({ target }: React.ChangeEvent<HTMLInputElement>) =>\n            setValues({ min: target.value, max: values.max })\n          }\n        />\n        <div>to</div>\n        <input\n          key=\"range_max\"\n          type={props.type}\n          value={values.max}\n          onChange={({ target }: React.ChangeEvent<HTMLInputElement>) =>\n            setValues({ min: values.min, max: target.value })\n          }\n        />\n      </div>\n      <button\n        className=\"btn btn-link SRC-noPadding\"\n        onClick={() => handleAppyChanges(values, props.onChange, props.type)}\n      >\n        Apply\n      </button>\n      {error && (\n        <div className=\"SRC-danger-color\">{props.errorText || errorText}</div>\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\n\nimport { Slider, Rail, Handles, Tracks, Ticks } from 'react-compound-slider'\nimport {\n  SliderItem,\n  GetHandleProps,\n  GetTrackProps,\n} from 'react-compound-slider'\nimport { RangeValues } from './Range'\nimport { useState } from 'react'\n\n\n/**************** RANGE SLIDER SUBCOMPONENTS *********************/\n\n/***  handles ***/\n\ninterface IHandleProps {\n  domain: number[]\n  handle: SliderItem\n  getHandleProps: GetHandleProps\n}\n\nexport const Handle: React.FunctionComponent<IHandleProps> = ({\n  domain: [min, max],\n  handle: { id, value, percent },\n  getHandleProps,\n}) => (\n  <div\n    role=\"slider\"\n    className=\"RangeSlider__handle\"\n    aria-valuemin={min}\n    aria-valuemax={max}\n    aria-valuenow={value}\n    style={{\n      left: `${percent}%`,\n    }}\n    {...getHandleProps(id)}\n  />\n)\n\n\n/***   track  ***/\ninterface ITrackProps {\n  source: SliderItem\n  target: SliderItem\n  getTrackProps: GetTrackProps\n}\n\nexport const Track: React.FunctionComponent<ITrackProps> = ({\n  source,\n  target,\n  getTrackProps,\n}) => (\n  <div\n    className=\"RangeSlider__track\"\n    style={{\n      left: `${source.percent}%`,\n      width: `${target.percent - source.percent}%`,\n    }}\n    {...getTrackProps()}\n  />\n)\n\n/***   tick  ***/\ninterface ITickProps {\n  key: string\n  tick: SliderItem\n  count: number\n  mode?: 'SHOWALL' | 'SHOWNONE' | 'SHOWMINMAX'\n}\n\nexport const Tick: React.FunctionComponent<ITickProps> = ({\n  tick,\n  count,\n  mode = 'SHOWMINMAX',\n}) => (\n  <div>\n    <div\n      className=\"RangeSlider__tick\"\n      style={{\n        left: `${tick.percent}%`,\n      }}\n    />\n    <div\n      className=\"RangeSlider__tickInner\"\n      style={{\n        marginLeft: `${-(100 / count) / 2}%`,\n        width: `${100 / count}%`,\n        left: `${tick.percent}%`,\n      }}\n    >\n      {(mode === 'SHOWALL' ||\n        (mode === 'SHOWMINMAX' &&\n          (tick.percent == 0 || tick.percent == 100))) &&\n        tick.value}\n    </div>\n  </div>\n)\n\n\n/*************  RANGE SLIDER COMPONENT ****************/\n\n\nexport type RangeSliderProps = {\n  domain: string[]\n  initialValues: RangeValues\n  step: number\n  doUpdateOnApply?: boolean\n  maxTickCount?: number\n  onChange: Function\n}\n\nexport type RangeSliderState = {\n  values: readonly number[]\n}\n\nfunction getInitialValues(initialValues: RangeValues, domain: string[]) {\n  const result = [\n    initialValues.min ? Number(initialValues.min) : Number(domain[0]),\n    initialValues.max ? Number(initialValues.max) : Number(domain[1]),\n  ]\n  return result\n}\n\nexport const RangeSlider: React.FunctionComponent<RangeSliderProps> = ({doUpdateOnApply=true, ...props} ) => {\n  const stringArrToNumArr = (inputArr: string[]) =>\n    inputArr.map(value => Number(value))\n\n  const [values, setValues] = useState<number[]>(() =>\n    getInitialValues(props.initialValues, props.domain),\n  )\n\n  const numDomain = stringArrToNumArr(props.domain)\n\n  const handleSliderChange = (\n    values: readonly number[],\n    callbackFn?: Function,\n  ) => {\n    setValues([...values])\n    if (callbackFn) {\n      callbackFn({ min: values[0], max: values[1] })\n    }\n  }\n\n  let ticksCount = numDomain[1] - numDomain[0]\n  if (props.maxTickCount && ticksCount > props.maxTickCount) {\n    ticksCount = props.maxTickCount\n  }\n\n  return (\n    <div className=\"RangeSlider\">\n      <div className=\"RangeSlider__values\">{values[0]} - {values[1]}</div>\n      <div\n        className={`RangeSlider__wrapper${\n          doUpdateOnApply ? '--flex' : '--block'\n        }`}\n      >\n        <Slider\n          mode={1}\n          step={props.step}\n          domain={stringArrToNumArr(props.domain)}\n          className=\"RangeSlider__slider\"\n          onChange={(values: readonly number[]) =>\n            handleSliderChange(\n              values,\n              doUpdateOnApply ? undefined : props.onChange,\n            )\n          }\n          values={getInitialValues(props.initialValues, props.domain)}\n        >\n          <Rail>\n            {({ getRailProps }) => (\n              <div className=\"RangeSlider__rail\" {...getRailProps()} />\n            )}\n          </Rail>\n          <Handles>\n            {({ handles, getHandleProps }) => (\n              <div className=\"slider-handles\">\n                {handles.map(handle => (\n                  <Handle\n                    key={handle.id + handle.percent}\n                    handle={handle}\n                    domain={stringArrToNumArr(props.domain)}\n                    getHandleProps={getHandleProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Handles>\n          <Tracks left={true} right={true}>\n            {({ tracks, getTrackProps }) => (\n              <div>\n                {tracks.map(({ id, source, target }) => (\n                  <Track\n                    key={id}\n                    source={source}\n                    target={target}\n                    getTrackProps={getTrackProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Tracks>\n          <Ticks count={ticksCount}>\n            {({ ticks }) => (\n              <div>\n                {ticks.map(tick => (\n                  <Tick key={tick.id} tick={tick} count={ticks.length} />\n                ))}\n              </div>\n            )}\n          </Ticks>\n        </Slider>\n        {doUpdateOnApply && (\n          <button\n            className=\"RangeSlider__btnApply\"\n            onClick={() =>  props.onChange({ min: values[0], max: values[1] })}\n          >\n            Apply\n          </button>\n        )}\n      </div>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Range, RangeValues } from '../Range'\nimport { RangeSlider } from '../RangeSlider'\nimport { FacetColumnResultRange } from '../../../utils/synapseTypes/Table/FacetColumnResult'\nimport { ColumnModel } from '../../../utils/synapseTypes/Table/ColumnModel'\nimport { VALUE_NOT_SET } from '../../../utils/SynapseConstants'\nimport { FacetFilterHeader } from './FacetFilterHeader'\nimport { RadioGroup } from '../RadioGroup'\nimport { useState } from 'react'\n\nexport enum RadioValuesEnum {\n  NOT_SET = 'org.sagebionetworks.UNDEFINED_NULL_NOTSET',\n  RANGE = 'RANGE',\n  ANY = '',\n}\n\nexport type RangeFacetFilterProps = {\n  facetResult: FacetColumnResultRange\n  columnModel: ColumnModel\n  onChange: Function\n  facetAliases: {} | undefined\n}\n\nexport type RangeFacetFilterState = {\n  facetResult: FacetColumnResultRange\n  columnModel: ColumnModel\n}\n\nexport const RangeFacetFilter: React.FunctionComponent<RangeFacetFilterProps> = ({\n  facetResult,\n  columnModel,\n  onChange,\n  facetAliases,\n}: RangeFacetFilterProps) => {\n  const [isCollapsed, setIsCollapsed] = useState<boolean>(false)\n  const options = [\n    { label: 'Unannotated', value: RadioValuesEnum.NOT_SET },\n    { label: 'Any', value: RadioValuesEnum.ANY },\n    { label: 'Range', value: RadioValuesEnum.RANGE },\n  ]\n\n  let { columnMin, columnMax, selectedMin, selectedMax } = facetResult // the upper bound of the selected range\n\n  const hasAnyValue = !selectedMin && !selectedMax\n\n  selectedMin = selectedMin || columnMin\n  selectedMax = selectedMax || columnMax\n\n  const rangeType = columnModel.columnType === 'DOUBLE' ? 'number' : 'date'\n\n  const getRadioValue = (min: string, isAnyValue: boolean) => {\n    if (isAnyValue) {\n      return RadioValuesEnum.ANY\n    } else if (min === VALUE_NOT_SET) {\n      return RadioValuesEnum.NOT_SET\n    }\n    return RadioValuesEnum.RANGE\n  }\n\n  const handleRadioGroupChange = (\n    radioValue: RadioValuesEnum,\n    onChangeCallback: Function,\n  ) => {\n    setRadioValue(radioValue)\n\n    if (radioValue !== RadioValuesEnum.RANGE) {\n      onChangeCallback([radioValue, radioValue])\n    }\n  }\n\n  const [radioValue, setRadioValue] = useState(\n    getRadioValue(selectedMin, hasAnyValue),\n  )\n\n  const result = (\n    <div>\n      <FacetFilterHeader\n        isCollapsed={isCollapsed}\n        label={columnModel.name}\n        onClick={(isCollapsed: boolean) => setIsCollapsed(isCollapsed)}\n        facetAliases={facetAliases}\n      ></FacetFilterHeader>\n      <div style={{ display: isCollapsed ? 'none' : 'block' }}>\n        <RadioGroup\n          value={radioValue}\n          id=\"rangeSelector\"\n          options={options}\n          onChange={(radioValue: RadioValuesEnum) =>\n            handleRadioGroupChange(radioValue, onChange)\n          }\n        ></RadioGroup>\n        {radioValue === RadioValuesEnum.RANGE &&\n          (columnMin === columnMax ? (\n            <label>{columnMax}</label>\n          ) : (\n            <>\n              {columnModel.columnType === 'INTEGER' && (\n                <RangeSlider\n                  key=\"RangeSlider\"\n                  domain={[columnMin, columnMax]}\n                  initialValues={{ min: selectedMin, max: selectedMax }}\n                  step={1}\n                  doUpdateOnApply={true}\n                  onChange={(values: RangeValues) =>\n                    onChange([values.min, values.max])\n                  }\n                >\n                  ) >\n                </RangeSlider>\n              )}\n\n              {(columnModel.columnType === 'DATE' ||\n                columnModel.columnType === 'DOUBLE') && (\n                <Range\n                  key=\"Range\"\n                  initialValues={{\n                    min: selectedMin,\n                    max: selectedMax,\n                  }}\n                  type={rangeType}\n                  onChange={(values: RangeValues) =>\n                    onChange([values.min, values.max])\n                  }\n                ></Range>\n              )}\n            </>\n          ))}\n      </div>\n    </div>\n  )\n  return result\n}\n","import * as React from 'react'\n\nexport type RadioGroupProps = {\n  options: { label: string; value: string }[]\n  id: string\n  className?: string\n  value?: string\n  onChange: Function\n}\n\nexport const RadioGroup: React.FunctionComponent<RadioGroupProps> = (\n  props: RadioGroupProps,\n) => {\n\n  const className = props.className\n    ? `radiogroup ${props.className}`\n    : `radiogroup`\n\n  return (\n    <div className={className}>\n      {props.options.map(option => (\n        <div className=\"radio\" key={option.value}>\n          {props.value == option.value}\n          <label>\n            <span>\n              <input\n                type=\"radio\"\n                checked={props.value === option.value}\n                value={option.value}\n                onChange={({ target }: React.ChangeEvent<HTMLInputElement>) =>\n                  props.onChange(target.value, target.checked)\n                }\n              />\n              <span>{option.label}</span>\n            </span>\n          </label>\n        </div>\n      ))}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { RangeFacetFilter } from './RangeFacetFilter'\nimport { EnumFacetFilter } from './EnumFacetFilter'\n\nimport {\n  FacetColumnResultValues,\n  FacetColumnResult,\n  FacetColumnResultRange,\n} from '../../../utils/synapseTypes/Table/FacetColumnResult'\nimport {\n  FacetColumnValuesRequest,\n  FacetColumnRangeRequest,\n  FacetColumnRequest,\n} from '../../../utils/synapseTypes/Table/FacetColumnRequest'\nimport {\n  QueryBundleRequest,\n  QueryResultBundle,\n} from '../../../utils/synapseTypes'\n\nexport type QueryFilterProps = {\n  isLoading?: boolean\n  data?: QueryResultBundle\n  getLastQueryRequest?: Function\n  executeQueryRequest?: Function\n  token?: string\n  facetAliases?: {}\n}\n\nconst convertFacetToFacetColumnValuesRequest = (\n  facet: FacetColumnResultValues,\n): FacetColumnValuesRequest => ({\n  concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n  columnName: facet.columnName,\n  facetValues: facet.facetValues\n    .filter(facet => facet.isSelected === true)\n    .map(facet => facet.value),\n})\n\nconst convertFacetColumnRangeRequest = (\n  facet: FacetColumnResultRange,\n): FacetColumnRangeRequest => {\n  let result = {\n    concreteType:\n      'org.sagebionetworks.repo.model.table.FacetColumnRangeRequest',\n    columnName: facet.columnName, // The name of the faceted column\n  }\n\n  if (facet.columnMin) {\n    result = { ...result, ...{ min: facet.columnMin, max: facet.columnMax } }\n  }\n  return result\n}\n\nconst patchRequestFacets = (\n  changedFacet: FacetColumnRequest,\n  lastRequest?: QueryBundleRequest,\n): FacetColumnRequest[] => {\n  const selections = lastRequest?.query?.selectedFacets ?? []\n  const changedFacetIndex = selections.findIndex(\n    facet => facet.columnName === changedFacet.columnName,\n  )\n\n  const isEmptyValuesFacet =\n    changedFacet.concreteType ===\n      'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest' &&\n    (!changedFacet.facetValues || !changedFacet.facetValues.length)\n  if (changedFacetIndex > -1) {\n    if (isEmptyValuesFacet) {\n      selections.splice(changedFacetIndex, 1)\n    } else {\n      selections[changedFacetIndex] = changedFacet\n    }\n  } else {\n    selections.push(changedFacet)\n  }\n  return selections\n}\n\nexport function applyChangesToValuesColumn(\n  lastRequest: QueryBundleRequest | undefined,\n  facet: FacetColumnResultValues,\n  onChangeFn: Function,\n  facetName?: string,\n  checked: boolean = false,\n) {\n  if (facetName) {\n    facet.facetValues.forEach(facetValue => {\n      if (facetValue.value === facetName) {\n        facetValue.isSelected = checked\n      }\n    })\n  } else {\n    // else clear all\n    facet.facetValues.forEach(facet => {\n      facet.isSelected = false\n    })\n  }\n\n  const changedFacet = convertFacetToFacetColumnValuesRequest(facet)\n  const result = patchRequestFacets(changedFacet, lastRequest)\n  onChangeFn(result)\n}\n\n// This handles multiple checkbox selection with delay refresh\nexport const applyMultipleChangesToValuesColumn = (\n  lastRequest: QueryBundleRequest | undefined,\n  facet: FacetColumnResultValues,\n  onChangeFn: Function,\n  facetNameMap?: {},\n) => {\n  const facetNames = (facetNameMap && Object.keys(facetNameMap)) || []\n  if (facetNames.length) {\n    facet.facetValues.forEach(facetValue => {\n      if (facetNames.includes(facetValue.value)) {\n        facetValue.isSelected = facetNameMap\n          ? facetNameMap[facetValue.value]\n          : false\n      }\n    })\n  }\n  const changedFacet = convertFacetToFacetColumnValuesRequest(facet)\n  const result = patchRequestFacets(changedFacet, lastRequest)\n  onChangeFn(result)\n}\n\n//rangeChanges\nexport const applyChangesToRangeColumn = (\n  lastRequest: QueryBundleRequest | undefined,\n  facet: FacetColumnResultRange,\n  onChangeFn: Function,\n  values: string[],\n) => {\n  facet.columnMin = values[0]\n  facet.columnMax = values[1]\n  const changedFacet = convertFacetColumnRangeRequest(facet)\n  const result = patchRequestFacets(changedFacet, lastRequest)\n  onChangeFn(result)\n}\n\nexport const QueryFilter: React.FunctionComponent<QueryFilterProps> = ({\n  data,\n  isLoading = false,\n  getLastQueryRequest,\n  executeQueryRequest,\n  token,\n  facetAliases,\n}: QueryFilterProps): JSX.Element => {\n  if (!data) {\n    return <></>\n  }\n  const columnModels = data.columnModels\n  const facets = data.facets as FacetColumnResult[]\n  const lastRequest = getLastQueryRequest ? getLastQueryRequest() : undefined\n\n  const applyChanges = (facets: FacetColumnRequest[]) => {\n    const queryRequest: QueryBundleRequest = getLastQueryRequest!()\n    queryRequest.query.selectedFacets = facets\n    queryRequest.query.offset = 0\n    executeQueryRequest!(queryRequest)\n  }\n\n  return (\n    <div className=\"QueryFilter\">\n      {isLoading && <div>Loading...</div>}\n      {!isLoading &&\n        facets.map(facet => {\n          const columnModel = columnModels!.find(\n            model => model.name === facet.columnName,\n          )\n\n          return (\n            <div className=\"QueryFilter__facet\" key={facet.columnName}>\n              {facet.facetType === 'enumeration' && columnModel && (\n                <EnumFacetFilter\n                  containerAs=\"Collapsible\"\n                  facetValues={(facet as FacetColumnResultValues).facetValues}\n                  columnModel={columnModel!}\n                  token={token}\n                  facetAliases={facetAliases}\n                  onChange={(facetNamesMap: {}) =>\n                    applyMultipleChangesToValuesColumn(\n                      lastRequest,\n                      facet as FacetColumnResultValues,\n                      applyChanges,\n                      facetNamesMap,\n                    )\n                  }\n                  onClear={() =>\n                    applyChangesToValuesColumn(\n                      lastRequest,\n                      facet as FacetColumnResultValues,\n                      applyChanges,\n                    )\n                  }\n                ></EnumFacetFilter>\n              )}\n              {facet.facetType === 'range' && columnModel && (\n                <RangeFacetFilter\n                  facetResult={facet as FacetColumnResultRange}\n                  columnModel={columnModel}\n                  facetAliases={facetAliases}\n                  onChange={(values: string[]) =>\n                    applyChangesToRangeColumn(\n                      lastRequest,\n                      facet as FacetColumnResultRange,\n                      applyChanges,\n                      values,\n                    )\n                  }\n                ></RangeFacetFilter>\n              )}\n            </div>\n          )\n        })}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { BarLoader } from 'react-spinners'\n\nconst loadingScreen = (\n  <div className=\"bar-loader\">\n    <BarLoader color=\"#878787\" loading={true} height={5}/>\n  </div>\n)\n\nexport default loadingScreen\n","// ALINA WIP TODO:\n// - bar chart\n// - filter\n// - show 9 labels on expanded facet\nimport * as React from 'react'\nimport Plotly from 'plotly.js-basic-dist'\nimport * as PlotlyTyped from 'plotly.js'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SizeMe } from 'react-sizeme'\nimport { Dropdown } from 'react-bootstrap'\n\nimport { QueryWrapperChildProps } from '../../../containers/QueryWrapper'\nimport {\n  FacetColumnResultValues,\n  FacetColumnResultValueCount,\n  ColumnType,\n  QueryBundleRequest,\n} from '../../../utils/synapseTypes'\nimport getColorPallette from '../../../containers/ColorGradient'\n\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\nimport {\n  getStoredEntityHeaders,\n  getStoredUserProfiles,\n} from '../../../utils/functions/getDataFromFromStorage'\nimport { useEffect, useState } from 'react'\nimport { ElementWithTooltip } from '../../../containers/widgets/ElementWithTooltip'\nimport { EnumFacetFilter } from '../query-filter/EnumFacetFilter'\nimport {\n  applyMultipleChangesToValuesColumn,\n  applyChangesToValuesColumn,\n} from '../query-filter/QueryFilter'\nimport loadingScreen from '../../LoadingScreen'\n\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type FacetNavPanelOwnProps = {\n  applyChangesToGraphSlice: Function\n  applyChangesToFacetFilter: Function\n  index: number\n  facetToPlot: FacetColumnResultValues\n  onHide: Function\n  onExpand?: Function\n  onCollapse?: Function\n  lastQueryRequest: QueryBundleRequest | undefined\n}\n\nconst maxLabelLength: number = 19\nconst maxLegendLength: number = 30\n\ntype FacetNavPanelProps = FacetNavPanelOwnProps & QueryWrapperChildProps\n\nexport type PlotType = 'PIE' | 'BAR'\n\nconst layout: Partial<PlotlyTyped.Layout> = {\n  showlegend: false,\n  annotations: [],\n  margin: { l: 0, r: 0, b: 0, t: 0, pad: 0 },\n  yaxis: {\n    visible: false,\n    showgrid: false,\n  },\n  xaxis: {\n    visible: false,\n    showgrid: false,\n  },\n}\n\n// https://github.com/plotly/plotly.js/blob/fa51e33d3e1f8ca0c029b3029f3d006a5205c8f3/src/lib/index.js#L1173\nconst formatPercent = (ratio: number, n: number) => {\n  n = n || 0\n  let str =\n    (Math.round(100 * ratio * Math.pow(10, n)) * Math.pow(0.1, n)).toFixed(n) +\n    '%'\n  for (let i = 0; i < n; i++) {\n    if (str.indexOf('.') !== -1) {\n      str = str.replace('0%', '%')\n      str = str.replace('.%', '%')\n    }\n  }\n  return str\n}\n\nexport type GraphData = {\n  data: PlotlyTyped.Data[]\n  labels: FacetWithLabel[]\n  colors: string[]\n}\n\nexport function truncate(str: string | undefined, n: number) {\n  if (!str) {\n    return str\n  }\n  const trimmedStr: string = str.trim()\n  return trimmedStr.length > n ? trimmedStr.substr(0, n - 1) + '' : str\n}\n\nexport function extractPlotDataArray(\n  facetToPlot: FacetColumnResultValues,\n  columnType: ColumnType | undefined,\n  index: number,\n  plotType: PlotType,\n) {\n  const { colorPalette } = getColorPallette(\n    index,\n    facetToPlot.facetValues.length,\n  )\n\n  const getLabels = (\n    facetValues: FacetColumnResultValueCount[],\n    truncateFlag: boolean,\n    columnType?: ColumnType,\n  ) => {\n    return facetValues.map(facetValue => ({\n      label: getLabel(facetValue, truncateFlag, columnType),\n      count: facetValue.count,\n    }))\n  }\n\n  const getLabel = (\n    facetValue: FacetColumnResultValueCount,\n    truncateFlag: boolean,\n    columnType?: ColumnType,\n  ): string => {\n    if (facetValue.value === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET') {\n      return 'Unannotated'\n    }\n\n    if (columnType === 'ENTITYID') {\n      const lookup = getStoredEntityHeaders()\n      let value = lookup.find(item => item.id === facetValue.value)?.name\n      if (truncateFlag) {\n        value = truncate(value, maxLabelLength)\n      }\n      return value || facetValue.value\n    }\n\n    if (columnType === 'USERID') {\n      const lookup = getStoredUserProfiles()\n      let value = lookup.find(item => item.ownerId === facetValue.value)\n        ?.userName\n      if (truncateFlag) {\n        value = truncate(value, maxLabelLength)\n      }\n      return value || facetValue.value\n    }\n    const value = facetValue.value\n    return truncateFlag ? truncate(value, maxLabelLength)! : value\n  }\n\n  const labels = getLabels(facetToPlot.facetValues, false, columnType)\n  const text = getLabels(facetToPlot.facetValues, true, columnType).map(\n    el => el.label,\n  )\n\n  const singleChartData: PlotlyTyped.Data = {\n    values:\n      plotType === 'PIE'\n        ? facetToPlot.facetValues.map(facet => facet.count)\n        : undefined,\n    labels: labels.map(el => el.label),\n    text,\n    x:\n      plotType === 'BAR'\n        ? facetToPlot.facetValues.map(facet =>\n            getLabel(facet, false, columnType),\n          )\n        : undefined,\n    y:\n      plotType === 'BAR'\n        ? facetToPlot.facetValues.map(facet => facet.count)\n        : undefined,\n    // @ts-ignore\n    facetEnumerationValues: facetToPlot.facetValues.map(\n      facetValue => facetValue.value,\n    ),\n    name: facetToPlot.columnName,\n    hovertemplate:\n      plotType === 'PIE'\n        ? '<b>%{text}</b><br>%{value} (%{percent})<br><extra></extra>'\n        : '<b>%{text}: </b><br>%{value} <br><extra></extra>',\n    textinfo: 'none',\n    type: plotType === 'PIE' ? 'pie' : 'bar',\n    marker: {\n      colors: plotType === 'PIE' ? colorPalette : undefined,\n      color: plotType === 'BAR' ? colorPalette : undefined,\n      line: {\n        width: facetToPlot.facetValues.map(facetValue =>\n          facetValue.isSelected ? 1 : 0,\n        ),\n      },\n    },\n    pull:\n      plotType === 'PIE'\n        ? facetToPlot.facetValues.map(facetValue =>\n            facetValue.isSelected ? 0.04 : 0,\n          )\n        : undefined,\n  }\n\n  const result = {\n    data: [singleChartData],\n    labels,\n    colors:\n      plotType === 'PIE'\n        ? (singleChartData.marker?.colors as string[])\n        : (singleChartData.marker?.color as string[]),\n  }\n  return result\n}\n\nconst applyFacetFilter = (\n  event: PlotlyTyped.PlotMouseEvent,\n  allFacetValues: FacetColumnResultValues,\n  callbackApplyFn: Function,\n) => {\n  if (event.points && event.points[0]) {\n    const plotPointData: any = event.points[0]\n    const facetValueClickedValue =\n      plotPointData.data.facetEnumerationValues[plotPointData.pointNumber]\n    const facetValueClicked = allFacetValues.facetValues.find(\n      facet => facet.value === facetValueClickedValue,\n    )\n    callbackApplyFn(\n      allFacetValues,\n      facetValueClicked,\n      !facetValueClicked!.isSelected,\n    )\n  }\n}\n\nexport function getPlotStyle (\n  parentWidth: number | null,\n  plotType: PlotType,\n  maxHeight: number,\n): { width: string; height: string } {\n  const quotient = plotType === 'BAR' ? 0.8 : 0.6\n  const width = parentWidth ? parentWidth * quotient : 200\n  let height = plotType === 'PIE' ? width : width / 3\n  // max height of .FacetNav row col* is 200px, so the effective plot height max is around 150 unless it's expanded\n  if (height > maxHeight) {\n    height = maxHeight\n  }\n\n  return {\n    width: `${width}px`,\n    height: `${height}px`,\n  }\n}\n\nexport type FacetWithLabel = {\n  label: string\n  count: number\n}\n\nexport function renderLegend (\n  labels: FacetWithLabel[] | undefined,\n  colors: string[] = [],\n  isExpanded: boolean,\n): JSX.Element {\n  if (!labels) {\n    return <></>\n  }\n  const numLegendItems = isExpanded\n    ? Math.min(labels.length, 9)\n    : Math.min(labels.length, 3)\n  if (numLegendItems === 0) {\n    return <></>\n  }\n  const totalCount = labels.reduce(\n    (curValue, curFacet) => curValue + curFacet.count,\n    0,\n  )\n  return (\n    <div\n      className={`FacetNavPanel__body__legend${isExpanded ? '--expanded' : ''}`}\n    >\n      {labels.slice(0, numLegendItems).map((facetValue, index) => {\n        const percent = formatPercent(facetValue.count / totalCount, 1)\n        const label = `(${percent}) ${facetValue.label}`\n        const labelDisplay = truncate(label, maxLegendLength)\n        return (\n          <ElementWithTooltip\n            idForToolTip={facetValue.label}\n            tooltipText={facetValue.label}\n            key={facetValue.label}\n          >\n            <div\n              className=\"FacetNavPanel__body__legend__row\"\n              key={`legendLabel_${index}`}\n              style={{ cursor: 'default' }}\n            >\n              <div style={{ backgroundColor: colors[index] }}></div>\n              <label>{labelDisplay}</label>\n            </div>\n          </ElementWithTooltip>\n        )\n      })}\n    </div>\n  )\n}\n\nconst getClassNameForPlotDiv = (isExpanded: boolean, plotType: PlotType) => {\n  if (!isExpanded) {\n    return 'FacetNavPanel__body__plot'\n  }\n  return `FacetNavPanel__body__plot--expanded${\n    plotType === 'BAR' ? 'Bar' : 'Pie'\n  }`\n}\n\nconst FacetNavPanel: React.FunctionComponent<FacetNavPanelProps> = ({\n  onHide,\n  onExpand,\n  onCollapse,\n  applyChangesToFacetFilter,\n  applyChangesToGraphSlice,\n  isLoadingNewData,\n  index,\n  facetToPlot,\n  data,\n  isLoading,\n  facetAliases,\n  token,\n  lastQueryRequest,\n}: FacetNavPanelProps): JSX.Element => {\n  const [plotData, setPlotData] = useState<GraphData>()\n  const [isExpanded, setIsExpanded] = useState(false)\n  const [plotType, setPlotType] = useState<PlotType>('PIE')\n\n  const getColumnType = (): ColumnType | undefined =>\n    data?.columnModels?.find(\n      columnModel => columnModel.name === facetToPlot.columnName,\n    )?.columnType as ColumnType\n\n  useEffect(() => {\n    if (!facetToPlot) {\n      return\n    } else {\n      const plotData = extractPlotDataArray(\n        facetToPlot,\n        getColumnType(),\n        index,\n        'PIE',\n      )\n      setPlotData(plotData)\n    }\n  }, [facetToPlot, data, index])\n\n  useEffect(() => {\n    setIsExpanded(onCollapse !== undefined)\n  }, [onCollapse])\n\n  const changePlotType = (plotType: PlotType) => {\n    if (plotType === 'BAR') {\n      setPlotData(\n        extractPlotDataArray(facetToPlot, getColumnType(), index, 'BAR'),\n      )\n    } else {\n      setPlotData(\n        extractPlotDataArray(facetToPlot, getColumnType(), index, 'PIE'),\n      )\n    }\n    setPlotType(plotType)\n  }\n\n  /* rendering functions */\n  const renderChartSelectionToggle = (): JSX.Element => (\n    <Dropdown>\n      <ElementWithTooltip\n        idForToolTip=\"toggleChart\"\n        tooltipText=\"Toggle chart type\"\n        key=\"toggleChart\"\n        className=\"SRC-primary-color\"\n        darkTheme={true}\n        icon={\"chart\"}\n      />\n      <Dropdown.Menu className=\"chart-tools\">\n        <Dropdown.Item as=\"button\" onClick={() => changePlotType('BAR')}>\n          Bar Chart\n        </Dropdown.Item>\n        <Dropdown.Item as=\"button\" onClick={() => changePlotType('PIE')}>\n          Pie Chart\n        </Dropdown.Item>\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n\n  if (isLoadingNewData || !facetToPlot) {\n    return (\n      <div className=\"SRC-loadingContainer SRC-centerContentColumn\">\n        {loadingScreen}\n      </div>\n    )\n  } else {\n    return (\n      <div className={`FacetNavPanel${isExpanded ? '--expanded' : ''}`}>\n        <div className=\"FacetNavPanel__title\">\n          <span className=\"FacetNavPanel__title__name\">\n            {unCamelCase(facetToPlot.columnName, facetAliases)}\n          </span>\n          {isLoading && (\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          )}\n          <div className=\"FacetNavPanel__title__tools\">\n            {isExpanded && renderChartSelectionToggle()}\n            <EnumFacetFilter\n              facetValues={facetToPlot.facetValues}\n              columnModel={\n                data?.columnModels!.find(\n                  el => el.name === facetToPlot.columnName,\n                )!\n              }\n              token={token}\n              facetAliases={facetAliases}\n              onChange={(facetNamesMap: {}) => {\n                applyMultipleChangesToValuesColumn(\n                  lastQueryRequest,\n                  facetToPlot,\n                  applyChangesToFacetFilter,\n                  facetNamesMap,\n                )\n              }}\n              onClear={() => {\n                applyChangesToValuesColumn(\n                  lastQueryRequest,\n                  facetToPlot,\n                  applyChangesToFacetFilter,\n                )\n              }}\n              containerAs=\"Dropdown\"\n            />\n            {!isExpanded && (\n              <ElementWithTooltip\n                idForToolTip=\"expandGraph\"\n                tooltipText=\"Expand to large graph\"\n                key=\"expandGraph\"\n                callbackFn={() => onExpand!(index)}\n                className=\"SRC-primary-color\"\n                darkTheme={true}\n                icon={\"expand\"}\n              />\n            )}\n            {isExpanded && (\n              <ElementWithTooltip\n                idForToolTip=\"collapseGraph\"\n                tooltipText=\"Collapse to small graph\"\n                key=\"collapseGraph\"\n                callbackFn={() => onCollapse!(index)}\n                className=\"SRC-primary-color\"\n                darkTheme={true}\n                icon={\"collapse\"}\n              />\n            )}\n            <ElementWithTooltip\n              idForToolTip=\"hideGraph\"\n              tooltipText=\"Hide graph under Show More\"\n              key=\"hideGraph\"\n              callbackFn={() => onHide(index)}\n              className=\"SRC-primary-color\"\n              darkTheme={true}\n              icon={\"close\"}\n            />\n          </div>\n        </div>\n\n        <div className={`FacetNavPanel__body${isExpanded ? '--expanded' : ''}`}>\n          <SizeMe monitorHeight>\n            {({ size }) => (\n              <div className={getClassNameForPlotDiv(isExpanded, plotType)}>\n                <Plot\n                  key={`${facetToPlot.columnName}-${size.width}`}\n                  layout={layout}\n                  data={plotData?.data ?? []}\n                  style={getPlotStyle(\n                    size.width,\n                    plotType,\n                    isExpanded ? 300 : 150,\n                  )}\n                  config={{ displayModeBar: false }}\n                  onClick={evt =>\n                    applyFacetFilter(evt, facetToPlot, applyChangesToGraphSlice)\n                  }\n                ></Plot>\n              </div>\n            )}\n          </SizeMe>\n          {renderLegend(plotData?.labels, plotData?.colors, isExpanded)}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default FacetNavPanel\n","import * as React from 'react'\nimport FacetNavPanel from './FacetNavPanel'\nimport { QueryWrapperChildProps } from '../../QueryWrapper'\nimport {\n  FacetColumnResultValues,\n  FacetColumnRequest,\n  FacetColumnResult,\n  QueryResultBundle,\n  FacetColumnResultValueCount,\n} from '../../../utils/synapseTypes'\nimport { useState, useEffect } from 'react'\nimport TotalQueryResults from '../../../containers/TotalQueryResults'\nimport { applyChangesToValuesColumn } from '../query-filter/QueryFilter'\n\nexport type FacetNavOwnProps = {\n  facetsToPlot?: string[]\n  showNotch?: boolean\n}\n\ntype UiFacetState = {\n  name: string\n  isHidden: boolean\n  isExpanded: boolean\n  index?: number\n}\n\nconst DEFAULT_VISIBLE_FACETS = 3\n\n/*\nTODO: This component has a few bugs when its props are updated with new data, this should be handled\nat some point. As of the moment the portal doesn't have a case when the props will update,\nit will always mount this component.\n*/\nexport type FacetNavProps = FacetNavOwnProps & QueryWrapperChildProps\n\ntype ShowMoreState = 'MORE' | 'LESS' | 'NONE'\n\nexport function getFacets (\n  data: QueryResultBundle | undefined,\n  facetsToPlot?: string[],\n): FacetColumnResult[] {\n  const result =\n    data?.facets?.filter(\n      item =>\n        item.facetType === 'enumeration' &&\n        (!facetsToPlot?.length || facetsToPlot.indexOf(item.columnName) > -1),\n    ) ?? []\n  return result\n}\n\nconst FacetNav: React.FunctionComponent<FacetNavProps> = ({\n  data,\n  getLastQueryRequest,\n  isLoadingNewData,\n  isLoading,\n  executeQueryRequest,\n  token,\n  asyncJobStatus,\n  topLevelControlsState,\n  facetsToPlot,\n  getInitQueryRequest,\n  updateParentState,\n  facetAliases,\n  showNotch = false,\n  error,\n}: FacetNavProps): JSX.Element => {\n  const [facetUiStateArray, setFacetUiStateArray] = useState<UiFacetState[]>([])\n  const [isFirstTime, setIsFirstTime] = useState(true)\n  const { showFacetVisualization } = topLevelControlsState!\n\n  const lastQueryRequest = getLastQueryRequest?.()\n\n  useEffect(() => {\n    const result = getFacets(data, facetsToPlot)\n    if (result.length === 0) {\n      return\n    }\n    if (isFirstTime) {\n      setFacetUiStateArray(\n        result.map((item, index) => ({\n          name: item.columnName,\n          isHidden: index >= DEFAULT_VISIBLE_FACETS,\n          isExpanded: false,\n        })),\n      )\n      setIsFirstTime(false)\n    }\n  }, [data, isFirstTime])\n\n  // when 'show more/less' is clicked\n  const onShowMoreClick = (shouldShowMore: boolean) => {\n    setFacetUiStateArray(facetUiStateArray => {\n      return facetUiStateArray.map((item, index) => {\n        if (shouldShowMore) {\n          // show everything\n          return { ...item, isHidden: false }\n        }\n        // otherwise hide everything except the first three items\n        return { ...item, isHidden: index >= DEFAULT_VISIBLE_FACETS }\n      })\n    })\n  }\n\n  // what needs to happen after the filters are adjusted from the plot\n  const applyChangesFromQueryFilter = (facets: FacetColumnRequest[]) => {\n    lastQueryRequest!.query.selectedFacets = facets\n    lastQueryRequest!.query.offset = 0\n    executeQueryRequest!(lastQueryRequest!)\n  }\n\n  // don't show expanded or hidden facets\n  const isFacetHiddenInGrid = (columnName: string) => {\n    const itemHidden = facetUiStateArray.find(\n      item =>\n        item.name === columnName &&\n        (item.isHidden === true || item.isExpanded === true),\n    )\n    const result = itemHidden !== undefined\n    return result\n  }\n\n  const getShowMoreState = (): ShowMoreState => {\n    if (facetUiStateArray.length <= DEFAULT_VISIBLE_FACETS) {\n      return 'NONE'\n    }\n    if (\n      // if at least one item is hidden\n      facetUiStateArray.find(item => item.isHidden === true)\n    ) {\n      return 'MORE'\n    }\n    return 'LESS'\n  }\n\n  // hides expanded facet under 'show more'\n  const hideExpandedFacet = (facet: FacetColumnResult) => {\n    setFacetUiStateArray(facetUiStateArray =>\n      facetUiStateArray.map(item =>\n        item.name === facet.columnName\n          ? { ...item, isExpanded: false, isHidden: true }\n          : item,\n      ),\n    )\n  }\n\n  //expands to collapses a facet\n  const toggleExpandFacet = (facet: FacetColumnResult, doExpand: boolean) => {\n    setUiPropertyForFacet(facet.columnName, 'isExpanded', doExpand)\n  }\n\n  // hides facet graph\n  const hideFacetInGrid = (columnName: string) => {\n    setUiPropertyForFacet(columnName, 'isHidden', true)\n  }\n\n  const setUiPropertyForFacet = (\n    columnName: string,\n    propName: 'isHidden' | 'isExpanded',\n    value: boolean,\n  ) => {\n    setFacetUiStateArray(facetUiStateArray =>\n      facetUiStateArray.map(item =>\n        item.name === columnName ? { ...item, [propName]: value } : item,\n      ),\n    )\n  }\n\n  const hasSelectedFacets =\n    lastQueryRequest?.query.selectedFacets !== undefined &&\n    lastQueryRequest.query.selectedFacets.length > 0\n\n  const expandedFacets = getFacets(data, facetsToPlot).filter(el => {\n    return facetUiStateArray.find(uiState => {\n      return uiState.name === el.columnName\n    })?.isExpanded\n  })\n  const restOfFacets = getFacets(data, facetsToPlot).filter(el => {\n    return !facetUiStateArray.find(uiState => uiState.name === el.columnName)\n      ?.isExpanded\n  })\n\n  const colorTracker = getFacets(data, facetsToPlot).map((el, index) => {\n    return {\n      columnName: el.columnName,\n      colorIndex: index,\n    }\n  })\n  const showMoreState = getShowMoreState()\n\n  if (error) {\n    return <></>\n  } else if (isLoadingNewData) {\n    return (\n      <div className=\"SRC-loadingContainer SRC-centerContentColumn\">\n        {asyncJobStatus?.progressMessage && (\n          <div> <span className=\"spinner\" /> {asyncJobStatus.progressMessage} </div>\n        )}\n      </div>\n    )\n  } else {\n    return (\n      <>\n        <div className={`FacetNav ${showFacetVisualization ? '' : 'hidden'}`}>\n          <div className=\"FacetNav__expanded\">\n            {expandedFacets.map((facet, index) => (\n              <div key={facet.columnName}>\n                <FacetNavPanel\n                  data={data}\n                  index={\n                    colorTracker.find(el => el.columnName === facet.columnName)\n                      ?.colorIndex!\n                  }\n                  onHide={() => hideExpandedFacet(facet)}\n                  onCollapse={() => toggleExpandFacet(facet, false)}\n                  facetToPlot={facet as FacetColumnResultValues}\n                  applyChangesToFacetFilter={applyChangesFromQueryFilter}\n                  applyChangesToGraphSlice={(\n                    facet: FacetColumnResultValues,\n                    value: FacetColumnResultValueCount | undefined,\n                    isSelected: boolean,\n                  ) =>\n                    applyChangesToValuesColumn(\n                      lastQueryRequest,\n                      facet,\n                      applyChangesFromQueryFilter,\n                      value?.value,\n                      isSelected,\n                    )\n                  }\n                  facetAliases={facetAliases}\n                  lastQueryRequest={lastQueryRequest}\n                ></FacetNavPanel>\n              </div>\n            ))}\n          </div>\n          <div className=\"FacetNav__row clearfix\">\n            {restOfFacets.map((facet, index) => (\n              <div\n                className=\"col-sm-12 col-md-4\"\n                style={{\n                  display: isFacetHiddenInGrid(facet.columnName)\n                    ? 'none'\n                    : 'block',\n                }}\n                key={facet.columnName}\n              >\n                <FacetNavPanel\n                  isLoading={isLoading}\n                  index={\n                    colorTracker.find(el => el.columnName === facet.columnName)\n                      ?.colorIndex!\n                  }\n                  data={data}\n                  onHide={() => hideFacetInGrid(facet.columnName)}\n                  onExpand={() => toggleExpandFacet(facet, true)}\n                  facetToPlot={facet as FacetColumnResultValues}\n                  lastQueryRequest={lastQueryRequest}\n                  /*\n                    TODO: Simplify the nested functions below, all the logic should be contained\n                    in the EnumFacetFilter component.\n                  */\n                  applyChangesToFacetFilter={applyChangesFromQueryFilter}\n                  applyChangesToGraphSlice={(\n                    facet: FacetColumnResultValues,\n                    value: FacetColumnResultValueCount | undefined,\n                    isSelected: boolean,\n                  ) =>\n                    applyChangesToValuesColumn(\n                      lastQueryRequest,\n                      facet,\n                      applyChangesFromQueryFilter,\n                      value?.value,\n                      isSelected,\n                    )\n                  }\n                  facetAliases={facetAliases}\n                ></FacetNavPanel>\n              </div>\n            ))}\n          </div>\n          <div className=\"FacetNav__showMoreContainer\">\n            {showMoreState !== 'NONE' && (\n              <button\n                className=\"btn btn-default FacetNav__showMore\"\n                onClick={() => onShowMoreClick(showMoreState === 'MORE')}\n              >\n                {showMoreState === 'LESS'\n                  ? 'Hide Optional Graphs'\n                  : 'Show All Graphs'}\n              </button>\n            )}\n          </div>\n        </div>\n        <TotalQueryResults\n          isLoading={isLoading!}\n          executeQueryRequest={executeQueryRequest!}\n          lastQueryRequest={getLastQueryRequest?.()!}\n          getInitQueryRequest={getInitQueryRequest}\n          token={token}\n          unitDescription={hasSelectedFacets ? 'results via:' : 'results'}\n          frontText={'Showing'}\n          showNotch={showNotch}\n        />\n      </>\n    )\n  }\n}\n\nexport default FacetNav\n","const sufixes: string[] = [\n  'Bytes',\n  'KB',\n  'MB',\n  'GB',\n  'TB',\n  'PB',\n  'EB',\n  'ZB',\n  'YB',\n]\n\nexport function calculateFriendlyFileSize(bytes: number) {\n  if (!bytes) {\n    return ''\n  }\n  // https://stackoverflow.com/questions/10420352/converting-file-size-in-bytes-to-human-readable-string\n  const i = Math.floor(Math.log(bytes) / Math.log(1024))\n  // tslint:disable-next-line\n  return (\n    (!bytes && '0 Bytes') ||\n    (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sufixes[i]\n  )\n}\n","import * as React from 'react'\nimport { DATASET } from '../../utils/SynapseConstants'\nimport { calculateFriendlyFileSize } from '../../utils/functions/calculateFriendlyFileSize'\nimport * as Utils from './utils'\nimport { renderValueOrMultiValue } from '../GenericCard'\nimport { SelectColumn, ColumnModel } from '../../utils/synapseTypes'\n\ntype DatasetProps = {\n  data?: any\n  schema?: any\n  secondaryLabelLimit?: number\n  selectColumns?: SelectColumn[]\n  columnModels?: ColumnModel[]\n}\n\nclass Dataset extends React.Component<DatasetProps, {}> {\n  constructor(props: DatasetProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n\n  public handleLinkClick = (link: string) => (\n    event: React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    event.preventDefault()\n    window.open(`https://www.synapse.org/#!Synapse:${link}`, '_blank')\n  }\n\n  public render() {\n    const { data, schema, selectColumns, columnModels } = this.props\n    const datasetName = data[schema.datasetName]\n    const summary = data[schema.summary]\n    const tumorType = renderValueOrMultiValue({\n      columnName: 'tumorType',\n      value: data[schema.tumorType],\n      selectColumns,\n      columnModels,\n    }).str\n    const diseaseFocus = renderValueOrMultiValue({\n      columnName: 'diseaseFocus',\n      value: data[schema.diseaseFocus],\n      selectColumns,\n      columnModels,\n    }).str\n    const id = data[schema.id]\n    const fundingAgency = data[schema.fundingAgency]\n    const fileCount = data[schema.fileCount]\n    const fileSize = calculateFriendlyFileSize(data[schema.fileSize])\n    const values = [\n      [\n        'FUNDER',\n        renderValueOrMultiValue({\n          columnName: 'fundingAgency',\n          value: fundingAgency,\n          selectColumns,\n          columnModels,\n        }).str,\n      ],\n      ['SIZE', fileSize],\n      ['FILES', fileCount],\n    ]\n    return (\n      <div className=\"SRC-portalCard SRC-typeDataset  \">\n        <div className=\"SRC-cardThumbnail\">\n          <Utils.Icon type={DATASET} />\n          <div>{fileSize}</div>\n        </div>\n        <div className=\"SRC-cardContent SRC-dataset\">\n          <div className=\"SRC-type\">Dataset </div>\n          <div>\n            <h3>\n              <a\n                target=\"_self\"\n                href={`https://www.synapse.org/#!Synapse:${id}`}\n              >\n                {datasetName}\n              </a>\n            </h3>\n          </div>\n          <div className=\"SRC-description-dataset\">\n            <p className=\"SRC-description-text\">{summary}</p>\n            <div className=\"SRC-cardAction\">\n              <button\n                className=\"SRC-datasetButton\"\n                onClick={this.handleLinkClick(id)}\n                type=\"button\"\n              >\n                Download Dataset\n              </button>\n            </div>\n          </div>\n          <div className=\"SRC-cardAnnotations\">\n            <Utils.ChipContainer chips={[tumorType, diseaseFocus]} />\n          </div>\n        </div>\n        <Utils.CardFooter\n          isHeader={false}\n          secondaryLabelLimit={this.props.secondaryLabelLimit}\n          values={values}\n        />\n      </div>\n    )\n  }\n}\nexport default Dataset\n","import * as React from 'react'\n\ntype FunderProps = {\n  data?: any\n  schema?: any\n}\n\nexport default class Funder extends React.Component<FunderProps, {}> {\n  constructor(props: FunderProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n  public handleLinkClick = (link: string) => (\n    event: React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    event.preventDefault()\n    window.open(link, '_blank')\n  }\n  public render() {\n    const { data, schema } = this.props\n    const organizationName = data[schema.organizationName]\n    const organizationPath = data[schema.organizationPath]\n    const summary = data[schema.summary]\n    const website = data[schema.website]\n    const logoHref: string = data[schema.logo]\n    // remove leading http(s):// and trailing /\n    let websiteDisplayName = website.replace('https://', '')\n    websiteDisplayName = websiteDisplayName.replace('http://', '')\n    if (websiteDisplayName.charAt(websiteDisplayName.length - 1) === '/') {\n      websiteDisplayName = websiteDisplayName.substring(\n        0,\n        websiteDisplayName.length - 1,\n      )\n    }\n    const isOnOrgPath = window.location.hash.substring(1) === organizationPath\n    const style: any = {}\n    let showOrgLink\n    if (!isOnOrgPath) {\n      showOrgLink = (\n        <div className=\"SRC-marginAuto SRC-cardAction\">\n          <a href={organizationPath}>View Funded Research</a>\n        </div>\n      )\n    } else {\n      style.paddingBottom = '42px'\n    }\n    return (\n      <div className=\"SRC-portalCard SRC-typeFunder \" style={style}>\n        <div className=\"SRC-cardContent\">\n          <div className=\"SRC-type\">Organization</div>\n          {logoHref && (\n            <div className=\"SRC-cardThumbnail\">\n              <img alt=\"funder logo\" className=\"SRC-logo\" src={logoHref} />\n            </div>\n          )}\n          <div>\n            <h3>\n              {isOnOrgPath && organizationName}\n              {!isOnOrgPath && (\n                <a href={organizationPath}>{organizationName}</a>\n              )}\n            </h3>\n          </div>\n          <div className=\"SRC-website\">\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href={website}>\n              {websiteDisplayName}\n            </a>\n          </div>\n          <div className=\"SRC-description\">{summary}</div>\n        </div>\n        {showOrgLink}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { getUserProfileWithProfilePicAttached } from '../utils/functions/getUserData'\nimport { UserProfileList } from '../utils/SynapseClient'\nimport { MEDIUM_USER_CARD } from '../utils/SynapseConstants'\nimport { QueryResultBundle, UserProfile } from '../utils/synapseTypes/'\nimport UserCard, { UserCardSize } from './UserCard'\nimport { without } from 'lodash-es'\n\nexport type UserCardListProps = {\n  list: string[]\n  size?: UserCardSize\n  // Data should not be needed, however, it gives the option to fill in a user profile with other column\n  // fields. This is required specifically by AMP-AD Explore/People page\n  data?: QueryResultBundle\n}\n\ntype MapOwnerIdToUserProfile = {\n  [index: number]: UserProfile\n}\nexport type UserCardListState = {\n  userProfileMap: MapOwnerIdToUserProfile\n}\nexport default class UserCardList extends React.Component<\n  UserCardListProps,\n  UserCardListState\n> {\n  constructor(props: UserCardListProps) {\n    super(props)\n    this.state = {\n      userProfileMap: {},\n    }\n    this.update = this.update.bind(this)\n  }\n\n  componentDidMount() {\n    const { list } = this.props\n    this.update(list)\n  }\n\n  componentDidUpdate(prevProps: UserCardListProps) {\n    const priorListOfIds = prevProps.list\n    const newValues = without(\n      this.props.list.filter(el => el),\n      ...priorListOfIds,\n    )\n    // check that the props have changed by seeing that at least one element is different\n    if (newValues.length > 0) {\n      this.update(newValues)\n    }\n  }\n\n  update(list: string[]) {\n    getUserProfileWithProfilePicAttached(list.filter(el => el))\n      .then((data: UserProfileList) => {\n        const newEntries = {}\n        data.list.forEach(el => {\n          const { ownerId } = el\n          newEntries[ownerId] = el\n        })\n        this.setState({\n          userProfileMap: { ...this.state.userProfileMap, ...newEntries },\n        })\n      })\n      .catch((err: string) => {\n        console.log('Error on batch call =', err)\n      })\n  }\n\n  /**\n   * Given data this will find rows where there is no userId columnType and create faux user profiles\n   * using firstName, lastName, and instituion (company in UserProfile object).\n   * @param {QueryResultBundle} data\n   * @returns list of UserProfiles with firstName, lastName, company, userName (first letter of firstName) filled out.\n   * @memberof UserCardList\n   */\n  manuallyExtractData(data: QueryResultBundle) {\n    const firstNameIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.name === 'firstName',\n    )\n    const lastNameIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.name === 'lastName',\n    )\n    const institutionIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.name === 'institution',\n    )\n    const ownerId = data.queryResult.queryResults.headers.findIndex(\n      el => el.columnType === 'USERID',\n    )\n    const nullOwnerIdsRows = data.queryResult.queryResults.rows.filter(\n      el => !el.values[ownerId],\n    )\n    return nullOwnerIdsRows.map<UserProfile>(el => {\n      const values = el.values\n      return {\n        firstName: values[firstNameIndex],\n        lastName: values[lastNameIndex],\n        company: values[institutionIndex],\n        ownerId: '',\n        userName: values[firstNameIndex][0],\n      }\n    })\n  }\n\n  render() {\n    const { size = MEDIUM_USER_CARD, data, list } = this.props\n    const { userProfileMap = {} } = this.state\n    const fauxUserProfilesList = data && this.manuallyExtractData(data)\n    let fauxUserProfileIndex = 0\n    return (\n      <div className=\"SRC-card-grid-row SRC-adjust-for-bootstrap-margin\">\n        {// we loop through the list from the props because thats the 'active set of data' whereas the data stored in state could be stale\n        list.map(ownerId => {\n          const userProfile = userProfileMap[ownerId]\n          if (userProfile) {\n            return (\n              <div\n                key={JSON.stringify(userProfile)}\n                className=\"SRC-grid-item SRC-narrow-grid-item\"\n              >\n                <UserCard\n                  size={size}\n                  preSignedURL={userProfile.clientPreSignedURL}\n                  userProfile={userProfile}\n                />\n              </div>\n            )\n          }\n          const fauxUserProfile =\n            fauxUserProfilesList && fauxUserProfilesList[fauxUserProfileIndex]\n          if (!fauxUserProfile) {\n            // This could happen in one of two cases:\n            // - The props just updated with a new userlist where the data is being gathered for this particular user\n            //   OR there is no mapping for this user\n            return false\n          }\n          fauxUserProfileIndex += 1\n          return (\n            <div\n              key={JSON.stringify(fauxUserProfile)}\n              className=\"SRC-grid-item SRC-narrow-grid-item\"\n            >\n              <UserCard\n                disableLink={true}\n                hideEmail={true}\n                size={size}\n                userProfile={fauxUserProfile}\n              />\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport {\n  DATASET,\n  FUNDER,\n  GENERIC_CARD,\n  MEDIUM_USER_CARD,\n} from '../utils/SynapseConstants'\nimport {\n  QueryBundleRequest,\n  QueryResultBundle,\n  EntityHeader,\n} from '../utils/synapseTypes/'\nimport { CardConfiguration } from './CardContainerLogic'\nimport GenericCard from './GenericCard'\nimport { Dataset, Funder } from './row_renderers'\nimport TotalQueryResults from './TotalQueryResults'\nimport UserCardList from './UserCardList'\nimport useGetInfoFromIds from '../utils/hooks/useGetInfoFromIds'\nimport loadingScreen from './LoadingScreen'\n\nconst PAGE_SIZE: number = 25\n\nexport type CardContainerProps = {\n  data?: QueryResultBundle\n  limit?: number\n  isHeader?: boolean\n  isAlignToLeftNav?: boolean\n  title?: string\n  executeQueryRequest?: (param: QueryBundleRequest) => void\n  facetAliases?: {}\n  getLastQueryRequest?: () => QueryBundleRequest\n  getNextPageOfData?: (queryRequest: QueryBundleRequest) => void\n  isLoading?: boolean\n  facet?: string\n  unitDescription?: string\n  hasMoreData?: boolean\n  showBarChart?: boolean\n  token?: string\n} & CardConfiguration\n\nexport const CardContainer = (props: CardContainerProps) => {\n  /**\n   * Handle a click on next or previous\n   *\n   * @memberof SynapseTable\n   */\n  const handleViewMore = () => {\n    const queryRequest = props.getLastQueryRequest!()\n    let offset = queryRequest.query.offset!\n    // paginate forward\n    offset += PAGE_SIZE\n    queryRequest.query.offset = offset\n    props.getNextPageOfData!(queryRequest)\n  }\n\n  const renderCard = (props: any, type: string) => {\n    switch (type) {\n      case DATASET:\n        return <Dataset {...props} />\n      case FUNDER:\n        return <Funder {...props} />\n      case GENERIC_CARD:\n        return <GenericCard {...props} />\n      default:\n        return <div /> // this should never happen\n    }\n  }\n\n  const ids = props.data?.queryResult.queryResults.tableId\n    ? [props.data?.queryResult.queryResults.tableId]\n    : []\n  const tableEntityConcreteType = useGetInfoFromIds<EntityHeader>({\n    ids,\n    type: 'ENTITY_HEADER',\n    token: props.token,\n  })\n  const {\n    data,\n    limit = Infinity,\n    isHeader = false,\n    facet,\n    unitDescription,\n    type,\n    isLoading,\n    secondaryLabelLimit = 3,\n    showBarChart = true,\n    title,\n    token,\n    getLastQueryRequest,\n    executeQueryRequest,\n    ...rest\n  } = props\n  // the cards only show the loading screen on initial load, this occurs when data is undefined\n  if (!data) {\n    return <div>{isLoading && loadingScreen}</div>\n  } else if (data && data.queryResult.queryResults.rows.length === 0) {\n    // data was retrieved from the backend but there is none to show, we return a empty fragment\n    // there could be a more informed UX decision here but the current use case right now\n    // should display nothing\n    return <React.Fragment />\n  }\n  const schema = {}\n  data.queryResult.queryResults.headers.forEach((element, index) => {\n    schema[element.name] = index\n  })\n\n  // We want to hide the view more button if:\n  //   1. The data fed in has !== PAGE_SIZE number of results\n  //   2. The hasMoreData prop is false\n  //   3. The limit is set to less than PAGE_SIZE\n  // below we show the view more button by following the opposite logic from above.\n  let showViewMore: boolean =\n    limit >= PAGE_SIZE && data.queryResult.queryResults.rows.length >= PAGE_SIZE\n  showViewMore = showViewMore && props.hasMoreData!\n\n  const showViewMoreButton = showViewMore && (\n    <div className=\"SRC-viewMore\">\n      <button\n        onClick={handleViewMore}\n        className=\"SRC-standard-button-shape SRC-light-button\"\n      >\n        View More\n      </button>\n    </div>\n  )\n  let cards\n  if (type === MEDIUM_USER_CARD) {\n    // Hard coding ownerId as a column name containing the user profile ownerId\n    // for each row, grab the column with the ownerId\n    const userIdColumnIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.columnType === 'USERID',\n    )\n    if (userIdColumnIndex === -1) {\n      throw Error(\n        'Type MEDIUM_USER_CARD specified but no columnType USERID found',\n      )\n    }\n    const listIds = data.queryResult.queryResults.rows.map(\n      el => el.values[userIdColumnIndex],\n    )\n    cards = <UserCardList data={data} list={listIds} size={MEDIUM_USER_CARD} />\n  } else {\n    // render the cards\n    cards = data.queryResult.queryResults.rows.map((rowData: any, index) => {\n      if (index < limit) {\n        const key = JSON.stringify(rowData.values)\n        const propsForCard = {\n          key,\n          type,\n          schema,\n          isHeader,\n          secondaryLabelLimit,\n          data: rowData.values,\n          selectColumns: data.selectColumns,\n          columnModels: data.columnModels,\n          tableEntityConcreteType:\n            tableEntityConcreteType[0] && tableEntityConcreteType[0].type,\n          tableId: props.data?.queryResult.queryResults.tableId,\n          token,\n          ...rest,\n        }\n        return renderCard(propsForCard, type)\n      }\n      return false\n    })\n  }\n\n  return (\n    <div>\n      {title && <h2 className=\"SRC-card-overview-title\">{title}</h2>}\n      {!title && unitDescription && showBarChart && (\n        <TotalQueryResults\n          token={token}\n          isLoading={isLoading!}\n          unitDescription={unitDescription}\n          executeQueryRequest={executeQueryRequest}\n          lastQueryRequest={getLastQueryRequest!()}\n          frontText={'Displaying'}\n        />\n      )}\n      {/* ReactCSSTransitionGroup adds css fade in property for cards that come into view */}\n      {cards}\n      {showViewMoreButton}\n    </div>\n  )\n}\n\nexport default CardContainer\n","import { getEntity, getFileHandleContent, getFiles } from '../SynapseClient'\nimport { FileEntity } from '../synapseTypes/'\nimport { Entity } from '../synapseTypes/'\nimport { BatchFileResult } from '../synapseTypes/'\nimport { FileHandle } from '../synapseTypes/'\nimport { BatchFileRequest } from '../synapseTypes/'\nimport {\n  FileHandleAssociation,\n  FileHandleAssociateType,\n} from '../synapseTypes/'\n\nconst ESTIMATED_CORS_TIME_MS: number = 200\nconst ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME_KEY: string =\n  'ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME'\nconst ESTIMATED_DOWNLOAD_SPEED_KEY: string = 'ESTIMATED_DOWNLOAD_SPEED'\nconst TEST_FILE_ENTITY_ID: string = 'syn12600511'\n/**\n * Return the estimated download speed (bytes/second).  Result is cached.\n * Result is crude estimate since it's a single test file (small sample, only ~2MB), but is a valid test (since it's a Synapse file on s3).\n * The intent is to let the user know if the package download will take many hours to download.\n * @param sessionToken\n */\nexport const testDownloadSpeed = (sessionToken: string): Promise<number> => {\n  return new Promise((resolve, reject) => {\n    // check cache\n    const cachedSpeedExpireTime = localStorage.getItem(\n      ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME_KEY,\n    )\n    const cachedSpeed = localStorage.getItem(ESTIMATED_DOWNLOAD_SPEED_KEY)\n    if (cachedSpeedExpireTime && cachedSpeed) {\n      // is this value expired?\n      const now: number = new Date().getTime()\n      if (now < Number(cachedSpeedExpireTime)) {\n        resolve(Number(cachedSpeed))\n        return\n      }\n    }\n\n    /**\n     * 1.  Get the test File Entity\n     * 2.  Get the file handle and presigned URL associated to the latest version of the test File Entity\n     * 3.  Start the timer and fetch the file content using that presigned URL\n     */\n    getEntity(sessionToken, TEST_FILE_ENTITY_ID)\n      .then((entity: Entity) => {\n        const fileEntity: FileEntity = entity as FileEntity\n        const fileHandleAssociationList: FileHandleAssociation[] = [\n          {\n            associateObjectId: fileEntity.id!,\n            associateObjectType: FileHandleAssociateType.FileEntity,\n            fileHandleId: fileEntity.dataFileHandleId,\n          },\n        ]\n        const request: BatchFileRequest = {\n          includeFileHandles: true,\n          includePreSignedURLs: true,\n          includePreviewPreSignedURLs: false,\n          requestedFiles: fileHandleAssociationList,\n        }\n        getFiles(request, sessionToken).then((data: BatchFileResult) => {\n          const presignedUrl: string = data.requestedFiles[0].preSignedURL!\n          // we know this file exists\n          const fileHandle: FileHandle = data.requestedFiles[0].fileHandle!\n          // start test!\n          const startMs = new Date().getTime()\n          return getFileHandleContent(fileHandle, presignedUrl).then(() => {\n            // console.log(`Transferred ${fileHandle.contentSize/1000000} MB in ${((new Date().getTime() - startMs - ESTIMATED_CORS_TIME_MS)/1000)} seconds`)\n            // bytes/second\n            const result =\n              fileHandle.contentSize /\n              ((new Date().getTime() - startMs - ESTIMATED_CORS_TIME_MS) / 1000)\n            // save result in cache (for 5 minutes)\n            const now: number = new Date().getTime()\n            localStorage.setItem(\n              ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME_KEY,\n              (now + 1000 * 60 * 5).toString(),\n            )\n            localStorage.setItem(\n              ESTIMATED_DOWNLOAD_SPEED_KEY,\n              result.toString(),\n            )\n            resolve(result)\n          })\n        })\n      })\n      .catch(err => reject(err))\n  })\n}\n","import React, { useState, useEffect } from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faFile, faDatabase, faClock } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { testDownloadSpeed } from '../../utils/functions/testDownloadSpeed'\nimport { calculateFriendlyFileSize } from '../../utils/functions/calculateFriendlyFileSize'\nimport ReactTooltip from 'react-tooltip'\nimport moment from 'moment'\nimport { TOOLTIP_DELAY_SHOW } from '../table/SynapseTableConstants'\n\nlibrary.add(faFile)\nlibrary.add(faDatabase)\nlibrary.add(faClock)\n\nexport type DownloadDetailsProps = {\n  numFiles: number\n  numBytes: number\n  token: string | undefined\n}\n\ntype State = {\n  isLoading: boolean\n  downloadSpeed: number\n}\n\nexport default function DownloadDetails(props: DownloadDetailsProps) {\n  const [state, setState] = useState<State>({\n    isLoading: true,\n    downloadSpeed: 0,\n  })\n  const { isLoading, downloadSpeed } = state\n  const { token, numFiles, numBytes } = props\n\n  useEffect(() => {\n    if (token) {\n      testDownloadSpeed(token).then(speed => {\n        setState({\n          isLoading: false,\n          downloadSpeed: speed,\n        })\n      })\n    }\n  }, [token])\n\n  const timeEstimateInSeconds =\n    isLoading || downloadSpeed === 0 ? 0 : numBytes / downloadSpeed\n  const friendlyTime =\n    timeEstimateInSeconds === 0\n      ? ''\n      : moment.duration(timeEstimateInSeconds, 'seconds').humanize()\n  const numBytesTooltipId = 'num_bytes_id'\n  const friendlyTimeTooltipId = 'friendly_time_id'\n  const isInactive = numFiles === 0 || timeEstimateInSeconds === 0\n  const iconClassName = isInactive ? 'SRC-inactive' : 'SRC-primary-text-color'\n  return (\n    <span className=\"download-details-container\">\n      <span>\n        <FontAwesomeIcon className={iconClassName} icon=\"file\" />\n        {!isInactive && <> {numFiles} &nbsp; files </>}\n      </span>\n      <span\n        data-for={numBytesTooltipId}\n        data-tip=\"This is the total size of all files. Zipped package(s) will likely be smaller.\"\n      >\n        <ReactTooltip\n          delayShow={TOOLTIP_DELAY_SHOW}\n          place=\"top\"\n          type=\"dark\"\n          effect=\"solid\"\n          id={numBytesTooltipId}\n        />\n        <FontAwesomeIcon className={iconClassName} icon=\"database\" />\n        {calculateFriendlyFileSize(numBytes)}\n      </span>\n      <span\n        data-for={friendlyTimeTooltipId}\n        data-tip=\"This is an estimate of how long package download will take.\"\n      >\n        <ReactTooltip\n          delayShow={TOOLTIP_DELAY_SHOW}\n          place=\"top\"\n          type=\"dark\"\n          effect=\"solid\"\n          id={friendlyTimeTooltipId}\n        />\n        <FontAwesomeIcon className={iconClassName} icon=\"clock\" />\n        {isLoading && numFiles > 0 && <span className=\"spinner\" />}\n        {!isLoading && friendlyTime}\n      </span>\n    </span>\n  )\n}\n","import { useEffect, useRef } from 'react'\n\nconst usePrevious = <T>(value: T): T | undefined => {\n  const ref = useRef<T>()\n  useEffect(() => {\n    ref.current = value\n  })\n  return ref.current\n}\n\nexport default usePrevious\n","import usePrevious from './usePrevious'\n\nconst useCompare = <T extends string | number | boolean | undefined>(\n  val: T,\n) => {\n  const prevVal = usePrevious<T>(val)\n  return prevVal !== val\n}\n\nexport default useCompare\n","import React from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCheck, faLock } from '@fortawesome/free-solid-svg-icons'\n\nexport type CheckMarkProps = {\n  isCompleted: boolean | undefined\n}\nexport default function AccessApprovalCheckMark({\n  isCompleted,\n}: CheckMarkProps) {\n  return (\n    <div className={`check-mark-container ${isCompleted ? 'green' : 'orange'}`}>\n      <FontAwesomeIcon icon={isCompleted ? faCheck : faLock} />\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { useState, useEffect } from 'react'\nimport MarkdownSynapse from '../MarkdownSynapse'\nimport {\n  WikiPageKey,\n  AccessRequirementStatus,\n  AccessRequirement,\n  UserProfile,\n  TermsOfUseAccessRequirement,\n  SelfSignAccessRequirement,\n  ManagedACTAccessRequirement,\n  AccessApproval,\n  ApprovalState,\n  ACTAccessRequirement,\n} from '../../utils/synapseTypes/'\nimport { SynapseClient } from '../../utils'\nimport AccessApprovalCheckMark from './AccessApprovalCheckMark'\nimport { SUPPORTED_ACCESS_REQUIREMENTS } from './AccessRequirementList'\n\nexport type AcceptedRequirementsProps = {\n  user: UserProfile | undefined\n  token: string | undefined\n  wikiPage: WikiPageKey | undefined\n  entityId: string\n  accessRequirement:\n    | AccessRequirement\n    | TermsOfUseAccessRequirement\n    | SelfSignAccessRequirement\n    | ManagedACTAccessRequirement\n  accessRequirementStatus: AccessRequirementStatus | undefined\n  showButton?: boolean\n  onHide?: Function\n}\n\nexport default function AcceptedRequirements({\n  user,\n  token,\n  wikiPage,\n  accessRequirement,\n  accessRequirementStatus,\n  showButton,\n  entityId,\n  onHide,\n}: AcceptedRequirementsProps) {\n  const [isHide, setIsHide] = useState<boolean>(true)\n  const propsIsApproved = accessRequirementStatus?.isApproved\n  const [isApproved, setIsApproved] = useState<boolean | undefined>(\n    propsIsApproved,\n  )\n\n  let acceptButtonText = ''\n  if (\n    accessRequirement.concreteType ===\n      SUPPORTED_ACCESS_REQUIREMENTS.ManagedACTAccessRequirement ||\n    accessRequirement.concreteType ===\n      SUPPORTED_ACCESS_REQUIREMENTS.ACTAccessRequirement\n  ) {\n    if (\n      window.location.hostname === 'www.synapse.org' ||\n      window.location.hostname === 'staging.synapse.org'\n    ) {\n      acceptButtonText = 'Request access'\n    } else {\n      acceptButtonText = 'Request access via Synapse.org'\n    }\n  } else {\n    acceptButtonText = 'I Accept Terms of Use'\n  }\n\n  useEffect(() => {\n    setIsApproved(propsIsApproved)\n  }, [propsIsApproved])\n\n  const gotoSynapseAccessRequirementPage = () => {\n    window.open(\n      `https://www.synapse.org/#!AccessRequirement:AR_ID=${accessRequirement.id}&TYPE=ENTITY&ID=${entityId}`,\n    )\n  }\n  const onAcceptClicked = () => {\n    if (\n      accessRequirement.concreteType ===\n        SUPPORTED_ACCESS_REQUIREMENTS.ManagedACTAccessRequirement ||\n      accessRequirement.concreteType ===\n        SUPPORTED_ACCESS_REQUIREMENTS.ACTAccessRequirement\n    ) {\n      gotoSynapseAccessRequirementPage()\n    } else {\n      if (!isApproved) {\n        const accessApprovalRequest: AccessApproval = {\n          requirementId: accessRequirement?.id!,\n          submitterId: user?.ownerId!,\n          accessorId: user?.ownerId!,\n          state: ApprovalState.APPROVED,\n        }\n\n        SynapseClient.postAccessApproval(token, accessApprovalRequest)\n          .then(_ => {\n            setIsApproved(true)\n          })\n          .catch(err => console.error('Error on post access approval: ', err))\n      }\n    }\n  }\n\n  const termsOfUse = (accessRequirement as TermsOfUseAccessRequirement)\n    .termsOfUse\n\n  const actContactInfo = (accessRequirement as ACTAccessRequirement)\n    .actContactInfo\n\n  const isTermsOfUse =\n    accessRequirement.concreteType ===\n    SUPPORTED_ACCESS_REQUIREMENTS.TermsOfUseAccessRequirement\n  const isActContactInfo =\n    accessRequirement.concreteType ===\n    SUPPORTED_ACCESS_REQUIREMENTS.ACTAccessRequirement\n\n  const isActOrTermsOfUse =\n    (isTermsOfUse && termsOfUse) || (isActContactInfo && actContactInfo)\n\n  let markdown = <></>\n\n  if (wikiPage) {\n    markdown = (\n      <div className=\"AcceptRequirementsMarkdown\">\n        <MarkdownSynapse\n          token={token}\n          wikiId={wikiPage?.wikiPageId}\n          ownerId={wikiPage?.ownerObjectId}\n          objectType={wikiPage?.ownerObjectType}\n        />\n      </div>\n    )\n  } else if (isActOrTermsOfUse) {\n    markdown = (\n      <MarkdownSynapse\n        markdown={isTermsOfUse ? termsOfUse : actContactInfo}\n        token={token}\n      />\n    )\n  }\n\n  const isManagedActAr =\n    accessRequirement.concreteType ===\n    SUPPORTED_ACCESS_REQUIREMENTS.ManagedACTAccessRequirement\n\n  return (\n    <>\n      <div className=\"requirement-container\">\n        <AccessApprovalCheckMark isCompleted={isApproved} />\n        <div className=\"terms-of-use-content\">\n          {isApproved ? (\n            <div>\n              <p>\n                You have accepted the terms of use.\n                {isManagedActAr && (\n                  <button\n                    className=\"update-request-button bold-text\"\n                    onClick={() => {\n                      gotoSynapseAccessRequirementPage()\n                    }}\n                  >\n                    Update Request\n                  </button>\n                )}\n                <button\n                  className=\"view-terms-button bold-text\"\n                  onClick={() => {\n                    setIsHide(!isHide)\n                  }}\n                >\n                  View Terms\n                </button>\n              </p>\n              <div className={`view-terms ${isHide ? 'hidden' : 'show'}`}>\n                {markdown}\n              </div>\n            </div>\n          ) : (\n            markdown\n          )}\n        </div>\n      </div>\n      {token && showButton && (\n        <div className={`button-container ${isApproved ? `hide` : `default`}`}>\n          <div className=\"accept-button-container\">\n            <button className=\"accept-button\" onClick={onAcceptClicked}>\n              {acceptButtonText}\n            </button>\n          </div>\n\n          <div className=\"not-accept-button-container\">\n            <button className=\"not-accpet-button\" onClick={() => onHide?.()}>\n              I do not accept\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  )\n}\n","import * as React from 'react'\nimport { useEffect, useState } from 'react'\nimport {\n  SelfSignAccessRequirement,\n  WikiPageKey,\n  UserBundle,\n} from '../../utils/synapseTypes'\nimport { SynapseClient, SynapseConstants } from '../../utils'\nimport AccessApprovalCheckMark from './AccessApprovalCheckMark'\nimport AcceptedRequirements from './AcceptedRequirements'\nimport { AccessRequirementProps } from './AccessRequirementProps'\n\nexport default function SelfSignAccessRequirementComponent({\n  accessRequirement,\n  token,\n  user,\n  onHide,\n  accessRequirementStatus,\n  entityId,\n}: AccessRequirementProps<SelfSignAccessRequirement>) {\n  const [wikiPage, setWikiPage] = useState<WikiPageKey | undefined>(undefined)\n  const [userBundle, setUserBundle] = useState<UserBundle | undefined>(\n    undefined,\n  )\n  const [isLoading, setIsLoading] = useState<boolean>(false)\n\n  useEffect(() => {\n    const getSelfSignAccessData = async () => {\n      try {\n        setIsLoading(true)\n        const wikiPageRequirment = await SynapseClient.getWikiPageKey(\n          token,\n          accessRequirement.id,\n        )\n\n        setWikiPage(wikiPageRequirment)\n\n        const certificationOrVerification =\n          SynapseConstants.USER_BUNDLE_MASK_IS_CERTIFIED |\n          SynapseConstants.USER_BUNDLE_MASK_IS_VERIFIED\n\n        if (user?.ownerId) {\n          const bundle = await SynapseClient.getUserBundle(\n            user.ownerId,\n            certificationOrVerification,\n            token,\n          )\n          setUserBundle(bundle)\n        }\n      } catch (err) {\n        console.error('Error on get Self Sign Access Requirement: ', err)\n      } finally {\n        setIsLoading(false)\n      }\n    }\n\n    getSelfSignAccessData()\n  }, [accessRequirement, token, user])\n\n  return (\n    <>\n      {accessRequirement.isCertifiedUserRequired && (\n        <div className=\"requirement-container\">\n          <AccessApprovalCheckMark isCompleted={userBundle?.isCertified} />\n          <div>\n            <p className=\"self-sign-access-title bold-text\">\n              You must first become a\n              <a\n                className=\"self-sign-access-certified bold-text\"\n                href=\"https://www.synapse.org/#!Quiz:\"\n              >\n                &nbsp;certified user\n              </a>\n            </p>\n            {isLoading && <span className=\"spinner\" />}\n\n            <p\n              className={`self-sign-access-certified-success-text ${\n                userBundle?.isCertified ? 'show' : 'hidden'\n              }`}\n            >\n              You are a certified user\n            </p>\n          </div>\n        </div>\n      )}\n      {accessRequirement.isValidatedProfileRequired && (\n        <div className=\"requirement-container\">\n          <AccessApprovalCheckMark isCompleted={userBundle?.isVerified} />\n          <div>\n            <p className=\"self-sign-access-title bold-text\">\n              You must first apply to have your\n              <a\n                className=\"self-sign-access-validated bold-text\"\n                href=\"https://www.synapse.org/#!Profile:v/settings\"\n              >\n                &nbsp;user profile validated\n              </a>\n            </p>\n            {isLoading && <span className=\"spinner\" />}\n\n            <p\n              className={`self-sign-access-verified-success-text ${\n                userBundle?.isVerified ? 'show' : 'hidden'\n              }`}\n            >\n              You have applied to have user profile valiadation successfully\n            </p>\n          </div>\n        </div>\n      )}\n      <AcceptedRequirements\n        user={user}\n        token={token}\n        wikiPage={wikiPage}\n        accessRequirement={accessRequirement}\n        accessRequirementStatus={accessRequirementStatus}\n        onHide={onHide}\n        entityId={entityId}\n      />\n    </>\n  )\n}\n","import * as React from 'react'\nimport { useEffect, useState } from 'react'\nimport {\n  WikiPageKey,\n  TermsOfUseAccessRequirement,\n} from '../../utils/synapseTypes'\nimport { SynapseClient } from '../../utils'\nimport AcceptedRequirements from './AcceptedRequirements'\nimport { AccessRequirementProps } from './AccessRequirementProps'\n\nexport default function TermsOfUseAccessRequirementComponent({\n  accessRequirement,\n  token,\n  user,\n  onHide,\n  accessRequirementStatus,\n  entityId,\n}: AccessRequirementProps<TermsOfUseAccessRequirement>) {\n  const [wikiPage, setWikiPage] = useState<WikiPageKey | undefined>(undefined)\n  const [isLoading, setIsLoading] = useState<boolean>(false)\n\n  useEffect(() => {\n    const getTermsOfUseData = async () => {\n      setIsLoading(true)\n\n      try {\n        const wikiPageRequirement = await SynapseClient.getWikiPageKey(\n          token,\n          accessRequirement.id,\n        )\n        setWikiPage(wikiPageRequirement)\n      } catch (err) {\n        console.error('Error on prepare terms of use ', err)\n      } finally {\n        setIsLoading(false)\n      }\n    }\n\n    getTermsOfUseData()\n  }, [token, accessRequirement])\n\n  return (\n    <>\n      {isLoading && <span className=\"spinner\" />}\n      <AcceptedRequirements\n        user={user}\n        token={token}\n        wikiPage={wikiPage}\n        accessRequirement={accessRequirement}\n        accessRequirementStatus={accessRequirementStatus}\n        onHide={onHide}\n        entityId={entityId}\n      />\n    </>\n  )\n}\n","import React, { useEffect, useState } from 'react'\nimport {\n  ManagedACTAccessRequirement,\n  WikiPageKey,\n} from '../../utils/synapseTypes'\nimport { SynapseClient } from '../../utils'\nimport AcceptedRequirements from './AcceptedRequirements'\nimport { AccessRequirementProps } from './AccessRequirementProps'\n\nexport default function ManagedACTAccessRequirementComponent({\n  accessRequirement,\n  token,\n  user,\n  onHide,\n  accessRequirementStatus,\n  entityId,\n}: AccessRequirementProps<ManagedACTAccessRequirement>) {\n  const [wikiPage, setWikiPage] = useState<WikiPageKey>()\n\n  useEffect(() => {\n    const getManagedACTAccessData = async () => {\n      try {\n        const wikipageRequirement = await SynapseClient.getWikiPageKey(\n          token,\n          accessRequirement.id,\n        )\n        setWikiPage(wikipageRequirement)\n      } catch (err) {\n        console.error('Error on get ManagedACTAccessRequirement', err)\n      }\n    }\n\n    getManagedACTAccessData()\n  }, [token, accessRequirement])\n\n  return (\n    <AcceptedRequirements\n      accessRequirement={accessRequirement}\n      accessRequirementStatus={accessRequirementStatus}\n      entityId={entityId}\n      token={token}\n      user={user}\n      wikiPage={wikiPage}\n      onHide={onHide}\n    />\n  )\n}\n","import React, { useEffect, useState } from 'react'\nimport { ACTAccessRequirement, WikiPageKey } from '../../utils/synapseTypes'\nimport { SynapseClient } from '../../utils'\nimport AcceptedRequirements from './AcceptedRequirements'\nimport { AccessRequirementProps } from './AccessRequirementProps'\n\nexport default function ACTAccessRequirementComponent({\n  accessRequirement,\n  token,\n  user,\n  onHide,\n  accessRequirementStatus,\n  entityId,\n}: AccessRequirementProps<ACTAccessRequirement>) {\n  const [wikiPage, setWikiPage] = useState<WikiPageKey>()\n\n  useEffect(() => {\n    const getACTAccessData = async () => {\n      try {\n        const wikipageRequirement = await SynapseClient.getWikiPageKey(\n          token,\n          accessRequirement.id,\n        )\n        setWikiPage(wikipageRequirement)\n      } catch (err) {\n        console.error('Error on get ACTAccessRequirement', err)\n      }\n    }\n\n    getACTAccessData()\n  }, [token, accessRequirement])\n\n  return (\n    <AcceptedRequirements\n      accessRequirement={accessRequirement}\n      accessRequirementStatus={accessRequirementStatus}\n      token={token}\n      user={user}\n      wikiPage={wikiPage}\n      onHide={onHide}\n      entityId={entityId}\n    />\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport { AccessRequirement } from '../../utils/synapseTypes/AccessRequirement/AccessRequirement'\nimport { getAllAccessRequirements } from '../../utils/SynapseClient'\nimport { SynapseConstants, SynapseClient } from '../../utils/'\nimport useCompare from '../../utils/hooks/useCompare'\nimport * as ReactBootstrap from 'react-bootstrap'\nimport SelfSignAccessRequirementComponent from './SelfSignAccessRequirement'\nimport TermsOfUseAccessRequirementComponent from './TermsOfUseAccessRequirement'\nimport ManagedACTAccessRequirementComponent from './ManagedACTAccessRequirement'\nimport ACTAccessRequirementComponent from './ACTAccessRequirement'\nimport {\n  UserProfile,\n  EntityHeader,\n  ACTAccessRequirement,\n  ManagedACTAccessRequirement,\n  TermsOfUseAccessRequirement,\n  SelfSignAccessRequirement,\n  AccessRequirementStatus,\n} from '../../utils/synapseTypes'\nimport useGetInfoFromIds, {\n  UseGetInfoFromIdsProps,\n} from '../../utils/hooks/useGetInfoFromIds'\nimport AccessApprovalCheckMark from './AccessApprovalCheckMark'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faFile } from '@fortawesome/free-solid-svg-icons'\nimport { sortBy } from 'lodash-es'\n\nlibrary.add(faFile)\n\ntype AccessRequirementAndStatus = {\n  accessRequirement: AccessRequirement\n  accessRequirementStatus: AccessRequirementStatus\n}\n\nexport type AccessRequirementListProps = {\n  entityId: string\n  token?: string\n  accessRequirementFromProps?: Array<AccessRequirement>\n  onHide?: Function\n  renderAsModal?: boolean\n}\n\nexport enum SUPPORTED_ACCESS_REQUIREMENTS {\n  SelfSignAccessRequirement = 'org.sagebionetworks.repo.model.SelfSignAccessRequirement',\n  TermsOfUseAccessRequirement = 'org.sagebionetworks.repo.model.TermsOfUseAccessRequirement',\n  ManagedACTAccessRequirement = 'org.sagebionetworks.repo.model.ManagedACTAccessRequirement',\n  ACTAccessRequirement = 'org.sagebionetworks.repo.model.ACTAccessRequirement',\n}\n\nexport const checkHasUnsportedRequirement = (\n  accessRequirements: Array<AccessRequirement>,\n): boolean => {\n  return accessRequirements.filter(isARUnsupported).length > 0\n}\n\nconst isARUnsupported = (accessRequirement: AccessRequirement) => {\n  switch (accessRequirement.concreteType) {\n    case SUPPORTED_ACCESS_REQUIREMENTS.ACTAccessRequirement:\n    case SUPPORTED_ACCESS_REQUIREMENTS.ManagedACTAccessRequirement:\n    case SUPPORTED_ACCESS_REQUIREMENTS.TermsOfUseAccessRequirement:\n    case SUPPORTED_ACCESS_REQUIREMENTS.SelfSignAccessRequirement:\n      return false\n    default:\n      return true\n  }\n}\n\nexport default function AccessRequirementList({\n  entityId,\n  token,\n  onHide,\n  accessRequirementFromProps,\n  renderAsModal,\n}: AccessRequirementListProps) {\n  const [accessRequirements, setAccessRequirements] = useState<\n    Array<AccessRequirementAndStatus> | undefined\n  >(undefined)\n\n  const [user, setUser] = useState<UserProfile>()\n\n  const entityHeaderProps: UseGetInfoFromIdsProps = {\n    ids: [entityId],\n    token: token,\n    type: 'ENTITY_HEADER',\n  }\n\n  const hasTokenChanged = useCompare(token)\n  const shouldUpdateData = hasTokenChanged || !accessRequirements\n\n  const entityInformation = useGetInfoFromIds<EntityHeader>(entityHeaderProps)\n\n  useEffect(() => {\n    const sortAccessRequirementByCompletion = async (\n      requirements: Array<AccessRequirement>,\n    ): Promise<Array<AccessRequirementAndStatus>> => {\n      const statuses = requirements.map(req => {\n        return SynapseClient.getAccessRequirementStatus(token, req.id)\n      })\n      const accessRequirementStatuses = await Promise.all(statuses)\n\n      const requirementsAndStatuses = requirements.map(req => {\n        return {\n          accessRequirement: req,\n          accessRequirementStatus: accessRequirementStatuses.find(\n            el => Number(el.accessRequirementId) === req.id,\n          )!,\n        }\n      })\n\n      const sortedRequirementsAndStatuses = sortBy(\n        requirementsAndStatuses,\n        reqAndStatus => {\n          // if its true then it should come first, which means that it should be higher in the list\n          // which is sorted ascendingly\n          return -1 * Number(reqAndStatus.accessRequirementStatus.isApproved)\n        },\n      )\n\n      return sortedRequirementsAndStatuses\n    }\n\n    const getAccessRequirements = async () => {\n      try {\n        if (!shouldUpdateData) {\n          return\n        }\n        if (!accessRequirementFromProps) {\n          const requirements = await getAllAccessRequirements(token, entityId)\n          const sortedAccessRequirements = await sortAccessRequirementByCompletion(\n            requirements,\n          )\n          setAccessRequirements(sortedAccessRequirements)\n        } else {\n          const sortedAccessRequirements = await sortAccessRequirementByCompletion(\n            accessRequirementFromProps!,\n          )\n          setAccessRequirements(sortedAccessRequirements)\n        }\n\n        const userProfile = await SynapseClient.getUserProfile(token)\n        setUser(userProfile)\n\n        // we use a functional update below https://reactjs.org/docs/hooks-reference.html#functional-updates\n        // because we want react hooks to update without a dependency on accessRequirements\n      } catch (err) {\n        console.error('Error on get access requirements: ', err)\n      }\n    }\n\n    getAccessRequirements()\n  }, [token, entityId, accessRequirementFromProps, shouldUpdateData])\n\n  // Using Boolean(value) converts undefined,null, 0,'',false -> false\n  // one alternative to using Boolean(value) is the double bang operator !!value,\n  // but doesn't ready well\n  const isSignedIn: boolean = Boolean(token)\n\n  /**\n   * Returns rendering for the access requirement.\n   *\n   * Only supports SelfSignAccessRequirement and TermsOfUseAccessRequirement\n   *\n   * @param {AccessRequirement} accessRequirement accessRequirement being rendered\n   */\n  const renderAccessRequirement = (\n    accessRequirement: AccessRequirement,\n    accessRequirementStatus: AccessRequirementStatus,\n  ) => {\n    switch (accessRequirement.concreteType) {\n      case SUPPORTED_ACCESS_REQUIREMENTS.SelfSignAccessRequirement:\n        return (\n          <SelfSignAccessRequirementComponent\n            accessRequirement={accessRequirement as SelfSignAccessRequirement}\n            accessRequirementStatus={accessRequirementStatus}\n            token={token}\n            user={user}\n            onHide={onHide}\n            entityId={entityId}\n          />\n        )\n      case SUPPORTED_ACCESS_REQUIREMENTS.TermsOfUseAccessRequirement:\n        return (\n          <TermsOfUseAccessRequirementComponent\n            accessRequirement={accessRequirement as TermsOfUseAccessRequirement}\n            accessRequirementStatus={accessRequirementStatus}\n            token={token}\n            user={user}\n            onHide={onHide}\n            entityId={entityId}\n          />\n        )\n      case SUPPORTED_ACCESS_REQUIREMENTS.ManagedACTAccessRequirement:\n        return (\n          <ManagedACTAccessRequirementComponent\n            accessRequirement={accessRequirement as ManagedACTAccessRequirement}\n            accessRequirementStatus={accessRequirementStatus}\n            token={token}\n            user={user}\n            onHide={onHide}\n            entityId={entityId}\n          />\n        )\n      case SUPPORTED_ACCESS_REQUIREMENTS.ACTAccessRequirement:\n        return (\n          <ACTAccessRequirementComponent\n            accessRequirement={accessRequirement as ACTAccessRequirement}\n            accessRequirementStatus={accessRequirementStatus}\n            token={token}\n            user={user}\n            onHide={onHide}\n            entityId={entityId}\n          />\n        )\n      // case not supported yet\n      default:\n        return undefined\n    }\n  }\n  const content = (\n    <>\n      <ReactBootstrap.Modal.Header closeButton={true}>\n        <ReactBootstrap.Modal.Title className=\"AccessRequirementList__title\">\n          Data Access Request\n        </ReactBootstrap.Modal.Title>\n      </ReactBootstrap.Modal.Header>\n      <ReactBootstrap.Modal.Body>\n        <div>\n          <h4 className=\"AccessRequirementList__instruction AccessRequirementList__access\">\n            Access For:\n          </h4>\n          <a\n            className=\"AccessRequirementList__register-text-link\"\n            href={`https://www.synapse.org/#!Synapse:${entityId}`}\n          >\n            <FontAwesomeIcon\n              size=\"lg\"\n              icon=\"file\"\n              className=\"AccessRequirementList__file\"\n            />\n            &nbsp;{entityInformation[0]?.name}\n          </a>\n          <h4 className=\"AccessRequirementList__instruction\">\n            What do I need to do?\n          </h4>\n          <div className=\"requirement-container\">\n            <AccessApprovalCheckMark isCompleted={isSignedIn} />\n            <div>\n              {!isSignedIn && (\n                <>\n                  <p className=\"AccessRequirementList__signin\">\n                    <button\n                      className={`${SynapseConstants.SRC_SIGN_IN_CLASS} SRC-primary-text-color SRC-boldText `}\n                    >\n                      Sign in\n                    </button>\n                    with a Sage Platform (Synapse) user account.\n                  </p>\n                  <p>\n                    If you do not have a Sage Account, you can\n                    <a\n                      className=\"register-text-link bold-text\"\n                      href=\"https://www.synapse.org/#!RegisterAccount:0\"\n                    >\n                      &nbsp;Register for free.\n                    </a>\n                  </p>\n                </>\n              )}\n              {isSignedIn && (\n                <p>\n                  You have signed with Sage Platform (Synapse) user account as{' '}\n                  <b className=\"SRC-primary-text-color\">\n                    {user?.userName}@synapse.org\n                  </b>\n                </p>\n              )}\n            </div>\n          </div>\n          {accessRequirements?.map(\n            ({ accessRequirement, accessRequirementStatus }) => {\n              return (\n                <React.Fragment key={accessRequirement.id}>\n                  {renderAccessRequirement(\n                    accessRequirement,\n                    accessRequirementStatus,\n                  )}\n                </React.Fragment>\n              )\n            },\n          )}\n        </div>\n      </ReactBootstrap.Modal.Body>\n    </>\n  )\n\n  if (renderAsModal) {\n    return (\n      <ReactBootstrap.Modal\n        className=\"AccessRequirementList\"\n        onHide={() => onHide?.()}\n        show={true}\n        animation={false}\n        centered={true}\n        scrollable={true}\n      >\n        {content}\n      </ReactBootstrap.Modal>\n    )\n  }\n  return <div className=\"AccessRequirementList\">{content}</div>\n}\n","import { IconProp, library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCircle,\n  faDatabase,\n  faLink,\n  faUnlockAlt,\n  faLock,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport ReactTooltip from 'react-tooltip'\nimport { SynapseClient } from '../utils'\nimport {\n  BackendDestinationEnum,\n  getEndpoint,\n} from '../utils/functions/getEndpoint'\nimport {\n  FileHandle,\n  RestrictableObjectType,\n  RestrictionInformationRequest,\n  RestrictionInformationResponse,\n  RestrictionLevel,\n  FileEntity,\n  AccessRequirement,\n  implementsExternalFileHandleInterface,\n} from '../utils/synapseTypes/'\nimport { TOOLTIP_DELAY_SHOW } from './table/SynapseTableConstants'\nimport AccessRequirementList, {\n  checkHasUnsportedRequirement,\n  AccessRequirementListProps,\n} from './access_requirement_list/AccessRequirementList'\nimport { SRC_SIGN_IN_CLASS } from '../utils/SynapseConstants'\n\nlibrary.add(faUnlockAlt)\nlibrary.add(faDatabase)\nlibrary.add(faCircle)\n\nexport type HasAccessProps = {\n  onHide?: Function\n  fileHandle?: FileHandle\n  entityId: string\n  isInDownloadList?: boolean // set to show errors in UI about package creation\n  entityVersionNumber?: string\n  token?: string\n  forceSamePage?: boolean\n  set_arPropsFromHasAccess?: (props: AccessRequirementListProps) => void\n}\n\ntype HasAccessState = {\n  restrictionInformation?: RestrictionInformationResponse\n  fileHandleDownloadType?: FileHandleDownloadTypeEnum\n  displayAccessRequirement: boolean\n  accessRequirements?: Array<AccessRequirement>\n  isGettingRestrictionInformation: boolean\n  isGettingEntityInformation: boolean\n  errorOnGetRestrictionInformation: boolean\n}\n\nexport enum GoogleCloudFileHandleEnum {\n  GoogleCloudFileHandle = 'org.sagebionetworks.repo.model.file.GoogleCloudFileHandle',\n}\n\nexport const GIGABYTE_SIZE = 2 ** 30\n\nexport enum FileHandleDownloadTypeEnum {\n  ExternalCloudFile = 'ExternalCloudFile',\n  ExternalFileLink = 'ExternalFileLink',\n  TooLarge = 'TooLarge',\n  Accessible = 'Accessible',\n  AccessBlockedByRestriction = 'AccessBlockedByRestriction',\n  AccessBlockedByACL = 'AccessBlockedByACL',\n  AccessBlockedToAnonymous = 'AccessBlockedToAnonymous',\n  NoFileHandle = 'NoFileHandle',\n}\n\nexport const getDownloadTypeForFileHandle = (\n  fileHandle: FileHandle,\n  isInDownloadList?: boolean,\n) => {\n  if (fileHandle && !isInDownloadList) {\n    return FileHandleDownloadTypeEnum.Accessible\n  }\n  const { concreteType, contentSize } = fileHandle\n  // check if it's too large\n  if (contentSize >= GIGABYTE_SIZE) {\n    return FileHandleDownloadTypeEnum.TooLarge\n  }\n  // check if it's a google cloud file handle\n  if (concreteType === GoogleCloudFileHandleEnum.GoogleCloudFileHandle) {\n    return FileHandleDownloadTypeEnum.ExternalCloudFile\n  }\n  // check if it's an external file handle\n  if (implementsExternalFileHandleInterface(fileHandle)) {\n    return FileHandleDownloadTypeEnum.ExternalFileLink\n  }\n  // otherwise its available\n  return FileHandleDownloadTypeEnum.Accessible\n}\n\n/**\n * HasAccess shows if the user has access to the file or not.\n *\n * The component's behavior changes whether it's passed in a FileHandle or not.\n * If passed a file handle then it will give more detailed information about the download.\n *\n * @export\n * @class HasAccess\n * @extends {React.Component<HasAccessProps, HasAccessState>}\n */\nexport default class HasAccess extends React.Component<\n  HasAccessProps,\n  HasAccessState\n> {\n  public static tooltipText = {\n    [FileHandleDownloadTypeEnum.AccessBlockedToAnonymous]:\n      'You must sign in to access this file.',\n    // Note AccessBlockedByRestriction is never explicitly set, its value is calculated\n    [FileHandleDownloadTypeEnum.AccessBlockedByRestriction]:\n      'You must request access to this restricted file.',\n    [FileHandleDownloadTypeEnum.AccessBlockedByACL]:\n      'You do not have download access for this item.',\n    [FileHandleDownloadTypeEnum.TooLarge]:\n      'This file is too large to download as a package and must be downloaded manually.',\n    [FileHandleDownloadTypeEnum.ExternalFileLink]:\n      'This is an external link, which must be downloaded manually.',\n    [FileHandleDownloadTypeEnum.ExternalCloudFile]:\n      'This file must be downloaded manually (e.g. a file in Google Cloud).',\n  }\n\n  constructor(props: HasAccessProps) {\n    super(props)\n    this.getRestrictionInformation = this.getRestrictionInformation.bind(this)\n    this.getFileEntityFileHandle = this.getFileEntityFileHandle.bind(this)\n    this.updateStateFileHandleAccessBlocked = this.updateStateFileHandleAccessBlocked.bind(\n      this,\n    )\n\n    this.state = {\n      fileHandleDownloadType: undefined,\n      displayAccessRequirement: false,\n      accessRequirements: [],\n      isGettingEntityInformation: false,\n      isGettingRestrictionInformation: false,\n      errorOnGetRestrictionInformation: false,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh()\n  }\n\n  componentDidUpdate(prevProps: HasAccessProps) {\n    const forceRefresh = prevProps.token !== this.props.token\n    // if there token has updated then force refresh the component state\n    this.refresh(forceRefresh)\n  }\n\n  refresh = (forceRefresh?: boolean) => {\n    if (\n      this.state.isGettingEntityInformation ||\n      this.state.isGettingRestrictionInformation ||\n      this.state.errorOnGetRestrictionInformation\n    ) {\n      return\n    }\n    this.getRestrictionInformation(forceRefresh)\n    this.getFileEntityFileHandle(forceRefresh)\n  }\n\n  updateStateFileHandleAccessBlocked = () => {\n    const { token } = this.props\n    const fileHandleDownloadType = token\n      ? FileHandleDownloadTypeEnum.AccessBlockedByACL\n      : FileHandleDownloadTypeEnum.AccessBlockedToAnonymous\n    this.setState({\n      fileHandleDownloadType,\n    })\n  }\n\n  getFileEntityFileHandle = (forceRefresh?: boolean) => {\n    const {\n      entityId,\n      entityVersionNumber,\n      token,\n      isInDownloadList,\n      fileHandle,\n    } = this.props\n\n    if (this.state.fileHandleDownloadType && !forceRefresh) {\n      // already know the downloadType\n      return\n    }\n    if (fileHandle) {\n      const fileHandleDownloadType = getDownloadTypeForFileHandle(\n        fileHandle,\n        isInDownloadList,\n      )\n      this.setState({\n        fileHandleDownloadType,\n      })\n      return\n    }\n    this.setState({\n      isGettingEntityInformation: true,\n    })\n    // fileHandle was not passed to us, ask for it.\n    // is this a FileEntity?\n    return SynapseClient.getEntity(token, entityId, entityVersionNumber)\n      .then(entity => {\n        if (entity.hasOwnProperty('dataFileHandleId')) {\n          // looks like a FileEntity, get the FileHandle\n          return SynapseClient.getFileEntityFileHandle(\n            entity as FileEntity,\n            token,\n          ).then((fileHandle: FileHandle) => {\n            const fileHandleDownloadType = getDownloadTypeForFileHandle(\n              fileHandle,\n              isInDownloadList,\n            )\n            this.setState({\n              fileHandleDownloadType,\n              isGettingEntityInformation: false,\n            })\n          })\n        } else {\n          // entity looks like something else.\n          this.setState({\n            fileHandleDownloadType: FileHandleDownloadTypeEnum.NoFileHandle,\n            isGettingEntityInformation: false,\n          })\n          return Promise.resolve()\n        }\n      })\n      .catch(err => {\n        // this could be a self-imposed error or one from the backend, only log the latter\n        if (err.reason) {\n          console.error('Error on get Entity = ', err)\n        }\n        // could not get entity\n        this.updateStateFileHandleAccessBlocked()\n        this.setState({\n          isGettingEntityInformation: false,\n        })\n      })\n  }\n\n  getRestrictionInformation = (forceRefresh?: boolean) => {\n    const { entityId, token } = this.props\n    if (this.state.restrictionInformation && !forceRefresh) {\n      return\n    }\n    this.setState({\n      isGettingRestrictionInformation: true,\n    })\n    const request: RestrictionInformationRequest = {\n      restrictableObjectType: RestrictableObjectType.ENTITY,\n      objectId: entityId,\n    }\n    return SynapseClient.getRestrictionInformation(request, token)\n      .then(restrictionInformation => {\n        this.setState({\n          restrictionInformation,\n        })\n      })\n      .catch(err => {\n        console.error(\n          'Error on getRestrictionInformation. This should not happen: ',\n          err,\n        )\n        this.setState({\n          errorOnGetRestrictionInformation: true,\n        })\n      })\n      .finally(() => {\n        this.setState({\n          isGettingRestrictionInformation: false,\n        })\n      })\n  }\n\n  renderIconHelper = (iconProp: IconProp, classColor: string) => {\n    return (\n      <span className=\"fa-layers fa-fw\">\n        <FontAwesomeIcon\n          icon={faCircle}\n          className={classColor}\n          size=\"1x\"\n          style={{ fontSize: '24px' }}\n        />\n        <FontAwesomeIcon\n          icon={iconProp}\n          className=\"SRC-whiteText\"\n          size=\"1x\"\n          transform={{ x: 5 }}\n          style={{ fontSize: '13px' }}\n        />\n      </span>\n    )\n  }\n\n  renderIcon = (\n    downloadType: FileHandleDownloadTypeEnum | string,\n    restrictionInformation?: RestrictionInformationResponse,\n  ) => {\n    // if there are any access restrictions\n    if (restrictionInformation?.hasUnmetAccessRequirement) {\n      return this.renderIconHelper(faLock, 'SRC-warning-color')\n    }\n    switch (downloadType) {\n      // fileHandle available\n      case FileHandleDownloadTypeEnum.ExternalFileLink:\n      case FileHandleDownloadTypeEnum.ExternalCloudFile:\n        return this.renderIconHelper(faLink, 'SRC-warning-color')\n      case FileHandleDownloadTypeEnum.TooLarge:\n        return this.renderIconHelper(faDatabase, 'SRC-danger-color')\n      // was FileEntity, but no fileHandle was available\n      case FileHandleDownloadTypeEnum.AccessBlockedByACL:\n      case FileHandleDownloadTypeEnum.AccessBlockedToAnonymous:\n        return this.renderIconHelper(faLock, 'SRC-warning-color')\n      // was a FileEntity, and fileHandle was available\n      case FileHandleDownloadTypeEnum.Accessible:\n      // or was not a FileEntity, but no unmet access restrictions\n      case FileHandleDownloadTypeEnum.NoFileHandle:\n        return this.renderIconHelper(faUnlockAlt, 'SRC-success-color')\n      default:\n        // nothing is rendered until access requirement is loaded\n        return <></>\n    }\n  }\n\n  handleGetAccess = () => {\n    const { token, entityId, set_arPropsFromHasAccess } = this.props\n    SynapseClient.getAllAccessRequirements(token, entityId).then(\n      requirements => {\n        if (checkHasUnsportedRequirement(requirements)) {\n          window.open(\n            `${getEndpoint(\n              BackendDestinationEnum.PORTAL_ENDPOINT,\n            )}#!AccessRequirements:ID=${entityId}&TYPE=ENTITY`,\n            '_blank',\n          )\n        } else {\n          if (set_arPropsFromHasAccess) {\n            set_arPropsFromHasAccess({\n              accessRequirementFromProps: requirements,\n              entityId,\n            })\n          } else {\n            this.setState({\n              accessRequirements: requirements,\n              displayAccessRequirement: true,\n            })\n          }\n        }\n      },\n    )\n  }\n\n  // Show Access Requirements\n  renderARsLink = () => {\n    const { entityId, token } = this.props\n    const {\n      restrictionInformation,\n      displayAccessRequirement,\n      accessRequirements,\n    } = this.state\n    if (!restrictionInformation) {\n      // loading\n      return <></>\n    }\n    const hasUnmetAccessRequirement =\n      restrictionInformation?.hasUnmetAccessRequirement\n    const restrictionLevel = restrictionInformation?.restrictionLevel\n    let linkText = ''\n\n    if (hasUnmetAccessRequirement) {\n      linkText = 'Request Access'\n    } else if (RestrictionLevel.OPEN === restrictionLevel) {\n      // they need to sign in\n      return <></>\n    } else {\n      linkText = 'View Terms'\n    }\n    return (\n      <>\n        <button\n          style={{\n            fontSize: '14px',\n            cursor: 'pointer',\n            marginLeft: '10px',\n          }}\n          onClick={this.handleGetAccess}\n          className=\"SRC-primary-text-color\"\n        >\n          {linkText}\n        </button>\n        {displayAccessRequirement && (\n          <AccessRequirementList\n            token={token}\n            entityId={entityId}\n            accessRequirementFromProps={accessRequirements}\n            renderAsModal={true}\n            onHide={() => {\n              this.setState({ displayAccessRequirement: false })\n              this.refresh()\n            }}\n          />\n        )}\n      </>\n    )\n  }\n\n  render() {\n    const { restrictionInformation, fileHandleDownloadType } = this.state\n    if (typeof fileHandleDownloadType === 'undefined') {\n      // note, this can't be \"if (!downloadType)\" since DownloadTypeEnum has a 0 value (which is falsy)\n      // loading\n      return <></>\n    }\n    let tooltipText = HasAccess.tooltipText[fileHandleDownloadType]\n    if (\n      fileHandleDownloadType ===\n        FileHandleDownloadTypeEnum.AccessBlockedByACL &&\n      restrictionInformation?.hasUnmetAccessRequirement\n    ) {\n      // If blocked by ACL check if blocked by Access Restrictions, those can be taken care of\n      // though they will then be blocked by ACL afterwards.\n      tooltipText =\n        HasAccess.tooltipText[\n          FileHandleDownloadTypeEnum.AccessBlockedByRestriction\n        ]\n    }\n    const entityId = this.props.entityId\n    const icon = this.renderIcon(fileHandleDownloadType, restrictionInformation)\n    const viewARsLink: React.ReactElement = this.renderARsLink()\n    const iconContainer =\n      fileHandleDownloadType ===\n      FileHandleDownloadTypeEnum.AccessBlockedToAnonymous ? (\n        <button\n          type=\"button\"\n          className={SRC_SIGN_IN_CLASS}\n          onClick={ev => {\n            if (ev.isTrusted) {\n              /*\n                There is a tricky problem - \n                The portals listens to click events for buttons with the class SRC_SIGN_IN_CLASS set, it listens to this event\n                so that it can display the login modal.\n\n                This button has an svg inside of it which is problematic because more often than not clicking this button will \n                instead click that svg. The event listener in the portals will break as a result.\n\n                Though the svg may get the actual click event, because of event bubbling this button will get its onClick called.\n                Once onClick is called we can manually dispatch an event off of this button. This does pose a problem, we end up in a \n                infinite loop because this button keeps disptaching click events, so we can use the isTrusted to recognize if onClick was\n                triggered programmatically or by user click. Lastly, using { bubbles: true } ensures the event bubbles up to the document level.\n\n              */\n              const clickEvent = new MouseEvent('click', { bubbles: true })\n              ev.currentTarget.dispatchEvent(clickEvent)\n            }\n          }}\n        >\n          {icon}\n        </button>\n      ) : (\n        <span tabIndex={0} data-for={entityId} data-tip={tooltipText}>\n          {icon}\n        </span>\n      )\n\n    return (\n      <span style={{ whiteSpace: 'nowrap' }}>\n        {tooltipText && (\n          <>\n            {iconContainer}\n            <ReactTooltip\n              delayShow={TOOLTIP_DELAY_SHOW}\n              place=\"top\"\n              type=\"dark\"\n              effect=\"solid\"\n              id={entityId}\n              className=\"has-access-tooltip-width\"\n            />\n            {viewARsLink}\n          </>\n        )}\n        {!tooltipText && (\n          <>\n            {icon} {viewARsLink}\n          </>\n        )}\n      </span>\n    )\n  }\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCheck,\n  faDownload,\n  faFolder,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport React, { useState } from 'react'\nimport * as ReactBoostrap from 'react-bootstrap'\nimport {\n  getBulkFiles,\n  getDownloadOrder,\n  getFileHandleByIdURL,\n} from '../../utils/SynapseClient'\nimport {\n  BulkFileDownloadRequest,\n  BulkFileDownloadResponse,\n  FileDownloadStatus,\n  ZipFileFormat,\n} from '../../utils/synapseTypes/'\n\nlibrary.add(faCheck)\nlibrary.add(faDownload)\nlibrary.add(faFolder)\n\nexport type CreatePackageProps = {\n  token?: string\n  children?: JSX.Element\n  updateDownloadList: Function\n}\n\ntype Alert = {\n  message: string\n  variant: ReactBoostrap.AlertProps['variant']\n  className: string | undefined\n}\n\nexport const TEMPLATE_DOWNLOAD_MESSAGE =\n  'files were downloaded and removed from the list.'\nexport const TEMPLATE_ERROR_FILE_NAME =\n  'Please provide a package file name and try again.'\n\nexport const CreatePackage = (props: CreatePackageProps) => {\n  const [isLoading, setIsLoading] = useState(false)\n  const [fileName, setZipFileName] = useState('')\n  const [alert, setAlert] = useState<Alert>({\n    message: '',\n    className: undefined,\n    variant: undefined,\n  })\n  const [bulkFileDownloadResponse, setBulkFileDownloadResponse] = useState<\n    BulkFileDownloadResponse | undefined\n  >(undefined)\n  const { token, children, updateDownloadList } = props\n\n  const createPackageHandler = async (event: React.SyntheticEvent) => {\n    event.preventDefault()\n    if (!fileName) {\n      setAlert({\n        message: TEMPLATE_ERROR_FILE_NAME,\n        variant: 'danger',\n        className: undefined,\n      })\n      return\n    }\n    setAlert({ message: '', variant: undefined, className: undefined })\n    setIsLoading(true)\n    try {\n      const fileNameWithZipExtension = `${fileName}.zip`\n      const downloadOrder = await getDownloadOrder(\n        fileNameWithZipExtension,\n        token,\n      )\n      const bulkFileDownloadRequest: BulkFileDownloadRequest = {\n        concreteType:\n          'org.sagebionetworks.repo.model.file.BulkFileDownloadRequest',\n        requestedFiles: downloadOrder.files,\n        zipFileName: fileNameWithZipExtension,\n        zipFileFormat: ZipFileFormat.Flat,\n      }\n      const bulkFileDownloadResponse: BulkFileDownloadResponse = await getBulkFiles(\n        bulkFileDownloadRequest,\n        token,\n      )\n      setBulkFileDownloadResponse(bulkFileDownloadResponse)\n    } catch (err) {\n      setAlert({\n        message: err.reason,\n        variant: 'danger',\n        className: undefined,\n      })\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const downloadPackageHandler = async () => {\n    const { resultZipFileHandleId, fileSummary } = bulkFileDownloadResponse!\n    try {\n      const numfilesDownloaded = fileSummary.filter(\n        el => el.status === FileDownloadStatus.SUCCESS,\n      ).length\n      setAlert({\n        message: `${numfilesDownloaded} ${TEMPLATE_DOWNLOAD_MESSAGE}`,\n        className: 'SRC-primary-background-color SRC-whiteText',\n        variant: undefined,\n      })\n      const url = await getFileHandleByIdURL(resultZipFileHandleId, token)\n      window.location.href = url\n      updateDownloadList()\n      setBulkFileDownloadResponse(undefined)\n    } catch (err) {\n      console.error('Err on getFileHandleByIdURL = ', err)\n    }\n  }\n\n  const onChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    setZipFileName(event.currentTarget.value)\n  }\n\n  return (\n    <>\n      {alert.message && (\n        <ReactBoostrap.Alert\n          transition={false}\n          variant={alert.variant}\n          show={true}\n          className={alert.className}\n        >\n          {alert.message}\n        </ReactBoostrap.Alert>\n      )}\n      <div className=\"create-package-container\">\n        {children}\n        <div>\n          {isLoading && (\n            <span className=\"SRC-centerContentInline\">\n              <span className=\"spinner\" />\n              <span style={{ marginLeft: 5 }} className=\"create-package-text\">\n                Creating package...\n              </span>\n            </span>\n          )}\n          <div className=\"SRC-split\">\n            {!isLoading && !bulkFileDownloadResponse && (\n              <>\n                <form onSubmit={createPackageHandler}>\n                  <input\n                    onChange={onChange}\n                    type=\"text\"\n                    placeholder=\"PackageFileName\"\n                  ></input>\n                  <span className=\"zip-extension SRC-boldText\">.zip</span>\n                </form>\n                <button\n                  className=\"SRC-standard-button-shape SRC-primary-button action-button\"\n                  onClick={createPackageHandler}\n                  type=\"button\"\n                >\n                  <FontAwesomeIcon icon=\"folder\" />\n                  Create Package\n                </button>\n              </>\n            )}\n            {bulkFileDownloadResponse && (\n              <>\n                <div className=\"package-created\">\n                  <FontAwesomeIcon icon=\"check\" color=\"green\" />\n                  <span className=\"create-package-text\">\n                    Package created! Ready for download.\n                  </span>\n                </div>\n                <button\n                  className=\"SRC-standard-button-shape SRC-primary-button action-button\"\n                  onClick={downloadPackageHandler}\n                >\n                  <FontAwesomeIcon icon=\"download\" color=\"white\" />\n                  Download Package\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faTrash } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport moment from 'moment'\nimport React, { useEffect, useState, useCallback } from 'react'\nimport * as ReactBootstrap from 'react-bootstrap'\nimport { calculateFriendlyFileSize } from '../../utils/functions/calculateFriendlyFileSize'\nimport useGetInfoFromIds from '../../utils/hooks/useGetInfoFromIds'\nimport {\n  deleteDownloadList,\n  deleteDownloadListFiles,\n  getDownloadList,\n  getEntityHeader,\n  getFiles,\n} from '../../utils/SynapseClient'\nimport {\n  BatchFileRequest,\n  BatchFileResult,\n  DownloadList,\n  EntityHeader,\n  FileHandleAssociateType,\n  FileHandleAssociation,\n  PaginatedResults,\n  Reference,\n  UserProfile,\n} from '../../utils/synapseTypes'\nimport HasAccess, {\n  getDownloadTypeForFileHandle,\n  FileHandleDownloadTypeEnum,\n} from '../HasAccess'\nimport UserCard from '../UserCard'\nimport { CreatePackage } from './CreatePackage'\nimport DownloadDetails from './DownloadDetails'\nimport AccessRequirementList, {\n  AccessRequirementListProps,\n} from '../access_requirement_list/AccessRequirementList'\n\nimport {\n  faSortAmountDown,\n  faSortAmountUp,\n} from '@fortawesome/free-solid-svg-icons'\n\nlibrary.add(faTrash)\n\ntype DownloadListTableData = {\n  references?: PaginatedResults<EntityHeader>\n  batchFileResult?: BatchFileResult\n  downloadList?: DownloadList\n}\n\ntype LoadingState = boolean\nexport type DownloadListTableProps = {\n  token?: string\n  listUpdatedCallback?: VoidFunction\n  forceSamePage?: boolean\n  renderAsModal?: boolean\n  onHide?: Function\n}\n\nexport const TESTING_TRASH_BTN_CLASS = 'TESTING_TRASH_BTN_CLASS'\nexport const TESTING_CLEAR_BTN_CLASS = 'TESTING_CLEAR_BTN_CLASS'\n\nexport default function DownloadListTable(props: DownloadListTableProps) {\n  // https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables\n  const [data, setData] = useState<DownloadListTableData>({\n    references: undefined,\n    batchFileResult: undefined,\n    downloadList: undefined,\n  })\n\n  type SortedColumn = {\n    column: string\n    isDescending: boolean\n  }\n\n  const [sortedColumn, setSortedColumn] = useState<SortedColumn>({\n    column: '',\n    isDescending: false,\n  })\n\n  const [arPropsFromHasAccess, set_arPropsFromHasAccess] = useState<\n    AccessRequirementListProps | undefined\n  >()\n  // https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables\n  const [isLoading, setIsLoading] = useState<LoadingState>(true)\n  const [fileBeingDeleted, setFileBeingDeleted] = useState<string>('')\n  const { token } = props\n  const {\n    forceSamePage = false,\n    renderAsModal = false,\n    onHide,\n    listUpdatedCallback,\n  } = props\n  const { references, batchFileResult, downloadList } = data\n  const requestedFiles =\n    (batchFileResult && batchFileResult.requestedFiles) || []\n  // Get owner ids from download list by filtering to items that have a file handle\n  // then map to ownerIds\n  const ownerIdsFromHeaders = references?.results\n    .filter(el => el.createdBy)\n    .map(el => el.createdBy)\n  const ownerIdsFromFileHandles = requestedFiles\n    .filter(el => el.fileHandle?.createdBy !== undefined)\n    .map(el => el.fileHandle!.createdBy)\n\n  const ownerIds: string[] = []\n  if (ownerIdsFromFileHandles) {\n    ownerIds.push(...ownerIdsFromFileHandles)\n  }\n  if (ownerIdsFromHeaders) {\n    ownerIds.push(...ownerIdsFromHeaders)\n  }\n  // use bang operator because filter function guarentee's that file handle will be defined\n  const userProfiles = useGetInfoFromIds<UserProfile>({\n    ids: ownerIds,\n    token,\n    type: 'USER_PROFILE',\n  })\n\n  const fetchData = useCallback(async () => {\n    if (!token) {\n      setIsLoading(false)\n      // doesn't make sense with anonymous user!\n      return\n    }\n    try {\n      setIsLoading(true)\n      const downloadList = await getDownloadList(token)\n      const { filesToDownload } = downloadList\n      if (filesToDownload.length === 0) {\n        setData({\n          downloadList,\n        })\n        return\n      }\n      const batchFileRequest: BatchFileRequest = {\n        requestedFiles: filesToDownload,\n        includeFileHandles: true,\n        includePreSignedURLs: false,\n        includePreviewPreSignedURLs: false,\n      }\n      // batch file result gives FilesHandle for the files the user can download\n      // which has additional metadata - createdBy, numBytes, etc.\n      const batchFileResult = await getFiles(batchFileRequest, token)\n\n      // Only make entity header calls to the files that the user doesn't have access to,\n      // which can be determined by whether the batchFileResult has a failure code for the\n      // corresponding download list item\n      const referenceCall: Reference[] = filesToDownload\n        .filter(el => {\n          return (\n            batchFileResult.requestedFiles.find(\n              batchFile => batchFile.fileHandleId === el.fileHandleId,\n            )!.failureCode !== undefined\n          )\n        })\n        .map(el => {\n          return { targetId: el.associateObjectId }\n        })\n      // entity header is used to get the names of the files that the user\n      // doesn't have access to\n      const references = await getEntityHeader(referenceCall, token)\n      setData({\n        references,\n        batchFileResult,\n        downloadList,\n      })\n    } catch (e) {\n      console.error('Error in DownloadList API call : ', e)\n    } finally {\n      setIsLoading(false)\n    }\n  }, [token])\n\n  useEffect(() => {\n    fetchData()\n  }, [fetchData])\n\n  const clearDownloadList = async (\n    _event: React.SyntheticEvent<HTMLButtonElement>,\n  ) => {\n    setIsLoading(true)\n    try {\n      await deleteDownloadList(token)\n      setData({\n        downloadList: undefined,\n      })\n      listUpdatedCallback?.()\n    } catch (err) {\n      console.error('Error on clearing download list: ', err)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const deleteFileFromList = async (\n    fileHandleId: string,\n    associateObjectId: string,\n  ) => {\n    const list: FileHandleAssociation[] = [\n      {\n        fileHandleId,\n        associateObjectId,\n        associateObjectType: FileHandleAssociateType.FileEntity,\n      },\n    ]\n    setIsLoading(true)\n\n    setFileBeingDeleted(fileHandleId)\n    try {\n      const downloadList = await deleteDownloadListFiles(list, token)\n      // The current references and batchFileResult can be kept because the download\n      // list drives the view, so the stale values in those two won't be viewed.\n      setData({ downloadList, references, batchFileResult })\n      listUpdatedCallback?.()\n    } catch (err) {\n      console.error('Error on delete from download list', err)\n    } finally {\n      setFileBeingDeleted('')\n      setIsLoading(false)\n    }\n  }\n\n  const sortColumn = async (column: string) => {\n    try {\n      setIsLoading(true)\n\n      const isDescending =\n        column === sortedColumn.column ? !sortedColumn.isDescending : false\n\n      setSortedColumn({\n        column,\n        isDescending,\n      })\n\n      const filesToDownload = downloadList?.filesToDownload ?? []\n\n      filesToDownload.sort((itemA, itemB) => {\n        return sortDownLoadList(itemA, itemB, column, isDescending)\n      })\n      setData({\n        ...data,\n        downloadList,\n      })\n      listUpdatedCallback?.()\n    } catch (err) {\n      console.error(err)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n  const getFileHandleInfo = (item: FileHandleAssociation) => {\n    const fileResult = requestedFiles.find(\n      fileRes => fileRes.fileHandleId === item.fileHandleId,\n    )\n    const fileHandle = fileResult ? fileResult.fileHandle : undefined\n\n    let fileName: string | undefined = ''\n    let createdBy: string | undefined = ''\n    let createdOn: string | undefined = ''\n    let contentSize: number | undefined = undefined\n\n    if (fileHandle && item) {\n      fileName = fileHandle.fileName\n      createdBy = fileHandle.createdBy\n      createdOn = fileHandle.createdOn\n      contentSize = fileHandle.contentSize\n    } else {\n      const requestedFile = results.find(\n        req => req.id === item.associateObjectId,\n      )\n      if (requestedFiles) {\n        fileName = requestedFile?.name\n        createdBy = requestedFile?.createdBy\n        createdOn = requestedFile?.createdOn\n      }\n    }\n    createdBy = userProfiles.find(el => el.ownerId === createdBy)?.userName\n\n    return { fileName, createdBy, createdOn, contentSize }\n  }\n\n  const sortDownLoadList = (\n    itemA: FileHandleAssociation,\n    itemB: FileHandleAssociation,\n    column: string,\n    isDescending: boolean,\n  ) => {\n    const {\n      fileName: fileName_A,\n      createdBy: createdBy_A,\n      createdOn: createdOn_A,\n      contentSize: contentSize_A,\n    } = getFileHandleInfo(itemA)\n\n    const {\n      fileName: fileName_B,\n      createdBy: createdBy_B,\n      createdOn: createdOn_B,\n      contentSize: contentSize_B,\n    } = getFileHandleInfo(itemB)\n\n    const direction = isDescending ? 1 : -1\n\n    switch (column) {\n      case 'file':\n        return fileName_B?.localeCompare(fileName_A!)! * direction\n      case 'createdBy':\n        return createdBy_B?.localeCompare(createdBy_A!)! * direction\n      case 'createdOn':\n        return createdOn_B?.localeCompare(createdOn_A!)! * direction\n      case 'size':\n        if (contentSize_A && !contentSize_B) {\n          return -1\n        } else if (contentSize_B && !contentSize_A) {\n          return 1\n        } else {\n          return (contentSize_B! - contentSize_A!) * direction\n        }\n      default:\n        return 1\n    }\n  }\n\n  const filesToDownload = downloadList?.filesToDownload ?? []\n  const results = references?.results ?? []\n  let numBytes = 0\n  let numFiles = 0\n  const content = (\n    <div className=\"DownloadListTable\">\n      <div style={{ display: arPropsFromHasAccess ? 'none' : '' }}>\n        <div className=\"SRC-split download-list-table-top SRC-primary-background-color SRC-border-bottom-only\">\n          <span className=\"create-package-text\">\n            Download List &nbsp;&nbsp;\n            {isLoading && <span className=\"spinner\" />}\n          </span>\n          <button\n            className=\"SRC-underline-on-hover uppercase-text\"\n            onClick={clearDownloadList}\n            id={TESTING_CLEAR_BTN_CLASS}\n          >\n            Clear list\n          </button>\n        </div>\n        <ReactBootstrap.Table striped={true} responsive={true}>\n          <thead>\n            <tr>\n              <th>\n                File\n                <button\n                  className={`sort SRC-primary-background-color-hover ${\n                    sortedColumn.column === 'file'\n                      ? 'SRC-primary-background-color'\n                      : ''\n                  }`}\n                  onClick={() => {\n                    sortColumn('file')\n                  }}\n                >\n                  <FontAwesomeIcon\n                    icon={\n                      sortedColumn.column === 'file'\n                        ? sortedColumn.isDescending === false\n                          ? faSortAmountDown\n                          : faSortAmountUp\n                        : faSortAmountDown\n                    }\n                    color={sortedColumn.column === 'file' ? 'white' : ''}\n                  />\n                </button>\n              </th>\n              <th>Access</th>\n              <th>\n                Created By\n                <button\n                  className={`sort SRC-primary-background-color-hover ${\n                    sortedColumn.column === 'createdBy'\n                      ? 'SRC-primary-background-color'\n                      : ''\n                  }`}\n                  onClick={() => {\n                    sortColumn('createdBy')\n                  }}\n                >\n                  <FontAwesomeIcon\n                    icon={\n                      sortedColumn.column === 'createdBy'\n                        ? sortedColumn.isDescending === false\n                          ? faSortAmountDown\n                          : faSortAmountUp\n                        : faSortAmountDown\n                    }\n                    color={sortedColumn.column === 'createdBy' ? 'white' : ''}\n                  />\n                </button>\n              </th>\n              <th>\n                Created On\n                <button\n                  className={`sort SRC-primary-background-color-hover ${\n                    sortedColumn.column === 'createdOn'\n                      ? 'SRC-primary-background-color'\n                      : ''\n                  }`}\n                  onClick={() => {\n                    sortColumn('createdOn')\n                  }}\n                >\n                  <FontAwesomeIcon\n                    icon={\n                      sortedColumn.column === 'createdOn'\n                        ? sortedColumn.isDescending === false\n                          ? faSortAmountDown\n                          : faSortAmountUp\n                        : faSortAmountDown\n                    }\n                    color={sortedColumn.column === 'createdOn' ? 'white' : ''}\n                  />\n                </button>\n              </th>\n              <th>\n                Size\n                <button\n                  className={`sort SRC-primary-background-color-hover ${\n                    sortedColumn.column === 'size'\n                      ? 'SRC-primary-background-color'\n                      : ''\n                  }`}\n                  onClick={() => {\n                    sortColumn('size')\n                  }}\n                >\n                  <FontAwesomeIcon\n                    icon={\n                      sortedColumn.column === 'size'\n                        ? sortedColumn.isDescending === false\n                          ? faSortAmountDown\n                          : faSortAmountUp\n                        : faSortAmountDown\n                    }\n                    color={sortedColumn.column === 'size' ? 'white' : ''}\n                  />\n                </button>\n              </th>\n              {/* th below is made for trash can icon but holds no content */}\n              <th />\n            </tr>\n          </thead>\n          <tbody className=\"download-list-table\">\n            {filesToDownload.map(item => {\n              let createdBy: string | undefined = ''\n              let createdOn: string | undefined = ''\n              let fileName: string | undefined = ''\n              let contentSize = undefined\n              const synId = item.associateObjectId\n              const fileHandleId = item.fileHandleId\n              const isCurrentlyBeingDeletedClass =\n                fileBeingDeleted === fileHandleId ? 'SRC-inactive-bg' : ''\n              // See if batch file results has this fileHandleId\n              const fileResult = requestedFiles.find(\n                fileRes => fileRes.fileHandleId === fileHandleId,\n              )\n              const fileHandle = fileResult?.fileHandle\n              const canDownload = fileHandle !== undefined\n              if (fileHandle) {\n                // fileHandle is defined, this file is downloadable, show its metadata\n                ;({ createdBy, createdOn, fileName, contentSize } = fileHandle)\n                if (\n                  getDownloadTypeForFileHandle(fileHandle) ===\n                  FileHandleDownloadTypeEnum.Accessible\n                ) {\n                  numBytes += contentSize\n                  numFiles += 1\n                }\n              } else {\n                // file is not downloadable, only show its name from entity header info\n                const requestedFile = results.find(\n                  req => req.id === item.associateObjectId,\n                )\n                fileName = requestedFile?.name\n                createdBy = requestedFile?.createdBy\n                createdOn = requestedFile?.createdOn\n              }\n              createdOn = moment(createdOn).format('L LT')\n              const userProfile = userProfiles.find(\n                el => el.ownerId === createdBy,\n              )\n              return (\n                <tr className={isCurrentlyBeingDeletedClass} key={fileHandleId}>\n                  <td>\n                    <a\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      href={`https://www.synapse.org/#!Synapse:${synId}`}\n                    >\n                      {fileName}\n                    </a>\n                  </td>\n                  <td>\n                    <HasAccess\n                      onHide={onHide}\n                      fileHandle={fileHandle}\n                      token={token}\n                      set_arPropsFromHasAccess={set_arPropsFromHasAccess}\n                      entityId={synId}\n                      isInDownloadList={true}\n                      forceSamePage={forceSamePage}\n                    />\n                  </td>\n                  <td>\n                    {userProfile && (\n                      <UserCard\n                        size={'SMALL USER CARD'}\n                        userProfile={userProfile}\n                        preSignedURL={userProfile.clientPreSignedURL}\n                        token={token}\n                        extraSmall={true}\n                      />\n                    )}\n                    {canDownload && !userProfile && (\n                      <span className=\"spinner\" />\n                    )}\n                  </td>\n                  <td>{createdOn}</td>\n                  <td>\n                    {contentSize && calculateFriendlyFileSize(contentSize)}\n                  </td>\n                  <td>\n                    <button\n                      className={TESTING_TRASH_BTN_CLASS}\n                      onClick={\n                        fileBeingDeleted === ''\n                          ? () => deleteFileFromList(fileHandleId, synId)\n                          : undefined\n                      }\n                    >\n                      <FontAwesomeIcon\n                        className=\"SRC-primary-text-color\"\n                        icon=\"trash\"\n                      />\n                    </button>\n                  </td>\n                </tr>\n              )\n            })}\n          </tbody>\n        </ReactBootstrap.Table>\n        <CreatePackage updateDownloadList={fetchData} token={token}>\n          <DownloadDetails\n            numBytes={numBytes}\n            numFiles={numFiles}\n            token={token}\n          />\n        </CreatePackage>\n      </div>\n      {arPropsFromHasAccess && (\n        <AccessRequirementList\n          {...arPropsFromHasAccess}\n          token={token}\n          onHide={() => {\n            set_arPropsFromHasAccess(undefined)\n          }}\n        />\n      )}\n    </div>\n  )\n\n  const onHideModal = useCallback(() => {\n    if (arPropsFromHasAccess) {\n      set_arPropsFromHasAccess(undefined)\n    } else {\n      onHide?.()\n    }\n  }, [arPropsFromHasAccess, onHide])\n\n  if (renderAsModal) {\n    const closeBtn: React.CSSProperties = {\n      position: 'absolute',\n      top: 5,\n      right: 20,\n      zIndex: 10,\n    }\n    \n    return (\n      <ReactBootstrap.Modal\n        centered={true}\n        animation={false}        \n        size={'lg'}\n        dialogClassName={'download-list-modal-container'}\n        show={true}\n      >\n        <ReactBootstrap.Modal.Header>\n          <button style={closeBtn} onClick={onHideModal}>\n            <FontAwesomeIcon style={{ fontSize: '21px' }} icon=\"times\" />\n          </button>\n        </ReactBootstrap.Modal.Header>\n        {content}\n      </ReactBootstrap.Modal>\n    )\n  } else {\n    return content\n  }\n}\n","import moment from 'moment'\nimport React, { useState } from 'react'\nimport { SynapseClient, SynapseConstants } from '../../utils'\nimport { testDownloadSpeed } from '../../utils/functions/testDownloadSpeed'\nimport {\n  AddFilesToDownloadListRequest,\n  Query,\n  QueryBundleRequest,\n} from '../../utils/synapseTypes/'\nimport DownloadDetails from './DownloadDetails'\nimport DownloadListTable from './DownloadListTable'\nimport useDeepCompareEffect from 'use-deep-compare-effect'\nimport { TopLevelControlsState, QueryWrapperState } from '../QueryWrapper'\nimport SignInButton from '../SignInButton'\n\nenum StatusEnum {\n  LOADING_INFO,\n  PROCESSING,\n  INFO,\n  SUCCESS,\n  ERROR,\n  SIGNED_OUT,\n}\n\nexport type DownloadConfirmationState = {\n  fileCount: number\n  fileSize: number\n  downloadEstimate?: string\n  status: StatusEnum\n  errorMessage?: string\n  ownerId?: string\n}\nexport type DownloadConfirmationProps = {\n  fnClose?: Function\n  token?: string\n  getLastQueryRequest?: () => QueryBundleRequest\n  topLevelControlsState?: TopLevelControlsState\n  updateParentState?: <K extends keyof QueryWrapperState>(\n    param: Pick<QueryWrapperState, K>,\n  ) => void\n  onExportTable?: () => void\n}\n\n// add files to download list\nasync function addToDownload(\n  query: Query,\n  token: string,\n): Promise<[StatusEnum, string]> {\n  const req: AddFilesToDownloadListRequest = {\n    concreteType:\n      'org.sagebionetworks.repo.model.file.AddFileToDownloadListRequest',\n    query: query,\n  }\n  try {\n    const result = await SynapseClient.addFilesToDownloadList(req, token)\n    const ownerId = result.downloadList.ownerId\n    return [StatusEnum.SUCCESS, ownerId]\n  } catch (error) {\n    return [StatusEnum.ERROR, error.reason]\n  }\n}\n\ntype UiStateDictionary = {\n  [key: string]: {\n    className: string\n    infoText: string | JSX.Element\n    closeText: string\n  }\n}\n\n// css classes, text, and close button text associated with different stages\nconst StatusConstruct: UiStateDictionary = {\n  [StatusEnum.INFO]: {\n    className: 'alert-info',\n    infoText: 'Would you like to add all files to the download list?',\n    closeText: 'Cancel',\n  },\n\n  [StatusEnum.PROCESSING]: {\n    className: 'alert-info',\n    infoText: 'Adding Files To List',\n    closeText: 'Cancel',\n  },\n\n  [StatusEnum.LOADING_INFO]: {\n    className: 'alert-info',\n    infoText: 'Calculating File Size',\n    closeText: 'Cancel',\n  },\n\n  [StatusEnum.ERROR]: {\n    className: 'alert-danger',\n    closeText: 'Close',\n    infoText: '',\n  },\n  [StatusEnum.SIGNED_OUT]: {\n    className: 'alert-danger',\n    closeText: 'Close',\n    infoText: (\n      <>\n        Please <SignInButton style={{ color: '#337ab7' }} /> to add files to\n        your download list.\n      </>\n    ),\n  },\n  [StatusEnum.SUCCESS]: {\n    className: 'alert-info',\n    closeText: 'Close',\n    infoText: '',\n  },\n}\n\n//============= DownloadConfirmation component =============\n\nexport const DownloadConfirmation: React.FunctionComponent<DownloadConfirmationProps> = ({\n  getLastQueryRequest,\n  token,\n  fnClose,\n  updateParentState,\n  topLevelControlsState,\n  onExportTable,\n}) => {\n  const { showDownloadConfirmation = true } = topLevelControlsState ?? {}\n  const [state, setState] = useState<DownloadConfirmationState>({\n    fileCount: 0,\n    fileSize: 0,\n    status: token ? StatusEnum.LOADING_INFO : StatusEnum.SIGNED_OUT,\n  })\n  const [showDownloadList, setShowDownloadList] = useState(false)\n  const queryBundleRequest = getLastQueryRequest!()\n\n  const getFilesInformation = async (\n    queryBundleRequest: QueryBundleRequest,\n    token: string,\n  ) => {\n    setState({\n      ...state,\n      status: StatusEnum.LOADING_INFO,\n    })\n\n    const partMask =\n      SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n      SynapseConstants.BUNDLE_MASK_SUM_FILES_SIZE_BYTES\n\n    const queryBundleRequestSizeInformation: QueryBundleRequest = {\n      ...queryBundleRequest,\n      partMask,\n    }\n\n    const {\n      queryCount,\n      sumFileSizes,\n    } = await SynapseClient.getQueryTableResults(\n      queryBundleRequestSizeInformation,\n      token,\n    )\n    const estimatedDownloadBytesPerSecond = await testDownloadSpeed(token)\n    const size = sumFileSizes ? sumFileSizes['sumFileSizesBytes'] : 0\n    const durationSeconds = size / estimatedDownloadBytesPerSecond\n    const duration = moment.duration(durationSeconds, 'seconds').humanize()\n    setState({\n      fileCount: queryCount || 0,\n      fileSize: size,\n      downloadEstimate: duration,\n      status: StatusEnum.INFO,\n    })\n  }\n\n  // UseEffect memoization only works for arguments where a direct === comparison can be made\n  // This fails drastically with the queryBundleRequest object which is a complex object of many fields that\n  // change, we could use a custom comparitor but this also introduces risk\n  useDeepCompareEffect(() => {\n    token && getFilesInformation(queryBundleRequest, token)\n  }, [queryBundleRequest, token])\n\n  const onCancel = fnClose\n    ? () => fnClose()\n    : () => {\n        updateParentState!({\n          topLevelControlsState: {\n            ...topLevelControlsState!,\n            showDownloadConfirmation: false,\n          },\n        })\n      }\n\n  const triggerAddToDownload = async () => {\n    if (!token) {\n      setState({ ...state, status: StatusEnum.SIGNED_OUT })\n      return\n    }\n    setState({ ...state, status: StatusEnum.PROCESSING })\n    const result = await addToDownload(queryBundleRequest.query, token)\n    const status = result[0]\n\n    if (status === StatusEnum.SUCCESS) {\n      setState({ ...state, ownerId: result[1], status })\n    } else {\n      setState({ ...state, errorMessage: result[1], status })\n    }\n  }\n\n  const getContent = (\n    { status, fileCount, fileSize, errorMessage }: DownloadConfirmationState,\n    token?: string,\n  ): JSX.Element => {\n    switch (status) {\n      case StatusEnum.LOADING_INFO:\n      case StatusEnum.PROCESSING:\n        return (\n          <div>\n            <span className={'spinner white'} />\n            <span className={'spinner__text'}>\n              {StatusConstruct[status].infoText}\n            </span>\n          </div>\n        )\n\n      case StatusEnum.SIGNED_OUT:\n        return <>{StatusConstruct[status].infoText}</>\n      case StatusEnum.ERROR:\n        return <>{errorMessage}</>\n\n      case StatusEnum.INFO:\n        return (\n          <>\n            <DownloadDetails\n              token={token}\n              numFiles={fileCount}\n              numBytes={fileSize}\n            ></DownloadDetails>\n            <span>{StatusConstruct[status].infoText}</span>\n          </>\n        )\n\n      case StatusEnum.SUCCESS:\n        return (\n          <span>\n            <button\n              className=\"test-view-downloadlist btn-link\"\n              onClick={() => setShowDownloadList(true)}\n            >\n              View Download List\n            </button>\n            \n            {onExportTable && <span>\n                or \n                <button\n                  className=\"test-download-metadata btn-link\"\n                  onClick={onExportTable}\n                >\n                  Download File Metadata\n                </button>\n              </span>\n            }\n          </span>\n        )\n\n      default:\n        return <></>\n    }\n  }\n\n  return (\n    <>\n      <div\n        className={`alert download-confirmation ${\n          StatusConstruct[state.status].className\n        } ${showDownloadConfirmation ? '' : 'hidden'}`}\n      >\n        <div>{getContent(state, token)}</div>\n        <div className=\"download-confirmation-action\">\n          {state.status !== StatusEnum.PROCESSING && (\n            <button className=\"btn btn-link\" onClick={onCancel}>\n              {StatusConstruct[state.status].closeText}\n            </button>\n          )}\n\n          {state.status === StatusEnum.INFO && (\n            <button\n              type=\"button\"\n              className=\"btn btn-primary\"\n              onClick={triggerAddToDownload}\n            >\n              Add\n            </button>\n          )}\n        </div>\n      </div>\n      {showDownloadList && (\n        <DownloadListTable\n          token={token}\n          renderAsModal={true}\n          onHide={() => setShowDownloadList(false)}\n        />\n      )}\n    </>\n  )\n}\n","import { Modal, ModalBody, ModalFooter, Button } from 'react-bootstrap'\nimport ModalHeader from 'react-bootstrap/ModalHeader'\nimport React from 'react'\n\nexport type DownloadLoginModalProps = {\n  showModal?: boolean\n  onHide: Function\n}\n\nexport const DownloadLoginModal: React.FunctionComponent<DownloadLoginModalProps> = props => {\n  return (\n    <Modal animation={false} show={true} onHide={() => props.onHide()}>\n      <ModalHeader closeButton>\n        <span\n          style={{ fontWeight: 'bold', color: '#515359', fontSize: '1.5em' }}\n        >\n          Sign In Required\n        </span>\n      </ModalHeader>\n      <ModalBody>\n        <p>\n          Anyone can browse public content on the Synapse website, but in order\n          to download and create content you will need to register for an\n          account using an email address.\n        </p>\n        <p>\n          To find out more see&nbsp;\n          <a\n            href=\"https://docs.synapse.org/articles/user_profiles.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            User Accounts\n          </a>\n          <span> and </span>\n          <a\n            href=\"https://docs.synapse.org/articles/governance.html\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            Governance Overview\n          </a>\n          .\n        </p>\n      </ModalBody>\n      <ModalFooter>\n        <Button variant=\"secondary\" onClick={() => props.onHide()}>\n          CANCEL\n        </Button>\n        <Button\n          className=\"SRC-primary-button SRC-SIGN-IN-CLASS\"\n          variant=\"primary\"\n          onClick={() => props.onHide()}\n        >\n          Sign in\n        </Button>\n      </ModalFooter>\n    </Modal>\n  )\n}\n","import * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\nimport { DownloadLoginModal } from './DownloadLoginModal'\n\ntype EllipsisDropdownProps = {\n  onDownloadFiles: Function\n  onDownloadTableOnly: Function\n  onShowColumns: Function\n  onFullScreen: Function\n  isExpanded: boolean\n  isUnauthenticated?: boolean\n  isGroupedQuery?: boolean\n  isFileView?: boolean\n}\nconst tooltipEllipsis = 'tooltip-ellipsis'\n\nexport const EllipsisDropdown: React.FunctionComponent<EllipsisDropdownProps> = props => {\n  const {\n    onDownloadFiles,\n    onDownloadTableOnly,\n    onShowColumns,\n    onFullScreen,\n    isExpanded,\n  } = props\n  const [showModal, setShowModal] = React.useState(false)\n  return (\n    <>\n      <Dropdown as=\"span\">\n        <ElementWithTooltip\n          idForToolTip={tooltipEllipsis}\n          tooltipText={'Table Options'}\n          size=\"lg\"\n          icon={\"verticaldots\"}\n          className={\"icon-vertical-dots\"}\n        />\n        <Dropdown.Menu\n          className=\"SRC-primary-color-hover-dropdown\"\n          alignRight={true}\n        >\n          {!props.isGroupedQuery && [\n            props.isFileView && (\n              <Dropdown.Item\n                key=\"download_files\"\n                onClick={() =>\n                  props.isUnauthenticated\n                    ? setShowModal(true)\n                    : onDownloadFiles()\n                }\n              >\n                Download Files\n              </Dropdown.Item>\n            ),\n            <Dropdown.Item\n              key=\"download_tables\"\n              onClick={() => onDownloadTableOnly()}\n            >\n              Download Table Only\n            </Dropdown.Item>,\n            <Dropdown.Divider key=\"divider1\" />,\n          ]}\n          <Dropdown.Item key=\"ColumnSelection\" onClick={() => onShowColumns()}>\n            Add/Remove Columns\n          </Dropdown.Item>\n          <Dropdown.Item key=\"expand\" onClick={() => onFullScreen()}>\n            {isExpanded ? 'Shrink' : 'Full Screen'}\n          </Dropdown.Item>\n        </Dropdown.Menu>\n      </Dropdown>\n      {showModal && (\n        <DownloadLoginModal\n          showModal={showModal}\n          onHide={() => setShowModal(false)}\n        ></DownloadLoginModal>\n      )}\n    </>\n  )\n}\n","import * as React from 'react'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\n\ntype ExpandTableProps = {\n  onExpand: Function\n  isExpanded: boolean\n}\n\nexport const ExpandTable: React.FunctionComponent<ExpandTableProps> = props => {\n  const { onExpand, isExpanded } = props\n\n  return (\n    <ElementWithTooltip\n      idForToolTip={'expand'}\n      callbackFn={() => onExpand()}\n      tooltipText={\n        isExpanded ? 'Shrink table to fit' : 'Expand table in full screen'\n      }\n      size=\"lg\"\n      icon={isExpanded ? \"collapse\": \"expand\"}\n    />\n  )\n}\n","import React, { useState } from 'react'\nimport {\n  QueryBundleRequest,\n  QueryResultBundle,\n} from '../../../utils/synapseTypes'\nimport { TransformSqlWithFacetsRequest } from '../../../utils/synapseTypes/Table/TransformSqlWithFacetsRequest'\nimport useDeepCompareEffect from 'use-deep-compare-effect'\nimport { getTransformSqlWithFacetsRequest } from '../../../utils/SynapseClient'\nimport { Modal, ModalBody } from 'react-bootstrap'\nimport ModalHeader from 'react-bootstrap/ModalHeader'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faQuestionCircle } from '@fortawesome/free-solid-svg-icons'\n\nlibrary.add(faQuestionCircle)\n\ntype ProgrammaticOptionsProps = {\n  queryBundleRequest: QueryBundleRequest\n  queryResultBundle: QueryResultBundle\n  onHide: Function\n}\n\nfunction ProgrammaticOptions({\n  queryBundleRequest,\n  queryResultBundle,\n  onHide,\n}: ProgrammaticOptionsProps) {\n  const [generatedSql, setGeneratedSql] = useState('')\n\n  useDeepCompareEffect(() => {\n    const getData = async () => {\n      const { query } = queryBundleRequest\n      const { sql, selectedFacets = [] } = query\n      const { columnModels } = queryResultBundle\n      if (!columnModels) {\n        console.error(\n          'Column Models must be included to complete transform sql request',\n        )\n      }\n      const transformSqlWithFacetsRequest: TransformSqlWithFacetsRequest = {\n        concreteType:\n          'org.sagebionetworks.repo.model.table.TransformSqlWithFacetsRequest',\n        sqlToTransform: sql,\n        selectedFacets,\n        schema: columnModels!,\n      }\n\n      try {\n        const res = await getTransformSqlWithFacetsRequest(\n          transformSqlWithFacetsRequest,\n        )\n        setGeneratedSql(res.transformedSql.replace(/\"/g, '\\\\\"'))\n      } catch (e) {\n        console.error('Error on getTransformSqlWithFacetsRequest ', e)\n      }\n    }\n    getData()\n  }, [queryBundleRequest, queryResultBundle])\n\n  return (\n    <Modal\n      animation={false}\n      show={true}\n      onHide={() => onHide()}\n      className=\"ProgrammaticOptions\"\n    >\n      <ModalHeader closeButton>\n        <span style={{ color: '#515359', fontSize: '1.5em' }}>\n          Download Options\n        </span>\n      </ModalHeader>\n      <ModalBody>\n        <p className=\"ProgrammaticOptions__commandline\">\n          Command Line Instructions\n        </p>\n        <p>\n          Use the Synapse command line client to download data. Installation\n          instructions are available\n          <a\n            className=\"ProgrammaticOptions__docslink\"\n            href=\"https://docs.synapse.org/articles/tutorial-download-data-portal.html#command-line\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            {' '}\n            here.\n          </a>\n        </p>\n        <div className=\"ProgrammaticOptions__cli\">\n          <p> synapse get -q \"{generatedSql}\" </p>\n        </div>\n      </ModalBody>\n    </Modal>\n  )\n}\n\nexport default ProgrammaticOptions\n","import { UiSchema } from 'react-jsonschema-form'\nimport { JSONSchema6 } from 'json-schema'\n\nexport const writeHeaderOption = \"First line is the columns names.\"\nexport const includeRowIdAndRowVersionOption = \"Include row metadata (Row Id and Row Version).\"\nexport const csvOption = \"Comma Separated Values (CSV)\"\nexport const tsvOption = \"Tab Separated Values (TSV)\"\n\n// Step 1\nconst stepOneFormSchema: JSONSchema6 = {\n  title: 'Download query results',\n  type: 'object',\n  properties: {\n    'File Type'  : {\n      type: \"string\",\n      oneOf: [\n        {\n          const: csvOption,\n          title: csvOption\n        },\n        {\n          const: tsvOption,\n          title: tsvOption\n        }\n      ],\n    },\n    Contents : {\n      type: \"array\",\n      title: 'Contents',\n      items: {\n        type: 'string',\n        enum: [writeHeaderOption, includeRowIdAndRowVersionOption],\n      },\n      uniqueItems: true\n    }\n  }\n}\n\nconst stepOneFormUISchema: UiSchema = {\n  'File Type': {\n    \"ui:widget\": \"radio\"\n  },\n  Contents: {\n    'ui:widget': 'checkboxes'\n  }\n}\n\n// Step 2\nconst stepTwoFormSchema: JSONSchema6 = {\n  title: 'Download query results',\n  description: 'File is ready for download. Select the download button to download the file.',\n  type: 'object',\n}\n\nconst stepTwoFormUISchema: UiSchema = {\n}\n\nexport const formSchemaArray = [stepOneFormSchema, stepTwoFormSchema]\nexport  const formSchemaUIArray = [stepOneFormUISchema, stepTwoFormUISchema]","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport { Modal } from 'react-bootstrap'\nimport Form, { IChangeEvent } from 'react-jsonschema-form'\nimport { SynapseClient } from '../utils'\nimport {\n  DownloadFromTableRequest,\n  DownloadFromTableResult,\n  SortItem,\n  QueryBundleRequest,\n} from '../utils/synapseTypes/'\nimport {\n  csvOption,\n  formSchemaArray,\n  formSchemaUIArray,\n  includeRowIdAndRowVersionOption,\n  writeHeaderOption,\n} from './ModalDownload.FormSchema'\nimport { parseEntityIdFromSqlStatement } from '../utils/functions/sqlFunctions'\n\nlibrary.add(faTimes)\n\nexport type ModalDownloadState = {\n  isLoading: boolean\n  step: number\n  data?: DownloadFromTableResult\n  formData: {}\n}\n\nexport type ModalDownloadProps = {\n  onClose: (...args: any[]) => void\n  token?: string\n  includeEntityEtag?: boolean\n  queryBundleRequest?: QueryBundleRequest  // either the query bundle request needs to be provided, or getLastQueryRequest\n  getLastQueryRequest?: () => QueryBundleRequest\n  offset?: number\n  limit?: number\n  sort?: SortItem[]\n}\n\nexport default class ModalDownload extends React.Component<\n  ModalDownloadProps,\n  ModalDownloadState\n> {\n  constructor(props: ModalDownloadProps) {\n    super(props)\n    this.state = {\n      isLoading: false,\n      step: 0,\n      formData: {\n        'File Type': csvOption,\n        Contents: [writeHeaderOption, includeRowIdAndRowVersionOption],\n      },\n    }\n  }\n\n  handleSubmit = (event: IChangeEvent) => {\n    if (this.state.step === 0) {\n      this.handleDownloadSetup(event)\n    } else {\n      this.onDownload()\n    }\n  }\n\n  handleDownloadSetup = (event: IChangeEvent) => {\n    this.setState({\n      isLoading: true,\n    })\n    const { formData } = event\n    const fileType = formData['File Type']\n    const contents = formData.Contents as string[]\n    const { token, queryBundleRequest, getLastQueryRequest } = this.props\n    const separator = fileType === csvOption ? ',' : '\\t'\n    const writeHeader = contents.includes(writeHeaderOption)\n    const includeRowIdAndRowVersion = contents.includes(\n      includeRowIdAndRowVersionOption,\n    )\n    const queryRequest = queryBundleRequest ?? getLastQueryRequest!()\n    const sql = queryRequest.query.sql\n    const downloadFromTableRequest: DownloadFromTableRequest = {\n      sql,\n      entityId: parseEntityIdFromSqlStatement(sql),\n      selectedFacets: queryRequest.query.selectedFacets,\n      concreteType:\n        'org.sagebionetworks.repo.model.table.DownloadFromTableRequest',\n      writeHeader,\n      includeRowIdAndRowVersion,\n      csvTableDescriptor: { separator },\n    }\n    SynapseClient.getDownloadFromTableRequest(downloadFromTableRequest, token)\n      .then(data => {\n        this.setState({\n          isLoading: false,\n          step: 1,\n          data,\n        })\n      })\n      .catch(err => {\n        console.log('Error getDownloadFromTableRequest: ', err)\n      })\n  }\n\n  onDownload = () => {\n    const { data } = this.state\n    const { token } = this.props\n    // data will always be defined if calling this function\n    SynapseClient.getFileHandleByIdURL(data!.resultsFileHandleId, token).then(\n      url => {\n        window.location.href = url\n        this.props.onClose()\n      },\n    )\n  }\n\n  handleChange = (event: IChangeEvent) => {\n    const { formData } = event\n    this.setState({\n      formData,\n    })\n  }\n\n  render() {\n    const closeBtn: React.CSSProperties = {\n      position: 'absolute',\n      top: 10,\n      right: 10,\n      zIndex: 10,\n    }\n    const submitBtn: React.CSSProperties = {\n      padding: '6px 10px',\n      borderRadius: 6,\n    }\n    const spinnerStyle: React.CSSProperties = {\n      height: 50,\n      width: 50,\n      backgroundSize: 50,\n    }\n    return (\n      <Modal animation={false} show={true} onHide={this.props.onClose}>\n        <Modal.Header>\n          <button style={closeBtn} onClick={this.props.onClose}>\n            <FontAwesomeIcon style={{ fontSize: '21px' }} icon=\"times\" />\n          </button>\n          <Form\n            schema={formSchemaArray[this.state.step]}\n            uiSchema={formSchemaUIArray[this.state.step]}\n            onChange={this.handleChange}\n            formData={this.state.formData}\n            onSubmit={this.handleSubmit}\n          >\n            {this.state.isLoading && (\n              <div className=\"SRC-centerAndJustifyContent\">\n                <div className=\"SRC-center-text\">\n                  <p> Creating the File </p>\n                  <div style={spinnerStyle} className=\"spinner\" />\n                  <p> Loading... </p>\n                </div>\n              </div>\n            )}\n            <hr />\n            <div style={{ textAlign: 'right' }}>\n              <button\n                id=\"cancelBtn\"\n                onClick={this.props.onClose}\n                className=\"SRC-primary-text-color SRC-roundBorder SRC-underline-on-hover \"\n                type=\"button\"\n              >\n                Cancel\n              </button>\n              <button\n                id=\"submitBtn\"\n                style={submitBtn}\n                className=\"SRC-primary-background-color SRC-roundBorder SRC-whiteText\"\n                type=\"submit\"\n              >\n                {this.state.step === 0 ? 'Next' : 'Download'}\n              </button>\n            </div>\n          </Form>\n        </Modal.Header>\n      </Modal>\n    )\n  }\n}\n","import { DownloadLoginModal } from './DownloadLoginModal'\nimport * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\nimport {\n  QueryResultBundle,\n  QueryBundleRequest,\n} from '../../../utils/synapseTypes'\nimport ProgrammaticOptions from './ProgrammaticOptions'\nimport ModalDownload from '../../../containers/ModalDownload'\n\nexport const DOWNLOAD_OPTIONS_CONTAINER_CLASS = 'SRC-download-options-container'\n\ntype DownloadOptionsProps = {\n  onDownloadFiles: Function\n  isUnauthenticated?: boolean\n  isFileView?: boolean\n  darkTheme?: boolean\n  token: string | undefined\n  queryResultBundle?: QueryResultBundle\n  queryBundleRequest: QueryBundleRequest\n}\n\nexport const DOWNLOAD_FILES_MENU_TEXT = 'Add To Download List'\nconst tooltipDownloadId = 'download'\n\nexport const DownloadOptions: React.FunctionComponent<DownloadOptionsProps> = props => {\n  const [showLoginModal, setShowLoginModal] = React.useState(false)\n  const [showExportMetadata, setShowExportMetadata] = React.useState(false)\n  const [showProgrammaticOptions, setShowProgrammaticOptions] = React.useState(\n    false,\n  )\n  const {\n    onDownloadFiles,\n    queryResultBundle,\n    queryBundleRequest,\n    token,\n    darkTheme = true,\n  } = props\n\n  return (\n    <React.Fragment>\n      <Dropdown as=\"span\">\n        <ElementWithTooltip\n          idForToolTip={tooltipDownloadId}\n          tooltipText={'Download Options'}\n          size=\"lg\"\n          darkTheme={darkTheme}\n          icon={\"download\"}\n        ></ElementWithTooltip>\n        <Dropdown.Menu\n          className=\"SRC-primary-color-hover-dropdown\"\n          alignRight={true}\n        >\n          <Dropdown.Item\n            onClick={() => {\n              setShowExportMetadata(true)\n            }}\n          >\n            Export Table\n          </Dropdown.Item>\n          {props.isFileView && (\n            <Dropdown.Item\n              onClick={() =>\n                props.token ? onDownloadFiles() : setShowLoginModal(true)\n              }\n            >\n              {DOWNLOAD_FILES_MENU_TEXT}\n            </Dropdown.Item>\n          )}\n          <Dropdown.Item\n            // @ts-ignore\n            onClick={() => setShowProgrammaticOptions(true)}\n          >\n            Programmatic Options\n          </Dropdown.Item>\n        </Dropdown.Menu>\n      </Dropdown>\n      {showLoginModal && (\n        <DownloadLoginModal\n          showModal={showLoginModal}\n          onHide={() => setShowLoginModal(false)}\n        ></DownloadLoginModal>\n      )}\n      {\n        // modal can render anywhere, this is not a particular location\n        showExportMetadata && (\n          <ModalDownload\n            onClose={() => setShowExportMetadata(false)}\n            queryBundleRequest={queryBundleRequest}\n            token={token}\n          />\n        )\n      }\n      {showProgrammaticOptions && queryResultBundle && (\n        <ProgrammaticOptions\n          onHide={() => setShowProgrammaticOptions(false)}\n          queryBundleRequest={queryBundleRequest}\n          queryResultBundle={queryResultBundle}\n        ></ProgrammaticOptions>\n      )}\n    </React.Fragment>\n  )\n}\n","import React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\nimport { SelectColumn } from '../../../utils/synapseTypes/'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\nimport { useState } from 'react'\n\ntype ColumnSelectionProps = {\n  headers?: SelectColumn[]\n  isColumnSelected: string[]\n  /* \n      The dropdown state is held in SynapseTable because the EllipsisDropdown has\n      an option to open the dropdown, 'show columns'\n    */\n  show?: boolean\n  onChange?: Function\n  toggleColumnSelection: (name: string) => void\n  darkTheme?: boolean\n  facetAliases?: {}\n}\n\nconst tooltipColumnSelectionId = 'addAndRemoveColumns'\n\nexport const ColumnSelection: React.FunctionComponent<ColumnSelectionProps> = (\n  props: ColumnSelectionProps,\n) => {\n  const {\n    headers,\n    isColumnSelected,\n    toggleColumnSelection,\n    darkTheme,\n    facetAliases,\n    show: showFromProps,\n    onChange,\n  } = props\n\n  let [show, setShow] = useState(false)\n\n  let [usedShow, usedSetShow] =\n    showFromProps !== undefined ? [showFromProps, onChange!] : [show, setShow]\n\n  const onDropdownClick = (_show: boolean, _event: any, metadata: any) => {\n    // Any click event for the Dropdown will close the dropdown (assuming its open), so we have\n    // to handle the onToggle event and manually manage the dropdown open state. If metadata\n    // is defined the event occuring is inside the dropdown which we then want to keep open, otherwise\n    // we close it.\n    if (metadata.source) {\n      usedSetShow(true)\n    } else {\n      usedSetShow(false)\n    }\n  }\n  return (\n    <Dropdown\n      as=\"span\"\n      onToggle={(show: boolean, event: any, metadata: any) =>\n        onDropdownClick(show, event, metadata)\n      }\n      show={usedShow}\n      drop=\"down\"\n    >\n      <ElementWithTooltip\n        idForToolTip={tooltipColumnSelectionId}\n        tooltipText={'Add / Remove Table Columns'}\n        icon={darkTheme ? \"columnsdark\": \"columns\"}\n        darkTheme={darkTheme}\n      ></ElementWithTooltip>\n\n      {/* There's a known issue if the number of dropdown items is very large, ~30+, the dropdown\n          will unexpectedly render with the list going upwards instead of downwards.\n        */}\n      <Dropdown.Menu\n        className=\"SRC-primary-color-hover-dropdown\"\n        alignRight={true}\n      >\n        {headers?.map(header => {\n          const { name } = header\n          const isCurrentColumnSelected = isColumnSelected.includes(name)\n          const iconStyle: React.CSSProperties = {\n            width: '11px',\n            marginRight: '10px',\n            visibility: isCurrentColumnSelected ? undefined : 'hidden',\n          }\n          const maybeShowPrimaryColor = isCurrentColumnSelected\n            ? 'SRC-primary-text-color'\n            : ''\n          return (\n            <Dropdown.Item\n              // @ts-ignore\n              onClick={() => toggleColumnSelection(name)}\n              key={name}\n            >\n              <FontAwesomeIcon\n                style={iconStyle}\n                className={maybeShowPrimaryColor}\n                icon=\"check\"\n              />\n              {unCamelCase(name, facetAliases)}\n            </Dropdown.Item>\n          )\n        })}\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n}\n","import * as React from 'react'\nimport { EntityHeader } from '../utils/synapseTypes/'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faLink,\n  faFolder,\n  faFile,\n  faListAlt,\n  faTable,\n  faThList,\n  faArchive,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nlibrary.add(faLink)\nlibrary.add(faFolder)\nlibrary.add(faFile)\nlibrary.add(faListAlt)\nlibrary.add(faTable)\nlibrary.add(faThList)\nlibrary.add(faArchive)\n\ntype IconType =\n  | 'FileEntity'\n  | 'Folder'\n  | 'Link'\n  | 'Project'\n  | 'TableEntity'\n  | 'EntityView'\n\nconst getIconTypeForEntity = (name: IconType) => {\n  switch (name) {\n    case 'Link':\n      return 'link'\n    case 'Folder':\n      return 'folder'\n    case 'FileEntity':\n      return 'file'\n    case 'TableEntity':\n      return 'table'\n    case 'Project':\n      return 'list-alt'\n    case 'EntityView':\n      return 'th-list'\n    default:\n      return ''\n  }\n}\n\ntype EntityTypeIconProps = {\n  type: string\n}\nconst EntityTypeIcon: React.SFC<EntityTypeIconProps> = ({ type }) => {\n  if (!type) {\n    return <></>\n  }\n  const splitType = type.split('.')\n  const name = splitType[splitType.length - 1] as IconType\n  const iconType = getIconTypeForEntity(name)\n  const iconStyle: React.CSSProperties = {\n    marginRight: 5,\n  }\n  if (iconType === '') {\n    console.log('Entity Type not mapped = ', type)\n    return <React.Fragment />\n  }\n  return <FontAwesomeIcon style={iconStyle} icon={iconType} />\n}\n\ntype EntityLinkProps = {\n  entityHeader: EntityHeader\n  className?: string\n}\n\nexport const EntityLink: React.SFC<EntityLinkProps> = ({\n  entityHeader,\n  className,\n}) => {\n  const { id, name, type } = entityHeader\n  return (\n    <a\n      className={className}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      href={`https://www.synapse.org/#!Synapse:${id}`}\n    >\n      <p className={className}>\n        <EntityTypeIcon type={type} />\n        {name}\n      </p>\n    </a>\n  )\n}\n","import { QueryResultBundle } from '../../utils/synapseTypes'\n\nexport const getUniqueEntities = (\n  data: QueryResultBundle,\n  mapIdToHeader: {},\n  indicies: number[],\n) => {\n  const distinctEntities = new Set<string>()\n  data!.queryResult.queryResults.rows.forEach(row => {\n    row.values.forEach((el: any, colIndex: number) => {\n      // make sure this is a column of type entity and that we haven't retrieved this entity's information prior\n      if (\n        indicies.includes(colIndex) &&\n        !Object.prototype.hasOwnProperty.call(mapIdToHeader, el) &&\n        el\n      ) {\n        distinctEntities.add(el)\n      }\n    })\n  })\n  return distinctEntities\n}\n","import { EntityColumnType, QueryResultBundle } from '../../utils/synapseTypes'\n\nexport const getColumnIndiciesWithType = (\n  data: QueryResultBundle | undefined,\n  ...columnTypes: EntityColumnType[]\n) => {\n  const columnsOfTypeEntity: number[] = []\n  data?.selectColumns?.forEach((el, index) => {\n    if (columnTypes.includes(el.columnType)) {\n      columnsOfTypeEntity.push(index)\n    }\n  })\n  return columnsOfTypeEntity\n}\n","import { ElementWithTooltip } from '../widgets/ElementWithTooltip'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCheck,\n  faColumns,\n  faDownload,\n  faFilter,\n  faGlobeAmericas,\n  faSort,\n  faSortAmountDown,\n  faSortAmountUp,\n  faTimes,\n  faUsers,\n} from '@fortawesome/free-solid-svg-icons'\nimport { cloneDeep } from 'lodash-es'\nimport * as React from 'react'\nimport { Modal } from 'react-bootstrap'\nimport { lexer } from 'sql-parser'\nimport { SynapseClient } from '../../utils'\nimport { getUserProfileWithProfilePicAttached } from '../../utils/functions/getUserData'\nimport {\n  formatSQLFromParser,\n  isGroupByInSql,\n} from '../../utils/functions/sqlFunctions'\nimport {\n  EntityHeader,\n  FacetColumnResult,\n  FacetColumnResultValues,\n  QueryBundleRequest,\n  ReferenceList,\n  Row,\n  SelectColumn,\n  SortItem,\n  UserGroupHeader,\n  UserProfile,\n  FacetColumnRequest,\n  EntityColumnType,\n  ColumnModel,\n} from '../../utils/synapseTypes/'\nimport { getColorPallette } from '../ColorGradient'\nimport { DownloadConfirmation } from '../download_list/DownloadConfirmation'\nimport HasAccess from '../HasAccess'\nimport { QueryWrapperChildProps } from '../QueryWrapper'\nimport TotalQueryResults from '../TotalQueryResults'\nimport { unCamelCase } from './../../utils/functions/unCamelCase'\nimport { ICON_STATE } from './SynapseTableConstants'\nimport {\n  ColumnSelection,\n  DownloadOptions,\n  EllipsisDropdown,\n  ExpandTable,\n} from './table-top/'\nimport NoData from '../../assets/icons/file-dotted.svg'\nimport { renderTableCell } from '../synapse_table_functions/renderTableCell'\nimport { getUniqueEntities } from '../synapse_table_functions/getUniqueEntities'\nimport { getColumnIndiciesWithType } from '../synapse_table_functions/getColumnIndiciesWithType'\nimport { Checkbox } from '../widgets/Checkbox'\nimport { LabelLinkConfig } from '../CardContainerLogic'\nimport { EnumFacetFilter } from '../widgets/query-filter/EnumFacetFilter'\nimport {\n  applyMultipleChangesToValuesColumn,\n  applyChangesToValuesColumn,\n} from '../widgets/query-filter/QueryFilter'\nimport ColumnResizer from 'column-resizer'\nimport ModalDownload from '../ModalDownload'\nimport loadingScreen from '../LoadingScreen'\nimport { Icon } from '../row_renderers/utils'\n\nexport const EMPTY_HEADER: EntityHeader = {\n  id: '',\n  name: '',\n  type: '',\n  versionNumber: -1,\n  versionLabel: '',\n  benefactorId: -1,\n  createdBy: '',\n  createdOn: '',\n  modifiedBy: '',\n  modifiedOn: '',\n}\n// Add all icons to the library so you can use it in your page\nlibrary.add(faColumns)\nlibrary.add(faSort)\nlibrary.add(faSortAmountUp)\nlibrary.add(faSortAmountDown)\nlibrary.add(faCheck)\nlibrary.add(faTimes)\nlibrary.add(faFilter)\nlibrary.add(faDownload)\nlibrary.add(faUsers)\nlibrary.add(faGlobeAmericas)\n// Hold constants for next and previous button actions\nconst NEXT = 'NEXT'\nconst PREVIOUS = 'PREVIOUS'\n\ntype Direction = '' | 'ASC' | 'DESC'\nexport const SORT_STATE: Direction[] = ['', 'DESC', 'ASC']\nexport const DOWNLOAD_OPTIONS_CONTAINER_CLASS = 'SRC-download-options-container'\nconst RESIZER_OPTIONS: any = {\n  resizeMode: 'overflow',\n  partialRefresh: 'true',\n  liveDrag: true,\n  headerOnly: 'true',\n}\ntype Info = {\n  index: number\n  name: string\n}\nexport interface Dictionary<T> {\n  [key: string]: T\n}\nexport type SynapseTableState = {\n  sortedColumnSelection: SortItem[]\n  columnIconSortState: number[]\n  isDownloadConfirmationOpen: boolean\n  isExportTableDownloadOpen: boolean\n  isExpanded: boolean\n  isFileView: boolean\n  mapEntityIdToHeader: Dictionary<EntityHeader>\n  mapUserIdToHeader: Dictionary<Partial<UserGroupHeader & UserProfile>>\n  isColumnSelectionOpen: boolean\n  isUserModifiedQuery?: boolean //flag to signal that the selection criterial has been defined by user and if no records are returned do not hide the table\n  isFetchingEntityHeaders: boolean\n  isFetchingEntityVersion: boolean\n}\nexport type SynapseTableProps = {\n  visibleColumnCount?: number\n  title?: string\n  showAccessColumn?: boolean\n  columnLinks?: LabelLinkConfig\n  hideDownload?: boolean\n  enableLeftFacetFilter?: boolean\n  isFilterAndViewChild?: boolean\n  isRowSelectionVisible?: boolean\n}\n\nexport default class SynapseTable extends React.Component<\n  QueryWrapperChildProps & SynapseTableProps,\n  SynapseTableState\n> {\n  constructor(props: QueryWrapperChildProps & SynapseTableProps) {\n    super(props)\n    this.componentDidMount = this.componentDidMount.bind(this)\n    this.componentWillUnmount = this.componentWillUnmount.bind(this)\n    this.componentDidUpdate = this.componentDidUpdate.bind(this)\n    this.shouldComponentUpdate = this.shouldComponentUpdate.bind(this)\n    this.handleColumnSortPress = this.handleColumnSortPress.bind(this)\n    this.handlePaginationClick = this.handlePaginationClick.bind(this)\n    this.findSelectionIndex = this.findSelectionIndex.bind(this)\n    this.toggleColumnSelection = this.toggleColumnSelection.bind(this)\n    this.advancedSearch = this.advancedSearch.bind(this)\n    this.getLengthOfPropsData = this.getLengthOfPropsData.bind(this)\n    this.configureFacetDropdown = this.configureFacetDropdown.bind(this)\n    this.enableResize = this.enableResize.bind(this)\n    this.disableResize = this.disableResize.bind(this)\n\n    // store the offset and sorted selection that is currently held\n    this.state = {\n      /* columnIconSortState tells what icon to display for a table\n         header. There are three states for a particular header-\n          0 - show descending icon but *deselected*\n          1 - show descending icon selected\n          2 - show ascending icon selected\n      */\n      columnIconSortState: [],\n      isDownloadConfirmationOpen: false,\n      isExportTableDownloadOpen: false,\n      isExpanded: false,\n      isColumnSelectionOpen: false,\n      isFileView: false,\n      // sortedColumnSelection contains the columns which are\n      // selected currently and their sort status as eithet\n      // off, desc, or asc.\n      sortedColumnSelection: [],\n      mapEntityIdToHeader: {},\n      mapUserIdToHeader: {},\n      isFetchingEntityHeaders: false,\n      isFetchingEntityVersion: false,\n    }\n    this.getEntityHeadersInData = this.getEntityHeadersInData.bind(this)\n  }\n\n  // instance variables\n  resizer: any\n  tableElement: HTMLTableElement | null | undefined = undefined\n\n  componentWillUnmount() {\n    this.disableResize()\n  }\n\n  componentDidMount() {\n    this.getEntityHeadersInData(true)\n    this.enableResize()\n  }\n\n  shouldComponentUpdate(\n    nextProps: QueryWrapperChildProps & SynapseTableProps,\n    nextState: Readonly<SynapseTableState>,\n    nextContext: any,\n  ): boolean {\n    this.disableResize()\n    return super.shouldComponentUpdate\n      ? super.shouldComponentUpdate(nextProps, nextState, nextContext)\n      : true\n  }\n  componentDidUpdate(prevProps: QueryWrapperChildProps & SynapseTableProps) {\n    this.getEntityHeadersInData(prevProps.token !== this.props.token)\n    this.getTableConcreteType(prevProps)\n    this.enableResize()\n  }\n\n  public async getTableConcreteType(\n    prevProps: QueryWrapperChildProps & SynapseTableProps,\n  ) {\n    const { data, token } = this.props\n    if (!data) {\n      return\n    } else if (\n      this.state.isFetchingEntityVersion &&\n      prevProps.token === this.props.token\n    ) {\n      return\n    }\n    const currentTableId = data?.queryResult.queryResults.tableId\n    const previousTableId = prevProps.data?.queryResult.queryResults.tableId\n    if (currentTableId && previousTableId !== currentTableId) {\n      this.setState({\n        isFetchingEntityVersion: true,\n      })\n      const entityData = await SynapseClient.getEntity(token, currentTableId)\n      this.setState({\n        isFileView: entityData.concreteType.includes('EntityView'),\n        isFetchingEntityVersion: false,\n      })\n    }\n  }\n\n  enableResize() {\n    if (!this.resizer) {\n      if (this.tableElement) {\n        this.resizer = new ColumnResizer(this.tableElement, RESIZER_OPTIONS)\n      }\n    } else {\n      this.resizer.reset(RESIZER_OPTIONS)\n    }\n  }\n\n  disableResize() {\n    if (this.resizer) {\n      this.resizer.reset({ disable: true })\n    }\n  }\n\n  public async getEntityHeadersInData(forceRefresh: boolean) {\n    const { data, token } = this.props\n    if (!data) {\n      return\n    } else if (this.state.isFetchingEntityHeaders && !forceRefresh) {\n      return\n    }\n    const mapEntityIdToHeader = cloneDeep(this.state.mapEntityIdToHeader)\n    const mapUserIdToHeader = cloneDeep(this.state.mapUserIdToHeader)\n    const entityIdColumnIndicies = getColumnIndiciesWithType(\n      this.props.data,\n      EntityColumnType.ENTITYID,\n    )\n    const userIdColumnIndicies = getColumnIndiciesWithType(\n      this.props.data,\n      EntityColumnType.USERID,\n    )\n    const distinctEntityIds = getUniqueEntities(\n      data,\n      mapEntityIdToHeader,\n      entityIdColumnIndicies,\n    )\n    const distinctUserIds = getUniqueEntities(\n      data,\n      mapUserIdToHeader,\n      userIdColumnIndicies,\n    )\n    if (distinctEntityIds.size === 0 && distinctUserIds.size === 0) {\n      return\n    }\n    this.setState({\n      isFetchingEntityHeaders: true,\n    })\n    // Make call to resolve entity ids\n    if (distinctEntityIds.size > 0) {\n      const referenceList: ReferenceList = Array.from(distinctEntityIds).map(\n        id => {\n          return { targetId: id }\n        },\n      )\n      try {\n        // initialize mapEntityIdToHeader\n        referenceList.forEach(el => {\n          mapEntityIdToHeader[el.targetId] = EMPTY_HEADER\n        })\n        const data = await SynapseClient.getEntityHeader(referenceList, token)\n        const { results } = data\n        results.forEach(el => {\n          mapEntityIdToHeader[el.id] = el\n        })\n      } catch (err) {\n        console.error('Error on retrieving entity header list , ', err)\n      }\n    }\n    const userPorfileIds: string[] = []\n    if (distinctUserIds.size > 0) {\n      // Make call to get group headers and user profiles\n      const ids = Array.from(distinctUserIds)\n      // TODO: Grab Team Badge\n      try {\n        const data = await SynapseClient.getGroupHeadersBatch(ids, token)\n        data.children.forEach(el => {\n          if (el.isIndividual) {\n            userPorfileIds.push(el.ownerId)\n          } else {\n            mapUserIdToHeader[el.ownerId] = el\n          }\n        })\n      } catch (err) {\n        console.error('Error on getGroupHeaders batch: ', err)\n      }\n    }\n    if (userPorfileIds.length > 0) {\n      try {\n        const data = await getUserProfileWithProfilePicAttached(\n          userPorfileIds,\n          token,\n        )\n        data.list.forEach((el: UserProfile) => {\n          mapUserIdToHeader[el.ownerId] = el\n        })\n      } catch (err) {\n        console.error('Error on getUserProfile : ', err)\n      }\n    }\n    this.setState({\n      mapEntityIdToHeader,\n      mapUserIdToHeader,\n      isFetchingEntityHeaders: false,\n    })\n  }\n\n  /**\n   * Display the view\n   */\n  public render() {\n    if (this.props.isLoadingNewData) {\n      return loadingScreen\n    } else if (!this.props.data) {\n      return <></>\n    }\n    // unpack all the data\n    const {\n      data,\n      isLoading = true,\n      unitDescription,\n      token,\n      showBarChart,\n      enableLeftFacetFilter,\n      isFilterAndViewChild,\n    } = this.props\n    const { queryResult, columnModels = [] } = data\n    const { queryResults } = queryResult\n    const { rows } = queryResults\n    const { headers } = queryResults\n    const { facets = [] } = data\n    const { isExpanded, isExportTableDownloadOpen } = this.state\n    const queryRequest = this.props.getLastQueryRequest!()\n\n    let className = ''\n    if (showBarChart) {\n      className = 'SRC-marginBottomTop'\n    }\n    const hasResults = data.queryResult.queryResults.rows.length > 0\n    if (!hasResults && !this.state.isUserModifiedQuery) {\n      return (\n        <div className=\"text-center SRCBorderedPanel SRCBorderedPanel--padded2x\">\n          <img src={NoData} alt=\"no data\"></img>\n          <div style={{ marginTop: '20px', fontStyle: 'italic' }}>\n            This table is currently empty\n          </div>\n        </div>\n      )\n    }\n    const table = (\n      <div className=\"col-xs-12\">\n        {this.renderTable(headers, columnModels, facets, rows)}\n      </div>\n    )\n    const content = (\n      <>\n        <div className={className}>\n          {isExportTableDownloadOpen && (\n            <ModalDownload\n              onClose={() => {\n                this.setState({\n                  isExportTableDownloadOpen: false,\n                })\n              }}\n              queryBundleRequest={queryRequest}\n              token={token}\n            />\n          )}\n          {!enableLeftFacetFilter &&\n            unitDescription &&\n            !isGroupByInSql(queryRequest.query.sql) && (\n              <div\n                className={`SRC-centerContent text-left`}\n                style={{ minHeight: '20px' }}\n              >\n                <TotalQueryResults\n                  isLoading={isLoading}\n                  style={{ fontSize: 15 }}\n                  unitDescription={unitDescription}\n                  lastQueryRequest={queryRequest}\n                  token={token}\n                  frontText={'Showing'}\n                  applyChanges={(newFacets: FacetColumnRequest[]) =>\n                    this.applyChangesFromQueryFilter(newFacets)\n                  }\n                />\n              </div>\n            )}\n          {!isFilterAndViewChild && this.renderTableTop(headers)}\n          {/* FRAGILE, CHANGE WITH CAUTION, see - https://sagebionetworks.jira.com/browse/PORTALS-1539 */}\n          <div className={enableLeftFacetFilter ? '' : 'row'}>{table}</div>\n        </div>\n      </>\n    )\n    return (\n      <React.Fragment>\n        {isExpanded && (\n          <Modal\n            animation={false}\n            show={true}\n            // @ts-ignore\n            onHide={() => this.setState({ isExpanded: false })}\n            dialogClassName={'modal-90w'}\n          >\n            <Modal.Header\n              // @ts-ignore\n              onHide={() => this.setState({ isExpanded: false })}\n              closeButton={true}\n            ></Modal.Header>\n            <Modal.Body>{content}</Modal.Body>\n          </Modal>\n        )}\n        {!isExpanded && content}\n      </React.Fragment>\n    )\n  }\n\n  private showGroupRowData = (selectedRow: Row) => {\n    // magic happens - parse query, deep copy query bundle request, modify, encode, send to Synapse.org.  Easy!\n    const queryCopy = this.props.getLastQueryRequest!().query\n    const parsed = this.getSqlUnderlyingDataForRow(selectedRow, queryCopy.sql)\n    queryCopy.sql = parsed.newSql\n    const queryJSON = JSON.stringify(queryCopy)\n    // encode this copy of the query (json)\n    const encodedQuery = btoa(queryJSON)\n    return `https://www.synapse.org/#!Synapse:${parsed.synId}/tables/query/${encodedQuery}`\n  }\n\n  private renderDropdownDownloadOptions = (isFileView?: boolean) => {\n    return (\n      <DownloadOptions\n        onDownloadFiles={(e: React.SyntheticEvent) => this.showDownload(e)}\n        token={this.props.token}\n        isFileView={isFileView && !this.props.hideDownload}\n        queryBundleRequest={this.props.getLastQueryRequest!()}\n        queryResultBundle={this.props.data!}\n        darkTheme={false}\n      />\n    )\n  }\n\n  private renderColumnSelection = (headers: SelectColumn[]) => {\n    return (\n      <ColumnSelection\n        headers={headers}\n        isColumnSelected={this.props.isColumnSelected!}\n        show={this.state.isColumnSelectionOpen}\n        onChange={(val: boolean) => {\n          this.setState({\n            isColumnSelectionOpen: val,\n          })\n        }}\n        toggleColumnSelection={this.toggleColumnSelection}\n      />\n    )\n  }\n\n  private renderTable = (\n    headers: SelectColumn[],\n    columnModels: ColumnModel[],\n    facets: FacetColumnResult[],\n    rows: Row[],\n  ) => {\n    const lastQueryRequest = this.props.getLastQueryRequest?.()!\n    // handle displaying the previous button -- if offset is zero then it\n    // shouldn't be displayed\n    const pastZero: boolean = lastQueryRequest.query.offset! > 0\n    const {\n      hasMoreData,\n      showAccessColumn,\n      token,\n      isRowSelectionVisible,\n    } = this.props\n\n    const zeroMarginRight: React.CSSProperties = {\n      marginRight: 0,\n    }\n    const nextBtn = (\n      <button\n        onClick={this.handlePaginationClick(NEXT)}\n        className=\"SRC-light-button SRC-standard-button-shape\"\n        style={zeroMarginRight}\n        type=\"button\"\n      >\n        Next\n      </button>\n    )\n    const previousBtn = (\n      <button\n        onClick={this.handlePaginationClick(PREVIOUS)}\n        className=\"SRC-light-button SRC-standard-button-shape\"\n        type=\"button\"\n        style={!hasMoreData && pastZero ? zeroMarginRight : undefined}\n      >\n        Previous\n      </button>\n    )\n\n    let isShowingAccessColumn: boolean | undefined =\n      showAccessColumn && this.state.isFileView\n    /* min height ensure if no rows are selected that a dropdown menu is still accessible */\n    return (\n      <div style={{ minHeight: '400px' }} className=\"SRC-overflowAuto\">\n        {this.state.isDownloadConfirmationOpen && (\n          <DownloadConfirmation\n            token={token!}\n            getLastQueryRequest={this.props.getLastQueryRequest!}\n            fnClose={\n              this.props.isFilterAndViewChild\n                ? undefined\n                : () => this.setState({ isDownloadConfirmationOpen: false })\n            }\n          />\n        )}\n        <table\n          ref={node => (this.tableElement = node)}\n          className=\"table table-striped table-condensed\"\n        >\n          <thead className=\"SRC_bordered\">\n            <tr>\n              {this.createTableHeader(\n                headers,\n                columnModels,\n                facets,\n                isShowingAccessColumn,\n                isRowSelectionVisible,\n                lastQueryRequest,\n              )}\n            </tr>\n          </thead>\n          <tbody>\n            {this.createTableRows(\n              rows,\n              headers,\n              isShowingAccessColumn,\n              isRowSelectionVisible,\n            )}\n          </tbody>\n        </table>\n        <div style={{ textAlign: 'right' }}>\n          {pastZero && previousBtn}\n          {hasMoreData && nextBtn}\n        </div>\n      </div>\n    )\n  }\n\n  private renderTableTop = (headers: SelectColumn[]) => {\n    const { title } = this.props\n    const { isExpanded, isFileView } = this.state\n    const { colorPalette } = getColorPallette(this.props.rgbIndex!, 1)\n    const background = colorPalette[0]\n    const queryRequest = this.props.getLastQueryRequest!()\n    return (\n      <div\n        className={'SRC-centerContent SRC-table-top'}\n        style={{ background, padding: 8 }}\n      >\n        <h3 className=\"SRC-tableHeader\"> {title}</h3>\n        <span className=\"SRC-table-tools\" style={{ marginLeft: 'auto' }}>\n          {!isGroupByInSql(queryRequest.query.sql) && (\n            <>\n              <ElementWithTooltip\n                idForToolTip={'advancedSearch'}\n                callbackFn={this.advancedSearch}\n                tooltipText={'Open Advanced Search in Synapse'}\n                size=\"lg\"\n                icon={\"settings\"}\n              />\n              {this.renderDropdownDownloadOptions(isFileView)}\n              {this.renderColumnSelection(headers)}\n            </>\n          )}\n          <ExpandTable\n            isExpanded={isExpanded}\n            onExpand={() =>\n              this.setState({\n                isExpanded: !isExpanded,\n              })\n            }\n          />\n          <EllipsisDropdown\n            onDownloadFiles={(e: React.SyntheticEvent) => this.showDownload(e)}\n            onDownloadTableOnly={() =>\n              this.setState({\n                isExportTableDownloadOpen: true,\n              })\n            }\n            onShowColumns={() => this.setState({ isColumnSelectionOpen: true })}\n            onFullScreen={() => this.setState({ isExpanded: !isExpanded })}\n            isExpanded={isExpanded}\n            isUnauthenticated={!this.props.token}\n            isGroupedQuery={isGroupByInSql(queryRequest.query.sql)}\n            isFileView={this.state.isFileView}\n          />\n        </span>\n      </div>\n    )\n  }\n  /**\n   * Return the select column indexes for columns that use the aggregate count function.\n   * If sql does not have a GROUP BY, this returns an empty array.\n   * @param originalSql\n   */\n  public getCountFunctionColumnIndexes(originalSql: string): number[] {\n    const indexes: number[] = []\n    if (isGroupByInSql(originalSql)) {\n      const tokens: string[][] = lexer.tokenize(originalSql)\n      const selectIndex = tokens.findIndex(el => el[0] === 'SELECT')\n      const fromIndex = tokens.findIndex(el => el[0] === 'FROM')\n      let columnIndex = 0\n      for (\n        let index = selectIndex + 1;\n        index < fromIndex - selectIndex - 1;\n        index += 1\n      ) {\n        const token = tokens[index]\n        if (token[0] === 'FUNCTION' && token[1].toLowerCase() === 'count') {\n          // found a count column!\n          indexes.push(columnIndex)\n        } else if (token[0] === 'SEPARATOR') {\n          // next column\n          columnIndex += 1\n        }\n      }\n    }\n    return indexes\n  }\n\n  public getSqlUnderlyingDataForRow(\n    selectedRow: Row,\n    originalSql: string,\n  ): { synId: string; newSql: string } {\n    let tokens: string[][] = lexer.tokenize(originalSql)\n    const selectIndex = tokens.findIndex(el => el[0] === 'SELECT')\n    const fromIndex = tokens.findIndex(el => el[0] === 'FROM')\n\n    // gather all of the column names literals between select and from (and their indices)\n    const columnReferences: ColumnReference[] = []\n    let columnIndex = 0\n    let foundFunctionForColumn = false\n    for (\n      let index = selectIndex + 1;\n      index < fromIndex - selectIndex - 1;\n      index += 1\n    ) {\n      const token = tokens[index]\n      // parsing error.  concat function is reported as a LITERAL instead of a function\n      if (\n        token[0] === 'FUNCTION' ||\n        token[1].toLocaleLowerCase() === 'concat'\n      ) {\n        foundFunctionForColumn = true\n      } else if (token[0] === 'LITERAL' && !foundFunctionForColumn) {\n        // found a column\n        columnReferences.push({ index: columnIndex, name: token[1] })\n      } else if (token[0] === 'SEPARATOR') {\n        // next column\n        columnIndex += 1\n        // reset \"found function\"\n        foundFunctionForColumn = false\n      }\n    }\n\n    // remove all tokens after (and including) group\n    tokens = tokens.slice(\n      0,\n      tokens.findIndex(el => el[0] === 'GROUP'),\n    )\n    // replace all columns with *\n    tokens.splice(selectIndex + 1, fromIndex - selectIndex - 1, [\n      'STAR',\n      '*',\n      '1',\n    ])\n    // add new items to where clause, but only if the column name corresponds to a real column in the table/view!\n    // use row.values\n    if (this.props.data === undefined) {\n      return { synId: '', newSql: '' }\n    }\n    const whereIndex = tokens.findIndex(el => el[0] === 'WHERE')\n    if (whereIndex === -1) {\n      // does not contain a where clause\n      tokens.push(['WHERE', 'WHERE', '1'])\n    } else {\n      // alreay contains a where clause, add the first AND\n      tokens.push(['CONDITIONAL', 'AND', '1'])\n    }\n\n    // look for headers in column models, if they match then add a where clause\n    columnReferences.forEach((value: ColumnReference, index: number) => {\n      const rowValue = selectedRow.values[value.index]\n      // PORTALS-712: support null values\n      if (rowValue) {\n        tokens.push(\n          ['LITERAL', value.name, '1'],\n          ['OPERATOR', '=', '1'],\n          ['STRING', rowValue, '1'],\n          ['CONDITIONAL', 'AND', '1'],\n        )\n      } else {\n        tokens.push(\n          ['LITERAL', value.name, '1'],\n          ['OPERATOR', 'IS', '1'],\n          ['BOOLEAN', 'null', '1'],\n          ['CONDITIONAL', 'AND', '1'],\n        )\n      }\n    })\n    // remove the last AND\n    tokens.pop()\n    // remove backtick from output sql (for table name): `syn1234` becomes syn1234\n    const synId = tokens[tokens.findIndex(el => el[0] === 'FROM') + 1][1]\n    tokens.push(['EOF', '', '1'])\n    return { synId, newSql: formatSQLFromParser(tokens) }\n  }\n\n  /**\n   * Handle a click on next or previous\n   *\n   * @memberof SynapseTable\n   */\n  private handlePaginationClick = (eventType: string) => (\n    _event: React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    const queryRequest = this.props.getLastQueryRequest!()\n    let currentOffset = queryRequest.query.offset!\n    // if its a \"previous\" click subtract from the offset\n    // otherwise its next and we paginate forward\n    if (eventType === PREVIOUS) {\n      currentOffset -= 25\n    }\n    if (eventType === NEXT) {\n      currentOffset += 25\n    }\n    queryRequest.query.offset = currentOffset\n    this.props.executeQueryRequest!(queryRequest)\n  }\n  /**\n   * Handle a column having been selected\n   *\n   * @memberof SynapseTable\n   */\n  public handleColumnSortPress = (dict: Info) => (_: React.SyntheticEvent) => {\n    // by using Synthetic event we can use the handler on both key press and mouse click\n    let columnIconSortState = cloneDeep(this.state.columnIconSortState)\n    if (columnIconSortState.length === 0) {\n      columnIconSortState = Array(this.getLengthOfPropsData()).fill(0)\n    }\n    // get currently sorted items and remove/insert/update this selection\n    const sortedColumnSelection = cloneDeep(this.state.sortedColumnSelection)\n    const index = this.findSelectionIndex(sortedColumnSelection, dict.name)\n    // if its present then remove it\n    if (index !== -1) {\n      sortedColumnSelection.splice(index, 1)\n    }\n    columnIconSortState[dict.index] =\n      (columnIconSortState[dict.index] + 1) % ICON_STATE.length\n    if (columnIconSortState[dict.index] > 0) {\n      sortedColumnSelection.unshift({\n        column: dict.name,\n        direction: SORT_STATE[columnIconSortState[dict.index]],\n      })\n    }\n    const queryRequest = this.props.getLastQueryRequest!()\n    queryRequest.query.sort = sortedColumnSelection\n    queryRequest.query.offset = 0\n    this.props.executeQueryRequest!(queryRequest)\n    this.setState({\n      columnIconSortState,\n      sortedColumnSelection,\n    })\n  }\n\n  private createTableRows(\n    rows: Row[],\n    headers: SelectColumn[],\n    isShowingAccessColumn: boolean | undefined,\n    isRowSelectionVisible: boolean | undefined,\n  ) {\n    const rowsFormatted: JSX.Element[] = []\n    const {\n      token,\n      data,\n      isColumnSelected,\n      selectedRowIndices,\n      updateParentState,\n      columnLinks = [],\n    } = this.props\n    const { selectColumns = [], columnModels = [] } = data!\n    const { mapEntityIdToHeader, mapUserIdToHeader } = this.state\n    const entityColumnIndicies = getColumnIndiciesWithType(\n      data,\n      EntityColumnType.ENTITYID,\n    )\n    const userColumnIndicies = getColumnIndiciesWithType(\n      data,\n      EntityColumnType.USERID,\n    )\n    const dateColumnIndicies = getColumnIndiciesWithType(\n      data,\n      EntityColumnType.DATE,\n    )\n    const dateListColumnIndicies = getColumnIndiciesWithType(\n      data,\n      EntityColumnType.DATE_LIST,\n    )\n    const booleanListColumnIndicies = getColumnIndiciesWithType(\n      data,\n      EntityColumnType.BOOLEAN_LIST,\n    )\n    const otherListColumnIndicies = getColumnIndiciesWithType(\n      data,\n      EntityColumnType.STRING_LIST,\n      EntityColumnType.INTEGER_LIST,\n    )\n    // find column indices that are COUNT type\n    const countColumnIndexes = this.getCountFunctionColumnIndexes(\n      this.props.getLastQueryRequest!().query.sql,\n    )\n    rows.forEach((row, rowIndex) => {\n      const rowContent = row.values.map(\n        (columnValue: string, colIndex: number) => {\n          const columnName = headers[colIndex].name\n          const isColumnActive = isColumnSelected!.includes(columnName)\n          const columnLinkConfig = columnLinks.find(el => {\n            return el.matchColumnName === columnName\n          })\n          const index = this.findSelectionIndex(\n            this.state.sortedColumnSelection,\n            columnName,\n          )\n          const isCountColumn = countColumnIndexes.includes(colIndex)\n          const isBold = index === -1 ? '' : 'SRC-boldText'\n          if (isColumnActive) {\n            return (\n              <td\n                className=\"SRC_noBorderTop SRC-synapseTableTd\"\n                key={`(${rowIndex}${columnValue}${colIndex})`}\n              >\n                {isCountColumn && (\n                  <a\n                    href={this.showGroupRowData(row)}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    <p className={isBold}>{columnValue}</p>\n                  </a>\n                )}\n\n                {!isCountColumn &&\n                  renderTableCell({\n                    entityColumnIndicies,\n                    userColumnIndicies,\n                    dateColumnIndicies,\n                    dateListColumnIndicies,\n                    booleanListColumnIndicies,\n                    otherListColumnIndicies,\n                    colIndex,\n                    columnValue,\n                    isBold,\n                    mapEntityIdToHeader,\n                    mapUserIdToHeader,\n                    columnLinkConfig,\n                    rowIndex,\n                    selectColumns,\n                    columnModels,\n                    columnName,\n                  })}\n              </td>\n            )\n          }\n          return <td className=\"SRC-hidden\" key={`(${rowIndex},${colIndex})`} />\n        },\n      )\n      // also push the access column value if we are showing user access for individual items (still shown if not logged in)\n      if (isShowingAccessColumn) {\n        const rowSynapseId = `syn${row.rowId}`\n        rowContent.unshift(\n          <td key={rowSynapseId} className=\"SRC_noBorderTop\">\n            <HasAccess\n              key={rowSynapseId}\n              entityId={rowSynapseId}\n              entityVersionNumber={row.versionNumber?.toString()}\n              token={token}\n            ></HasAccess>\n          </td>,\n        )\n      }\n      if (isRowSelectionVisible && selectedRowIndices) {\n        rowContent.unshift(\n          <td key={`(${rowIndex},rowSelectColumn)`} className=\"SRC_noBorderTop\">\n            <Checkbox\n              label=\"\"\n              id={`(${rowIndex},rowSelectColumnCheckbox)`}\n              checked={selectedRowIndices.includes(rowIndex)}\n              onChange={(checked: boolean) => {\n                const cloneSelectedRowIndices = [...selectedRowIndices]\n                if (checked) {\n                  cloneSelectedRowIndices.push(rowIndex)\n                } else {\n                  const index = cloneSelectedRowIndices.indexOf(rowIndex)\n                  if (index > -1) {\n                    cloneSelectedRowIndices.splice(index, 1)\n                  }\n                }\n                // update parent state on change\n                updateParentState!({\n                  selectedRowIndices: cloneSelectedRowIndices,\n                })\n              }}\n            ></Checkbox>\n          </td>,\n        )\n      }\n\n      const rowFormatted = <tr key={row.rowId}>{rowContent}</tr>\n      rowsFormatted.push(rowFormatted)\n    })\n    return rowsFormatted\n  }\n\n  public isSortableColumn(column: EntityColumnType) {\n    switch (column) {\n      case EntityColumnType.USERID:\n      case EntityColumnType.ENTITYID:\n      case EntityColumnType.FILEHANDLEID:\n        return false\n      default:\n        return true\n    }\n  }\n\n  private createTableHeader(\n    headers: SelectColumn[],\n    columnModels: ColumnModel[],\n    facets: FacetColumnResult[],\n    isShowingAccessColumn: boolean | undefined,\n    isRowSelectionVisible: boolean | undefined,\n    lastQueryRequest: QueryBundleRequest,\n  ) {\n    const { sortedColumnSelection, columnIconSortState } = this.state\n    const { facetAliases = {}, isColumnSelected, token } = this.props\n    const tableColumnHeaderElements: JSX.Element[] = headers.map(\n      (column: SelectColumn, index: number) => {\n        const isHeaderSelected = isColumnSelected!.includes(column.name)\n        if (isHeaderSelected) {\n          // for background color\n          const isSelected: boolean =\n            this.findSelectionIndex(sortedColumnSelection, column.name) !== -1\n          // for icon state\n          const columnIndex: number =\n            columnIconSortState[index] === undefined\n              ? 0\n              : columnIconSortState[index]\n          // we have to figure out if the current column is a facet selection\n          const facetIndex: number = facets.findIndex(\n            (facetColumnResult: FacetColumnResult) => {\n              return facetColumnResult.columnName === column.name\n            },\n          )\n          // the header must be included in the facets and it has to be enumerable for current rendering capabilities\n          const isFacetSelection: boolean =\n            facetIndex !== -1 && facets[facetIndex].facetType === 'enumeration'\n          const facet = facets[facetIndex] as FacetColumnResultValues\n          const isSelectedSpanClass = isSelected\n            ? 'SRC-primary-background-color SRC-anchor-light'\n            : ''\n          const isSelectedIconClass = isSelected\n            ? 'SRC-selected-table-icon tool-icon'\n            : 'SRC-primary-text-color tool-icon'\n          const sortSpanBackgoundClass = `SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover  ${isSelectedSpanClass}`\n          const displayColumnName: string | undefined = unCamelCase(\n            column.name,\n            facetAliases,\n          )\n          const columnModel = columnModels.find(el => el.name === column.name)!\n          return (\n            <th key={column.name}>\n              <div className=\"SRC-split\">\n                <span style={{ whiteSpace: 'nowrap' }}>\n                  {displayColumnName}\n                </span>\n                <div className=\"SRC-centerContent\">\n                  {isFacetSelection &&\n                    this.configureFacetDropdown(\n                      facet,\n                      columnModel,\n                      lastQueryRequest,\n                      token,\n                      facetAliases,\n                    )}\n                  {this.isSortableColumn(column.columnType) && (\n                    <span\n                      tabIndex={0}\n                      className={sortSpanBackgoundClass}\n                      onKeyPress={this.handleColumnSortPress({\n                        index,\n                        name: column.name,\n                      })}\n                      onClick={this.handleColumnSortPress({\n                        index,\n                        name: column.name,\n                      })}\n                    >\n                      <Icon type={ICON_STATE[columnIndex]} cssClass={isSelectedIconClass}></Icon>\n                    </span>\n                  )}\n                </div>\n              </div>\n            </th>\n          )\n        } else {\n          return <th className=\"SRC-hidden\" key={column.name} />\n        }\n      },\n    )\n    // also push the access column if we are showing user access for individual items (must be logged in)\n    if (isShowingAccessColumn) {\n      tableColumnHeaderElements.unshift(\n        <th key=\"accessColumn\">\n          <div className=\"SRC-centerContent\">\n            <span style={{ whiteSpace: 'nowrap' }}>Access</span>\n          </div>\n        </th>,\n      )\n    }\n    if (isRowSelectionVisible) {\n      tableColumnHeaderElements.unshift(\n        <th key=\"rowSelectionColumn\">\n          <div className=\"SRC-centerContent\">{/* checkboxes column */}</div>\n        </th>,\n      )\n    }\n    return tableColumnHeaderElements\n  }\n\n  /**\n   * Utility to search through array of objects and find object with key \"column\"\n   * equal to input parameter \"name\"\n   *\n   * @param {*} sortedColumnSelection\n   * @param {*} name\n   * @returns -1 if not present, otherwise the index of the object\n   * @memberof SynapseTable\n   */\n  private findSelectionIndex(sortedColumnSelection: SortItem[], name: string) {\n    if (sortedColumnSelection.length !== 0) {\n      // find if the current selection exists already and remove it\n      return sortedColumnSelection.findIndex(\n        (el: SortItem) => el.column === name,\n      )\n    }\n    return -1\n  }\n\n  // Direct user to corresponding query on synapse\n  private advancedSearch(event: React.SyntheticEvent) {\n    event && event.preventDefault()\n    const lastQueryRequest = this.props.getLastQueryRequest!()\n    const { query } = lastQueryRequest\n    // base 64 encode the json of the query and go to url with the encoded object\n    const encodedQuery = btoa(JSON.stringify(query))\n    const synTable = lastQueryRequest.entityId\n    window.open(\n      `https://www.synapse.org/#!Synapse:${synTable}/tables/query/${encodedQuery}`,\n      '_blank',\n    )\n  }\n\n  private showDownload(event: React.SyntheticEvent) {\n    if (!this.props.isFilterAndViewChild) {\n      this.setState({ isDownloadConfirmationOpen: true })\n    } else {\n      this.advancedSearch(event)\n    }\n  }\n\n  private getLengthOfPropsData() {\n    const { data } = this.props\n    return data!.queryResult.queryResults.headers.length\n  }\n  /**\n   * Handles the toggle of a column select, this will cause the table to\n   * either show the column or hide depending on the prior state of the column\n   *\n   * @memberof SynapseTable\n   */\n  public toggleColumnSelection = (columnName: string) => {\n    let isColumnSelected = cloneDeep(this.props.isColumnSelected!)\n    if (isColumnSelected.includes(columnName)) {\n      isColumnSelected = isColumnSelected.filter(el => el !== columnName)\n    } else {\n      isColumnSelected.push(columnName)\n    }\n    this.props.updateParentState!({ isColumnSelected })\n  }\n\n  /**\n   * Show the dropdown menu for a column that has been faceted\n   *\n   * @param {number} index this is column index of the query table data\n   * @param {string} columnName this is the name of the column\n   * @param {FacetColumnResult[]} facetColumnResults\n   * @param {number} facetIndex\n   * @returns\n   * @memberof SynapseTable\n   */\n  public configureFacetDropdown(\n    facetColumnResult: FacetColumnResultValues,\n    columnModel: ColumnModel,\n    lastQueryRequest: QueryBundleRequest,\n    token?: string,\n    facetAliases?: {},\n  ) {\n    return (\n      <EnumFacetFilter\n        containerAs=\"Dropdown\"\n        facetValues={facetColumnResult.facetValues}\n        columnModel={columnModel!}\n        token={token}\n        facetAliases={facetAliases}\n        onChange={(facetNamesMap: {}) => {\n          applyMultipleChangesToValuesColumn(\n            lastQueryRequest,\n            facetColumnResult,\n            this.applyChangesFromQueryFilter,\n            facetNamesMap,\n          )\n        }}\n        onClear={() => {\n          applyChangesToValuesColumn(\n            lastQueryRequest,\n            facetColumnResult,\n            this.applyChangesFromQueryFilter,\n          )\n        }}\n      />\n    )\n  }\n\n  public applyChangesFromQueryFilter = (facets: FacetColumnRequest[]) => {\n    const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n    queryRequest.query.selectedFacets = facets\n    queryRequest.query.offset = 0\n    this.setState({ isUserModifiedQuery: true })\n    this.props.executeQueryRequest!(queryRequest)\n  }\n}\ntype ColumnReference = {\n  index: number\n  name: string\n}\n","export enum ColumnSingleValueFilterOperator {\n  LIKE = 'LIKE', // The LIKE operation. Use wildcard '%' in value sting for prefix/suffix matching.\n}\n\nexport interface ColumnSingleValueQueryFilter extends QueryFilter {\n  concreteType: 'org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter'\n  operator: ColumnSingleValueFilterOperator // Determines the filter operation to perform\n  values: string[] // Values to used with the filter.\n  // Multiple values will be joined in an OR relationship.\n}\n\nexport interface QueryFilter {\n  concreteType: string\n  columnName: string\n  operator: string\n  values: string[]\n}\n","import * as React from 'react'\nimport { Dictionary } from '../table/SynapseTable'\nimport { EntityHeader } from '../../utils/synapseTypes/EntityHeader'\nimport { EntityLink } from '../EntityLink'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport UserCard from '../UserCard'\nimport { ElementWithTooltip } from '../widgets/ElementWithTooltip'\nimport { AUTHENTICATED_USERS } from '../../utils/SynapseConstants'\nimport { noop } from 'lodash-es'\nimport { MarkdownLink, CardLink } from '../CardContainerLogic'\nimport { renderLabel } from '../GenericCard'\nimport { SelectColumn, ColumnModel } from '../../utils/synapseTypes'\n\n// Render table cell, supports Entity's and User Icons\nexport const renderTableCell = ({\n  entityColumnIndicies,\n  userColumnIndicies,\n  dateColumnIndicies,\n  dateListColumnIndicies,\n  booleanListColumnIndicies,\n  otherListColumnIndicies,\n  colIndex,\n  columnValue,\n  isBold,\n  mapEntityIdToHeader,\n  mapUserIdToHeader,\n  columnLinkConfig,\n  rowIndex,\n  columnName,\n  selectColumns,\n  columnModels,\n}: {\n  entityColumnIndicies: number[]\n  userColumnIndicies: number[]\n  dateColumnIndicies: number[]\n  dateListColumnIndicies: number[]\n  booleanListColumnIndicies: number[]\n  otherListColumnIndicies: number[]\n  colIndex: number\n  columnValue: string\n  isBold: string\n  mapEntityIdToHeader: Dictionary<EntityHeader>\n  mapUserIdToHeader: Dictionary<any>\n  columnLinkConfig?: MarkdownLink | CardLink\n  rowIndex?: number\n  columnName: string\n  selectColumns: SelectColumn[] | undefined\n  columnModels: ColumnModel[] | undefined\n}): React.ReactNode => {\n  const isShortString = (\n    s: string,\n    maxCharCount = 20,\n  ): boolean => {\n    return (!s || s.length <= maxCharCount)\n  }\n  if (!columnValue) {\n    return <></>\n  }\n  if (columnLinkConfig) {\n    return renderLabel({\n      value: columnValue,\n      columnName,\n      selectColumns,\n      columnModels,\n      isHeader: false,\n      labelLink: columnLinkConfig,\n    })\n  }\n  if (\n    entityColumnIndicies.includes(colIndex) &&\n    Object.prototype.hasOwnProperty.call(mapEntityIdToHeader, columnValue)\n  ) {\n    return (\n      <EntityLink\n        entityHeader={mapEntityIdToHeader[columnValue]}\n        className={isBold}\n      />\n    )\n  }\n  if (dateListColumnIndicies.includes(colIndex)) {\n    const jsonData: number[] = JSON.parse(columnValue)\n    return <p>{jsonData.map((val: number, index: number) => {\n      return (\n        <span key={index} className={isBold}>\n          {new Date(val).toLocaleString()}\n          {index !== jsonData.length - 1 ? ', ' : ''}\n        </span>\n      )\n    })} </p>\n  }\n  if (booleanListColumnIndicies.includes(colIndex)) {\n    const jsonData: boolean[] = JSON.parse(columnValue)\n    return <p>{jsonData.map((val: boolean, index: number) => {\n      return (\n        <span key={index} className={isBold}>\n          {val ? 'true' : 'false'}\n          {index !== jsonData.length - 1 ? ', ' : ''}\n        </span>\n      )\n    })}</p>\n  }\n  if (otherListColumnIndicies.includes(colIndex)) {\n    const jsonData: string[] = JSON.parse(columnValue)\n    return <p>{jsonData.map((val: string, index: number) => {\n      return (\n        <span key={val} className={isBold}>\n          {val}\n          {index !== jsonData.length - 1 ? ', ' : ''}\n        </span>\n      )\n    })}</p>\n  }\n  if (dateColumnIndicies.includes(colIndex)) {\n    return (\n      <p className={isBold}>{new Date(Number(columnValue)).toLocaleString()}</p>\n    )\n  } else if (\n    userColumnIndicies.includes(colIndex) &&\n    Object.prototype.hasOwnProperty.call(mapUserIdToHeader, columnValue)\n  ) {\n    const { ownerId, userName } = mapUserIdToHeader[columnValue]\n    if (mapUserIdToHeader[columnValue].isIndividual === false) {\n      // isUserGroupHeader\n      const icon = userName === AUTHENTICATED_USERS ? 'globe-americas' : 'users'\n      if (userName === AUTHENTICATED_USERS) {\n        return (\n          <span>\n            <FontAwesomeIcon icon={icon} /> All registered Synapse users\n          </span>\n        )\n      }\n      return (\n        <a\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          href={`https://www.synapse.org/#!Team:${ownerId}`}\n        >\n          <FontAwesomeIcon icon={icon} /> {userName}\n        </a>\n      )\n    } else {\n      // isUserCard\n      return (\n        <UserCard\n          userProfile={mapUserIdToHeader[columnValue]}\n          preSignedURL={mapUserIdToHeader[columnValue].clientPreSignedURL}\n          size={'SMALL USER CARD'}\n        />\n      )\n    }\n  } else {\n    const isShort = isShortString(columnValue)\n    if (isShort) {\n      return <p className={isBold}> {columnValue}</p>\n    } else {\n      return (\n        <div className={isBold}>\n          <ElementWithTooltip\n            tooltipText={columnValue}\n            callbackFn={noop}\n            idForToolTip={`${colIndex}_${rowIndex}`}\n          >\n            <p className={isBold}> {columnValue}</p>\n          </ElementWithTooltip>\n        </div>\n      )\n    }\n  }\n}\n","import * as React from 'react'\nimport { QueryWrapperChildProps } from '../QueryWrapper'\nimport CardContainer from '../CardContainer'\nimport SynapseTable, { SynapseTableProps } from '../table/SynapseTable'\nimport { QueryFilter } from '../widgets/query-filter/QueryFilter'\nimport { CardConfiguration } from '../CardContainerLogic'\n\nexport type OwnProps = {\n  tableConfiguration: SynapseTableProps | undefined\n  cardConfiguration: CardConfiguration | undefined\n  hideDownload?: boolean\n}\n\nconst FilterAndView = (props: QueryWrapperChildProps & OwnProps) => {\n  const {\n    topLevelControlsState,\n    tableConfiguration,\n    cardConfiguration,\n    hideDownload,\n    ...rest\n  } = props\n  const { showFacetFilter } = topLevelControlsState!\n  return (\n    <div className=\"row\">\n      <div\n        className={showFacetFilter ? 'col-xs-12 col-sm-3 col-lg-3' : 'hidden'}\n        style={{ paddingRight: '0px' }}\n      >\n        <QueryFilter {...rest} />\n      </div>\n      <div\n        className={\n          showFacetFilter ? 'col-xs-12 col-sm-9 col-lg-9' : 'col-xs-12'\n        }\n      >\n        {tableConfiguration ? (\n          <SynapseTable\n            enableLeftFacetFilter={topLevelControlsState?.showFacetFilter}\n            isFilterAndViewChild={true}\n            {...rest}\n            {...tableConfiguration}\n            hideDownload={hideDownload}\n          />\n        ) : (\n          <></>\n        )}\n        {cardConfiguration ? (\n          <CardContainer {...rest} {...cardConfiguration} />\n        ) : (\n          <></>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default FilterAndView\n","import { SynapseConstants, SynapseClient } from '../utils/'\nimport React, { useEffect, useState } from 'react'\nimport {\n  QueryBundleRequest,\n  FacetColumnValuesRequest,\n} from '../utils/synapseTypes/'\nimport { parseEntityIdFromSqlStatement } from '../utils/functions/sqlFunctions'\n\nexport type QueryCountProps = {\n  sql: string\n  selectedFacets?: FacetColumnValuesRequest[]\n  parens?: boolean\n  name: string\n  token?: string\n}\n\nconst QueryCount: React.FunctionComponent<QueryCountProps> = ({\n  sql,\n  selectedFacets,\n  parens,\n  name,\n  token,\n}) => {\n  const [storedSqlQueryCount, setStoredSqlQueryCount] = useState<{}>({})\n  // maps sql string to true/false, true if already made a request for this sql's query count\n  // false or undefined if not\n  const [isCalculatingQueryCountForSql, setIsCalculatingQueryCountForSql] = useState<{}>({})\n  let mounted = true\n\n  useEffect(() => {\n    const calculateRowCount = () => {\n      if (mounted) {\n        const entityId = parseEntityIdFromSqlStatement(sql)\n        if (\n          isCalculatingQueryCountForSql[`${sql}-${token}`] ||\n          storedSqlQueryCount[`${sql}-${token}`]\n        ) {\n          // its either in progress or its already been calculated\n          return\n        }\n        const request: QueryBundleRequest = {\n          concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n          query: {\n            sql,\n            selectedFacets,\n          },\n          entityId,\n          partMask: SynapseConstants.BUNDLE_MASK_QUERY_COUNT,\n        }\n        const newIsCalculatingQueryCountForSql = {\n          ...isCalculatingQueryCountForSql,  \n        }\n        newIsCalculatingQueryCountForSql[`${sql}-${token}`] = true\n        setIsCalculatingQueryCountForSql(newIsCalculatingQueryCountForSql)\n        SynapseClient.getQueryTableResults(request, token).then(data => {\n          const newStoredSqlQueryCount = {\n            ...storedSqlQueryCount\n          }\n          newStoredSqlQueryCount[`${sql}-${token}`] = data!.queryCount\n          setStoredSqlQueryCount(newStoredSqlQueryCount)\n        })\n      }\n    }\n\n    calculateRowCount()\n\n    return () => {\n      mounted = false\n    }\n\n  }, [sql, selectedFacets, token])\n\n  const count = storedSqlQueryCount[`${sql}-${token}`]\n  const localCount = count?.toLocaleString()\n  /* https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString#Using_toLocaleString */\n  return (\n    <React.Fragment>\n      {name} {count && (parens ? `(${localCount})` : localCount)}\n    </React.Fragment>\n  )\n}\nexport default QueryCount","import React, { useEffect, useState } from 'react'\nimport QueryCount from '../QueryCount'\nimport { IconDefinition } from '@fortawesome/fontawesome-svg-core'\nimport { QueryWrapperChildProps, TopLevelControlsState } from '../QueryWrapper'\nimport { ColumnSelection } from '../table/table-top/ColumnSelection'\nimport { SynapseClient } from '../../utils'\nimport { ElementWithTooltip } from '../widgets/ElementWithTooltip'\nimport { cloneDeep } from 'lodash-es'\nimport { QueryResultBundle } from '../../utils/synapseTypes/'\nimport { DownloadOptions } from '../table/table-top'\nimport { parseEntityIdFromSqlStatement } from '../../utils/functions/sqlFunctions'\n\nexport type TopLevelControlsProps = {\n  name: string\n  entityId: string\n  sql: string\n  token?: string\n  hideDownload?: boolean\n  showColumnSelection?: boolean\n  customControls?: CustomControl[]\n}\n\ntype Control = {\n  key: keyof TopLevelControlsState\n  icon: string\n  tooltipText: string\n}\n\ntype CustomControlCallbackData = {\n  data: QueryResultBundle | undefined\n  selectedRowIndices: number[] | undefined\n  refresh: () => void\n}\n\ntype CustomControl = {\n  buttonText: string\n  onClick: (event: CustomControlCallbackData) => void\n  classNames?: string\n  icon?: IconDefinition\n}\n\nconst controls: Control[] = [\n  {\n    icon: 'search',\n    key: 'showSearchBar',\n    tooltipText: 'Show / Hide Search Bar',\n  },\n  {\n    icon: 'chart',\n    key: 'showFacetVisualization',\n    tooltipText: 'Show / Hide Visualizations',\n  },\n  {\n    icon: 'filter',\n    key: 'showFacetFilter',\n    tooltipText: 'Show / Hide Filters',\n  },\n  {\n    icon: 'download',\n    key: 'showDownloadConfirmation',\n    tooltipText: 'Add files in table to Download List',\n  },\n]\n\nconst TopLevelControls = (\n  props: QueryWrapperChildProps & TopLevelControlsProps,\n) => {\n  const {\n    token,\n    name,\n    sql,\n    updateParentState,\n    topLevelControlsState,\n    data,\n    showColumnSelection = false,\n    isColumnSelected,\n    hideDownload = false,\n    selectedRowIndices,\n    customControls,\n    executeQueryRequest,\n    getLastQueryRequest,\n    facetAliases,\n  } = props\n  const entityId = parseEntityIdFromSqlStatement(sql)\n  const [isFileView, setIsFileView] = useState(false)\n\n  const setControlState = (control: keyof TopLevelControlsState) => {\n    const updatedTopLevelControlsState: TopLevelControlsState = {\n      ...topLevelControlsState!,\n      [control]: !topLevelControlsState![control],\n    }\n    if (control === 'showSearchBar') {\n      updatedTopLevelControlsState.showDownloadConfirmation = false\n    }\n    if (control === 'showDownloadConfirmation') {\n      updatedTopLevelControlsState.showSearchBar = false\n    }\n    updateParentState!({\n      topLevelControlsState: updatedTopLevelControlsState,\n    })\n  }\n\n  useEffect(() => {\n    const getIsFileView = async () => {\n      const entityData = await SynapseClient.getEntity(token, entityId)\n      setIsFileView(entityData.concreteType.includes('EntityView'))\n    }\n    getIsFileView()\n  }, [entityId, token])\n\n  const refresh = () => {\n    executeQueryRequest!(getLastQueryRequest!())\n  }\n  /**\n   * Handles the toggle of a column select, this will cause the table to\n   * either show the column or hide depending on the prior state of the column\n   *\n   * @memberof SynapseTable\n   */\n  const toggleColumnSelection = (columnName: string) => {\n    let isColumnSelectedCopy = cloneDeep(isColumnSelected!)\n    if (isColumnSelectedCopy.includes(columnName)) {\n      isColumnSelectedCopy = isColumnSelectedCopy.filter(\n        el => el !== columnName,\n      )\n    } else {\n      isColumnSelectedCopy.push(columnName)\n    }\n    updateParentState!({ isColumnSelected: isColumnSelectedCopy })\n  }\n\n  return (\n    <h3 className=\"QueryWrapperPlotNav__title\">\n      <div className=\"QueryWrapperPlotNav__querycount\">\n        <QueryCount token={token} name={name} sql={sql} parens={true} />\n      </div>\n      <div className=\"QueryWrapperPlotNav__actions\">\n        {customControls &&\n          customControls.map(customControl => {\n            return (\n              <button\n                key={customControl.buttonText}\n                className={`btn SRC-roundBorder SRC-primary-background-color SRC-whiteText ${customControl.classNames}`}\n                style={{ marginRight: '5px' }}\n                type=\"button\"\n                onClick={() =>\n                  customControl.onClick({ data, selectedRowIndices, refresh })\n                }\n              >\n                {customControl.icon}&nbsp;\n                {customControl.buttonText}\n              </button>\n            )\n          })}\n        {controls.map(control => {\n          const { key, icon, tooltipText } = control\n          if (\n            key === 'showDownloadConfirmation' &&\n            (!isFileView || hideDownload)\n          ) {\n            // needs to be a file view in order for download to make sense\n            return <></>\n          } else if (key === 'showDownloadConfirmation') {\n            return (\n              <DownloadOptions\n                darkTheme={true}\n                onDownloadFiles={() =>\n                  updateParentState!({\n                    topLevelControlsState: {\n                      ...topLevelControlsState!,\n                      showDownloadConfirmation: true,\n                    },\n                  })\n                }\n                token={token}\n                queryResultBundle={data}\n                queryBundleRequest={getLastQueryRequest!()}\n                isFileView={isFileView && !hideDownload}\n              />\n            )\n          }\n          return (\n            <ElementWithTooltip\n              idForToolTip={key}\n              tooltipText={tooltipText}\n              key={key}\n              callbackFn={() => setControlState(key)}\n              darkTheme={true}\n              icon={icon}\n            />\n          )\n        })}\n        {showColumnSelection && (\n          <ColumnSelection\n            headers={data?.selectColumns}\n            isColumnSelected={isColumnSelected!}\n            toggleColumnSelection={toggleColumnSelection}\n            darkTheme={true}\n            facetAliases={facetAliases}\n          />\n        )}\n      </div>\n    </h3>\n  )\n}\n\nexport default TopLevelControls\n","import * as React from 'react'\nimport { CSSTransition } from 'react-transition-group'\nimport { LockedFacet, QueryWrapperChildProps } from './QueryWrapper'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCaretDown,\n  faCaretUp,\n  faSearch,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport { ColumnModel, ColumnType } from '../utils/synapseTypes'\nimport {\n  ColumnSingleValueQueryFilter,\n  ColumnSingleValueFilterOperator,\n  QueryFilter,\n} from '../utils/synapseTypes/Table/QueryFilter'\n\nlibrary.add(faCaretDown)\nlibrary.add(faCaretUp)\nlibrary.add(faSearch)\nlibrary.add(faTimes)\n\ntype SearchState = {\n  show: boolean\n  /* \n    When the component is revealed in queryplotnav we want to focus on the input field and reveal the dropdown\n    there is an issue where the method handleClickOutsideForm will override the state from componentDidUpdate\n    so we track when componentDidUpdate just fired so that `show` is not overriden on the click event which\n    triggers componentDidUpdate \n  */\n  didUpdateRanLast: boolean\n  searchText: string\n  columnName: string\n}\n\nexport type SearchableColumnsV2 = string[]\n\nexport type SearchV2Props = {\n  isQueryWrapperMenuChild?: boolean\n  defaultColumn?: string\n  searchable?: SearchableColumnsV2\n  lockedFacet?: LockedFacet\n}\n\ntype InternalSearchProps = QueryWrapperChildProps & SearchV2Props\n\nclass Search extends React.Component<InternalSearchProps, SearchState> {\n  public searchFormRef: React.RefObject<HTMLFormElement>\n  public radioFormRef: React.RefObject<HTMLFormElement>\n\n  constructor(props: InternalSearchProps) {\n    super(props)\n    this.state = {\n      show: false,\n      didUpdateRanLast: false,\n      searchText: '',\n      columnName: this.props.defaultColumn ?? '',\n    }\n    this.searchFormRef = React.createRef()\n    this.radioFormRef = React.createRef()\n  }\n\n  componentDidMount() {\n    // @ts-ignore\n    document.addEventListener('click', this.handleClickOutsideForm)\n  }\n\n  componentDidUpdate(prevProps: InternalSearchProps) {\n    if (\n      !prevProps.topLevelControlsState?.showSearchBar &&\n      this.props.topLevelControlsState?.showSearchBar\n    ) {\n      this.setState({\n        show: true,\n        didUpdateRanLast: true,\n      })\n      this.searchFormRef?.current?.querySelector('input')?.focus()\n    }\n  }\n\n  componentWillUnmount() {\n    // @ts-ignore\n    document.removeEventListener('click', this.handleClickOutsideForm)\n  }\n\n  handleClickOutsideForm = (event: React.SyntheticEvent) => {\n    if (\n      // @ts-ignore\n      !this.searchFormRef.current?.contains(event?.target) &&\n      // @ts-ignore\n      !this.radioFormRef.current?.contains(event?.target)\n    ) {\n      if (this.state.didUpdateRanLast) {\n        this.setState({\n          didUpdateRanLast: false,\n        })\n      } else {\n        this.setState({\n          show: false,\n        })\n      }\n    }\n  }\n\n  public static addEscapeCharacters = (searchText: string) => {\n    // We have to escape the following characters\n    // ' % \\\n    let escapedSearchText = searchText\n    // escape ' by adding additional '\n    escapedSearchText = escapedSearchText.split(\"'\").join(\"''\")\n    // escape % by adding \\\n    escapedSearchText = escapedSearchText.split('%').join(`\\%`)\n    // escape \\ by adding \\\n    escapedSearchText = escapedSearchText.split('\\\\').join('\\\\\\\\')\n    return escapedSearchText\n  }\n\n  public search = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    // form completion by default causes the page to reload, so we prevent that\n    event.preventDefault()\n    const { searchText } = this.state\n    let { columnName } = this.state\n    const { searchable, lockedFacet } = this.props\n    if (columnName === '') {\n      // default to the first one, will always be defined\n      // For study details page: if lockedFacet is defined, remove it from the search\n      columnName =\n        this.props.data?.columnModels?.filter(el => el.name !== lockedFacet?.facet)\n          .filter(el => searchable ? this.isSupportedColumnAndInProps(el) : this.isSupportedColumn(el),\n        )?.[0].name ?? ''\n    }\n    this.setState({\n      show: false,\n    })\n    const { executeQueryRequest, getLastQueryRequest } = this.props\n\n    const lastQueryRequestDeepClone = getLastQueryRequest!()\n\n    const { additionalFilters = [] } = lastQueryRequestDeepClone.query\n\n    const indexOfColumn = additionalFilters.findIndex((el: QueryFilter) => {\n      if (el.columnName === columnName) {\n        return true\n      }\n      return false\n    })\n    if (indexOfColumn === -1) {\n      const columnSingleValueQueryFilter: ColumnSingleValueQueryFilter = {\n        columnName,\n        operator: ColumnSingleValueFilterOperator.LIKE,\n        values: [`%${searchText}%`],\n        concreteType:\n          'org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter',\n      }\n      additionalFilters.push(columnSingleValueQueryFilter)\n    } else {\n      additionalFilters[indexOfColumn].values.push(searchText)\n    }\n    lastQueryRequestDeepClone.query.additionalFilters = additionalFilters\n    executeQueryRequest!(lastQueryRequestDeepClone)\n  }\n\n  public handleChange = (event: React.FormEvent<HTMLInputElement>) => {\n    this.setState({\n      searchText: event.currentTarget.value,\n    })\n  }\n\n  public isSupportedColumn = (columnModel?: ColumnModel) => {\n    switch (columnModel?.columnType) {\n      case ColumnType.FILEHANDLEID:\n      case ColumnType.ENTITYID:\n      case ColumnType.DATE:\n      case ColumnType.DATE_LIST:\n      case ColumnType.USERID:\n        return false\n      default:\n        return true\n    }\n  }\n\n  public isSupportedColumnAndInProps = (columnModel?: ColumnModel) => {\n    if (this.isSupportedColumn(columnModel)) {\n        // return true if the searchable array contains this column name\n        const { searchable } = this.props\n        return searchable?.some(e => e === columnModel?.name)\n    }\n    return false\n  }\n\n  render() {\n    const { data, topLevelControlsState, facetAliases, searchable, lockedFacet } = this.props\n    const { searchText, show, columnName } = this.state\n    let searchColumns: string[] = []\n\n    // searchable specifies the order of the columns to search\n    if (searchable) {\n      searchColumns = searchable\n        .map(el =>\n          data?.columnModels?.find(model => model.name === el),\n        )\n        .filter(this.isSupportedColumnAndInProps)\n        .map(el => el!.name)\n    } else if (data?.columnModels) {\n      searchColumns = data.columnModels\n        ?.filter(this.isSupportedColumn)\n        .map(el => el.name)\n    }\n\n    // For study details page: if lockedFacet is defined, remove it from the radio dropdown\n    if (searchColumns.length && lockedFacet?.facet) {\n      searchColumns = searchColumns.filter(el => el !== lockedFacet?.facet)\n    }\n\n    return (\n      <div className=\"SearchV2\">\n        <CSSTransition\n          in={topLevelControlsState?.showSearchBar}\n          classNames=\"SearchV2__animate_bar\"\n          timeout={{ enter: 0, exit: 300 }}\n        >\n          <div className=\"SearchV2__animate_height\">\n            <form\n              className=\"SearchV2__searchbar\"\n              onSubmit={this.search}\n              onClick={() => {\n                this.setState({ show: true })\n              }}\n              ref={this.searchFormRef}\n            >\n              <FontAwesomeIcon\n                className=\"SearchV2__searchbar__searchicon\"\n                size={'sm'}\n                icon={'search'}\n              />\n              <input\n                onChange={this.handleChange}\n                onClick={() => {\n                  this.setState({\n                    show: true,\n                  })\n                }}\n                placeholder=\"Enter Search Terms\"\n                value={searchText}\n                type=\"text\"\n              />\n              {this.state.searchText.length > 0 && (\n                <button\n                  className=\"SearchV2__searchbar__clearbutton\"\n                  type=\"button\"\n                  onClick={() => {\n                    this.setState({\n                      searchText: '',\n                    })\n                  }}\n                >\n                  <FontAwesomeIcon\n                    className=\"SRC-primary-text-color\"\n                    icon=\"times\"\n                  />\n                </button>\n              )}\n            </form>\n          </div>\n        </CSSTransition>\n        <div className=\"SearchV2__dropdown_pos\">\n          <CSSTransition\n            in={show}\n            classNames=\"SearchV2__animate_dropdown\"\n            timeout={{ enter: 0, exit: 300 }}\n          >\n            <form\n              ref={this.radioFormRef}\n              className=\"SearchV2__column-select SearchV2__animate_height\"\n            >\n              <p className=\"deemphasized\">\n                <i> Search In Field: </i>\n              </p>\n              {searchColumns.map((name, index) => {\n                const displayName = unCamelCase(name, facetAliases)\n                const isSelected =\n                  (columnName === '' && index === 0) || columnName === name\n                return (\n                  <div className=\"radio\">\n                    <label>\n                      <span>\n                        <input\n                          id={name}\n                          type=\"radio\"\n                          value={name}\n                          checked={isSelected}\n                          onClick={() => {\n                            this.setState({\n                              columnName: name,\n                            })\n                          }}\n                        />\n                        <span>{displayName}</span>\n                      </span>\n                    </label>\n                  </div>\n                )\n              })}\n            </form>\n          </CSSTransition>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Search\n","import * as React from 'react'\nimport QueryWrapper from '../QueryWrapper'\nimport FacetNav, { FacetNavOwnProps } from '../widgets/facet-nav/FacetNav'\nimport { SynapseTableProps } from '../table/SynapseTable'\nimport {\n  insertConditionsFromSearchParams,\n  SQLOperator,\n  parseEntityIdFromSqlStatement,\n} from '../../utils/functions/sqlFunctions'\nimport { SynapseConstants } from '../../utils/'\nimport { QueryBundleRequest } from '../../utils/synapseTypes'\nimport { CardConfiguration } from '../CardContainerLogic'\nimport { Error } from '../Error'\nimport FilterAndView from './FilterAndView'\nimport { TopLevelControlsProps } from './TopLevelControls'\nimport TopLevelControls from './TopLevelControls'\nimport SearchV2, { SearchV2Props } from '../SearchV2'\nimport ModalDownload from '../ModalDownload'\nimport { DownloadConfirmation } from '../download_list'\n\ntype OwnProps = {\n  sql: string\n  shouldDeepLink?: boolean\n  tableConfiguration?: SynapseTableProps\n  cardConfiguration?: CardConfiguration\n  searchConfiguration?: SearchV2Props\n  token?: string\n  rgbIndex?: number\n  facetsToPlot?: string[]\n  visibleColumnCount?: number\n  facetAliases?: {}\n  hideDownload?: boolean\n  defaultColumn?: string\n} & Omit<TopLevelControlsProps, 'entityId'>\n\ntype SearchParams = {\n  searchParams?: {\n    facetValue: string\n  }\n}\ntype Operator = {\n  sqlOperator?: SQLOperator\n}\n\nexport type QueryWrapperPlotNavProps = SearchParams &\n  Partial<FacetNavOwnProps> &\n  Operator &\n  OwnProps\n\nconst QueryWrapperPlotNav: React.FunctionComponent<QueryWrapperPlotNavProps> = props => {\n  const [showExportMetadata, setShowExportMetadata] = React.useState(false)\n  const {\n    searchParams,\n    sql,\n    sqlOperator,\n    tableConfiguration,\n    name,\n    cardConfiguration,\n    facetsToPlot,\n    hideDownload,\n    searchConfiguration,\n    ...rest\n  } = props\n  let sqlUsed = sql\n\n  if (searchParams) {\n    sqlUsed = insertConditionsFromSearchParams(\n      searchParams,\n      sqlUsed,\n      sqlOperator,\n    )\n  }\n\n  const entityId = parseEntityIdFromSqlStatement(sqlUsed)\n  const initQueryRequest: QueryBundleRequest = {\n    entityId,\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    partMask:\n      SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n      SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    query: {\n      sql: sqlUsed,\n      limit: 25,\n      offset: 0,\n    },\n  }\n  return (\n    <div className=\"QueryWrapperPlotNav\">\n      <QueryWrapper {...rest} initQueryRequest={initQueryRequest}>\n        <TopLevelControls\n          showColumnSelection={tableConfiguration !== undefined}\n          name={name}\n          entityId={entityId}\n          sql={sqlUsed}\n          hideDownload={hideDownload}\n        />\n        <SearchV2 {...searchConfiguration} />\n        <Error />\n        <DownloadConfirmation onExportTable={() => setShowExportMetadata(true)}/>\n        <FacetNav\n          facetsToPlot={facetsToPlot}\n          showNotch={true}\n        />\n        <FilterAndView\n          tableConfiguration={tableConfiguration}\n          hideDownload={hideDownload}\n          cardConfiguration={cardConfiguration}\n        />\n        {showExportMetadata && (\n          <ModalDownload\n            onClose={() => setShowExportMetadata(false)}\n          />\n        )}\n      </QueryWrapper>\n    </div>\n  )\n}\n\nexport default QueryWrapperPlotNav\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faAngleLeft, faAngleRight } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport ReactMeasure from 'react-measure'\nimport ReactTooltip from 'react-tooltip'\nimport { getColorPallette } from './ColorGradient'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport {\n  FacetColumnResultValueCount,\n  QueryResultBundle,\n} from '../utils/synapseTypes/'\nimport { getIsValueSelected } from '../utils/functions/facetUtils'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport loadingScreen from './LoadingScreen'\nlibrary.add(faAngleLeft)\nlibrary.add(faAngleRight)\n\nexport const PREVIOUS_ITEM_CLICK = 'left click'\nexport const NEXT_CLICK = 'right click'\n\ntype Rect = {\n  height: number\n  width: number\n  top: number\n  left: number\n  right: number\n  bottom: number\n}\n\ntype MeasureRect = {\n  bounds: Rect\n}\n\nexport type StackedBarChartState = {\n  selectedFacets: {}\n  dimensions: MeasureRect\n}\n\nexport type StackedBarChartProps = {\n  link?: string\n  linkText?: string\n}\n\ntype Info = {\n  value: string\n  count: number\n  index: number\n}\n\ntype InternalProps = StackedBarChartProps & QueryWrapperChildProps\n/**\n * Make a simple stacked bar chart\n *\n * @class StackedBarChart\n * @extends {React.Component}\n */\nexport default class StackedBarChart extends React.Component<\n  InternalProps,\n  StackedBarChartState\n> {\n  constructor(props: InternalProps) {\n    super(props)\n    this.handleHover = this.handleHover.bind(this)\n    this.handleExit = this.handleExit.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n    this.handleArrowClick = this.handleArrowClick.bind(this)\n    this.getTextForChartSelection = this.getTextForChartSelection.bind(this)\n    this.onMeasureResize = this.onMeasureResize.bind(this)\n    // the text currently under the cursor\n    this.state = {\n      // the dimensions of the bar chart itself\n      dimensions: {\n        bounds: { height: 1, width: 1, top: 0, left: 0, right: 0, bottom: 0 },\n      },\n      // the text of the current slice\n      // the count of this facet value occurence\n      selectedFacets: {},\n    }\n    this.extractPropsData = this.extractPropsData.bind(this)\n  }\n\n  /**\n   * Updates the hover text and update the view\n   *\n   * @memberof StackedBarChart\n   */\n  public handleHover(event: React.MouseEvent<SVGRectElement>) {\n    // add box shadow\n    event.currentTarget.style.boxShadow = '25px 20px'\n  }\n\n  /**\n   * Update the hover text and the view\n   *\n   * @param {*} event\n   * @memberof StackedBarChart\n   */\n  public handleExit(event: React.MouseEvent<SVGRectElement>) {\n    // remove box shadow\n    event.currentTarget.style.boxShadow = ''\n  }\n\n  /**\n   * Handle column click event\n   */\n  public handleClick = (dict: Info) => (\n    _event: React.MouseEvent<SVGElement>,\n  ) => {\n    // https://medium.freecodecamp.org/reactjs-pass-parameters-to-event-handlers-ca1f5c422b9\n    this.props.updateParentState!({ chartSelectionIndex: dict.index })\n  }\n\n  public handleArrowClick = (direction: string) => (\n    _event: React.MouseEvent,\n  ) => {\n    let { chartSelectionIndex = 0 } = this.props\n    let dict: any = this.extractPropsData(this.props.data)\n    const length = Object.keys(dict).length\n    if (direction === PREVIOUS_ITEM_CLICK) {\n      chartSelectionIndex -= 1\n      // if its at zero then we want to wrap around to the end\n      chartSelectionIndex =\n        chartSelectionIndex < 0 ? length - 1 : chartSelectionIndex\n    } else {\n      chartSelectionIndex += 1\n    }\n    chartSelectionIndex = chartSelectionIndex % length\n\n    dict = dict[chartSelectionIndex]\n    this.props.updateParentState!({ chartSelectionIndex })\n    // return is only for testing purposes\n    return chartSelectionIndex\n  }\n\n  public getTextForChartSelection(xData: any) {\n    const { chartSelectionIndex = 0 } = this.props\n    const { facetAliases = {}, facet } = this.props\n    const facetValueDisplay =\n      xData[chartSelectionIndex] && xData[chartSelectionIndex].value\n    const filterDisplay = facetAliases[facet!] || unCamelCase(facet)\n    return (\n      <span>\n        <span className=\"SRC-text-title SRC-filter-display\">\n          {filterDisplay}\n        </span>\n        :\n        <span className=\"SRC-facet-view SRC-text-title\">\n          {facetValueDisplay === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n            ? 'Unannotated'\n            : facetValueDisplay}\n        </span>\n      </span>\n    )\n  }\n\n  public getFileCount(xData: any) {\n    const { chartSelectionIndex = 1 } = this.props\n    return xData[chartSelectionIndex] && xData[chartSelectionIndex].count\n  }\n\n  public render() {\n    const {\n      data,\n      isLoadingNewData,\n      rgbIndex,\n      facet = '',\n      unitDescription,\n      isLoading,\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n      chartSelectionIndex,\n      asyncJobStatus,\n    } = this.props\n    // while loading\n    if (isLoadingNewData) {\n      return (\n        <div className=\"SRC-loadingContainer SRC-centerContentColumn\">\n          {loadingScreen}\n          <div>{asyncJobStatus && asyncJobStatus.progressMessage}</div>\n        </div>\n      )\n    }\n    const xData = this.extractPropsData(data)\n    let total: number = 0\n    const width: number = this.state.dimensions.bounds!.width\n    // sum up the counts of data\n    for (const key in xData) {\n      if (xData.hasOwnProperty(key)) {\n        total += xData[key].count\n      }\n    }\n    const { colorPalette, textColors } = getColorPallette(\n      rgbIndex!,\n      xData.length,\n    )\n    const originalColor = colorPalette[0]\n\n    return (\n      <React.Fragment>\n        {/* TODO: Refactor the chart into its own component */}\n        <div className=\"SRC-bar-border SRC-bar-marginTop SRC-bar-border-top\">\n          <ReactMeasure\n            bounds={true}\n            onResize={(contentRect: any) => {\n              this.setState({ dimensions: contentRect })\n            }}\n          >\n            {({ measureRef }) => (\n              <div className=\"SRC-flex\" ref={measureRef}>\n                {xData.map((obj: FacetColumnResultValueCount, index) => {\n                  const textColor: string = textColors[index]\n                  const rgbColor: string = colorPalette[index]\n                  let rectStyle: any\n                  const isValueSelected = isAllFilterSelectedForFacet![facet]\n                    ? true\n                    : getIsValueSelected({\n                        isLoading,\n                        lastFacetSelection,\n                        columnName: facet,\n                        curFacetSelection: obj,\n                      })\n                  if (isValueSelected) {\n                    rectStyle = {\n                      fill: rgbColor,\n                    }\n                  } else {\n                    rectStyle = {\n                      fill: '#C4C4C4',\n                    }\n                  }\n                  const svgHeight = 80\n                  const svgWidth = (obj.count / total) * width\n                  const style: any = {}\n                  if (chartSelectionIndex === index) {\n                    style.filter = 'drop-shadow(5px 5px 5px rgba(0,0,0,0.5))'\n                  }\n                  const label: string = `${facet}: ${obj.value}  - ${obj.count} ${unitDescription}`\n                  // there was one bug where a new line character was in the obj.value, making data-for\n                  // break because its a special character, below we remove that\n                  const tooltipId = obj.value.replace(/(\\r\\n|\\n|\\r)/gm, '')\n                  // basic heuristic to calculate the number of pixels needed to show the value on the bar chart\n                  const value = obj.count as number\n                  const numCharsInValue = value.toString().length * 4.5 // represents width of a character\n\n                  return (\n                    // each svg represents one of the bars\n                    // will need to change this to be responsive\n                    <React.Fragment key={label}>\n                      <span data-for={tooltipId} data-tip={label}>\n                        <svg\n                          className=\"SRC-hoverBox\"\n                          height={svgHeight + 15}\n                          width={svgWidth}\n                          style={style}\n                          onClick={this.handleClick({ ...obj, index })}\n                        >\n                          <rect\n                            onMouseEnter={this.handleHover}\n                            onMouseLeave={this.handleExit}\n                            height={svgHeight}\n                            width={svgWidth}\n                            className=\"SRC-chart-rect-style\"\n                            // can't remove inline style due to dynamic fill\n                            style={rectStyle}\n                          />\n                          {index < 3 && svgWidth > numCharsInValue && (\n                            <text\n                              textAnchor=\"middle\"\n                              className=\"SRC-text-title\"\n                              fontFamily={'bold sans-serif'}\n                              fill={textColor}\n                              x={'50%'}\n                              y={'50%'}\n                            >\n                              {obj.count}\n                            </text>\n                          )}\n                          {chartSelectionIndex === index && (\n                            <text\n                              fill={originalColor}\n                              x={0}\n                              y={svgHeight + 15}\n                              className=\"SRC-text-shadow SRC-text-large\"\n                            >\n                              {'\\u25CF'}\n                            </text>\n                          )}\n                        </svg>\n                      </span>\n                      <ReactTooltip delayShow={1000} id={tooltipId} />\n                    </React.Fragment>\n                  )\n                })}\n              </div>\n            )}\n          </ReactMeasure>\n        </div>\n        <div className=\"SRC-bar-border SRC-bar-border-bottom\">\n          <p className=\"SRC-noMargin SRC-padding-chart SRC-text-title\">\n            <strong>{this.getTextForChartSelection(xData)}</strong>\n          </p>\n          <p\n            id=\"fileCount\"\n            className=\"SRC-noMargin SRC-padding-chart SRC-text-chart\"\n          >\n            {this.getFileCount(xData)} {unitDescription}\n          </p>\n          {this.props.link && (\n            <div className=\"SRC-chart-link\">\n              <a href={`/${this.props.link}`}> {this.props.linkText} </a>\n            </div>\n          )}\n        </div>\n        <div className=\"SRC-chart-nav SRC-center-text\">\n          <button\n            className=\"SRC-chart-btn SRC-floatRight\"\n            type=\"button\"\n            onClick={this.handleArrowClick(NEXT_CLICK)}\n          >\n            <FontAwesomeIcon\n              style={{ fontSize: '11px' }}\n              className=\"SRC-primary-text-color\"\n              icon=\"angle-right\"\n            />\n          </button>\n          <button\n            className=\"SRC-chart-btn SRC-floatRight\"\n            type=\"button\"\n            onClick={this.handleArrowClick(PREVIOUS_ITEM_CLICK)}\n          >\n            <FontAwesomeIcon\n              style={{ fontSize: '11px' }}\n              className=\"SRC-primary-text-color\"\n              icon=\"angle-left\"\n            />\n          </button>\n        </div>\n      </React.Fragment>\n    )\n  }\n  public extractPropsData(data?: QueryResultBundle) {\n    const xData: any[] = []\n    const { facet } = this.props\n    // pull out the data corresponding to the filter in question\n    data?.facets?.forEach((item: any) => {\n      if (item.facetType === 'enumeration' && item.columnName === facet) {\n        item.facetValues.forEach((facetValue: any) => {\n          if (item.columnName) {\n            xData.push({ columnName: item.columnName, ...facetValue })\n          }\n        })\n      }\n    })\n    // sort the data so that the largest bars are at the front\n    xData.sort((a, b) => {\n      return b.count - a.count\n    })\n    return xData\n  }\n\n  public onMeasureResize(contentRect: any) {\n    this.setState({ dimensions: contentRect })\n  }\n}\n","// EntityForm:\n// Will generate a Form (based on your schema files).\n// Gathers user input (including files)\n// Will give you the Synapse ID of the FileEntity that contains the user form data.\nimport * as React from 'react'\nimport Form from 'react-jsonschema-form'\nimport { SynapseClient } from '../utils'\nimport {\n  EntityId,\n  EntityLookupRequest,\n  FileEntity,\n  UserProfile,\n} from '../utils/synapseTypes/'\n\nexport type EntityFormProps = {\n  // Provide the parent container (folder/project), that should contain a folder (named <user_id>) that this user can write to.\n  parentContainerId: string\n  formSchemaEntityId: string // Synapse file that contains the form schema.\n  formUiSchemaEntityId: string // Synapse file that contains the form ui schema.\n  initFormData: boolean // If true, it indicates that youd like to download and pre-fill the form with the user's previous response.\n  token?: string // user's session token\n  synIdCallback: (synId: string) => void // callback.  Once the form output has been saved to a FileEntity, will send synID back\n}\ntype EntityFormState = {\n  error?: any\n  isLoading?: boolean\n  successfullyUploaded: boolean\n  containerId?: string\n  userprofile?: UserProfile\n  currentFileEntity?: FileEntity // file holding user form data\n  formData?: any // form data that prepopulates the form\n  formSchema?: any // schema that drives the form\n  formUiSchema?: any // ui schema that directs how to render the form elements\n}\n\nexport default class EntityForm extends React.Component<\n  EntityFormProps,\n  EntityFormState\n> {\n  formRef: any\n\n  constructor(props: EntityFormProps) {\n    super(props)\n    this.formRef = React.createRef()\n    this.state = {\n      isLoading: true,\n      successfullyUploaded: false,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh()\n  }\n\n  componentDidUpdate(prevProps: any) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      this.refresh()\n    }\n  }\n\n  submitForm = () => {\n    this.formRef.current.submit()\n  }\n\n  refresh = () => {\n    if (this.props.token) {\n      const promises = [\n        SynapseClient.getUserProfile(this.props.token),\n        SynapseClient.getEntity(\n          this.props.token,\n          this.props.formSchemaEntityId,\n        ),\n        SynapseClient.getEntity(\n          this.props.token,\n          this.props.formUiSchemaEntityId,\n        ),\n      ] as Promise<any>[]\n      Promise.all(promises)\n        .then(values => {\n          const userprofile: UserProfile = values[0]\n          this.getTargetContainer(userprofile, this.props.token!).then(\n            // @ts-ignore\n            (targetContainerId: string) => {\n              const formSchemaFileEntity: FileEntity = values[1]\n              const formUiSchemaFileEntity: FileEntity = values[2]\n              this.getSchemaFileContent(\n                targetContainerId,\n                formSchemaFileEntity,\n                formUiSchemaFileEntity,\n              )\n            },\n          )\n        })\n        .catch(error => {\n          this.onError(error)\n        })\n    }\n  }\n\n  getSchemaFileContent = (\n    targetFolderId: string,\n    formSchemaFileEntity: FileEntity,\n    formUiSchemaFileEntity: FileEntity,\n  ) => {\n    const promises = [\n      SynapseClient.getFileEntityContent(\n        this.props.token!,\n        formSchemaFileEntity,\n      ),\n      SynapseClient.getFileEntityContent(\n        this.props.token!,\n        formUiSchemaFileEntity,\n      ),\n    ]\n    Promise.all(promises)\n      .then(values => {\n        const formSchemaContent = JSON.parse(values[0])\n        const formUiSchemaContent = JSON.parse(values[1])\n        this.getExistingFileData(\n          targetFolderId,\n          formSchemaContent,\n          formUiSchemaContent,\n        )\n      })\n      .catch(error => {\n        this.onError(error)\n      })\n  }\n\n  getExistingFileData = (\n    targetFolderId: string,\n    formSchemaContent: any,\n    formUiSchemaContent: any,\n  ) => {\n    // if data already exists, save a reference to the existing entity and prefill the form\n    const fileName = `${formSchemaContent.title}.json`\n    const entityLookupRequest = {\n      entityName: fileName,\n      parentId: targetFolderId,\n    }\n    let formData: any\n    let currentFileEntity: FileEntity\n    SynapseClient.lookupChildEntity(entityLookupRequest, this.props.token)\n      .then((entityId: EntityId) => {\n        // ok, found the existing file\n        return SynapseClient.getEntity<FileEntity>(\n          this.props.token,\n          entityId.id,\n        ).then(entity => {\n          currentFileEntity = entity\n          if (this.props.initFormData) {\n            return SynapseClient.getFileEntityContent(\n              this.props.token!,\n              currentFileEntity,\n            ).then(existingFileData => {\n              formData = JSON.parse(existingFileData)\n            })\n          }\n          // else we're done\n          return Promise.resolve()\n        })\n      })\n      .finally(() => {\n        this.setState({\n          formData,\n          currentFileEntity,\n          formSchema: formSchemaContent,\n          formUiSchema: formUiSchemaContent,\n        })\n      })\n  }\n\n  getTargetContainer = async (userprofile: UserProfile, token: string) => {\n    const entityLookupRequest: EntityLookupRequest = {\n      entityName: userprofile.ownerId,\n      parentId: this.props.parentContainerId,\n    }\n    try {\n      const entityId = await SynapseClient.lookupChildEntity(\n        entityLookupRequest,\n        token,\n      )\n      // ok, found an entity of the same name.\n      console.log(\n        `EntityForm uploading to https://www.synapse.org/#!Synapse:${entityId.id}`,\n      )\n      this.setState({\n        userprofile,\n        containerId: entityId.id,\n        isLoading: false,\n      })\n      return entityId.id\n    } catch (error) {\n      if (error.status === 404) {\n        return this.onError(\n          new Error(\n            'Your folder has not yet been set up, please retry in a few minutes.',\n          ),\n        )\n      }\n      // else\n      return this.onError(error)\n    }\n  }\n\n  finishedProcessing = () => {\n    this.setState({\n      isLoading: false,\n      successfullyUploaded: true,\n    })\n  }\n\n  onError = (error: any) => {\n    this.setState({\n      error,\n      isLoading: false,\n      successfullyUploaded: false,\n    })\n  }\n\n  onSubmit = ({ formData }: any) => {\n    this.setState({\n      isLoading: true,\n      successfullyUploaded: false,\n    })\n\n    const submissionFileAndForm: Blob = new Blob([JSON.stringify(formData)], {\n      type: 'text/json',\n    })\n    this.createEntityFile(submissionFileAndForm)\n  }\n\n  createEntityFile = (fileContentsBlob: Blob) => {\n    const fileName = `${this.state.formSchema.title}.json`\n    SynapseClient.uploadFile(this.props.token, fileName, fileContentsBlob)\n      .then(fileUploadComplete => {\n        // do we need to create a new file entity, or update an existing file entity?\n        const newFileHandleId = fileUploadComplete.fileHandleId\n        if (this.state.currentFileEntity) {\n          this.state.currentFileEntity.dataFileHandleId = newFileHandleId\n          return SynapseClient.updateEntity(\n            this.state.currentFileEntity,\n            this.props.token,\n          )\n        }\n        // else, it's a new file entity\n        const newFileEntity: FileEntity = {\n          parentId: this.state.containerId!,\n          name: fileName,\n          concreteType: 'org.sagebionetworks.repo.model.FileEntity',\n          dataFileHandleId: newFileHandleId,\n        }\n        return SynapseClient.createEntity(newFileEntity, this.props.token)\n      })\n      .then(fileEntity => {\n        // by this point we've either found and updated the existing file entity, or created a new one.\n        this.finishedProcessing()\n        if (this.props.synIdCallback) {\n          this.props.synIdCallback(fileEntity.id!)\n        }\n      })\n      .catch((error: any) => {\n        this.onError(error)\n      })\n  }\n\n  render() {\n    return (\n      <div>\n        {this.state.error && (\n          <div className=\"panel panel-danger errors\">\n            <div className=\"panel-heading\">\n              <h3 className=\"panel-title\">Error</h3>\n            </div>\n            <ul className=\"list-group\">\n              <li className=\"list-group-item text-danger\">\n                {this.state.error.name} {this.state.error.reason}\n                {this.state.error.message}\n              </li>\n            </ul>\n          </div>\n        )}\n        {this.props.token &&\n          !this.state.isLoading &&\n          !this.state.successfullyUploaded &&\n          this.state.formSchema &&\n          this.state.formUiSchema &&\n          !this.state.error && (\n            <Form\n              formData={this.state.formData}\n              schema={this.state.formSchema}\n              uiSchema={this.state.formUiSchema}\n              onSubmit={this.onSubmit}\n              showErrorList={true}\n              ref={this.formRef}\n            >\n              <div style={{ display: 'none' }}>\n                <button type=\"submit\" className=\"btn btn-info\">\n                  Submit\n                </button>\n              </div>\n            </Form>\n          )}\n        {!this.state.error && this.props.token && this.state.isLoading && (\n          <React.Fragment>\n            <span>Saving&hellip;</span>\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          </React.Fragment>\n        )}\n      </div>\n    )\n  }\n}\n","import React, { useEffect, useState } from 'react'\nimport {\n  BatchFileRequest,\n  FileHandleAssociateType,\n  FileEntity,\n  ExternalFileHandle,\n  assertIsExternalFileHandle,\n  assertIsFileEntity,\n} from '../utils/synapseTypes'\nimport { SynapseClient } from '../utils/'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faExternalLinkAlt } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nlibrary.add(faExternalLinkAlt)\n\nexport type ExternalFileHandleLinkProps = {\n  synId: string\n  token?: string\n  className?: string\n}\n\nexport const ExternalFileHandleLink = (props: ExternalFileHandleLinkProps) => {\n  const { synId, token, className } = props\n  const [data, setData] = useState<\n    | { fileEntity: FileEntity; externalFileHandle: ExternalFileHandle }\n    | undefined\n  >(undefined)\n  useEffect(() => {\n    const getEntity = async () => {\n      try {\n        const fileEntity = await SynapseClient.getEntity<FileEntity>(\n          token,\n          synId,\n        )\n        assertIsFileEntity(fileEntity)\n        const batchFileRequest: BatchFileRequest = {\n          requestedFiles: [\n            {\n              associateObjectId: synId,\n              associateObjectType: FileHandleAssociateType.FileEntity,\n              fileHandleId: fileEntity.dataFileHandleId,\n            },\n          ],\n          includeFileHandles: true,\n          includePreSignedURLs: false,\n          includePreviewPreSignedURLs: false,\n        }\n        const file = await SynapseClient.getFiles(batchFileRequest, token)\n        const externalFileHandle = file.requestedFiles[0].fileHandle\n        assertIsExternalFileHandle(externalFileHandle)\n        setData({\n          externalFileHandle,\n          fileEntity,\n        })\n      } catch (e) {\n        console.error('Error on getting external file handle = ', e)\n      }\n    }\n    getEntity()\n  }, [synId, token])\n\n  const externalFileHandle = data?.externalFileHandle\n  const fileEntity = data?.fileEntity\n\n  return externalFileHandle ? (\n    <a\n      href={externalFileHandle.externalURL}\n      className={className}\n      target=\"_blank\"\n    >\n      <span>\n        {fileEntity?.name}\n        <FontAwesomeIcon style={{ marginLeft: 5 }} icon=\"external-link-alt\" />\n      </span>\n    </a>\n  ) : (\n    <></>\n  )\n}\n","export enum StepStateEnum {\n  TODO,\n  PROGRESS,\n  COMPLETED,\n  EXCLUDED,\n  ERROR,\n}\n\nexport type Step = {\n  id: string\n  title: string\n  order: number\n  state: StepStateEnum\n  inProgress: boolean\n  rules?: any[]\n  validationRules?: any[]\n  default: string\n  excluded?: boolean\n  final?: boolean\n  description?: string\n  copy?: string\n  static?: boolean\n  child?: boolean\n  children?: string[]\n}\n\nexport enum NavActionEnum {\n  PREVIOUS,\n  NEXT,\n  GO_TO_STEP,\n  SAVE,\n  SUBMIT,\n  VALIDATE,\n  NONE,\n}\n\nexport enum StatusEnum {\n  PROGRESS,\n  ERROR,\n  SAVE_SUCCESS,\n  SUBMIT_SUCCESS,\n  ERROR_CRITICAL,\n}\n\nexport interface SummaryFormat {\n  screen: Step\n  label: string\n  value: string\n}\n\nexport type FormSchema = {\n  properties?: any\n  definitions?: any\n}\n\nexport interface IRulesEvent {\n  type: string\n  params: any\n}\nexport interface IRulesNavigationEvent extends IRulesEvent {\n  params: {\n    next: string\n  }\n}\n\nexport interface IRulesValidationEvent extends IRulesEvent {\n  params: {\n    message: string\n    name: string\n    property: string\n  }\n}\n\nexport interface IAdditionalError {\n  screen: string\n  field: string\n  message: string\n}\n","import * as React from 'react'\n\nexport type HeaderProps = {\n  isSubmitted?: boolean\n  bodyText?: string //should never take user input only use cardcoded text from a parent component. Uses dangerouslySetInnerHTML\n  title: string\n}\n\nexport default function Header(props: HeaderProps) {\n  let bodyText = <></>\n\n  if (props.isSubmitted) {\n    bodyText = <div>Your information has been submitted</div>\n  } else {\n    if (props.bodyText) {\n      bodyText = (\n        <div dangerouslySetInnerHTML={{ __html: props.bodyText }}></div>\n      )\n    }\n  }\n\n  return (\n    <div\n      className={`submission-header${props.isSubmitted ? ' submitted' : ''}`}\n    >\n      <h2>{props.title}</h2>\n      {bodyText}\n      <hr></hr>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Step, StepStateEnum } from './types'\n\nimport { FlipProp, IconDefinition } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCheckCircle,\n  faCircle,\n  faBan,\n  faExclamationCircle,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport type StepsSideNavProps = {\n  stepList: Step[]\n  onStepChange: Function\n  isWizardMode?: boolean\n}\n\nexport default function StepsSideNav(props: StepsSideNavProps) {\n  const nonChildSteps = props.stepList.filter(step => step.child !== true)\n\n  const getIcon = (\n    state: StepStateEnum,\n    isExcluded: boolean | undefined,\n    isStatic: boolean | undefined,\n    isSubmit: boolean | undefined,\n  ): { iconDef: IconDefinition; flip: FlipProp | undefined } => {\n    let iconDef: IconDefinition = faCircle\n    let flip: FlipProp | undefined = undefined\n    if (isStatic || isSubmit) {\n      return {\n        iconDef,\n        flip,\n      }\n    }\n\n    if (isExcluded) {\n      iconDef = faBan\n      flip = 'horizontal'\n    } else if (state === StepStateEnum.COMPLETED) {\n      iconDef = faCheckCircle\n    } else if (state === StepStateEnum.ERROR) {\n      iconDef = faExclamationCircle\n    }\n    return { iconDef, flip }\n  }\n\n  const getItemClass = (\n    isInProgress: boolean,\n    isStatic: boolean = false,\n  ): string => {\n    let liClassName = 'item'\n    if (isInProgress) {\n      liClassName = `${liClassName} pointed `\n    }\n    if (isStatic) {\n      liClassName = `${liClassName} static`\n    }\n    return liClassName\n  }\n\n  const getListItem = (\n    step: Step,\n    isWizard: boolean,\n    isRenderChild = false,\n  ): JSX.Element => {\n    if (!step || (step.child && !isRenderChild)) {\n      return <></>\n    }\n    const renderStepName = (\n      step: Step,\n      isWizard: boolean,\n      callback: Function,\n    ): JSX.Element => {\n      if (!step.inProgress && (!isWizard || !!step.final)) {\n        return (\n          <button className=\"btn btn-link\" onClick={() => callback(step)}>\n            {step.title}\n          </button>\n        )\n      } else {\n        return <span>{step.title}</span>\n      }\n    }\n    const icon = getIcon(step.state, step.excluded, step.static, step.final)\n    const itemClass = getItemClass(step.inProgress, step.static)\n\n    return (\n      <div className={itemClass}>\n        <FontAwesomeIcon icon={icon.iconDef} flip={icon.flip} />\n        {renderStepName(step, isWizard, props.onStepChange)}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"SRC-menuLayout json-forms-menu\" style={{ flex: '1' }}>\n      <ul>\n        {nonChildSteps.map((step: Step, i: number) => {\n          return (\n            <li className=\"item-wrap\" key={i + step.id}>\n              {getListItem(step, !!props.isWizardMode)}\n              {step.children && step.children.length > 0 && (\n                <div className=\"subMenu\">\n                  <ul>\n                    {step.children &&\n                      step.children.map((stepChildId: string, j: number) => {\n                        const childStep = props.stepList.find(\n                          step => step.id === stepChildId,\n                        )\n                        return typeof childStep === 'undefined' ? (\n                          <></>\n                        ) : (\n                          <li className=\"item-wrap\" key={j + stepChildId}>\n                            {getListItem(childStep, !!props.isWizardMode, true)}\n                          </li>\n                        )\n                      })}\n                  </ul>\n                </div>\n              )}\n            </li>\n          )\n        })}\n      </ul>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Step, NavActionEnum } from './types'\nimport {\n  faChevronLeft,\n  faChevronRight,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport interface NavButtonsProps {\n  isWizardMode?: boolean\n  previousStepIds: string[]\n  onNavAction: Function\n  steps: Step[]\n  currentStep: Step\n  isFormSubmitted?: boolean\n}\n\nexport interface NextStepLinkProps {\n  onNavAction: Function\n  steps: Step[]\n  nextStepId: string | undefined\n}\n\nexport function NavButtons(props: NavButtonsProps): JSX.Element {\n  // in wizard mode we build an array of the previous steps. In regular mode back goes to\n  // a previous order step\n  const canGoBack = (props: NavButtonsProps): boolean => {\n    if (props.isWizardMode) {\n      return props.previousStepIds && props.previousStepIds.length > 0\n    } else {\n      return props.steps.findIndex(step => step.id === props.currentStep.id) > 0\n    }\n  }\n\n  const previousButton = canGoBack(props) ? (\n    <button\n      type=\"button\"\n      onClick={e => props.onNavAction(NavActionEnum.PREVIOUS)}\n      className=\"btn btn-link nav-link prev\"\n    >\n      <FontAwesomeIcon icon={faChevronLeft} />\n    </button>\n  ) : (\n    <></>\n  )\n\n  const nextButton = !props.currentStep.final ? (\n    <button\n      type=\"button\"\n      onClick={e => props.onNavAction(NavActionEnum.NEXT)}\n      className=\"btn btn-link nav-link next\"\n    >\n      <FontAwesomeIcon icon={faChevronRight} />\n    </button>\n  ) : (\n    <></>\n  )\n\n  const saveButton = (\n    <button\n      type=\"button\"\n      className=\"btn btn-action save\"\n      disabled={props.isFormSubmitted}\n      onClick={e => props.onNavAction(NavActionEnum.SAVE)}\n    >\n      SAVE\n    </button>\n  )\n\n  return (\n    <div>\n      <hr></hr>\n      <div className=\"buttonWrapper pull-right\">\n        {previousButton} {nextButton} {saveButton}\n      </div>\n    </div>\n  )\n}\n\nexport function NextStepLink(props: NextStepLinkProps): JSX.Element {\n  const nextStep = props.steps.find(step => step.id === props.nextStepId)\n  if (typeof nextStep === 'undefined') {\n    return <></>\n  }\n  return (\n    <span className=\"nav-link\">\n      <a onClick={e => props.onNavAction(nextStep)}>{nextStep.title}</a>\n      <FontAwesomeIcon icon={faChevronRight}></FontAwesomeIcon>\n    </span>\n  )\n}\n","import * as React from 'react'\n\ninterface DataDebugProps {\n  formData: any\n  hidden: boolean\n}\n\nexport default function DataDebug(props: DataDebugProps) {\n  const myData = (\n    <div>\n      <h6>Data</h6>\n      <pre>{JSON.stringify(props.formData, null, 2)}</pre>\n    </div>\n  )\n  return <>{!props.hidden && myData}</>\n}\n","import * as React from 'react'\n\nimport { UiSchema } from 'react-jsonschema-form'\nimport { SummaryFormat, Step, FormSchema } from './types'\nimport {\n  first,\n  cloneDeep,\n  keys,\n  find,\n  isObject,\n  get,\n  isArray,\n  isString,\n  isDate,\n} from 'lodash-es'\n\nexport interface SummaryTableProps {\n  isWizard?: boolean\n  formData: any\n  callbackFn?: Function\n  steps: Step[]\n  schema: FormSchema\n  uiSchema: UiSchema\n}\n\nfunction findLabel(key: string, schema: any, uiSchema: UiSchema): string {\n  const regex1 = /\\[\\d+\\]\\./g\n  const regex3 = /\\.(\\d)+/g\n\n  key = key.replace(regex3, '[$1]')\n\n  const propArr = key.split('.')\n  // some things require labels in schema (e.g. checkboxes) so this is preferred\n  const labelFromSchema = `${propArr.join('.properties.')}.title`\n  //can be overriden by label in UI\n  const labelFromUi = `${key}.ui:title`\n  //for array fields we need to change the property e.g.\n  //  ld50.experiments[0].species_other should look like 'ld50.experiments.items.species_other'\n  const arrayLabelFromSchema = labelFromSchema.replace(regex1, '.items.')\n  const arrayLabelFromUiSchema = labelFromUi.replace(regex1, '.items.')\n  const indexMatch = labelFromSchema.match(regex1)\n  let index = first(indexMatch)\n\n  if (index) {\n    index = index.substring(1, index.length - 2)\n    index = !isNaN(parseInt(index)) ? parseInt(index) + 1 + '' : ''\n  }\n\n  const label =\n    get(uiSchema, labelFromUi) ||\n    get(schema.properties, labelFromSchema) ||\n    get(uiSchema, arrayLabelFromUiSchema) ||\n    get(schema.properties, arrayLabelFromSchema) ||\n    `${arrayLabelFromSchema}`\n  return `${index ? '[' + index + '] ' : ''}${label}`\n}\n\nexport function getFlatData(\n  formData: any,\n  steps: Step[],\n  schema: FormSchema,\n  uiSchema: UiSchema,\n): SummaryFormat[] {\n  //takes nested json and converts it into flattened item list\n\n  function flatten(\n    object: any,\n    flattenedObject: any,\n    prefix: string,\n  ): string[] {\n    const separator = '.'\n    Object.keys(object).forEach(key => {\n      if (object[key] === null) {\n        flattenedObject[prefix + key] = ''\n      } else if (\n        //if the value is a proper array\n        isArray(object[key]) &&\n        !isString(object[key])\n      ) {\n        for (const i in object[key]) {\n          if (\n            isArray(object[key][i]) ||\n            (isObject(object[key]) && !isString(object[key][i]))\n          ) {\n            flatten(\n              object[key][i],\n              flattenedObject,\n              `${prefix}${key}[${i}]${separator}`,\n            )\n          } else {\n            let prevVal = flattenedObject[`${prefix}${key}`]\n            prevVal = prevVal ? prevVal + ', ' : ''\n            flattenedObject[`${prefix}${key}`] = prevVal + object[key][i]\n          }\n        }\n      } else if (isObject(object[key]) && !isDate(object[key])) {\n        flatten(object[key], flattenedObject, `${prefix}${key}${separator}`)\n      } else {\n        flattenedObject[prefix + key] = object[key]\n      }\n    })\n    return flattenedObject\n  }\n\n  const flatData = flatten(cloneDeep(formData), [], '')\n  const flatFormData = keys(flatData)\n    .map(key => {\n      let val = flatData[key]\n      if (flatData[key] === false) {\n        val = 'false'\n      }\n      if (flatData[key] === true) {\n        val = 'true'\n      }\n      const boundary = key.indexOf('.')\n      return {\n        screen: find(steps, { id: key.substring(0, boundary) }),\n        label: findLabel(key, schema, uiSchema),\n        value: val,\n      }\n    })\n    .filter(item => item.label.indexOf('.properties.included.title') === -1) //included is the property we generate to help with validation of optional forms\n\n  const result = flatFormData\n    .filter(item => item.screen && typeof item.value !== 'undefined')\n    .map(item => {\n      return {\n        label: item.label,\n        value: item.value,\n        screen: item.screen!,\n      }\n    })\n    .sort((a, b) => a.screen.order - b.screen.order)\n\n  return result\n}\n\nexport default function SummaryTable(props: SummaryTableProps): JSX.Element {\n  let flatFormData: SummaryFormat[] = []\n\n  flatFormData = getFlatData(\n    cloneDeep(props.formData),\n    props.steps,\n    props.schema,\n    props.uiSchema,\n  )\n\n  let prevScreenId = ''\n  const table = (\n    <>\n      <table className=\"table summary-table-header\">\n        <thead>\n          <tr>\n            <th>Step</th>\n            <th>Label</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n      </table>\n\n      <div className=\"scroll-area table-body\">\n        <table className=\"table summary-table\">\n          <tbody>\n            {flatFormData.map((line: SummaryFormat, i: number) => {\n              return (\n                <tr key={i + line.screen.id + line.label}>\n                  <td>\n                    {prevScreenId !== line.screen.id &&\n                      (prevScreenId = line.screen.id) && (\n                        <span>{line.screen.title}</span>\n                      )}\n                  </td>\n                  <td>{line.label}</td>\n\n                  <td>{line.value}</td>\n                </tr>\n              )\n            })}\n          </tbody>\n        </table>\n      </div>\n    </>\n  )\n\n  return (\n    <>\n      <p className=\"step-exclude-directions\">\n        Below is all of the data you have entered. Before submitting, click\n        'Validate' to ensure that all of the required data has been entered.\n      </p>\n      <button className=\"nav-link pull-right\" onClick={() => window.print()}>\n        Print this data\n      </button>\n      <div className=\"panel panel-default padding-full wrap\">\n        <div className=\"summary scroll-area\">{table}</div>\n      </div>\n    </>\n  )\n}\n","import React from 'react'\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\n\nexport type WarningModalProps = {\n  title: string\n  copy: string | JSX.Element\n  confirmCopy?: string\n  className?: string\n  show: boolean\n  onOK: Function\n  onCancel: Function\n  callbackArgs: any\n}\n\nexport default function WarningModal(props: WarningModalProps) {\n  return (\n    <Modal show={props.show} animation={false} className={props.className}>\n      <Modal.Header closeButton={false} onHide={() => props.onCancel()}>\n        <Modal.Title>{props.title}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>{props.copy}</Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"secondary\" onClick={() => props.onCancel()}>\n          Cancel\n        </Button>\n        <Button\n          variant=\"success\"\n          onClick={() => props.onOK(...props.callbackArgs)}\n        >\n          <span>{props.confirmCopy || 'OK'}</span>\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n","import * as React from 'react'\nimport _ from 'lodash-es'\nimport { Engine, EngineResult } from 'json-rules-engine'\nimport {\n  default as Form,\n  UiSchema,\n  AjvError,\n  ErrorListProps,\n} from 'react-jsonschema-form'\n\nimport {\n  Step,\n  StepStateEnum,\n  NavActionEnum,\n  StatusEnum,\n  FormSchema,\n  IRulesValidationEvent,\n  IRulesNavigationEvent,\n} from './types'\nimport Header from './Header'\nimport StepsSideNav from './StepsSideNav'\nimport { NavButtons, NextStepLink } from './NavButtons'\nimport DataDebug from './DataDebug'\nimport SummaryTable from './SummaryTable'\nimport WarningModal from './WarningModal'\nimport Switch from 'react-switch'\nimport { Prompt } from 'react-router-dom'\n\nexport interface IFormData {\n  [key: string]: {\n    included?: boolean\n    [key: string]: any\n  }\n}\n\nexport type SynapseFormProps = {\n  schema: FormSchema\n  uiSchema: UiSchema\n  navSchema: {\n    steps: any[]\n  }\n  formData: IFormData\n  onSubmit: Function\n  onSave: Function\n  formTitle: string\n  formClass?: string\n  isWizardMode?: boolean\n  callbackStatus?: StatusEnum\n  isSubmitted?: boolean\n}\n\ntype SynapseFormState = {\n  formData: IFormData // form data that prepopulates the form\n  currentStep: Step\n  nextStep?: Step\n  steps: Step[]\n  previousStepIds: string[]\n  hasValidated?: boolean //validation has been called and it passed\n  doShowErrors: boolean //if we should show error summary at the top of the page\n  doShowHelp: boolean\n  modalContext?: { action: Function; arguments: any[] }\n  hasUnsavedChanges: boolean\n  isSubmitted?: boolean\n  isLoadingSaved: boolean\n}\n\nexport interface SummaryFormat {\n  label: string\n  value: string\n}\n\nexport default class SynapseForm extends React.Component<\n  SynapseFormProps,\n  SynapseFormState\n> {\n  excludeWarningText = (\n    <div>\n      <p>\n        This action will clear any entered data on this page and remove this\n        form from your submission. You can include it again at anytime. Only\n        this page will be affected.\n      </p>\n      <p>Are you sure you want to skip this step and clear any entered data?</p>\n    </div>\n  )\n  excludeWarningHeader = 'Skip This Step?'\n  unsavedDataWarning = `You might have some unsaved data. Are you sure you want to leave?`\n  formRef: any //ref to form for submission\n  formDivRef: any // ref to the div containing form (for scrolling on validation failure)\n  navAction: NavActionEnum = NavActionEnum.NONE\n  uiSchema: {}\n  nextStep: Step | undefined\n  extraErrors: AjvError[] = []\n\n  isNewForm = (formData: IFormData): boolean => {\n    return (\n      (Object.keys(formData).length == 1 &&\n        Object.keys(formData)[0] === 'metadata') ||\n      Object.keys(formData).length == 0\n    )\n  }\n\n  getFirstStep = (steps: Step[], formData: IFormData): Step => {\n    if (!this.isNewForm(formData)) {\n      return steps.find(step => step.final === true) || steps[0]\n    } else {\n      return steps[0]\n    }\n  }\n\n  constructor(props: SynapseFormProps) {\n    super(props)\n\n    //will modify the ui:help to render html vs text\n    this.uiSchema = stringToElementForProp(\n      _.cloneDeep(props.uiSchema),\n      'ui:help',\n    )\n    //create steps array from the navSchema\n    const steps = props.navSchema.steps\n      .map((step, i) => {\n        return {\n          ...step,\n          inProgress: i === 0 ? true : false,\n        }\n      })\n      .sort((a, b) => a.order - b.order)\n\n    this.formRef = React.createRef()\n    this.formDivRef = React.createRef()\n    const currentStep = this.getFirstStep(steps, props.formData)\n    this.state = {\n      currentStep,\n      steps,\n      previousStepIds: [],\n      formData: props.formData,\n      doShowErrors: false,\n      doShowHelp: true,\n      hasUnsavedChanges: false,\n      isSubmitted: props.isSubmitted,\n      isLoadingSaved: !this.isNewForm(this.props.formData),\n    }\n  }\n\n  onUnload = (ev: any) => {\n    {\n      if (this.state.hasUnsavedChanges) {\n        ev.preventDefault()\n        return (ev.returnValue = this.unsavedDataWarning)\n      }\n      return\n    }\n  }\n  // Setup the `beforeunload` event listener\n  setupBeforeUnloadListener = () => {\n    window.addEventListener('beforeunload', this.onUnload)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeunload', this.onUnload)\n  }\n\n  componentDidUpdate(prevProps: SynapseFormProps) {\n    const shouldUpdate = this.props.callbackStatus !== prevProps.callbackStatus\n    const isSuccess =\n      this.props.callbackStatus === StatusEnum.SAVE_SUCCESS ||\n      this.props.callbackStatus === StatusEnum.SUBMIT_SUCCESS\n    if (shouldUpdate && isSuccess) {\n      this.setState({ hasUnsavedChanges: false })\n      if (this.props.callbackStatus === StatusEnum.SUBMIT_SUCCESS) {\n        this.setState({ isSubmitted: true })\n        window.history.back()\n      }\n    }\n  }\n\n  _setIncludedPropInFormDataNonWizard = (\n    currentState: SynapseFormState,\n    schemaScreens: any,\n  ): IFormData => {\n    const result = {}\n    const currentStateFormData = currentState.formData\n    //if there is a top level 'included' property in schema - update the form.\n    Object.keys(schemaScreens).forEach((key: string) => {\n      if (_.get(schemaScreens[key], `properties.included`)) {\n        _.set(result, `${key}.included`, true)\n      }\n    })\n    return { ...currentStateFormData, ...result }\n  }\n\n  _setIncludedPropInFormDataWizard = (\n    currentState: SynapseFormState,\n  ): IFormData => {\n    const firstStepId = currentState.currentStep.id\n    const newStateData = _.cloneDeep(currentState.formData)\n    _.set(newStateData, `${firstStepId}.included`, true)\n    return newStateData\n  }\n\n  componentDidMount() {\n    this.setupBeforeUnloadListener()\n    const isNewForm = this.isNewForm(this.state.formData)\n    if (!isNewForm) {\n      //when loading saved form - validate to see the steps status\n      this.triggerAction(NavActionEnum.VALIDATE)\n    } else {\n      // for validation of optional forms. Validation is enforced only if included property is set.\n      this.setState(prevState => {\n        const newFormData = this.props.isWizardMode\n          ? this._setIncludedPropInFormDataWizard(prevState)\n          : this._setIncludedPropInFormDataNonWizard(\n              prevState,\n              this.props.schema,\n            )\n        return {\n          formData: newFormData,\n        }\n      })\n    }\n  }\n\n  // get the schema slice for the current screen/step\n  getSchema = ({ id, final }: Step): FormSchema => {\n    if (final) {\n      return this.props.schema\n    }\n    //only get schema for current step. Only the portion of entire form is shown\n\n    const currentStepSlice = _.pick(this.props.schema, [\n      'title',\n      'type',\n      `properties.${id}`,\n    ])\n    return currentStepSlice\n  }\n\n  // find the next step\n  getNextStepId = async (\n    currentStep: Step,\n    formData: any,\n    nextStepId?: string,\n  ): Promise<string> => {\n    if (nextStepId) {\n      return nextStepId\n    }\n    if (!currentStep.rules || currentStep.rules.length === 0) {\n      return currentStep.default\n    }\n\n    // if there are rules - run the engine and go to the first next step\n    const engine = new Engine(currentStep.rules)\n\n    try {\n      const result: EngineResult = await engine.run(formData)\n      if (result.events.length > 0) {\n        return (result.events[0] as IRulesNavigationEvent).params.next\n      } else {\n        return currentStep.default\n      }\n    } catch (error) {\n      return currentStep.default\n    }\n  }\n\n  // called when going next, previous or a given step\n  moveStep = async (\n    formData: any,\n    nextStepId: string | undefined,\n    isError: boolean,\n    previousStack = [...this.state.previousStepIds],\n  ) => {\n    const currentStep = this.state.currentStep\n    let currentStepState: StepStateEnum\n    //we don't wnat to display errors on the page - this will be done explicitly in validation\n    this.formRef.current.setState({ errorSchema: {} })\n    //in wizard mode we can only move forwards (don't know next step yet) or backwards (do know next step)\n    const isMoveForwardInWizardMode = this.props.isWizardMode && !nextStepId\n\n    //previousStack is used for 'back' navigation is wizard mode.\n    //only need to do it if moving forward i.e. nextStepId is undefined\n    if (isMoveForwardInWizardMode) {\n      previousStack.push(currentStep.id)\n    }\n\n    if (!isError) {\n      currentStepState = StepStateEnum.COMPLETED\n\n      if (!isMoveForwardInWizardMode && this.props.isWizardMode) {\n        currentStepState = StepStateEnum.TODO\n      }\n    } else {\n      currentStepState = StepStateEnum.ERROR\n    }\n    // determine next step\n    nextStepId = await this.getNextStepId(currentStep, formData, nextStepId)\n\n    const steps = this.state.steps.map(step => {\n      if (step.id === currentStep.id) {\n        return {\n          ...step,\n          ...{ state: currentStepState, inProgress: false },\n        }\n      } else if (step.id === nextStepId) {\n        return { ...step, ...{ inProgress: true } }\n      }\n      return step\n    })\n    //if we are in wizard mode we want to make sure that we include the step we are about to go to\n    if (isMoveForwardInWizardMode) {\n      _.set(formData, `${nextStepId}.included`, true)\n    }\n\n    //at this point the form is valid and submitted and the data reflects the latest\n    const nextStep = this.state.steps.find(step => step.id === nextStepId)!\n    // clean up unused screens in wizard before getting to submit\n    if (this.props.isWizardMode && nextStep.final) {\n      Object.keys(formData).forEach(key => {\n        if (formData[key].included === undefined) {\n          formData[key] = {}\n        }\n      })\n    }\n\n    this.saveStepState(previousStack, steps, nextStep!, formData)\n  }\n\n  //save the state of the current screen\n  saveStepState = (\n    previousStepIds: string[],\n    steps: Step[],\n    currentStep: Step,\n    formData: any,\n  ) => {\n    this.setState({\n      previousStepIds,\n      steps,\n      currentStep,\n      formData,\n      hasValidated: false,\n      doShowErrors: false,\n    })\n  }\n\n  //--------- fns to support navigation --------------------//\n  goPrevious = async (formData: any, isError: boolean) => {\n    let previousStepId: string | undefined\n    const previousStack: string[] = [...this.state.previousStepIds]\n    // in wizard mode we go to the previously visited screen.\n    // In regular mode go to the screen with previous index\n    if (this.props.isWizardMode) {\n      previousStepId = previousStack.pop()\n      if (!this.isSubmitScreen()) {\n        //since we don't know if we'll get back to that step again - exclude it. We will include it again if we\n        // get to it.\n        _.set(formData, `${this.state.currentStep.id}.included`, undefined)\n      }\n    } else {\n      const currentIndex = _.findIndex(this.state.steps, {\n        id: this.state.currentStep.id,\n      })\n      if (currentIndex > 0) {\n        previousStepId = this.state.steps[currentIndex - 1].id\n      }\n    }\n    if (!_.isUndefined(previousStepId)) {\n      return this.moveStep(formData, previousStepId, isError, previousStack)\n    }\n  }\n\n  triggerAction = async (navAction: NavActionEnum) => {\n    // we don't need to validate on save so bypassing submit\n    if (navAction === NavActionEnum.SAVE) {\n      return this.props.onSave(this.state.formData)\n    } else {\n      this.navAction = navAction\n      // first run whatever custom validaton we have\n      this.extraErrors = await this.runCustomValidation(\n        this.state.formData,\n        this.state.currentStep,\n        this.state.steps,\n      )\n      if (this.formRef.current) {\n        this.formRef.current.submit()\n      }\n    }\n  }\n\n  // triggered when we click on the step name in left nav (doesn't happen in wizard mode)\n  triggerStepChange = (step: Step) => {\n    this.nextStep = step\n    this.triggerAction(NavActionEnum.GO_TO_STEP)\n  }\n\n  onError = (args: any) => {\n    this.setState({\n      doShowErrors: true,\n      hasValidated: false,\n    })\n    if (this.navAction === NavActionEnum.VALIDATE) {\n      const modifiedSteps = this.setStepStatusForFailedValidation(\n        args.props,\n        this.state.steps,\n        !!this.props.isWizardMode,\n        this.state.formData,\n        this.getSchema(this.state.currentStep).properties ||\n          this.getSchema(this.state.currentStep),\n      )\n      this.setState({ steps: modifiedSteps })\n      this.formDivRef.current.scrollTo(0, 0)\n      if (this.state.isLoadingSaved) {\n        this.moveStep(this.state.formData, modifiedSteps[0].id, true)\n        this.setState({ isLoadingSaved: false })\n      }\n    }\n  }\n\n  setStepStatusForFailedValidation = (\n    errors: AjvError[],\n    steps: Step[],\n    isWizard: boolean,\n    formData: IFormData,\n    currentSchemaProperties: any,\n  ): Step[] => {\n    //error property is in the format: step.somevalue.etc  .welcome.submission_name example\n    //find all the steps where there is an error\n    const stepsWithError = errors.map(\n      error => _.trimStart(error.property, '.').split('.')[0],\n    )\n    //find all steps in current schema\n    const stepsInCurrentSchema = Object.keys(currentSchemaProperties)\n    const updatedSteps: Step[] = steps.map(step => {\n      //if there is an error in this step\n      if (stepsWithError.indexOf(step.id) > -1) {\n        return {\n          ...step,\n          state: StepStateEnum.ERROR,\n        }\n        //if no error and included in schema\n      } else if (stepsInCurrentSchema.indexOf(step.id) > -1) {\n        let state = StepStateEnum.COMPLETED\n        //if we are in wizard and possibly have not visited this step\n        if (isWizard && !_.get(formData[step.id], 'included')) {\n          state = step.state\n        }\n\n        return {\n          ...step,\n          state: state,\n        }\n      } else {\n        return step\n      }\n    })\n    return updatedSteps\n  }\n\n  //we are constantly saving form data. Needed to overwrite on-error behavior\n  handleOnChange({ formData }: any) {\n    //this is just for form updates. submit screen goes different route\n    if (!this.isSubmitScreen() && !this.state.currentStep.excluded) {\n      const hasUnsavedChanges = !_.isEqual(this.state.formData, formData)\n      this.setState({ formData, hasUnsavedChanges })\n    }\n  }\n\n  performAction(navAction: NavActionEnum, hasError: boolean) {\n    const formData = this.state.formData\n\n    switch (navAction) {\n      case NavActionEnum.NEXT: {\n        return this.moveStep(formData, undefined, hasError)\n      }\n      case NavActionEnum.PREVIOUS: {\n        return this.goPrevious(formData, hasError)\n      }\n      case NavActionEnum.GO_TO_STEP: {\n        //nextStep is returned when clicked on the Steps left nav\n        if (!this.nextStep) {\n          return\n        }\n        return this.moveStep(formData, this.nextStep.id, hasError)\n      }\n\n      case NavActionEnum.SUBMIT: {\n        this.props.onSubmit(formData)\n        return\n      }\n      case NavActionEnum.VALIDATE: {\n        //we get here is we clicked validate and the data is valid.\n        // if it's not valid we handle it in onError fn\n        const steps = this.setStepStatusForFailedValidation(\n          [],\n          this.state.steps,\n          !!this.props.isWizardMode,\n          this.state.formData,\n          this.getSchema(this.state.currentStep).properties ||\n            this.getSchema(this.state.currentStep),\n        )\n        const currentStep = {\n          ...this.state.currentStep,\n          state: StepStateEnum.COMPLETED,\n        }\n\n        this.setState({ hasValidated: true, currentStep, steps })\n        if (this.state.isLoadingSaved) {\n          this.moveStep(this.state.formData, steps[0].id, false)\n          this.setState({ isLoadingSaved: false })\n        }\n        return\n      }\n      default:\n        return\n    }\n  }\n\n  //we need to route things through submit - otherwise validation does not kick in\n  // it triggers internal library validation and calls the performAction with the params for action\n  onSubmit = (): any => {\n    this.performAction(\n      this.navAction,\n      this.state.currentStep.state === StepStateEnum.ERROR,\n    )\n  }\n\n  isSubmitScreen = (): boolean => {\n    return this.state.currentStep.final === true && !this.state.isLoadingSaved\n  }\n\n  showExcludeStateWarningModal = (\n    stepId: string,\n    isUpdateFlattenedData: boolean = false,\n  ): void => {\n    this.setState({\n      modalContext: {\n        action: this.toggleExcludeStep,\n        arguments: [stepId, true, isUpdateFlattenedData],\n      },\n    })\n  }\n\n  toggleExcludeStep = (stepId: string, isExclude: boolean): void => {\n    this.setState((prevState, props) => {\n      const steps = prevState.steps.map(stp => {\n        if (stp.id === stepId) {\n          return { ...stp, ...{ excluded: isExclude } }\n        }\n        return stp\n      })\n\n      const formDataUpdated = _.cloneDeep(prevState.formData)\n      const currentStep = _.cloneDeep(prevState.currentStep)\n      //we need this because you can exclude on the ifnal screen so the currentStep.id\n      //is not always the one we need to exclude\n      if (currentStep.id === stepId) {\n        currentStep.excluded = isExclude\n      }\n      //if exluding - blow away the data for the step\n      if (isExclude) {\n        formDataUpdated[stepId] = {}\n        //_.set(formDataUpdated, `${stepId}.included`, false);\n      } else {\n        _.set(formDataUpdated, `${stepId}.included`, true)\n      }\n      return {\n        steps,\n        formData: formDataUpdated,\n        modalContext: undefined,\n        currentStep,\n      }\n    })\n  }\n\n  private renderNotification = (status?: StatusEnum): JSX.Element => {\n    if (status === StatusEnum.SAVE_SUCCESS) {\n      return <div className=\"notification-area\"> Successfully saved </div>\n    }\n    if (status === StatusEnum.SUBMIT_SUCCESS) {\n      return <div className=\"notification-area\"> Successfully submitted </div>\n    }\n    if (status === StatusEnum.PROGRESS) {\n      return <div className=\"notification-area\"> working on it ....</div>\n    }\n    return <></>\n  }\n\n  // displays the text for screens that don't have any form data\n  private renderTextForStaticScreen = (): JSX.Element => {\n    if (!this.state.currentStep.copy) {\n      return <></>\n    }\n    const copy = this.state.currentStep.copy\n    return (\n      <div\n        className=\"static-screen\"\n        dangerouslySetInnerHTML={{ __html: copy! }}\n      />\n    )\n  }\n\n  //displays subheader for forms that can be excluded\n  renderOptionalFormSubheader = (isWizard: boolean = false): JSX.Element => {\n    if (isWizard) {\n      return <></>\n    }\n    const currentStep = this.state.currentStep\n\n    if (currentStep.excluded === true) {\n      return (\n        <div className=\"step-exclude-directions\">\n          This form is currently not included in the submission.\n          <button\n            className=\"btn btn-link\"\n            onClick={() => this.toggleExcludeStep(currentStep.id, false)}\n          >\n            INCLUDE\n          </button>\n        </div>\n      )\n    } else if (currentStep.excluded === false) {\n      return (\n        <div className=\"step-exclude-directions\">\n          This form is currently included in the submission. Enter some data if\n          you have it, or click \"Skip\".\n          <button\n            className=\"btn btn-link\"\n            onClick={() =>\n              this.showExcludeStateWarningModal(this.state.currentStep.id)\n            }\n          >\n            SKIP\n          </button>\n        </div>\n      )\n    }\n    return <></>\n  }\n\n  renderHelpToggle = (\n    currentStep: Step,\n    showHelp: boolean,\n    callbackFn: Function,\n  ): JSX.Element => {\n    if (currentStep.static || currentStep.final) {\n      return <></>\n    }\n    return (\n      <>\n        <label className=\"pull-right toggle-help-label\">\n          <span>Hide help</span>\n          <Switch\n            checkedIcon={false}\n            uncheckedIcon={false}\n            height={20}\n            width={45}\n            className=\"toggle-help\"\n            offColor=\"#ccc\"\n            onChange={() => callbackFn()}\n            checked={showHelp}\n          />\n          <span>Show help</span>\n        </label>\n      </>\n    )\n  }\n\n  runCustomValidation = async (\n    formData: IFormData,\n    currentStep: Step,\n    allSteps: Step[],\n  ): Promise<AjvError[]> => {\n    const errors: AjvError[] = []\n\n    //default - running on current step\n    let rules = currentStep.validationRules || []\n    let data = {\n      [currentStep.id]: formData[currentStep.id],\n    }\n\n    // for final step -- concatenate all rules and run on all data\n    if (currentStep.final) {\n      rules = allSteps.reduce((acc: any, value: Step) => {\n        return value.validationRules && value.validationRules.length > 0\n          ? acc.concat(value.validationRules)\n          : acc\n      }, [])\n      data = _.cloneDeep(formData)\n    }\n\n    if (rules.length === 0) {\n      return []\n    }\n\n    //this is a workaround for inability to define a rule to run on all members of the data array\n    // we define the generic rule with path e.g.\"path\": \".experiments[*].dose_range.dose_range_min\",\n    const allRules: any[] = []\n    rules.forEach(rule => {\n      //take a rule\n      const paramProp = rule.event.params.property\n      // if it's just a normal rule - add it\n      if (paramProp.indexOf('[*]') === -1) {\n        allRules.push(rule)\n      } else {\n        const path = paramProp.split('[*]')[0].substring(1)\n        const data = _.get(formData, path)\n        // generate a rule for each item in the data array by substituting [*] w/ appropriate index\n        if (Array.isArray(data) && typeof data !== 'string') {\n          for (let i = 0; i < data.length; i++) {\n            const newRule = JSON.parse(\n              JSON.stringify(rule).replace(/\\[\\*\\]/g, `[${i}]`),\n            )\n            allRules.push(newRule)\n          }\n        } else {\n          allRules.push(rule)\n        }\n      }\n    })\n    // no we run  all the rules through the engine\n    const engine = new Engine(allRules, {\n      allowUndefinedFacts: true,\n    })\n\n    try {\n      const result: EngineResult = await engine.run(data)\n      const validationEvents = result.events as IRulesValidationEvent[]\n      validationEvents.forEach(event => {\n        const err: AjvError = {\n          ...event.params,\n          ...{\n            params: {},\n            stack: `${event.params.property} ${event.params.message}`,\n          },\n        }\n        errors.push(err)\n      })\n    } catch (error) {\n      console.log(error)\n    }\n\n    return errors\n  }\n\n  transformErrors = (errors: AjvError[]): AjvError[] => {\n    // if we are not in wizard mode and not trying to submit or validate we just want to skip\n    // over the errors and just set the step status\n    // https://github.com/rjsf-team/react-jsonschema-form/issues/1263\n    this.extraErrors.forEach(extraError => {\n      if (!errors.find(error => error.stack === extraError.stack)) {\n        errors.push(extraError)\n      }\n    })\n\n    if (\n      this.navAction !== NavActionEnum.SUBMIT &&\n      this.navAction !== NavActionEnum.VALIDATE &&\n      (!this.props.isWizardMode || this.state.currentStep.final)\n    ) {\n      const currentStep = {\n        ...this.state.currentStep,\n      }\n      if (errors.length > 0) {\n        currentStep.state = StepStateEnum.ERROR\n      } else {\n        currentStep.state = StepStateEnum.COMPLETED\n      }\n\n      this.setState({ currentStep })\n\n      return []\n    }\n\n    // there is an odd behavior in the lib that in cases when we have additional fields depending on enum\n    // value if it's required and not entered we get 3 error: enum, required, and oneOf\n    // so if there is an error Oneof on a parent - ignore it and enum on a child. and just output 'required'\n    // if there is an enum error and there is required with the same prefix remove it\n\n    const reqErrors = errors.filter(error => error.name === 'required')\n    reqErrors.forEach(error => {\n      const parentPath = error.property.substring(\n        0,\n        error.property.lastIndexOf('.'),\n      )\n      _.remove(errors, (error: AjvError) => {\n        return (\n          error.property.indexOf(parentPath) > -1 &&\n          (error.name === 'enum' || error.name === 'oneOf')\n        )\n      })\n    })\n\n    return errors.map(error => {\n      error.message = error.message.replace('property', 'field')\n\n      return error\n    })\n  }\n\n  renderErrorListTemplate = (props: ErrorListProps) => {\n    const { errors } = props\n    const currentLis = errors\n      .map((error, i) => {\n        return renderTransformedErrorObject(\n          this.state.steps,\n          error,\n          this.uiSchema,\n          i,\n          this.props.schema,\n        )\n      })\n      .sort((a, b) => a.order - b.order)\n      .map(li => li.element)\n\n    return (\n      <div className=\"form-error-summary\">\n        <ul className=\"error-detail\">{currentLis}</ul>\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"outter-wrap\">\n        <Prompt\n          when={this.state.hasUnsavedChanges}\n          message={this.unsavedDataWarning}\n        />\n        <Header\n          isSubmitted={this.state.isSubmitted}\n          bodyText={this.state.currentStep.description}\n          title={this.props.formTitle}\n        ></Header>\n        <div>\n          <div className=\"inner-wrap\">\n            <StepsSideNav\n              stepList={this.state.steps}\n              isWizardMode={this.props.isWizardMode}\n              onStepChange={this.triggerStepChange}\n            ></StepsSideNav>\n            {this.state.isLoadingSaved && (\n              <div className=\"text-center\">\n                <span className={'spinner'} />\n              </div>\n            )}\n            <div className=\"form-wrap\">\n              <div className=\"form-title\">{this.state.currentStep.title}</div>\n              {this.renderNotification(this.props.callbackStatus)}\n              <div\n                className={`right-top-actions ${\n                  this.state.isSubmitted ? 'hide' : ''\n                }`}\n              >\n                {!this.state.currentStep.static && (\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-action save pull-right\"\n                    onClick={() => this.triggerAction(NavActionEnum.VALIDATE)}\n                  >\n                    VALIDATE\n                  </button>\n                )}\n                {this.renderHelpToggle(\n                  this.state.currentStep,\n                  this.state.doShowHelp,\n                  () =>\n                    this.setState({\n                      doShowHelp: !this.state.doShowHelp,\n                    }),\n                )}\n                {this.isSubmitScreen() && (\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-action save pull-right\"\n                    disabled={this.state.isSubmitted}\n                    onClick={() => this.triggerAction(NavActionEnum.SUBMIT)}\n                  >\n                    SUBMIT\n                  </button>\n                )}\n              </div>\n              {this.renderOptionalFormSubheader(this.props.isWizardMode)}\n              <div\n                className={\n                  this.isSubmitScreen() || this.state.currentStep.static\n                    ? 'hide-form-only'\n                    : 'wrap'\n                }\n              >\n                {this.state.hasValidated && (\n                  <div className=\"notification-area\">\n                    Great! All required data on this form has been entered.\n                  </div>\n                )}\n                <div\n                  ref={this.formDivRef}\n                  className={`scroll-area ${\n                    this.state.currentStep.excluded ? 'disabled' : ' '\n                  } `}\n                >\n                  <Form\n                    className={\n                      this.state.doShowHelp\n                        ? 'submissionInputForm'\n                        : 'submissionInputForm no-help'\n                    }\n                    liveValidate={false}\n                    formData={this.state.formData}\n                    schema={this.getSchema(this.state.currentStep)}\n                    uiSchema={this.uiSchema}\n                    onSubmit={this.onSubmit}\n                    onChange={args => this.handleOnChange(args)}\n                    onError={args =>\n                      this.onError({\n                        props: args,\n                        form: this.formRef,\n                      })\n                    }\n                    showErrorList={\n                      !!this.state.doShowErrors || !!this.props.isWizardMode\n                    }\n                    ErrorList={this.renderErrorListTemplate}\n                    transformErrors={this.transformErrors}\n                    ref={this.formRef}\n                    disabled={\n                      this.state.currentStep.excluded || this.state.isSubmitted\n                    }\n                  >\n                    <div style={{ display: 'none' }}>\n                      <button type=\"submit\"></button>\n                    </div>\n                  </Form>\n                  {this.renderTextForStaticScreen()}\n                  {!this.props.isWizardMode && (\n                    <NextStepLink\n                      steps={this.state.steps}\n                      nextStepId={this.state.currentStep.default}\n                      onNavAction={(step: Step) => this.triggerStepChange(step)}\n                    ></NextStepLink>\n                  )}\n                </div>\n              </div>\n\n              {this.isSubmitScreen() && (\n                <SummaryTable\n                  formData={this.state.formData}\n                  steps={this.state.steps}\n                  callbackFn={(screenId: string) =>\n                    this.showExcludeStateWarningModal(screenId, true)\n                  }\n                  uiSchema={this.props.uiSchema}\n                  schema={this.props.schema}\n                ></SummaryTable>\n              )}\n\n              <NavButtons\n                currentStep={this.state.currentStep}\n                steps={this.state.steps}\n                previousStepIds={this.state.previousStepIds}\n                isFormSubmitted={this.state.isSubmitted}\n                onNavAction={(e: NavActionEnum) => this.triggerAction(e)}\n              ></NavButtons>\n            </div>\n          </div>\n        </div>\n        {this.state.modalContext && (\n          <WarningModal\n            show={true}\n            title={this.excludeWarningHeader}\n            copy={this.excludeWarningText}\n            className={`theme-${this.props.formClass}`}\n            callbackArgs={this.state.modalContext.arguments}\n            onCancel={() => this.setState({ modalContext: undefined })}\n            onOK={(stepId: string, isExclude: boolean) =>\n              this.toggleExcludeStep(stepId, isExclude)\n            }\n          ></WarningModal>\n        )}\n        <DataDebug formData={this.state.formData} hidden={true}></DataDebug>\n      </div>\n    )\n  }\n}\n\n// takes in a single validation error and  and displays it in more readable manner\n// used by renderErrorListTemplate\nfunction renderTransformedErrorObject(\n  steps: Step[],\n  error: AjvError,\n  uiSchema: UiSchema,\n  i: number,\n  schema: any,\n): { order: number; element: JSX.Element } {\n  const propPath = _.trimStart(error.property, '.')\n  const propArr = propPath.split('.')\n\n  // some things require labels in schema (e.g. checkboxes) so this is preferred\n  const labelFromSchema = `${propArr.join('.properties.')}.title`\n  //can be overriden by label in UI\n  const labelFromUi = `${propPath}.ui:title`\n  //for array fields we need to change the property e.g.\n  //  ld50.experiments[0].species_other should look like 'ld50.experiments.items.species_other'\n  const arrayLabelFromSchema = labelFromSchema.replace(/\\[.*?\\]/, '.items')\n  const arrayLabelFromUI = labelFromUi.replace(/\\[.*?\\]/, '.items')\n  const indexMatch = labelFromSchema.match(/\\[.*?\\]/)\n\n  let index = _.first(indexMatch)\n\n  if (index) {\n    index = index.substring(1, index.length - 1)\n    index = !isNaN(parseInt(index)) ? ` [${parseInt(index) + 1}]` : ''\n  }\n\n  const label =\n    _.get(uiSchema, labelFromUi) ||\n    _.get(schema.properties, labelFromSchema) ||\n    _.get(uiSchema, arrayLabelFromUI) ||\n    _.get(schema.properties, arrayLabelFromSchema) ||\n    error.property\n\n  const screen = _.find(steps, { id: propArr[0] }) || {\n    title: propArr[0],\n    order: 0,\n  }\n  const element = (\n    <li key={i} className=\"\">\n      <span>\n        <strong>\n          {screen.title}\n          {index}:\n        </strong>\n        {label}&nbsp; {error.message}\n      </span>\n    </li>\n  )\n  return { order: screen.order, element }\n}\n\n//recursively sets property value to dangerouslySetInnerHTML of that value\nfunction stringToElementForProp(srcObject: any, key: string): object {\n  _.keys(srcObject).some(k => {\n    if (k === key) {\n      const value = srcObject[k]\n      srcObject[k] = <span dangerouslySetInnerHTML={{ __html: value }}></span>\n\n      return srcObject\n    }\n    if (srcObject[k] && typeof srcObject[k] === 'object') {\n      stringToElementForProp(srcObject[k], key)\n    }\n  })\n  return srcObject\n}\n","import $RefParser from 'json-schema-ref-parser'\nimport { get, includes } from 'lodash-es'\nimport * as React from 'react'\nimport Alert from 'react-bootstrap/Alert'\nimport { UiSchema } from 'react-jsonschema-form'\nimport { SynapseClient } from '../../utils'\nimport { SRC_SIGN_IN_CLASS } from '../../utils/SynapseConstants'\nimport { FileEntity, FormData } from '../../utils/synapseTypes/'\nimport SynapseForm from './SynapseForm'\nimport { StatusEnum } from './types'\n\nexport type UploadToolSearchParams = {\n  formDataId?: string //formDataId for user data form data\n  dataFileHandleId?: string //fileHandle to get userData\n  submitted?: boolean // if the file has been submitted\n  formGroupId: string\n}\n\nexport type SynapseFormWrapperProps = {\n  // Provide the parent container (folder/project), that should contain a folder (named <user_id>) that this user can write to.\n  formSchemaEntityId: string // Synapse file that contains the form schema.\n  formUiSchemaEntityId: string // Synapse file that contains the form ui schema.\n  formNavSchemaEntityId: string //Synapse file that consists screen nav schema\n  token?: string // user's session token\n  searchParams?: UploadToolSearchParams\n  isWizardMode?: boolean // if we are displaying the form in wizard mode\n  fileNamePath: string // path in data to specify the name of saved file\n  formTitle: string //for UI customization\n  formClass?: string // to support potential theaming\n}\n\ntype SynapseFormWrapperState = {\n  notification?: Notification\n  isLoading?: boolean\n  formDataId?: string // file holding user form data\n  formData?: any // form data that prepopulates the form\n  formSchema?: any // schema that drives the form\n  formUiSchema?: UiSchema // ui schema that directs how to render the form elements\n  formNavSchema?: any // drives the steps left panel\n\n  status?: StatusEnum\n}\n\ntype Error = {\n  name?: string\n  message?: string\n}\n\ninterface Notification extends Error {\n  type: StatusEnum\n}\n\nclass SynapseFormWrapper extends React.Component<\n  SynapseFormWrapperProps,\n  SynapseFormWrapperState\n> {\n  constructor(props: SynapseFormWrapperProps) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      formDataId: this.props?.searchParams?.formDataId,\n    }\n  }\n\n  async componentDidMount() {\n    await this.getData(this.props.token)\n  }\n\n  async componentDidUpdate(prevProps: SynapseFormWrapperProps) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      await this.getData(this.props.token)\n    }\n  }\n\n  //gets a file entity with content\n  getFileEntityData = async (\n    token: string,\n    entityId: string,\n    versionNumber?: string,\n  ): Promise<{ version?: number; content: JSON }> => {\n    try {\n      const entity: FileEntity = await SynapseClient.getEntity(\n        token,\n        entityId,\n        versionNumber,\n      )\n      const entityContent = await SynapseClient.getFileEntityContent(\n        token,\n        entity,\n      )\n      const content = JSON.parse(entityContent)\n      return {\n        version: entity.versionNumber,\n        content: content,\n      }\n    } catch (error) {\n      const newError = {\n        message: `${error.message}:  configuration data for ${entityId} failed to load`,\n      }\n      this.onError(newError)\n      return Promise.reject(newError)\n    }\n  }\n\n  //same as above but also uses $RefParser to convert json $refs to regular json\n  getFileEntityDataDereferenced = async (\n    token: string,\n    entityId: string,\n    versionNumber?: string,\n  ): Promise<{ version?: number; content: JSON }> => {\n    const { version, content } = await this.getFileEntityData(\n      token,\n      entityId,\n      versionNumber,\n    )\n    const derefContent = (await $RefParser.dereference(content)) as JSON\n    return {\n      version: version,\n      content: derefContent,\n    }\n  }\n\n  getData = async (token?: string): Promise<void> => {\n    if (!token) {\n      return\n    }\n    try {\n      let formData = {}\n      let dataFileHandleId: string | undefined\n      let submitted: boolean | undefined\n      let formSchemaVersion = undefined\n      let uiSchemaVersion = undefined\n      let navSchemaVersion = undefined\n      const { searchParams } = this.props\n      if (searchParams) {\n        ;({ dataFileHandleId, submitted } = searchParams)\n      }\n\n      //for not new form we need to get the data\n      //and if it is submitted form we need to pull appropriave schema versions\n      //for new form (no dataFileHandleId) we need to populate schema versions\n\n      if (dataFileHandleId) {\n        const fileData = await SynapseClient.getFileHandleContentFromID(\n          dataFileHandleId,\n          token,\n        )\n        formData = JSON.parse(fileData)\n        if (submitted && formData && formData['metadata']) {\n          ;({ formSchemaVersion, uiSchemaVersion, navSchemaVersion } = formData[\n            'metadata'\n          ])\n        }\n      }\n\n      const promises = [\n        this.getFileEntityDataDereferenced(\n          token,\n          this.props.formSchemaEntityId,\n          formSchemaVersion,\n        ),\n        this.getFileEntityData(\n          token,\n          this.props.formUiSchemaEntityId,\n          uiSchemaVersion,\n        ),\n        this.getFileEntityData(\n          token,\n          this.props.formNavSchemaEntityId,\n          navSchemaVersion,\n        ),\n      ]\n      const configData = await Promise.all(promises)\n\n      if (!dataFileHandleId) {\n        //if we are creating a new file - store the versions\n        formData = {\n          metadata: {\n            formSchemaVersion: configData[0].version,\n            uiSchemaVersion: configData[1].version,\n            navSchemaVersion: configData[2].version,\n          },\n        }\n      }\n      this.setState({\n        formData: formData,\n        formSchema: configData[0].content,\n        formUiSchema: configData[1].content,\n        formNavSchema: configData[2].content,\n        isLoading: false,\n      })\n    } catch (error) {\n      this.onError({ message: error })\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  finishedProcessing = (status: StatusEnum, message?: string) => {\n    this.setState({\n      isLoading: false,\n      notification: { type: status, message: message },\n      status: status,\n    })\n    //this will show the update message for 7 seconds\n    setTimeout(() => {\n      this.setState({ status: undefined })\n    }, 7000)\n  }\n\n  onError = (error: Error) => {\n    this.setState({\n      notification: {\n        type: StatusEnum.ERROR,\n        message: error.message,\n        name: error.name,\n      },\n      status: StatusEnum.ERROR,\n      isLoading: false,\n    })\n  }\n\n  submitForm = async (formData: any) => {\n    await this.saveToFile(formData)\n\n    this.setState({\n      isLoading: true,\n    })\n\n    await SynapseClient.submitFormData(this.state.formDataId!, this.props.token)\n    this.finishedProcessing(StatusEnum.SUBMIT_SUCCESS, 'File Submitted')\n  }\n\n  createOrUpdateFormDataFile = async (\n    fileName: string,\n    fileContentsBlob: Blob,\n  ): Promise<FormData> => {\n    fileName = `${fileName}.json`\n    const fileUploadComplete = await SynapseClient.uploadFile(\n      this.props.token,\n      fileName,\n      fileContentsBlob,\n    )\n    const { searchParams } = this.props\n    const formGroupId = searchParams && searchParams.formGroupId\n    if (!formGroupId) {\n      console.error('formGroupId must be defined')\n      throw 'formGroupId must be defined'\n    }\n    try {\n      // do we need to create a new file entity, or update an existing file entity?\n      const newFileHandleId = fileUploadComplete.fileHandleId\n\n      let formData\n      if (this.state.formDataId) {\n        formData = await SynapseClient.updateFormData(\n          this.state.formDataId,\n          fileName,\n          newFileHandleId,\n          this.props.token!,\n        )\n      } else {\n        formData = await SynapseClient.createFormData(\n          formGroupId,\n          fileName,\n          newFileHandleId,\n          this.props.token!,\n        )\n      }\n\n      return formData\n    } catch (error) {\n      this.onError(error)\n      throw error\n    }\n  }\n\n  saveToFile = async (data: any) => {\n    const fileName = get(data, this.props.fileNamePath)\n    this.setState({\n      status: StatusEnum.PROGRESS,\n      notification: { type: StatusEnum.PROGRESS, message: 'Progress' },\n      isLoading: true,\n    })\n\n    if (!fileName) {\n      // try to find corresponding property. By convention it should be first level property\n      // and follow pattern screen.prop\n      let errorTitle = 'File Name'\n      try {\n        // get it to the schema format\n        const searchString = `${this.props.fileNamePath.replace(\n          '.',\n          '.properties.',\n        )}.title`\n        errorTitle = get(\n          this.state.formSchema.properties,\n          searchString,\n          errorTitle,\n        )\n      } finally {\n        const error = `Please Provide the ${errorTitle} before saving`\n        this.onError({ message: error })\n      }\n      return\n    }\n\n    try {\n      const fileContent: Blob = new Blob([JSON.stringify(data)], {\n        type: 'text/json',\n      })\n\n      const formData = await this.createOrUpdateFormDataFile(\n        fileName,\n        fileContent,\n      )\n      this.setState({\n        formDataId: formData.formDataId,\n      })\n\n      this.finishedProcessing(StatusEnum.SAVE_SUCCESS, 'File Saved')\n    } catch (error) {\n      this.onError({ message: error })\n    }\n  }\n\n  isReadyToDisplayForm = (state: SynapseFormWrapperState): boolean => {\n    return (\n      this.state.status !== StatusEnum.ERROR_CRITICAL &&\n      state.formSchema &&\n      state.formUiSchema &&\n      state.formNavSchema &&\n      state.formData\n    )\n  }\n\n  renderLoader = (\n    state: SynapseFormWrapperState,\n    props: SynapseFormWrapperProps,\n  ): JSX.Element => {\n    if (\n      includes([StatusEnum.ERROR, StatusEnum.ERROR_CRITICAL], state.status) &&\n      props.token &&\n      state.isLoading\n    ) {\n      return (\n        <div className=\"text-center\">\n          <span className={'spinner'} />\n        </div>\n      )\n    } else {\n      return <></>\n    }\n  }\n\n  renderNotification = (notification?: Notification): JSX.Element => {\n    if (!notification) {\n      return <></>\n    }\n    if (notification.type === StatusEnum.ERROR) {\n      return (\n        <Alert\n          variant=\"danger\"\n          onClose={() => this.setState({ status: undefined })}\n        >\n          <Alert.Heading>Error</Alert.Heading>\n\n          <p>\n            {notification.name} {notification.message}\n          </p>\n        </Alert>\n      )\n    }\n\n    return <></>\n  }\n\n  renderUnauthenticatedView = (token: string | undefined) => {\n    if (token) {\n      return <></>\n    } else {\n      return (\n        <div className=\"panel padding-full unauthenticated text-center\">\n          Please\n          <button\n            className={`SRC-standard-button-shape SRC-light-button SRC-sign-in-button ${SRC_SIGN_IN_CLASS}`}\n          >\n            sign in\n          </button>\n          to initiate or continue your submission\n        </div>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div className={`theme-${this.props.formClass}`}>\n        <div className=\"SRC-ReactJsonForm\">\n          {this.renderNotification(this.state.notification)}\n          {this.renderLoader(this.state, this.props)}\n          {this.renderUnauthenticatedView(this.props.token)}\n\n          {this.isReadyToDisplayForm(this.state) && (\n            <div>\n              <SynapseForm\n                schema={this.state.formSchema}\n                uiSchema={this.state.formUiSchema!}\n                formData={this.state.formData}\n                navSchema={this.state.formNavSchema}\n                isWizardMode={this.props.isWizardMode}\n                formTitle={this.props.formTitle}\n                formClass={this.props.formClass}\n                callbackStatus={this.state.status}\n                onSave={(data: any) => this.saveToFile(data)}\n                onSubmit={(data: any) => this.submitForm(data)}\n                isSubmitted={\n                  this.props.searchParams && !!this.props.searchParams.submitted\n                }\n              ></SynapseForm>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default SynapseFormWrapper\n","import * as React from 'react'\n\nimport { SynapseClient } from '../../utils'\nimport {\n  FormData,\n  ListRequest,\n  StatusEnum,\n  ListResponse,\n} from '../../utils/synapseTypes/'\nimport { faTrash, faPhone } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport WarningModal from './WarningModal'\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\n\nimport moment from 'moment'\nimport { SRC_SIGN_IN_CLASS } from '../../utils/SynapseConstants'\nimport NoSubmissionsIcon from '../../assets/icons/json-form-tool-no-submissions.svg'\n\n\nexport type SynapseFormSubmissionGridProps = {\n  token?: string\n  formGroupId: string\n  pathpart: string\n  formClass?: string\n  itemNoun: string\n}\n\ntype FileListType = 'IN_PROGRESS' | 'SUBMITTED'\n\ntype SynapseFormSubmissionGridState = {\n  inProgress: {\n    fileList: FormData[]\n    nextPageToken?: string\n  }\n  submitted: {\n    fileList: FormData[]\n    nextPageToken?: string\n  }\n  isLoading: boolean\n  isShowInfoModal: boolean\n  modalContext?: { action: Function; arguments: any[] }\n}\n\nexport default class SynapseFormSubmissionGrid extends React.Component<\n  SynapseFormSubmissionGridProps,\n  SynapseFormSubmissionGridState\n> {\n  modalTitle = 'Trash Submission?'\n  listingText = {\n    inProgress: {\n      subhead: 'In Progress',\n      noRecords: `You don't have submissions in progress`,\n    },\n    submitted: {\n      subhead: 'Submitted',\n      noRecords: `You don't have anything submitted`,\n    },\n  }\n  modalCopy = (\n    <>\n      <p>\n        This submission is currently incomplete and has not been submitted. If\n        you trash this submission, you won't be able to recover the data.\n      </p>\n      <p>Are you sure you want to trash this submission?</p>\n    </>\n  )\n  static requestFilter = {\n    IN_PROGRESS: [StatusEnum.WAITING_FOR_SUBMISSION],\n    SUBMITTED: [\n      StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n      StatusEnum.ACCEPTED,\n      StatusEnum.REJECTED,\n    ],\n  }\n\n  constructor(props: SynapseFormSubmissionGridProps) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      isShowInfoModal: false,\n      inProgress: {\n        fileList: [],\n      },\n      submitted: {\n        fileList: [],\n      },\n    }\n  }\n\n  async componentDidMount() {\n    await this.refresh(this.props.token)\n  }\n\n  async componentDidUpdate(prevProps: SynapseFormSubmissionGridProps) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      await this.refresh(this.props.token)\n    }\n  }\n\n  async refresh(token?: string) {\n    if (token) {\n      await this.getUserFileListing().catch(error => {\n        this.onError(error)\n      })\n    }\n  }\n\n  getTypeFileListing = async (\n    filter: StatusEnum[],\n    nextPageToken?: string,\n  ): Promise<{ fileList: FormData[]; nextPageToken?: string }> => {\n    this.setState({\n      isLoading: true,\n    })\n    const token = this.props.token\n    const groupId = this.props.formGroupId\n    try {\n      const cleanUpName = (item: FormData): FormData => {\n        item = { ...item, ...{ name: item.name.replace('.json', '') } }\n        return item\n      }\n      const request: ListRequest = {\n        filterByState: filter,\n        groupId,\n        nextPageToken: nextPageToken,\n      }\n\n      const response: ListResponse = await SynapseClient.listFormData(\n        request,\n        token,\n      )\n      const fileList = response.page\n        ? response.page.map(item => cleanUpName(item))\n        : []\n\n      return {\n        fileList,\n        nextPageToken: response.nextPageToken,\n      }\n    } catch (error) {\n      this.onError(error)\n      return Promise.reject(error)\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  getMore = async (fileListType: FileListType, nextPageToken: string) => {\n    const statusList =\n      fileListType === 'SUBMITTED'\n        ? SynapseFormSubmissionGrid.requestFilter.SUBMITTED\n        : SynapseFormSubmissionGrid.requestFilter.IN_PROGRESS\n    const result = await this.getTypeFileListing(statusList, nextPageToken)\n    if (fileListType === 'SUBMITTED') {\n      this.setState(prevState => ({\n        submitted: {\n          fileList: [...prevState.submitted.fileList, ...result.fileList],\n          nextPageToken: result.nextPageToken,\n        },\n      }))\n    } else {\n      this.setState(prevState => ({\n        inProgress: {\n          fileList: [...prevState.inProgress.fileList, ...result.fileList],\n          nextPageToken: result.nextPageToken,\n        },\n      }))\n    }\n  }\n\n  getUserFileListing = async (): Promise<void> => {\n    const inProgress = await this.getTypeFileListing(\n      SynapseFormSubmissionGrid.requestFilter.IN_PROGRESS,\n      this.state.inProgress.nextPageToken,\n    )\n    const submitted = await this.getTypeFileListing(\n      SynapseFormSubmissionGrid.requestFilter.SUBMITTED,\n      this.state.submitted.nextPageToken,\n    )\n\n    this.setState({\n      inProgress: inProgress,\n      submitted: submitted,\n    })\n\n    return\n  }\n  onError = (args: any) => {\n    console.log(args)\n  }\n\n  deleteFile = async (token: string, formDataId: string): Promise<any> => {\n    this.setState({\n      isLoading: true,\n      modalContext: undefined,\n    })\n    try {\n      await SynapseClient.deleteFormData(formDataId, token)\n      //await this.getUserFileListing(token, this.props.formGroupId)\n      this.setState((prevState, props) => ({\n        inProgress: {\n          fileList: prevState.inProgress.fileList.filter(\n            item => item.formDataId !== formDataId,\n          ),\n          nextPageToken: prevState.inProgress.nextPageToken,\n        },\n      }))\n    } catch (error) {\n      this.onError(error)\n      return []\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  setModalConfirmationState = (token: string, formDataId: string) => {\n    this.setState({\n      modalContext: {\n        action: this.deleteFile,\n        arguments: [token, formDataId],\n      },\n    })\n  }\n  /* ------------------------------------------   rendering fns  ------------------------------------------------*/\n\n  renderLoading = (\n    token: string | undefined,\n    isLoading: boolean,\n  ): JSX.Element => {\n    if (token && isLoading) {\n      return (\n        <div className=\"text-center\">\n          <span>Loading&hellip;</span>\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        </div>\n      )\n    } else {\n      return <></>\n    }\n  }\n\n  renderUnauthenticatedView = (token: string | undefined) => {\n    if (token) {\n      return <></>\n    } else {\n      return (\n        <div className=\"file-grid\">\n          <h3>Your Submissions</h3>\n          <div className=\"panel padding-full unauthenticated text-center\">\n          <p className=\"padding-full\">Please sign in or register to initiate or continue your submission</p>\n            <button className={`btn btn-large ${SRC_SIGN_IN_CLASS}`}>\n              sign in\n            </button>\n          </div>\n        </div>\n      )\n    }\n  }\n\n  renderSubmissionsTable = (\n    fileList: FormData[],\n    pathpart: string,\n    formGroupId: string,\n    fileListType: FileListType,\n    nextPageToken?: string,\n  ): JSX.Element => {\n    if (!formGroupId) {\n      this.onError('Form Group ID is undefined')\n      return <></>\n    }\n    const isInProgress = fileListType === 'IN_PROGRESS'\n    const textSource = isInProgress\n      ? this.listingText.inProgress\n      : this.listingText.submitted\n\n    const subhead = <h4>{textSource.subhead}</h4>\n    const tableTitleRow = isInProgress ? (\n      <tr>\n        <th>Submission Name</th>\n        <th>Edited On</th>\n        <th></th>\n        <th></th>\n      </tr>\n    ) : (\n      <tr>\n        <th>Submission Name</th>\n        <th>Submitted On</th>\n        <th>Status</th>\n        <th></th>\n      </tr>\n    )\n\n    let content = (\n      <h5 className=\"text-center no-submissions padding-full\">\n        {textSource.noRecords}\n      </h5>\n    )\n    const viewMore = nextPageToken ? (\n      <div className=\"view-more\">\n        <button\n          className=\"btn btn-link\"\n          onClick={() => this.getMore(fileListType, nextPageToken)}\n        >\n          more ...\n        </button>\n      </div>\n    ) : (\n      <></>\n    )\n    if (fileList.length > 0) {\n      content = (\n        <div className=\"file-table\" key={`table${fileListType}`}>\n          <table className=\"table\">\n            <thead>{tableTitleRow}</thead>\n            <tbody>\n              {fileList.map((dataFileRecord, key) => {\n                if (isInProgress) {\n                  return (\n                    <tr key={dataFileRecord.formDataId! + key + fileListType}>\n                      <td>\n                        <a\n                          href={`${pathpart}?formGroupId=${formGroupId}&formDataId=${dataFileRecord.formDataId}&dataFileHandleId=${dataFileRecord.dataFileHandleId}`}\n                        >\n                          {dataFileRecord.name}\n                        </a>\n                      </td>\n                      <td>{moment(dataFileRecord.modifiedOn).calendar()}</td>\n                      <td>&nbsp;</td>\n                      <td className=\"text-right\">\n                        <button\n                          className=\"btn\"\n                          aria-label=\"delete\"\n                          onClick={() =>\n                            this.setModalConfirmationState(\n                              this.props.token!,\n                              dataFileRecord.formDataId!,\n                            )\n                          }\n                        >\n                          <FontAwesomeIcon\n                            icon={faTrash}\n                            aria-hidden=\"true\"\n                          ></FontAwesomeIcon>\n                        </button>\n                      </td>\n                    </tr>\n                  )\n                } else {\n                  return (\n                    <tr key={dataFileRecord.formDataId! + key}>\n                      <td>\n                        <a\n                          href={`${pathpart}?formGroupId=${formGroupId}&formDataId=${dataFileRecord.formDataId}&dataFileHandleId=${dataFileRecord.dataFileHandleId}&submitted=1`}\n                        >\n                          {dataFileRecord.name}\n                        </a>\n                      </td>\n                      <td>{moment(dataFileRecord.modifiedOn).calendar()}</td>\n                      <td>{dataFileRecord.submissionStatus.state}</td>\n                      <td className=\"text-right\">\n                        <button\n                          className=\"btn\"\n                          aria-label=\"information\"\n                          onClick={() =>\n                            this.setState({ isShowInfoModal: true })\n                          }\n                        >\n                          <FontAwesomeIcon\n                            icon={faPhone}\n                            aria-hidden=\"true\"\n                          ></FontAwesomeIcon>\n                        </button>\n                      </td>\n                    </tr>\n                  )\n                }\n              })}\n            </tbody>\n          </table>\n          {viewMore}\n        </div>\n      )\n    }\n    return (\n      <div key={`grid-${fileListType}`}>\n        {subhead} {content}\n      </div>\n    )\n  }\n\n  renderSubmissionsTables = (\n    inProgress: { fileList: FormData[]; nextPageToken?: string },\n    submitted: { fileList: FormData[]; nextPageToken?: string },\n    pathpart: string,\n    formGroupId: string,\n  ): JSX.Element[] | JSX.Element => {\n    if (inProgress.fileList.length === 0 && submitted.fileList.length === 0) {\n      return (\n        <div className=\"text-center\">\n          <img src={NoSubmissionsIcon} alt=\"no submissions\"></img>\n          <p className=\"padding-full\">You have no submissions</p>\n        </div>\n      )\n    } else {\n      return [\n        this.renderSubmissionsTable(\n          inProgress.fileList,\n          pathpart,\n          formGroupId,\n          'IN_PROGRESS',\n          inProgress.nextPageToken,\n        ),\n\n       this.renderSubmissionsTable(\n          submitted.fileList,\n          pathpart,\n          formGroupId,\n          'SUBMITTED',\n          submitted.nextPageToken,\n        ),\n      ]\n    }\n  }\n\n  render() {\n    return (\n      <div className={`theme-${this.props.formClass}`}>\n        <div className=\"SRC-ReactJsonForm\">\n          {this.renderLoading(this.props.token, this.state.isLoading)}\n          {this.renderUnauthenticatedView(this.props.token)}\n\n          {!this.state.isLoading && (\n            <div className=\"file-grid \">\n              <h3>Your Submissions</h3>\n              <div className=\"panel panel-default padding-full\">\n                {this.renderSubmissionsTables(\n                  this.state.inProgress,\n                  this.state.submitted,\n                  this.props.pathpart,\n                  this.props.formGroupId,\n                )}\n\n                <div className=\"text-center\">\n                  <a\n                    className=\"btn btn-large\"\n                    href={`${this.props.pathpart}?formGroupId=${this.props.formGroupId}`}\n                  >\n                    Add new {this.props.itemNoun}\n                  </a>\n                </div>\n              </div>\n            </div>\n          )}\n          {this.state.modalContext && (\n            <WarningModal\n              className={`theme-${this.props.formClass}`}\n              show={typeof this.state.modalContext !== 'undefined'}\n              title={this.modalTitle}\n              copy={this.modalCopy}\n              callbackArgs={this.state.modalContext.arguments}\n              onCancel={() => this.setState({ modalContext: undefined })}\n              onOK={(token: string, formDataId: string) =>\n                this.deleteFile(token, formDataId)\n              }\n            />\n          )}\n\n          <Modal\n            show={this.state.isShowInfoModal}\n            animation={false}\n            className={`theme-${this.props.formClass}`}\n          >\n            <Modal.Header\n              closeButton={false}\n              onHide={() => this.setState({ isShowInfoModal: false })}\n            >\n              <Modal.Title>More Information</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n              Please <a href=\"mailto:ModelAD@iupui.edu\">contact us</a> for more\n              information about your submission\n            </Modal.Body>\n            <Modal.Footer>\n              <Button\n                variant=\"success\"\n                onClick={() => this.setState({ isShowInfoModal: false })}\n              >\n                OK\n              </Button>\n            </Modal.Footer>\n          </Modal>\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { SynapseClient, SynapseConstants } from '../utils'\nimport { getNextPageOfData } from '../utils/functions/queryUtils'\nimport {\n  insertConditionsFromSearchParams,\n  KeyValue,\n  SQLOperator,\n  parseEntityIdFromSqlStatement,\n} from '../utils/functions/sqlFunctions'\nimport { QueryBundleRequest, QueryResultBundle } from '../utils/synapseTypes/'\nimport CardContainer from './CardContainer'\nimport { GenericCardSchema, IconOptions } from './GenericCard'\n// TODO: this import nearly doubles the package size of SRC as a UMD build by ~400KB\n// will have to find a way to use individual lodash packages instead of the entire thing\nimport { cloneDeep, isEqual } from 'lodash-es'\nexport interface CardLink {\n  baseURL: string\n  // the key that will go into the url\n  URLColumnName: string\n  // the column name who's value will be used\n  matchColumnName: string\n  isMarkdown: false\n  // the value that will go into the url link should be surrounded with parenthesis, making the search\n  // param study=(ROSMAP) instead of study=ROSMAP\n  wrapValueWithParens?: boolean\n}\n\nexport type MarkdownLink = {\n  isMarkdown: true\n  // the columns whos value will be used for the markdown\n  matchColumnName: string\n}\n\nexport type MarkdownValue = {\n  isMarkdown: true\n}\n\n// Specify the indices in the values [] that should be rendered specially\nexport type LabelLinkConfig = (MarkdownLink | CardLink)[]\n\nexport type CommonCardProps = {\n  genericCardSchema?: GenericCardSchema\n  secondaryLabelLimit?: number\n  titleLinkConfig?: CardLink\n  labelLinkConfig?: LabelLinkConfig\n  descriptionLinkConfig?: MarkdownValue\n  rgbIndex?: number\n}\n\nexport type CardConfiguration = {\n  type: string\n  hasInternalLink?: boolean\n  iconOptions?: IconOptions\n} & CommonCardProps\n\nexport type CardContainerLogicProps = {\n  token?: string\n  limit?: number\n  title?: string\n  unitDescription?: string\n  sqlOperator?: SQLOperator\n  searchParams?: KeyValue\n  facet?: string\n  facetAliases?: {}\n  backgroundColor?: string\n  rgbIndex?: number\n  isHeader?: boolean\n  isAlignToLeftNav?: boolean\n  sql: string\n} & CardConfiguration\n\ntype State = {\n  data: QueryResultBundle | undefined\n  isLoading: boolean\n  queryRequest: QueryBundleRequest\n  totalResultsNoFacet: number\n  hasMoreData: boolean\n}\n\n/**\n * Class wraps around CardContainer and serves as a standalone logic container for rendering cards.\n * This same logic exists in QueryWrapper, but the two serve two distinct purposes, making this component\n * sufficiently distinct.\n *\n * @class CardContainerLogic\n * @extends {React.Component}\n */\nexport default class CardContainerLogic extends React.Component<\n  CardContainerLogicProps,\n  State\n> {\n  public static defaultProps = {\n    token: '',\n  }\n\n  public static defaultState = {\n    data: undefined,\n    isLoading: true,\n    queryRequest: {} as QueryBundleRequest,\n    totalResultsNoFacet: 0,\n    hasMoreData: true,\n  }\n\n  constructor(props: CardContainerLogicProps) {\n    super(props)\n    this.executeInitialQueryRequest = this.executeInitialQueryRequest.bind(this)\n    this.getLastQueryRequest = this.getLastQueryRequest.bind(this)\n    this.getNextPageOfData = this.getNextPageOfData.bind(this)\n    this.state = CardContainerLogic.defaultState\n  }\n\n  /**\n   * Compute default query request\n   *\n   * @memberof QueryWrapper\n   */\n  public componentDidMount() {\n    this.executeInitialQueryRequest()\n  }\n\n  /**\n   * @memberof QueryWrapper\n   *\n   */\n  public componentDidUpdate(prevProps: CardContainerLogicProps) {\n    /**\n     *  If token has changed (they signed in) or sql query has changed\n     *  or search params have updated then perform an update.\n     */\n    const { searchParams: prevSearchParams = {} } = prevProps\n    const { searchParams: currentSearchParams = {} } = this.props\n    const hasSearchParamsChanged = !isEqual(\n      prevSearchParams,\n      currentSearchParams,\n    )\n    const hasTokenChanged = this.props.token !== prevProps.token\n    const hasSqlChanged = this.props.sql !== prevProps.sql\n    if (hasTokenChanged || hasSqlChanged || hasSearchParamsChanged) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * last query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getLastQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.state.queryRequest)\n  }\n\n  /**\n   * Grab the next page of data, pulling in 25 more rows.\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public async getNextPageOfData(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true,\n    })\n\n    await getNextPageOfData(\n      queryRequest,\n      this.state.data!,\n      this.props.token,\n    ).then(newState => {\n      this.setState({\n        ...newState,\n        isLoading: false,\n        queryRequest: cloneDeep(queryRequest),\n      })\n    })\n  }\n\n  /**\n   * Execute the initial query passed into the component\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeInitialQueryRequest() {\n    this.setState({\n      isLoading: true,\n    })\n\n    let sqlUsed = this.props.sql\n    if (this.props.searchParams) {\n      sqlUsed = insertConditionsFromSearchParams(\n        this.props.searchParams,\n        this.props.sql,\n        this.props.sqlOperator,\n      )\n    }\n    const entityId = parseEntityIdFromSqlStatement(sqlUsed)\n\n    // we don't set this in the state because it hardcodes the sql query, on componentDidUpdate\n    // we need the sql to change\n    const initQueryRequest: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask:\n        SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n        SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n        SynapseConstants.BUNDLE_MASK_QUERY_RESULTS |\n        SynapseConstants.BUNDLE_MASK_QUERY_COUNT,\n      entityId,\n      query: {\n        sql: sqlUsed,\n        limit: 25,\n        offset: 0,\n      },\n    }\n\n    SynapseClient.getQueryTableResults(initQueryRequest, this.props.token)\n      .then((data: QueryResultBundle) => {\n        const queryRequestWithoutCount = cloneDeep(initQueryRequest)\n        queryRequestWithoutCount.partMask =\n          SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n          SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n          SynapseConstants.BUNDLE_MASK_QUERY_RESULTS\n\n        const hasMoreData =\n          data.queryResult.queryResults.rows.length ===\n          SynapseConstants.PAGE_SIZE\n        const newState = {\n          hasMoreData,\n          data,\n          queryRequest: queryRequestWithoutCount,\n          isLoading: false,\n          totalResultsNoFacet: data.queryCount!,\n        }\n        this.setState(newState)\n      })\n      .catch(err => {\n        console.log('Failed to get data ', err)\n      })\n  }\n\n  /**\n   * Render the children without any formatting\n   */\n  public render() {\n    // only forward the necessary props\n    const { sql, searchParams, token, ...rest } = this.props\n    return (\n      <CardContainer\n        {...rest}\n        data={this.state.data}\n        token={token}\n        getLastQueryRequest={this.getLastQueryRequest}\n        getNextPageOfData={this.getNextPageOfData}\n        hasMoreData={this.state.hasMoreData}\n        isLoading={this.state.isLoading}\n      />\n    )\n  }\n}\n","import React, { useEffect, useState } from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faDownload } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { Link, withRouter, RouteComponentProps } from 'react-router-dom'\nimport { SynapseClient } from '../../utils'\nimport { DownloadList } from '../../utils/synapseTypes'\nimport { DOWNLOAD_LIST_CHANGE_EVENT } from '../../utils/functions/dispatchDownloadListChangeEvent'\nimport DownloadListTable from './DownloadListTable'\nimport ReactTooltip from 'react-tooltip'\nimport { TOOLTIP_DELAY_SHOW } from '../table/SynapseTableConstants'\n\nlibrary.add(faDownload)\n\nexport type ShowDownloadProps = {\n  token?: string\n  to?: string\n}\n\nfunction ShowDownload({ token, to }: ShowDownloadProps & RouteComponentProps) {\n  const [downloadList, setDownloadList] = useState<DownloadList | undefined>(\n    undefined,\n  )\n  const [showDownloadModal, setShowDownloadModal] = useState(false)\n  const idForToolTip = 'SHOW_DOWNLOAD_TOOLTIP'\n  const tooltipText = 'Click to view items in your download list.'\n  useEffect(() => {\n    if (!token) {\n      return\n    }\n    const updateDownloadList = async (\n      event?: CustomEventInit<DownloadList>,\n    ) => {\n      if (event?.detail) {\n        setDownloadList(event.detail)\n      } else {\n        // for initialization\n        SynapseClient.getDownloadList(token).then((downloadList) => {\n          setDownloadList(downloadList)\n        })\n      }\n    }\n    updateDownloadList()\n    document.addEventListener(DOWNLOAD_LIST_CHANGE_EVENT, updateDownloadList)\n    return () => {\n      document.removeEventListener(\n        DOWNLOAD_LIST_CHANGE_EVENT,\n        updateDownloadList,\n      )\n    }\n  }, [token])\n\n  if (!token) {\n    return <></>\n  }\n  const size = downloadList?.filesToDownload.length ?? 0\n  if (size === 0 && !showDownloadModal) {\n    // close only if the download modal is already closed too\n    return <></>\n  }\n  const positionClass = to ? 'position-by-anchor' : 'position-by-button'\n  const content = (\n    <>\n      <span id={idForToolTip} data-for={idForToolTip} data-tip={tooltipText}>\n        <span className=\"icon-container\">\n          <FontAwesomeIcon icon=\"download\" />\n        </span>\n        <span className={`download-size ${positionClass}`}>{size}</span>\n      </span>\n      <ReactTooltip\n        delayShow={TOOLTIP_DELAY_SHOW}\n        place={'bottom'}\n        type={'dark'}\n        effect={'solid'}\n        border={true}\n        id={idForToolTip}\n      />\n    </>\n  )\n\n  return to ? (\n    <Link className=\"Download-Link SRC-userImgSmall\" to={to}>\n      {content}\n    </Link>\n  ) : (\n    <>\n      <button\n        onClick={() => setShowDownloadModal(true)}\n        className=\"Download-Link\"\n      >\n        {content}\n      </button>\n      {showDownloadModal && (\n        <DownloadListTable\n          token={token}\n          renderAsModal={true}\n          onHide={() => setShowDownloadModal(false)}\n        />\n      )}\n    </>\n  )\n}\n\nexport default withRouter(ShowDownload)\n","import { QueryBundleRequest, QueryResultBundle } from '../synapseTypes'\nimport { useState } from 'react'\nimport useDeepCompareEffect from 'use-deep-compare-effect'\nimport { SynapseClientError } from '../SynapseClient'\nimport { SynapseClient } from '..'\n\nexport type GetQueryResultBundleProps = {\n  queryBundleRequest: QueryBundleRequest\n  token?: string\n}\n\ntype State = {\n  queryResultBundle: QueryResultBundle | undefined\n  isLoading: boolean\n  error: SynapseClientError | undefined\n}\n\nexport default function useGetQueryResultBundle(\n  props: GetQueryResultBundleProps,\n) {\n  const { queryBundleRequest, token } = props\n  const [state, setState] = useState<State>({\n    isLoading: false,\n    error: undefined,\n    queryResultBundle: undefined,\n  })\n\n  const { isLoading, error, queryResultBundle } = state\n  useDeepCompareEffect(() => {\n    const getData = async () => {\n      if (isLoading) {\n        return\n      }\n      setState({\n        isLoading: true,\n        error: undefined,\n        queryResultBundle: undefined,\n      })\n      try {\n        const data = await SynapseClient.getQueryTableResults(\n          queryBundleRequest,\n          token,\n        )\n        setState({\n          queryResultBundle: data,\n          error: undefined,\n          isLoading: false,\n        })\n      } catch (err) {\n        setState({\n          queryResultBundle: undefined,\n          error: err,\n          isLoading: false,\n        })\n      }\n    }\n    getData()\n  }, [queryBundleRequest, token])\n\n  return { queryResultBundle, error, isLoading }\n}\n","import { useEffect, useState } from 'react'\nexport type UseShowDesktopProps = number\n\nexport const MOBILE_VIEWPORT_WIDTH = 600\n\nexport default function useShowDesktop(breakpoint?: UseShowDesktopProps) {\n  let usedBreakpoint = breakpoint ?? MOBILE_VIEWPORT_WIDTH\n  const [showDesktop, setShowDesktop] = useState(\n    window.innerWidth > usedBreakpoint,\n  )\n  useEffect(() => {\n    const listener = () => {\n      const updatedValue = window.innerWidth > usedBreakpoint\n      if (updatedValue !== showDesktop) {\n        setShowDesktop(updatedValue)\n      }\n    }\n    window.addEventListener('resize', listener)\n    return () => {\n      window.removeEventListener('resize', listener)\n    }\n  })\n\n  return showDesktop\n}\n","import React, { useState } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport type ExpandableContentProps = {\n  title: JSX.Element\n  content: JSX.Element\n}\n\nexport default function ExpandableContent({\n  title,\n  content,\n}: ExpandableContentProps) {\n  const [isExpanded, setIsExpanded] = useState(false)\n\n  return (\n    <div className=\"ExpandableContent\">\n      <div className={'ExpandableContent__button__container'}>\n        <button\n          className={isExpanded ? 'expanded' : ''}\n          onClick={() => setIsExpanded(!isExpanded)}\n        >\n          <span>{title}</span>\n          <FontAwesomeIcon\n            className=\"SRC-primary-action-color\"\n            icon={isExpanded ? 'times' : 'plus'}\n          />\n        </button>\n      </div>\n      <div\n        className={`ExpandableContent__content__container ${\n          isExpanded ? '' : 'hide'\n        }`}\n      >\n        {content}\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { GoalsDataProps } from './Goals'\nimport ExpandableContent from '../ExpandableContent'\nimport QueryCount from '../../../containers/QueryCount'\n\nexport default function ({\n  link,\n  summary,\n  tableId,\n  title,\n  token,\n}: GoalsDataProps) {\n  const titleElement = (\n    <div className=\"Goals__Mobile__Header\">\n      <span className=\"Goals__Mobile__Header__Count\">\n        <QueryCount\n          parens={false}\n          sql={`SELECT * FROM ${tableId}`}\n          token={token}\n          name=\"\"\n        />\n      </span>\n      <span className=\"Goals__Mobile__Header__Title\"> {title} </span>\n    </div>\n  )\n  const content = (\n    <div className=\"Goals__Mobile__Content\">\n      <p>{summary}</p>\n      <a className=\"Goals__Mobile__Content__Link\" href={link}>\n        EXPLORE\n      </a>\n    </div>\n  )\n  return <ExpandableContent title={titleElement} content={content} />\n}\n","import React, { useEffect, useState } from 'react'\nimport {\n  QueryResultBundle,\n  QueryBundleRequest,\n  FileHandleAssociation,\n  FileHandleAssociateType,\n  BatchFileRequest,\n} from '../../../utils/synapseTypes'\nimport { SynapseConstants } from '../../../utils'\nimport { SynapseClientError, getFiles } from '../../../utils/SynapseClient'\nimport { Error } from '../../Error'\nimport useGetQueryResultBundle from '../../../utils/hooks/useGetQueryResultBundle'\nimport useShowDesktop from '../../../utils/hooks/useShowDesktop'\nimport GoalsMobile from './Goals.Mobile'\nimport GoalsDesktop from './Goals.Desktop'\n\nexport type GoalsProps = {\n  entityId: string\n  token?: string\n}\n\nexport type GoalsDataProps = {\n  tableId: string\n  title: string\n  summary: string\n  link: string\n  asset: string\n  token?: string\n}\n\nenum ExpectedColumns {\n  TABLEID = 'TableId',\n  TITLE = 'Title',\n  SUMMARY = 'Summary',\n  LINK = 'Link',\n  ASSET = 'Asset',\n}\n\nexport const getFieldIndex = (\n  name: string,\n  result: QueryResultBundle | undefined,\n) => {\n  return (\n    result?.selectColumns?.findIndex(el => {\n      return el.name === name\n    }) ?? -1\n  )\n}\n\nexport default function (props: GoalsProps) {\n  const { entityId, token } = props\n  const [assets, setAssets] = useState<string[] | undefined>()\n  const [error, setError] = useState<string | SynapseClientError | undefined>()\n  const showDesktop = useShowDesktop()\n  const queryBundleRequest: QueryBundleRequest = {\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    entityId,\n    partMask:\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    query: {\n      sql: `select TableId, Title, Summary, Link, Asset from ${entityId} order by ItemOrder`,\n    },\n  }\n  const { queryResultBundle } = useGetQueryResultBundle({\n    token,\n    queryBundleRequest,\n  })\n\n  useEffect(() => {\n    const getData = async () => {\n      try {\n        const assetColumnIndex = getFieldIndex(\n          ExpectedColumns.ASSET,\n          queryResultBundle,\n        )\n        const assets =\n          queryResultBundle?.queryResult.queryResults.rows.map(\n            el => el.values[assetColumnIndex],\n          ) ?? []\n        if (assets.length === 0) {\n          // wait for data to load\n          return\n        }\n        const fileHandleAssociationList: FileHandleAssociation[] = assets.map(\n          fileId => {\n            return {\n              associateObjectId: entityId!,\n              associateObjectType: FileHandleAssociateType.TableEntity,\n              fileHandleId: fileId,\n            }\n          },\n        )\n        const batchFileRequest: BatchFileRequest = {\n          includeFileHandles: false,\n          includePreSignedURLs: true,\n          includePreviewPreSignedURLs: false,\n          requestedFiles: fileHandleAssociationList,\n        }\n        const files = await getFiles(batchFileRequest, token)\n        setError(undefined)\n        setAssets(\n          files.requestedFiles\n            .filter(el => el.preSignedURL !== undefined)\n            .map(el => el.preSignedURL!),\n        )\n      } catch (e) {\n        console.error('Error on get data', e)\n        setError(e)\n      }\n    }\n    getData()\n  }, [entityId, token, queryResultBundle])\n\n  const tableIdColumnIndex = getFieldIndex(\n    ExpectedColumns.TABLEID,\n    queryResultBundle,\n  )\n  const titleColumnIndex = getFieldIndex(\n    ExpectedColumns.TITLE,\n    queryResultBundle,\n  )\n  const summaryColumnIndex = getFieldIndex(\n    ExpectedColumns.SUMMARY,\n    queryResultBundle,\n  )\n  const linkColumnIndex = getFieldIndex(ExpectedColumns.LINK, queryResultBundle)\n\n  return (\n    <div className={`Goals${showDesktop ? '__Desktop' : ''}`}>\n      {error && <Error error={error} token={token} />}\n      {queryResultBundle?.queryResult.queryResults.rows.map((el, index) => {\n        const values = el.values\n        const tableId = values[tableIdColumnIndex]\n        const title = values[titleColumnIndex]\n        const summary = values[summaryColumnIndex]\n        const link = values[linkColumnIndex]\n        // assume that we recieve assets in order of rows and there is an asset for each item\n        // can revisit if this isn't the case.\n        const asset = assets?.[index] ?? ''\n        const goalsDataProps: GoalsDataProps = {\n          tableId,\n          title,\n          summary,\n          link,\n          asset,\n          token,\n        }\n        return showDesktop ? (\n          <GoalsDesktop {...goalsDataProps} />\n        ) : (\n          <GoalsMobile {...goalsDataProps} />\n        )\n      })}\n    </div>\n  )\n}\n","import React from 'react'\nimport { GoalsDataProps } from './Goals'\nimport QueryCount from '../../../containers/QueryCount'\n\nexport default function GoalsDesktop({\n  asset,\n  link,\n  summary,\n  tableId,\n  title,\n  token,\n}: GoalsDataProps) {\n  return (\n    <div className=\"Goals__Card\">\n      <div\n        className=\"Goals__Card__header\"\n        style={{ background: `url('${asset}')` }}\n      >\n        <p>\n          <span className=\"Goals__Card__header__title\"> {title} </span>\n          <span className=\"Goals__Card__header__count\">\n            <QueryCount\n              parens={false}\n              sql={`SELECT * FROM ${tableId}`}\n              token={token}\n              name=\"\"\n            />\n          </span>\n        </p>\n      </div>\n      <div className=\"Goals__Card__summary\">\n        <p> {summary} </p>\n        <p>\n          <a className=\"Goals__Card__summary__link\" href={link}>\n            EXPLORE\n          </a>\n        </p>\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { ProgramsDataProps } from './Programs'\nimport ExpandableContent from '../ExpandableContent'\nimport { Icon } from '../../../containers/row_renderers/utils'\n\nexport default function ({\n  link,\n  summary,\n  title,\n  color,\n  iconValue,\n  iconOptions, \n  exploreLink,\n}: ProgramsDataProps) {\n  const titleElement = (\n    <div className=\"Programs__Mobile__Header\">\n      <Icon type={iconValue} iconOptions={iconOptions}/>\n      <span className=\"Programs__Mobile__Header__Title\"> {title} </span>\n    </div>\n  )\n  const content = (\n    <div className=\"Programs__Mobile__Content\">\n      {link && <p className=\"Programs__Card__header__info__link\">\n        <a\n        style={{borderBottom: `1px solid ${color}`}}\n        href={link}>\n          Visit website\n        </a>\n      </p>}\n      <p>{summary}</p>\n      <p>\n        <a href={exploreLink} className=\"homepage-button-link\">\n            EXPLORE\n        </a>\n      </p>\n    </div>\n  )\n  return <ExpandableContent title={titleElement} content={content} />\n}\n","import React from 'react'\nimport { ProgramsDataProps } from './Programs'\nimport { Icon } from '../../../containers/row_renderers/utils'\n\nexport default function ProgramsDesktop({\n  link,\n  summary,\n  title,\n  color,\n  iconValue,\n  iconOptions, \n  exploreLink,\n}: ProgramsDataProps) {\n  return (\n    <div className=\"Programs__Card\">\n      <div\n        className=\"Programs__Card__header\"\n        style={{backgroundColor: color.replace(')', ',.05)')}}\n      >\n        <div className=\"Programs__Card__header__icon\">\n          <Icon type={iconValue} iconOptions={iconOptions} />\n        </div>\n        <div className=\"Programs__Card__header__info\">\n          <span className=\"Programs__Card__header__info__title\"> {title} </span>\n          {link && <p className=\"Programs__Card__header__info__link\">\n            <a\n            style={{borderBottom: `1px solid ${color}`}}\n            href={link}>\n              Visit website\n            </a>\n          </p>}\n        </div>\n      </div>\n      <div className=\"Programs__Card__summary\">\n        <p> {summary} </p>\n        <p>\n          <a href={exploreLink} className=\"homepage-button-link\">\n              EXPLORE\n          </a>\n        </p>\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport {\n  QueryResultBundle,\n  QueryBundleRequest,\n} from '../../../utils/synapseTypes'\nimport { SynapseConstants } from '../../../utils'\n\nimport useGetQueryResultBundle from '../../../utils/hooks/useGetQueryResultBundle'\nimport useShowDesktop from '../../../utils/hooks/useShowDesktop'\nimport ProgramsMobile from './Programs.Mobile'\nimport ProgramsDesktop from './Programs.Desktop'\nimport { getColorPallette } from '../../../containers/ColorGradient'\nimport { CardLink } from '../../../containers/CardContainerLogic'\nimport { IconOptions } from '../../../containers/GenericCard'\n\nexport type ProgramsProps = {\n  entityId: string\n  rgbIndex: number\n  titleColumnName: string\n  linkColumnName: string\n  summaryColumnName: string\n  iconColumnName: string\n  linkConfig: CardLink\n  iconOptions: IconOptions\n  token?: string  \n}\n\nexport type ProgramsDataProps = {\n  title: string\n  summary: string\n  link: string\n  exploreLink: string\n  color: string\n  iconValue: string\n  iconOptions: IconOptions\n}\n\nexport const getFieldIndex = (\n  name: string,\n  result: QueryResultBundle | undefined,\n) => {\n  return (\n    result?.selectColumns?.findIndex(el => {\n      return el.name === name\n    }) ?? -1\n  )\n}\n\nexport default function (props: ProgramsProps) {\n  const { entityId, titleColumnName, linkColumnName, summaryColumnName, iconColumnName, linkConfig, token, rgbIndex, iconOptions } = props\n  const showDesktop = useShowDesktop()\n  const color:string = getColorPallette(rgbIndex ?? 0, 2).colorPalette[0]\n  const queryBundleRequest: QueryBundleRequest = {\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    entityId,\n    partMask:\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    query: {\n      sql: `select * from ${entityId}`,\n    },\n  }\n  const { queryResultBundle } = useGetQueryResultBundle({\n    token,\n    queryBundleRequest,\n  })\n\n  const titleColumnIndex = getFieldIndex(\n    titleColumnName,\n    queryResultBundle,\n  )\n  const summaryColumnIndex = getFieldIndex(\n    summaryColumnName,\n    queryResultBundle,\n  )\n  const linkColumnIndex = getFieldIndex(linkColumnName, queryResultBundle)\n  const iconColumnIndex = getFieldIndex(iconColumnName, queryResultBundle)\n  const matchColIndex = getFieldIndex(linkConfig.matchColumnName, queryResultBundle)\n  const baseExploreUrl = `/${linkConfig.baseURL}?${linkConfig.URLColumnName}=`\n  return (\n    <div className={`Programs${showDesktop ? '__Desktop' : ''}`}>\n      {queryResultBundle?.queryResult.queryResults.rows.map((el, index) => {\n        const values = el.values\n        const title = values[titleColumnIndex]\n        const summary = values[summaryColumnIndex]\n        const link = values[linkColumnIndex]\n        const iconValue = values[iconColumnIndex]\n        const matchValue = values[matchColIndex]\n        \n        const ProgramsDataProps: ProgramsDataProps = {\n          title,\n          summary,\n          link,\n          color,\n          exploreLink: `${baseExploreUrl}${matchValue}`,\n          iconValue,\n          iconOptions,\n        }\n        return showDesktop ? (\n          <ProgramsDesktop {...ProgramsDataProps} />\n        ) : (\n          <ProgramsMobile {...ProgramsDataProps} />\n        )\n      })}\n    </div>\n  )\n}\n","import React from 'react'\nimport { QueryBundleRequest } from '../../../utils/synapseTypes'\nimport { SynapseConstants } from '../../../utils'\nimport { Error } from '../../Error'\nimport { getFieldIndex } from '../goals/Goals'\nimport useGetQueryResultBundle from '../../../utils/hooks/useGetQueryResultBundle'\nimport ResourcesDesktop from './Resources.Desktop'\nimport ResourcesMobile from './Resources.Mobile'\nimport useShowDesktop from '../../../utils/hooks/useShowDesktop'\n\nexport type ResourcesProps = {\n  entityId: string\n  token?: string\n}\n\nenum ExpectedColumns {\n  NAME = 'Name',\n  WIKI = 'Wiki',\n}\n\nexport type Data = {\n  name: string\n  ownerId: string\n  wikiId: string\n}[]\n\nexport default function Resources(props: ResourcesProps) {\n  const { entityId, token } = props\n  const showDesktop = useShowDesktop()\n\n  const queryBundleRequest: QueryBundleRequest = {\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    entityId,\n    partMask:\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    query: {\n      sql: `SELECT Name, Wiki FROM ${entityId} ORDER BY ItemOrder`,\n    },\n  }\n  const { queryResultBundle, error } = useGetQueryResultBundle({\n    token,\n    queryBundleRequest,\n  })\n\n  const nameIndex = getFieldIndex(ExpectedColumns.NAME, queryResultBundle)\n  const wikiIndex = getFieldIndex(ExpectedColumns.WIKI, queryResultBundle)\n  const data: Data =\n    queryResultBundle?.queryResult.queryResults.rows.map(el => {\n      const values = el.values\n      const name = values[nameIndex]\n      const wikiValue = values[wikiIndex] ?? ''\n      const split = wikiValue.split('/')\n      const ownerId = split[0]\n      const wikiId = split[2]\n      return {\n        name,\n        ownerId,\n        wikiId,\n      }\n    }) ?? []\n  return (\n    <div className=\"Resources\">\n      <Error error={error} token={token} />\n      {showDesktop ? (\n        <ResourcesDesktop data={data} token={token} />\n      ) : (\n        <ResourcesMobile data={data} token={token} />\n      )}\n    </div>\n  )\n}\n","import { Data } from './Resources'\nimport React, { useState } from 'react'\nimport MarkdownSynapse from '../../MarkdownSynapse'\n\nexport type ResourcesDesktopProps = {\n  data: Data\n  token?: string\n}\n\nexport default function ResourcesDesktop({\n  data,\n  token,\n}: ResourcesDesktopProps) {\n  const [index, setIndex] = useState(0)\n  return (\n    <div className=\"control-container\">\n      <div className=\"button-container\">\n        {data?.map((el, curIndex) => {\n          return (\n            <button\n              className={index === curIndex ? 'isSelected' : ''}\n              onClick={() => setIndex(curIndex)}\n              key={el.name}\n            >\n              {el.name}\n            </button>\n          )\n        })}\n        {/* \n            This button keeps the border line in the button container running from top to bottom,\n            it doesn't have any functionality.\n          */}\n        <button className=\"gap-fill\" />\n      </div>\n      <div className=\"content-container\">\n        {data?.map((el, curIndex) => {\n          const { ownerId, wikiId } = el\n          return (\n            <span key={ownerId} className={index === curIndex ? '' : 'hide'}>\n              <MarkdownSynapse\n                token={token}\n                ownerId={ownerId}\n                wikiId={wikiId}\n              />\n            </span>\n          )\n        })}\n      </div>\n    </div>\n  )\n}\n","import React from 'react'\nimport { Data } from './Resources'\nimport MarkdownSynapse from '../../../containers/MarkdownSynapse'\nimport ExpandableContent from '../ExpandableContent'\n\nexport type ResourcesMobileProps = {\n  data: Data\n  token?: string\n}\n\nexport default function ResourcesMobile({ data, token }: ResourcesMobileProps) {\n  return (\n    <div className=\"Resources_Mobile\">\n      {data.map(({ name, ownerId, wikiId }) => {\n        let title = <> {name} </>\n        let markdown = (\n          <MarkdownSynapse token={token} ownerId={ownerId} wikiId={wikiId} />\n        )\n        return <ExpandableContent title={title} content={markdown} />\n      })}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { library, IconProp } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faLongArrowAltUp,\n  faLongArrowAltDown,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport Parser from 'rss-parser'\nlibrary.add(faLongArrowAltUp)\nlibrary.add(faLongArrowAltDown)\nlet rssParser = new Parser()\ntype RssState = {\n  rssFeed: any\n  isLoadingError: boolean\n  isShowingMoreItems: boolean\n  itemId2MoreItem: {}\n}\n\nexport type RssFeedProps = {\n  url: string\n  defaultItemsToShow: number\n  showMoreElements: boolean\n}\n\nconst parser = new DOMParser()\n\n/**\n * Deprecated, use RssFeedCards instead\n */\nexport default class RssFeed extends React.Component<RssFeedProps, RssState> {\n  // only update the state if this component is mounted\n  _isMounted = false\n  \n  constructor(props: RssFeedProps) {\n    super(props)\n    this.state = {\n      rssFeed: {},\n      isLoadingError: false,\n      isShowingMoreItems: false,\n      itemId2MoreItem: {},\n    }\n  }\n  \n  componentDidMount() {\n    this._isMounted = true\n    const { url } = this.props\n    fetch(url)\n      .then(response => response.text())\n      .then(responseData => rssParser.parseString(responseData))\n      .then(rss => {\n        if (this._isMounted) {\n          this.setState({ rssFeed: rss })\n        }\n      })\n      .catch(err => {\n        if (this._isMounted) {\n          this.setState({ isLoadingError: true })\n        }\n      })\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false\n  }\n  public onToggleReadMore = (itemId: string) => (\n    event: React.SyntheticEvent<HTMLButtonElement>,\n  ) => {\n    let feedItemContentDiv = document.getElementById(itemId)\n    if (!this.state.itemId2MoreItem[itemId]) {\n      this.state.itemId2MoreItem[itemId] = {\n        text: 'View full post',\n        icon: 'long-arrow-alt-down',\n      }\n    }\n    const isShow: boolean = this.state.itemId2MoreItem[itemId].text.includes(\n      'View full post',\n    )\n    if (feedItemContentDiv) {\n      let foundMoreItem: boolean = false\n      // hide or show the elements after the More element\n      for (let i = 0; i < feedItemContentDiv.children.length; i++) {\n        // skip over children until we find the id that starts with 'more-'\n        let child = feedItemContentDiv.children[i]\n        if (foundMoreItem) {\n          if (isShow) {\n            child.classList.remove('hidden')\n          } else {\n            child.classList.add('hidden')\n          }\n        } else {\n          foundMoreItem = child.id.includes('more-')\n        }\n      }\n    }\n    // toggle, by updating text and icon\n    const newText: string = isShow ? 'Hide' : 'View full post'\n    const newIcon: IconProp = isShow\n      ? 'long-arrow-alt-up'\n      : 'long-arrow-alt-down'\n    this.state.itemId2MoreItem[itemId] = {\n      text: newText,\n      icon: newIcon,\n    }\n    this.setState({ itemId2MoreItem: this.state.itemId2MoreItem })\n  }\n\n  public onClickShowMoreItems = () => (\n    event: React.SyntheticEvent<HTMLButtonElement>,\n  ) => {\n    this.setState({ isShowingMoreItems: true })\n  }\n\n  render() {\n    return (\n      <ul className=\"srcRssFeed\">\n        {this.state.rssFeed.items &&\n          this.state.rssFeed.items.map((item: any, index: any) => {\n            // There are 2 \"more\" buttons here.  One is to hide long article content.  See moreElement and onClickReadMore()\n            // The other is to hide the large number of items in a particular feed (usually a max of 10 are returned).  See state.isShowingMoreItems\n            let parsedHtml = parser.parseFromString(\n              item['content:encoded'],\n              'text/html',\n            )\n            let bodyElement = parsedHtml.querySelector('body')\n            let moreElement = this.props.showMoreElements && parsedHtml.querySelector('[id^=\"more-\"]')\n            if (moreElement && bodyElement) {\n              let foundMoreElement = false\n              const children = bodyElement.children\n              for (let i = 0; i < children.length; i++) {\n                let child = children[i]\n                if (foundMoreElement) {\n                  child.classList.add('hidden')\n                }\n                if (child === moreElement) {\n                  foundMoreElement = true\n                }\n              }\n            }\n            let isItemVisible: boolean =\n              index < this.props.defaultItemsToShow ||\n              this.state.isShowingMoreItems\n\n            let showMoreText: string = 'View full post'\n            let showMoreIcon: IconProp = 'long-arrow-alt-down'\n            if (this.state.itemId2MoreItem[item.guid]) {\n              showMoreText = this.state.itemId2MoreItem[item.guid].text\n              showMoreIcon = this.state.itemId2MoreItem[item.guid].icon\n            }\n            return (\n              <li\n                key={item.guid}\n                className={`srcRssFeedItem ${isItemVisible ? '' : 'hidden'}`}\n              >\n                <div className=\"srcRssFeedItemContent\">\n                  <div\n                    id={item.guid}\n                    dangerouslySetInnerHTML={{\n                      __html: parsedHtml.documentElement.innerHTML,\n                    }}\n                  ></div>\n                  {moreElement && (\n                    <div className=\"clearfix\">\n                      <button\n                        style={{\n                          textAlign: 'left',\n                          margin: 0,\n                          padding: '0px 50px 25px 35px',\n                        }}\n                        className=\"SRC-primary-text-color SRC-basicButton SRC-floatRight\"\n                        onClick={this.onToggleReadMore(item.guid)}\n                      >\n                        {showMoreText}\n                        <FontAwesomeIcon\n                          key={`${item.guid}${index}`}\n                          style={{ marginLeft: '5px' }}\n                          icon={showMoreIcon}\n                        />\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </li>\n            )\n          })}\n        {this.state.rssFeed.items &&\n          this.state.rssFeed.items.length > this.props.defaultItemsToShow &&\n          !this.state.isShowingMoreItems && (\n            <div className=\"clearfix\">\n              <button\n                className=\"btn SRC-grayBackground SRC-roundBorder SRC-floatRight\"\n                onClick={this.onClickShowMoreItems()}\n              >\n                View All\n              </button>\n            </div>\n          )}\n        {this.state.isLoadingError && (\n          <div>Unable to load feed: {this.props.url}</div>\n        )}\n      </ul>\n    )\n  }\n}\n","import * as React from 'react'\n\nexport type TwitterFeedProps = {\n  href: string\n}\n\n/**\n * Deprecated, UI clashes with rest of site.\n */\nexport default class TwitterFeed extends React.Component<TwitterFeedProps> {\n  constructor(props: TwitterFeedProps) {\n    super(props)\n  }\n\n  componentDidMount() {\n    if (typeof (window as any).twttr !== 'undefined') {\n      ;(window as any).twttr.widgets.load(\n        document.getElementById(this.props.href),\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <a\n          id={this.props.href}\n          className=\"twitter-timeline\"\n          data-height=\"600\"\n          data-theme=\"light\"\n          href={this.props.href}\n        ></a>\n      </div>\n    )\n  }\n}\n","\nimport * as React from 'react'\nimport RssFeed from './RssFeed'\nimport TwitterFeed from './TwitterFeed'\nimport MailchimpSubscribe from 'react-mailchimp-subscribe'\nimport { KeyValue } from '../utils/functions/sqlFunctions'\nimport { isEqual } from 'lodash-es'\nimport { Link } from 'react-router-dom'\n\nexport type MenuConfig = {\n  feedName: string\n  feedDescription: string\n  feedUrl: string\n  feedKeyValue?: KeyValue\n  defaultItemsToShow: number\n  mailChimpListName?: string\n  mailChimpUrl?: string\n  twitterFeedUrl?: string\n}\nexport type NewsFeedMenuProps = {\n  menuConfig: MenuConfig[]\n  searchParams?: KeyValue\n  routeToNewsFeed: string // news feed nav bar links are hardcoded to this route, with query params set to the selected menu config key/value\n}\n\n/**\n * Deprecated, use RssFeedCards instead\n */\nexport default class NewsFeedMenu extends React.Component<\n  NewsFeedMenuProps,\n  {}\n> {\n  constructor(props: NewsFeedMenuProps) {\n    super(props)\n    this.getMenuIndex = this.getMenuIndex.bind(this)\n  }\n\n  public render() {\n    const menuIndex = this.getMenuIndex()\n    const menuDropdown = this.renderMenu()\n    const { menuConfig } = this.props\n    const {\n      feedName,\n      feedDescription,\n      feedUrl,\n      feedKeyValue,\n      defaultItemsToShow,\n      mailChimpUrl,\n      twitterFeedUrl,\n      mailChimpListName,\n    } = menuConfig[menuIndex]\n    let modifiedFeedUrl = feedUrl\n    if (feedKeyValue) {\n      Object.getOwnPropertyNames(feedKeyValue).forEach(key => {\n        modifiedFeedUrl = `${modifiedFeedUrl}&${key}=${feedKeyValue[key]}`\n      })\n    }\n    return (\n      <div className=\"row\">\n        <div className=\"col-xs-2 SRC-menuLayout SRC-menuPadding\">\n          {menuDropdown}\n        </div>\n        <div className=\"col-xs-10\">\n          {\n            <>\n              {mailChimpUrl && (\n                <div className=\"SRC-mailchimpSubscribeContainer\">\n                  <h4>Subscribe</h4>\n                  <p className=\"SRC-marginBottomTop\">\n                    Subscribe to receive the {mailChimpListName} by e-mail,\n                    which provides information and updates related to the\n                    Portal. You can opt out at any time by using the unsubscribe\n                    link within the e-mail. We will not share your information\n                    with any third parties or use it for any other purposes.\n                  </p>\n                  <div className=\"SRC-marginBottomTop\">\n                    <MailchimpSubscribe url={mailChimpUrl} />\n                  </div>\n                </div>\n              )}\n              <h3 className=\"srcRssFeed\">{feedName}</h3>\n              <p>{feedDescription}</p>\n              <RssFeed\n                key={modifiedFeedUrl}\n                url={modifiedFeedUrl}\n                defaultItemsToShow={defaultItemsToShow}\n                showMoreElements={true}\n              />\n            </>\n          }\n          {twitterFeedUrl && <TwitterFeed href={twitterFeedUrl} />}\n        </div>\n      </div>\n    )\n  }\n\n  getMenuIndex = () => {\n    let menuIndex = 0\n    if (this.props.searchParams) {\n      // do the search params match a menu config?\n      this.props.menuConfig.forEach((config, index) => {\n        if (\n          config.feedKeyValue &&\n          isEqual(this.props.searchParams, config.feedKeyValue)\n        ) {\n          menuIndex = index\n        }\n      })\n    }\n    return menuIndex\n  }\n\n  private renderMenu() {\n    const menuIndex = this.getMenuIndex()\n    const { menuConfig, routeToNewsFeed } = this.props\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const isSelected: boolean = index === menuIndex\n      const style: any = {}\n      let selectedStyling: string = ''\n      if (isSelected) {\n        selectedStyling =\n          'SRC-pointed SRC-whiteText SRC-primary-background-color SRC-pointed-triangle-right SRC-primary-background-color-border-left'\n      } else {\n        selectedStyling = 'SRC-blackText SRC-light-background'\n      }\n      const urlParams = new URLSearchParams(window.location.search)\n      if (config.feedKeyValue) {\n        Object.getOwnPropertyNames(config.feedKeyValue).forEach(key => {\n          urlParams.set(key, config.feedKeyValue![key])\n        })\n      }\n      return (\n        <Link\n          key={config.feedName}\n          className={`SRC-hand-cursor SRC-menu-button-base SRC-gap SRC-hoverWhiteText SRC-primary-background-color-hover SRC-no-underline-on-hover ${selectedStyling}`}\n          role=\"button\"\n          tabIndex={0}\n          style={style}\n          to={{\n            pathname: routeToNewsFeed,\n            search: urlParams + '',\n          }}\n        >\n          {config.feedName}\n        </Link>\n      )\n    })\n  }\n}\n","import * as React from 'react'\nimport Parser from 'rss-parser'\nimport moment from 'moment'\nimport subscribePlus from '../assets/icons/subscribe_plus.svg'\nimport MailchimpSubscribe from 'react-mailchimp-subscribe'\n\nlet rssParser = new Parser()\ntype RssState = {\n  rssFeed: any\n  isLoadingError: boolean\n  itemId2MoreItem: {}\n  isShowingSubscribeUI: boolean\n}\n\nexport type RssFeedCardsProps = {\n  url: string\n  itemsToShow: number\n  allowCategories: string[]\n  mailChimpListName?: string\n  mailChimpUrl?: string\n}\nexport default class RssFeedCards extends React.Component<RssFeedCardsProps, RssState> {\n  // only update the state if this component is mounted\n  _isMounted = false\n  \n  constructor(props: RssFeedCardsProps) {\n    super(props)\n    this.state = {\n      rssFeed: {},\n      isLoadingError: false,\n      itemId2MoreItem: {},\n      isShowingSubscribeUI: false,\n    }\n  }\n  \n  componentDidMount() {\n    this._isMounted = true\n    const { url } = this.props\n    fetch(url)\n      .then(response => response.text())\n      .then(responseData => rssParser.parseString(responseData))\n      .then(rss => {\n        if (this._isMounted) {\n          this.setState({ rssFeed: rss })\n        }\n      })\n      .catch(err => {\n        if (this._isMounted) {\n          this.setState({ isLoadingError: true })\n        }\n      })\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false\n  }\n\n  public onClickSubscribe = () => {\n    this.setState({ isShowingSubscribeUI: true })\n  }\n\n  render() {\n    return (\n      <>        \n        {this.props.mailChimpUrl && (\n          <div className=\"RssFeedSubscribe text-center\">\n            {!this.state.isShowingSubscribeUI && (\n              <a className=\"RssFeedSubscribeToNewsLink\" onClick={this.onClickSubscribe}>\n                <img src={subscribePlus} alt=\"Subscribe to News\" />\n                Subscribe to News\n              </a>\n            )}\n            {this.state.isShowingSubscribeUI && (\n                <div className=\"MailchimpSubscribeContainer\">\n                  <img src={subscribePlus} alt=\"Subscribe to News\" />\n                  <p>\n                    Subscribe to receive the {this.props.mailChimpListName} by e-mail,\n                    which provides information and updates related to the\n                    Portal. You can opt out at any time by using the unsubscribe\n                    link within the e-mail. We will not share your information\n                    with any third parties or use it for any other purposes.\n                  </p>\n                  <div className=\"SRC-marginBottomTop\">\n                    <MailchimpSubscribe url={this.props.mailChimpUrl} />\n                  </div>\n                </div>\n            )}\n          </div>\n        )}\n        <div className=\"RssFeed\">\n          <div className=\"RssFeedItems\">\n          {this.state.rssFeed.items &&\n            this.state.rssFeed.items.map((item: any, index: any) => {\n              // The other is to hide the large number of items in a particular feed (usually a max of 10 are returned).  See state.isShowingMoreItems\n              let isItemVisible: boolean =\n                index < this.props.itemsToShow\n\n              return (\n                <div\n                  key={item.guid}\n                  className={`RssFeedItem ${isItemVisible ? '' : 'hidden'}`}\n                >\n                  <div>\n                    <div className=\"RssFeedItemCategories\">\n                      {item['categories'].map((categoryName: string,) => {\n                        // are we allowed to show this category/tag?\n                        const categoryNameLowerCase = categoryName.toLowerCase()\n                        const allowCategories = this.props.allowCategories\n                        if (allowCategories.findIndex(item => categoryNameLowerCase === item.toLowerCase()) === -1)\n                          return <></>\n                        // else\n                        return <a \n                          href={`${this.state.rssFeed.link}/?tag=${categoryName.replace(' ', '-')}`}\n                          className=\"SRC-no-underline-on-hover\"\n                          target=\"_blank\" rel=\"noopener noreferrer\">\n                            <div key={`${item.guid}_${categoryName}`} className=\"RssFeedItemCategory\">{categoryName}</div>\n                        </a>\n                      })}\n                    </div>\n                    <p className=\"RssFeedItemDate\">\n                      {moment(item['isoDate']).format('MMMM YYYY')}\n                    </p>\n                    <p className=\"RssFeedItemTitle\">{item['title']}</p>\n                    <div className=\"RssFeedItemDescription\"\n                    >{item['contentSnippet'].replace(/\\[...\\]|\\[\\]/gm, '')}</div>\n                    <a className=\"RssFeedItemLink\" href={item['link']} target=\"_blank\">Continue reading</a>\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n          {this.state.rssFeed.items &&\n            this.state.rssFeed.items.length > this.props.itemsToShow && (\n              <div className=\"RssFeedViewAllNewsButtonContainer\">\n                <a className=\"homepage-button-link\" href={this.state.rssFeed.link} target=\"_blank\" rel=\"noopener noreferrer\">\n                    VIEW ALL NEWS\n                </a>\n              </div>\n            )}\n          {this.state.isLoadingError && (\n            <div>Unable to load feed: {this.props.url}</div>\n          )}\n        </div>\n      </>\n    )\n  }\n}\n","import React, { FunctionComponent /*, useState , useEffect */ } from 'react' // importing FunctionComponent\nimport Plotly from 'plotly.js-basic-dist'\nimport * as PlotlyTyped from 'plotly.js'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { GraphItem, PlotStyle, Dictionary } from './types'\nimport _ from 'lodash-es'\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type DotPlotProps = {\n  plotData: GraphItem[]\n  layoutConfig: Partial<PlotlyTyped.Layout>\n  optionsConfig: Partial<PlotlyTyped.Config>\n  label?: string\n  style?: React.CSSProperties\n  id: string\n  isLegend?: boolean\n  isXAxis?: boolean\n  xMax?: number\n  plotStyle?: PlotStyle\n  markerSymbols?: Dictionary\n  onClick?: Function\n}\n\ntype LayoutOptions = {\n  isLegend: boolean\n  isXAxis: boolean\n  maxValue?: number\n  backgroundColor?: string\n}\n\nfunction getLayout(\n  dotPlotLayoutConfig: Partial<PlotlyTyped.Layout>,\n  layoutOptions?: LayoutOptions,\n): Partial<PlotlyTyped.Layout> {\n  const result = _.cloneDeep(dotPlotLayoutConfig)\n  if (!layoutOptions) {\n    return result\n  }\n  if (layoutOptions.backgroundColor) {\n    result.plot_bgcolor = layoutOptions.backgroundColor\n  }\n  result.yaxis!.showticklabels = false\n  result.xaxis!.range = [-5, layoutOptions.maxValue! + 30]\n  result.xaxis!.visible = layoutOptions.isXAxis\n  result.showlegend = layoutOptions.isLegend\n  result.margin = {\n    t: 0,\n    b: layoutOptions.isXAxis ? 50 : 0,\n    l: 0,\n    r: 0,\n    pad: 15,\n  }\n  let height = 30\n  if (layoutOptions.isLegend) {\n    height = 35\n    result.margin.pad = 0\n    result.xaxis = {\n      visible: false,\n      zeroline: false,\n      showgrid: false,\n      showline: false,\n      range: [0, 1],\n    }\n\n    result.yaxis = {\n      visible: false,\n      showline: false,\n    }\n  }\n  if (layoutOptions.isXAxis) {\n    result.yaxis = {\n      visible: false,\n      showgrid: false,\n      showline: false,\n    }\n    height = 50\n  }\n\n  result.height = height\n\n  return result\n}\n\nfunction createArrayOfGroupValues(\n  headers: string[],\n  items: GraphItem[],\n): any[] {\n  const result = new Array(headers.length)\n  items.forEach(item => {\n    const index = headers.indexOf(item.y)\n    result[index] = item.x\n  })\n  return result\n}\n\nfunction getPlotDataPoints(\n  graphItems: GraphItem[],\n  plotStyle: PlotStyle,\n  ySorted?: string[],\n  markerSymbols?: Dictionary,\n): any[] {\n  const isFakeData = ySorted === undefined\n  var groups = _.uniq(graphItems.map(item => item.group))\n  const data: any = []\n  const defaultSymbols = [\n    'y-down',\n    'triangle-up',\n    'cross-thin-open',\n    'triangle-up-open-dot',\n    'star-square-open',\n    'diamond-x',\n  ]\n\n  groups.forEach((group, i) => {\n    data.push({\n      type: 'scatter',\n\n      x: isFakeData\n        ? [-10] // fake datavalue outside of the bounds\n        : createArrayOfGroupValues(\n            ySorted!,\n            graphItems.filter(row => row.group === group),\n          ),\n      y: ySorted,\n      text: [group],\n      hovertemplate: `%{x} %{text}<extra></extra>`,\n      mode: 'markers',\n      name: group,\n      marker: {\n        color: plotStyle.markerFill,\n        line: {\n          color: plotStyle.markerLine,\n          width: 1,\n        },\n\n        symbol: markerSymbols ? markerSymbols[group] : defaultSymbols[i],\n        size: plotStyle.markerSize,\n      },\n    })\n  })\n  return data\n}\n\nconst DotPlot: FunctionComponent<DotPlotProps> = ({\n  plotData,\n  optionsConfig,\n  layoutConfig,\n  label,\n  id,\n  xMax,\n  style = { width: '100%', height: '100%' },\n  markerSymbols,\n  plotStyle = {\n    markerFill: '#515359',\n    markerLine: '#515359',\n    markerSize: 9,\n    backgroundColor: 'transparent',\n  },\n  onClick,\n  isLegend = false,\n  isXAxis = false,\n}: DotPlotProps) => {\n  const pointsTypes = label ? [label] : undefined\n\n  return (\n    <Plot\n      key={`dotPlot_${id}`}\n      layout={getLayout(layoutConfig, {\n        isLegend: isLegend,\n        isXAxis: isXAxis,\n        maxValue: xMax,\n        backgroundColor: plotStyle.backgroundColor,\n      })}\n      style={style}\n      data={getPlotDataPoints(plotData, plotStyle, pointsTypes, markerSymbols)}\n      config={optionsConfig}\n      onClick={(e: any) => (onClick ? onClick(e) : _.noop)}\n    />\n  )\n}\n\nexport default DotPlot\n","import React, { FunctionComponent } from 'react'\nimport Plotly from 'plotly.js-basic-dist'\nimport * as PlotlyTyped from 'plotly.js'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { GraphItem, BarPlotColors, PlotStyle } from './types'\nimport _ from 'lodash-es'\n\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type BarPlotProps = {\n  isTop: boolean\n  style?: React.CSSProperties\n  plotData: GraphItem[]\n  layoutConfig: Partial<PlotlyTyped.Layout>\n  optionsConfig: Partial<PlotlyTyped.Config>\n  label: string\n  xMax: number\n  colors?: BarPlotColors\n  plotStyle?: PlotStyle\n  onClick?: Function\n}\n\ntype LayoutOptions = {\n  isTop: boolean\n  maxValue: number\n  isLegend?: boolean\n  backgroundColor?: string\n}\n\nfunction getBarPlotDataPoints(\n  data: any[],\n  filter?: string,\n  colors?: BarPlotColors,\n): any[] {\n  if (filter) {\n    data = data.filter(item => item.y === filter)\n  }\n  var groups = _.uniq(data.map(item => item['group'])).sort()\n  const result: any[] = []\n  const defaultColors = [`(28,118,175,1)`, `rgba(91,176,181,1)`]\n\n  groups.forEach((group, i) => {\n    const items = data.filter(item => item.group === group)\n    result.push({\n      x: items.map(item => item.x),\n      y: items.map(item => item.y),\n      name: group,\n      orientation: 'h',\n      marker: {\n        color: colors ? colors[group] : defaultColors[i],\n        width: 1,\n      },\n      text: [group],\n      hovertemplate: `%{x} %{text}<extra></extra>`,\n      type: 'bar',\n    })\n  })\n\n  return result\n}\n\nfunction getLayout(\n  layoutConfig: Partial<PlotlyTyped.Layout>,\n  { isTop, maxValue, backgroundColor }: LayoutOptions,\n): Partial<PlotlyTyped.Layout> {\n  const layout = _.cloneDeep(layoutConfig)\n  layout.xaxis = {\n    visible: false,\n    range: [0, maxValue],\n  }\n  if (backgroundColor) {\n    layout.plot_bgcolor = backgroundColor\n    layout.paper_bgcolor = backgroundColor\n  }\n  if (!isTop) {\n    layout.hoverlabel = {\n      font: {\n        size: 10,\n      },\n    }\n  }\n  layout.showlegend = false\n  layout.height = isTop ? 40 : 20\n  return layout\n}\n\nconst BarPlot: FunctionComponent<BarPlotProps> = ({\n  plotData,\n  optionsConfig,\n  isTop,\n  layoutConfig,\n  label,\n  xMax,\n  colors,\n  plotStyle = { backgroundColor: 'transparent' },\n  style = { width: '100%', height: '100%' },\n  onClick,\n}: BarPlotProps) => {\n  return (\n    <Plot\n      style={style}\n      layout={getLayout(layoutConfig, {\n        isTop,\n        maxValue: xMax,\n        backgroundColor: plotStyle.backgroundColor,\n      })}\n      config={optionsConfig}\n      data={getBarPlotDataPoints(plotData, label, colors)}\n      onClick={(e: any) => (onClick ? onClick(e) : _.noop)}\n    />\n  )\n}\n\nexport default BarPlot\n","import React, { FunctionComponent, useState, useEffect } from 'react' // importing FunctionComponent\nimport * as PlotlyTyped from 'plotly.js'\n\nimport { ElementWithTooltip, TooltipVisualProps } from '../ElementWithTooltip'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\n\nimport { SynapseConstants } from '../../../utils'\nimport { getFullQueryTableResults } from '../../../utils/SynapseClient'\nimport {\n  QueryResultBundle,\n  QueryBundleRequest,\n  RowSet,\n} from '../../../utils/synapseTypes'\nimport { resultToJson } from '../../../utils/functions/sqlFunctions'\nimport {\n  GraphItem,\n  PlotProps,\n  BarPlotColors,\n  ClickCallbackParams,\n} from './types'\nimport _ from 'lodash-es'\nimport DotPlot from './DotPlot'\nimport BarPlot from './BarPlot'\nimport loadingScreen from '../../LoadingScreen'\n\nexport type ThemesPlotProps = {\n  token?: string\n  onPointClick: ({ facetValue, type, event }: ClickCallbackParams) => void\n  dotPlot: PlotProps\n  topBarPlot: PlotProps\n  sideBarPlot: PlotProps\n  tooltipProps?: TooltipVisualProps\n  dotPlotYAxisLabel?: string\n}\n\ntype TotalsGroupByY = { y: string; count: number }\ntype TotalsGroupByGroup = { group: string; count: number }\n\nconst optionsConfig: Partial<PlotlyTyped.Config> = {\n  displayModeBar: false,\n  responsive: true,\n  scrollZoom: false,\n  editable: false,\n  autosizable: true,\n}\n\nconst tooltipVisualProps: TooltipVisualProps = {\n  delayShow: 0,\n  place: 'right',\n  type: 'light',\n  effect: 'solid',\n  border: true,\n}\nconst dotPlotLayoutConfig: Partial<PlotlyTyped.Layout> = {\n  showlegend: true,\n  dragmode: false,\n  legend: {\n    font: {\n      size: 11,\n    },\n\n    y: 1.1,\n    xanchor: 'right',\n    x: 1,\n\n    orientation: 'h',\n  },\n  xaxis: {\n    visible: true,\n    fixedrange: true,\n    zeroline: false,\n    showgrid: false,\n    showline: true,\n    linecolor: '#ddd', //bottom line\n    autotick: true,\n    ticks: 'outside',\n    tickcolor: '#ddd',\n  },\n\n  yaxis: {\n    fixedrange: true,\n    zeroline: false,\n    gridcolor: '#ddd', //horizontal lines\n    automargin: true,\n  },\n\n  margin: {\n    pad: 20,\n  },\n  hovermode: 'closest',\n}\n\nconst barLayoutConfig: Partial<PlotlyTyped.Layout> = {\n  barmode: 'stack',\n  showlegend: false,\n  dragmode: false,\n  hovermode: 'closest',\n  yaxis: { visible: false, fixedrange: true },\n  margin: {\n    l: 0,\n    r: 0,\n    b: 0,\n    t: 0,\n    pad: 0,\n  },\n}\n\nfunction fetchData(\n  token: string,\n  { xField, yField, groupField, entityId, whereClause, infoField }: PlotProps,\n): Promise<RowSet> {\n  const sql = `SELECT ${xField} as \"x\", ${yField} as \"y\", ${\n    infoField ? infoField + ' as \"info\", ' : ''\n  }   ${groupField} as \"group\" FROM ${entityId} ${\n    whereClause ? ' WHERE ' + whereClause : ''\n  }`\n\n  const queryRequest: QueryBundleRequest = {\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    partMask: SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    entityId: entityId,\n    query: {\n      sql: sql,\n    },\n  }\n\n  return getFullQueryTableResults(queryRequest, token).then(\n    (data: QueryResultBundle) => {\n      return data.queryResult.queryResults\n    },\n  )\n}\n\nfunction getTotalsByProp<T>(data: GraphItem[], prop: string): T[] {\n  const resultObject = data.reduce((res, obj) => {\n    res[obj[prop]] =\n      (obj[prop] in res ? Number(res[obj[prop]]) : 0) + Number(obj.x)\n    return res\n  }, {})\n  const result = []\n  for (const property in resultObject) {\n    result.push(({\n      [prop]: property,\n      count: resultObject[property] as number,\n    } as unknown) as T)\n  }\n  return result\n}\n\nconst getClickTargetData = (\n  e: PlotlyTyped.PlotMouseEvent,\n  swap: boolean,\n): ClickCallbackParams => {\n  const pointData = e.points[0].data\n\n  let facetValue = pointData.y[0] as string\n  let type = pointData.name\n\n  if (swap) {\n    // @ts-ignore\n    ;[facetValue, type] = [type, facetValue]\n  }\n  return { facetValue, type, event: e.event }\n}\n\nconst renderTopBarLegend = (\n  colors: BarPlotColors | undefined,\n  xLabels: string[],\n): JSX.Element => (\n  <div className=\"ThemesPlot__barPlotLegend\">\n    {xLabels.map((item, i) => (\n      <div style={{ float: 'left' }} key={`topBar_${i}`}>\n        <div\n          className=\"ThemesPlot__barPlotLegend__label\"\n          key=\"topBar_label\"\n          style={{\n            backgroundColor: `${colors ? colors[item] : 'transparent'}`,\n          }}\n        ></div>\n        <div className=\"ThemesPlot__barPlotLegend__graph\" key=\"topBar_graph\">\n          {item}\n        </div>{' '}\n      </div>\n    ))}\n  </div>\n)\n\nconst fadeColors = (colors: { [key: string]: string }, opacity: string) => {\n  for (let key in colors) {\n    colors[key] = colors[key]\n      .replace(',1)', `, ${opacity})`)\n      .replace(',1.0)', `, ${opacity})`)\n  }\n  return colors\n}\n\nconst getTooltip = (data: GraphItem[], filter: string) => {\n  return _.first(data.filter(item => item.y === filter).map(item => item.info))\n}\n\nconst ThemesPlot: FunctionComponent<ThemesPlotProps> = ({\n  token,\n  dotPlot,\n  topBarPlot,\n  sideBarPlot,\n  tooltipProps = tooltipVisualProps,\n  onPointClick,\n  dotPlotYAxisLabel = 'Research Themes',\n}: ThemesPlotProps) => {\n  const [isLoaded, setIsLoaded] = useState(false)\n  const [dotPlotQueryData, setDotPlotQueryData] = useState<GraphItem[]>([])\n  const [topBarPlotData, setTopBarQueryData] = useState<GraphItem[]>([])\n  const [sideBarPlotData, setSideBarQueryData] = useState<GraphItem[]>([])\n\n  useEffect(() => {\n    const dotPlotData = fetchData(token!, dotPlot)\n    const topBarPlotData = fetchData(token!, topBarPlot)\n    const sideBarPlotData = fetchData(token!, sideBarPlot)\n    Promise.all([dotPlotData, topBarPlotData, sideBarPlotData])\n      .then(result => {\n        setDotPlotQueryData(resultToJson(result[0].headers, result[0].rows))\n        setTopBarQueryData(resultToJson(result[1].headers, result[1].rows))\n        setSideBarQueryData(resultToJson(result[2].headers, result[2].rows))\n        setIsLoaded(true)\n      })\n      .catch(err => {\n        throw err\n      })\n    return () => {}\n  }, [token, dotPlot, topBarPlot, sideBarPlot])\n  let yLabelsForDotPlot: string[] = []\n  let xLabelsForTopBarPlot: string[] = []\n  let xMaxForDotPlot = 0\n  let xMaxForSideBarPlot = 0\n  let topBarPlotDataSorted: TotalsGroupByY[] = []\n  let totalsByDotPlotY: TotalsGroupByY[] = []\n  if (isLoaded) {\n    totalsByDotPlotY = getTotalsByProp(sideBarPlotData, 'y')\n    yLabelsForDotPlot = totalsByDotPlotY\n      .sort((a, b) => b.count - a.count)\n      .map(item => item.y)\n    xMaxForSideBarPlot = Math.max(...totalsByDotPlotY.map(item => item.count))\n    xMaxForDotPlot = Math.max(...dotPlotQueryData.map(item => Number(item.x)))\n    topBarPlotDataSorted = _.orderBy(getTotalsByProp(topBarPlotData, 'y'), [\n      'y',\n    ])\n    xLabelsForTopBarPlot = _.orderBy(\n      getTotalsByProp<TotalsGroupByGroup>(topBarPlotData, 'group'),\n      ['group'],\n    ).map(item => item.group)\n  }\n\n  return (\n    <>\n      {!isLoaded && (\n        loadingScreen\n      )}\n\n      {isLoaded && (\n        <div className=\"ThemesPlot\">\n          <div className=\"ThemesPlot__dotPlotLegend\">\n            <DotPlot\n              id=\"head\"\n              plotData={dotPlotQueryData}\n              isLegend={true}\n              markerSymbols={dotPlot.markerSymbols}\n              style={{ width: '100%', height: '100%' }}\n              layoutConfig={dotPlotLayoutConfig}\n              optionsConfig={{\n                ...optionsConfig,\n                responsive: true,\n                staticPlot: true,\n              }}\n              plotStyle={{\n                ...dotPlot.plotStyle!,\n                backgroundColor: 'transparent',\n              }}\n            ></DotPlot>\n          </div>\n          {topBarPlot.colors &&\n            renderTopBarLegend(topBarPlot.colors, xLabelsForTopBarPlot)}\n          {topBarPlotDataSorted.map((item, i) => (\n            <div className=\"ThemesPlot__topBarPlot\" key={`topBarDiv_${i}`}>\n              <div className=\"ThemesPlot__topBarPlot__label\">\n                {item.count}&nbsp;{unCamelCase(item.y)}\n              </div>\n              <div className=\"ThemesPlot__topBarPlot__plot\">\n                <BarPlot\n                  style={{ width: '100%', height: '100%' }}\n                  layoutConfig={_.cloneDeep(barLayoutConfig)}\n                  optionsConfig={{ ...optionsConfig }}\n                  plotData={topBarPlotData}\n                  isTop={true}\n                  label={item.y}\n                  xMax={item.count}\n                  onClick={(e: any) =>\n                    onPointClick(getClickTargetData(e, true))\n                  }\n                  colors={\n                    // we are not actually fading colors for now. But keeping implemenation in case it changes\n                    i % 2 === 0\n                      ? topBarPlot.colors\n                      : fadeColors({ ...topBarPlot.colors }, '1')\n                  }\n                />\n              </div>\n            </div>\n          ))}\n          <div style={{ display: 'flex', position: 'relative' }}>\n            <div className=\"ThemesPlot__dotPlotYLabel\">{dotPlotYAxisLabel}</div>\n            <div className=\"ThemesPlot__dotPlot\">\n              {yLabelsForDotPlot.map((label, i) => (\n                <div\n                  key={`plotDiv_${+i}`}\n                  className=\"ThemesPlot__dotPlot__row\"\n                  style={{\n                    backgroundColor: dotPlot.plotStyle?.backgroundColor,\n                  }}\n                >\n                  <div className=\"ThemesPlot__dotPlot__barColumn\">\n                    <ElementWithTooltip\n                      idForToolTip={`plotDiv1_${+i}`}\n                      tooltipText={`${getTooltip(dotPlotQueryData, label)} `}\n                      tooltipVisualProps={tooltipProps}\n                      callbackFn={() => _.noop}\n                    >\n                      <div>\n                        <span className=\"ThemesPlot__dotPlot__themeLabel\">\n                          {label}\n                        </span>\n                        <br />\n                        <span className=\"ThemesPlot__dotPlot__countLabel\">\n                          {totalsByDotPlotY[i].count} {sideBarPlot.countLabel}\n                        </span>\n                        <br />\n                        <BarPlot\n                          style={{ width: '100%' }}\n                          layoutConfig={barLayoutConfig}\n                          optionsConfig={optionsConfig}\n                          plotData={sideBarPlotData}\n                          isTop={false}\n                          xMax={xMaxForSideBarPlot}\n                          label={label}\n                          colors={fadeColors({ ...topBarPlot.colors }, '1')}\n                        />\n                      </div>\n                    </ElementWithTooltip>\n                  </div>\n                  <div className=\"ThemesPlot__dotPlot__dotPlotColumn\">\n                    <div\n                      style={{\n                        width: '100%',\n                        backgroundColor: dotPlot.plotStyle?.backgroundColor,\n                      }}\n                    >\n                      <DotPlot\n                        id={i + ''}\n                        onClick={(e: any) =>\n                          onPointClick(getClickTargetData(e, false))\n                        }\n                        plotData={dotPlotQueryData}\n                        plotStyle={dotPlot.plotStyle}\n                        markerSymbols={dotPlot.markerSymbols}\n                        xMax={xMaxForDotPlot}\n                        label={label}\n                        layoutConfig={dotPlotLayoutConfig}\n                        optionsConfig={{\n                          ...optionsConfig,\n                          responsive: false,\n                        }}\n                      ></DotPlot>\n                    </div>\n                  </div>\n                </div>\n              ))}\n              <div className=\"ThemesPlot__dotPlot__row\">\n                <div\n                  className=\"ThemesPlot__dotPlot__barColumn\"\n                  style={{ textAlign: 'right' }}\n                >\n                  VOLUME:\n                </div>\n                <div\n                  className=\"ThemesPlot__dotPlot__dotPlotColumn\"\n                  style={{ marginTop: '0px' }}\n                >\n                  <DotPlot\n                    id={'footer'}\n                    plotData={dotPlotQueryData}\n                    isXAxis={true}\n                    xMax={xMaxForDotPlot}\n                    layoutConfig={dotPlotLayoutConfig}\n                    optionsConfig={{ ...optionsConfig, responsive: false }}\n                  ></DotPlot>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div></div>\n        </div>\n      )}\n    </>\n  )\n}\n\nexport default ThemesPlot\n","import React, { useState, useEffect } from 'react'\nimport UpSetJS, {\n  extractSets,\n  generateCombinations,\n  ISetLike,\n  UpSetFontSizes,\n  ISetCombinations,\n  ISets,\n} from '@upsetjs/react'\nimport { QueryBundleRequest } from '../utils/synapseTypes'\nimport { SynapseConstants, SynapseClient } from '../utils'\nimport { SizeMe } from 'react-sizeme'\nimport getColorPallette from './ColorGradient'\nimport { parseEntityIdFromSqlStatement } from '../utils/functions/sqlFunctions'\nimport { Error } from './Error'\nimport loadingScreen from './LoadingScreen'\n\nexport type UpsetPlotProps = {\n  sql: string // first column should contain values, second column should contain a single set value.  ie. SELECT distinct individualID, assay FROM syn20821313\n  rgbIndex: number // color plot based on portal\n  maxBarCount?: number // will show all if not set\n  setName?: string // instead of \"Set Size\"\n  combinationName?: string // instead of \"Intersection Size\"\n  height?: number\n  summaryLinkText?: string  // text for home page link below chart\n  summaryLink?: string // url for home page link below chart  \n  token?: string  \n}\n\nexport type UpsetPlotData = {\n  sets: ISets<any>\n  combinations: ISetCombinations<any>\n}\n/**\n * Upset plot.  See https://medium.com/@sgratzl/upset-js-javascript-tutorial-1b84bfd6896d\n * Currently this is driven by a Synapse Table/View, but we may want to alter it to read in the data from a flat file instead.\n */\nconst UpsetPlot: React.FunctionComponent<UpsetPlotProps> = ({\n  sql,\n  rgbIndex,\n  maxBarCount,\n  setName,\n  combinationName,\n  height = 700,\n  summaryLinkText,\n  summaryLink,\n  token,\n}) => {\n  const [isLoading, setIsLoading] = useState<boolean>()\n  const [data, setData] = useState<UpsetPlotData>()\n  const [error, setError] = useState<string>()\n  const [selection, setSelection] = useState(null as ISetLike<any> | null)\n\n  const { colorPalette } = getColorPallette(rgbIndex, 2)\n  const updateFontSizes: UpSetFontSizes = {\n    setLabel: '14px',\n  }\n\n  useEffect(() => {\n    let isCancelled: boolean = false\n    const getPlotData = async () => {\n      setIsLoading(true)\n      try {\n        const entityId = parseEntityIdFromSqlStatement(sql)\n        const partMask = SynapseConstants.BUNDLE_MASK_QUERY_RESULTS\n        const queryRequest: QueryBundleRequest = {\n          partMask,\n          concreteType:\n            'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n          entityId,\n          query: {\n            sql,\n          },\n        }\n        const { queryResult } = await SynapseClient.getFullQueryTableResults(\n          queryRequest,\n          token,\n        )\n        // transform query data into plot data, and store.\n        // collect all values for each key\n        const keyValuesMap = {}\n        // keyValuesMap looks like { 'A': {name: 'A', sets: ['S1', 'S2'] }, 'B': { name: 'B', sets: ['S1'] }, ... }\n        // It's a little redudant, but makes the next step much easier.\n\n        const caseInsensitiveSetNames = {}\n        // caseInsensitiveSetNames looks like { 'RNASEQ': 'rnaSeq', 'NOMe-SEQ': 'NOMe-seq'}.\n\n        for (const row of queryResult.queryResults.rows) {\n          for (let j = 1; j < row.values.length; j += 1) {\n            const rowValues: string[] = row.values\n            const key = rowValues[0]\n            let newValue = rowValues[j]\n            keyValuesMap[key] = keyValuesMap[key] || {}\n            keyValuesMap[key].name = key\n\n            keyValuesMap[key].sets = keyValuesMap[key].sets || []\n            const found = keyValuesMap[key].sets.find((v: any) => v == newValue)\n            if (!found && newValue) {\n              if (caseInsensitiveSetNames[newValue.toUpperCase()]) {\n                newValue = caseInsensitiveSetNames[newValue.toUpperCase()]\n              } else {\n                caseInsensitiveSetNames[newValue.toUpperCase()] = newValue\n              }\n              keyValuesMap[key].sets.push(newValue)\n            }\n          }\n        }\n        // now create the expected elems set\n        const elems: any[] = Object.values(keyValuesMap)\n        // elems looks like [{ name: 'A', sets: ['S1', 'S2'] }, { name: 'B', sets: ['S1'] }, ...]\n        const sets = extractSets(elems)\n        const combinations = generateCombinations(sets, {\n          type: 'intersection',\n          min: 1,\n          limit: maxBarCount,\n          order: 'cardinality:desc',\n        })\n        if (!isCancelled) {\n          setData({ sets, combinations })\n          setIsLoading(false)\n        }\n      } catch (err) {\n        if (!isCancelled) {\n          setIsLoading(false)\n          let errorMessage = err['reason']\n          if (!errorMessage) {\n            console.error(err)\n            errorMessage = 'Error retrieving data'\n          }\n          setError(errorMessage)\n        }\n      }\n    }\n    getPlotData()\n    return () => {\n      isCancelled = true\n    }\n  }, [sql, token])\n\n  return (\n    <>\n      {isLoading && loadingScreen}\n      {!isLoading && data && (\n        <SizeMe>\n          {({ size }) => (\n            <div className=\"UpsetPlot\">\n              <UpSetJS\n                sets={data.sets}\n                combinations={data.combinations}\n                width={size.width!}\n                height={height}\n                onHover={setSelection}\n                // onClick={setSelection}\n                selection={selection}\n                color={colorPalette[0]}\n                selectionColor={colorPalette[0]}\n                hasSelectionOpacity={0.3}\n                // alternatingBackgroundColor={false}\n                setName={setName?.toUpperCase()}\n                combinationName={combinationName?.toUpperCase()}\n                fontFamily=\"Lato sans-serif\"\n                fontSizes={updateFontSizes}\n                exportButtons={false}\n                notMemberColor=\"transparent\"\n\n              />\n              {summaryLink && summaryLinkText && (\n                <div className=\"UpsetPlot__summary\">\n                  <p>\n                    <a className=\"homepage-button-link\" href={summaryLink}>\n                      {summaryLinkText}\n                    </a>\n                  </p>\n                </div>      \n              )}\n\n            </div>\n          )}\n        </SizeMe>\n      )}\n      <Error error={error} token={token} />\n    </>\n  )\n}\n\nexport default UpsetPlot\n","import React, { useEffect, useState } from 'react'\nimport { parseEntityIdFromSqlStatement } from '../utils/functions/sqlFunctions'\nimport { SynapseClient, SynapseConstants } from '../utils'\nimport { QueryBundleRequest, QueryResultBundle } from '../utils/synapseTypes/Table'\nimport UserCardList from './UserCardList'\nimport loadingScreen from './LoadingScreen'\nimport { UserCardSize } from './UserCard'\nimport { LARGE_USER_CARD } from '../utils/SynapseConstants'\n\nconst STORED_UID_KEY = 'sage_rotate_uids'\nconst DEFAULT_DISPLAY_COUNT = 3\n\nexport type UserCardListRotateProps = {\n  sql: string\n  count: number\n  token?: string\n  useQueryResultUserData?: boolean\n  size?: UserCardSize\n  summaryLink: string\n  summaryLinkText: string\n}\n\nexport const getDisplayIds = (ids: string[] = [], count: number = DEFAULT_DISPLAY_COUNT) => {\n  let storedIds: string[] = []\n  let newIds: string[] = []\n  const storedIdsStr = localStorage.getItem(STORED_UID_KEY)\n  if (storedIdsStr != null) {\n    storedIds = JSON.parse(storedIdsStr)\n  }\n\n  if (!storedIds.length) {  // no stuff in storage\n    newIds = ids.slice(0, count)\n    localStorage.setItem(STORED_UID_KEY, JSON.stringify(newIds))\n    return newIds\n  } else {  // has stuff in storage\n    const filtered = ids.filter(item => !storedIds.includes(item))\n    if (filtered.length >= count) {\n      newIds = filtered.slice(0, count)\n      localStorage.setItem(STORED_UID_KEY, JSON.stringify(storedIds.concat(newIds)))\n      return newIds\n    } else {\n      localStorage.removeItem(STORED_UID_KEY)\n      const part = ids.slice(0, count - filtered.length)\n      localStorage.setItem(STORED_UID_KEY, JSON.stringify(part))\n      return filtered.concat(part)\n    }\n  }\n}\n\nconst UserCardListRotate: React.FunctionComponent<UserCardListRotateProps> = ({\n    sql,\n    count,\n    token,\n    useQueryResultUserData = false,\n    size = LARGE_USER_CARD,\n    summaryLink,\n    summaryLinkText\n  }) => {\n\n  // const [isLoading, setIsLoading] = useState<boolean>()\n  const [userIds, setUserIds] = useState<string []>([])\n  const [queryData, setQueryData] = useState<QueryResultBundle>()\n  const [isLoading, setIsLoading] = useState<boolean>()\n  let mounted = true\n\n  useEffect(() => {\n\n    const fetchData = async function() {\n      setIsLoading(true)\n      const entityId = parseEntityIdFromSqlStatement(sql)\n      const partMask = SynapseConstants.BUNDLE_MASK_QUERY_RESULTS\n      const request: QueryBundleRequest = {\n        partMask,\n        concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n        entityId,\n        query: {\n          sql,\n        }\n      }\n\n      const queryResultBundle = await SynapseClient.getFullQueryTableResults(\n        request,\n        token\n      )\n      const { queryResult } = queryResultBundle\n      if (queryResult.queryResults.rows) {\n        // find the column that has the USER_ID in it.\n        const ownerIdColumnIndex = queryResult.queryResults.headers.findIndex(\n          el => el.columnType === 'USERID',\n        )\n        const ids: string[] = queryResult.queryResults.rows.map( d => d.values[ownerIdColumnIndex] )\n        if (mounted) {\n          const newIds = getDisplayIds(ids)\n          setUserIds(newIds)\n          if (useQueryResultUserData) {\n            setQueryData(queryResultBundle)\n          }\n          setIsLoading(false)\n        }\n      } else {\n        console.log(\"UserCardListRotate: Error getting data\")\n      }\n    }\n\n    fetchData()\n\n    return () => {\n      mounted = false\n    }\n\n  }, [sql, count, token])\n\n  return (\n    <div className=\"UserCardListRotate\">\n      {isLoading && loadingScreen}\n      {!isLoading && userIds.length > 0 && <UserCardList list={userIds} size={size} data={queryData} />}\n      <div className=\"UserCardListRotate__summary\">\n        <p>\n          <a className=\"homepage-button-link\" href={summaryLink}>\n            {summaryLinkText}\n          </a>\n        </p>\n      </div>\n    </div>\n  )\n\n}\n\nexport default UserCardListRotate","import * as React from 'react'\nimport Plotly from 'plotly.js-basic-dist'\nimport * as PlotlyTyped from 'plotly.js'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SizeMe } from 'react-sizeme'\n\nimport { QueryWrapperChildProps } from '../../../containers/QueryWrapper'\nimport {\n  FacetColumnResultValues,\n  ColumnType,\n  FacetColumnResult,\n  FacetColumnResultValueCount,\n} from '../../../utils/synapseTypes'\n\nimport { getColorPallette } from '../../../containers/ColorGradient'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\nimport { useEffect, useState } from 'react'\nimport loadingScreen from '../../LoadingScreen'\nimport { GraphData, extractPlotDataArray, getPlotStyle, renderLegend } from '../../widgets/facet-nav/FacetNavPanel'\nimport { getFacets } from '../../widgets/facet-nav/FacetNav'\n\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type FacetPlotsCardOwnProps = {\n  title?:string\n  rgbIndex?: number\n  facetsToPlot?: string[]\n  detailsPagePath: string\n}\n\ntype FacetPlotsCardProps = FacetPlotsCardOwnProps & QueryWrapperChildProps\n\nconst layout: Partial<PlotlyTyped.Layout> = {\n  showlegend: false,\n  annotations: [],\n  margin: { l: 0, r: 0, b: 0, t: 0, pad: 0 },\n  yaxis: {\n    visible: false,\n    showgrid: false,\n  },\n  xaxis: {\n    visible: false,\n    showgrid: false,\n  },\n}\n\nconst FacetPlotsCard: React.FunctionComponent<FacetPlotsCardProps> = ({\n  title,\n  isLoadingNewData,\n  rgbIndex,\n  facetsToPlot,\n  detailsPagePath,\n  data,\n  isLoading,\n  facetAliases,\n}: FacetPlotsCardProps): JSX.Element => {\n  const [facetPlotDataArray, setFacetPlotDataArray] = useState<GraphData[]>([])\n  const [facetDataArray, setFacetDataArray] = useState<FacetColumnResult[]>([])\n  const [selectedFacetValue, setSelectedFacetValue] = useState<string>('')\n  const { colorPalette } = getColorPallette(rgbIndex ?? 0, 2)\n  \n  useEffect(() => {\n    if (!facetsToPlot || !data) {\n      return\n    } else {\n      const getColumnType = (facetToPlot:FacetColumnResult): ColumnType | undefined =>\n        data?.columnModels?.find(\n          columnModel => columnModel.name === facetToPlot.columnName,\n        )?.columnType as ColumnType\n  \n      const facetsDataToPlot = getFacets(data, facetsToPlot)\n      const newPlotData = facetsDataToPlot.map((item, index) => {\n        const plotData = extractPlotDataArray(\n          item as FacetColumnResultValues,\n          getColumnType(item),\n          index+1, //individual plot rgbIndex\n          'PIE',\n        )\n        return plotData\n      })\n      setFacetPlotDataArray(newPlotData)\n      setFacetDataArray(facetsDataToPlot)\n      // ASSUMPTION: exactly one facet column value is selected (locked down).  For example, facet column \"study\" with value \"ROSMAP\"\n      const selectedFacet:FacetColumnResultValueCount|undefined = data?.facets?.map(item => {\n        return (item as FacetColumnResultValues).facetValues.filter(facetValue => {\n          return facetValue.isSelected\n        })[0]\n      })[0]\n      if (selectedFacet && selectedFacet.value) {\n        setSelectedFacetValue(selectedFacet?.value)\n      }\n    }\n  }, [facetsToPlot, data])\n\n  if (isLoadingNewData || !facetPlotDataArray || !facetDataArray) {\n    return (\n      <div className=\"FacetPlotsCard__loading SRC-loadingContainer SRC-centerContentColumn\">\n        {loadingScreen}\n      </div>\n    )\n  } else {\n    let detailsPageLink = <></>\n    if (detailsPagePath) {\n      detailsPageLink = <div className=\"FacetPlotsCard__body__footer\">\n        <div className=\"FacetPlotsCard__body__footer__link\">\n          <a href={detailsPagePath}>\n            View {selectedFacetValue}\n          </a>\n        </div>\n      </div>\n    }\n    return (\n      <div className=\"FacetPlotsCard cardContainer\">\n        <div className=\"FacetPlotsCard__titlebar\" style={{backgroundColor: colorPalette[0].replace(')', ',.05)')}}>\n          <span className=\"FacetPlotsCard__title\">\n            {title ?? selectedFacetValue}\n          </span>\n          {isLoading && (\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          )}\n        </div>\n        <div className=\"FacetPlotsCard__body\">\n          {/* create a plot for every facet to be plotted */}\n          {facetPlotDataArray.map((plotData, index) => {\n            return <div>\n              {index !== 0 && <hr></hr>}\n              <div className=\"FacetPlotsCard__body__facetname\">\n                <span>\n                  {unCamelCase(facetDataArray[index].columnName, facetAliases)}\n                </span>\n              </div>\n              <div className=\"FacetPlotsCard__body__row\">\n                <SizeMe monitorHeight>\n                  {({ size }) => (\n                    <div className=\"FacetPlotsCard__body__plot\">\n                      <Plot\n                        key={`${facetsToPlot![index]}-${size.width}`}\n                        layout={layout}                      \n                        data={plotData?.data ?? []}\n                        style={getPlotStyle(\n                          size.width,\n                          'PIE',\n                          150,\n                        )}\n                        config={{ displayModeBar: false }}                  \n                      />\n                    </div>\n                  )}\n                </SizeMe>\n                {renderLegend(plotData?.labels, plotData?.colors, false)}\n                </div>\n            </div>\n          })}\n          {detailsPageLink}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default FacetPlotsCard\n","import * as React from 'react'\nimport QueryWrapper from '../../QueryWrapper'\nimport {\n  parseEntityIdFromSqlStatement,\n} from '../../../utils/functions/sqlFunctions'\nimport { SynapseConstants } from '../../../utils/'\nimport { QueryBundleRequest } from '../../../utils/synapseTypes'\nimport { Error } from '../../Error'\nimport FacetPlotsCard from './FacetPlotsCard'\n\nexport type QueryWrapperFacetPlotsCardProps = {\n  token?: string\n  title?:string\n  rgbIndex?: number\n  facetsToPlot?: string[]\n  facetAliases?: {}\n  selectFacetColumnName: string\n  selectFacetColumnValue: string\n  sql?: string\n  detailsPagePath: string\n}\nexport function getQueryRequest(sql: string, selectFacetColumnName: string, selectFacetColumnValue: string):QueryBundleRequest {\n  const entityId = parseEntityIdFromSqlStatement(sql)\n  return {\n    entityId,\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    partMask:\n      SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n      SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    query: {      \n      sql,\n      offset: 0,\n      limit: 25,\n      selectedFacets: [{\n        columnName: selectFacetColumnName,\n        facetValues: [selectFacetColumnValue],\n        concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest'        \n      }],\n    }, \n  }\n}\nconst QueryWrapperFacetPlotsCard: React.FunctionComponent<QueryWrapperFacetPlotsCardProps> = props => {\n  const {\n    title,\n    sql,\n    facetsToPlot,\n    rgbIndex,  \n    selectFacetColumnName,\n    selectFacetColumnValue,\n    detailsPagePath,\n    token,\n    ...rest\n  } = props\n  const initQueryRequest: QueryBundleRequest = getQueryRequest(sql!, selectFacetColumnName, selectFacetColumnValue)\n  return (\n    <div className=\"QueryWrapperFacetPlotsCard\">\n      <QueryWrapper {...rest} token={token} initQueryRequest={initQueryRequest}>\n        <Error />\n        <FacetPlotsCard\n          title={title}\n          facetsToPlot={facetsToPlot}\n          rgbIndex={rgbIndex}\n          detailsPagePath={detailsPagePath}\n        />\n      </QueryWrapper>\n    </div>\n  )\n}\n\nexport default QueryWrapperFacetPlotsCard\n","import * as React from 'react'\nimport QueryWrapperFacetPlotsCard, { QueryWrapperFacetPlotsCardProps } from './QueryWrapperFacetPlotsCard'\n\nexport type FeaturedDataPlotsProps = {\n  token?: string\n  configs: QueryWrapperFacetPlotsCardProps[]\n  rgbIndex?: number\n  sql?: string,\n  explorePagePath?: string,\n}\n\nconst FeaturedDataPlots: React.FunctionComponent<FeaturedDataPlotsProps> = props => {\n  const {\n    configs,\n    rgbIndex,\n    sql,\n    token,\n  } = props\n  return (\n  <div className=\"FeaturedDataPlots\">\n    {configs.map(config => {\n      return <div className=\"FeaturedDataPlots__card\">\n        <QueryWrapperFacetPlotsCard \n          {...config}\n          rgbIndex={rgbIndex}\n          sql={sql}\n          token={token} />\n      </div>\n    })}\n  </div>)\n}\n\nexport default FeaturedDataPlots\n","import * as React from 'react'\nimport { useState } from 'react'\nimport FeaturedDataPlots, { FeaturedDataPlotsProps } from './FeaturedDataPlots'\nimport { Icon } from '../../../containers/row_renderers/utils'\nimport getColorPallette from '../../../containers/ColorGradient'\n\nexport type FeatureDataTabProps = {\n  title: string, // type of data being shown, used for the tab title and explore all button\n  icon?: string,\n  plotsConfig: FeaturedDataPlotsProps,\n  exploreFacetColumnName: string,\n  exploreFacetColumnValue: string,\n}\n\nexport type FeaturedDataTabsProps = {\n  token?: string\n  configs: FeatureDataTabProps[],\n  rgbIndex:number,\n  sql: string,\n  exploreObjectType: string,\n  explorePagePath: string,\n}\n\nconst FeaturedDataTabs: React.FunctionComponent<FeaturedDataTabsProps> = props => {\n  const [selectedTabIndex, setSelectedTabIndex] = useState<number>(0)\n  const {\n    configs,\n    rgbIndex,\n    sql,\n    exploreObjectType,\n    explorePagePath,\n    token\n  } = props\n  const { colorPalette } = getColorPallette(rgbIndex ?? 0, 1)\n  // explore all data button\n  const selectedTabProps:FeatureDataTabProps = configs[selectedTabIndex]\n  return (\n    <div className=\"FeaturedDataTabs\">\n      {/* tabs */}\n      <div className=\"FeaturedDataTabs__tabs\">\n        {configs.map((config, index) => {\n          const isSelectedTabIndex:boolean = index === selectedTabIndex\n          return <div className={`FeaturedDataTabs__tabs__tab ${isSelectedTabIndex ? 'FeaturedDataTabs__tabs__tab__selected' : ''}`}\n            style={{borderBottomColor:isSelectedTabIndex ? colorPalette[0]:''}}>\n            <button onClick={() => setSelectedTabIndex(index)}>\n              {config.icon && <Icon type={config.icon}></Icon>}&nbsp;\n              {config.title}\n            </button>\n          </div>\n        })}\n      </div>\n      {/* tab content */}\n      {\n        selectedTabProps && <>\n          <FeaturedDataPlots key={`${sql}-${selectedTabProps.exploreFacetColumnName}-${selectedTabProps.exploreFacetColumnValue}`}\n            {...selectedTabProps.plotsConfig}\n              rgbIndex={rgbIndex}\n              sql={sql}\n              explorePagePath={explorePagePath}\n              token={token} /> \n          <div className=\"FeaturedDataTabs__explore-all\">\n            <a className=\"homepage-button-link\" href={explorePagePath}>\n                EXPLORE ALL {exploreObjectType.toUpperCase()}\n            </a>\n          </div>\n        </>\n      }\n    </div>)\n}\n\nexport default FeaturedDataTabs\n","import * as React from 'react'\nimport { FunctionComponent } from 'react'\n\nimport {\n  FacetColumnResult,\n  FacetColumnResultRange,\n  FacetColumnResultValueCount,\n} from '../../../utils/synapseTypes'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { ElementWithTooltip } from '../ElementWithTooltip'\nimport _ from 'lodash'\nimport { SynapseConstants } from '../../../utils'\n\nexport type FacetWithSelection = {\n  facet: FacetColumnResult\n  selectedValue?: FacetColumnResultValueCount\n  displayValue?: string\n}\n\nexport type SelectionCriteriaPillProps = {\n  facetWithSelection?: FacetWithSelection\n  index: number\n  className?: string\n  onRemove: Function\n  filter?: {\n    columnName: string\n    value: string\n  }\n}\n\nconst SelectionCriteriaPill: FunctionComponent<SelectionCriteriaPillProps> = ({\n  facetWithSelection,\n  index,\n  onRemove,\n  filter,\n}) => {\n  let innerText,\n    tooltipText: string | null = ''\n  if (facetWithSelection) {\n    if (facetWithSelection.facet.facetType === 'enumeration') {\n      innerText =\n        facetWithSelection.displayValue === SynapseConstants.VALUE_NOT_SET\n          ? 'Unannotated'\n          : facetWithSelection.displayValue\n    } else {\n      innerText =\n        (facetWithSelection.facet as FacetColumnResultRange).selectedMin +\n        ' - ' +\n        (facetWithSelection.facet as FacetColumnResultRange).selectedMax\n    }\n    tooltipText = `${unCamelCase(\n      facetWithSelection.facet.columnName,\n    )}: ${innerText}`\n  } else {\n    let filterValue = filter?.value\n    if (filterValue?.startsWith('%') && filterValue?.endsWith('%')) {\n      // strip '%' wildcard character when using a LIKE condition\n      filterValue = filterValue.substring(1, filterValue.length-1)\n    }\n    innerText = `\"${filterValue}\" in ${unCamelCase(filter?.columnName)}`\n    tooltipText = `${unCamelCase(filter?.columnName)}: ${filterValue}`\n  }\n  return (\n    <ElementWithTooltip\n      idForToolTip={`selectionCriteria_${+index}`}\n      tooltipText={tooltipText}\n      callbackFn={() => _.noop}\n    >\n      <label\n        className=\"SelectionCriteriaPill\"\n        key={index + '__SelectionCriteriaPill'}\n      >\n        <span>{innerText}</span>\n        <button\n          onClick={() => onRemove(facetWithSelection)}\n          className=\"SelectionCriteriaPill__btnRemove\"\n        >\n          <FontAwesomeIcon icon={faTimes} title=\"deselect\" />\n        </button>\n      </label>\n    </ElementWithTooltip>\n  )\n}\n\nexport default SelectionCriteriaPill\n","import * as React from 'react'\nimport {\n  QueryBundleRequest,\n  FacetColumnResultRange,\n  FacetColumnResultValues,\n  EntityHeader,\n  UserProfile,\n  FacetColumnResult,\n  ColumnModel,\n  FacetColumnRequest,\n} from '../utils/synapseTypes'\nimport { SynapseClient, SynapseConstants } from '../'\nimport {\n  getStoredEntityHeaders,\n  getStoredUserProfiles,\n} from '../utils/functions/getDataFromFromStorage'\nimport useDeepCompareEffect from 'use-deep-compare-effect'\nimport { cloneDeep } from 'lodash-es'\nimport SelectionCriteriaPill, {\n  FacetWithSelection,\n} from './widgets/facet-nav/SelectionCriteriaPill'\nimport {\n  applyChangesToValuesColumn,\n  applyChangesToRangeColumn,\n} from './widgets/query-filter/QueryFilter'\nimport { RadioValuesEnum } from './widgets/query-filter/RangeFacetFilter'\nimport { useState, FunctionComponent } from 'react'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport { ColumnSingleValueFilterOperator } from '../utils/synapseTypes/Table/QueryFilter'\n\nexport type TotalQueryResultsProps = {\n  isLoading: boolean\n  style?: React.CSSProperties\n  lastQueryRequest: QueryBundleRequest\n  token: string | undefined\n  unitDescription: string\n  frontText: string\n  applyChanges?: Function\n  showNotch?: boolean\n} & QueryWrapperChildProps\n\n// This is a stateful component so that during load the component can hold onto the previous\n// total instead of showing 0 results for the intermittent loading state.\n\nconst TotalQueryResults: FunctionComponent<TotalQueryResultsProps> = ({\n  style,\n  unitDescription,\n  frontText,\n  lastQueryRequest,\n  token,\n  isLoading: parentLoading,\n  executeQueryRequest,\n  getInitQueryRequest,\n  showNotch = false,\n  error,\n}) => {\n  const [total, setTotal] = useState<number | undefined>(undefined) // undefined to start\n  const [isLoading, setIsLoading] = useState(false)\n  const [facetsWithSelection, setFacetsWithSelection] = useState<\n    FacetWithSelection[]\n  >([])\n\n  const applyChanges = (facets: FacetColumnRequest[]) => {\n    const queryRequest: QueryBundleRequest = cloneDeep(lastQueryRequest)\n    queryRequest.query.selectedFacets = facets\n    queryRequest.query.offset = 0\n    executeQueryRequest!(queryRequest)\n  }\n\n  const getEnumFacetsWithSelections = (\n    facets: FacetColumnResult[],\n  ): FacetColumnResultValues[] => {\n    const enumFacets = facets.filter(\n      facet => facet.facetType === 'enumeration',\n    ) as FacetColumnResultValues[]\n    const enumFacetsWithSelections = enumFacets.filter(\n      facet =>\n        facet.facetValues.filter(value => value.isSelected === true).length > 0,\n    )\n    return enumFacetsWithSelections\n  }\n\n  const getRangeFacetsWithSelections = (\n    facets: FacetColumnResult[],\n  ): FacetColumnResultRange[] => {\n    const rangeFacets = facets.filter(\n      facet => facet.facetType === 'range',\n    ) as FacetColumnResultRange[]\n    const rangeFacetsWithSelections = rangeFacets.filter(\n      facet => facet.selectedMax || facet.selectedMin,\n    )\n    return rangeFacetsWithSelections\n  }\n\n  const getDisplayValueForEntityColumn = (\n    entityHeaders: EntityHeader[],\n    facetValue: string,\n  ): string => {\n    const entity = entityHeaders.find(item => item.id === facetValue)\n    return entity?.name ?? facetValue\n  }\n\n  const getDisplayValueUserIdColumn = (\n    userProfiles: UserProfile[],\n    facetValue: string,\n  ): string => {\n    const userProfile = userProfiles.find(item => item.ownerId === facetValue)\n    return userProfile?.userName || facetValue\n  }\n\n  const transformEnumFacetsForSelectionDisplay = (\n    facets: FacetColumnResultValues[],\n    columnModels: ColumnModel[],\n  ): FacetWithSelection[] => {\n    const lookUpEntityHeaders = getStoredEntityHeaders()\n    const lookUpUserProfiles = getStoredUserProfiles()\n    const filteredEnumWithSelectedValuesOnly: FacetWithSelection[] = []\n    facets.forEach(facet => {\n      const columnModel = columnModels.find(\n        model => model.name === facet.columnName,\n      )\n      facet.facetValues.forEach(facetValue => {\n        if (facetValue.isSelected) {\n          let displayValue = facetValue.value\n          if (columnModel?.columnType === 'ENTITYID') {\n            displayValue = getDisplayValueForEntityColumn(\n              lookUpEntityHeaders,\n              facetValue.value,\n            )\n          } else if (columnModel?.columnType === 'USERID') {\n            displayValue = getDisplayValueUserIdColumn(\n              lookUpUserProfiles,\n              facetValue.value,\n            )\n          }\n\n          filteredEnumWithSelectedValuesOnly.push({\n            facet,\n            displayValue,\n            selectedValue: facetValue,\n          })\n        }\n      })\n    })\n    return filteredEnumWithSelectedValuesOnly\n  }\n\n  useDeepCompareEffect(() => {\n    const calculateTotal = async () => {\n      const cloneLastQueryRequest = cloneDeep(lastQueryRequest)\n      cloneLastQueryRequest.partMask =\n        SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n        SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n        SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS\n      if (parentLoading || total === undefined) {\n        setIsLoading(true)\n        SynapseClient.getQueryTableResults(cloneLastQueryRequest, token)\n          .then(data => {\n            setTotal(data.queryCount!)\n            const rangeFacetsWithSelections = getRangeFacetsWithSelections(\n              data.facets!,\n            )\n            const enumFacetsWithSelections = getEnumFacetsWithSelections(\n              data.facets!,\n            )\n            const rangeFacetsForDisplay = rangeFacetsWithSelections.map(\n              facet => ({ facet }),\n            )\n            const enumFacetsForDisplay = transformEnumFacetsForSelectionDisplay(\n              enumFacetsWithSelections,\n              data.columnModels!,\n            )\n\n            setFacetsWithSelection([\n              ...rangeFacetsForDisplay,\n              ...enumFacetsForDisplay,\n            ])\n          })\n          .catch(err => {\n            console.error('err ', err)\n          })\n          .finally(() => {\n            setIsLoading(false)\n          })\n      }\n    }\n    calculateTotal()\n  }, [parentLoading, token, lastQueryRequest])\n\n  const removeFacetSelection = ({\n    facet,\n    selectedValue,\n  }: FacetWithSelection) => {\n    if (facet.facetType === 'enumeration') {\n      applyChangesToValuesColumn(\n        lastQueryRequest,\n        facet as FacetColumnResultValues,\n        applyChanges!,\n        selectedValue?.value,\n        false,\n      )\n    } else {\n      applyChangesToRangeColumn(\n        lastQueryRequest,\n        facet as FacetColumnResultRange,\n        applyChanges!,\n        [RadioValuesEnum.ANY, RadioValuesEnum.ANY],\n      )\n    }\n  }\n\n  const removeSearchQuerySelection = (columnName: string, value: string) => {\n    const cloneLastQueryRequest = cloneDeep(lastQueryRequest)\n    if (!cloneLastQueryRequest.query.additionalFilters) {\n      return\n    }\n    cloneLastQueryRequest.query.additionalFilters = cloneLastQueryRequest.query.additionalFilters\n      ?.map(el => {\n        return {\n          columnName: el.columnName,\n          values:\n            el.columnName === columnName\n              ? el.values.filter(el => el !== value)\n              : el.values,\n          operator: ColumnSingleValueFilterOperator.LIKE,\n          concreteType:\n            'org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter',\n        }\n      })\n      .filter(el => el.values.length > 0)\n    executeQueryRequest!(cloneLastQueryRequest)\n  }\n\n  const clearAll = () => {\n    const initQueryRequest = cloneDeep(getInitQueryRequest!())\n    initQueryRequest.query.additionalFilters = []\n    executeQueryRequest!(initQueryRequest)\n  }\n\n  const searchSelectionCriteriaPill = lastQueryRequest?.query.additionalFilters?.map(\n    el => {\n      const { columnName } = el\n      return el.values.map(value => {\n        return (\n          <SelectionCriteriaPill\n            key={value}\n            index={facetsWithSelection.length + 1}\n            filter={{\n              columnName,\n              value,\n            }}\n            onRemove={() => removeSearchQuerySelection(el.columnName, value)}\n          />\n        )\n      })\n    },\n  )\n\n  if (error) {\n    return <></>\n  }\n  return (\n    <div\n      className={`TotalQueryResults ${showNotch ? 'notch-down' : ''}`}\n      style={style}\n    >\n      <span className=\"SRC-boldText SRC-text-title SRC-centerContent\">\n        {frontText} {total} {unitDescription}\n        {isLoading && (\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        )}\n      </span>\n      <div className=\"TotalQueryResults__selections\">\n        {searchSelectionCriteriaPill}\n        {facetsWithSelection.map((selectedFacet, index) => (\n          <SelectionCriteriaPill\n            key={\n              selectedFacet.selectedValue?.value ?? selectedFacet.displayValue\n            }\n            facetWithSelection={selectedFacet}\n            index={index}\n            onRemove={removeFacetSelection}\n          ></SelectionCriteriaPill>\n        ))}\n      </div>\n      {facetsWithSelection.length > 0 && (\n        <button onClick={clearAll} className=\"TotalQueryResults__clearall\">\n          Clear All\n        </button>\n      )}\n    </div>\n  )\n}\n\nexport default TotalQueryResults\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faPlus } from '@fortawesome/free-solid-svg-icons'\nimport * as React from 'react'\nimport {\n  getIsValueSelected,\n  readFacetValues,\n} from '../utils/functions/facetUtils'\nimport {\n  FacetColumnResultValues,\n  QueryBundleRequest,\n} from '../utils/synapseTypes/'\nimport { getColorPallette } from './ColorGradient'\nimport { FacetSelection, QueryWrapperChildProps } from './QueryWrapper'\nimport { SELECT_ALL } from './table/SynapseTableConstants'\nimport TotalQueryResults from './TotalQueryResults'\nlibrary.add(faPlus)\n\nexport const SELECT_SINGLE_FACET = 'SELECT_SINGLE_FACET'\n\ntype CheckboxGroupProps = {\n  isAllFilterSelected: boolean\n  rgbIndex: number\n  facetColumnResult: FacetColumnResultValues\n  applyChanges: (\n    ref: React.RefObject<HTMLSpanElement>,\n    facetValue: string,\n    selector: string,\n    index: number,\n  ) => (_event: React.MouseEvent<HTMLSpanElement>) => void\n  showAllFacets: boolean\n  lastFacetSelection: FacetSelection\n  isLoading: boolean\n}\n\nexport const FACET_SELECTED_CLASS = 'FACET_SELECTED_CLASS'\nexport const FACET_NOT_SELECTED_CLASS = 'FACET_NOT_SELECTED_CLASS'\n\n/**\n * Checkbox group represents one column's set of checkbox filters\n *\n * @class CheckboxGroup\n * @extends {React.Component}\n */\nconst CheckboxGroup: React.FunctionComponent<CheckboxGroupProps> = (\n  props: CheckboxGroupProps,\n) => {\n  const {\n    facetColumnResult,\n    showAllFacets,\n    lastFacetSelection,\n    isLoading,\n    rgbIndex,\n    isAllFilterSelected,\n  } = props\n  const children: any = []\n  const ref: React.RefObject<HTMLSpanElement> = React.createRef()\n  // Note: this actually sorts the data when it appears in the\n  // table as it stands currently, this may change depending on\n  // if that arrangment is no longer desired\n  facetColumnResult.facetValues.sort((a: any, b: any) => {\n    return b.count - a.count\n  })\n  const { colorPalette, textColors } = getColorPallette(\n    rgbIndex,\n    facetColumnResult.facetValues.length,\n  )\n  facetColumnResult.facetValues.forEach(\n    (facetColumnResultValues, index: number) => {\n      const key =\n        facetColumnResult.columnName +\n        facetColumnResultValues.value +\n        facetColumnResultValues.count\n      const textColor = textColors[index]\n      const curColor = colorPalette[index]\n      let style: any = {}\n\n      const isSelected = isAllFilterSelected\n        ? true\n        : getIsValueSelected({\n            isLoading,\n            lastFacetSelection,\n            columnName: facetColumnResult.columnName,\n            curFacetSelection: facetColumnResultValues,\n          })\n\n      if (isSelected) {\n        style = {\n          background: curColor,\n        }\n      } else {\n        style = {\n          background: '#C4C4C4',\n        }\n      }\n      // we add this class for testability\n      const backgroundClass = isSelected\n        ? FACET_SELECTED_CLASS\n        : FACET_NOT_SELECTED_CLASS\n      style.color = textColor\n      const { value, count } = facetColumnResultValues\n      const displayValue =\n        value === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n          ? 'Unannotated'\n          : value\n\n      children.push(\n        <label\n          style={style}\n          className=\"SRC-facets SRC-primary-background-color-hover \"\n          key={key}\n        >\n          <span className=\"SRC-facets-text\">\n            {displayValue} ({count})\n          </span>\n          <input\n            // @ts-ignore\n            onChange={props.applyChanges(\n              ref,\n              value,\n              SELECT_SINGLE_FACET,\n              index,\n            )}\n            checked={isSelected}\n            type=\"checkbox\"\n            value={value}\n            className={`SRC-hidden SRC-facet-checkboxes ${backgroundClass}`}\n          />\n        </label>,\n      )\n    },\n  )\n  // By default only show 5 facets unless the user has clicked a facet, in which case\n  // showAllFacets will be true.\n  const childrenView = showAllFacets ? children : children.slice(0, 5)\n  return (\n    // need a span so that we can have a ref attachable\n    <span ref={ref}>{childrenView}</span>\n  )\n}\n\ntype FacetsState = {\n  showAllFacets: boolean\n}\n\nclass Facets extends React.Component<QueryWrapperChildProps, FacetsState> {\n  constructor(props: QueryWrapperChildProps) {\n    super(props)\n    this.applyChanges = this.applyChanges.bind(this)\n    this.state = {\n      showAllFacets: false,\n    }\n    this.showAllFacets = this.showAllFacets.bind(this)\n    this.showButtons = this.showButtons.bind(this)\n  }\n  /**\n   * Display the view of the facets\n   *\n   * @returns\n   * @memberof Facets\n   */\n  public showFacetFilter() {\n    if (!this.props.data!.facets) {\n      throw Error(\n        'Error on query request, must include facets in partmask to show facets',\n      )\n    }\n    // Find the facetcolumn result according to the input filter\n    const facetColumnResult = this.props.data!.facets!.find(\n      el =>\n        el.columnName === this.props.facet && el.facetType === 'enumeration',\n    ) as FacetColumnResultValues\n    if (!facetColumnResult) {\n      throw Error('Error no matching facet found given specified facet')\n    }\n\n    return (\n      <CheckboxGroup\n        isAllFilterSelected={\n          this.props.isAllFilterSelectedForFacet![this.props.facet!]\n        }\n        showAllFacets={this.state.showAllFacets}\n        rgbIndex={this.props.rgbIndex!}\n        key={facetColumnResult.columnName}\n        facetColumnResult={facetColumnResult}\n        applyChanges={this.applyChanges}\n        isLoading={this.props.isLoading!}\n        lastFacetSelection={this.props.lastFacetSelection!}\n      />\n    )\n  }\n\n  /**\n   * Handle checkbox click event\n   */\n  public applyChanges = (\n    ref: React.RefObject<HTMLSpanElement>,\n    facetValue: string,\n    selector: string,\n    index: number,\n  ) => (event: React.MouseEvent<HTMLSpanElement>) => {\n    event.preventDefault()\n    if (!this.state.showAllFacets) {\n      this.setState({\n        showAllFacets: true,\n      })\n    }\n\n    const { facet = '', isAllFilterSelectedForFacet = {} } = this.props\n\n    const lastFacetSelection = {\n      facetValue,\n      selector,\n      columnName: facet,\n    } as FacetSelection\n    isAllFilterSelectedForFacet[facet] = selector === SELECT_ALL\n    this.props.updateParentState!({\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n      chartSelectionIndex: index,\n    })\n\n    // read input and fetch data\n    const htmlCheckboxes = Array.from(\n      ref.current!.querySelectorAll('.SRC-facet-checkboxes'),\n    ) as HTMLInputElement[]\n    // queryRequest is a deep clone\n    const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n    const { newQueryRequest } = readFacetValues({\n      htmlCheckboxes,\n      queryRequest,\n      selector,\n      facet,\n      value: facetValue,\n    })\n\n    queryRequest.query.offset = 0\n    this.props.executeQueryRequest!(newQueryRequest)\n  }\n\n  public showAllFacets(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault()\n    this.setState({\n      showAllFacets: true,\n    })\n  }\n\n  public showButtons(\n    curFacetsLength: number,\n    ref: React.RefObject<HTMLDivElement>,\n  ) {\n    if (this.state.showAllFacets || curFacetsLength <= 5) {\n      // this is hidden if there are > 5 facets, wait for user to make\n      // an action for this to appear\n      return (\n        <button\n          className=\"SRC-primary-text-color SRC-facet-select-all SRC-no-text-decor\"\n          onClick={this.applyChanges(ref, '', SELECT_ALL, 0)}\n        >\n          Select All\n        </button>\n      )\n    }\n    return (\n      <button\n        id=\"showAllFacetsButton\"\n        className=\"SRC-primary-text-color SRC-no-text-decor\"\n        onClick={this.showAllFacets}\n      >\n        Show All ({curFacetsLength})\n      </button>\n    )\n  }\n\n  public render() {\n    if (!this.props.data) {\n      return <div />\n    }\n    const { data, facet, unitDescription, isLoading, showBarChart } = this.props\n    const { facets } = data\n    if (!facets) {\n      throw Error(\n        'Error on query request, must include facets in partmask to show facets',\n      )\n    }\n    const curFacetsIndex = facets.findIndex(\n      curFacet =>\n        curFacet.columnName === facet && curFacet.facetType === 'enumeration',\n    )\n    // cast is necessary because filter returns an array of arrays\n    const facetColumnResultValues = facets[\n      curFacetsIndex\n    ] as FacetColumnResultValues\n\n    if (!facetColumnResultValues) {\n      return <div />\n    }\n    const ref: React.RefObject<HTMLDivElement> = React.createRef()\n    return (\n      <div className=\"SRC-syn-border-spacing\">\n        {!showBarChart && (\n          <TotalQueryResults\n            lastQueryRequest={this.props.getLastQueryRequest!()}\n            token={this.props.token}\n            unitDescription={unitDescription!}\n            frontText={'Displaying'}\n            isLoading={isLoading!}\n          />\n        )}\n        <form>\n          <div ref={ref} className=\"SRC-marginFive form-group\">\n            {this.showFacetFilter()}\n            {this.showButtons(facetColumnResultValues.facetValues.length, ref)}\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport { Facets, CheckboxGroup }\n","import * as React from 'react'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCaretDown,\n  faCaretUp,\n  faSearch,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { insertConditionsFromSearchParams } from '../utils/functions/sqlFunctions'\nimport TotalQueryResults from './TotalQueryResults'\nimport getColorPallette from './ColorGradient'\nimport { SEARCH_CLASS_CSS } from './QueryWrapperMenu'\nimport { Dropdown } from 'react-bootstrap'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\n\nlibrary.add(faCaretDown)\nlibrary.add(faCaretUp)\nlibrary.add(faSearch)\nlibrary.add(faTimes)\n\ntype SearchState = {\n  dropdownIndex: number\n  show: boolean\n  searchText: string\n  submittedSearchText: string\n  lastSearchedFacet: string\n}\nexport type Searchable = {\n  columnName: string\n  hintText: string\n}[]\n\nexport type SearchProps = {\n  searchable: Searchable\n  isQueryWrapperMenuChild?: boolean\n}\n\ntype InternalSearchProps = QueryWrapperChildProps & SearchProps\n\nclass Search extends React.Component<InternalSearchProps, SearchState> {\n  public inputRef: React.RefObject<HTMLInputElement>\n\n  constructor(props: InternalSearchProps) {\n    super(props)\n    this.state = {\n      dropdownIndex: 0,\n      show: false,\n      searchText: '',\n      submittedSearchText: '',\n      lastSearchedFacet: '',\n    }\n    this.inputRef = React.createRef()\n  }\n\n  componentDidUpdate(prevProps: InternalSearchProps) {\n    if (this.props.isLoading === false && prevProps.isLoading === true) {\n      // highlighting will sometimes outpace the render method for react, adding the slight delay\n      // mitigates this\n      setTimeout(this.highlightText, 100)\n    }\n  }\n\n  public toggleDropdown = (value: boolean) => (_: React.SyntheticEvent) => {\n    this.setState({\n      show: value,\n    })\n  }\n\n  public setDropdownIndex = (index: number) => (_: React.SyntheticEvent) => {\n    this.inputRef.current && this.inputRef.current.focus()\n    this.setState({\n      dropdownIndex: index,\n      show: false,\n    })\n  }\n\n  public highlightText = () => {\n    const { submittedSearchText, dropdownIndex } = this.state\n    const {\n      searchable,\n      rgbIndex,\n      facetAliases = {},\n      isQueryWrapperMenuChild = true,\n    } = this.props\n    const { colorPalette } = getColorPallette(rgbIndex!, 1)\n    const originalColor = colorPalette[0]\n    const searchItem = searchable[dropdownIndex]\n\n    const highlightedSpans = document.querySelectorAll<HTMLSpanElement>(\n      '.highlight',\n    )\n    highlightedSpans.forEach(span => {\n      span.outerHTML = span.innerText\n    })\n    if (submittedSearchText) {\n      const searchItemView =\n        facetAliases[searchItem.columnName] ||\n        unCamelCase(searchItem.columnName)\n      const frontText = isQueryWrapperMenuChild ? `.${SEARCH_CLASS_CSS} ` : ''\n      const querySelector = `${frontText}[data-search-handle=\"${searchItemView}\"]`\n      const trs = document.querySelectorAll<HTMLElement>(querySelector)\n      // Target elements and apply styles\n      trs.forEach(textElement => {\n        if (textElement.innerHTML !== null) {\n          const regex = new RegExp(submittedSearchText, 'gi')\n          const match = textElement.innerText.match(regex)\n          if (match) {\n            // innerHTML contains only text\n            textElement.innerHTML = textElement.innerHTML.replace(\n              regex,\n              match => {\n                return `<span style=\"background: ${originalColor}; color: white;\" class=\"highlight\">${match}</span>`\n              },\n            )\n          }\n        }\n      })\n    }\n  }\n\n  public static addEscapeCharacters = (searchText: string) => {\n    // We have to escape the following characters\n    // ' % \\\n    let escapedSearchText = searchText\n    // escape ' by adding additional '\n    escapedSearchText = escapedSearchText.split(\"'\").join(\"''\")\n    // escape % by adding \\\n    // eslint-disable-next-line no-useless-escape\n    escapedSearchText = escapedSearchText.split('%').join('%')\n    // escape \\ by adding \\\n    escapedSearchText = escapedSearchText.split('\\\\').join('\\\\\\\\')\n    return escapedSearchText\n  }\n\n  public clearSearchText = () => {\n    this.setState({\n      searchText: '',\n    })\n  }\n\n  public search = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    // form completion by default causes the page to reload, so we prevent that\n    event.preventDefault()\n    const { searchText, dropdownIndex } = this.state\n\n    const { searchable } = this.props\n    const searchItem = searchable[dropdownIndex]\n    // Always grabs initQueryRequest so that it doesn't build a chain of\n    // LIKE clauses\n    const lastQueryRequestDeepCopy = this.props.getInitQueryRequest!()\n    const { sql } = lastQueryRequestDeepCopy.query\n    const searchParams = {\n      [searchItem.columnName]: Search.addEscapeCharacters(searchText),\n    }\n    const newSql = insertConditionsFromSearchParams(searchParams, sql)\n    lastQueryRequestDeepCopy.query.sql = newSql\n    lastQueryRequestDeepCopy.query.offset = 0\n    this.setState({\n      submittedSearchText: searchText,\n      lastSearchedFacet: searchItem.columnName,\n    })\n    this.props.executeQueryRequest!(lastQueryRequestDeepCopy)\n  }\n\n  public handleChange = (event: React.FormEvent<HTMLInputElement>) => {\n    this.setState({\n      searchText: event.currentTarget.value,\n    })\n  }\n\n  render() {\n    const {\n      searchable,\n      isLoading,\n      getLastQueryRequest,\n      unitDescription = '',\n      facetAliases = {},\n    } = this.props\n    const {\n      show,\n      dropdownIndex,\n      searchText,\n      submittedSearchText,\n      lastSearchedFacet,\n    } = this.state\n    const searchableItem = searchable[dropdownIndex]\n    const containerStyle: React.CSSProperties = {\n      border: '1px solid #DCDCDC',\n      display: 'flex',\n      marginTop: 10,\n      alignItems: 'center',\n    }\n    const fieldStyle: React.CSSProperties = {\n      background: '#F9F9F9',\n      height: '51px',\n      display: 'inline-flex',\n      alignItems: 'center',\n    }\n    const caretIconStyle: React.CSSProperties = {\n      fontSize: '16px',\n      marginRight: 8,\n    }\n    const searchIconStyle: React.CSSProperties = {\n      color: '#C4C4C4',\n      position: 'absolute',\n      left: 10,\n      fontSize: 16,\n    }\n    const cancelIconStyle: React.CSSProperties = {\n      width: 30,\n      height: 30,\n      position: 'absolute',\n      right: 10,\n    }\n    const inputStyle: React.CSSProperties = {\n      border: 1,\n      paddingLeft: 40,\n      height: 49,\n    }\n    const dropdownBtnStyle: React.CSSProperties = {\n      justifyContent: 'space-between',\n      margin: 0,\n      paddingLeft: 10,\n    }\n    const totalQueryResultsStyle: React.CSSProperties = {\n      margin: '20px 0px',\n    }\n    const curFacetDisplayText =\n      facetAliases[searchableItem.columnName] ||\n      unCamelCase(searchableItem.columnName)\n    const lastSearchedFacetDisplayText =\n      facetAliases[lastSearchedFacet] || unCamelCase(lastSearchedFacet)\n    const usedUnitDescription = submittedSearchText\n      ? `${unitDescription} containing \"${submittedSearchText}\" in ${lastSearchedFacetDisplayText}`\n      : unitDescription\n    return (\n      <div>\n        <p>\n          Search within <strong> {curFacetDisplayText} </strong> using keywords\n        </p>\n        <div style={containerStyle}>\n          <div className=\"SRC-centerContent SRC-fullWidth\">\n            <div\n              style={{\n                ...fieldStyle,\n                flex: 1,\n                borderRight: '1px solid #DCDCDC',\n              }}\n            >\n              <Dropdown\n                show={show}\n                onToggle={() => this.setState({ show: !show })}\n                className=\"SRC-inherit-height SRC-fullWidth\"\n              >\n                <Dropdown.Toggle\n                  style={dropdownBtnStyle}\n                  className=\"SRC-primary-color-hover-dropdown SRC-inlineFlex SRC-inherit-height SRC-fullWidth\"\n                  variant=\"light\"\n                  id=\"search-toggle\"\n                >\n                  {curFacetDisplayText}\n                  <FontAwesomeIcon\n                    style={caretIconStyle}\n                    icon={show ? 'caret-up' : 'caret-down'}\n                    color={show ? 'white' : undefined}\n                  />\n                </Dropdown.Toggle>\n                <Dropdown.Menu>\n                  {searchable.map((el, index) => {\n                    const displayName =\n                      facetAliases[el.columnName] || unCamelCase(el.columnName)\n                    return (\n                      <Dropdown.Item\n                        // @ts-ignore\n                        onSelect={this.setDropdownIndex(index)}\n                        key={displayName}\n                        className=\"SRC-hand-cursor SRC-primary-background-color-hover\"\n                      >\n                        {displayName}\n                      </Dropdown.Item>\n                    )\n                  })}\n                </Dropdown.Menu>\n              </Dropdown>\n            </div>\n            <form\n              style={{\n                ...fieldStyle,\n                flex: 3,\n                alignItems: 'center',\n                position: 'relative',\n              }}\n              onSubmit={this.search}\n            >\n              <FontAwesomeIcon\n                size={'sm'}\n                style={searchIconStyle}\n                icon={'search'}\n              />\n              <input\n                placeholder={`e.g. \"${searchableItem.hintText}\"`}\n                style={inputStyle}\n                ref={this.inputRef}\n                onChange={this.handleChange}\n                value={searchText}\n                type=\"text\"\n                className=\"SRC-fullWidth\"\n              />\n              {searchText.length > 0 && (\n                <button\n                  type=\"reset\"\n                  className=\"SRC-button-focus-primary-color SRC-centerContentInline\"\n                  style={cancelIconStyle}\n                  onClick={this.clearSearchText}\n                  tabIndex={0}\n                >\n                  <FontAwesomeIcon\n                    size={'sm'}\n                    color={'#C4C4C4'}\n                    style={{ fontSize: 16 }}\n                    icon={'times'}\n                  />\n                </button>\n              )}\n            </form>\n          </div>\n        </div>\n        <TotalQueryResults\n          style={totalQueryResultsStyle}\n          isLoading={isLoading!}\n          frontText={'Displaying'}\n          token={this.props.token}\n          lastQueryRequest={getLastQueryRequest!()}\n          unitDescription={usedUnitDescription}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Search\n","import { CSSTransition, TransitionGroup } from 'react-transition-group'\nimport * as React from 'react'\nimport { SynapseConstants } from '../utils/'\nimport { getColorPallette } from './ColorGradient'\nimport { Facets } from './Facets'\nimport QueryCount from './QueryCount'\nimport QueryWrapper from './QueryWrapper'\nimport StackedBarChart from './StackedBarChart'\nimport SynapseTable, { SynapseTableProps } from './table/SynapseTable'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport CardContainer from './CardContainer'\nimport { CardConfiguration } from './CardContainerLogic'\nimport { StackedBarChartProps } from './StackedBarChart'\nimport {\n  isGroupByInSql,\n  insertConditionsFromSearchParams,\n  parseEntityIdFromSqlStatement,\n} from '../utils/functions/sqlFunctions'\nimport {\n  FacetColumnValuesRequest,\n  QueryBundleRequest,\n} from '../utils/synapseTypes/'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus, faSearch } from '@fortawesome/free-solid-svg-icons'\nimport Search, { SearchProps } from './Search'\nimport * as DeepLinkingUtils from '../utils/functions/deepLinkingUtils'\n\nlibrary.add(faPlus)\nlibrary.add(faSearch)\n\ntype MenuState = {\n  activeMenuIndices: number[]\n  accordionGroupIndex: number\n}\n\nexport type MenuConfig = {\n  sql: string\n  facet?: string\n}\n\n// represents the entirety of the menu\nexport const MENU_DROPDOWN_CSS = 'SRC-menuLayout'\n// represent an accordiong 'group' within the menu\nexport const ACCORDION_GROUP_CSS = 'SRC-accordion-key'\n// represents the single accordiong group which is active within the menu\nexport const ACCORDION_GROUP_ACTIVE_CSS = 'SRC-IS-ACTIVE'\n// for search component querying on cardcontainer\nexport const SEARCH_CLASS_CSS = 'SRC-search-component'\n\ninterface MenuSearchParams {\n  facetValue: string\n  facet: string\n  menuIndex?: string\n}\n\ntype CommonMenuProps = {\n  tableConfiguration?: SynapseTableProps\n  cardConfiguration?: CardConfiguration\n  stackedBarChartConfiguration?: StackedBarChartProps\n  searchConfiguration?: SearchProps\n  showBarChart?: boolean\n  unitDescription?: string\n}\n\ntype AccordionConfig = {\n  searchConfiguration?: SearchProps\n  menuConfig: MenuConfig[]\n  name: string\n} & CommonMenuProps\n\nexport type QueryWrapperMenuProps = {\n  facetAliases?: {}\n  menuConfig?: MenuConfig[]\n  accordionConfig?: AccordionConfig[]\n  token?: string\n  rgbIndex: number\n  searchParams?: MenuSearchParams\n  name?: string\n  globalQueryCountSql?: string\n  componentIndex?: number //used for deep linking\n  shouldDeepLink?: boolean\n} & CommonMenuProps\n\ntype Info = {\n  isSelected: boolean\n  originalColor: string\n  hoverWhiteTextClass?: string\n}\n\nexport default class QueryWrapperMenu extends React.Component<\n  QueryWrapperMenuProps,\n  MenuState\n> {\n  constructor(props: QueryWrapperMenuProps) {\n    super(props)\n    // See note about initializing props from state here\n    //  - https://stackoverflow.com/questions/40063468/react-component-initialize-state-from-props/47341539#47341539\n    const { searchParams, accordionConfig, menuConfig } = this.props\n    let activeMenuIndices = []\n    let accordionGroupIndex = searchParams?.menuIndex\n      ? Number.parseInt(searchParams?.menuIndex) || 0\n      : 0\n    const facetIndexFromFacetSearchParam = menuConfig?.findIndex(\n      el => el.facet && el.facet === searchParams?.facet,\n    )\n    const usedFacetIndex =\n      facetIndexFromFacetSearchParam === -1 ? 0 : facetIndexFromFacetSearchParam\n    const indexFromURLOrDefaultZero = usedFacetIndex || 0\n    if (accordionConfig) {\n      activeMenuIndices = new Array(accordionConfig.length).fill(0)\n    } else {\n      activeMenuIndices = [indexFromURLOrDefaultZero]\n    }\n    this.state = {\n      activeMenuIndices,\n      accordionGroupIndex,\n    }\n    this.handleHoverLogic = this.handleHoverLogic.bind(this)\n    this.switchFacet = this.switchFacet.bind(this)\n    this.getUnitDescription = this.getUnitDescription.bind(this)\n    this.getPartMask = this.getPartMask.bind(this)\n    this.getSelectedFacets = this.getSelectedFacets.bind(this)\n    this.getSqlWithAdditionalClause = this.getSqlWithAdditionalClause.bind(this)    \n  }\n\n  componentDidUpdate(prevProps: QueryWrapperMenuProps, _prevState: MenuState) {\n    /*\n      Update the row count or the menu index if the props changed by looking at whether the sql or the rgbIndex\n      changed\n    */\n    let { activeMenuIndices } = this.state\n    const { rgbIndex, accordionConfig } = this.props\n    if (rgbIndex !== prevProps.rgbIndex) {\n      activeMenuIndices = accordionConfig\n        ? new Array(accordionConfig.length).fill(0)\n        : [0]\n      this.setState({\n        activeMenuIndices,\n        accordionGroupIndex: 0,\n      })\n    }\n  }\n\n  /**\n   * Handle the user hovering over a facet selection, it must be programatically\n   * handled because the color used is dynamic\n   *\n   * @memberof Menu\n   */\n  public handleHoverLogic = (info: Info) => (\n    event: React.MouseEvent<HTMLDivElement>,\n  ) => {\n    // This prevents a bug where there is both light text and a light background,\n    // otherwise SRC-hoverWhiteText would be placed on the group and item keys statically\n    if (!event.currentTarget.classList.contains('SRC-hoverWhiteText')) {\n      event.currentTarget.classList.add('SRC-hoverWhiteText')\n    }\n    if (!info.isSelected && event.currentTarget.tagName === 'DIV') {\n      event.currentTarget.style.backgroundColor = info.originalColor\n    }\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public switchFacet = (menuIndexIn: number, accordionIndexIn: number) => (\n    _: React.SyntheticEvent<HTMLDivElement>,\n  ) => {\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    // there's an odd bug where clicking a menu item twice will select the first tab,\n    // this is a fix for that, but this shouldn't be necessary\n    const isClickingCurrentSelection =\n      accordionGroupIndex === accordionIndexIn &&\n      activeMenuIndices[accordionIndexIn] === menuIndexIn\n    if (!isClickingCurrentSelection) {\n      activeMenuIndices[accordionIndexIn] = menuIndexIn\n      this.setState({\n        activeMenuIndices,\n        accordionGroupIndex: accordionIndexIn,\n      })\n\n      if (this.props.shouldDeepLink) {\n        const facetName = this.props.menuConfig?.[menuIndexIn].facet\n        DeepLinkingUtils.updateUrlWithNewSearchParam(\n          'menuIndex',\n          undefined,\n          accordionIndexIn.toString(),\n        )\n        if (facetName) {\n          DeepLinkingUtils.updateUrlWithNewSearchParam(\n            'facet',\n            undefined,\n            facetName,\n          )\n        }\n      }\n    }\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public toggleGroupAccordionIndex = (accordionGroupIndexIn: number) => (\n    _event: React.SyntheticEvent<HTMLDivElement>,\n  ) => {\n    const { accordionGroupIndex } = this.state\n    if (accordionGroupIndex === accordionGroupIndexIn) {\n      return\n    } else {\n      this.setState({\n        accordionGroupIndex: accordionGroupIndexIn,\n      })\n    }\n  }\n\n  public render() {\n    const {\n      stackedBarChartConfiguration,\n      name,\n      menuConfig,\n      token,\n      globalQueryCountSql = '',\n    } = this.props\n    const { activeMenuIndices } = this.state\n\n    let sql = ''\n    if (menuConfig) {\n      sql = menuConfig![activeMenuIndices[0]].sql\n    }\n    if (globalQueryCountSql) {\n      // globalQueryCountSql takes precendence over menuconfig sql\n      sql = globalQueryCountSql\n    }\n    const hasGroupByInSql = isGroupByInSql(sql)\n    const menuDropdown = this.renderMenuDropdown()\n    const queryWrapper = this.renderQueryChildren()\n    const showBarChart = stackedBarChartConfiguration !== undefined\n    return (\n      <React.Fragment>\n        {name && sql && !hasGroupByInSql && (\n          <h3 id=\"exploreCount\" className=\"SRC-boldText\">\n            <QueryCount token={token} name={name} sql={sql} />\n          </h3>\n        )}\n        {hasGroupByInSql && (\n          <h3 id=\"exploreCount\" className=\"SRC-boldText\">\n            {name}\n          </h3>\n        )}\n        <div className=\"break\">\n          <hr />\n        </div>\n        <div className=\"row\" key=\"row\">\n          <div\n            className={`col-xs-12 col-sm-3 col-lg-2 SRC-menuLayout ${\n              showBarChart ? 'SRC-menuPadding' : 'SRC-menuPaddingLess'\n            }`}\n          >\n            {menuDropdown}\n          </div>\n          <div className=\"col-xs-12 col-sm-9 col-lg-10\" key=\"queryWrapper\">\n            {queryWrapper}\n          </div>\n        </div>\n      </React.Fragment>\n    )\n  }\n\n  private renderQueryChild(\n    menuConfig: MenuConfig[],\n    queryConfig: CommonMenuProps,\n    groupIndex: number,\n  ) {\n    const {\n      token,\n      rgbIndex = 0,\n      searchParams,\n      accordionConfig = [],\n      facetAliases = {},\n      shouldDeepLink,\n    } = this.props\n    const {\n      cardConfiguration,\n      tableConfiguration,\n      stackedBarChartConfiguration,\n      unitDescription = '',\n      searchConfiguration,\n    } = queryConfig\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    let facetValue = ''\n    let facetValueFromSearchParams = ''\n    if (searchParams) {\n      ;({\n        facetValue = '',\n        facet: facetValueFromSearchParams = '',\n      } = searchParams)\n    }\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const isSelected: boolean =\n        groupIndex === accordionGroupIndex &&\n        activeMenuIndices[accordionGroupIndex] === index\n      const { facet, sql } = config\n      const name =\n        accordionConfig[groupIndex] && accordionConfig[groupIndex].name\n      const hasGroupByInSql = isGroupByInSql(sql)\n      // only show search component if its the last item in the menu config\n      const showSearch =\n        index === menuConfig.length - 1 && searchConfiguration !== undefined\n      const showBarChart =\n        stackedBarChartConfiguration !== undefined &&\n        !showSearch &&\n        !hasGroupByInSql\n      const aliasedFacet: string =\n        facet && (facetAliases[facet] || unCamelCase(facet))\n\n      // search class is only used for testing, no css is actually applied\n      let searchClass = showSearch ? SEARCH_CLASS_CSS : ''\n      if (!isSelected) {\n        searchClass = 'SRC-hidden'\n      }\n\n      // Get props for query wrapper\n      const usedUnitDescription = this.getUnitDescription(\n        unitDescription,\n        aliasedFacet,\n        showSearch,\n        accordionConfig.length > 0,\n        name,\n      )\n      const isSelectedFromURL =\n        config.facet !== undefined &&\n        config.facet === facetValueFromSearchParams\n      const selectedFacets = this.getSelectedFacets(\n        isSelectedFromURL,\n        facet,\n        facetValue,\n      )\n      const partMask = this.getPartMask(facet, hasGroupByInSql)\n      const initQueryRequest: QueryBundleRequest = {\n        partMask,\n        concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n        entityId: parseEntityIdFromSqlStatement(sql),\n        query: {\n          sql,\n          selectedFacets,\n          limit: 25,\n          offset: 0,\n        },\n      }\n\n      const queryFromUrl = DeepLinkingUtils.getQueryRequestFromLink(\n        'QueryWrapper',\n        index,\n      )\n\n      return (\n        <span key={(facet || 'nofacet') + index} className={searchClass}>\n          <QueryWrapper\n            componentIndex={index}\n            showBarChart={showBarChart}\n            loadNow={isSelected}\n            initQueryRequest={queryFromUrl || initQueryRequest}\n            unitDescription={usedUnitDescription}\n            facet={facet}\n            token={token}\n            rgbIndex={rgbIndex}\n            facetAliases={facetAliases}\n            shouldDeepLink={shouldDeepLink}\n          >\n            {showBarChart ? (\n              <StackedBarChart {...stackedBarChartConfiguration!} />\n            ) : (\n              <React.Fragment />\n            )}\n            {!showSearch ? <Facets /> : <React.Fragment />}\n            {showSearch ? (\n              <Search searchable={searchConfiguration!.searchable} />\n            ) : (\n              <React.Fragment />\n            )}\n            {/*\n                Using a conditional render fails here because QueryWrapper can't clone an undefined element\n                which will happen if either configuration is undefined.\n            */}\n            {tableConfiguration ? (\n              <SynapseTable\n                {...{\n                  ...tableConfiguration\n                }}\n              />\n            ) : (\n              <React.Fragment />\n            )}\n            {cardConfiguration ? (\n              <CardContainer {...cardConfiguration} />\n            ) : (\n              <React.Fragment />\n            )}\n          </QueryWrapper>\n        </span>\n      )\n    })\n  }\n\n  public getUnitDescription(\n    unitDescription: string,\n    aliasedFacet: string,\n    showSearch: boolean,\n    isAccordionConfigDefined: boolean,\n    name: string,\n  ) {\n    if (isAccordionConfigDefined && !showSearch) {\n      return `${name} Tools by ${aliasedFacet}`\n    }\n    if (isAccordionConfigDefined && showSearch) {\n      // This is also a hardcoded setting to detect if search within a tools accordion is being shown\n      return `${name} Tools`\n    }\n    return unitDescription\n  }\n\n  public getPartMask(facet: string | undefined, hasGroupByInSql: boolean) {\n    let partMask =\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS |\n      SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS\n    if (facet) {\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_FACETS\n    } else {\n      // Needed to calculate the total count for TotalQueryResults\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_COUNT\n    }\n    // note: COLUMN_MODELS unnecessary for Synapse Table link for aggregate functions since we now rely on the sql parser to distinguish.\n    return partMask\n  }\n\n  public getSelectedFacets(\n    isSelected: boolean,\n    facet: string | undefined,\n    facetValue: string | undefined,\n  ): FacetColumnValuesRequest[] {\n    if (isSelected && facet && facetValue) {\n      return [\n        {\n          concreteType:\n            'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n          facetValues: [facetValue],\n          columnName: facet,\n        },\n      ]\n    }\n    return []\n  }\n\n  public getSqlWithAdditionalClause(\n    isSelected: boolean,\n    facet: string | undefined,\n    facetValue: string | undefined,\n    sql: string,\n  ): string {\n    if (isSelected && facet && facetValue && this.props.searchParams) {\n      return insertConditionsFromSearchParams(\n        { [facet]: facetValue },\n        sql,\n        'LIKE',\n      )\n    }\n    return sql\n  }\n\n  private renderQueryChildren() {\n    const { accordionConfig, menuConfig } = this.props\n    const { accordionGroupIndex } = this.state\n    if (accordionConfig) {\n      return accordionConfig.map((el, index) => {\n        return (\n          <div\n            key={JSON.stringify(el) + index}\n            className={accordionGroupIndex === index ? '' : 'SRC-hidden'}\n          >\n            {this.renderQueryChild(el.menuConfig, el, index)}\n          </div>\n        )\n      })\n    } else {\n      return this.renderQueryChild(menuConfig!, this.props, 0)\n    }\n  }\n\n  private renderMenuDropdown() {\n    const { accordionConfig, menuConfig, searchConfiguration } = this.props\n    const { accordionGroupIndex } = this.state\n    const { rgbIndex } = this.props\n    const { colorPalette } = getColorPallette(rgbIndex, 5)\n    const lightColor = '#F5F5F5'\n    if (accordionConfig) {\n      return accordionConfig.map((el, index) => {\n        const isActive = accordionGroupIndex === index\n        const primaryColor = colorPalette[0]\n        const style: React.CSSProperties = {\n          background: isActive ? primaryColor : lightColor,\n          color: isActive ? 'white' : '',\n        }\n        const indicatorClasses = isActive\n          ? 'SRC-whiteText SRC-pointed-triangle-down'\n          : ' SRC-hand-cursor '\n        if (isActive) {\n          style.borderTopColor = primaryColor\n        }\n        const hoverEnter: Info = {\n          isSelected: isActive,\n          originalColor: primaryColor,\n        }\n        const hoverLeave: Info = {\n          isSelected: isActive,\n          originalColor: lightColor,\n        }\n        const iconContainerStyle: React.CSSProperties = {\n          marginLeft: 5,\n        }\n        const iconStyle: React.CSSProperties = {\n          fontSize: '0.55em',\n        }\n        return (\n          <div\n            key={JSON.stringify(el)}\n            className={isActive ? ACCORDION_GROUP_ACTIVE_CSS : ''}\n          >\n            <div\n              style={style}\n              role={isActive ? '' : 'button'}\n              onMouseEnter={this.handleHoverLogic(hoverEnter)}\n              onMouseLeave={this.handleHoverLogic(hoverLeave)}\n              className={`${ACCORDION_GROUP_CSS} SRC-gap SRC-menu-button-base SRC-background-unset ${indicatorClasses}`}\n              onClick={\n                !isActive ? this.toggleGroupAccordionIndex(index) : undefined\n              }\n            >\n              {el.name}\n              <span style={iconContainerStyle}>\n                {!isActive && (\n                  <FontAwesomeIcon\n                    style={iconStyle}\n                    color={primaryColor}\n                    icon={'plus'}\n                  />\n                )}\n              </span>\n            </div>\n            <TransitionGroup component={null}>\n              {isActive && (\n                <CSSTransition\n                  // The component doesn't run a transition on mount, we override this\n                  // by setting appear to true because otherwise the triangle indicator wouldn't show\n                  appear={true}\n                  key={JSON.stringify(el)}\n                  classNames=\"SRC-accordion-menu\"\n                  timeout={{ enter: 1000, exit: 500 }}\n                >\n                  <div className={'SRC-accordion-menu'}>\n                    {this.renderFacetMenu(\n                      el.menuConfig,\n                      index,\n                      el.searchConfiguration,\n                    )}\n                  </div>\n                </CSSTransition>\n              )}\n            </TransitionGroup>\n          </div>\n        )\n      })\n    }\n    return this.renderFacetMenu(menuConfig!, 0, searchConfiguration)\n  }\n\n  private renderFacetMenu(\n    menuConfig: MenuConfig[],\n    curLevel: number,\n    searchConfiguration?: SearchProps,\n  ) {\n    const { rgbIndex, accordionConfig, facetAliases = {} } = this.props\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    const { colorPalette } = getColorPallette(rgbIndex, 5)\n    let originalColor = colorPalette[0]\n    let defaultColor = '#F5F5F5'\n    if (accordionConfig) {\n      originalColor = colorPalette[2]\n      defaultColor = colorPalette[4]\n    }\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const searchIconStyle: React.CSSProperties = {\n        margin: 'auto 0',\n        opacity: 0.4,\n      }\n      const { facet } = config\n      const isSelected: boolean =\n        activeMenuIndices[accordionGroupIndex] === index &&\n        curLevel === accordionGroupIndex\n      const style: React.CSSProperties = {}\n      const isSearchConfig =\n        index === menuConfig.length - 1 && searchConfiguration\n      let selectedStyling: string = ''\n      if (isSelected) {\n        // we have to programatically set the style since the color is chosen from a color\n        // wheel\n        style.background = originalColor\n        // below has to be set so the pseudo element created will inherit its color\n        // appropriately\n        style.borderLeftColor = originalColor\n        selectedStyling = 'SRC-pointed-triangle-right SRC-whiteText'\n        searchIconStyle.color = 'white'\n      } else {\n        // change background to class\n        selectedStyling = 'SRC-blackText'\n        style.background = defaultColor\n      }\n      const infoEnter: Info = { isSelected, originalColor }\n      const infoLeave: Info = { isSelected, originalColor: defaultColor }\n      const facetDisplayValue: string =\n        (facet && facetAliases[facet]) || unCamelCase(facet)\n      return (\n        <div\n          onMouseEnter={this.handleHoverLogic(infoEnter)}\n          onMouseLeave={this.handleHoverLogic(infoLeave)}\n          key={(config.facet || 'nofacet') + index}\n          className={`SRC-hand-cursor SRC-background-unset ${selectedStyling} SRC-menu-button-base SRC-gap`}\n          onClick={this.switchFacet(index, curLevel)}\n          onKeyPress={this.switchFacet(index, curLevel)}\n          role=\"button\"\n          tabIndex={0}\n          style={style}\n        >\n          {isSearchConfig ? 'Search' : facetDisplayValue}\n          {isSearchConfig && (\n            <span>\n              <FontAwesomeIcon\n                className={selectedStyling}\n                size={'sm'}\n                style={searchIconStyle}\n                icon=\"search\"\n              />\n            </span>\n          )}\n        </div>\n      )\n    })\n  }\n}\n","import * as React from 'react'\nimport {\n  createEntity,\n  getEntity,\n  lookupChildEntity,\n  updateEntity,\n  uploadFile,\n} from '../utils/SynapseClient'\nimport {\n  EntityId,\n  EntityLookupRequest,\n  FileEntity,\n  FileUploadComplete,\n} from '../utils/synapseTypes/'\n\ntype UploaderState = {\n  token?: string\n  error?: any\n  totalFilesToUploadCount: number\n  filesUploadedCount: number\n  isUploading?: boolean\n  successfullyUploaded: boolean\n}\n\nexport type UploaderProps = {\n  token?: string\n  parentContainerId: string\n}\n\nexport default class Uploader extends React.Component<\n  UploaderProps,\n  UploaderState\n> {\n  private readonly inputOpenFileRef: React.RefObject<HTMLInputElement>\n\n  constructor(props: UploaderProps) {\n    super(props)\n    this.state = {\n      token: '',\n      isUploading: false,\n      filesUploadedCount: 0,\n      totalFilesToUploadCount: 0,\n      successfullyUploaded: false,\n    }\n    this.inputOpenFileRef = React.createRef()\n  }\n\n  showOpenFileDlg = () => {\n    if (this.inputOpenFileRef && this.inputOpenFileRef.current) {\n      this.inputOpenFileRef.current.click()\n    }\n  }\n\n  handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files) {\n      this.handleFilesChanged(event.target.files)\n    }\n  }\n\n  finishedProcessingOneFile = () => {\n    const incrementedFilesUploadedCount = this.state.filesUploadedCount + 1\n    const isStillUploading =\n      incrementedFilesUploadedCount < this.state.totalFilesToUploadCount\n    this.setState({\n      isUploading: isStillUploading,\n      filesUploadedCount: incrementedFilesUploadedCount,\n      successfullyUploaded: !isStillUploading,\n    })\n  }\n\n  handleUploadError = (error: any) => {\n    this.finishedProcessingOneFile()\n    this.setState({ error })\n  }\n\n  handleFilesChanged = (selectorFiles: FileList) => {\n    this.setState({\n      error: undefined,\n      isUploading: true,\n      filesUploadedCount: 0,\n      totalFilesToUploadCount: selectorFiles.length,\n      successfullyUploaded: false,\n    })\n    Array.from(selectorFiles).forEach(file => {\n      // check for existing filename in parent folder before upload (add new version if exists).\n      // note that the parent container (project/folder) is configurable.\n      const newFileEntity: FileEntity = {\n        parentId: this.props.parentContainerId,\n        name: file.name,\n        concreteType: 'org.sagebionetworks.repo.model.FileEntity',\n        dataFileHandleId: '',\n      }\n      const entityLookupRequest: EntityLookupRequest = {\n        entityName: file.name,\n        parentId: this.props.parentContainerId,\n      }\n      lookupChildEntity(entityLookupRequest, this.props.token)\n        .then((entityId: EntityId) => {\n          // ok, found an entity of the same name.\n          getEntity<FileEntity>(this.props.token, entityId.id).then(\n            (existingEntity: FileEntity) => {\n              if (\n                existingEntity.concreteType ===\n                'org.sagebionetworks.repo.model.FileEntity'\n              ) {\n                this.updateEntityFile(existingEntity, file)\n              } else {\n                this.updateEntityFile(newFileEntity, file)\n              }\n            },\n          )\n        })\n        .catch((error: any) => {\n          if (error.status === 404) {\n            // great, it's a new file!\n            this.updateEntityFile(newFileEntity, file)\n          } else {\n            this.handleUploadError(error)\n          }\n        })\n    })\n  }\n\n  updateEntityFile = (fileEntity: FileEntity, file: File) => {\n    uploadFile(this.props.token, file.name, file)\n      .then((fileUploadComplete: FileUploadComplete) => {\n        const isCreate = fileEntity.dataFileHandleId === ''\n        fileEntity.dataFileHandleId = fileUploadComplete.fileHandleId\n        const createOrUpdate = isCreate ? createEntity : updateEntity\n        createOrUpdate(fileEntity, this.props.token).then(() => {\n          this.finishedProcessingOneFile()\n        })\n      })\n      .catch((error: any) => {\n        this.handleUploadError(error)\n      })\n  }\n\n  render() {\n    return (\n      <div>\n        {/** This input field is used for it's functionally (browse for files), the button acts as the UI. */}\n        <input\n          ref={this.inputOpenFileRef}\n          type=\"file\"\n          style={{ display: 'none' }}\n          onChange={this.handleChange}\n          multiple={true}\n        />\n        <button\n          type=\"button\"\n          onClick={this.showOpenFileDlg}\n          className=\"SRC-uploadButton\"\n        >\n          Browse...\n        </button>\n        {this.state.isUploading && (\n          <React.Fragment>\n            <span style={{ marginLeft: '10px' }}>\n              {this.state.filesUploadedCount} /\n              {this.state.totalFilesToUploadCount} file(s)\n            </span>\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          </React.Fragment>\n        )}\n        {this.state.successfullyUploaded && (\n          <span style={{ marginLeft: '10px' }}>\n            Successfully uploaded {this.state.totalFilesToUploadCount} file(s)\n            to\n            <a\n              style={{ marginLeft: '2px' }}\n              href={`https://www.synapse.org/#!Synapse:${this.props.parentContainerId}`}\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n            >\n              {this.props.parentContainerId}\n            </a>\n          </span>\n        )}\n        {this.state.error && <p>Upload error!</p>}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport {\n  getEntity,\n  getFileEntityContent,\n  updateEntity,\n  uploadFile,\n} from '../utils/SynapseClient'\nimport { Entity, FileEntity, FileUploadComplete } from '../utils/synapseTypes/'\n\ntype FileContentDownloadUploadDemoState = {\n  token?: string\n  error?: any\n  isLoading?: boolean\n  fileContent?: string\n  targetEntity?: FileEntity\n}\n\nexport type FileContentDownloadUploadDemoProps = {\n  token?: string\n  targetEntityId: string\n}\n\nexport default class FileContentDownloadUploadDemo extends React.Component<\n  FileContentDownloadUploadDemoProps,\n  FileContentDownloadUploadDemoState\n> {\n  constructor(props: FileContentDownloadUploadDemoProps) {\n    super(props)\n    this.state = {\n      token: '',\n      isLoading: false,\n    }\n  }\n\n  public componentDidMount() {\n    const { token, targetEntityId } = this.props\n    // must be logged in to download content\n    if (token) {\n      this.setState({ isLoading: true })\n      getEntity(token, targetEntityId)\n        .then((entity: Entity) => {\n          // if file entity\n          if (\n            entity.concreteType === 'org.sagebionetworks.repo.model.FileEntity'\n          ) {\n            const fileEntity: FileEntity = entity as FileEntity\n            getFileEntityContent(token, fileEntity).then(content => {\n              this.setState({\n                fileContent: content,\n                targetEntity: fileEntity,\n                isLoading: false,\n              })\n            })\n          } else {\n            this.setState({ error: 'invalid type', isLoading: false })\n          }\n        })\n        .catch(err => {\n          this.setState({ error: err, isLoading: false })\n        })\n    }\n  }\n\n  updateFileContent = (event: React.MouseEvent<HTMLButtonElement>) => {\n    // create a new FileHandle, and update the FileEntity\n    if (this.props.token && this.state.targetEntity && this.state.fileContent) {\n      this.setState({ isLoading: true })\n      const newFileContent = new Blob([this.state.fileContent], {\n        type: 'text/plain',\n      })\n      uploadFile(this.props.token, this.state.targetEntity.name, newFileContent)\n        .then((fileUploadComplete: FileUploadComplete) => {\n          // now update the entity!\n          if (this.state.targetEntity) {\n            this.state.targetEntity.dataFileHandleId =\n              fileUploadComplete.fileHandleId\n            updateEntity(this.state.targetEntity, this.props.token)\n              .then((entity: Entity) => {\n                const fileEntity = entity as FileEntity\n                // updated the target entity, force it to get the updated entity\n                this.setState({ targetEntity: fileEntity, isLoading: false })\n              })\n              .catch((err: string) => {\n                this.setState({ error: err, isLoading: false })\n              })\n          }\n        })\n        .catch((err: string) => {\n          this.setState({ error: err, isLoading: false })\n        })\n    }\n  }\n  handleContentChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.setState({ fileContent: event.target.value })\n  }\n\n  render() {\n    return (\n      <div>\n        {this.state.fileContent && (\n          <React.Fragment>\n            <div>\n              <textarea\n                style={{ width: '100%', height: '300px' }}\n                value={this.state.fileContent}\n                onChange={this.handleContentChange}\n              />\n            </div>\n            <button onClick={this.updateFileContent}>\n              Update File Content...\n            </button>\n          </React.Fragment>\n        )}\n        {this.state.isLoading && (\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        )}\n\n        {this.state.error && <p>Download error!</p>}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport Plotly from 'plotly.js-basic-dist'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SynapseClient } from '../utils'\nimport {\n  ProjectFilesStatisticsRequest,\n  ProjectFilesStatisticsResponse,\n  FilesCountStatistics,\n} from '../utils/synapseTypes/'\nconst Plot = createPlotlyComponent(Plotly)\n\nconst months = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec',\n]\n\nexport type StatisticsPlotProps = {\n  request: ProjectFilesStatisticsRequest\n  token?: string\n  title?: string\n  xtitle?: string\n  ytitle?: string\n  isHorizontal?: boolean\n  xaxistype?: string\n  showlegend?: boolean\n}\n\ntype StatisticsPlotState = {\n  isLoaded: boolean\n  plotData?: ProjectFilesStatisticsResponse\n}\n\nclass StatisticsPlot extends React.Component<\n  StatisticsPlotProps,\n  StatisticsPlotState\n> {\n  constructor(props: StatisticsPlotProps) {\n    super(props)\n    this.state = {\n      isLoaded: false,\n      plotData: {} as ProjectFilesStatisticsResponse,\n    }\n  }\n\n  public componentDidMount() {\n    this.fetchPlotlyData()\n  }\n  /**\n   * Get data for plotly\n   *\n   * @returns data corresponding to plotly widget\n   */\n  fetchPlotlyData = async () => {\n    const { request, token } = this.props\n    return SynapseClient.getProjectStatistics(request, token)\n      .then((data: ProjectFilesStatisticsResponse) => {\n        this.setState({\n          isLoaded: true,\n          plotData: data,\n        })\n      })\n      .catch((err: any) => {\n        console.log('Error on call to get statistics ', err)\n      })\n  }\n\n  getTrace = (\n    traceName: string,\n    stats: FilesCountStatistics[],\n    orientation: string,\n    markerColor: string,\n  ) => {\n    const x: string[] = []\n    const y: number[] = []\n    const trace = {\n      orientation,\n      x,\n      y,\n      name: traceName,\n      type: 'bar',\n      marker: { color: markerColor },\n      hovertemplate:\n        // see S3 Formatting options: https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format\n        `%{y:n} <br><extra>${traceName}</extra>`,\n    }\n    for (const statPoint of stats) {\n      const statPointDate: Date = new Date(statPoint.rangeStart)\n      trace.x.push(\n        `${\n          months[statPointDate.getUTCMonth()]\n        } ${statPointDate.getUTCFullYear()}`,\n      )\n      trace.y.push(statPoint.filesCount)\n    }\n    return trace\n  }\n\n  showPlot = () => {\n    if (!this.state.isLoaded || !this.state.plotData) {\n      return\n    }\n    const {\n      title,\n      xtitle,\n      ytitle,\n      isHorizontal,\n      xaxistype,\n      showlegend,\n    } = this.props\n    const plotData = this.state.plotData\n    const layout: any = {\n      showlegend,\n      title,\n      barmode: 'stack',\n      hovermode: 'x',\n    }\n    const config: any = {\n      displayModeBar: true,\n      displaylogo: false,\n      // options found here: https://github.com/plotly/plotly.js/blob/master/src/components/modebar/buttons.js\n      modeBarButtonsToRemove: [\n        'sendDataToCloud',\n        'hoverCompareCartesian',\n        'select2d',\n        'lasso2d',\n        'zoom2d',\n        'resetScale2d',\n        'hoverClosestCartesian',\n        'toggleSpikelines',\n      ],\n    }\n    if (xtitle) {\n      layout.xaxis = {\n        title: xtitle,\n      }\n    }\n    if (xaxistype) {\n      layout.xaxis = {\n        ...layout.xaxis,\n        xaxistype: xaxistype.toLowerCase(),\n      }\n    }\n\n    if (ytitle) {\n      layout.yaxis = {\n        title: ytitle,\n      }\n    }\n    // init plot_data\n    const orientation: string = isHorizontal ? 'h' : 'v'\n    const traces: any = []\n    if (\n      plotData.fileDownloads &&\n      plotData.fileDownloads.months &&\n      plotData.fileDownloads.months.length > 0\n    ) {\n      // add file downloads trace\n      traces.push(\n        this.getTrace(\n          'File Downloads',\n          plotData.fileDownloads.months,\n          orientation,\n          '#7CC0C4',\n        ),\n      )\n    }\n    if (\n      plotData.fileUploads &&\n      plotData.fileUploads.months &&\n      plotData.fileUploads.months.length > 0\n    ) {\n      // add file uploads trace\n      traces.push(\n        this.getTrace(\n          'File Uploads',\n          plotData.fileUploads.months,\n          orientation,\n          '#D4689A',\n        ),\n      )\n    }\n    if (traces.length > 0)\n      return (\n        <Plot\n          layout={layout}\n          data={traces}\n          config={config}\n          className=\"SRC-fullWidth\"\n          useResizeHandler={true}\n        />\n      )\n    else return <></>\n  }\n\n  public render() {\n    if (!this.state.isLoaded) {\n      return null\n    }\n    return this.showPlot()\n  }\n}\nexport default StatisticsPlot\n","import * as React from 'react'\nimport { SynapseVersion } from '../../lib/utils/synapseTypes/'\nimport { SynapseClient } from '../../lib/utils/'\nimport QueryWrapperMenu, {\n  MenuConfig,\n  QueryWrapperMenuProps,\n} from '../../lib/containers/QueryWrapperMenu'\nimport Uploader from '../../lib/containers/Uploader'\nimport FileContentDownloadUploadDemo from '../../lib/containers/FileContentDownloadUploadDemo'\nimport StatisticsPlot from 'lib/containers/StatisticsPlot'\nimport { testDownloadSpeed } from '../../lib/utils/functions/testDownloadSpeed'\nimport HasAccess from 'lib/containers/HasAccess'\n\ntype DemoState = {\n  token: string | null\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  tabOne: QueryWrapperMenuProps\n  tabTwo: QueryWrapperMenuProps\n  showTabOne: boolean\n  userFormDataSynId?: string\n  estimatedDownloadBytesPerSecond?: number\n}\n\ntype DemoProps = {\n  forceSamePage?: boolean\n}\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n\n */\nclass Demo extends React.Component<DemoProps, DemoState> {\n  entityFormRef: any\n  searchParamsProps: any\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: DemoProps) {\n    super(props)\n    this.entityFormRef = React.createRef()\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      token: '',\n      version: 0,\n      showTabOne: true,\n      tabOne: {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          enableLeftFacetFilter: true,\n        },\n        menuConfig: [\n          {\n            facet: 'dataStatus',\n            sql: 'SELECT studyStatus, dataStatus FROM syn16787123',\n          },\n          {\n            facet: 'projectStatus',\n            sql: 'SELECT * FROM syn16787123',\n          },\n          {\n            facet: 'name',\n            sql: 'SELECT name, grant FROM syn11346063',\n          },\n          {\n            facet: 'grant',\n            sql: 'SELECT name, grant FROM syn11346063 Group by grant',\n          },\n          {\n            facet: 'name',\n            sql:\n              'SELECT name, grant, sex, dataType, consortium FROM syn11346063 WHERE ( ( \"consortium\" = \\'AMP-AD\\') )',\n          },\n\n          {\n            facet: 'model',\n            sql: 'SELECT * FROM syn21498718',\n          },\n          {\n            facet: 'metadataType',\n            sql:\n              \"SELECT `id`, `metadataType`, `dataType`, `assay`  FROM syn11346063  WHERE ((`study` LIKE '%BroadAstrom109%') AND (`dataSubtype` = 'metadata'))\",\n          },\n        ],\n        rgbIndex: 2,\n      },\n      tabTwo: {\n        tableConfiguration: {\n          title: 'title',\n          showAccessColumn: true,\n        },\n        menuConfig: [\n          {\n            facet: 'assay',\n            sql: 'SELECT * FROM syn21156352',\n          },\n          {\n            facet: 'study',\n            sql:\n              'SELECT study, dataType, assay, id AS file_id, specimenID, individualID, diagnosis, sex, consortium as \"Program\", grant, species, organ, tissue, cellType, fileFormat FROM syn11346063',\n          },\n          {\n            facet: 'diagnosis',\n            sql:\n              'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          },\n          {\n            facet: 'individuals',\n            sql:\n              'SELECT diagnosis, sex, dataType, assay, count(distinct(id)) as \"Files\", count(distinct(specimenID)) as \"Specimens\", count(distinct(individualID)) as \"Individuals\" FROM syn11346063 GROUP BY 1,2,3,4 ORDER BY 1 DESC',\n          },\n        ] as MenuConfig[],\n        rgbIndex: 5,\n      },\n    }\n    this.getVersion = this.getVersion.bind(this)\n    this.onRunDownloadSpeedTest = this.onRunDownloadSpeedTest.bind(this)\n    this.searchParamsProps = {}\n    const searchParams = new URLSearchParams(window.location.search)\n    searchParams.forEach((value, key) => {\n      this.searchParamsProps[key] = value\n    })\n  }\n\n  public onSubmitEntityForm() {\n    this.entityFormRef.current.submitForm()\n  }\n\n  public onEntityFormSubmitted(synId: string) {\n    this.setState({ userFormDataSynId: synId })\n  }\n\n  public onRunDownloadSpeedTest() {\n    const { token } = this.state\n    if (token) {\n      testDownloadSpeed(token)\n        .then((estimatedDownloadBytesPerSecond: number) => {\n          this.setState({ estimatedDownloadBytesPerSecond })\n        })\n        .catch((error: any) => {\n          console.error('estimate download speed failed', error)\n        })\n    }\n  }\n\n  /**\n   * Get the current version of Synapse\n   */\n  public getVersion(): void {\n    // IMPORTANT: Your component should have a property (with default) to change the endpoint.  This is necessary for Synapse.org integration.\n    // Pass your endpoint through to the rpc call:\n    // SynapseClient.getVersion('https://repo-staging.prod.sagebase.org')\n    SynapseClient.getVersion()\n      .then((data: SynapseVersion) => this.setState({ version: data.version }))\n      .catch((error: any) => {\n        // Handle HTTPError.  Has status and message.\n        console.error('Get version failed', error)\n      })\n  }\n\n  public componentDidMount() {\n    // Note:  All portals should do this once on the initial app load.\n    // This looks for the session token cookie (HttpOnly, unable to directly access), and initialize the session if it does exists.\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then(sessionToken => {\n        this.setState({\n          token: sessionToken,\n        })\n      })\n      .catch((error: any) => {\n        console.error(error)\n      })\n    this.getVersion()\n  }\n  public render(): JSX.Element {\n    const { forceSamePage = false } = this.props\n    const { token, estimatedDownloadBytesPerSecond } = this.state\n    return (\n      <div>\n        <p className=\"App-intro text-center\">\n          Synapse production version: {this.state.version}\n        </p>\n        {token && (\n          <div className=\"container\">\n            <button\n              className=\"btn btn-default\"\n              onClick={this.onRunDownloadSpeedTest}\n            >\n              Run Download Speed Test\n            </button>\n            <hr />\n          </div>\n        )}\n        {estimatedDownloadBytesPerSecond && (\n          <div className=\"container\">\n            <h5>\n              Estimated Download Speed:{' '}\n              {(estimatedDownloadBytesPerSecond / 1000000).toFixed(2)} MBps\n            </h5>\n            <hr />\n          </div>\n        )}\n        {token && (\n          <div className=\"container\">\n            <h5>Upload File(s) Demo</h5>\n            <Uploader token={token} parentContainerId=\"syn18987891\" />\n            <hr />\n          </div>\n        )}\n        {token && (\n          <div className=\"container\">\n            <h5>Download File Content Demo (syn12196718)</h5>\n            <FileContentDownloadUploadDemo\n              token={token}\n              targetEntityId=\"syn12196718\"\n            />\n            <hr />\n          </div>\n        )}\n        {\n          <div className=\"container\">\n            <h5>Public Folder - HasAccess widget</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn7122428'}\n              isInDownloadList={false}\n              forceSamePage={forceSamePage}\n            />\n            <h5>A Controlled Access Folder - HasAccess widget</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn7383419'}\n              isInDownloadList={false}\n              forceSamePage={forceSamePage}\n            />\n            <h5>Open Data</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn5481758'}\n              isInDownloadList={false}\n              forceSamePage={forceSamePage}\n            />\n            <h5>Acces Requirements required Data</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn2426398'}\n              isInDownloadList={false}\n              forceSamePage={forceSamePage}\n            />\n            <h5>\n              Acces Requirements required Data without unsupported requirement\n            </h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn4993293'}\n              isInDownloadList={false}\n              forceSamePage={forceSamePage}\n            />\n\n            <hr />\n          </div>\n        }\n        {token && (\n          <div className=\"container\">\n            <h5>Project Statistics Demo</h5>\n            <StatisticsPlot\n              token={token}\n              request={{\n                concreteType:\n                  'org.sagebionetworks.repo.model.statistics.ProjectFilesStatisticsRequest',\n                objectId: 'syn2580853',\n                fileDownloads: true,\n                fileUploads: true,\n              }}\n            />\n            <StatisticsPlot\n              token={token}\n              request={{\n                concreteType:\n                  'org.sagebionetworks.repo.model.statistics.ProjectFilesStatisticsRequest',\n                objectId: 'syn5585645',\n                fileDownloads: true,\n                fileUploads: true,\n              }}\n            />\n            <hr />\n          </div>\n        )}\n        <div className=\"container\">\n          <button\n            className=\"btn btn-default\"\n            onClick={() => {\n              this.setState({ showTabOne: !this.state.showTabOne })\n            }}\n          >\n            toggle config for query wrapper menu\n          </button>\n          <QueryWrapperMenu\n            name={'Demo'}\n            token={\n              SynapseClient.IS_OUTSIDE_SYNAPSE_ORG ? token! : this.state.token!\n            }\n            unitDescription={\n              this.state.showTabOne\n                ? this.state.tabOne.unitDescription\n                : this.state.tabTwo.unitDescription\n            }\n            tableConfiguration={\n              this.state.showTabOne\n                ? this.state.tabOne.tableConfiguration\n                : this.state.tabTwo.tableConfiguration\n            }\n            menuConfig={\n              this.state.showTabOne\n                ? this.state.tabOne.menuConfig\n                : this.state.tabTwo.menuConfig\n            }\n            rgbIndex={\n              this.state.showTabOne\n                ? this.state.tabOne.rgbIndex\n                : this.state.tabTwo.rgbIndex\n            }\n            stackedBarChartConfiguration={{\n            }}\n            searchParams={{\n              facet: this.searchParamsProps['facet'],\n              facetValue: this.searchParamsProps['facetValue'],\n            }}\n          />\n        </div>\n      </div>\n    )\n  }\n}\nexport default Demo\n","import * as React from 'react'\nimport QueryWrapperMenu, {\n  MenuConfig,\n  QueryWrapperMenuProps,\n} from '../../../lib/containers/QueryWrapperMenu'\nimport { SynapseConstants } from '../../../lib/utils'\nimport { GenericCardSchema } from '../../../lib/containers/GenericCard'\n\ntype DemoState = {\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  tabOne: QueryWrapperMenuProps\n  tabTwo: QueryWrapperMenuProps\n  tabThree: QueryWrapperMenuProps\n  tabFour: QueryWrapperMenuProps\n  activeTab: number\n}\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nclass QueryWrapperMenuDemo extends React.Component<\n  { rgbIndex: number; token: string | undefined },\n  DemoState\n> {\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    const experimentalSql =\n      \"SELECT * FROM syn20337467 WHERE toolType = 'experimental' LIMIT 100\"\n    const computationalSql =\n      \"SELECT * FROM syn20337467 WHERE toolType = 'computational' LIMIT 100\"\n    const genericCardSchema: GenericCardSchema = {\n      title: 'Title',\n      type: 'Generic Tool',\n      subTitle: 'softwareType',\n      description: 'summary',\n      icon: 'icon',\n      secondaryLabels: ['contributor', 'diagnosis', 'program'],\n    }\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      activeTab: 2,\n      tabFour: {\n        stackedBarChartConfiguration: {},\n        unitDescription: 'apples',\n        tableConfiguration: {\n          title: 'title',\n          // markdownColumns: ['fruit', 'vegetable'],\n        },\n        menuConfig: [\n          {\n            facet: 'fruit',\n            sql: 'select * from syn21085100',\n          },\n        ],\n        rgbIndex: 3,\n      },\n      tabThree: {\n        stackedBarChartConfiguration: {},\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          showAccessColumn: true,\n        },\n        searchConfiguration: {\n          searchable: [\n            {\n              columnName: 'study',\n              hintText: 'study name',\n            },\n          ],\n        },\n        menuConfig: [\n          {\n            facet: 'resourceType',\n            sql: 'SELECT id, name, resourceType FROM syn11346063 LIMIT 1',\n          },\n          {\n            facet: 'study',\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n          {\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n        ] as MenuConfig[],\n        rgbIndex: 5,\n      },\n      tabTwo: {\n        name: 'Demo',\n        unitDescription: 'persons',\n        cardConfiguration: {\n          genericCardSchema,\n          type: SynapseConstants.MEDIUM_USER_CARD,          \n        },\n        rgbIndex: 1,\n        facetAliases: {\n          grant: 'Grant',\n        },\n        accordionConfig: [\n          {\n            name: 'Compuational',\n            cardConfiguration: {\n              genericCardSchema,\n              type: SynapseConstants.GENERIC_CARD,              \n            },\n            menuConfig: [\n              {\n                facet: 'grant',\n                sql: computationalSql,\n              },\n              {\n                facet: 'diagnosis',\n                sql: computationalSql,\n              },\n              {\n                facet: 'modelType',\n                sql: computationalSql,\n              },\n            ],\n          },\n          {\n            name: 'Experimental',\n            cardConfiguration: {\n              genericCardSchema,\n              type: SynapseConstants.GENERIC_CARD,              \n            },\n            menuConfig: [\n              {\n                facet: 'program',\n                sql: experimentalSql,\n              },\n              {\n                facet: 'reagentType',\n                sql: experimentalSql,\n              },\n              {\n                facet: 'softwareType',\n                sql: experimentalSql,\n              },\n            ],\n          },\n        ],\n      },\n      tabOne: {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n        },\n        searchConfiguration: {\n          searchable: [\n            {\n              columnName: 'study',\n              hintText: 'study name',\n            },\n          ],\n        },\n        menuConfig: [\n          {\n            facet: 'diagnosis',\n            sql:\n              'SELECT study, assay, count(distinct id) AS files, concat(organ) AS organs' +\n              \" FROM syn17024112 WHERE species='Human' AND assay='rnaSeq' group by 1,2 order by 3 desc limit 1000\",\n          },\n          {\n            facet: 'PORTALS-712',\n            sql:\n              'SELECT dataType, assay, fileFormat, COUNT(distinct id) AS Files ' +\n              \"FROM syn11346063 WHERE (study LIKE '%MODEL-AD_5XFAD%') GROUP BY 1, 2, 3 ORDER BY 4 DESC\",\n          },\n          {\n            facet: 'PORTALS-803',\n            sql:\n              'SELECT diagnosis AS \"Diagnosis\", sex as \"Sex\", dataType as \"Data Type\", assay as \"Assay\", count(distinct(id)) as \"Files\", count(distinct(specimenID)) as \"Specimens\", count(distinct(individualID)) as \"Individuals\" FROM syn11346063 GROUP BY 1,2,3,4 ORDER BY 1 DESC',\n          },\n          {\n            facet: 'study',\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n          // {\n          //   facet: 'dataType',\n          //   sql: 'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          //   synapseId: 'syn16858331',\n          //   title: 'title',\n          //   unitDescription: 'descriptive unit'\n          // },\n        ] as MenuConfig[],\n        rgbIndex: 5,\n      },\n      version: 0,\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.removeHandler = this.removeHandler.bind(this)\n  }\n\n  /**\n   * Update internal state\n   * @param {Object} updatedState new state to be updated by the component\n   */\n  public handleChange(updatedState: {}): void {\n    this.setState(updatedState)\n  }\n\n  public removeHandler(): void {\n    this.setState({ showMarkdown: !this.state.showMarkdown })\n  }\n\n  public render(): JSX.Element {\n    const { activeTab } = this.state\n    let props: QueryWrapperMenuProps = {} as QueryWrapperMenuProps\n    if (activeTab === 0) {\n      props = this.state.tabOne\n    } else if (activeTab === 1) {\n      props = this.state.tabTwo\n    } else if (activeTab === 2) {\n      props = this.state.tabThree\n    } else {\n      props = this.state.tabFour\n    }\n    return (\n      <div className=\"container\">\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 0 })\n          }}\n        >\n          With Group By\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 1 })\n          }}\n        >\n          With Tools\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 2 })\n          }}\n        >\n          Standard\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 3 })\n          }}\n        >\n          Table with markdown\n        </button>\n        <h2>Demo of table</h2>\n        <QueryWrapperMenu token={this.props.token} {...props} />\n      </div>\n    )\n  }\n}\nexport default QueryWrapperMenuDemo\n","import * as React from 'react'\nimport CardContainerLogic, {\n  CardConfiguration,\n} from '../../../lib/containers/CardContainerLogic'\nimport { SynapseConstants } from '../../../lib'\nimport brainSvg from './icons/brain.svg'\nimport circleSvg from './icons/circle.svg'\nimport mouseSvg from './icons/mouse.svg'\nimport resilienceadSvg from './icons/resiliencead.svg'\n\ntype State = {\n  tabIndex: Number\n}\nexport const iconOptions = {\n  'AMP-AD': circleSvg,\n  'M2OVE-AD': brainSvg,\n  'MODEL-AD': mouseSvg,\n  'Resilience-AD': resilienceadSvg,\n}\n\nexport default class CardContainerLogicDemo extends React.Component<{}, State> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      tabIndex: 2,\n    }\n  }\n\n  render() {\n    const { tabIndex } = this.state\n    \n    const genericCardSchema: CardConfiguration = {\n      type: SynapseConstants.GENERIC_CARD,\n      genericCardSchema: {\n        type: SynapseConstants.DATASET,\n        title: 'portalDisplayName',\n        subTitle: 'centerName',\n        description: 'summary',\n        secondaryLabels: ['externalLink'],\n      },\n      labelLinkConfig: [\n        {\n          isMarkdown: true,\n          matchColumnName: 'externalLink',\n        },\n      ],\n    }\n    return (\n      <div>\n        <hr />\n        <p> Generic Card Rendering </p>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.setState({ tabIndex: 0 })}\n        >\n          Header Card\n        </button>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.setState({ tabIndex: 1 })}\n        >\n          People Card\n        </button>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.setState({ tabIndex: 2 })}\n        >\n          Other Card\n        </button>\n        <div style={{ height: 50 }} />\n        {tabIndex === 0 && (\n          <CardContainerLogic\n            type={SynapseConstants.GENERIC_CARD}\n            sql={'SELECT * FROM syn17024173'}\n            searchParams={{ Program: 'AMP-AD' }}\n            genericCardSchema={{\n              type: 'Program',\n              title: 'Full Name',\n              subTitle: 'Short Description',\n              icon: 'Program',\n            }}\n            backgroundColor={'#5960a5'}\n            isHeader={true}\n            iconOptions={iconOptions}\n          />\n        )}\n        {tabIndex === 1 && (\n          <CardContainerLogic\n            type={SynapseConstants.MEDIUM_USER_CARD}\n            sql={'SELECT ownerID as ownerId FROM syn13897207'}            \n          />\n        )}\n        {tabIndex === 2 && (\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-md-10 col-md-offset-1\">\n                <CardContainerLogic\n                  sql={'SELECT * FROM syn18488466 group by externalLink'}\n                  unitDescription=\"studies\"\n                  {...genericCardSchema}\n                  secondaryLabelLimit={3}\n                />\n              </div>\n            </div>\n          </div>\n        )}\n        <div style={{ height: 50 }} />\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport QueryWrapper from 'lib/containers/QueryWrapper'\nimport Search, { Searchable } from 'lib/containers/Search'\nimport { SynapseConstants } from 'lib'\nimport { GenericCardSchema } from 'lib/containers/GenericCard'\nimport { CardConfiguration } from 'lib/containers/CardContainerLogic'\nimport CardContainer from 'lib/containers/CardContainer'\n\nexport const SearchDemo: React.SFC = () => {\n  const sql = 'SELECT * FROM syn20337467'\n  const facetAliases = {\n    contributor: 'Contributor',\n    diagnosis: 'Diagnosis',\n  }\n  const searchable: Searchable = [\n    {\n      columnName: 'summary',\n      hintText: 'summary',\n    },\n    {\n      columnName: 'contributor',\n      hintText: 'Jane',\n    },\n    {\n      columnName: 'diagnosis',\n      hintText: 'LOAD',\n    },\n    {\n      columnName: 'modelType',\n      hintText: 'hint',\n    },\n  ]\n  const genericCardSchema: GenericCardSchema = {\n    title: 'Title',\n    type: 'Generic Tool',\n    subTitle: 'softwareType',\n    description: 'summary',\n    icon: 'icon',\n    secondaryLabels: ['contributor', 'diagnosis', 'program'],\n  }\n  const cardConfiguration: CardConfiguration = {\n    type: SynapseConstants.GENERIC_CARD,\n    genericCardSchema,\n  }\n  return (\n    <div className=\"col-xs-8 col-xs-offset-2\">\n      <QueryWrapper\n        facetAliases={facetAliases}\n        rgbIndex={5}\n        initQueryRequest={{\n          entityId: 'syn20337467',\n          concreteType:\n            'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n          partMask:\n            SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n            SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n            SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n            SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n            SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n          query: {\n            sql,\n            limit: 25,\n            offset: 0,\n          },\n        }}\n        showBarChart={false}\n        unitDescription={'studies'}\n      >\n        <Search searchable={searchable} isQueryWrapperMenuChild={false} />\n        <CardContainer {...cardConfiguration} />\n      </QueryWrapper>\n    </div>\n  )\n}\n\nexport default SearchDemo\n","import * as React from 'react'\nimport ModalDownload from '../../../lib/containers/ModalDownload'\n\ntype State = {\n  showModal: boolean\n}\n\nclass ModalDownloadDemo extends React.Component<{}, State> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      showModal: false,\n    }\n  }\n\n  onClose = () => {\n    this.setState({\n      showModal: false,\n    })\n  }\n\n  onOpen = () => {\n    console.log('opening')\n    this.setState({\n      showModal: true,\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <button onClick={this.onOpen} className=\"btn btn-primary\">\n          {' '}\n          Show ModalDownload{' '}\n        </button>\n        {this.state.showModal && (\n          <ModalDownload\n            queryBundleRequest={{\n              concreteType:\n                'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n              entityId: '',\n              // @ts-ignore\n              partMask: undefined,\n              query: {\n                sql: 'SELECT * from syn17328596',\n              },\n            }}\n            onClose={this.onClose}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default ModalDownloadDemo\n","import * as React from 'react'\nimport UserCard from '../../../lib/containers/UserCard'\nimport { SynapseConstants } from '../../../lib'\nimport MarkdownSynapse from '../../../lib/containers/MarkdownSynapse'\n\nexport default class UserBadgeSmallDemo extends React.Component<any, any> {\n  constructor(props: any) {\n    super(props)\n  }\n  public render() {\n    const profiles = [\n      '3376985',\n      '1131050',\n      '273960',\n      '3346401',\n      '3374422',\n      '273950',\n      '273950',\n    ]\n    return (\n      <React.Fragment>\n        <div className=\"container\">\n          <div className=\"row\">\n            <h3>User Card Small </h3>\n            <p> sans photo- </p>\n            <UserCard\n              ownerId={'273950'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <p> without text </p>\n            <UserCard\n              ownerId={'3374422'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <hr />\n            <p> with custom link- </p>\n            <UserCard\n              ownerId={'273950'}\n              size={SynapseConstants.SMALL_USER_CARD}\n              link={'https://google.com'}\n            />\n            <UserCard\n              ownerId={'3374422'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n              link={'https://google.com'}\n            />\n            <hr />\n            <p> without tooltip </p>\n            <div className=\"SRC-centerContent\">\n              <UserCard\n                ownerId={'3374422'}\n                hideTooltip={true}\n                size={SynapseConstants.SMALL_USER_CARD}\n              />\n              <UserCard\n                ownerId={'3346401'}\n                hideTooltip={true}\n                size={SynapseConstants.SMALL_USER_CARD}\n              />\n            </div>\n            <hr />\n            <p> with photo- </p>\n            <UserCard\n              ownerId={'3346401'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <UserCard\n              ownerId={'1131050'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <p> without text- </p>\n            <UserCard\n              ownerId={'273960'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <hr />\n            <p>inside of markdown-</p>\n            <MarkdownSynapse wikiId={'588827'} ownerId={'syn18380882'} />\n          </div>\n          <div className=\"row\">\n            <h3> User Card Large </h3>\n            <p> with photo- </p>\n            <UserCard\n              ownerId={'1131050'}\n              // tslint:disable-next-line:jsx-no-lambda\n              size={SynapseConstants.LARGE_USER_CARD}\n              menuActions={[\n                {\n                  field: 'Projects',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'Profile',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'SEPERATOR',\n                },\n                {\n                  field: 'Teams',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n              ]}\n            />\n            <br />\n            <p> sans photo- </p>\n            <br />\n            <UserCard\n              ownerId={'3374422'}\n              isCertified={true}\n              size={SynapseConstants.LARGE_USER_CARD}\n            />\n            <br />\n            <br />\n            <UserCard\n              ownerId={'345424'}\n              isValidated={true}\n              size={SynapseConstants.LARGE_USER_CARD}\n              menuActions={[\n                {\n                  field: 'Projects',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'Profile',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'SEPERATOR',\n                },\n                {\n                  field: 'Teams',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n              ]}\n            />\n          </div>\n        </div>\n        <h3> User Card Medium Wrapping Example </h3>\n        <div className=\"SRC-card-grid-row\">\n          {[1, 2, 3, 4, 5].map((_el, index) => {\n            return (\n              <div className=\"SRC-grid-item\" key={index}>\n                <UserCard\n                  hideEmail={index % 2 === 0}\n                  menuActions={[\n                    {\n                      field: 'Projects',\n                      callback: userProfile => {\n                        console.log(userProfile)\n                      },\n                    },\n                    {\n                      field: 'Profile',\n                      callback: userProfile => {\n                        console.log(userProfile)\n                      },\n                    },\n                    {\n                      field: 'SEPERATOR',\n                    },\n                    {\n                      field: 'Teams',\n                      callback: userProfile => {\n                        console.log(userProfile)\n                      },\n                    },\n                  ]}\n                  ownerId={profiles[index]}\n                  size={SynapseConstants.MEDIUM_USER_CARD}\n                  link={index % 2 ? 'https://google.com' : ''}\n                />\n              </div>\n            )\n          })}\n        </div>\n      </React.Fragment>\n    )\n  }\n}\n","import * as React from 'react'\nimport MarkdownSynapse, {\n  MarkdownSynapseProps,\n} from '../../../lib/containers/MarkdownSynapse'\n\ntype State = {\n  index: number\n  markdownPropsArray: MarkdownSynapseProps[]\n}\n\nexport default class MarkdownSynapseDemo extends React.Component<\n  { token?: string },\n  State\n> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      index: 3,\n      markdownPropsArray: [\n        {\n          // footnotes with html\n          ownerId: 'syn18380882',\n          wikiId: '588827',\n        },\n        {\n          // with details tag\n          ownerId: 'syn12666371',\n          wikiId: '585317',\n        },\n        {\n          //  with references\n          ownerId: 'syn17100797',\n          wikiId: '587923',\n        },\n        {\n          // with bookmark\n          ownerId: 'syn21097753',\n          wikiId: '597236',\n        },\n        {\n          // lego man\n          ownerId: 'syn18142975',\n        },\n        {\n          // nested link\n          ownerId: 'syn12666371',\n          wikiId: '595383',\n        },\n        {\n          // video\n          ownerId: 'syn21714219',\n          token: this.props.token,\n          // ownerId: 'syn4993293',\n          // wikiId: '247859',\n        },\n      ],\n    }\n  }\n  render() {\n    const { index, markdownPropsArray } = this.state\n    const props = markdownPropsArray[index]\n    return (\n      <div className=\"container\">\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 0 })\n          }}\n        >\n          Footnotes with html\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 1 })\n          }}\n        >\n          Details tag\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 2 })\n          }}\n        >\n          References\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 3 })\n          }}\n        >\n          Table of Contents\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 4 })\n          }}\n        >\n          Lego Man\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 5 })\n          }}\n        >\n          Show nested anchor\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 6 })\n          }}\n        >\n          Video\n        </button>\n        {/* footnotes with html */}\n        <MarkdownSynapse token={this.props.token} {...props} />\n      </div>\n    )\n  }\n}\n","import React from 'react'\nimport ShowDownload from '../../../lib/containers/download_list/ShowDownload'\n\nconst ShowDownloadDemo = ({ token }: { token: string | undefined }) => {\n  if (!token) {\n    return <p> You need to sign in to for ShowDownload to render </p>\n  }\n  return (\n    <div>\n      <ShowDownload token={token} />\n    </div>\n  )\n}\nexport default ShowDownloadDemo\n","import * as React from 'react'\nimport RssFeedCards from '../../../lib/containers/RssFeedCards'\n\nexport const NewsFeedDemo:React.SFC = () => {\n  // in the portal, search params should be filled in based on URL query parameters.\n  return (\n    <RssFeedCards\n      // url='http://padknowdev.wpengine.com/?feed=rss2'\n      url='https://portalnewsdev.wpengine.com/?feed=rss2'\n      itemsToShow={3}\n      allowCategories={['Data Release', 'News', 'Webinar','rosMAP']}\n      mailChimpListName='AMP-AD quarterly newsletter'\n      mailChimpUrl='https://sagebase.us7.list-manage.com/subscribe/post?u=b146de537186191a9d2110f3a&amp;id=96b614587a'\n    />\n  )\n}\n\n\n","import React from 'react' // importing FunctionComponent\nimport RssFeed from './RssFeed'\n\nexport type SingleNewsFeedPostProps = {\n  feedUrl: string \n}\n\nexport default function SingleNewsFeedPost(props: SingleNewsFeedPostProps) {\n  const {feedUrl} = props\n  let updatedModifiedFeedUrl = feedUrl\n  const urlParams = new URLSearchParams(window.location.search)\n  if (urlParams) {\n    urlParams.forEach((value, key) => {\n      updatedModifiedFeedUrl = `${updatedModifiedFeedUrl}&${key}=${value}`\n    })\n  }\n  return (\n      <>\n        {updatedModifiedFeedUrl && (\n          <RssFeed\n            key={updatedModifiedFeedUrl}\n            url={updatedModifiedFeedUrl}\n            defaultItemsToShow={1}\n            showMoreElements={false}\n          />\n        )}\n      </>\n  )\n}\n","import * as React from 'react'\nimport SingleNewsFeedPost from '../../../lib/containers/SingleNewsFeedPost'\n\nexport const SingleNewsFeedPostDemo:React.SFC = () => {\n  // in the portal, search params will be filled in based on URL query parameters.\n  // in the demo app, we'll send you to a target post by supplying a tag in the url params \n  //  (but it would recognize any param supported by WordPress rss2 feeds)\n  // For example: /Playground/SingleNewsFeedPostDemo?tag=centenarians\n  return (\n    <SingleNewsFeedPost\n      feedUrl='https://portalnews.wpengine.com/?feed=rss2'\n    />\n  )\n}\n\n","import { SynapseClient } from 'lib'\nimport {\n  FileUploadComplete,\n  FormData,\n  FormGroup,\n  ListRequest,\n  ListResponse,\n  StatusEnum,\n} from 'lib/utils/synapseTypes/'\nimport * as React from 'react'\nimport { TokenContext } from '../App'\n\ntype FormServicesIntegrationDemoState = {\n  token?: string\n  formGroup?: FormGroup\n  formData?: FormData\n  myFormDataList?: ListResponse\n  formAdminFormDataList?: ListResponse\n}\n\nclass FormServicesIntegrationDemo extends React.Component<\n  {},\n  FormServicesIntegrationDemoState\n> {\n  constructor(props: any) {\n    super(props)\n    this.state = {}\n    this.onCreateFormGroup = this.onCreateFormGroup.bind(this)\n    this.onCreateFormData = this.onCreateFormData.bind(this)\n    this.onUpdateFormData = this.onUpdateFormData.bind(this)\n    this.onSubmitFormData = this.onSubmitFormData.bind(this)\n    this.listMyFormData = this.listMyFormData.bind(this)\n    this.listFormAdminFormData = this.listFormAdminFormData.bind(this)\n    this.onReadFormDataFileHandleContents = this.onReadFormDataFileHandleContents.bind(\n      this,\n    )\n  }\n\n  public onCreateFormGroup(): void {\n    SynapseClient.createFormGroup(\n      'AAMP-ADExternalContribution(production)',\n      this.state.token!,\n    )\n      .then((data: FormGroup) => {\n        console.log('Successfully created FormGroup', data)\n        this.setState({ formGroup: data })\n      })\n      .catch((error: any) =>\n        console.error('Failed to create form group', error),\n      )\n  }\n  public onUpdateFormData(): void {\n    SynapseClient.uploadFile(\n      this.state.token,\n      'my test file',\n      new Blob(['hello form data 2']),\n    )\n      .then((fileUploadComplete: FileUploadComplete) => {\n        console.log(\n          'Successfully created test file handle, now update the form data!',\n        )\n        SynapseClient.updateFormData(\n          this.state.formData!.formDataId!,\n          'my test form data',\n          fileUploadComplete.fileHandleId,\n          this.state.token!,\n        )\n          .then((data: FormData) => {\n            console.log('Successfully updated FormData', data)\n            this.setState({ formData: data })\n          })\n          .catch((error: any) =>\n            console.error('Failed to update FormData', error),\n          )\n      })\n      .catch((error: any) =>\n        console.error('Failed to update a new file handle:', error),\n      )\n  }\n\n  public onCreateFormData(): void {\n    SynapseClient.uploadFile(\n      this.state.token,\n      'my test file',\n      new Blob(['hello form data']),\n    )\n      .then((fileUploadComplete: FileUploadComplete) => {\n        console.log(\n          'Successfully created test file handle, now create the form data!',\n        )\n        SynapseClient.createFormData(\n          this.state.formGroup!.groupId!,\n          'my test form data',\n          fileUploadComplete.fileHandleId,\n          this.state.token!,\n        )\n          .then((data: FormData) => {\n            console.log('Successfully created FormData', data)\n            this.setState({ formData: data })\n          })\n          .catch((error: any) =>\n            console.error('Failed to create FormData', error),\n          )\n      })\n      .catch((error: any) =>\n        console.error('Failed to create a new file handle:', error),\n      )\n  }\n\n  public onSubmitFormData(): void {\n    SynapseClient.submitFormData(\n      this.state.formData!.formDataId!,\n      this.state.token!,\n    )\n      .then((data: FormData) => {\n        console.log('Successfully submitted FormData', data)\n      })\n      .catch((error: any) => console.error('Failed to submit form data', error))\n  }\n\n  private listMyFormData = () => {\n    if (\n      this.state.token &&\n      this.state.formGroup &&\n      !this.state.myFormDataList\n    ) {\n      let request: ListRequest = {\n        groupId: this.state.formGroup.groupId!,\n        filterByState: [\n          StatusEnum.ACCEPTED,\n          StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n          StatusEnum.WAITING_FOR_SUBMISSION,\n        ],\n      }\n      SynapseClient.listFormData(request, this.state.token)\n        .then((resp: ListResponse) => {\n          console.log('Successfully got a my FormData list', resp)\n          this.setState({ myFormDataList: resp })\n        })\n        .catch((error: any) =>\n          console.error('Failed to get my FormData list', error),\n        )\n    }\n  }\n\n  private listFormAdminFormData = () => {\n    if (\n      this.state.token &&\n      this.state.formGroup &&\n      !this.state.formAdminFormDataList\n    ) {\n      let request: ListRequest = {\n        groupId: this.state.formGroup.groupId!,\n        filterByState: [\n          StatusEnum.ACCEPTED,\n          StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n        ],\n      }\n      SynapseClient.listFormDataAsFormAdmin(request, this.state.token)\n        .then((resp: ListResponse) => {\n          console.log('Successfully got FormGroup admin list', resp)\n          this.setState({ formAdminFormDataList: resp })\n        })\n        .catch((error: any) =>\n          console.error('Failed to get FormGroup admin FormData list', error),\n        )\n    }\n  }\n\n  private onReadFormDataFileHandleContents = () => {\n    SynapseClient.getFileHandleContentFromID(\n      this.state.formData!.dataFileHandleId,\n      this.state.token!,\n    )\n      .then((data: string) => {\n        console.log('Successfully fetched file handle contents: ', data)\n      })\n      .catch((error: any) =>\n        console.error('Failed to read form data file handle contents', error),\n      )\n  }\n\n  public componentDidUpdate() {\n    this.listMyFormData()\n    this.listFormAdminFormData()\n  }\n\n  render() {\n    return (\n      <TokenContext.Consumer>\n        {(token: string) => {\n          if (token !== this.state.token) {\n            this.setState({\n              token,\n            })\n          }\n          if (token) {\n            return (\n              <>\n                <div>\n                  <a onClick={this.onCreateFormGroup}>\n                    Create Form Group\n                    <br />\n                  </a>\n                  {!this.state.formData && (\n                    <a onClick={this.onCreateFormData}>\n                      Create Form Data\n                      <br />\n                    </a>\n                  )}\n                  {this.state.formData && (\n                    <a onClick={this.onReadFormDataFileHandleContents}>\n                      Get Form Data FileHandle contents\n                      <br />\n                    </a>\n                  )}\n\n                  {this.state.formData && (\n                    <a onClick={this.onUpdateFormData}>\n                      Update Form Data\n                      <br />\n                    </a>\n                  )}\n                  {this.state.formData && (\n                    <a onClick={this.onSubmitFormData}>\n                      Submit Form Data\n                      <br />\n                    </a>\n                  )}\n                </div>\n                {<h3>My FormData</h3>}\n                {this.state.myFormDataList && (\n                  <table>\n                    <thead>\n                      <tr>\n                        <th>Form Data name</th>\n                        <th>Data File Handle ID</th>\n                        <th>Status</th>\n                        <th>Rejection Reason</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {this.state.myFormDataList.page.map(value => {\n                        return (\n                          <tr key={value.formDataId}>\n                            <td>{value.name}</td>\n                            <td>{value.dataFileHandleId}</td>\n                            <td>{value.submissionStatus.state}</td>\n                            <td>{value.submissionStatus.rejectionMessage}</td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                )}\n                {<h3>FormGroup Admin FormData</h3>}\n                {this.state.formAdminFormDataList && (\n                  <table>\n                    <thead>\n                      <tr>\n                        <th>Form Data name</th>\n                        <th>Data File Handle ID</th>\n                        <th>Status</th>\n                        <th>Rejection Reason</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {this.state.formAdminFormDataList.page.map(value => {\n                        return (\n                          <tr key={value.formDataId}>\n                            <td>{value.name}</td>\n                            <td>{value.dataFileHandleId}</td>\n                            <td>{value.submissionStatus.state}</td>\n                            <td>{value.submissionStatus.rejectionMessage}</td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                )}\n              </>\n            )\n          } else\n            return (\n              <>\n                <p>Please log in and reload this route</p>\n              </>\n            )\n        }}\n      </TokenContext.Consumer>\n    )\n  }\n}\n\nexport default FormServicesIntegrationDemo\n","import * as React from 'react'\nimport QueryWrapperPlotNav, {\n  QueryWrapperPlotNavProps,\n} from '../../../lib/containers/query_wrapper_plot_nav/QueryWrapperPlotNav'\nimport { SynapseConstants, SynapseClient } from '../../../lib'\nimport {\n  TableUpdateTransactionRequest,\n  PartialRow,\n} from '../../../lib/utils/synapseTypes/Table/TableUpdate'\nimport { Row } from '../../../lib/utils/synapseTypes'\n\ntype DemoState = {\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  propsWithTable: QueryWrapperPlotNavProps\n  propsWithCards: QueryWrapperPlotNavProps\n  propsWithCustomCommands: QueryWrapperPlotNavProps\n  showCards: boolean\n}\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nclass QueryWrapperPlotNavDemo extends React.Component<\n  { token: string },\n  DemoState\n> {\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    const sql: string = 'SELECT assay, id FROM syn11346063 limit 1000'\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      showCards: false,\n      propsWithTable: {\n        tableConfiguration: {\n          showAccessColumn: true,\n          columnLinks: [\n            {\n              matchColumnName: 'study',\n              isMarkdown: false,\n              baseURL: 'Explore/Studies/DetailsPage',\n              URLColumnName: 'Study_Name',\n              wrapValueWithParens: true,\n            },\n          ],\n        },\n        searchConfiguration: {\n          searchable: ['assay','name','consortium'],\n        },\n        visibleColumnCount: 10,\n        facetsToPlot: ['assay'],\n        rgbIndex: 1,\n        name: 'PlotNav Demo',\n        sqlOperator: '=',\n        sql,\n        // facetsToPlot: ['assay', 'dataType'],\n      },\n      propsWithCards: {\n        rgbIndex: 1,\n        name: 'PlotNav Demo',\n        sqlOperator: '=',\n        sql,\n        cardConfiguration: {\n          type: SynapseConstants.GENERIC_CARD,\n          genericCardSchema: {\n            title: 'id',\n            type: SynapseConstants.STUDY,\n          },\n        },\n      },\n      propsWithCustomCommands: {\n        tableConfiguration: {\n          isRowSelectionVisible: true,\n        },\n        visibleColumnCount: 10,\n        facetsToPlot: ['Ethnicity', 'Sex'],\n        rgbIndex: 1,\n        name: 'PlotNav Demo',\n        sqlOperator: '=',\n        sql: 'select * from syn22084217',\n        customControls: [\n          {\n            buttonText: 'Update WorkflowState',\n            classNames: 'exampleClassNameToAddToButton',\n            onClick: event => {\n              // Demo custom control updates all values in a particular column for the selected rows (CRC)\n              // test Updating a Synapse Table for the first time from SRC, by updating the WorkflowState column value\n              const entityId: string = event.data?.queryResult.queryResults\n                .tableId!\n              // find target column\n              const targetColumn = event.data?.columnModels!.find(\n                cm => cm.name === 'WorkflowState',\n              )\n              // collect all selected rows (create PartialRow objects)\n              const rowUpdates: PartialRow[] = []\n              const rows: Row[] = event.data?.queryResult.queryResults!.rows!\n              for (\n                let index = 0;\n                index < event.selectedRowIndices!.length;\n                index++\n              ) {\n                rowUpdates.push({\n                  rowId: rows[event.selectedRowIndices![index]].rowId,\n                  values: [\n                    {\n                      key: targetColumn?.id!,\n                      value: 'Selected',\n                    },\n                  ],\n                })\n              }\n\n              const request: TableUpdateTransactionRequest = {\n                concreteType:\n                  'org.sagebionetworks.repo.model.table.TableUpdateTransactionRequest',\n                entityId,\n                changes: [\n                  {\n                    concreteType:\n                      'org.sagebionetworks.repo.model.table.AppendableRowSetRequest',\n                    entityId,\n                    toAppend: {\n                      concreteType:\n                        'org.sagebionetworks.repo.model.table.PartialRowSet',\n                      tableId: entityId,\n                      rows: rowUpdates,\n                    },\n                  },\n                ],\n              }\n              SynapseClient.updateTable(request, props.token).then(() => {\n                console.log('updated!')\n                // refresh data after successful update\n                event.refresh()\n              })\n            },\n          },\n        ],\n      },\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.removeHandler = this.removeHandler.bind(this)\n  }\n\n  /**\n   * Update internal state\n   * @param {Object} updatedState new state to be updated by the component\n   */\n  public handleChange(updatedState: {}): void {\n    this.setState(updatedState)\n  }\n\n  public removeHandler(): void {\n    this.setState({ showMarkdown: !this.state.showMarkdown })\n  }\n\n  componentDidMount() {\n    const log = (ev: any) => {\n      if (ev.target instanceof HTMLButtonElement) {\n        const buttonElement = ev.target as HTMLButtonElement\n        if (\n          buttonElement.classList.contains(SynapseConstants.SRC_SIGN_IN_CLASS)\n        ) {\n          console.log('testing sign in button event captured')\n        }\n      }\n    }\n    window.document.addEventListener('click', log)\n  }\n\n  public render(): JSX.Element {\n    const { showCards } = this.state\n    const propsForPlotNav = this.state.showCards\n      ? this.state.propsWithCards\n      : this.state.propsWithTable\n    return (\n      <div className=\"container\">\n        <h2>Demo of plot nav table</h2>\n        <button\n          className=\"SRC-primary-background-color\"\n          style={{ color: 'white', padding: 10 }}\n          onClick={() => this.setState({ showCards: !showCards })}\n        >\n          Switch to table/cards\n        </button>\n        <QueryWrapperPlotNav token={this.props.token} {...propsForPlotNav} />\n        <hr></hr>\n        {/* <h3>Now with custom commands</h3> */}\n        {/* <QueryWrapperPlotNav\n          token={this.props.token}\n          {...this.state.propsWithCustomCommands}\n        /> */}\n      </div>\n    )\n  }\n}\nexport default QueryWrapperPlotNavDemo\n","import * as React from 'react'\nimport { Checkbox } from '../../../lib/containers/widgets/Checkbox'\nimport { RadioGroup } from '../../../lib/containers/widgets/RadioGroup'\nimport ThemesPlot from '../../../lib/containers/widgets/themes-plot/ThemesPlot'\nimport {\n  PlotProps,\n  ClickCallbackParams,\n} from '../../../lib/containers/widgets/themes-plot/types'\nimport { Range, RangeValues } from '../../../lib/containers/widgets/Range'\nimport { RangeSlider } from '../../../lib/containers/widgets/RangeSlider'\nimport { useState } from 'react'\n\ntype WigetDemoPros = {\n  token: string\n}\n\nexport const WidgetDemo: React.FunctionComponent<WigetDemoPros> = (\n  props: WigetDemoPros,\n) => {\n  const options = [\n    { label: 'option 1', value: 'option1' },\n    { label: 'option 2', value: 'option2' },\n    { label: 'option 3', value: 'option3' },\n  ]\n  const [check1, setCheck1] = useState(true)\n  const [check2, setCheck2] = useState(false)\n  const [optionValue, setOptionValue] = useState('option2')\n  const [rangeNumberValue, setRangeNumberValue] = useState(() => {\n    const result: RangeValues = {\n      min: '10.5',\n      max: '30',\n    }\n    return result\n  })\n  const [rangeDateValue, setRangeDateValue] = useState(() => {\n    const result: RangeValues = {\n      min: new Date(2019, 5, 10).toISOString(),\n      max: new Date(2019, 6, 11).toISOString(),\n    }\n    return result\n  })\n\n  const [rangeSliderValue, setRangeSliderValue] = useState({\n    min: '10',\n    max: '25',\n  })\n\n  const topBarPlotProps: PlotProps = {\n    entityId: 'syn21641485',\n    xField: 'totalCount',\n    yField: 'groupBy',\n    groupField: 'consortium',\n    whereClause: 'totalCount is not NULL',\n    colors: {\n      CSBC: 'rgba(64,123,160, 1)',\n      'PS-ON': 'rgba(91,176,181,1)',\n    },\n  }\n\n  const sideBarPlotProps: PlotProps = {\n    entityId: 'syn21649281',\n    xField: 'totalCount',\n    yField: 'theme',\n    groupField: 'consortium',\n    countLabel: 'projects',\n    plotStyle: {\n      backgroundColor: '#f5f9fa',\n    },\n    colors: {\n      CSBC: '#4788A5',\n      'PS-ON': '#5bb0b5',\n    },\n  }\n\n  const dotPlotProps: PlotProps = {\n    entityId: 'syn21639584',\n    xField: 'totalCount',\n    yField: 'theme',\n    groupField: 'groupBy',\n    infoField: 'themeDescription',\n    whereClause: \"groupBy IN ('publications', 'tools', 'datasets')\",\n    markerSymbols: {\n      tools: 'y-down',\n      datasets: 'diamond-x',\n      publications: 'circle',\n    },\n    plotStyle: {\n      markerLine: 'rgba(0, 0, 0,1)',\n      markerFill: 'rgba(255, 255, 255,1)',\n      markerSize: 11,\n      backgroundColor: '#f5f9fa',\n    },\n  }\n\n  const plotCallback = ({ facetValue, type }: ClickCallbackParams) => {\n    alert(`facetValue: ${facetValue} type: ${type}`)\n  }\n\n  return (\n    <div className=\"container\">\n      <div style={{ fontWeight: 'bold' }}></div>\n      <h4 style={{ marginTop: '20px' }}>Checkbox</h4>\n      Checkbox 1 is {check1 ? 'checked' : 'unchecked'}\n      <br />\n      Checkbox 2 is {check2 ? 'checked' : 'unchecked'}\n      <br />\n      <Checkbox\n        label=\"Initially Checked Checkbox\"\n        id=\"ch1\"\n        checked={true}\n        onChange={(checked: boolean) => setCheck1(checked)}\n      ></Checkbox>\n      <Checkbox\n        label=\"Initially Unchecked Checkbox\"\n        id=\"ch2\"\n        onChange={(checked: boolean) => setCheck2(checked)}\n      ></Checkbox>\n      <hr></hr>\n      <h4 style={{ marginTop: '20px' }}>Radio</h4>\n      Option Value is: {optionValue}\n      <br />\n      <RadioGroup\n        id=\"radioGroup1\"\n        options={options}\n        value={optionValue}\n        onChange={(value: string) => setOptionValue(value)}\n      ></RadioGroup>\n      <hr></hr>\n      <h4 style={{ marginTop: '20px' }}>Number Range</h4>\n      Number Range Value is:\n      {` ${rangeNumberValue.min} - ${rangeNumberValue.max}`}\n      <br />\n      <Range\n        type=\"number\"\n        initialValues={{ min: rangeNumberValue.min, max: rangeNumberValue.max }}\n        onChange={(values: RangeValues) => setRangeNumberValue(values)}\n      ></Range>\n      <hr></hr>\n      <h4>Date Range</h4>\n      Number Date Value is: {rangeDateValue.min} - {rangeDateValue.max}\n      <br />\n      <Range\n        type=\"date\"\n        initialValues={{ min: rangeDateValue.min, max: rangeDateValue.max }}\n        onChange={(values: RangeValues) => setRangeDateValue(values)}\n      ></Range>\n      <hr></hr>\n      <h4>Range Slider</h4>\n      Range Slider Value is: {rangeSliderValue.min} - {rangeSliderValue.max}\n      <br />\n      <RangeSlider\n        initialValues={rangeSliderValue}\n        onChange={(values: { min: string; max: string }) =>\n          setRangeSliderValue(values)\n        }\n        domain={['0', '100']}\n        step={1}\n      ></RangeSlider>\n      <ThemesPlot\n        token={props.token}\n        onPointClick={plotCallback}\n        topBarPlot={topBarPlotProps}\n        sideBarPlot={sideBarPlotProps}\n        dotPlot={dotPlotProps}\n      ></ThemesPlot>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport AccessRequirementList from 'lib/containers/access_requirement_list/AccessRequirementList'\n\ntype AccessRequirementDemoProps = {\n  token: string\n}\n\nexport const AccessRequirementDemo: React.FunctionComponent<AccessRequirementDemoProps> = props => {\n  const { token } = props\n  const [\n    displayAccessRequirement,\n    setDisplayAccessRequirement,\n  ] = React.useState<boolean>(false)\n  const currentWindowLocation = window.location.href\n  const [inputValue, setInputValue] = React.useState<string>('')\n\n  const getAccessRequirement = () => {\n    if (inputValue !== '' && inputValue.startsWith('syn')) {\n      setDisplayAccessRequirement(!displayAccessRequirement)\n    }\n  }\n\n  return (\n    <div>\n      {displayAccessRequirement ? (\n        <AccessRequirementList\n          onHide={() => {\n            window.location.href = currentWindowLocation\n            setDisplayAccessRequirement(false)\n          }}\n          entityId={inputValue}\n          token={token}\n        />\n      ) : (\n        <>\n          <p>SynId for Self Sign Access: syn3850484</p>\n          <p>SynId for Terms Of Use: syn2426398</p>\n          <p>SynId for Managed ACT Access: syn3191087</p>\n          <p>SynId for ACT Access: syn12634840</p>\n\n          <input\n            id=\"AccessRequirementInput\"\n            type=\"text\"\n            placeholder=\"Synapse Id\"\n            onChange={event => {\n              setInputValue(event.target.value)\n            }}\n          ></input>\n          <button\n            className=\"get-access-requirement-button\"\n            onClick={getAccessRequirement}\n          >\n            Get Access Requirement\n          </button>\n        </>\n      )}\n    </div>\n  )\n}\n","import React, { useState } from 'react'\n\ntype Props = {\n  userId: string\n}\n\nexport default function TemplateComponent({ userId }: Props) {\n  const [count, setCount] = useState<number>(0)\n\n  return (\n    <div>\n      <button\n        style={{ backgroundColor: 'blue', color: 'white' }}\n        onClick={() => setCount(count + 1)}\n      >\n        Click to increment count!\n      </button>\n      <p> Count = {count} </p>\n\n      <p> Passed in userId = {userId} </p>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport TemplateComponent from '../../../lib/containers/TemplateComponent'\n\nexport default function TemplateComponentDemo() {\n  /*\n    Setup component with props for various scenarios\n  */\n  return <TemplateComponent userId={'1234'} />\n}\n","import * as React from 'react'\nimport ThemesPlot from 'lib/containers/widgets/themes-plot/ThemesPlot'\n\nexport const ThemesPlotDemo = () => {\n  return (\n    <ThemesPlot\n      onPointClick={e => {\n        console.log(e.event.shiftKey) // shift\n        console.log(e.event.ctrlKey) // ctrl\n        console.log(e.event.altKey) // alt\n        console.log(e.event.metaKey) // command/windows (meta) key\n      }}\n      topBarPlot={{\n        entityId: 'syn21641485',\n        xField: 'totalCount',\n        yField: 'groupBy',\n        groupField: 'consortium',\n        colors: {\n          CSBC: 'rgba(64,123,160, 1)',\n          'PS-ON': 'rgba(91,176,181,1)',\n          ICBP: 'rgba(197, 191, 223, 1)',\n          TEC: 'rgba(156, 196, 233, 1)',\n        },\n        whereClause: 'totalCount is not NULL',\n      }}\n      sideBarPlot={{\n        entityId: 'syn21649281',\n        xField: 'totalCount',\n        yField: 'theme',\n        groupField: 'consortium',\n        countLabel: 'grants',\n        plotStyle: {\n          backgroundColor: '#f5f9fa',\n        },\n        colors: {\n          CSBC: '#1c76af',\n          'PS-ON': '#5bb0b5',\n          ICBP: '#9cc4e9',\n          TEC: '#c5bfdf',\n        },\n      }}\n      dotPlot={{\n        entityId: 'syn21639584',\n        xField: 'totalCount',\n        yField: 'theme',\n        groupField: 'groupBy',\n        infoField: 'themeDescription',\n        whereClause: \"groupBy IN ('publications', 'tools', 'datasets')\",\n        markerSymbols: {\n          tools: 'y-down',\n          datasets: 'diamond-x',\n          publications: 'circle',\n        },\n        plotStyle: {\n          markerLine: 'rgba(0, 0, 0,1)',\n          markerFill: 'rgba(255, 255, 255,1)',\n          markerSize: 11,\n          backgroundColor: '#f5f9fa',\n        },\n      }}\n    />\n  )\n}\n","import * as React from 'react'\nimport Goals, { GoalsProps } from 'lib/containers/home_page/goals/Goals'\n\nexport default (props: GoalsProps) => {\n  return (\n    <div className=\"container\">\n      <Goals {...props} />\n    </div>\n  )\n}\n","import * as React from 'react'\nimport Programs, { ProgramsProps } from 'lib/containers/home_page/programs/Programs'\n\nexport default (props: ProgramsProps) => {\n  return (\n    <div className=\"container\">\n      <Programs {...props} />\n    </div>\n  )\n}\n","import * as React from 'react'\nimport UpsetPlot from 'lib/containers/UpsetPlot'\n\ntype UpsetPlotDemoProps = {\n  token: string\n}\n\nexport const UpsetPlotDemo: React.FunctionComponent<UpsetPlotDemoProps> = ({token}) => {\n  return (\n    <UpsetPlot\n      token={token}\n      sql={\"SELECT unnest(individualID), assay FROM syn20821313 WHERE individualID is not null GROUP BY assay, unnest(individualID)\"}\n      rgbIndex={0}\n      maxBarCount={20}\n      setName='Individuals (#) per Assay'\n      combinationName='Individuals (#)'\n      summaryLink='/Synapse-React-Client/Playground/UpsetPlotDemo'\n      summaryLinkText='EXPLORE ALL OF SOMETHING'\n    />\n  )\n}","import * as React from 'react'\nimport SynapsePlot from 'lib/containers/widgets/SynapsePlot'\n\ntype SynapsePlotDemoProps = {\n  token: string\n}\n\nexport const SynapsePlotDemo: React.FunctionComponent<SynapsePlotDemoProps> = ({token}) => {\n  return (\n    <SynapsePlot\n      token={token}\n      widgetparamsMapped={{\n        query:'SELECT \\'date\\', survey_1, survey_2, survey_3, survey_4 FROM syn22314856',\n        title:'New Participants Per Survey Per Day',\n        xtitle:'Date',\n        ytitle: 'Count',\n        type: 'scatter',\n        horizontal: 'true',\n        // xaxistype:,\n        showlegend:'true'\n      }\n      }      \n    />\n  )\n}","import * as React from 'react'\nimport UserCardListRotate from '../../../lib/containers/UserCardListRotate'\nimport { MEDIUM_USER_CARD } from 'lib/utils/SynapseConstants'\n\nexport const PeopleProfileDemo = () => {\n  return (\n    <div className=\"homepage-color-background\">\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <UserCardListRotate\n            sql={\"SELECT * FROM syn22096112 where feature=true\"}\n            count={3}\n            summaryLinkText={\"EXPLORE ALL PEOPLE\"}\n            summaryLink={\"/Explore/People\"}\n          />\n        </div>\n        <div className=\"row\">\n          <UserCardListRotate\n            sql={\"SELECT * FROM syn13897207 where isFeatured=true\"}\n            count={3}\n            useQueryResultUserData={true}\n            size={MEDIUM_USER_CARD}\n            summaryLinkText={\"EXPLORE ALL PEOPLE\"}\n            summaryLink={\"/Explore/People\"}            \n          />\n        </div>\n      </div>\n    </div>\n  )\n}","import * as React from 'react'\nimport FeaturedDataTabs from '../../../lib/containers/home_page/featured-data/FeaturedDataTabs'\n\nexport const FeaturedDataTabsDemo = () => {\n  return (\n    <FeaturedDataTabs rgbIndex={0}\n      sql='select * from syn11346063'\n      explorePagePath='/Explore/Studies'\n      exploreObjectType='Studies'\n      configs={\n        [\n          {\n            title: 'Human Studies',\n            icon: 'PERSON',\n            exploreFacetColumnName: 'species',\n            exploreFacetColumnValue: 'Human',\n            plotsConfig: {\n              configs: [{\n                title:'The Religious Orders and Memory and Aging Project Study',\n                facetsToPlot:['dataType', 'assay'],\n                selectFacetColumnName:'study',\n                selectFacetColumnValue:'ROSMAP',\n                detailsPagePath:'/Explore/Studies/DetailsPage?Study=syn3219045'\n              },\n              {\n                title:'The Mount Sinai Brain Bank Study',\n                facetsToPlot:['dataType', 'assay'],\n                selectFacetColumnName:'study',\n                selectFacetColumnValue:'MSBB',\n                detailsPagePath:'/Explore/Studies/DetailsPage?Study=syn3159438'\n              },\n              {\n                title:'The RNAseq Harmonization Study',\n                facetsToPlot:['dataType', 'assay'],\n                selectFacetColumnName:'study',\n                selectFacetColumnValue:'rnaSeqReprocessing',\n                detailsPagePath:'/Explore/Studies/DetailsPage?Study=syn5550404'\n              },]\n            }\n          },\n          {\n            title: 'Animal Model Studies',\n            icon: 'MOUSE',\n            exploreFacetColumnName: 'species',\n            exploreFacetColumnValue: 'Mouse',\n            plotsConfig: {\n              configs: [{\n                title:'The UCI MODEL-AD 5XFAD Study',\n                facetsToPlot:['dataType', 'assay'],\n                selectFacetColumnName:'study',\n                selectFacetColumnValue:'UCI_5XFAD',\n                detailsPagePath:'/Explore/Studies/DetailsPage?Study=syn16798076'\n              },\n              {\n                title:'The IU/Jax/Pitt MODEL-AD Primary Screen Study',\n                facetsToPlot:['dataType', 'assay'],\n                selectFacetColumnName:'study',\n                selectFacetColumnValue:'Jax.IU.Pitt_PrimaryScreen',\n                detailsPagePath:'/Explore/Studies/DetailsPage?Study=syn21595258'\n              },\n              {\n                title:'The IU/Jax/Pit MODEL-AD APOE/TREM2 Study',\n                facetsToPlot:['dataType', 'assay'],\n                selectFacetColumnName:'study',\n                selectFacetColumnValue:'Jax.IU.Pitt_5XFAD',\n                detailsPagePath:'/Explore/Studies/DetailsPage?Study=syn17095980'\n              }]\n            }\n          }\n        ]\n    }\n    />\n  )\n}","import * as React from 'react'\nimport { Link, Route } from 'react-router-dom'\nimport QueryWrapperMenuDemo from './QueryWrapperMenuDemo'\nimport CardContainerLogicDemo, { iconOptions } from './CardContainerLogicDemo'\nimport SearchDemo from './SearchDemo'\nimport ModalDownloadDemo from './ModalDownloadDemo'\nimport UserCardDemo from './UserCardDemo'\nimport MarkdownSynapseDemo from './MarkdownSynapseDemo'\nimport ShowDownloadDemo from './ShowDownloadDemo'\nimport { NewsFeedDemo } from './NewsFeedDemo'\nimport { SingleNewsFeedPostDemo } from './SingleNewsFeedPostDemo'\nimport FormServicesIntegrationDemo from './FormServicesIntegrationDemo'\nimport QueryWrapperPlotNavDemo from './QueryWrapperPlotNavDemo'\nimport DownloadListTable from 'lib/containers/download_list/DownloadListTable'\nimport { WidgetDemo } from './WidgetDemo'\nimport { RouteChildrenProps } from 'react-router'\nimport { AccessRequirementDemo } from './AccessRequirementDemo'\nimport TemplateComponentDemo from './TemplateComponentDemo'\nimport { ThemesPlotDemo } from './ThemesPlotDemo'\nimport GoalsDemo from './GoalsDemo'\nimport ProgramsDemo from './ProgramsDemo'\nimport Resources from 'lib/containers/home_page/resources/Resources'\nimport { UpsetPlotDemo } from './UpsetPlotDemo'\nimport { SynapsePlotDemo } from './SynapsePlotDemo'\nimport { ExternalFileHandleLink } from 'lib/containers/ExternalFileHandleLink'\nimport { PeopleProfileDemo } from './PeopleProfileDemo'\nimport { FeaturedDataTabsDemo } from './FeaturedDataTabsDemo'\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nconst App = ({\n  match,\n  token,\n}: {\n  match?: RouteChildrenProps['match']\n  token: string\n}) => {\n  if (!match) {\n    return <div />\n  }\n  return (\n    <div>\n      <h2>Links to components under development </h2>\n      <ul>\n        <li>\n          <Link to={`${match.url}/QueryWrapperMenuDemo`}>\n            QueryWrapperMenuDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/QueryWrapperPlotNavDemo`}>\n            QueryWrapperPlotNavDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/SearchDemo`}>SearchDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/CardContainerLogicDemo`}>\n            CardContainerLogicDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/UserBadgeDemo`}>UserBadgeDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/MarkdownSynapseDemo`}>\n            MarkdownSynapseDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/NewsFeedDemo`}>NewsFeedDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/SingleNewsFeedPostDemo?tag=centenarians`}>\n            SingleNewsFeedPostDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/FormServicesIntegrationDemo`}>\n            FormServicesIntegrationDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/ModalDownloadDemo`}>ModalDownload</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/DownloadListTableDemo`}>\n            DownloadListTableDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/WidgetDemo`}>WidgetDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/AccessRequirementDemo`}>\n            AccessRequirementDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/TemplateComponentDemo`}>\n            TemplateComponentDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/ShowDownloadDemo`}>ShowDownloadDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/ThemesPlotDemo`}>ThemesPlotDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/SynapsePlotDemo`}>SynapsePlotDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/UpsetPlotDemo`}>UpsetPlotDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/ExternalFileHandleLink`}>\n            ExternalFileHandleLink\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/People`}>PeopleDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/GoalsDemo`}>GoalsDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/ProgramsDemo`}>ProgramsDemo</Link>\n        </li>        \n        <li>\n          <Link to={`${match.url}/ResourcesDemo`}>ResourcesDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/FeaturedDataTabsDemo`}>Featured Data Tabs Demo</Link>\n        </li>        \n      </ul>\n\n      <Route\n        exact={true}\n        path={`${match.url}/QueryWrapperMenuDemo`}\n        render={() => <QueryWrapperMenuDemo token={token} rgbIndex={0} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/QueryWrapperPlotNavDemo`}\n        render={() => <QueryWrapperPlotNavDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/SearchDemo`}\n        render={() => <SearchDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/CardContainerLogicDemo`}\n        component={CardContainerLogicDemo}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/UserBadgeDemo`}\n        component={() => <UserCardDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/MarkdownSynapseDemo`}\n        component={() => <MarkdownSynapseDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/NewsFeedDemo`}\n        component={() => <NewsFeedDemo />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/SingleNewsFeedPostDemo`}\n        component={() => <SingleNewsFeedPostDemo />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/FormServicesIntegrationDemo`}\n        component={() => <FormServicesIntegrationDemo />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/ModalDownloadDemo`}\n        component={() => <ModalDownloadDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/DownloadListTableDemo`}\n        component={() => (\n          <div className=\"container download-list-demo\">\n            <div className=\"col-xs-10\">\n              <DownloadListTable\n                token={token}\n                listUpdatedCallback={() => {\n                  console.log('DownloadList updated')\n                }}\n              />\n            </div>\n          </div>\n        )}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/WidgetDemo`}\n        component={() => <WidgetDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/AccessRequirementDemo`}\n        component={() => <AccessRequirementDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/TemplateComponentDemo`}\n        component={() => <TemplateComponentDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/ShowDownloadDemo`}\n        component={() => <ShowDownloadDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/ThemesPlotDemo`}\n        component={ThemesPlotDemo}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/SynapsePlotDemo`}\n        component={() => <SynapsePlotDemo token={token} />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/UpsetPlotDemo`}\n        component={() => <UpsetPlotDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/GoalsDemo`}\n        component={() => <GoalsDemo entityId={'syn22315959'} token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/ProgramsDemo`}\n        component={() => <ProgramsDemo\n          entityId={'syn17024173'}\n          rgbIndex={1}\n          titleColumnName={'Program'}\n          summaryColumnName={'Short Description'}\n          linkColumnName={'Website'}\n          iconColumnName={'Program'}\n          iconOptions={iconOptions}\n          linkConfig={{\n            isMarkdown: false,\n            baseURL: 'Explore/Programs/DetailsPage',\n            URLColumnName: 'Program',\n            matchColumnName: 'Program',\n          }}\n          token={token} />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/ResourcesDemo`}\n        component={() => (\n          <div className=\"container\">\n            {' '}\n            <Resources entityId=\"syn22311127\" token={token} />{' '}\n          </div>\n        )}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/ExternalFileHandleLink`}\n        component={() => (\n          <ExternalFileHandleLink synId={'syn22276050'} token={token} />\n        )}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/People`}\n        component={PeopleProfileDemo}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/FeaturedDataTabsDemo`}\n        component={FeaturedDataTabsDemo}\n      />\n\n      <Route exact={true} path={match.path} component={() => <div />} />\n    </div>\n  )\n}\n\nexport default App\n","import * as React from 'react'\nimport { Link, BrowserRouter as Router, Route } from 'react-router-dom'\nimport Login from '../../lib/containers/Login'\nimport logoSvg from '../../images/logo.svg'\nimport '../style/App.scss'\nimport '../style/DemoStyle.scss'\nimport '@fortawesome/fontawesome-free/css/all.css'\nimport Demo from './Demo'\nimport Playground from './playground/Playground'\nimport SynapseFormWrapper from '../../lib/containers/synapse_form_wrapper/SynapseFormWrapper'\nimport SynapseFormSubmissionsGrid from '../../lib/containers/synapse_form_wrapper/SynapseFormSubmissionsGrid'\nimport { SynapseClient } from '../../lib/utils/'\nimport { RouteChildrenProps } from 'react-router'\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\n\ntype AppState = {\n  token: string\n  getSessionCalled: boolean\n}\nexport const TokenContext = React.createContext('')\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      token: '',\n      getSessionCalled: false,\n    }\n  }\n\n  handleChange = (updatedState: {}): void => {\n    this.setState(updatedState)\n  }\n\n  public componentDidMount() {\n    // Note:  All portals should do this once on the initial app load.\n    // This looks for the session token cookie (HttpOnly, unable to directly access), and initialize the session if it does exists.\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then(sessionToken =>\n        this.handleChange({ token: sessionToken, getSessionCalled: true }),\n      )\n      .catch((error: any) => {\n        console.error(error)\n        this.setState({\n          getSessionCalled: true,\n        })\n      })\n  }\n\n  getSession = async () => {\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then(sessionToken => {\n        this.handleChange({ token: sessionToken })\n      })\n      .catch((error: any) => {\n        console.error(error)\n      })\n  }\n\n  renderLoginAndSignout(token: string): JSX.Element {\n    const signedInState = (\n      <div className=\"bg-success text-center\" role=\"alert\">\n        You are logged in.&nbsp;\n        <button\n          onClick={() => {\n            SynapseClient.signOut(this.getSession)\n          }}\n        >\n          <span aria-hidden=\"true\">Sign out</span>\n        </button>\n      </div>\n    )\n\n    const notSignedInState = (\n      <div className=\"text-center\">\n        <h4>Synapse Production (Google SSO redirects here)</h4>\n        <Login sessionCallback={this.getSession} theme={'light'} icon={true} />\n        <details>\n          <summary>\n            Synapse Staging (Google SSO redirects to staging site)\n          </summary>\n          <Login\n            sessionCallback={this.getSession}\n            theme={'dark'}\n            icon={true}\n            googleRedirectUrl={\n              'https://staging.synapse.org/Portal/oauth2callback?oauth2provider=GOOGLE_OAUTH_2_0'\n            }\n          />\n        </details>\n        <hr />\n      </div>\n    )\n\n    if (token && token !== '') {\n      return signedInState\n    } else {\n      return notSignedInState\n    }\n  }\n\n  public render(): JSX.Element {\n    const { token, getSessionCalled } = this.state\n    if (!getSessionCalled) {\n      // This lets us keep better track of API calls made, it avoids having the token cause an unecessary\n      // component update\n      return (\n        <div>\n          <div className=\"App-header text-center\">\n            <img src={logoSvg} className=\"App-logo\" alt=\"logo\" />\n            <h4 className=\"white-text\">Synapse React Client Demo</h4>\n          </div>\n          <p> Getting session token... </p>\n        </div>\n      )\n    }\n    return (\n      <TokenContext.Provider value={token}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <div>\n            <div className=\"App-header text-center\">\n              <img src={logoSvg} className=\"App-logo\" alt=\"logo\" />\n              <h4 className=\"white-text\">Synapse React Client Demo</h4>\n            </div>\n            {this.renderLoginAndSignout(token)}\n            <ul>\n              <li>\n                <Link to=\"/\">Demo</Link>\n              </li>\n              <li>\n                <Link to=\"/Playground\">Playground</Link>\n              </li>\n              <li>\n                <Link to=\"/drugUploadTool\">Drug Upload Tool</Link>\n              </li>\n              <li>\n                <Link to=\"/contribReqForm\">\n                  AMP-AD external data contribution{' '}\n                </Link>\n              </li>\n            </ul>\n            <Route exact={true} path=\"/\" component={Demo} />\n            <Route\n              path=\"/Playground\"\n              component={(props: RouteChildrenProps) => (\n                <Playground {...props} token={token} />\n              )}\n            />\n            <Route\n              exact={true}\n              path=\"/drugUploadTool\"\n              render={props => {\n                const searchParamsProps: any = {}\n                // https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams -- needs polyfill for ie11\n                const searchParams = new URLSearchParams(props.location.search)\n                searchParams.forEach((value, key) => {\n                  searchParamsProps[key] = value\n                })\n                return !props.location.search ? (\n                  <SynapseFormSubmissionsGrid\n                    pathpart=\"drugUploadTool\"\n                    token={token}\n                    formClass=\"drug-upload-tool\"\n                    formGroupId=\"9\"\n                    itemNoun=\"Compound\"\n                  />\n                ) : (\n                  <SynapseFormWrapper\n                    {...props}\n                    formSchemaEntityId=\"syn20680102\"\n                    fileNamePath=\"naming.compound_name\"\n                    formUiSchemaEntityId=\"syn20693568\"\n                    formNavSchemaEntityId=\"syn20680027\"\n                    token={token}\n                    formTitle=\"Your Submission\"\n                    formClass=\"drug-upload-tool\"\n                    searchParams={searchParamsProps}\n                  />\n                )\n              }}\n            />\n\n            {/*------------------- contributions request form ---------------------------------*/}\n            <Route\n              exact={true}\n              path=\"/contribReqForm\"\n              render={props => {\n                let searchParamsProps: any = {}\n                // https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams -- needs polyfill for ie11\n                const searchParams = new URLSearchParams(props.location.search)\n                searchParams.forEach((value, key) => {\n                  searchParamsProps[key] = value\n                })\n                return !props.location.search ? (\n                  <SynapseFormSubmissionsGrid\n                    pathpart=\"contribReqForm\"\n                    formGroupId=\"11\"\n                    token={token}\n                    formClass=\"contribution-request\"\n                    itemNoun={'Contribution Request'}\n                  />\n                ) : (\n                  <SynapseFormWrapper\n                    {...props}\n                    formSchemaEntityId=\"syn20692910\"\n                    fileNamePath=\"study.submission_name\"\n                    formUiSchemaEntityId=\"syn20692911\"\n                    formNavSchemaEntityId=\"syn20968007\"\n                    isWizardMode={true}\n                    token={token}\n                    formTitle=\"Your Contribution Request\"\n                    formClass=\"contribution-request\"\n                    searchParams={searchParamsProps}\n                  />\n                )\n              }}\n            />\n          </div>\n        </Router>\n      </TokenContext.Provider>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\nimport App from './demo/containers/App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","// Folder exports\nexport * from './Download'\nexport * from './EvaluationQueryTable'\nexport * from './Table'\nexport * from './AccessRequirement'\n// https://basarat.gitbooks.io/typescript/docs/tips/barrel.html\nexport * from './AccessCodeResponse'\nexport * from './AccessControlList'\nexport * from './AddFilesToDownloadListRequest'\nexport * from './AddFilesToDownloadListResponse'\nexport * from './AddPartResponse'\nexport * from './AttachmentData'\nexport * from './BatchFileRequest'\nexport * from './BatchFileResult'\nexport * from './BatchPresignedUploadUrlRequest'\nexport * from './BatchPresignedUploadUrlResponse'\nexport * from './BulkFileDownloadRequest'\nexport * from './BulkFileDownloadResponse'\nexport * from './Entity'\nexport * from './EntityHeader'\nexport * from './EntityId'\nexport * from './EntityLookupRequest'\nexport * from './Evaluation'\nexport * from './EvaluationQueryTable'\nexport * from './FileDownloadSummary'\nexport * from './FileEntity'\nexport * from './FileHandle'\nexport * from './FileHandleAssociation'\nexport * from './FileHandleResults'\nexport * from './ExternalFileHandleInterface'\nexport * from './FileResult'\nexport * from './FileUploadComplete'\nexport * from './Forms'\nexport * from './LoginRequest'\nexport * from './LoginResponse'\nexport * from './MultipartUploadRequest'\nexport * from './MultipartUploadStatus'\nexport * from './OAuthClientPublic'\nexport * from './OIDCAuthorizationRequest'\nexport * from './OAuthConsentGrantedResponse'\nexport * from './OIDCAuthorizationRequestDescription'\nexport * from './PaginatedResults'\nexport * from './PartPresignedUrl'\nexport * from './ReferenceList'\nexport * from './ResourceAccess'\nexport * from './RestrictionInformation'\nexport * from './Statistics'\nexport * from './Submission'\nexport * from './SubmissionContributor'\nexport * from './SubmissionQuota'\nexport * from './SynapseVersion'\nexport * from './UserBundle'\nexport * from './UserGroupHeader'\nexport * from './UserGroupHeaderResponsePage'\nexport * from './UserPreference'\nexport * from './UserProfile'\nexport * from './VerificationSubmission'\nexport * from './WikiPage'\nexport * from './Evaluation'\nexport * from './AccessApproval'\nexport * from './WikiPageKey'\n","export * from './QueryTableResults'","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","module.exports = __webpack_public_path__ + \"static/media/Data2.1104e430.svg\";","module.exports = __webpack_public_path__ + \"static/media/subscribe_plus.f7a0ebbd.svg\";","export * from './DownloadList'\nexport * from './DownloadOrder'","export * from './AsyncJobId'\nexport * from './AsynchronousJobStatus'\nexport * from './ColumnModel'\nexport * from './ColumnType'\nexport * from './CsvTableDescription'\nexport * from './DownloadFromTableRequest'\nexport * from './DownloadFromTableResult'\nexport * from './FacetColumnRequest'\nexport * from './FacetColumnResult'\nexport * from './FacetType'\nexport * from './Query'\nexport * from './QueryBundleRequest'\nexport * from './QueryResult'\nexport * from './QueryResultBundle'\nexport * from './SelectColumn'\nexport * from './SumFileSizes'","// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/ColumnType.html\nexport enum ColumnType {\n  STRING = 'STRING',\n  DOUBLE = 'DOUBLE',\n  BOOLEAN = 'BOOLEAN',\n  INTEGER = 'INTEGER',\n  DATE = 'DATE',\n  FILEHANDLEID = 'FILEHANDLEID',\n  ENTITYID = 'ENTITYID',\n  LINK = 'LINK',\n  LARGETEXT = 'LARGETEXT',\n  USERID = 'USERID',\n  STRING_LIST = 'STRING_LIST',\n  INTEGER_LIST = 'INTEGER_LIST',\n  BOOLEAN_LIST = 'BOOLEAN_LIST',\n  DATE_LIST = 'DATE_LIST',\n}\n","export enum EntityColumnType {\n  STRING = 'STRING',\n  DOUBLE = 'DOUBLE',\n  BOOLEAN = 'BOOLEAN',\n  INTEGER = 'INTEGER',\n  DATE = 'DATE',\n  FILEHANDLEID = 'FILEHANDLEID',\n  ENTITYID = 'ENTITYID',\n  LINK = 'LINK',\n  LARGETEXT = 'LARGETEXT',\n  USERID = 'USERID',\n  STRING_LIST = 'STRING_LIST',\n  INTEGER_LIST = 'INTEGER_LIST',\n  BOOLEAN_LIST = 'BOOLEAN_LIST',\n  DATE_LIST = 'DATE_LIST',\n}\n\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/SelectColumn.html\nexport type SelectColumn = {\n  name: string // The required display name of the column\n  columnType: EntityColumnType\n  // The column type determines the type of data that can be stored in a co\n  id: string // The optional ID of the select column, if this is a direct column selected\n}\n","export * from './AccessRequirement'\nexport * from './RestrictableObjectDescriptor'\nexport * from './SelfSignAccessRequirement'\nexport * from './SelfSignAccessRequirementInterface'\nexport * from './TermsOfUseAccessRequirement'\nexport * from './AccessRequirementStatus'\nexport * from './ManagedACTAccessRequirement'\nexport * from './ACTAccessRequirement'\n","import { RestrictableObjectDescriptor } from './RestrictableObjectDescriptor'\n\nexport enum ACCESS_TYPE {\n  CREATE = 'CREATE',\n  READ = 'READ',\n  UPDATE = 'UPDATE',\n  DELETE = 'DELETE',\n  CHANGE_PERMISSIONS = 'CHANGE_PERMISSIONS',\n  DOWNLOAD = 'DOWNLOAD',\n  UPLOAD = 'UPLOAD',\n  PARTICIPATE = 'PARTICIPATE',\n  SUBMIT = 'SUBMIT',\n  READ_PRIVATE_SUBMISSION = 'READ_PRIVATE_SUBMISSION',\n  UPDATE_SUBMISSION = 'UPDATE_SUBMISSION',\n  DELETE_SUBMISSION = 'DELETE_SUBMISSION',\n  TEAM_MEMBERSHIP_UPDATE = 'TEAM_MEMBERSHIP_UPDATE',\n  SEND_MESSAGE = 'SEND_MESSAGE',\n  CHANGE_SETTINGS = 'CHANGE_SETTINGS',\n  MODERATE = 'MODERATE',\n}\n\nexport interface AccessRequirement {\n  versionNumber: number //\tThe version number issued to this version on the object.\n  id: number //\tThe unique immutable ID. Provided by the system, the user may not set this field.\n  etag: string //\tSynapse employs an Optimistic Concurrency Control (OCC) scheme to handle concurrent updates. Since the E-Tag changes every time an entity is updated it is used to detect when a client's current representation of an object is out-of-date.\n  createdOn: string //\tThe date this object was created. Provided by the system, the user may not set this field.\n  modifiedOn: string //\tThe date this object was last modified. Provided by the system, the user may not set this field.\n  createdBy: string //\tThe user that created this object. Provided by the system, the user may not set this field.\n  modifiedBy: string //\tThe user that last modified this object. Provided by the system, the user may not set this field.\n  subjectIds: Array<RestrictableObjectDescriptor> // The IDs of the items controlled by this Access Requirement. Required when creating or updating.\n  accessType: ACCESS_TYPE //\tThe enumeration of possible permission.\n  concreteType: string //\tIndicates which type of AccessRequirement this object represents. Provided by the system, the user may not set this field.\n}\n","import { FileHandleAssociation } from './FileHandleAssociation'\n\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/ZipFileFormat.html\nexport enum ZipFileFormat {\n  CommandLineCache = 'CommandLineCache', // This is the default format. Zip file format structure is: (%1000)//\n  Flat = 'Flat', // Files are writtent to the zip 'flat' with no directory structure.\n  //Each file is named after the original file. Duplicate file names are appended with a number in parenthesis to ensure all names are unique.\n}\n\n// Request for a bulk file download.\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/BulkFileDownloadRequest.html\nexport type BulkFileDownloadRequest = {\n  concreteType: 'org.sagebionetworks.repo.model.file.BulkFileDownloadRequest'\n  requestedFiles: FileHandleAssociation[] // The files to be included in the download.\n  zipFileName: string // Optional parameter to set the name of the resulting zip file.\n  zipFileFormat?: ZipFileFormat // Enumeration of all possible zip file formats produced by bulk file download worker\n}\n","import { FileHandleAssociateType } from './FileHandleAssociation'\n\n// The download status of this file.\nexport enum FileDownloadStatus {\n  SUCCESS = 'SUCCESS',\n  FAILURE = 'FAILURE',\n}\n\n// If the download status of this file is set to 'FAILURE', then this will be the failure code. Null for 'SUCCESS'.\nexport enum FileDownloadCode {\n  NOT_FOUND = 'NOT_FOUND',\n  UNAUTHORIZED = 'UNAUTHORIZED',\n  DUPLICATE = 'DUPLICATE',\n  EXCEEDS_SIZE_LIMIT = 'EXCEEDS_SIZE_LIMIT',\n  UNKNOWN_ERROR = 'UNKNOWN_ERROR',\n}\n\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/FileDownloadSummary.html\nexport type FileDownloadSummary = {\n  fileHandleId: string //\tThe file handle id of a requested file.\n  associateObjectId: string //\tThe ID of the object associated with the file\n  associateObjectType: FileHandleAssociateType //\tEnumeration of all possible objects types that can be associated with a file.\n  zipEntryName: string //\tThe zip entry name used for this file. This entry includes both the path and file name. The value will only be set if the status is set to 'SUCCESS'\n  status: FileDownloadStatus //\tThe download status of this file.\n  failureMessage: string //\tIf the download status of this file is set to 'FAILURE', then this will be the failure message. Null for 'SUCCESS'.\n  failureCode: FileDownloadCode | null // If the download status of this file is set to 'FAILURE', then this will be the failure code. Null for 'SUCCESS'.\n}\n","import { Entity } from './Entity'\nimport { AssertionError } from 'assert'\n\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/FileEntity.html\nexport interface FileEntity extends Entity {\n  concreteType: 'org.sagebionetworks.repo.model.FileEntity'\n  versionNumber?: number // \tThe version number issued to this version on the object.\n  versionLabel?: string // \tThe version label for this entity\n  versionComment?: string // \tThe version comment for this entity\n  versionUrl?: string // \tThe full URL of this exect version. This URL is provided by Synapse.\n  versions?: string // \tThe URL to get all versions of this entity. This URL is provided by Synapse.\n  dataFileHandleId: string // \tID of the file associated with this entity.\n  fileNameOverride?: string // \tAn optional replacement for the name of the uploaded file. This is distinct from the entity name. If omitted the file will retain its original name.\n}\n\nexport function assertIsFileEntity(val: Entity): asserts val is FileEntity {\n  if (val.concreteType !== 'org.sagebionetworks.repo.model.FileEntity') {\n    throw new AssertionError({\n      message: `File Entity exepcted but found ${val}`,\n    })\n  }\n}\n","// http://rest-docs.synapse.org/rest/org/sagebionetworks/repo/model/file/FileHandleAssociateType.html\nexport enum FileHandleAssociateType {\n  FileEntity = 'FileEntity',\n  TableEntity = 'TableEntity',\n  WikiAttachment = 'WikiAttachment',\n  WikiMarkdown = 'WikiMarkdown',\n  UserProfileAttachment = 'UserProfileAttachment',\n  MessageAttachment = 'MessageAttachment',\n  TeamAttachment = 'TeamAttachment',\n  SubmissionAttachment = 'SubmissionAttachment',\n  VerificationSubmission = 'VerificationSubmission',\n  AccessRequirementAttachment = 'AccessRequirementAttachment',\n  DataAccessRequestAttachment = 'DataAccessRequestAttachment',\n  DataAccessSubmissionAttachment = 'DataAccessSubmissionAttachment',\n}\n\nexport type FileHandleAssociation = {\n  fileHandleId: string //\tThe ID of the FileHandle.\n  associateObjectId: string //\tThe ID of the object associated with the file\n  associateObjectType: FileHandleAssociateType //\tEnumeration of all possible objects types that can be associated with a file.\n}\n","import { FileHandle } from './FileHandle'\nimport { AssertionError } from 'assert'\n\nexport enum ExternalFileHandleConcreteTypeEnum {\n  ProxyFileHandle = 'org.sagebionetworks.repo.model.file.ProxyFileHandle',\n  ExternalObjectStoreFileHandle = 'org.sagebionetworks.repo.model.file.ExternalObjectStoreFileHandle',\n  ExternalFileHandle = 'org.sagebionetworks.repo.model.file.ExternalFileHandle',\n}\n\n/*\nhttps://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/ExternalObjectStoreFileHandle.html\nRepresents a file stored in an S3 Bucket to which Synapse cannot access. \nTogether with ExternalObjectStorageLocationSetting, this object provides the information the client requires to access the S3 file.\n\n*/\nexport type ExternalObjectStoreFileHandle = ExternalFileHandleInterface & {\n  concreteType: ExternalFileHandleConcreteTypeEnum.ExternalObjectStoreFileHandle // This is used to indicate the implementation of this interface. For example, an S3FileHandle should be set to: org.sagebionetworks.repo.model.file.S3FileHandle\n  filePath: string //\tSTRING\tThe relative path of this file within the proxy.\n}\n\nexport function assertIsExternalFileHandle(\n  x?: FileHandle,\n): asserts x is ExternalFileHandle {\n  if (\n    x?.concreteType !== ExternalFileHandleConcreteTypeEnum.ExternalFileHandle\n  ) {\n    throw new AssertionError({\n      message: ` ExternalFileHandle expected but found ${x}`,\n    })\n  }\n}\n\n/*\n  https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/ExternalFileHandle.html\n  An ExternalFileHandle represents a file that is not stored in Synapse. Instead, ExternalFileHandles reside somewhere accessible via a URL. Synapse will attempt to generate a preview for any external URL that can be publicly read.\n*/\nexport type ExternalFileHandle = ExternalFileHandleInterface & {\n  concreteType: ExternalFileHandleConcreteTypeEnum.ExternalFileHandle // This is used to indicate the implementation of this interface. For example, an S3FileHandle should be set to: org.sagebionetworks.repo.model.file.S3FileHandle\n  externalURL: string //\tThe external URL of this file.\n}\n\n/*\n https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/ProxyFileHandle.html\n Reference to a file that accessible via a proxy server. Each ProxyFileHandle must reference a ProxyStorageLocationSettings that defines how the files are accessed.\n*/\nexport type ProxyFileHandle = ExternalFileHandleInterface & {\n  concreteType: ExternalFileHandleConcreteTypeEnum.ProxyFileHandle // This is used to indicate the implementation of this interface. For example, an S3FileHandle should be set to: org.sagebionetworks.repo.model.file.S3FileHandle\n  filePath: string //\tSTRING\tThe relative path of this file within the proxy.\n}\n\n// https://www.typescriptlang.org/docs/handbook/advanced-types.html#typeof-type-guards\nexport function implementsExternalFileHandleInterface(\n  x: ExternalFileHandleInterface,\n): x is ExternalFileHandleInterface {\n  return Object.values<string>(ExternalFileHandleConcreteTypeEnum).includes(\n    x.concreteType,\n  )\n}\n\n/* \n  Defines FileHandles for files that are stored externally and can not be controlled by Synapse. \n  All file access authentication and download/upload/delete operations are delegated the client.\n\n  Note - while the interface is empty this keeps parity between the backend and frontend types.\n*/\nexport interface ExternalFileHandleInterface extends FileHandle {}\n","//https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormGroup.html\nexport type FormGroup = {\n  groupId: string\n  name: string\n  createdBy: string\n  createdOn: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormData.html\nexport type FormData = {\n  formDataId: string\n  etag: string\n  groupId: string\n  name: string\n  createdBy: string\n  createdOn: string\n  modifiedOn: string\n  dataFileHandleId: string\n  submissionStatus: SubmissionStatus\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormChangeRequest.html\nexport type FormChangeRequest = {\n  name: string\n  fileHandleId: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormRejection.html\nexport type FormRejection = {\n  reason: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/SubmissionStatus.html\nexport type SubmissionStatus = {\n  submittedOn?: string\n  reviewedOn?: string\n  reviewedBy?: string\n  state: StatusEnum\n  rejectionMessage?: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/StatusEnum.html\nexport enum StatusEnum {\n  WAITING_FOR_SUBMISSION = 'WAITING_FOR_SUBMISSION',\n  SUBMITTED_WAITING_FOR_REVIEW = 'SUBMITTED_WAITING_FOR_REVIEW',\n  ACCEPTED = 'ACCEPTED',\n  REJECTED = 'REJECTED',\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/ListRequest.html\nexport type ListRequest = {\n  filterByState?: StatusEnum[]\n  groupId: string\n  nextPageToken?: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/ListResponse.html\nexport type ListResponse = {\n  page: FormData[]\n  nextPageToken?: string\n}\n","// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictableObjectType.html\nexport enum RestrictableObjectType {\n  ENTITY = 'ENTITY',\n  EVALUATION = 'EVALUATION',\n  TEAM = 'TEAM',\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictionInformationRequest.html\nexport type RestrictionInformationRequest = {\n  restrictableObjectType: RestrictableObjectType\n  objectId: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictionLevel.html\nexport enum RestrictionLevel {\n  OPEN = 'OPEN',\n  RESTRICTED_BY_TERMS_OF_USE = 'RESTRICTED_BY_TERMS_OF_USE',\n  CONTROLLED_BY_ACT = 'CONTROLLED_BY_ACT',\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictionInformationResponse.html\nexport type RestrictionInformationResponse = {\n  restrictionLevel: RestrictionLevel\n  hasUnmetAccessRequirement: boolean\n}\n","export enum ApprovalState {\n  APPROVED = 'APPROVED',\n  REVOKED = 'REVOKED',\n}\n\nexport interface AccessApproval {\n  id?: number //\tThe unique immutable ID\n  etag?: string //\tSynapse employs an Optimistic Concurrency Control (OCC) scheme to handle concurrent updates. Since the E-Tag changes every time an entity is updated it is used to detect when a client's current representation of an object is out-of-date.\n  createdOn?: string //\tThe date this object was created.\n  modifiedOn?: string //\tThe date this object was last modified.\n  createdBy?: string //\tThe user that created this object.\n  modifiedBy?: string //\tThe user that last modified this object.\n  requirementId: number //\tThe ID of the Access Requirement that this object approves.\n  requirementVersion?: number //\tThe version of the Access Requirement that this object approves.\n  submitterId: string //\tThe user who performed the necessary action(s) to gain this approval.\n  accessorId: string //\tThe ID of the principal (user or group) approved for access\n  expiredOn?: string //\tThe date this object will be expired.\n  state: ApprovalState //\tJSON enum for the state of AccessApproval\n}\n","// https://rest-docs.synapse.org/rest/org/sagebionetworks/repo/model/ObjectType.html\n\nexport enum ObjectType {\n    ENTITY = 'ENTITY',\n    ENTITY_CONTAINER = 'ENTITY_CONTAINER', \t\n    PRINCIPAL = 'PRINCIPAL',\t\n    ACTIVITY = 'ACTIVITY',\t\n    EVALUATION = 'EVALUATION',\t\n    SUBMISSION = 'SUBMISSION',\t\n    EVALUATION_SUBMISSIONS = 'EVALUATION_SUBMISSIONS',\t\n    FILE = 'FILE',\t\n    MESSAGE = 'MESSAGE', \n    WIKI = 'WIKI',\t\n    FAVORITE = 'FAVORITE',\t\n    ACCESS_REQUIREMENT = 'ACCESS_REQUIREMENT',\t\n    ACCESS_APPROVAL = 'ACCESS_APPROVAL',\t\n    TEAM = 'TEAM',\t\n    TABLE = 'TABLE',\t\n    ACCESS_CONTROL_LIST = 'ACCESS_CONTROL_LIST',\t\n    PROJECT_SETTING = 'PROJECT_SETTING',\t\n    VERIFICATION_SUBMISSION = 'VERIFICATION_SUBMISSION',\t\n    CERTIFIED_USER_PASSING_RECORD = 'CERTIFIED_USER_PASSING_RECORD',\t\n    FORUM = 'FORUM',\t\n    THREAD = 'THREAD',\t\n    REPLY = 'REPLY',\t\n    FORM_GROUP = 'FORM_GROUP',\t\n    FORM_DATA = 'FORM_DATA',\t\n    ENTITY_VIEW = 'ENTITY_VIEW',\t\n    USER_PROFILE = 'USER_PROFILE',\t\n    DATA_ACCESS_REQUEST = 'DATA_ACCESS_REQUEST',\t\n    DATA_ACCESS_SUBMISSION = 'DATA_ACCESS_SUBMISSION',\t\n    DATA_ACCESS_SUBMISSION_STATUS = 'DATA_ACCESS_SUBMISSION_STATUS',\t\n    MEMBERSHIP_INVITATION = 'MEMBERSHIP_INVITATION',\n}\n\n// https://rest-docs.synapse.org/rest/org/sagebionetworks/repo/model/dao/WikiPageKey.html\n\nexport type WikiPageKey = {\n    \n    wikiPageId: string\t//The ID of the wiki page.\n    ownerObjectId: string\t//The owner of this page.\n    ownerObjectType: ObjectType\t//JSON enum for the types of objects in Synapse.\n\n  }\n  ","module.exports = __webpack_public_path__ + \"static/media/study-active.bc52e72b.svg\";","module.exports = __webpack_public_path__ + \"static/media/study-complete.b012f80b.svg\";","module.exports = __webpack_public_path__ + \"static/media/DNA_Two.d8f80972.svg\";","module.exports = __webpack_public_path__ + \"static/media/organizations.67d2a8a1.svg\";","module.exports = __webpack_public_path__ + \"static/media/person.0d77b8e6.svg\";","module.exports = __webpack_public_path__ + \"static/media/mouse.4a97f235.svg\";","module.exports = __webpack_public_path__ + \"static/media/icon_plus.0e50c501.svg\";","module.exports = __webpack_public_path__ + \"static/media/icon_minus.e81d9a4f.svg\";","module.exports = __webpack_public_path__ + \"static/media/file-dotted.2dcc2eac.svg\";","module.exports = __webpack_public_path__ + \"static/media/json-form-tool-no-submissions.e64940c0.svg\";","module.exports = __webpack_public_path__ + \"static/media/brain.c6301611.svg\";","module.exports = __webpack_public_path__ + \"static/media/circle.ed6d433a.svg\";","module.exports = __webpack_public_path__ + \"static/media/mouse.7e294e96.svg\";","module.exports = __webpack_public_path__ + \"static/media/resiliencead.7500217a.svg\";"],"sourceRoot":""}