{"version":3,"sources":["lib/utils/functions/getEndpoint.ts","lib/assets/ButtonContent.tsx","lib/assets/GoogleIcon.tsx","lib/utils/SynapseConstants.ts","lib/utils/SynapseClient.ts","lib/containers/Login.tsx","lib/utils/functions/colorPalette.ts","lib/containers/ColorGradient.tsx","lib/utils/functions/facetUtils.ts","lib/containers/table/SynapseTableConstants.ts","lib/utils/functions/getUserData.ts","lib/containers/UserCardSmall.tsx","lib/containers/UserCardContextMenu.tsx","lib/containers/UserCardLarge.tsx","lib/assets/icons/IconCopy.tsx","lib/containers/UserCardMedium.tsx","lib/containers/UserCard.tsx","lib/containers/widgets/Bookmarks.tsx","lib/containers/widgets/SynapseImage.tsx","lib/containers/row_renderers/utils/CardFooter.tsx","lib/containers/row_renderers/utils/ChipContainer.tsx","lib/containers/row_renderers/utils/Icon.tsx","lib/assets/themed_icons/Publication.tsx","lib/assets/themed_icons/Study.tsx","lib/assets/themed_icons/ToolExperimental.tsx","lib/assets/themed_icons/ToolComputational.tsx","lib/assets/themed_icons/ToolClinical.tsx","lib/assets/themed_icons/Project.tsx","lib/containers/HeaderCard.tsx","lib/containers/row_renderers/utils/ShowMore.tsx","lib/utils/functions/unCamelCase.ts","lib/containers/GenericCard.tsx","lib/utils/functions/sqlFunctions.ts","lib/containers/widgets/SynapsePlot.tsx","lib/containers/MarkdownSynapse.tsx","lib/utils/functions/queryUtils.ts","lib/containers/QueryWrapper.tsx","lib/containers/StackedBarChart.tsx","lib/containers/HasAccess.tsx","lib/utils/functions/calculateFriendlyFileSize.ts","lib/utils/hooks/useGetInfoFromIds.ts","lib/containers/download_list/CreatePackage.tsx","lib/utils/functions/testDownloadSpeed.ts","lib/containers/download_list/DownloadDetails.tsx","lib/containers/download_list/DownloadListTable.tsx","lib/containers/widgets/ElementWithTooltip.tsx","lib/containers/download_list/DownloadConfirmation.tsx","lib/containers/EntityLink.tsx","lib/containers/ModalDownload.FormSchema.ts","lib/containers/ModalDownload.tsx","lib/containers/table/table-top/DownloadLoginModal.tsx","lib/containers/table/table-top/EllipsisDropdown.tsx","lib/containers/table/table-top/ExpandTable.tsx","lib/containers/table/table-top/DownloadOptions.tsx","lib/containers/table/table-top/ColumnSelection.tsx","lib/containers/table/table-top/FacetFilter.tsx","lib/containers/widgets/Range.tsx","lib/containers/widgets/RangeSlider.tsx","lib/containers/widgets/query-filter/RangeFacetFilter.tsx","lib/containers/widgets/query-filter/FacetFilterHeader.tsx","lib/containers/widgets/RadioGroup.tsx","lib/containers/widgets/Checkbox.tsx","lib/containers/widgets/query-filter/EnumFacetFilter.tsx","lib/containers/widgets/query-filter/QueryFilter.tsx","lib/containers/table/SynapseTable.tsx","lib/containers/synapse_form_wrapper/types.ts","lib/containers/QueryCount.tsx","lib/containers/row_renderers/Dataset.tsx","lib/containers/EntityForm.tsx","lib/containers/row_renderers/Funder.tsx","lib/containers/UserCardList.tsx","lib/containers/CardContainer.tsx","lib/containers/synapse_form_wrapper/Header.tsx","lib/containers/synapse_form_wrapper/StepsSideNav.tsx","lib/containers/synapse_form_wrapper/NavButtons.tsx","lib/containers/synapse_form_wrapper/DataDebug.tsx","lib/containers/synapse_form_wrapper/SummaryTable.tsx","lib/containers/synapse_form_wrapper/WarningModal.tsx","lib/containers/synapse_form_wrapper/SynapseForm.tsx","lib/containers/synapse_form_wrapper/SynapseFormWrapper.tsx","lib/containers/synapse_form_wrapper/SynapseFormSubmissionsGrid.tsx","lib/containers/CardContainerLogic.tsx","lib/containers/RssFeed.tsx","lib/containers/TwitterFeed.tsx","lib/containers/NewsFeedMenu.tsx","lib/containers/widgets/themes-plot/DotPlot.tsx","lib/containers/widgets/themes-plot/BarPlot.tsx","lib/containers/widgets/themes-plot/ThemesPlot.tsx","lib/containers/TotalQueryResults.tsx","lib/containers/Facets.tsx","lib/containers/Search.tsx","lib/containers/QueryWrapperMenu.tsx","lib/containers/access_requirement_list/AccessRequirementList.tsx","lib/containers/Uploader.tsx","lib/containers/FileContentDownloadUploadDemo.tsx","lib/containers/StatisticsPlot.tsx","demo/containers/Demo.tsx","demo/containers/playground/QueryWrapperMenuDemo.tsx","demo/containers/playground/CardContainerLogicDemo.tsx","demo/containers/playground/SearchDemo.tsx","demo/containers/playground/ModalDownloadDemo.tsx","demo/containers/playground/UserCardDemo.tsx","demo/containers/playground/MarkdownSynapseDemo.tsx","demo/containers/playground/NewsFeedDemo.tsx","demo/containers/playground/FormServicesIntegrationDemo.tsx","lib/containers/FacetsPlotNav.tsx","lib/containers/QueryWrapperPlotNav.tsx","demo/containers/playground/QueryWrapperPlotNavDemo.tsx","demo/containers/playground/WidgetDemo.tsx","lib/containers/access_requirement_list/SelfSignAccessRequirement.tsx","lib/containers/access_requirement_list/TermsOfUseAccessRequirement.tsx","demo/containers/playground/AccessRequirementDemo.tsx","lib/containers/TemplateComponent.tsx","demo/containers/playground/TemplateComponentDemo.tsx","demo/containers/playground/Playground.tsx","demo/containers/App.tsx","index.tsx","lib/utils/synapseTypes/EvaluationQueryTable/index.ts","lib/assets/icons/Data2.svg","lib/utils/synapseTypes/index.ts","lib/utils/synapseTypes/Download/index.ts","lib/utils/synapseTypes/Table/index.ts","lib/utils/synapseTypes/Table/ColumnType.ts","lib/utils/synapseTypes/AccessRequirement/index.ts","lib/utils/synapseTypes/AccessRequirement/AccessRequirement.ts","lib/utils/synapseTypes/BulkFileDownloadRequest.ts","lib/utils/synapseTypes/FileDownloadSummary.ts","lib/utils/synapseTypes/FileHandleAssociation.ts","lib/utils/synapseTypes/Forms.ts","lib/utils/synapseTypes/RestrictionInformation.ts","lib/utils/synapseTypes/AccessApproval.ts","images/logo.svg","lib/assets/icons/study-active.svg","lib/assets/icons/study-complete.svg","lib/assets/icons/DNA_Two.svg","lib/assets/icons/expand.svg","lib/assets/icons/shrink.svg","lib/assets/icons/columns.svg","lib/assets/icons/file-dotted.svg","lib/assets/icons/json-form-tool-no-submissions.svg","demo/containers/playground/icons/brain.svg","demo/containers/playground/icons/circle.svg","demo/containers/playground/icons/mouse.svg","demo/containers/playground/icons/resiliencead.svg"],"names":["BackendDestinationEnum","children","style","paddingRight","fontWeight","paddingLeft","icon","paddingTop","paddingBottom","textAlign","width","active","background","borderRadius","height","xmlns","fill","fillRule","d","BUNDLE_MASK_QUERY_RESULTS","BUNDLE_MASK_QUERY_COUNT","BUNDLE_MASK_QUERY_SELECT_COLUMNS","BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE","BUNDLE_MASK_QUERY_COLUMN_MODELS","BUNDLE_MASK_QUERY_FACETS","BUNDLE_MASK_SUM_FILES_SIZE_BYTES","ENTITY_BUNDLE_MASK_ENTITY","ENTITY_BUNDLE_MASK_ANNOTATIONS","ENTITY_BUNDLE_MASK_PERMISSIONS","ENTITY_BUNDLE_MASK_ENTITY_PATH","ENTITY_BUNDLE_MASK_HAS_CHILDREN","ENTITY_BUNDLE_MASK_ACL","ENTITY_BUNDLE_MASK_FILE_HANDLES","ENTITY_BUNDLE_MASK_TABLE_DATA","ENTITY_BUNDLE_MASK_ROOT_WIKI_ID","ENTITY_BUNDLE_MASK_BENEFACTOR_ACL","ENTITY_BUNDLE_MASK_DOI","ENTITY_BUNDLE_MASK_FILE_NAME","ENTITY_BUNDLE_MASK_THREAD_COUNT","ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION","STUDY","VALUE_NOT_SET","STUDY_ACTIVE","STUDY_COMPLETE","DATASET","AMP_CONSORTIUM","FUNDER","PUBLICATION","TOOL","GENERIC_CARD","COMPUTATIONAL","EXPERIMENTAL","CLINICAL","PROJECT","PAGE_SIZE","SMALL_USER_CARD","MEDIUM_USER_CARD","LARGE_USER_CARD","SEPERATOR","AUTHENTICATED_USERS","_TIME_DELAY","SRC_SIGN_IN_CLASS","PRODUCTION_ENDPOINT_CONFIG","REPO","PORTAL","getEndpoint","endpoint","endpoint_config","window","SRC","OVERRIDE_ENDPOINT_CONFIG","Error","PORTAL_ENDPOINT","cookies","UniversalCookies","IS_OUTSIDE_SYNAPSE_ORG","location","hostname","toLowerCase","includes","SESSION_TOKEN_COOKIE_KEY","AUTH_PROVIDER","SYNAPSE_STORAGE_LOCATION_ID","getRootURL","portString","port","protocol","delay","t","Promise","resolve","setTimeout","bind","retryFetch","url","options","delayMs","then","fetchWithExponentialTimeout","retries","fetch","resp","status","text","json","JSON","parse","ok","reject","error","catch","reason","doPost","requestJsonObject","sessionToken","initCredentials","body","stringify","headers","Accept","method","mode","credentials","usedEndpoint","doGet","doDelete","undefined","doPut","putRefreshSessionToken","REPO_ENDPOINT","getVersion","addFilesToDownloadList","request","updateParentState","requestUrl","token","getAsyncResultFromJobId","getDownloadFromTableRequest","entityId","getFileHandleById","handleId","getFileHandleByIdURL","urlRequest","jobState","asyncJobStatus","getQueryTableResults","queryBundleRequest","getFullQueryTableResults","a","async","maxPageSize","offset","query","rest","queryRequest","limit","response","data","isDone","queryResult","queryResults","rows","length","push","login","username","password","authenticationReceipt","oAuthUrlRequest","provider","redirectUrl","oAuthSessionRequest","authenticationCode","createEntity","entity","createProject","name","concreteType","getUserProfile","getUserProfileById","ownerId","getUserBundle","id","mask","getGroupHeadersBatch","ids","join","getUserProfiles","list","getEntityChildren","lookupChildEntity","getFiles","getBulkFiles","bulkFileDownloadRequest","asyncJobId","err","console","getEntity","versionNumber","getEntityHeader","references","updateEntity","deleteEntity","getEntityBundleForVersion","version","partsMask","getEntityWiki","wikiId","getUserFavorites","getUserTeamList","getTeamList","fragment","getWikiAttachmentsFromEntity","getWikiAttachmentsFromEvaluation","setSessionTokenCookie","sessionCallback","set","maxAge","remove","_","getSessionTokenFromCookie","get","getPrincipalAliasRequest","alias","type","detectSSOCode","redirectURL","code","URL","href","searchParams","synToken","originalUrl","localStorage","getItem","removeItem","replace","signOut","uploadFile","filename","file","fileUploadResolve","fileUploadReject","partSize","Math","max","size","contentType","fileName","fileSizeBytes","partSizeBytes","storageLocationId","calculateMd5","md5","contentMD5Hex","startMultipartUpload","fileBlob","blobSlice","File","prototype","slice","chunks","ceil","spark","SparkMD5","ArrayBuffer","fileReader","FileReader","currentChunk","onload","e","log","append","result","loadNext","end","info","onerror","warn","start","readAsArrayBuffer","call","processFilePart","partNumber","multipartUploadStatus","clientSidePartsState","uploadId","presignedUploadUrlRequest","partNumbers","presignedUrlUrl","presignedUrlResponse","presignedUrl","partPresignedUrls","uploadPresignedUrl","startByte","endByte","fileSlice","uploadFilePart","addPartUrl","addPartResponse","addPartState","checkUploadComplete","fileHandleName","every","v","newStatus","fileHandleId","resultFileHandleId","partsState","split","map","bit","i","getFileEntityContent","fileEntity","fileHandleAssociationList","associateObjectId","associateObjectType","dataFileHandleId","includeFileHandles","includePreSignedURLs","includePreviewPreSignedURLs","requestedFiles","preSignedURL","fileHandle","getFileHandleContent","content","getFileEntityFileHandle","FileHandleAssociateType","FileEntity","getFileHandleContentFromID","getFileHandleByIdPromise","getFileHandlePresignedUrlPromis","all","values","contentSize","cache","createACL","acl","submitToEvaluation","submission","etag","getEvaluation","evalId","getEvaluationSubmissions","encodeURI","getOAuth2RequestDescription","oidcAuthRequest","hasUserAuthorizedOAuthClient","getOAuth2Client","clientId","consentToOAuth2Request","createFormGroup","getFormACL","formGroupId","updateFormACL","newAcl","createFormData","newFormData","updateFormData","formDataId","updatedFormData","deleteFormData","submitFormData","listFormData","listFormDataAsFormAdmin","acceptFormData","rejectFormData","formRejection","getProjectStatistics","getRestrictionInformation","getAccessRequirement","getAllAccessRequirements","getAllOfPaginatedService","postAccessApproval","accessApproval","getDownloadList","getDownloadOrder","zipFileName","baseURL","fn","existsMoreData","results","deleteDownloadListFiles","deleteDownloadList","Login","props","authenticationReceiptKey","state","email","errorMessage","hasLoginInFailed","isSignedIn","handleChange","handleLogin","getLoginFailureView","onGoogleSignIn","event","target","currentTarget","value","newState","this","setState","clickEvent","preventDefault","SynapseClient","setItem","className","googleRedirectUrl","authUrl","authorizationUrl","theme","googleTheme","onClick","GoogleIcon","key","ButtonContent","marginRight","alt","src","onSubmit","autoComplete","placeholder","onChange","React","COLOR_PALETTE_EVEN","COLOR_PALETTE_ODD","getColorPallette","colorPalleteSelection","textColors","colorPalette","textColor","color","getIsValueSelected","isLoading","lastFacetSelection","curFacetSelection","columnName","facetValue","isSelected","selector","SELECT_SINGLE_FACET","readFacetValues","htmlCheckboxes","facet","facetValues","checkbox","checked","newQueryRequest","selectedFacets","specificFacet","find","el","facetColumnValuesRequest","ICON_STATE","getUserProfileWithProfilePicAttached","principalIds","withProfilePic","filter","profilePicureFileHandleId","fileHandleList","forEach","matchingPersonIndex","findIndex","clientPreSignedURL","getUserProfileWithProfilePic","userProfile","firstElement","COLORS","getColor","userName","hashedUserName","val","reduce","prevHash","currVal","charCodeAt","abs","hash","library","add","faCircle","UserCardSmall","img","marginLeft","hideText","hideTooltip","link","linkLocation","label","displayName","firstName","lastName","position","backgroundImage","data-for","data-tip","delayShow","multiline","whiteSpace","UserCardContextMenu","menuActions","aria-labelledby","menuAction","index","callback","field","listStyle","onKeyPress","UserCardLarge","summary","industry","faEllipsisV","faCopy","svg","viewBox","UserCardMedium","htmlDivRef","copyToClipboard","document","createElement","setAttribute","left","current","appendChild","select","execCommand","removeChild","showModal","toggleContextMenu","_event","isContextMenuOpen","pageClick","addEventListener","removeEventListener","isLarge","hideEmail","disableLink","company","mediumCard","classNames","timeout","enter","exit","tabIndex","ref","IconCopy","outline","fixedWidth","padding","boxShadow","border","UserCard","aliasData","principalId","userProfileAtRender","preSignedURLAtRender","loadingScreen","propsForChild","SynapseConstants","Bookmarks","renderBookmarks","matchedGroup","copyFootnotes","String","footnotes","regex","output","exec","isBeforeLastElement","dangerouslySetInnerHTML","__html","SynapseImage","getSynapseFiles","synapseId","fileResults","WikiAttachment","params","align","alignLowerCase","faLongArrowAltUp","faLongArrowAltDown","URL_REGEX","CardFooter","renderRowValue","textColorClass","isHeader","match","DOI_REGEX","data-search-handle","rel","renderRows","isDesktop","kv","hideClass","isShowMoreOn","toggleShowMore","updatePredicate","innerWidth","secondaryLabelLimit","valuesFiltered","hasMoreValuesThanLimit","Infinity","margin","ChipContainer","chipsFormatted","chips","defaultIcons","Data2Svg","DNA_TwoSvg","studyActiveSvg","studyCompleteSvg","clipPath","clipRule","transform","Icon","iconOptions","iconSet","datasetIconClass","HeaderCard","title","subTitle","description","iconValue","backgroundColor","isAlignToLeftNav","descriptionLinkConfig","descriptionElement","querySelector","useState","docTitle","getAttribute","docDescription","useEffect","markdown","borderTop","marginTop","unCamelCase","str","toUpperCase","SYNAPSE_REGX","GenericCard","getCutoff","previewText","summarySplit","trim","hasClickedShowMore","renderTitleLink","renderLabel","renderLongDescription","renderShortDescription","titleLink","schema","linkDisplay","matchColumnName","URLColumnName","indexInData","labelLink","isMarkdown","renderInline","genericCardSchema","selectColumns","titleLinkConfig","labelLinkConfig","facetAliases","genericCardSchemaDefined","linkValue","secondaryLabels","selectedColumnOrUndefined","isMultiValue","columnType","columnDisplayName","keyValue","showFooter","marginBottom","titleSearchHandle","stubTitleSearchHandle","descriptionSubTitle","show","fontSize","cursor","GROUP_BY_REGEX","isGroupByInSql","sql","test","generateTokenUsingOperator","literal","operator","usedMatchForLike","substring","insertConditionsFromSearchParams","tokens","lexer","tokenize","foundIndex","whereClauseIndex","indexAfterWhereClause","splice","searchParamsLen","Object","keys","unshift","formatSQLFromParser","synId","newSql","parser","toString","splitString","parseEntityIdFromSqlStatement","matches","substr","resultToJson","headerColumns","rowColumns","row","column","cellIndex","Plot","createPlotlyComponent","Plotly","SynapsePlot","isLoaded","queryData","fetchPlotlyData","showPlot","widgetparamsMapped","partMask","xtitle","ytitle","xaxistype","showlegend","isHorizontal","horizontal","layout","xaxis","yaxis","plotData","orientation","x","y","j","rowValues","TOC_CLASS","1","2","3","4","5","6","md","markdownit","html","MarkdownSynapse","markupRef","markdownitSynapse","init_markdown_it","markdownitSub","markdownitSup","markdownitCentertext","markdownitSynapseHeading","markdownitSynapseTable","markdownitStrikethroughAlt","markdownitContainer","markdownitEmphasisAlt","markdownitInlineComments","markdownitBr","use","markdownitMath","fileHandles","handleLinkClicks","renderMarkdown","recursiveRender","processMath","getWikiAttachments","getWikiPageMarkdown","renderWidget","renderSynapseButton","renderSynapseImage","renderSynapsePlot","renderSynapseTOC","getErrorView","createHTML","addBookmarks","addIdsToReferenceWidgets","addIdsToTocWidgets","genericElement","tagName","anchor","referenceNumber","Number","goTo","scrollIntoView","behavior","block","inline","idOfContent","initText","render","sanitizeHtml","allowedAttributes","button","div","h1","h2","h3","h4","h5","h6","li","ol","span","table","th","thead","ul","allowedTags","querySelectorAll","element","textContent","katex","throwOnError","resetFootnotes","footnotesHtml","wikiPage","errorMessageView","ErrorView","referenceCount","tocIdCount","curTocId","markup","DOMParser","parseFromString","nodeType","Node","TEXT_NODE","ELEMENT_NODE","HTMLElement","widgetParams","processHTMLWidgetMapping","attributes","attribute","item","childNodes","Array","from","xml","escapedOneToXmlSpecialMap","originalMarkup","decodedWidgetParams","decodeXml","questionIndex","indexOf","widgetType","keyPair","decodeURIComponent","reactKey","renderUserBadge","buttonClasses","highlight","role","elements","p1","p2","p3","p4","data-anchor","prevProps","bookmarks","getNextPageOfData","newData","oldData","cloneDeep","hasMoreData","QueryWrapper","executeInitialQueryRequest","executeQueryRequest","getLastQueryRequest","getInitQueryRequest","initialState","loadNow","loadNowStarted","initQueryRequest","lastQueryRequest","isLoadingNewData","chartSelectionIndex","isAllFilterSelectedForFacet","facets","facetType","isAllFalse","isAllTrue","isByDefaultSelected","sort","b","count","update","childrenWithProps","child","queryWrapperChildProps","rgbIndex","unitDescription","showBarChart","loadingCusrorClass","defaultProps","faAngleLeft","faAngleRight","ExternalFileHandleConcreteTypeEnum","GoogleCloudFileHandleEnum","StackedBarChart","handleClick","dict","handleArrowClick","direction","extractPropsData","handleHover","handleExit","getTextForChartSelection","onMeasureResize","dimensions","bounds","top","right","bottom","xData","facetValueDisplay","filterDisplay","progressMessage","total","hasOwnProperty","originalColor","onResize","contentRect","measureRef","obj","rectStyle","rgbColor","svgWidth","tooltipId","numCharsInValue","svgHeight","onMouseEnter","onMouseLeave","textAnchor","fontFamily","getFileCount","linkText","faUnlockAlt","faDatabase","FileHandleDownloadTypeEnum","GIGABYTE_SIZE","getDownloadTypeForFileHandle","isInDownloadList","Accessible","TooLarge","GoogleCloudFileHandle","ExternalCloudFile","ExternalFileLink","HasAccess","entityVersionNumber","fileHandleDownloadType","updateStateFileHandleAccessBlocked","NoFileHandle","AccessBlocked","AccessBlockedToAnonymous","restrictionInformation","restrictableObjectType","RestrictableObjectType","ENTITY","objectId","renderIconHelper","iconProp","classColor","renderIcon","downloadType","hasUnmetAccessRequirement","faLock","faLink","renderARsLink","restrictionLevel","RestrictionLevel","OPEN","tooltipText","viewARsLink","place","effect","sufixes","calculateFriendlyFileSize","bytes","floor","pow","toFixed","UserProfileTemplate","entityHeaderTemplate","versionLabel","benefactorId","createdOn","modifiedOn","createdBy","modifiedBy","getEntityHeaderItems","lookupList","notFound","targetId","notFoundPlaceholders","getUserProfileItems","useGetInfoFromIds","setData","idProp","curList","incomingList","newValues","without","newIds","newReferences","newReferencesChunks","chunk","concat","getData","faCheck","faDownload","faFolder","CreatePackage","setIsLoading","setZipFileName","message","variant","alert","setAlert","bulkFileDownloadResponse","setBulkFileDownloadResponse","updateDownloadList","createPackageHandler","fileNameWithZipExtension","downloadOrder","files","zipFileFormat","ZipFileFormat","Flat","transition","resultZipFileHandleId","fileSummary","numfilesDownloaded","FileDownloadStatus","SUCCESS","testDownloadSpeed","cachedSpeedExpireTime","cachedSpeed","Date","getTime","startMs","now","DownloadDetails","downloadSpeed","numFiles","numBytes","speed","timeEstimateInSeconds","friendlyTime","moment","duration","humanize","isInactive","iconClassName","faFile","faClock","faTrash","DownloadListTable","batchFileResult","downloadList","fileBeingDeleted","setFileBeingDeleted","userProfiles","fetchData","filesToDownload","invokeDownloadListUpdatedEvent","batchFileRequest","referenceCall","batchFile","failureCode","listUpdatedCallback","responsive","isCurrentlyBeingDeletedClass","fileResult","fileRes","canDownload","format","req","deleteFileFromList","StatusEnum","ElementWithTooltip","tooltipTrigger","image","idForToolTip","callbackFn","imageColor","tooltipVisualProps","tooltipTriggerContents","svgImg","altText","getTooltipTriggerContents","outerChild","cloneElement","aria-label","Dropdown","Toggle","getFilesInformation","queryBundleRequestSizeInformation","queryCount","sumFileSizes","estimatedDownloadBytesPerSecond","durationSeconds","fileCount","fileSize","downloadEstimate","INFO","addToDownload","ERROR","StatusConstruct","infoText","closeText","PROCESSING","LOADING_INFO","DownloadConfirmation","fnClose","getContent","faListAlt","faTable","faThList","faArchive","EntityTypeIcon","splitType","iconType","getIconTypeForEntity","EntityLink","entityHeader","csvOption","formSchemaArray","properties","oneOf","const","Contents","items","enum","uniqueItems","formSchemaUIArray","faTimes","ModalDownload","handleSubmit","step","handleDownloadSetup","onDownload","formData","fileType","contents","onClose","separator","writeHeader","includeRowIdAndRowVersion","downloadFromTableRequest","csvTableDescriptor","resultsFileHandleId","Modal","animation","centered","onHide","Header","zIndex","uiSchema","backgroundSize","DownloadLoginModal","ModalHeader","closeButton","ModalBody","ModalFooter","Button","EllipsisDropdown","onDownloadFiles","onDownloadTableOnly","onShowColumns","onFullScreen","isExpanded","setShowModal","Menu","alignRight","isGroupedQuery","isFileView","Item","isUnauthenticated","Divider","ExpandTable","onExpand","ShrinkSvg","ExpandSvg","DownloadOptions","onExportMetadata","ColumnSelection","isColumnSelected","visibleColumnCount","onToggle","toggleColumnSelection","metadata","ColumnsSvg","header","isCurrentColumnSelected","iconStyle","visibility","maybeShowPrimaryColor","FacetFilter","overflowY","maxHeight","_show","source","facetColumnResult","applyChanges","allRef","click","facetColumnResultValueCount","displayValue","isValueSelected","inputRef","Range","setError","initialValues","min","setValues","isValid","display","flexWrap","callBackFn","handleAppyChanges","errorText","Handle","domain","handle","percent","getHandleProps","aria-valuemin","aria-valuemax","aria-valuenow","Track","getTrackProps","Tick","tick","getInitialValues","RadioValuesEnum","RangeSlider","doUpdateOnApply","stringArrToNumArr","inputArr","numDomain","ticksCount","maxTickCount","handleSliderChange","getRailProps","handles","tracks","ticks","FacetFilterHeader","isCollapsed","RadioGroup","option","RangeFacetFilter","facetResult","columnModel","setIsCollapsed","NOT_SET","ANY","RANGE","columnMin","columnMax","selectedMin","selectedMax","hasAnyValue","rangeType","radioValue","setRadioValue","onChangeCallback","handleRadioGroupChange","Checkbox","setChecked","valueToLabel","profiles","entityHeaders","profile","eh","EnumFacetFilter","onClear","isShowAll","setIsShowAll","visibleItemsCount","formatFacetValuesForDisplay","isChecked","convertFacetToFacetColumnValuesRequest","patchRequestFacets","changedFacet","lastRequest","selections","changedFacetIndex","isEmptyValuesFacet","applyChangesToValuesColumn","onChangeFn","facetName","applyChangesToRangeColumn","convertFacetColumnRangeRequest","QueryFilter","columnModels","model","EMPTY_HEADER","faColumns","faSort","faSortAmountUp","faSortAmountDown","faFilter","faCog","faUsers","faGlobeAmericas","StepStateEnum","NavActionEnum","SORT_STATE","SynapseTable","showGroupRowData","selectedRow","queryCopy","parsed","getSqlUnderlyingDataForRow","queryJSON","encodedQuery","btoa","renderDropdownDownloadOptions","partialState","isModalDownloadOpen","showDownload","renderColumnSelection","showColumnSelection","onToggleColumnSelectionShow","renderTable","pastZero","showAccessColumn","zeroMarginRight","nextBtn","handlePaginationClick","previousBtn","isShowingAccessColumn","rowId","minHeight","isDownloadConfirmationOpen","createTableHeader","createTableRows","renderTableTop","enableLeftFacetFilter","onDownloadTableOnlyArguments","onExpandArguments","isShowLeftFilter","advancedSearch","eventType","currentOffset","handleColumnSortPress","columnIconSortState","getLengthOfPropsData","sortedColumnSelection","findSelectionIndex","defaultSelection","lengthOfPropsData","applyChangesFromQueryFilter","isUserModifiedQuery","configureFacetDropdown","mapEntityIdToHeader","mapUserIdToHeader","getEntityHeadersInData","getColumnIndiciesWithType","getTableConcreteType","currentTableId","tableId","previousTableId","entityData","entityIdColumnIndicies","userIdColumnIndicies","distinctEntityIds","getUniqueEntities","distinctUserIds","referenceList","userPorfileIds","isIndividual","mapIdToHeader","indicies","distinctEntities","Set","colIndex","columnTypes","columnsOfTypeEntity","NoData","fontStyle","frontText","newFacets","dialogClassName","Body","originalSql","indexes","selectIndex","fromIndex","columnIndex","columnReferences","foundFunctionForColumn","toLocaleLowerCase","rowValue","pop","rowsFormatted","entityColumnIndicies","userColumnIndicies","dateColumnIndicies","dateListColumnIndicies","booleanListColumnIndicies","otherListColumnIndicies","isColumnSelectedLen","countColumnIndexes","getCountFunctionColumnIndexes","markdownColumns","rowIndex","rowContent","columnValue","isMarkdownColumn","isColumnActiveInitLoad","isColumnActivePastInitLoad","isCountColumn","isBold","renderTableCell","rowSynapseId","rowFormatted","jsonData","toLocaleString","longString","maxCharCount","getShortString","displayString","noop","usedVisibleColumnCount","tableColumnHeaderElements","initRender","subsequentRender","facetIndex","isFacetSelection","isSelectedIconClass","sortSpanBackgoundClass","displayColumnName","synTable","open","enableDownloadConfirmation","facetColumnResults","QueryCount","storedSqlQueryCount","isCalculatingQueryCountForSql","calculateRowCount","Dataset","handleLinkClick","datasetName","tumorType","diseaseFocus","fundingAgency","Funder","organizationName","organizationPath","website","logoHref","logo","orgPath","origin","websiteDisplayName","charAt","showOrgLink","isOnOrgPath","UserCardList","userProfileMap","priorListOfIds","newEntries","firstNameIndex","lastNameIndex","institutionIndex","fauxUserProfilesList","manuallyExtractData","fauxUserProfileIndex","fauxUserProfile","CardContainer","renderCard","handleViewMore","cards","showViewMore","showViewMoreButton","userIdColumnIndex","listIds","rowData","propsForCard","bodyText","isSubmitted","StepsSideNav","nonChildSteps","stepList","getIcon","isExcluded","isStatic","isSubmit","iconDef","flip","faBan","COMPLETED","faCheckCircle","faExclamationCircle","getItemClass","isInProgress","liClassName","getListItem","isWizard","isRenderChild","renderStepName","inProgress","final","excluded","static","itemClass","onStepChange","flex","isWizardMode","stepChildId","childStep","NavButtons","previousButton","previousStepIds","steps","currentStep","canGoBack","onNavAction","PREVIOUS","faChevronLeft","nextButton","NEXT","faChevronRight","saveButton","disabled","isFormSubmitted","SAVE","NextStepLink","nextStep","nextStepId","DataDebug","myData","hidden","findLabel","regex1","propArr","labelFromSchema","labelFromUi","arrayLabelFromSchema","arrayLabelFromUiSchema","indexMatch","first","isNaN","parseInt","SummaryTable","flatFormData","flatData","flatten","object","flattenedObject","prefix","isArray","isString","isObject","prevVal","isDate","boundary","screen","order","getFlatData","prevScreenId","line","print","WarningModal","onCancel","Title","copy","Footer","onOK","callbackArgs","confirmCopy","SynapseForm","excludeWarningText","excludeWarningHeader","unsavedDataWarning","formRef","formDivRef","navAction","NONE","extraErrors","isNewForm","getFirstStep","onUnload","ev","hasUnsavedChanges","returnValue","setupBeforeUnloadListener","_setIncludedPropInFormDataNonWizard","currentState","schemaScreens","currentStateFormData","_setIncludedPropInFormDataWizard","firstStepId","newStateData","getSchema","pick","getNextStepId","rules","default","engine","Engine","run","events","next","moveStep","isError","previousStack","errorSchema","isMoveForwardInWizardMode","currentStepState","TODO","included","saveStepState","hasValidated","doShowErrors","goPrevious","previousStepId","isSubmitScreen","currentIndex","isUndefined","triggerAction","onSave","runCustomValidation","submit","triggerStepChange","GO_TO_STEP","onError","args","VALIDATE","modifiedSteps","setStepStatusForFailedValidation","scrollTo","isLoadingSaved","errors","currentSchemaProperties","stepsWithError","trimStart","property","stepsInCurrentSchema","performAction","showExcludeStateWarningModal","stepId","isUpdateFlattenedData","modalContext","action","toggleExcludeStep","arguments","isExclude","prevState","stp","formDataUpdated","renderNotification","SAVE_SUCCESS","SUBMIT_SUCCESS","PROGRESS","renderTextForStaticScreen","renderOptionalFormSubheader","renderHelpToggle","showHelp","checkedIcon","uncheckedIcon","offColor","allSteps","validationRules","acc","allRules","rule","paramProp","path","newRule","allowUndefinedFacts","stack","transformErrors","extraError","SUBMIT","parentPath","lastIndexOf","renderErrorListTemplate","currentLis","propPath","arrayLabelFromUI","renderTransformedErrorObject","stringToElementForProp","srcObject","some","k","navSchema","doShowHelp","shouldUpdate","callbackStatus","isSuccess","history","back","isEqual","hasError","when","formTitle","liveValidate","handleOnChange","form","showErrorList","ErrorList","screenId","formClass","SynapseFormWrapper","getFileEntityData","entityContent","newError","getFileEntityDataDereferenced","$RefParser","dereference","derefContent","formSchemaVersion","uiSchemaVersion","navSchemaVersion","submitted","fileData","promises","formSchemaEntityId","formUiSchemaEntityId","formNavSchemaEntityId","configData","formSchema","formUiSchema","formNavSchema","finishedProcessing","notification","submitForm","saveToFile","createOrUpdateFormDataFile","fileContentsBlob","fileUploadComplete","newFileHandleId","fileNamePath","errorTitle","searchString","fileContent","Blob","isReadyToDisplayForm","ERROR_CRITICAL","renderLoader","Alert","Heading","renderUnauthenticatedView","SynapseFormSubmissionGrid","modalTitle","listingText","subhead","noRecords","modalCopy","getTypeFileListing","nextPageToken","groupId","cleanUpName","filterByState","fileList","page","getMore","fileListType","statusList","requestFilter","SUBMITTED","IN_PROGRESS","getUserFileListing","deleteFile","setModalConfirmationState","renderLoading","renderSubmissionsTable","pathpart","textSource","tableTitleRow","viewMore","dataFileRecord","calendar","aria-hidden","submissionStatus","isShowInfoModal","faPhone","renderSubmissionsTables","NoSubmissionsIcon","refresh","itemNoun","WAITING_FOR_SUBMISSION","SUBMITTED_WAITING_FOR_REVIEW","ACCEPTED","REJECTED","CardContainerLogic","defaultState","prevSearchParams","currentSearchParams","hasSearchParamsChanged","hasTokenBeenAquired","hasSqlChanged","sqlUsed","sqlOperator","isConsistent","queryRequestWithoutCount","totalResultsNoFacet","rssParser","Parser","RssFeed","_isMounted","onToggleReadMore","itemId","feedItemContentDiv","getElementById","itemId2MoreItem","isShow","foundMoreItem","classList","newText","newIcon","onClickShowMoreItems","isShowingMoreItems","rssFeed","isLoadingError","responseData","parseString","rss","parsedHtml","bodyElement","moreElement","foundMoreElement","isItemVisible","defaultItemsToShow","showMoreText","showMoreIcon","guid","documentElement","innerHTML","TwitterFeed","twttr","widgets","load","data-height","data-theme","NewsFeedMenu","getMenuIndex","menuIndex","menuConfig","config","feedKeyValue","menuDropdown","renderMenu","feedName","feedDescription","feedUrl","mailChimpUrl","twitterFeedUrl","mailChimpListName","modifiedFeedUrl","getOwnPropertyNames","routeToNewsFeed","selectedStyling","urlParams","URLSearchParams","search","to","pathname","getLayout","dotPlotLayoutConfig","layoutOptions","plot_bgcolor","showticklabels","range","maxValue","visible","isXAxis","isLegend","l","r","pad","zeroline","showgrid","showline","createArrayOfGroupValues","getPlotDataPoints","graphItems","plotStyle","ySorted","markerSymbols","isFakeData","groups","uniq","group","defaultSymbols","hovertemplate","marker","markerFill","markerLine","symbol","markerSize","DotPlot","optionsConfig","layoutConfig","xMax","pointsTypes","getBarPlotDataPoints","colors","defaultColors","isTop","paper_bgcolor","hoverlabel","font","BarPlot","displayModeBar","scrollZoom","editable","autosizable","dragmode","legend","xanchor","fixedrange","linecolor","autotick","tickcolor","gridcolor","automargin","hovermode","barLayoutConfig","barmode","xField","yField","groupField","whereClause","infoField","getTotalsByProp","prop","resultObject","res","getClickTargetData","swap","pointData","points","fadeColors","opacity","ThemesPlot","dotPlot","topBarPlot","sideBarPlot","tooltipProps","onPointClick","dotPlotYAxisLabel","setIsLoaded","dotPlotQueryData","setDotPlotQueryData","topBarPlotData","setTopBarQueryData","sideBarPlotData","setSideBarQueryData","dotPlotData","xLabels","yLabelsForDotPlot","xLabelsForTopBarPlot","xMaxForDotPlot","xMaxForSideBarPlot","topBarPlotDataSorted","totalsByDotPlotY","orderBy","staticPlot","float","countLabel","TotalQueryResults","calculateTotal","faPlus","CheckboxGroup","showAllFacets","isAllFilterSelected","facetColumnResultValues","curColor","backgroundClass","childrenView","Facets","showButtons","curFacetsLength","curFacetsIndex","curFacet","showFacetFilter","faCaretDown","faCaretUp","faSearch","Search","toggleDropdown","setDropdownIndex","focus","dropdownIndex","highlightText","submittedSearchText","searchable","isQueryWrapperMenuChild","searchItem","outerHTML","innerText","searchItemView","SEARCH_CLASS_CSS","textElement","RegExp","clearSearchText","searchText","lastQueryRequestDeepCopy","addEscapeCharacters","lastSearchedFacet","searchableItem","fieldStyle","alignItems","curFacetDisplayText","lastSearchedFacetDisplayText","usedUnitDescription","borderRight","justifyContent","onSelect","hintText","escapedSearchText","SUPPORTED_ACCESS_REQUIREMENTS","QueryWrapperMenu","handleHoverLogic","contains","switchFacet","menuIndexIn","accordionIndexIn","activeMenuIndices","isClickingCurrentSelection","accordionGroupIndex","toggleGroupAccordionIndex","accordionGroupIndexIn","accordionConfig","facetIndexFromFacetSearchParam","indexFromURLOrDefaultZero","getUnitDescription","getPartMask","getSelectedFacets","getSqlWithAdditionalClause","getTableLoadingScreen","_prevState","stackedBarChartConfiguration","globalQueryCountSql","hasGroupByInSql","renderMenuDropdown","queryWrapper","renderQueryChildren","queryConfig","groupIndex","cardConfiguration","tableConfiguration","searchConfiguration","facetValueFromSearchParams","showSearch","aliasedFacet","searchClass","isSelectedFromURL","tableLoadingScreen","isAccordionConfigDefined","renderQueryChild","isActive","primaryColor","indicatorClasses","borderTopColor","hoverEnter","hoverLeave","component","appear","renderFacetMenu","curLevel","defaultColor","searchIconStyle","isSearchConfig","borderLeftColor","infoEnter","infoLeave","facetDisplayValue","Uploader","inputOpenFileRef","showOpenFileDlg","handleFilesChanged","finishedProcessingOneFile","incrementedFilesUploadedCount","filesUploadedCount","isStillUploading","totalFilesToUploadCount","isUploading","successfullyUploaded","handleUploadError","selectorFiles","newFileEntity","parentId","parentContainerId","entityLookupRequest","entityName","existingEntity","updateEntityFile","isCreate","multiple","FileContentDownloadUploadDemo","updateFileContent","targetEntity","newFileContent","handleContentChange","targetEntityId","months","StatisticsPlot","getTrace","traceName","stats","markerColor","trace","statPoint","statPointDate","rangeStart","getUTCMonth","getUTCFullYear","filesCount","traces","fileDownloads","fileUploads","displaylogo","modeBarButtonsToRemove","useResizeHandler","Demo","entityFormRef","showMarkdown","showTabOne","tabOne","tabTwo","onRunDownloadSpeedTest","userFormDataSynId","QueryWrapperMenuDemo","experimentalSql","computationalSql","activeTab","tabFour","tabThree","grant","removeHandler","updatedState","CardContainerLogicDemo","circleSvg","brainSvg","mouseSvg","resilienceadSvg","Program","SearchDemo","contributor","diagnosis","ModalDownloadDemo","onOpen","UserBadgeSmallDemo","_el","MarkdownSynapseDemo","markdownPropsArray","NewsFeedDemo","FormServicesIntegrationDemo","listMyFormData","formGroup","myFormDataList","listFormAdminFormData","formAdminFormDataList","onReadFormDataFileHandleContents","onCreateFormGroup","onCreateFormData","onUpdateFormData","onSubmitFormData","TokenContext","Consumer","rejectionMessage","FacetsPlotNav","plotPointData","facetValueClicked","facetEnumerationValues","pointNumber","isResetPossible","isShowingMore","extractPlotDataArray","onReset","showMoreButton","resetButton","plotDataToShow","rowCount","grid","columns","annotations","facetsToPlot","enumerationFacets","singlePieChartData","labels","textposition","textinfo","pull","QueryWrapperPlotNav","QueryWrapperPlotNavDemo","tableProps","WidgetDemo","check1","setCheck1","check2","setCheck2","optionValue","setOptionValue","rangeNumberValue","setRangeNumberValue","toISOString","rangeDateValue","setRangeDateValue","rangeSliderValue","setRangeSliderValue","topBarPlotProps","sideBarPlotProps","tools","datasets","publications","SelfSignAccessRequirement","accessRequirement","TermsOfUseAccessRequirement","AccessRequirementList","accessRequirements","setAccessRequirements","incomingAccessRequirements","prevAcessRequirements","getAccessRequirements","renderAccessRequirement","AccessRequirementDemo","TemplateComponent","userId","setCount","TemplateComponentDemo","App","exact","getSession","signedInState","notSignedInState","Provider","basename","process","logoSvg","renderLoginAndSignout","Playground","searchParamsProps","ReactDOM","module","exports","ColumnType","ACCESS_TYPE","FileDownloadCode","ApprovalState"],"mappings":"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ACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,gBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBAGIC,GAA8B,CAClC,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,gBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,gBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBCjNK,SAASC,GACdrJ,EACAJ,GAEA,IAAI0J,EAAwB,GACtBC,EAAa,GACfvR,GAAU,EAEVgI,EAAQ,IAAM,GAChBsJ,EAAwBH,GACxBnR,EAAiB,EAARgI,IAETsJ,EAAwBF,GACxBpR,EAAuB,GAAbgI,EAAQ,IAKpB,IAFA,IAAMwJ,EAAyB,GAEtBvH,EAAI,E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","file":"static/js/main.e5dcb3f5.chunk.js","sourcesContent":["export enum BackendDestinationEnum {\n  REPO_ENDPOINT,\n  PORTAL_ENDPOINT,\n}\n\n// Encodes the portal and repo service destinations\ntype EndpointObject = {\n  REPO: string\n  PORTAL: string\n}\n\nexport const PRODUCTION_ENDPOINT_CONFIG: EndpointObject = {\n  REPO: 'https://repo-prod.prod.sagebase.org/',\n  PORTAL: 'https://www.synapse.org/',\n}\n\n// Given an endpoint will return the specific stack object\nexport const getEndpoint = (endpoint: BackendDestinationEnum): string => {\n  let endpoint_config = PRODUCTION_ENDPOINT_CONFIG\n  // @ts-ignore if overriding endpoint config\n  if (window.SRC && window.SRC.OVERRIDE_ENDPOINT_CONFIG) {\n    // @ts-ignore\n    endpoint_config = window.SRC && window.SRC.OVERRIDE_ENDPOINT_CONFIG\n  }\n  const { PORTAL, REPO } = endpoint_config\n  if (!PORTAL || !REPO) {\n    throw Error('Error failed to specify endpoints, cannot make call')\n  }\n  if (endpoint === BackendDestinationEnum.PORTAL_ENDPOINT) {\n    return PORTAL\n  }\n  return REPO\n}\n","import * as React from 'react'\n\nexport default ({ children, icon }: { children: any; icon?: any }) => {\n  const style: React.CSSProperties = {\n    paddingRight: 10,\n    fontWeight: 500,\n    paddingLeft: icon ? 0 : 10,\n    paddingTop: 10,\n    paddingBottom: 10,\n    textAlign: 'center',\n    width: '100%',\n  }\n  return <span style={style}>{children}</span>\n}\n","import * as React from 'react'\n// @ts-nocheck\nexport default ({ active }: { active: boolean }) => (\n  <div\n    style={{\n      background: active ? '#fff' : '#eee',\n      paddingTop: 7,\n      paddingRight: 10,\n      paddingBottom: 4,\n      paddingLeft: 10,\n      borderRadius: 2,\n    }}\n  >\n    <svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g fill=\"#000\" fillRule=\"evenodd\">\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\"\n          fill=\"#EA4335\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\"\n          fill=\"#4285F4\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\"\n          fill=\"#FBBC05\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\"\n          fill=\"#34A853\"\n        />\n        <path fill=\"none\" d=\"M0 0h18v18H0z\" />\n      </g>\n    </svg>\n  </div>\n)\n","import { UserCardSize } from '../containers/UserCard'\n\n/** QueryBundleRequest constants */\nexport const BUNDLE_MASK_QUERY_RESULTS: number = 1\nexport const BUNDLE_MASK_QUERY_COUNT: number = 2\nexport const BUNDLE_MASK_QUERY_SELECT_COLUMNS: number = 4\nexport const BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE: number = 8\nexport const BUNDLE_MASK_QUERY_COLUMN_MODELS: number = 16\nexport const BUNDLE_MASK_QUERY_FACETS: number = 32\nexport const BUNDLE_MASK_SUM_FILES_SIZE_BYTES: number = 64\n/** EntityBundle constants */\nexport const ENTITY_BUNDLE_MASK_ENTITY: number = 1\nexport const ENTITY_BUNDLE_MASK_ANNOTATIONS: number = 2\nexport const ENTITY_BUNDLE_MASK_PERMISSIONS: number = 4\nexport const ENTITY_BUNDLE_MASK_ENTITY_PATH: number = 8\nexport const ENTITY_BUNDLE_MASK_HAS_CHILDREN: number = 32\nexport const ENTITY_BUNDLE_MASK_ACL: number = 64\nexport const ENTITY_BUNDLE_MASK_FILE_HANDLES: number = 2048\nexport const ENTITY_BUNDLE_MASK_TABLE_DATA: number = 4096\nexport const ENTITY_BUNDLE_MASK_ROOT_WIKI_ID: number = 8192\nexport const ENTITY_BUNDLE_MASK_BENEFACTOR_ACL: number = 16384\nexport const ENTITY_BUNDLE_MASK_DOI: number = 32768\nexport const ENTITY_BUNDLE_MASK_FILE_NAME: number = 65536\nexport const ENTITY_BUNDLE_MASK_THREAD_COUNT: number = 131072\nexport const ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION: number = 262144\n/** Row Types  */\nexport const STUDY: string = 'study'\n/** Not set value for query */\nexport const VALUE_NOT_SET = 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n// for study icons\nexport const STUDY_ACTIVE: string = 'study active'\nexport const STUDY_COMPLETE: string = 'study complete'\nexport const DATASET: string = 'dataset'\nexport const AMP_CONSORTIUM: string = 'AMP_Consortium'\nexport const FUNDER: string = 'funder'\nexport const PUBLICATION: string = 'publication'\nexport const TOOL: string = 'tool'\nexport const GENERIC_CARD: string = 'GENERIC_CARD'\nexport const COMPUTATIONAL: string = 'computational'\nexport const EXPERIMENTAL: string = 'experimental'\nexport const CLINICAL: string = 'clinical'\nexport const PROJECT: string = 'Project'\nexport const PAGE_SIZE: number = 25\n// For User Profile Cards\nexport const SMALL_USER_CARD: UserCardSize = 'SMALL USER CARD'\nexport const MEDIUM_USER_CARD: UserCardSize = 'MEDIUM USER CARD'\nexport const LARGE_USER_CARD: UserCardSize = 'LARGE USER CARD'\nexport const SEPERATOR = 'SEPERATOR'\nexport const AUTHENTICATED_USERS = 'AUTHENTICATED_USERS'\n// For internal testing only\nexport const _TIME_DELAY = 75\nexport const SRC_SIGN_IN_CLASS = 'SRC-SIGN-IN-CLASS'\n","import SparkMD5 from 'spark-md5'\nimport { BackendDestinationEnum, getEndpoint } from './functions/getEndpoint'\nimport {\n  AccessCodeResponse,\n  AccessControlList,\n  AddFilesToDownloadListRequest,\n  AddFilesToDownloadListResponse,\n  AddPartResponse,\n  AsyncJobId,\n  BatchFileRequest,\n  BatchFileResult,\n  BatchPresignedUploadUrlRequest,\n  BatchPresignedUploadUrlResponse,\n  BulkFileDownloadRequest,\n  BulkFileDownloadResponse,\n  DownloadFromTableRequest,\n  DownloadFromTableResult,\n  DownloadList,\n  DownloadOrder,\n  Entity,\n  EntityHeader,\n  EntityLookupRequest,\n  FileEntity,\n  FileHandle,\n  FileHandleAssociation,\n  FileHandleResults,\n  FileUploadComplete,\n  FormChangeRequest,\n  FormData,\n  FormGroup,\n  FormRejection,\n  ListRequest,\n  ListResponse,\n  LoginResponse,\n  MultipartUploadRequest,\n  MultipartUploadStatus,\n  OAuthClientPublic,\n  OAuthConsentGrantedResponse,\n  OIDCAuthorizationRequest,\n  OIDCAuthorizationRequestDescription,\n  PaginatedResults,\n  ProjectFilesStatisticsRequest,\n  ProjectFilesStatisticsResponse,\n  QueryBundleRequest,\n  QueryResultBundle,\n  QueryTableResults,\n  ReferenceList,\n  RestrictionInformationRequest,\n  RestrictionInformationResponse,\n  Submission,\n  SynapseVersion,\n  UserBundle,\n  UserGroupHeaderResponsePage,\n  UserProfile,\n  WikiPage,\n  AccessRequirement,\n  AccessApproval,\n  EntityId,\n  FileHandleAssociateType,\n} from './synapseTypes/'\nimport UniversalCookies from 'universal-cookie'\n\nconst cookies = new UniversalCookies()\n\n// TODO: Create JSON response types for all return types\nexport const IS_OUTSIDE_SYNAPSE_ORG = window.location.hostname\n  .toLowerCase()\n  .includes('.synapse.org')\n  ? false\n  : true\n\nexport const SESSION_TOKEN_COOKIE_KEY =\n  'org.sagebionetworks.security.user.login.token'\n\n// Max size file that we will allow the caller to read into memory (5MB)\nconst MAX_JS_FILE_DOWNLOAD_SIZE = 5242880\nexport const AUTH_PROVIDER = 'GOOGLE_OAUTH_2_0'\n// This corresponds to the Synapse-managed S3 storage location:\nexport const SYNAPSE_STORAGE_LOCATION_ID = 1\nexport const getRootURL = () => {\n  const portString = window.location.port ? `:${window.location.port}` : ''\n  return `${window.location.protocol}//${window.location.hostname}${portString}/`\n}\n\n/**\n * Waits t number of milliseconds\n *\n * @export\n * @param {number} t milliseconds\n * @returns after t milliseconds\n */\nexport function delay(t: number) {\n  return new Promise(resolve => {\n    setTimeout(resolve.bind(null, {}), t)\n  })\n}\n\ntype SynapseError = {\n  reason: string\n}\n\nconst retryFetch = <T>(\n  url: RequestInfo,\n  options: RequestInit,\n  delayMs: number,\n) => {\n  return delay(delayMs).then(() => {\n    return fetchWithExponentialTimeout<T>(url, options, delayMs * 2)\n  })\n}\n\n// remove parseJson, combine ok and not okay response, except for 0 and 429..., make sure string responses got through\nconst fetchWithExponentialTimeout = <T>(\n  url: RequestInfo,\n  options: RequestInit,\n  delayMs: number = 1000,\n  retries: number = 5,\n): Promise<T> => {\n  return fetch(url, options)\n    .then(resp => {\n      if ((retries > 0 && resp.status === 429) || resp.status === 0) {\n        // TOO_MANY_REQUESTS_STATUS_CODE, or network connection is down.  Retry after a couple of seconds.\n        return retryFetch<T>(url, options, delayMs)\n      }\n      return resp\n        .text()\n        .then(text => {\n          // try to parse it as json\n          try {\n            const json = JSON.parse(text)\n            return resp.ok ? Promise.resolve(json) : Promise.reject<T>(json)\n          } catch (error) {\n            // failed to parse json, return text\n            return resp.ok ? Promise.resolve(text) : Promise.reject<T>(text)\n          }\n        })\n        .catch((error: SynapseError) => {\n          if (resp.ok) {\n            // possible empty response\n            return Promise.resolve({\n              reason: error,\n              status: resp.status,\n            })\n          }\n          if (error.reason && resp.status) {\n            // successfull return from server but invalid call\n            return Promise.reject({\n              reason: error.reason,\n              status: resp.status,\n            })\n          }\n          // This occurs if the response is not ok and does not have json or is empty\n          return Promise.reject({\n            reason: error,\n            status: resp.status,\n          })\n        })\n    })\n    .catch(error => {\n      if (\n        retries === 0 ||\n        (error.status && error.status !== 429 && error.status !== 0)\n      ) {\n        // If there is an error response and the error is nether a throttled response\n        // or disconnected network\n        return Promise.reject(error)\n      }\n      return retryFetch(url, options, delayMs)\n    })\n}\n\nexport const doPost = <T>(\n  url: string,\n  requestJsonObject: any,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n): Promise<T> => {\n  const options: RequestInit = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n      'Content-Type': 'application/json',\n    },\n    method: 'POST',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout<T>(usedEndpoint + url, options)\n}\nexport const doGet = <T>(\n  url: string,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n) => {\n  const options: RequestInit = {\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n    },\n    method: 'GET',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout<T>(usedEndpoint + url, options)\n}\n\nexport const doDelete = (\n  url: string,\n  requestJsonObject: any | undefined = undefined,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n) => {\n  const options: RequestInit = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n    },\n    method: 'DELETE',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout(usedEndpoint + url, options)\n}\n\nexport const doPut = (\n  url: string,\n  requestJsonObject: any,\n  sessionToken: string | undefined,\n  initCredentials: RequestInit['credentials'],\n  endpoint: BackendDestinationEnum,\n): Promise<any> => {\n  const options: RequestInit = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n      'Content-Type': 'application/json',\n    },\n    method: 'PUT',\n    mode: 'cors',\n    credentials: initCredentials,\n  }\n  if (sessionToken) {\n    // @ts-ignore\n    options.headers.sessionToken = sessionToken\n  }\n  const usedEndpoint = getEndpoint(endpoint)\n  return fetchWithExponentialTimeout(usedEndpoint + url, options)\n}\n\nexport const putRefreshSessionToken = (sessionToken: string) => {\n  return doPut(\n    '/auth/v1/session',\n    { sessionToken },\n    undefined,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getVersion = (): Promise<SynapseVersion> => {\n  return doGet<SynapseVersion>(\n    '/repo/v1/version',\n    undefined,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * https://docs.synapse.org/rest/POST/download/list/add/async/start.html\n */\n//Start an asynchronous job to add files to a user's download list.\nexport const addFilesToDownloadList = (\n  request: AddFilesToDownloadListRequest,\n  sessionToken: string,\n  updateParentState?: any,\n) => {\n  return doPost<AsyncJobId>(\n    `file/v1/download/list/add/async/start`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((resp: AsyncJobId) => {\n      const requestUrl = `file/v1/download/list/add/async/get/${resp.token}`\n      return getAsyncResultFromJobId<AddFilesToDownloadListResponse>(\n        requestUrl,\n        sessionToken,\n        updateParentState,\n      )\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n\n/**\n * https://docs.synapse.org/rest/POST/entity/id/table/download/csv/async/start.html\n */\nexport const getDownloadFromTableRequest = (\n  request: DownloadFromTableRequest,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n) => {\n  return doPost<AsyncJobId>(\n    `/repo/v1/entity/${request.entityId}/table/download/csv/async/start`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((resp: AsyncJobId) => {\n      const requestUrl = `/repo/v1/entity/${request.entityId}/table/download/csv/async/get/${resp.token}`\n      return getAsyncResultFromJobId<DownloadFromTableResult>(\n        requestUrl,\n        sessionToken,\n        updateParentState,\n      )\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n\n/**\n * https://docs.synapse.org/rest/GET/fileHandle/handleId.html\n * Get a FileHandle using its ID.\n * Note: Only the user that created the FileHandle can access it directly.\n * @return FileHandle\n **/\nexport const getFileHandleById = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n): Promise<FileHandle> => {\n  return doGet<FileHandle>(\n    `file/v1/fileHandle/${handleId}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * https://docs.synapse.org/rest/GET/fileHandle/handleId/url.html\n * @return a short lived presignedURL to be redirected with\n **/\nexport const getFileHandleByIdURL = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n) => {\n  // get the presigned URL for this file handle\n  return doGet<string>(\n    `file/v1/fileHandle/${handleId}/url?redirect=false`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getAsyncResultFromJobId = <T>(\n  urlRequest: string,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n): Promise<T> => {\n  return doGet(\n    urlRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((resp: any) => {\n      // is this the job status?\n      if (resp.jobState && resp.jobState !== 'FAILED') {\n        updateParentState &&\n          updateParentState({\n            asyncJobStatus: resp,\n          })\n        // still processing, wait for a second and try again\n        return delay(500).then(() => {\n          return getAsyncResultFromJobId<T>(\n            urlRequest,\n            sessionToken,\n            updateParentState,\n          )\n        })\n      }\n      // these must be the query results!\n      return resp\n    })\n    .catch(error => {\n      throw error\n    })\n}\n\n/**\n * http://docs.synapse.org/rest/POST/entity/id/table/query/nextPage/async/start.html\n * @param {*} queryBundleRequest\n * @param {*} sessionToken\n * @param {*} endpoint\n */\nexport const getQueryTableResults = (\n  queryBundleRequest: QueryBundleRequest,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n): Promise<QueryResultBundle> => {\n  return doPost<AsyncJobId>(\n    `/repo/v1/entity/${queryBundleRequest.entityId}/table/query/async/start`,\n    queryBundleRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then(resp => {\n      return getAsyncResultFromJobId<QueryResultBundle>(\n        `/repo/v1/entity/${queryBundleRequest.entityId}/table/query/async/get/${resp.token}`,\n        sessionToken,\n        updateParentState,\n      )\n    })\n    .catch((error: any) => {\n      throw error\n    })\n}\n/**\n *  Run and return results from queryBundleRequest, queryBundle request must be of the\n *  form:\n *     {\n *        concreteType: String,\n *        query: {\n *           sql: String,\n *           isConsistent: Boolean,\n *           partMask: Number\n *        }\n *     }\n * @param {*} queryBundleRequest\n * @param {*} [sessionToken=undefined]\n * @param {boolean} [onlyGetFacets=false] Specify if the query only needs facets and no\n * data-- (internally this limits the row count to 1 on the request)\n * @returns Full dataset from synapse table query\n */\n\nexport const getFullQueryTableResults = async (\n  queryBundleRequest: QueryBundleRequest,\n  sessionToken: string | undefined = undefined,\n  maxPageSize: number = 2500,\n): Promise<QueryResultBundle> => {\n  let data: QueryResultBundle\n  // get first page\n  let offset = 0\n  const { query, ...rest } = queryBundleRequest\n  const queryRequest: QueryBundleRequest = {\n    ...rest,\n    query: { ...query, limit: maxPageSize, offset: offset },\n  }\n  let response = await getQueryTableResults(queryRequest, sessionToken)\n  data = response\n  //we are done if we return less than a pagesize\n  let isDone = response.queryResult.queryResults.rows.length < maxPageSize\n\n  while (!isDone) {\n    offset += maxPageSize\n    queryRequest.query.offset = offset\n    let response = await getQueryTableResults(queryRequest, sessionToken)\n\n    data.queryResult.queryResults.rows.push(\n      ...response.queryResult.queryResults.rows, // ... spread operator to push all elements on\n    )\n\n    isDone =  response.queryResult.queryResults.rows.length < maxPageSize\n  }\n  return data\n}\n\n/**\n *  Log-in using the given username and password.  Will return a session token that must be used in\n *  authenticated requests.\n *  http://docs.synapse.org/rest/POST/login.html\n */\nexport const login = (\n  username: string,\n  password: string,\n  authenticationReceipt: string | null,\n  endpoint = BackendDestinationEnum.REPO_ENDPOINT,\n): Promise<LoginResponse> => {\n  return doPost(\n    '/auth/v1/login',\n    { username, password, authenticationReceipt },\n    undefined,\n    undefined,\n    endpoint,\n  )\n}\n/**\n * Get redirect url\n * https://docs.synapse.org/rest/POST/oauth2/authurl.html\n * @param {*} provider\n * @param {*} redirectUrl\n * @param {*} endpoint\n */\nexport const oAuthUrlRequest = (\n  provider: string,\n  redirectUrl: string,\n  endpoint = BackendDestinationEnum.REPO_ENDPOINT,\n) => {\n  return doPost(\n    '/auth/v1/oauth2/authurl',\n    { provider, redirectUrl },\n    undefined,\n    undefined,\n    endpoint,\n  )\n}\n/**\n * Get session token from SSO\n * https://docs.synapse.org/rest/POST/oauth2/session.html\n * @param {*} provider\n * @param {*} authenticationCode\n * @param {*} redirectUrl\n * @param {*} endpoint\n */\nexport const oAuthSessionRequest = (\n  provider: string,\n  authenticationCode: string | number,\n  redirectUrl: string,\n  endpoint: any = BackendDestinationEnum.REPO_ENDPOINT,\n) => {\n  return doPost(\n    '/auth/v1/oauth2/session',\n    { provider, authenticationCode, redirectUrl },\n    undefined,\n    undefined,\n    endpoint,\n  )\n}\n/**\n * Create an entity (Project, Folder, File, Table, View)\n * http://docs.synapse.org/rest/POST/entity.html\n */\nexport const createEntity = <T extends Entity>(\n  entity: T,\n  sessionToken: string | undefined,\n) => {\n  return doPost<T>(\n    '/repo/v1/entity',\n    entity,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Create a project with the given name.\n * http://docs.synapse.org/rest/POST/entity.html\n */\nexport const createProject = (\n  name: string,\n  sessionToken: string | undefined,\n): Promise<Entity> => {\n  return createEntity(\n    {\n      name,\n      concreteType: 'org.sagebionetworks.repo.model.Project',\n    },\n    sessionToken,\n  )\n}\n\n/**\n * Return this user's UserProfile\n * http://docs.synapse.org/rest/GET/userProfile.html\n */\nexport const getUserProfile = (sessionToken: string | undefined) => {\n  return doGet<UserProfile>(\n    '/repo/v1/userProfile',\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return this user's UserProfile\n * http://docs.synapse.org/rest/GET/userProfile.html\n */\nexport const getUserProfileById = (\n  sessionToken: string | undefined,\n  ownerId: string,\n) => {\n  return doGet<UserProfile>(\n    `/repo/v1/userProfile/${ownerId}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return this user's profile bundle\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserBundle.html\n */\nexport const getUserBundle = (\n  id: string,\n  mask: number,\n  sessionToken: string | undefined,\n): Promise<UserBundle> => {\n  return doGet<UserBundle>(\n    `repo/v1/user/${id}/bundle?mask=${mask}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return batch of user group headers\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserGroupHeaderResponsePage.html\n */\nexport const getGroupHeadersBatch = (\n  ids: string[],\n  sessionToken: string | undefined,\n): Promise<UserGroupHeaderResponsePage> => {\n  return doGet<UserGroupHeaderResponsePage>(\n    `repo/v1/userGroupHeaders/batch?ids=${ids.join(',')}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport type UserProfileList = { list: UserProfile[] }\n/**\n * Return the User Profiles for the given list of user IDs\n * http://docs.synapse.org/rest/POST/userProfile.html\n */\nexport const getUserProfiles = (\n  list: string[],\n  sessionToken: string | undefined = undefined,\n): Promise<UserProfileList> => {\n  return doPost(\n    '/repo/v1/userProfile',\n    { list },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Return the children (Files/Folders) of the given entity (Project or Folder).\n * http://docs.synapse.org/rest/POST/entity/children.html\n */\nexport const getEntityChildren = (\n  request: any,\n  sessionToken: string | undefined = undefined,\n) => {\n  return doPost(\n    '/repo/v1/entity/children',\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Retrieve an entityId for a given parent ID and entity name.\n * https://docs.synapse.org/rest/POST/entity/child.html\n */\nexport const lookupChildEntity = (\n  request: EntityLookupRequest,\n  sessionToken: string | undefined = undefined,\n) => {\n  return doPost<EntityId>(\n    '/repo/v1/entity/child',\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get a batch of pre-signed URLs and/or FileHandles for the given list of FileHandleAssociations.\n * http://docs.synapse.org/rest/POST/fileHandle/batch.html\n */\nexport const getFiles = (\n  request: BatchFileRequest,\n  sessionToken: string | undefined = undefined,\n): Promise<BatchFileResult> => {\n  return doPost(\n    '/file/v1/fileHandle/batch',\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get a batch of pre-signed URLs and/or FileHandles for the given list of FileHandleAssociations.\n * http://docs.synapse.org/rest/POST/fileHandle/batch.html\n */\nexport const getBulkFiles = (\n  bulkFileDownloadRequest: BulkFileDownloadRequest,\n  sessionToken: string | undefined = undefined,\n): Promise<BulkFileDownloadResponse> => {\n  return doPost<AsyncJobId>(\n    'file/v1/file/bulk/async/start',\n    bulkFileDownloadRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then((asyncJobId: AsyncJobId) => {\n      const urlRequest = `/file/v1/file/bulk/async/get/${asyncJobId.token}`\n      return getAsyncResultFromJobId<BulkFileDownloadResponse>(\n        urlRequest,\n        sessionToken,\n      )\n    })\n    .catch(err => {\n      console.error('Error on getBulkFiles ', err)\n      return err\n    })\n}\n/**\n * Bundled access to Entity and related data components.\n * An EntityBundle can be used to create, fetch, or update an Entity and associated\n * objects with a single web service request.\n * See SynapseClient.test.js for an example partsMask.\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/Entity.html\n */\ntype GetEntity = <T extends Entity>(\n  sessionToken: string | undefined,\n  entityId: string | number,\n  versionNumber?: string,\n) => Promise<T>\n\nexport const getEntity: GetEntity = <T>(\n  sessionToken: string | undefined = undefined,\n  entityId: string | number,\n  versionNumber?: string,\n) => {\n  const url = versionNumber\n    ? `/repo/v1/entity/${entityId}/version/${versionNumber}`\n    : `/repo/v1/entity/${entityId}`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<T>\n}\n\n/**\n * Get the EntityHeader for a list of references with a POST.\n * If any item in the batch fails (e.g., with a 404) it will be EXCLUDED in the result set.\n * https://docs.synapse.org/rest/POST/entity/header.html\n */\nexport const getEntityHeader = (\n  references: ReferenceList,\n  sessionToken: string | undefined = undefined,\n) => {\n  return doPost(\n    'repo/v1/entity/header',\n    { references },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<PaginatedResults<EntityHeader>>\n}\n\nexport const updateEntity = <T extends Entity>(\n  entity: T,\n  sessionToken: string | undefined = undefined,\n): Promise<T> => {\n  const url = `/repo/v1/entity/${entity.id}`\n  return doPut(\n    url,\n    entity,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const deleteEntity: GetEntity = <T>(\n  sessionToken: string | undefined = undefined,\n  entityId: string | number,\n) => {\n  const url = `/repo/v1/entity/${entityId}`\n  return doDelete(\n    url,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<T>\n}\n\n/**\n * Bundled access to Entity and related data components.\n * An EntityBundle can be used to create, fetch, or update an Entity and\n * associated objects with a single web service request.\n * See SynapseClient.test.js for an example partsMask.\n * http://docs.synapse.org/rest/GET/entity/id/version/versionNumber/bundle.html\n */\nexport const getEntityBundleForVersion = (\n  entityId: string | number,\n  version: string | number | undefined,\n  partsMask: string | number,\n  sessionToken: string | undefined = undefined,\n) => {\n  let url = `/repo/v1/entity/${entityId}`\n  if (version) {\n    url += `/version/ + ${version}`\n  }\n  url += `/bundle?mask= ${partsMask}`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<any>\n}\n/**\n * Get Wiki page contents, call is of the form:\n * http://docs.synapse.org/rest/GET/entity/ownerId/wiki.html\n */\nexport const getEntityWiki = (\n  sessionToken: string | undefined,\n  ownerId: string | undefined,\n  wikiId: string | undefined,\n) => {\n  const url = `/repo/v1/entity/${ownerId}/wiki/${wikiId}`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<WikiPage>\n}\n\n/**\n * Returns synapse user favorites list given their session token\n * http://docs.synapse.org/rest/GET/favorite.html\n */\nexport const getUserFavorites = (sessionToken: string | undefined) => {\n  const url = 'repo/v1/favorite?offset=0&limit=200'\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ) as Promise<any>\n}\n\n/**\n * Get the user's list of teams they are on\n *\n * @param {*} id ownerID of the synapse user see - http://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserProfile.html\n */\nexport const getUserTeamList = (\n  sessionToken: string | undefined,\n  id: string | number,\n) => {\n  const url = `repo/v1/user/${id}/team?offset=0&limit=200`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Get the user's list of teams they are on\n *\n * @param {*} id ownerID of the synapse user see -https://docs.synapse.org/rest/GET/teamMembers/id.html\n * @param {*} fragment (optional) a prefix of the user's first or last name or email address (optional)\n * @param {*} limit    (optional) the maximum number of members to return (default 10, max limit 50)\n * @param {*} offset   (optional) the starting index of the returned results (default 0)\n *\n */\nexport const getTeamList = (\n  sessionToken: string | undefined,\n  id: string | number,\n  fragment: string = '',\n  limit: number = 10,\n  offset: number = 0,\n) => {\n  const url = `repo/v1/teamMembers/${id}?limit=${limit}&offset=${offset}${\n    fragment ? `&fragment=${fragment}` : ''\n  }`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getWikiAttachmentsFromEntity = (\n  sessionToken: string | undefined,\n  id: string | number,\n  wikiId: string | number,\n): Promise<FileHandleResults> => {\n  const url = `repo/v1/entity/${id}/wiki/${wikiId}/attachmenthandles`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\nexport const getWikiAttachmentsFromEvaluation = (\n  sessionToken: string | undefined,\n  id: string | number,\n  wikiId: string | number,\n) => {\n  const url = `repo/v1/evaluation/${id}/wiki/${wikiId}/attachmenthandles`\n  return doGet(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Set the session token cookie.  Note that this will only succeed if your app is running on\n * a .synapse.org subdomain.\n *\n * @param {*} token Session token.  If undefined, then call should instruct the browser to delete the cookie.\n */\nexport const setSessionTokenCookie = (\n  token: string | undefined,\n  sessionCallback: Function,\n): void => {\n  if (IS_OUTSIDE_SYNAPSE_ORG) {\n    if (!token) {\n      cookies.remove(SESSION_TOKEN_COOKIE_KEY)\n    } else {\n      // set's cookie in session storage\n      cookies.set(SESSION_TOKEN_COOKIE_KEY, token, {\n        // expires in a day\n        maxAge: 60 * 60 * 24,\n      })\n    }\n    sessionCallback()\n  } else {\n    // will set cookie in the http header\n    doPost(\n      'Portal/sessioncookie',\n      { sessionToken: token },\n      undefined,\n      'include',\n      BackendDestinationEnum.PORTAL_ENDPOINT,\n    )\n      .then(_ => {\n        sessionCallback()\n      })\n      .catch(err => {\n        console.error('Error on setting session token ', err)\n      })\n  }\n}\n/**\n * Get the current session token from a cookie.  Note that this will only succeed if your app is running on\n * a .synapse.org subdomain.\n */\nexport const getSessionTokenFromCookie = async () => {\n  if (IS_OUTSIDE_SYNAPSE_ORG) {\n    return cookies.get(SESSION_TOKEN_COOKIE_KEY)\n  }\n  return doGet<string>(\n    'Portal/sessioncookie',\n    undefined,\n    'include',\n    BackendDestinationEnum.PORTAL_ENDPOINT,\n  )\n}\n\nexport const getPrincipalAliasRequest = (\n  sessionToken: string | undefined,\n  alias: string,\n  type: string,\n) => {\n  const url = 'repo/v1/principal/alias'\n  return doPost(\n    url,\n    { alias, type },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/*\nDuring SSO login, the authorization provider (Google) will\nsend the user back to the portal with an authorization code,\nwhich can be exchanged for a Synapse user session.\nThis function should be called whenever the root App is initialized\n(to look for this code parameter and complete the round-trip).\n*/\nexport const detectSSOCode = () => {\n  const redirectURL = getRootURL()\n  // 'code' handling (from SSO) should be preformed on the root page, and then redirect to original route.\n  let code: URL | null | string = new URL(window.location.href)\n  // in test environment the searchParams isn't defined\n  const { searchParams } = code\n  if (!searchParams) {\n    return\n  }\n  code = searchParams.get('code')\n  if (code) {\n    oAuthSessionRequest(\n      AUTH_PROVIDER,\n      code,\n      `${redirectURL}?provider=${AUTH_PROVIDER}`,\n      BackendDestinationEnum.REPO_ENDPOINT,\n    )\n      .then((synToken: any) => {\n        setSessionTokenCookie(synToken.sessionToken, () => {\n          // go back to original route after successful SSO login\n          const originalUrl = localStorage.getItem('after-sso-login-url')\n          localStorage.removeItem('after-sso-login-url')\n          if (originalUrl) {\n            window.location.replace(originalUrl)\n          }\n        })\n      })\n      .catch((err: any) => {\n        if (err.status === 404) {\n          // Synapse account not found, send to registration page\n          window.location.replace('https://www.synapse.org/#!RegisterAccount:0')\n        }\n        console.error('Error on sso sign in ', err)\n      })\n  }\n}\n\nexport const signOut = (sessionCallback: Function) => {\n  setSessionTokenCookie(undefined, sessionCallback)\n}\n\n/**\n * Upload file.  Note that this currently only supports Synapse storage (Sage s3 bucket)\n * @param sessionToken\n * @param file\n * @param endpoint\n */\nexport const uploadFile = (\n  sessionToken: string | undefined,\n  filename: string,\n  file: Blob,\n) => {\n  return new Promise<FileUploadComplete>(\n    (fileUploadResolve, fileUploadReject) => {\n      const partSize: number = Math.max(5242880, file.size / 10000)\n      const request: MultipartUploadRequest = {\n        contentType: file.type,\n        fileName: filename,\n        fileSizeBytes: file.size,\n        partSizeBytes: partSize,\n        storageLocationId: SYNAPSE_STORAGE_LOCATION_ID,\n      }\n      calculateMd5(file).then((md5: string) => {\n        request.contentMD5Hex = md5\n        startMultipartUpload(\n          sessionToken,\n          filename,\n          file,\n          request,\n          fileUploadResolve,\n          fileUploadReject,\n        )\n      })\n    },\n  )\n}\n\nconst calculateMd5 = (fileBlob: File | Blob): Promise<string> => {\n  // code taken from md5 example from library\n  return new Promise((resolve, reject) => {\n    const blobSlice = File.prototype.slice,\n      file = fileBlob,\n      chunkSize = 2097152, // Read in chunks of 2MB\n      chunks = Math.ceil(file.size / chunkSize),\n      spark = new SparkMD5.ArrayBuffer(),\n      fileReader = new FileReader()\n    let currentChunk = 0\n\n    fileReader.onload = function(e) {\n      console.log('read chunk nr', currentChunk + 1, 'of', chunks)\n      spark.append(fileReader.result as ArrayBuffer) // Append array buffer\n      currentChunk++\n\n      if (currentChunk < chunks) {\n        loadNext()\n      } else {\n        console.log('finished loading')\n        const md5: string = spark.end()\n        console.info('computed hash', md5) // Compute hash\n        resolve(md5)\n      }\n    }\n\n    fileReader.onerror = function() {\n      console.warn('oops, something went wrong.')\n      reject(fileReader.error)\n    }\n\n    const loadNext = () => {\n      const start = currentChunk * chunkSize,\n        end = start + chunkSize >= file.size ? file.size : start + chunkSize\n\n      fileReader.readAsArrayBuffer(blobSlice.call(file, start, end))\n    }\n    loadNext()\n  })\n}\n\nconst processFilePart = (\n  partNumber: number,\n  multipartUploadStatus: MultipartUploadStatus,\n  sessionToken: string | undefined,\n  fileName: string,\n  file: Blob,\n  request: MultipartUploadRequest,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n) => {\n  if (multipartUploadStatus.clientSidePartsState![partNumber - 1]) {\n    // no-op. this part has already been processed!\n    return\n  }\n\n  const uploadId = multipartUploadStatus.uploadId\n  const presignedUploadUrlRequest: BatchPresignedUploadUrlRequest = {\n    uploadId,\n    contentType: 'application/octet-stream', // each part is binary\n    partNumbers: [partNumber],\n  }\n  const presignedUrlUrl = `/file/v1/file/multipart/${uploadId}/presigned/url/batch`\n  doPost<BatchPresignedUploadUrlResponse>(\n    presignedUrlUrl,\n    presignedUploadUrlRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  ).then(async (presignedUrlResponse: BatchPresignedUploadUrlResponse) => {\n    const presignedUrl =\n      presignedUrlResponse.partPresignedUrls[0].uploadPresignedUrl\n    // calculate the byte range\n    const startByte = (partNumber - 1) * request.partSizeBytes\n    let endByte = partNumber * request.partSizeBytes - 1\n    if (endByte >= request.fileSizeBytes) {\n      endByte = request.fileSizeBytes - 1\n    }\n    const fileSlice = file.slice(\n      startByte,\n      endByte + 1,\n      presignedUploadUrlRequest.contentType,\n    )\n    await uploadFilePart(\n      presignedUrl,\n      fileSlice,\n      presignedUploadUrlRequest.contentType,\n    )\n    // uploaded the part.  calculate md5 of the part and add the part to the upload\n    calculateMd5(fileSlice).then((md5: string) => {\n      const addPartUrl = `/file/v1/file/multipart/${uploadId}/add/${partNumber}?partMD5Hex=${md5}`\n      doPut(\n        addPartUrl,\n        undefined,\n        sessionToken,\n        undefined,\n        BackendDestinationEnum.REPO_ENDPOINT,\n      ).then((addPartResponse: AddPartResponse) => {\n        if (addPartResponse.addPartState === 'ADD_SUCCESS') {\n          // done with this part!\n          multipartUploadStatus.clientSidePartsState![partNumber - 1] = true\n          checkUploadComplete(\n            multipartUploadStatus,\n            fileName,\n            sessionToken,\n            fileUploadResolve,\n            fileUploadReject,\n          )\n        } else {\n          // retry after a brief delay\n          delay(1000).then(() => {\n            processFilePart(\n              partNumber,\n              multipartUploadStatus,\n              sessionToken,\n              fileName,\n              file,\n              request,\n              fileUploadResolve,\n              fileUploadReject,\n            )\n          })\n        }\n      })\n    })\n  })\n}\nexport const checkUploadComplete = (\n  status: MultipartUploadStatus,\n  fileHandleName: string,\n  sessionToken: string | undefined,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n) => {\n  // if all client-side parts are true (uploaded), then complete the upload and get the file handle!\n  if (\n    status.clientSidePartsState!.every(v => {\n      return v\n    })\n  ) {\n    const url = `/file/v1/file/multipart/${status.uploadId}/complete`\n    doPut(\n      url,\n      undefined,\n      sessionToken,\n      undefined,\n      BackendDestinationEnum.REPO_ENDPOINT,\n    )\n      .then((newStatus: MultipartUploadStatus) => {\n        // success!\n        fileUploadResolve({\n          fileHandleId: newStatus.resultFileHandleId,\n          fileName: fileHandleName,\n        })\n      })\n      .catch(error => {\n        fileUploadReject(error)\n      })\n  }\n}\nconst uploadFilePart = async (\n  presignedUrl: string,\n  file: any,\n  contentType: string,\n) => {\n  // TODO: could try using axios to get upload progress, then update the client-side part state (change to numbers from 0-1)\n  // This would give progress for the single file (across all parts).\n  // The parent would still need to figure out progress (for the total file set).\n  await fetch(presignedUrl, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': contentType,\n    },\n    body: file,\n  })\n}\nexport const startMultipartUpload = (\n  sessionToken: string | undefined,\n  fileName: string,\n  file: Blob,\n  request: MultipartUploadRequest,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n) => {\n  const url = 'file/v1/file/multipart'\n  doPost<MultipartUploadStatus>(\n    url,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n    .then(async (status: MultipartUploadStatus) => {\n      // started the upload\n      // keep track of the part state client-side\n      const clientSidePartsState: boolean[] = status.partsState\n        .split('')\n        .map(bit => bit === '1')\n      status.clientSidePartsState = clientSidePartsState\n      for (let i = 0; i < clientSidePartsState.length; i = i + 1) {\n        if (!clientSidePartsState[i]) {\n          // upload this part.  note that partNumber is always the index+1\n          await processFilePart(\n            i + 1,\n            status,\n            sessionToken,\n            fileName,\n            file,\n            request,\n            fileUploadResolve,\n            fileUploadReject,\n          )\n        }\n      }\n      // in case there is no upload work to do!\n      checkUploadComplete(\n        status,\n        fileName,\n        sessionToken,\n        fileUploadResolve,\n        fileUploadReject,\n      )\n    })\n    .catch(error => {\n      fileUploadReject(error)\n    })\n}\n\n/**\n * Return the content of the file (latest version) associated to the given FileEntity.\n * Be aware that if the target file size > 5MB, this method will throw an error.\n * @param sessionToken\n * @param fileEntity\n * @param endpoint\n */\nexport const getFileEntityContent = (\n  sessionToken: string,\n  fileEntity: FileEntity,\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    const fileHandleAssociationList = [\n      {\n        associateObjectId: fileEntity.id,\n        associateObjectType: 'FileEntity',\n        fileHandleId: fileEntity.dataFileHandleId,\n      },\n    ]\n    const request: any = {\n      includeFileHandles: true,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    getFiles(request, sessionToken)\n      .then((data: BatchFileResult) => {\n        const presignedUrl: string = data.requestedFiles[0].preSignedURL!\n        const fileHandle: FileHandle = data.requestedFiles[0].fileHandle!\n        return getFileHandleContent(fileHandle, presignedUrl).then(\n          (content: string) => {\n            resolve(content)\n          },\n        )\n      })\n      .catch(err => {\n        reject(err)\n      })\n  })\n}\n\n/**\n * Return the FileHandle of the file associated to the given FileEntity.\n * * @param fileEntity: FileEntity\n * @param sessionToken\n * @param endpoint\n */\nexport const getFileEntityFileHandle = (\n  fileEntity: FileEntity,\n  sessionToken?: string,\n): Promise<FileHandle> => {\n  return new Promise((resolve, reject) => {\n    const fileHandleAssociationList:FileHandleAssociation[] = [\n      {\n        associateObjectId: fileEntity.id!,\n        associateObjectType: FileHandleAssociateType.FileEntity,\n        fileHandleId: fileEntity.dataFileHandleId,\n      },\n    ]\n    const request:BatchFileRequest = {\n      includeFileHandles: true,\n      includePreSignedURLs: false,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    getFiles(request, sessionToken)\n      .then((data: BatchFileResult) => {\n        if (data.requestedFiles.length > 0 && data.requestedFiles[0].fileHandle) {\n          resolve(data.requestedFiles[0].fileHandle)  \n        } else {\n          // not found, or not allowed to access\n          reject(undefined)\n        }\n      })\n      .catch(err => {\n        reject(err)\n      })\n  })\n}\n\nexport const getFileHandleContentFromID = (\n  fileHandleId: string,\n  sessionToken: string,\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    // get the file handle and url\n    const getFileHandleByIdPromise = getFileHandleById(\n      fileHandleId,\n      sessionToken,\n    )\n    const getFileHandlePresignedUrlPromis = getFileHandleByIdURL(\n      fileHandleId,\n      sessionToken,\n    )\n    Promise.all([getFileHandleByIdPromise, getFileHandlePresignedUrlPromis])\n      .then(values => {\n        const fileHandle: FileHandle = values[0]\n        const presignedUrl: string = values[1]\n        return getFileHandleContent(fileHandle, presignedUrl).then(\n          (content: string) => {\n            resolve(content)\n          },\n        )\n      })\n      .catch(err => {\n        reject(err)\n      })\n  })\n}\n\nexport const getFileHandleContent = (\n  fileHandle: FileHandle,\n  presignedUrl: string,\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    // sanity check!  must be less than 5MB\n    if (fileHandle.contentSize < MAX_JS_FILE_DOWNLOAD_SIZE) {\n      fetch(presignedUrl, {\n        method: 'GET',\n        mode: 'cors',\n        cache: 'no-cache',\n        headers: {\n          'Content-Type': fileHandle.contentType,\n        },\n      }).then(response => {\n        // the response is always decoded using UTF-8\n        response.text().then(text => {\n          resolve(text)\n        })\n      })\n    } else {\n      reject('File size exceeds max (5MB)')\n    }\n  })\n}\n\n/**\n * Create an ACL\n * https://docs.synapse.org/rest/POST/entity/id/acl.html\n */\nexport const createACL = (\n  entityId: string,\n  acl: AccessControlList,\n  sessionToken: string | undefined,\n) => {\n  return doPost(\n    `/repo/v1/entity/${entityId}/acl`,\n    acl,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Submit an entity to an evaluation queue\n * https://docs.synapse.org/rest/POST/evaluation/submission.html\n */\nexport const submitToEvaluation = (\n  submission: Submission,\n  etag: string,\n  sessionToken: string | undefined,\n) => {\n  return doPost(\n    `/repo/v1/evaluation/submission?etag=${etag}`,\n    submission,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get an evaluation queue\n * https://docs.synapse.org/rest/GET/evaluation/evalId.html\n */\nexport const getEvaluation = (\n  evalId: string,\n  sessionToken: string | undefined,\n) => {\n  return doGet(\n    `/repo/v1/evaluation/${evalId}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Executes a user-defined query over the Submissions of a specific Evaluation.\n * https://docs.synapse.org/rest/GET/evaluation/submission/query.html\n */\nexport const getEvaluationSubmissions = (\n  query: string,\n  sessionToken: string | undefined,\n): Promise<QueryTableResults> => {\n  return doGet(\n    `/repo/v1/evaluation/submission/query?query=${encodeURI(query)}`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get user-friendly OAuth2 request information (to present to the user so they can choose if they want to give consent).\n * http://rest-docs.synapse.org/rest/POST/oauth2/description.html\n */\nexport const getOAuth2RequestDescription = (\n  oidcAuthRequest: OIDCAuthorizationRequest\n): Promise<OIDCAuthorizationRequestDescription> => {\n  return doPost(\n    '/auth/v1/oauth2/description',\n    oidcAuthRequest,\n    undefined, // sessionToken: this is not an authenticated call\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Check whether user has already granted consent for the given OAuth client, scope, and claims.\n * Consent persists for one year.\n */\nexport const hasUserAuthorizedOAuthClient = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n  sessionToken: string,\n): Promise<OAuthConsentGrantedResponse> => {\n  return doPost(\n    '/auth/v1/oauth2/consentcheck',\n    oidcAuthRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get OAuth2 Client information (available to the public)\n */\nexport const getOAuth2Client = (\n  clientId: string,\n): Promise<OAuthClientPublic> => {\n  return doGet(\n    `/auth/v1/oauth2/client/${clientId}`,\n    undefined,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * User consents to the given OIDCAuthorizationRequest (after being presented with all information returned by getOAuth2RequestDescription())\n * @param oidcAuthRequest\n * @param sessionToken\n * @param endpoint\n */\nexport const consentToOAuth2Request = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n  sessionToken: string | undefined,\n): Promise<AccessCodeResponse> => {\n  return doPost(\n    '/auth/v1/oauth2/consent',\n    oidcAuthRequest,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/***********************\n * FORM SERVICES\n * https://docs.synapse.org/rest/#org.sagebionetworks.repo.web.controller.FormController\n *************************/\n/**\n * Create a FormGroup\n * https://docs.synapse.org/rest/POST/form/group.html\n * @param name\n * @param sessionToken\n * @param endpoint\n */\nexport const createFormGroup = (\n  name: string,\n  sessionToken: string,\n): Promise<FormGroup> => {\n  return doPost(\n    `/repo/v1/form/group?name=${encodeURI(name)}`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get FormGroup ACL\n * https://docs.synapse.org/rest/GET/form/group/id/acl.html\n */\nexport const getFormACL = (\n  formGroupId: string,\n  sessionToken: string | undefined,\n): Promise<AccessControlList> => {\n  return doGet(\n    `/repo/v1/form/group/${formGroupId}/acl`,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Update FormGroup ACL\n * https://docs.synapse.org/rest/PUT/form/group/id/acl.html\n */\nexport const updateFormACL = (\n  formGroupId: string,\n  newAcl: AccessControlList,\n  sessionToken: string | undefined,\n): Promise<AccessControlList> => {\n  return doPut(\n    `/repo/v1/form/group/${formGroupId}/acl`,\n    newAcl,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Create a new FormData object\n * https://docs.synapse.org/rest/POST/form/data.html\n * @param formGroupId\n * @param name\n * @param sessionToken\n * @param endpoint\n */\nexport const createFormData = (\n  formGroupId: string,\n  name: string,\n  dataFileHandleId: string,\n  sessionToken: string,\n): Promise<FormData> => {\n  const newFormData: FormChangeRequest = {\n    name,\n    fileHandleId: dataFileHandleId,\n  }\n  return doPost(\n    `/repo/v1/form/data?groupId=${formGroupId}`,\n    newFormData,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Update FormData object\n * https://docs.synapse.org/rest/PUT/form/data.html\n */\nexport const updateFormData = (\n  formDataId: string,\n  name: string,\n  dataFileHandleId: string,\n  sessionToken: string,\n): Promise<FormData> => {\n  const updatedFormData: FormChangeRequest = {\n    name,\n    fileHandleId: dataFileHandleId,\n  }\n  return doPut(\n    `/repo/v1/form/data/${formDataId}`,\n    updatedFormData,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Delete FormData object\n * https://docs.synapse.org/rest/DELETE/form/data.html\n */\nexport const deleteFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n) => {\n  return doDelete(\n    `/repo/v1/form/data/${formDataId}`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Submit the identified FormData for review.\n * https://docs.synapse.org/rest/POST/form/data/id/submit.html\n */\nexport const submitFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n): Promise<FormData> => {\n  return doPost(\n    `/repo/v1/form/data/${formDataId}/submit`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * List FormData objects and their associated status that match the filters of the provided request that are\n * owned by the caller. Note: Only objects owned by the caller will be returned.\n * https://docs.synapse.org/rest/POST/form/data/list.html\n */\nexport const listFormData = (\n  request: ListRequest,\n  sessionToken: string | undefined,\n): Promise<ListResponse> => {\n  return doPost(\n    `/repo/v1/form/data/list`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * List FormData objects and their associated status that match the filters of the provided request for the entire\n * group. This is used by service accounts to process submissions.\n * https://docs.synapse.org/rest/POST/form/data/list/reviewer.html\n */\nexport const listFormDataAsFormAdmin = (\n  request: ListRequest,\n  sessionToken: string | undefined,\n): Promise<ListResponse> => {\n  return doPost(\n    `/repo/v1/form/data/list/reviewer`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Called by the form processing service to accept a submitted data.\n * https://docs.synapse.org/rest/PUT/form/data/id/accept.html\n */\nexport const acceptFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n): Promise<FormData> => {\n  return doPut(\n    `/repo/v1/form/data/${formDataId}/accept`,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Called by the form processing service to reject a submitted data.\n * https://docs.synapse.org/rest/PUT/form/data/id/reject.html\n */\nexport const rejectFormData = (\n  formDataId: string,\n  reason: string,\n  sessionToken: string | undefined,\n): Promise<FormData> => {\n  const formRejection: FormRejection = {\n    reason,\n  }\n  return doPut(\n    `/repo/v1/form/data/${formDataId}/reject`,\n    formRejection,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get Statistics\n * https://docs.synapse.org/rest/POST/statistics.html\n * Generic endpoint to retrieve statistics about objects. The user should have VIEW_STATISTICS access on the object referenced by the objectId in the request.\n */\nexport const getProjectStatistics = (\n  request: ProjectFilesStatisticsRequest,\n  sessionToken: string | undefined,\n): Promise<ProjectFilesStatisticsResponse> => {\n  return doPost(\n    `/repo/v1/statistics`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n// see https://docs.synapse.org/rest/POST/restrictionInformation.html\nexport const getRestrictionInformation = (\n  request: RestrictionInformationRequest,\n  sessionToken: string | undefined,\n): Promise<RestrictionInformationResponse> => {\n  return doPost(\n    `/repo/v1/restrictionInformation`,\n    request,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n/**\n * Returns a paginated result of access requirements associated for an entity\n *\n * See https://rest-docs.synapse.org/rest/GET/entity/id/accessRequirement.html\n *\n * @param {(string | undefined)} sessionToken token of user\n * @param {string} id id of entity\n * @param {number} [limit=50]\n * @param {number} [offset=0]\n * @returns {Promise<PaginatedResults<AccessRequirement>>}\n */\nexport const getAccessRequirement = (\n  sessionToken: string | undefined,\n  id: string,\n  limit: number = 50,\n  offset: number = 0,\n): Promise<PaginatedResults<AccessRequirement>> => {\n  const url = `/repo/v1/entity/${id}/accessRequirement?limit=${limit}&offset=${offset}`\n  return doGet<PaginatedResults<AccessRequirement>>(\n    url,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n/**\n * Get all access requirements\n */\nexport const getAllAccessRequirements = (\n  sessionToken: string | undefined,\n  id: string,\n): Promise<Array<AccessRequirement>> => {\n  // format function to be callable by getAllOfPaginatedService\n  const fn = (limit: number, offset: number) => {\n    const url = `/repo/v1/entity/${id}/accessRequirement?limit=${limit}&offset=${offset}`\n    return doGet<PaginatedResults<AccessRequirement>>(\n      url,\n      sessionToken,\n      undefined,\n      BackendDestinationEnum.REPO_ENDPOINT,\n    )\n  }\n  return getAllOfPaginatedService(fn)\n}\n\n/**\n *\n *\n * @param {(string | undefined)} sessionToken user session token\n * @param {AccessApproval} accessApproval access approval request object\n * @returns {AccessApproval}\n */\nexport const postAccessApproval = async (\n  sessionToken: string | undefined,\n  accessApproval: AccessApproval,\n): Promise<AccessApproval> => {\n  return doPost<AccessApproval>(\n    'https://repo-prod.prod.sagebase.org/repo/v1/accessApproval',\n    accessApproval,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n// https://rest-docs.synapse.org/rest/GET/download/list.html\nexport const getDownloadList = (sessionToken: string | undefined) => {\n  return doGet<DownloadList>(\n    '/file/v1/download/list',\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport const getDownloadOrder = (\n  zipFileName: string | undefined,\n  sessionToken: string | undefined,\n): Promise<DownloadOrder> => {\n  const baseURL = '/file/v1/download/order'\n  const url = zipFileName ? `${baseURL}?zipFileName=${zipFileName}` : baseURL\n  return doPost(\n    url,\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\nexport type FunctionReturningPaginatedResults<T> = (\n  limit: number,\n  offset: number,\n) => Promise<PaginatedResults<T>>\n/**\n * Utility function to get all the results of a paginated service\n *\n * @template T Type of paginated service\n * @param {FunctionReturningPaginatedResults<T>} fn Function that returns a paginated synapse object, accepts a limit and offset\n * @returns\n */\nexport const getAllOfPaginatedService = async <T>(\n  fn: FunctionReturningPaginatedResults<T>,\n) => {\n  const limit = 50\n  let offset = 0\n  let existsMoreData = true\n  const results: T[] = []\n\n  while (existsMoreData) {\n    try {\n      const data = await fn(limit, offset)\n      results.push(...data.results)\n      offset += data.results.length\n      if (data.results.length < limit) {\n        existsMoreData = false\n      }\n    } catch (e) {\n      throw Error(`Error on getting paginated results ${e}`)\n    }\n  }\n\n  return results\n}\n\n// https://rest-docs.synapse.org/rest/POST/download/list/remove.html\nexport const deleteDownloadListFiles = (\n  list: FileHandleAssociation[],\n  sessionToken: string | undefined,\n): Promise<DownloadList> => {\n  return doPost(\n    '/file/v1/download/list/remove',\n    { list },\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n\n// https://rest-docs.synapse.org/rest/DELETE/download/list.html ?\nexport const deleteDownloadList = (sessionToken: string | undefined) => {\n  return doDelete(\n    '/file/v1/download/list',\n    undefined,\n    sessionToken,\n    undefined,\n    BackendDestinationEnum.REPO_ENDPOINT,\n  )\n}\n","import * as React from 'react'\nimport ButtonContent from '../assets/ButtonContent'\nimport GoogleIcon from '../assets/GoogleIcon'\nimport { SynapseClient } from '../utils'\nimport {\n  getEndpoint,\n  BackendDestinationEnum,\n} from '../utils/functions/getEndpoint'\n\ntype State = {\n  username: string\n  password: string\n  email: string\n  isSignedIn: boolean\n  hasLoginInFailed: boolean\n  errorMessage: string\n}\n\ntype Props = {\n  theme: string\n  icon: boolean\n  googleRedirectUrl?: string\n  redirectUrl?: string // will redirect here after a successful login. if unset, reload the current page url.\n  sessionCallback: Function // Callback is invoked after login\n}\n\n/**\n *  Demo of user session, show login screen and handling user login submission.\n *\n *  To support Google SSO in your portal, you must add your domain to the Authorized Redirect URIs\n *  for Synapse authentication.\n *  This can be done by contacting synapseInfo@sagebionetworks.org to form a collaboration.\n *  Synapse engineers must add your redirect URL in the Google API console found at https://console.cloud.google.com/ for this functionality to work.\n *\n * @class Login\n * @extends {React.Component}\n */\nclass Login extends React.Component<Props, State> {\n  authenticationReceiptKey = 'last_user_authentication_receipt'\n\n  /**\n   * Creates a user session, maintaining credentials\n   * @param {*} props\n   * @memberof Login\n   */\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      email: '',\n      errorMessage: '',\n      hasLoginInFailed: false,\n      isSignedIn: false,\n      password: '',\n      username: '',\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.handleLogin = this.handleLogin.bind(this)\n    this.getLoginFailureView = this.getLoginFailureView.bind(this)\n    this.onGoogleSignIn = this.onGoogleSignIn.bind(this)\n  }\n  /**\n   * Updates internal state with the event that was triggered\n   *\n   * @param {*} event Form update\n   */\n  public handleChange(event: React.FormEvent<HTMLInputElement>): void {\n    const target = event.currentTarget\n    const name = target.name\n    const value = target.value\n    const newState: Pick<any, any> = { [name]: value }\n    this.setState(newState)\n  }\n  /**\n   * Handle user login on click\n   *\n   * @param {*} clickEvent Userclick event\n   */\n  public async handleLogin(clickEvent: React.FormEvent<HTMLElement>) {\n    clickEvent.preventDefault() // avoid page refresh\n    try {\n      // get last valid receipt\n      const authenticationReceipt = localStorage.getItem(\n        this.authenticationReceiptKey,\n      )\n      const data = await SynapseClient.login(\n        this.state.username,\n        this.state.password,\n        authenticationReceipt,\n      )\n      // now get session token from cookie has to be called in the portals repo\n      await SynapseClient.setSessionTokenCookie(\n        data.sessionToken,\n        this.props.sessionCallback,\n      )\n      // Set the new receipt\n      localStorage.setItem(\n        this.authenticationReceiptKey,\n        data.authenticationReceipt,\n      )\n    } catch (err) {\n      console.log('Error on login: ', err.reason)\n      this.setState({\n        errorMessage: err.reason,\n        hasLoginInFailed: true,\n        isSignedIn: false,\n      })\n    }\n  }\n\n  /**\n   * Shows user login failure view on login failure\n   *\n   * @returns view to be displayed on user sign in error.\n   */\n  public getLoginFailureView(): JSX.Element | boolean {\n    if (this.state.hasLoginInFailed) {\n      return (\n        <div>\n          <small className=\"form-text text-danger\">\n            {this.state.errorMessage}\n          </small>\n          <div className=\"invalid-feedback\" />\n        </div>\n      )\n    }\n    return false\n  }\n\n  public onGoogleSignIn(event: React.MouseEvent<HTMLButtonElement>) {\n    // save current route (so that we can go back here after SSO)\n    localStorage.setItem('after-sso-login-url', window.location.href)\n    event.preventDefault()\n    const redirectUrl = this.props.googleRedirectUrl\n      ? this.props.googleRedirectUrl\n      : `${SynapseClient.getRootURL()}?provider=${SynapseClient.AUTH_PROVIDER}`\n    SynapseClient.oAuthUrlRequest(SynapseClient.AUTH_PROVIDER, redirectUrl)\n      .then((data: any) => {\n        const authUrl = data.authorizationUrl\n        window.location = authUrl // ping the url\n      })\n      .catch((err: any) => {\n        console.log('Error on oAuth url ', err)\n      })\n  }\n  public render() {\n    const { theme, icon } = this.props\n    const googleTheme =\n      theme === 'dark'\n        ? 'SRC-google-button-dark-color'\n        : 'SRC-google-button-light-color'\n    return (\n      <div\n        id=\"loginPage\"\n        className=\"container loginContainer SRC-syn-border-spacing\"\n      >\n        <form>\n          <button\n            onClick={this.onGoogleSignIn}\n            className={`SRC-google-button ${googleTheme} SRC-marginBottomTen`}\n          >\n            <GoogleIcon key={1} active={true} />\n            <ButtonContent icon={icon} key={2}>\n              Sign in with Google\n            </ButtonContent>\n          </button>\n        </form>\n        <div className=\"SRC-center-text SRC-deemphasized-text SRC-marginBottomTen\">\n          or\n        </div>\n\n        <div className=\"SRC-centerAndJustifyContent SRC-marginBottomTen\">\n          <img\n            height=\"20px\"\n            style={{ marginRight: '10px' }}\n            alt={'sage bionetworks logo'}\n            src=\"https://s3.amazonaws.com/static.synapse.org/sage-bionetworks-logo.svg\"\n          />\n          Sign in with your Sage Bionetworks Synapse account\n        </div>\n        <form onSubmit={this.handleLogin} className=\"form-group\">\n          <input\n            autoComplete=\"username\"\n            placeholder=\"username or email\"\n            className=\"form-control SRC-marginBottomTop\"\n            id=\"exampleEmail\"\n            name=\"username\"\n            type=\"text\"\n            value={this.state.username}\n            onChange={this.handleChange}\n          />\n          <input\n            autoComplete=\"password\"\n            placeholder=\"password\"\n            className=\"form-control SRC-marginBottomTop\"\n            id=\"examplePassword\"\n            name=\"password\"\n            type=\"password\"\n            value={this.state.password}\n            onChange={this.handleChange}\n          />\n          {this.getLoginFailureView()}\n          <button\n            onSubmit={this.handleLogin}\n            type=\"submit\"\n            className=\"btn SRC-primary-background-color SRC-hoverWhiteText\n              SRC-whiteText m-1 SRC-google-button SRC-marginBottomTen\"\n          >\n            <ButtonContent icon={icon}>Sign in</ButtonContent>\n          </button>\n        </form>\n        <div>\n          <a\n            href={`${getEndpoint(\n              BackendDestinationEnum.PORTAL_ENDPOINT,\n            )}#!PasswordReset:0`}\n            className=\"SRC-floatLeft SRC-primary-text-color\"\n          >\n            Forgot password?\n          </a>\n          <span className=\"SRC-deemphasized-text SRC-floatRight\">\n            &nbsp;It's free!\n          </span>\n          <a\n            href={`${getEndpoint(\n              BackendDestinationEnum.PORTAL_ENDPOINT,\n            )}#!RegisterAccount:0`}\n            className=\"SRC-floatRight SRC-primary-text-color\"\n          >\n            Register\n          </a>\n        </div>\n      </div>\n    )\n  }\n}\nexport default Login\n","const COLOR_PALETTE_EVEN: string[] = [\n  'rgb(91,176,181)',\n  'rgb(124,192,196)',\n  'rgb(157,208,211)',\n  'rgb(189,223,225)',\n  'rgb(222,239,240)',\n  'rgb(217,229,236)',\n  'rgb(179,202,217)',\n  'rgb(140,176,198)',\n  'rgb(102,149,179)',\n  'rgb(64,123,160)',\n  'rgb(201,66,129)',\n  'rgb(212,104,154)',\n  'rgb(223,142,179)',\n  'rgb(233,179,205)',\n  'rgb(244,217,230)',\n  'rgb(218,214,229)',\n  'rgb(181,173,203)',\n  'rgb(145,133,177)',\n  'rgb(108,92,151)',\n  'rgb(71,51,125)',\n  'rgb(222,154,31)',\n  'rgb(229,174,76)',\n  'rgb(235,194,121)',\n  'rgb(242,215,165)',\n  'rgb(248,235,210)',\n  'rgb(207,234,231)',\n  'rgb(159,212,207)',\n  'rgb(112,191,184)',\n  'rgb(64,169,160)',\n  'rgb(16,148,136)',\n  'rgb(60,74,99)',\n  'rgb(99,110,130)',\n  'rgb(138,146,161)',\n  'rgb(177,183,193)',\n  'rgb(216,219,224)',\n  'rgb(246,226,210)',\n  'rgb(238,197,165)',\n  'rgb(229,167,120)',\n  'rgb(221,138,75)',\n  'rgb(212,109,30)',\n  'rgb(88,161,88)',\n  'rgb(121,180,121)',\n  'rgb(155,199,155)',\n  'rgb(188,217,188)',\n  'rgb(222,236,222)',\n  'rgb(220,227,242)',\n  'rgb(185,198,230)',\n  'rgb(151,170,217)',\n  'rgb(116,141,205)',\n  'rgb(81,113,192)',\n  'rgb(178,36,42)',\n  'rgb(193,80,85)',\n  'rgb(209,124,127)',\n  'rgb(224,167,170)',\n  'rgb(240,211,212)',\n  'rgb(222,239,240)',\n  'rgb(189,223,225)',\n  'rgb(157,208,211)',\n  'rgb(124,192,196)',\n  'rgb(91,176,181)',\n  'rgb(64,123,160)',\n  'rgb(102,149,179)',\n  'rgb(140,176,198)',\n  'rgb(179,202,217)',\n  'rgb(217,229,236)',\n  'rgb(244,217,230)',\n  'rgb(233,179,205)',\n  'rgb(223,142,179)',\n  'rgb(212,104,154)',\n  'rgb(201,66,129)',\n  'rgb(71,51,125)',\n  'rgb(108,92,151)',\n  'rgb(145,133,177)',\n  'rgb(181,173,203)',\n  'rgb(218,214,229)',\n  'rgb(248,235,210)',\n  'rgb(242,215,165)',\n  'rgb(235,194,121)',\n  'rgb(229,174,76)',\n  'rgb(222,154,31)',\n  'rgb(16,148,136)',\n  'rgb(64,169,160)',\n  'rgb(112,191,184)',\n  'rgb(159,212,207)',\n  'rgb(207,234,231)',\n  'rgb(216,219,224)',\n  'rgb(177,183,193)',\n  'rgb(138,146,161)',\n  'rgb(99,110,130)',\n  'rgb(60,74,99)',\n  'rgb(212,109,30)',\n  'rgb(221,138,75)',\n  'rgb(229,167,120)',\n  'rgb(238,197,165)',\n  'rgb(246,226,210)',\n  'rgb(222,236,222)',\n  'rgb(188,217,188)',\n  'rgb(155,199,155)',\n  'rgb(121,180,121)',\n  'rgb(88,161,88)',\n  'rgb(81,113,192)',\n  'rgb(116,141,205)',\n  'rgb(151,170,217)',\n  'rgb(185,198,230)',\n  'rgb(220,227,242)',\n  'rgb(240,211,212)',\n  'rgb(224,167,170)',\n  'rgb(209,124,127)',\n  'rgb(193,80,85)',\n  'rgb(178,36,42)',\n]\n\nconst COLOR_PALETTE_ODD: string[] = [\n  'rgb(64,123,160)',\n  'rgb(102,149,179)',\n  'rgb(140,176,198)',\n  'rgb(179,202,217)',\n  'rgb(217,229,236)',\n  'rgb(244,217,230)',\n  'rgb(233,179,205)',\n  'rgb(223,142,179)',\n  'rgb(212,104,154)',\n  'rgb(201,66,129)',\n  'rgb(71,51,125)',\n  'rgb(108,92,151)',\n  'rgb(145,133,177)',\n  'rgb(181,173,203)',\n  'rgb(218,214,229)',\n  'rgb(248,235,210)',\n  'rgb(242,215,165)',\n  'rgb(235,194,121)',\n  'rgb(229,174,76)',\n  'rgb(222,154,31)',\n  'rgb(16,148,136)',\n  'rgb(64,169,160)',\n  'rgb(112,191,184)',\n  'rgb(159,212,207)',\n  'rgb(207,234,231)',\n  'rgb(216,219,224)',\n  'rgb(177,183,193)',\n  'rgb(138,146,161)',\n  'rgb(99,110,130)',\n  'rgb(60,74,99)',\n  'rgb(212,109,30)',\n  'rgb(221,138,75)',\n  'rgb(229,167,120)',\n  'rgb(238,197,165)',\n  'rgb(246,226,210)',\n  'rgb(222,236,222)',\n  'rgb(188,217,188)',\n  'rgb(155,199,155)',\n  'rgb(121,180,121)',\n  'rgb(88,161,88)',\n  'rgb(81,113,192)',\n  'rgb(116,141,205)',\n  'rgb(151,170,217)',\n  'rgb(185,198,230)',\n  'rgb(220,227,242)',\n  'rgb(240,211,212)',\n  'rgb(224,167,170)',\n  'rgb(209,124,127)',\n  'rgb(193,80,85)',\n  'rgb(178,36,42)',\n  'rgb(91,176,181)',\n  'rgb(124,192,196)',\n  'rgb(157,208,211)',\n  'rgb(189,223,225)',\n  'rgb(222,239,240)',\n  'rgb(217,229,236)',\n  'rgb(179,202,217)',\n  'rgb(140,176,198)',\n  'rgb(102,149,179)',\n  'rgb(64,123,160)',\n  'rgb(201,66,129)',\n  'rgb(212,104,154)',\n  'rgb(223,142,179)',\n  'rgb(233,179,205)',\n  'rgb(244,217,230)',\n  'rgb(218,214,229)',\n  'rgb(181,173,203)',\n  'rgb(145,133,177)',\n  'rgb(108,92,151)',\n  'rgb(71,51,125)',\n  'rgb(222,154,31)',\n  'rgb(229,174,76)',\n  'rgb(235,194,121)',\n  'rgb(242,215,165)',\n  'rgb(248,235,210)',\n  'rgb(207,234,231)',\n  'rgb(159,212,207)',\n  'rgb(112,191,184)',\n  'rgb(64,169,160)',\n  'rgb(16,148,136)',\n  'rgb(60,74,99)',\n  'rgb(99,110,130)',\n  'rgb(138,146,161)',\n  'rgb(177,183,193)',\n  'rgb(216,219,224)',\n  'rgb(246,226,210)',\n  'rgb(238,197,165)',\n  'rgb(229,167,120)',\n  'rgb(221,138,75)',\n  'rgb(212,109,30)',\n  'rgb(88,161,88)',\n  'rgb(121,180,121)',\n  'rgb(155,199,155)',\n  'rgb(188,217,188)',\n  'rgb(222,236,222)',\n  'rgb(220,227,242)',\n  'rgb(185,198,230)',\n  'rgb(151,170,217)',\n  'rgb(116,141,205)',\n  'rgb(81,113,192)',\n  'rgb(178,36,42)',\n  'rgb(193,80,85)',\n  'rgb(209,124,127)',\n  'rgb(224,167,170)',\n  'rgb(240,211,212)',\n  'rgb(222,239,240)',\n  'rgb(189,223,225)',\n  'rgb(157,208,211)',\n  'rgb(124,192,196)',\n  'rgb(91,176,181)',\n]\n\nexport { COLOR_PALETTE_EVEN, COLOR_PALETTE_ODD }\n","import {\n  COLOR_PALETTE_EVEN,\n  COLOR_PALETTE_ODD,\n} from '../utils/functions/colorPalette'\n\nexport function rgba2rgb(background: number[], color: number[]) {\n  const alpha = color[3]\n  return [\n    Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5),\n    Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5),\n    Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5),\n  ]\n}\n\nexport function getColorPallette(\n  start: number,\n  end: number,\n): { colorPalette: string[]; textColors: string[] } {\n  let colorPalleteSelection = []\n  const textColors = []\n  let offset = -1\n\n  if (start % 2 === 0) {\n    colorPalleteSelection = COLOR_PALETTE_EVEN\n    offset = start * 5\n  } else {\n    colorPalleteSelection = COLOR_PALETTE_ODD\n    offset = (start - 1) * 5\n  }\n\n  const colorPalette: string[] = []\n\n  for (let i = 0; i < end; i += 1) {\n    const textColor: string = i % 10 < 2 || i % 10 > 7 ? 'white' : 'black'\n    const color: string = `${\n      colorPalleteSelection[(offset + i) % colorPalleteSelection.length]\n    }`\n    colorPalette.push(color)\n    textColors.push(textColor)\n  }\n  return { colorPalette, textColors }\n}\n\nexport default getColorPallette\n","import { FacetSelection } from '../../containers/QueryWrapper'\nimport { QueryBundleRequest } from '../synapseTypes/'\nimport { FacetColumnValuesRequest } from '../synapseTypes/'\nimport { SELECT_SINGLE_FACET } from '../../containers/Facets'\nimport { FacetColumnResultValueCount } from '../synapseTypes/'\n\n/**\n *  Calculates the state of a specific facet value given the current state\n *  of the application.\n *\n * @param\n *     isLoading: boolean | undefined,\n *     lastFacetSelection: FacetSelection | undefined,\n *     curFacetSelection: any,\n *     columnName: string\n * @returns boolean\n */\n\nexport const getIsValueSelected = ({\n  isLoading,\n  lastFacetSelection,\n  curFacetSelection,\n  columnName,\n}: {\n  isLoading: boolean | undefined\n  lastFacetSelection: FacetSelection | undefined\n  curFacetSelection: FacetColumnResultValueCount\n  columnName: string\n}) => {\n  if (isLoading && columnName === lastFacetSelection!.columnName) {\n    // indicates there is a selection made with this current facet value\n    if (lastFacetSelection!.facetValue === curFacetSelection.value) {\n      return !curFacetSelection.isSelected\n    }\n    if (lastFacetSelection!.selector === SELECT_SINGLE_FACET) {\n      return false\n    }\n  }\n  /*\n    else, the information has come back from the server and we can\n    rely on that\n  */\n  return curFacetSelection.isSelected\n}\n\nexport type SyntheticHTMLInputElement = {\n  value: string\n  checked: boolean\n}\n\n/**\n * Function reads over a set of checkboxes and then returns a corresponding\n * queryRequest given the state of the prior queryRequest\n *   htmlCheckboxes: any,\n *   selector : string,\n *   queryRequest: QueryBundleRequest,\n *   facet: string,\n *   value?: string\n * }\n * @returns\n */\nexport const readFacetValues = ({\n  htmlCheckboxes,\n  selector,\n  queryRequest,\n  facet,\n  value,\n}: {\n  htmlCheckboxes: SyntheticHTMLInputElement[]\n  selector: string\n  queryRequest: QueryBundleRequest\n  facet: string\n  value?: string\n}) => {\n  const facetValues: string[] = []\n\n  if (!selector) {\n    // no selector was clicked -- read over facet values as normal and see what was clicked\n    for (let i = 0; i < htmlCheckboxes.length; i += 1) {\n      const checkbox = htmlCheckboxes[i]\n      const isSelected = checkbox.checked\n      if (isSelected) {\n        facetValues.push(checkbox.value)\n      }\n    }\n  } else if (selector === SELECT_SINGLE_FACET) {\n    // SELECT_SINGLE_FACET acts as a radio selection, thats the only selection\n    facetValues.push(value!)\n  } // else selector === SELECT_ALL, we don't add any values, empty is treated as SELECT_ALL\n  const newQueryRequest: QueryBundleRequest = queryRequest\n  const { selectedFacets = [] } = newQueryRequest.query\n\n  const specificFacet = selectedFacets!.find(el => el.columnName === facet)!\n  if (!specificFacet) {\n    const facetColumnValuesRequest: FacetColumnValuesRequest = {\n      facetValues,\n      concreteType:\n        'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n      columnName: facet,\n    }\n    selectedFacets.push(facetColumnValuesRequest)\n    // align the reference to selectedFacets\n    newQueryRequest.query.selectedFacets = selectedFacets\n  } else {\n    specificFacet.facetValues = facetValues\n  }\n\n  return { newQueryRequest }\n}\n","export const TOOLTIP_DELAY_SHOW = 500\nexport const SELECT_ALL = 'SELECT_ALL';\nexport const DESELECT_ALL = 'DESELECT_ALL';\nexport const DOWNLOAD_FILES_MENU_TEXT = 'Download Files'; // double check these icons!\nexport const ICON_STATE: string[] = ['sort-amount-down', 'sort-amount-down', 'sort-amount-up'];\n  ","import { SynapseClient } from '..'\nimport { UserProfile } from '../synapseTypes/'\n\n/*\n  Utility functions for UserCards\n*/\n\nfunction getUserProfileWithProfilePicAttached(\n  principalIds: string[],\n  token?: string,\n) {\n  return SynapseClient.getUserProfiles(principalIds).then(data => {\n    // people will either have a profile pic file handle id\n    // or they won't. Have to break this down into two groups.\n    const withProfilePic = data.list.filter((value: any) => {\n      return value.profilePicureFileHandleId !== undefined\n    })\n    if (withProfilePic.length === 0) {\n      return data\n    }\n    const fileHandleAssociationList = withProfilePic.map(value => {\n      return {\n        associateObjectId: value.ownerId,\n        associateObjectType: 'UserProfileAttachment',\n        fileHandleId: value.profilePicureFileHandleId,\n      }\n    })\n    const request: any = {\n      includeFileHandles: false,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    return SynapseClient.getFiles(request, token)\n      .then(fileHandleList => {\n        // we retrieve all the persons with profile pic file handles\n        // so we next loop through them, find the original person in the data.list\n        // and add a field with their pre-signed url\n        fileHandleList.requestedFiles.forEach(fileHandle => {\n          const matchingPersonIndex = data.list.findIndex(el => {\n            return fileHandle.fileHandleId === el.profilePicureFileHandleId\n          })\n          data.list[matchingPersonIndex].clientPreSignedURL =\n            fileHandle.preSignedURL\n        })\n        return Promise.resolve(data)\n      })\n      .catch(err => {\n        throw Error(`Err on getting user data ${err}`)\n      })\n  })\n}\n\ntype UserProfileAndImg = {\n  userProfile: UserProfile\n  preSignedURL: string\n}\nfunction getUserProfileWithProfilePic(\n  ownerId: string,\n  token?: string,\n): Promise<UserProfileAndImg> {\n  return SynapseClient.getUserProfileById(token, ownerId).then(\n    (userProfile: UserProfile) => {\n      // people will either have a profile pic file handle id\n      // or they won't. Have to break this down into two groups.\n      if (!userProfile.profilePicureFileHandleId) {\n        return Promise.resolve({ userProfile }) as any\n      }\n\n      const fileHandleAssociationList = [\n        {\n          associateObjectId: ownerId,\n          associateObjectType: 'UserProfileAttachment',\n          fileHandleId: userProfile.profilePicureFileHandleId,\n        },\n      ]\n\n      const request: any = {\n        includeFileHandles: false,\n        includePreSignedURLs: true,\n        includePreviewPreSignedURLs: false,\n        requestedFiles: fileHandleAssociationList,\n      }\n\n      return SynapseClient.getFiles(request, token)\n        .then(fileHandleList => {\n          // we retrieve all the persons with profile pic file handles\n          // so we next loop through them, find the original person in the data.list\n          // and add a field with their pre-signed url\n          const firstElement = fileHandleList.requestedFiles[0]\n          return Promise.resolve({\n            userProfile,\n            preSignedURL: firstElement.preSignedURL,\n          })\n        })\n        .catch(err => {\n          console.log({ err })\n        })\n    },\n  )\n}\n\nconst COLORS: string[] = [\n  'chocolate',\n  'black',\n  'firebrick',\n  'maroon',\n  'olive',\n  'green',\n  'forestgreen',\n  'darkturquoise',\n  'teal',\n  'blue',\n  'navy',\n  'darkmagenta',\n  'purple',\n  'blue',\n  'orangered',\n  'blueviolet',\n]\n\nconst hash = (userName: string) => {\n  const val = userName\n    .split('')\n    .reduce(\n      (prevHash, currVal) =>\n        ((prevHash << 5) - prevHash + currVal.charCodeAt(0)) | 0,\n      0,\n    )\n  return Math.abs(val)\n}\n\nconst getColor = (userName: string) => {\n  const hashedUserName = hash(userName)\n  return COLORS[hashedUserName % COLORS.length]\n}\n\nexport {\n  getUserProfileWithProfilePicAttached,\n  getColor,\n  getUserProfileWithProfilePic,\n}\nexport default {\n  getUserProfileWithProfilePicAttached,\n  getColor,\n  getUserProfileWithProfilePic,\n}\n","import * as React from 'react'\n// ignore because this is rollup requiring imports be named a certain way\n// tslint:disable-next-line\nimport ReactTooltip from \"react-tooltip\"\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faCircle,  } from '@fortawesome/free-solid-svg-icons'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport { getColor } from '../utils/functions/getUserData'\n\nlibrary.add(faCircle)\n\nexport type UserCardSmallProps = {\n  userProfile: UserProfile\n  preSignedURL?: string\n  hideText?: boolean\n  hideTooltip?: boolean\n  link?: string\n}\n\nexport const UserCardSmall: React.FunctionComponent<UserCardSmallProps> = (\n  { userProfile, hideText = false, hideTooltip = false, preSignedURL, link }\n) => {\n  const linkLocation = link ? link : `https://www.synapse.org/#!Profile:${userProfile.ownerId}`\n  let img\n  let marginLeft\n  let label = ''\n  if (!hideTooltip) {\n    if (userProfile.displayName) {\n      label += userProfile.displayName\n    } else if (userProfile.firstName && userProfile.lastName) {\n      label += (`${userProfile.firstName} ${userProfile.lastName}`)\n    }\n    if (userProfile.userName) {\n      label += ` (${userProfile.userName})`\n    }\n    if (userProfile.position) {\n      label += ` <br/>${userProfile.position}`\n    }\n    if (userProfile.location) {\n      label += ` <br/>${userProfile.location}`\n    }\n  }\n\n  if (preSignedURL) {\n    marginLeft = '3px'\n    img = (\n      <div\n        className=\"SRC-userImgSmall\"\n        style={{ backgroundImage: `url(${preSignedURL})` }}\n        data-for={label}\n        data-tip={label}\n      />\n    )\n  } else {\n    const color = getColor(userProfile.userName)\n    marginLeft = '3px'\n    img = (\n      <div style={{ background: color }} className=\"SRC-userImgSmall SRC-centerContentInline\">\n        {(userProfile.firstName && userProfile.firstName[0]) || userProfile.userName[0]}\n      </div>\n    )\n  }\n  return (\n    <a\n      href={linkLocation}\n      className=\"SRC-userCard SRC-primary-text-color SRC-no-underline-on-hover\"\n    >\n      {img}\n        <ReactTooltip delayShow={1000} id={label} multiline={true}/>\n        {!hideText && <span className=\"SRC-primary-text-color SRC-underline-on-hover\" style={{ marginLeft, whiteSpace: 'nowrap' }}>{`@${userProfile.userName}`}</span>}\n    </a>\n  )\n}\n","import * as React from 'react'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport { SEPERATOR } from '../utils/SynapseConstants'\n\nexport type MenuAction = {\n  field: string\n  callback?: (userProfile: UserProfile) => void\n}\n\nexport type UserCardContextMenuProps = {\n  userProfile: UserProfile\n  menuActions: MenuAction[]\n}\n\nconst UserCardContextMenu: React.SFC<UserCardContextMenuProps> = (\n  props: UserCardContextMenuProps,\n) => {\n  const { menuActions = [], userProfile } = props\n  return (\n    <div className=\"dropdown open\">\n      <ul\n        className=\"dropdown-menu dropdown-menu-right\"\n        aria-labelledby=\"dropdownMenu1\"\n      >\n        {menuActions.map((menuAction, index) => {\n          const callback = () => menuAction.callback!(userProfile)\n          if (menuAction.field === SEPERATOR) {\n            return <hr className=\"SRC-break\" key={menuAction.field + index} />\n          }\n          return (\n            <li\n              key={menuAction.field}\n              style={{ listStyle: 'none' }}\n              className=\"SRC-menu-item SRC-table-dropdown-list SRC-primary-background-color-hover\"\n              onClick={callback}\n              onKeyPress={callback}\n            >\n              <button className=\"SRC-menuAction\">{menuAction.field}</button>\n            </li>\n          )\n        })}\n      </ul>\n    </div>\n  )\n}\n\nexport default UserCardContextMenu\n","import * as React from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCircle,\n  faEllipsisV,\n  faCopy,\n} from '@fortawesome/free-solid-svg-icons'\nimport { UserProfile } from '../utils/synapseTypes/'\n\nlibrary.add(faCircle)\nlibrary.add(faEllipsisV)\nlibrary.add(faCopy)\n\ntype UserCardLargeProps = {\n  userProfile: UserProfile\n}\n\n/**\n * UserCardLarge wraps around UserCardMedium\n *\n * @export UserCardLarge\n * @param {UserCardLargeProps} { userProfile }\n */\n// Disable function name because compiler has to know that its a class\n// tslint:disable-next-line:function-name\nexport function UserCardLarge({ userProfile }: UserCardLargeProps) {\n  const { summary, industry, location, url } = userProfile\n\n  return (\n    <div className=\"SRC-cardMetaData\">\n      {summary && (\n        <div>\n          <p className=\"SRC-card-metadata-title\"> Bio </p>\n          <p>{summary}</p>\n        </div>\n      )}\n      {url && (\n        <div>\n          <p className=\"SRC-card-metadata-title\"> More Info </p>\n          <p>{url}</p>\n        </div>\n      )}\n      {industry && (\n        <div>\n          <p className=\"SRC-card-metadata-title\"> Industry </p>\n          <p>{industry}</p>\n        </div>\n      )}\n      {location && (\n        <div>\n          <p className=\"SRC-card-metadata-title\"> Location </p>\n          <p>{location}</p>\n        </div>\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\n\nconst svg = (\n  <svg width=\"12\" height=\"14\" viewBox=\"0 0 12 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      // tslint:disable-next-line:max-line-length\n      d=\"M10.7368 12.7273H3.78947V3.81818H10.7368V12.7273ZM10.7368 2.54545H3.78947C3.45446 2.54545 3.13317 2.67954 2.89629 2.91823C2.6594 3.15691 2.52632 3.48063 2.52632 3.81818V12.7273C2.52632 13.0648 2.6594 13.3885 2.89629 13.6272C3.13317 13.8659 3.45446 14 3.78947 14H10.7368C11.0719 14 11.3931 13.8659 11.63 13.6272C11.8669 13.3885 12 13.0648 12 12.7273V3.81818C12 3.48063 11.8669 3.15691 11.63 2.91823C11.3931 2.67954 11.0719 2.54545 10.7368 2.54545V2.54545ZM8.8421 0H1.26316C0.928148 0 0.606858 0.134091 0.36997 0.372773C0.133082 0.611456 0 0.935179 0 1.27273V10.1818H1.26316V1.27273H8.8421V0Z\"\n      fill=\"#DCDCDC\"\n    />\n  </svg>\n)\nexport default svg\n","import * as React from 'react'\nimport { CSSTransition, TransitionGroup } from 'react-transition-group'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCircle,\n  faEllipsisV,\n  faCopy,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { getColor } from '../utils/functions/getUserData'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport UserCardContextMenu, { MenuAction } from './UserCardContextMenu'\nimport { UserCardLarge } from './UserCardLarge'\nimport IconCopy from '../assets/icons/IconCopy'\n\nlibrary.add(faCircle)\nlibrary.add(faEllipsisV)\nlibrary.add(faCopy)\n\ntype UserCardState = {\n  showModal: boolean\n  isContextMenuOpen: boolean\n}\n\nexport type UserCardMediumProps = {\n  userProfile: UserProfile\n  menuActions?: MenuAction[]\n  preSignedURL?: string\n  hideEmail?: boolean\n  isLarge?: boolean\n  link?: string\n  disableLink?: boolean\n}\n\nexport default class UserCardMedium extends React.Component<\n  UserCardMediumProps,\n  UserCardState\n> {\n  public htmlDivRef = React.createRef<HTMLDivElement>()\n\n  constructor(props: UserCardMediumProps) {\n    super(props)\n    this.state = {\n      showModal: false,\n      isContextMenuOpen: false,\n    }\n  }\n\n  /**\n   * Function handles copying to clipboard the user's email address\n   *\n   * @param {string} value the email address of the user\n   * @returns\n   */\n  public copyToClipboard = (value: string) => (event: React.SyntheticEvent) => {\n    event.preventDefault()\n    // https://hackernoon.com/copying-text-to-clipboard-with-javascript-df4d4988697f\n    // this copies the email to the clipoard\n    const el = document.createElement('textarea')\n    el.value = value\n    el.setAttribute('readonly', '')\n    el.style.position = 'absolute'\n    el.style.left = '-9999px'\n    this.htmlDivRef.current!.appendChild(el)\n    el.select()\n    document.execCommand('copy')\n    this.htmlDivRef.current!.removeChild(el)\n    // show modal and hide after 4 seconds, the timing is per Material Design\n    this.setState({ showModal: true })\n    // hide after 4 seconds\n    setTimeout(() => {\n      this.setState({ showModal: false })\n    }, 4000)\n  }\n\n  public toggleContextMenu = (_event: any) => {\n    this.setState({ isContextMenuOpen: !this.state.isContextMenuOpen })\n  }\n\n  public componentDidMount() {\n    // SWC-4778: https://stackoverflow.com/questions/23821768/how-to-listen-for-click-events-that-are-outside-of-a-component\n    window.addEventListener('mouseup', this.pageClick, false)\n  }\n\n  public componentWillUnmount() {\n    window.removeEventListener('mouseup', this.pageClick, false)\n  }\n\n  public pageClick = (_event: any) => {\n    if (!this.state.isContextMenuOpen) {\n      return\n    }\n    // hide content menu (deferred, to allow menu action to process)\n    setTimeout(() => {\n      if (this.state.isContextMenuOpen) {\n        this.toggleContextMenu(_event)\n      }\n    }, 10)\n  }\n\n  render() {\n    const {\n      userProfile,\n      menuActions,\n      isLarge = false,\n      preSignedURL,\n      hideEmail = false,\n      disableLink = false,\n      link,\n    } = this.props\n    const { isContextMenuOpen, showModal } = this.state\n    const {\n      displayName,\n      userName,\n      firstName,\n      lastName,\n      position,\n      company,\n    } = userProfile\n    let img\n    let name = ''\n    const linkLocation = link\n      ? link\n      : `https://www.synapse.org/#!Profile:${userProfile.ownerId}`\n    // linkLocation is overriden by custom click handler\n    const email = `${userName}@synapse.org`\n    if (displayName) {\n      name = displayName\n    } else if (firstName && lastName) {\n      name = `${firstName} ${lastName}`\n    } else if (userName) {\n      name = userName\n    }\n    if (preSignedURL) {\n      img = (\n        <div\n          style={{ backgroundImage: `url(${preSignedURL})` }}\n          className=\"SRC-userImg\"\n        />\n      )\n    } else {\n      img = (\n        <div\n          style={{ background: getColor(userName) }}\n          className=\"SRC-userImg SRC-centerContentInline\"\n        >\n          {userProfile.firstName &&\n            (userProfile.firstName[0] || userProfile.userName[0])}\n        </div>\n      )\n    }\n    const mediumCard = (\n      <React.Fragment>\n        {!hideEmail && (\n          <TransitionGroup>\n            {showModal && (\n              <CSSTransition\n                key={email}\n                classNames=\"SRC-card\"\n                timeout={{ enter: 500, exit: 300 }}\n              >\n                <div key={email} className=\"SRC-modal\">\n                  Email address copied to clipboard\n                </div>\n              </CSSTransition>\n            )}\n          </TransitionGroup>\n        )}\n        {disableLink && img}\n        {!disableLink && (\n          <a\n            href={linkLocation}\n            className={`SRC-no-underline-on-hover ${\n              isLarge ? 'SRC-isLargeCard' : ''\n            }`}\n          >\n            {img}\n          </a>\n        )}\n        <div className=\"SRC-cardContent\">\n          <p className=\"SRC-eqHeightRow SRC-userCardName\">\n            {/*\n              if its a medium component the header should be clickable (unless disableLink is set),\n              if its large then it should NOT be clickable\n            */}\n            {/* make SRC-whiteText overridable with a good name! */}\n            {isLarge || disableLink ? (\n              <span className={isLarge ? 'SRC-whiteText' : 'SRC-blackText'}>\n                {name}\n              </span>\n            ) : (\n              // consolidate click events\n              <a\n                href={linkLocation}\n                tabIndex={0}\n                className={'SRC-hand-cursor SRC-primary-text-color'}\n              >\n                {name}\n              </a>\n            )}\n          </p>\n          {(position || company) && (\n            <p className={`${isLarge ? 'SRC-whiteText' : ''}`}>\n              {position} {position ? ' / ' : ''} {company}\n            </p>\n          )}\n          {!hideEmail && (\n            <p\n              className={`${\n                isLarge\n                  ? 'SRC-whiteText'\n                  : 'SRC-primary-text-color SRC-primary-color-hover'\n              }\n              SRC-hand-cursor SRC-eqHeightRow SRC-inlineFlex SRC-emailText SRC-cardSvg`}\n              onClick={this.copyToClipboard(email)}\n              onKeyPress={this.copyToClipboard(email)}\n              tabIndex={0}\n              ref={this.htmlDivRef}\n            >\n              <span style={{ paddingRight: '5px' }}>\n                {`${userName}@synapse.org`}\n              </span>\n              {IconCopy}\n            </p>\n          )}\n        </div>\n        {/* conditionally render menu actions, if its not defined then we don't show the button */}\n        {menuActions && (\n          <React.Fragment>\n            <span\n              className={`SRC-extraPadding SRC-hand-cursor SRC-primary-background-color-hover SRC-inlineBlock\n              SRC-cardMenuButton ${\n                isContextMenuOpen ? 'SRC-primary-background-color' : ''\n              }`}\n              style={{ outline: 'none' }}\n              tabIndex={0}\n              onClick={this.toggleContextMenu}\n              onKeyPress={this.toggleContextMenu}\n            >\n              <FontAwesomeIcon\n                className={\n                  isContextMenuOpen || isLarge\n                    ? 'SRC-whiteText'\n                    : 'SRC-primary-text-color'\n                }\n                icon=\"ellipsis-v\"\n                fixedWidth={true}\n              />\n            </span>\n            {isContextMenuOpen && (\n              <UserCardContextMenu\n                menuActions={menuActions}\n                userProfile={userProfile}\n              />\n            )}\n          </React.Fragment>\n        )}\n        {!menuActions && <span style={{ padding: '0px 0px 0px 35px' }} />}\n      </React.Fragment>\n    )\n\n    if (!isLarge) {\n      return (\n        <div\n          style={{ border: '1px solid #DDDDDF' }}\n          className={`SRC-userCard SRC-userCardMediumUp ${\n            isContextMenuOpen ? 'SRC-hand-cursor' : ''\n          }`}\n          onClick={isContextMenuOpen ? this.toggleContextMenu : undefined}\n        >\n          {mediumCard}\n        </div>\n      )\n    }\n    // else return medium card inside large component\n    // when the component is large we have to set the click handler to wrap both the top and bottom portion\n    return (\n      <div\n        style={{ boxShadow: '0px 4px 4px rgba(0, 0, 0, 0.25)' }}\n        className={isContextMenuOpen ? 'SRC-hand-cursor' : ''}\n        onClick={isContextMenuOpen ? this.toggleContextMenu : undefined}\n      >\n        <div\n          className={`SRC-primary-background-color SRC-userCard SRC-userCardMediumUp ${\n            isContextMenuOpen ? 'SRC-hand-cursor' : ''\n          }`}\n        >\n          {mediumCard}\n        </div>\n        {isLarge ? <UserCardLarge userProfile={userProfile} /> : false}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { getUserProfileWithProfilePic } from '../utils/functions/getUserData'\nimport { getPrincipalAliasRequest } from '../utils/SynapseClient'\nimport { MenuAction } from './UserCardContextMenu'\nimport { UserProfile } from '../utils/synapseTypes/'\nimport { SynapseConstants } from '../utils/'\nimport { UserCardSmall } from './UserCardSmall'\nimport UserCardMedium from './UserCardMedium'\n\ntype UserCardState = {\n  userProfile: UserProfile | undefined\n  preSignedURL: string\n  isLoading: boolean\n}\n\nexport type UserCardSize =\n  | 'SMALL USER CARD'\n  | 'MEDIUM USER CARD'\n  | 'LARGE USER CARD'\n\nexport type UserCardProps = {\n  // Note - either specify userProfile OR (alias or ownerId)\n  userProfile?: UserProfile\n  loadingScreen?: JSX.Element\n  hideEmail?: boolean\n  preSignedURL?: string\n  alias?: string\n  ownerId?: string\n  size: UserCardSize\n  hideText?: boolean\n  hideTooltip?: boolean\n  menuActions?: MenuAction[]\n  link?: string\n  disableLink?: boolean\n}\n\nexport default class UserCard extends React.Component<\n  UserCardProps,\n  UserCardState\n> {\n  constructor(props: any) {\n    super(props)\n    this.state = { userProfile: undefined, isLoading: true, preSignedURL: '' }\n    this.getUserProfile = this.getUserProfile.bind(this)\n  }\n\n  public componentDidMount() {\n    const { userProfile, ownerId, alias } = this.props\n    if (userProfile) {\n      return\n    }\n    if (alias) {\n      getPrincipalAliasRequest('', alias, 'USER_NAME').then(\n        (aliasData: any) => {\n          this.getUserProfile(aliasData.principalId!)\n        },\n      )\n    } else {\n      // check for ownerId!\n      this.getUserProfile(ownerId!)\n    }\n  }\n\n  public getUserProfile(ownerId: string) {\n    getUserProfileWithProfilePic(ownerId!, '')\n      .then(data => {\n        const { userProfile, preSignedURL } = data\n        this.setState({ userProfile, preSignedURL, isLoading: false })\n      })\n      .catch(err => {\n        console.log('failed to get user bundle ', err)\n      })\n  }\n\n  public render() {\n    const {\n      userProfile,\n      loadingScreen = <span />,\n      preSignedURL,\n      size,\n      ...rest\n    } = this.props\n    let userProfileAtRender\n    let preSignedURLAtRender\n    if (!userProfile) {\n      // userProfile wans't passed in from props\n      if (this.state.isLoading) {\n        // still making the API call\n        return loadingScreen\n      }\n      userProfileAtRender = this.state.userProfile\n      preSignedURLAtRender = this.state.preSignedURL\n    } else {\n      // otherwise we have the profile from props\n      userProfileAtRender = userProfile\n      preSignedURLAtRender = preSignedURL\n    }\n    const propsForChild = {\n      userProfile: userProfileAtRender!,\n      preSignedURL: preSignedURLAtRender,\n      ...rest,\n    }\n    switch (size) {\n      case SynapseConstants.SMALL_USER_CARD:\n        return <UserCardSmall {...propsForChild} />\n      case SynapseConstants.MEDIUM_USER_CARD:\n        return <UserCardMedium {...propsForChild} />\n      case SynapseConstants.LARGE_USER_CARD:\n        return <UserCardMedium isLarge={true} {...propsForChild} />\n      default:\n        return <span />\n    }\n  }\n}\n","import * as React from 'react'\n\ntype BookmarksProps = {\n  footnotes: string\n}\n\nclass Bookmarks extends React.Component<BookmarksProps, {}> {\n  constructor(props: BookmarksProps) {\n    super(props)\n    this.renderBookmarks = this.renderBookmarks.bind(this)\n  }\n\n  /**\n   * Returns bookmarks\n   *\n   * @returns JSX for the embedded bookmarks in the markdown passed in as a prop\n   * @memberof Bookmarks\n   */\n  public renderBookmarks() {\n    const copyFootnotes: string = String(this.props.footnotes)\n\n    // find all the links embedded in the markdown below\n    const regex = /Synapse widget&gt;<\\/span>(.*)</g\n    let matchedGroup: RegExpExecArray | null\n    const output = []\n    // below we use regex.exec to find the find matched group containing the citation source\n    while ((matchedGroup = regex.exec(copyFootnotes))) {\n      output.push(matchedGroup[1])\n    }\n\n    // return all the links formatted accordingly\n    return output.map((el, index) => {\n      const isBeforeLastElement = index < output.length - 1\n      return (\n        <React.Fragment key={index}>\n          <button className=\"SRC-markdown-bookmark\" id={`bookmark${index}`}>\n            [{index + 1}]\n          </button>\n          <span dangerouslySetInnerHTML={{ __html: el }} />\n          {isBeforeLastElement && <br />}\n        </React.Fragment>\n      )\n    })\n  }\n\n  public render() {\n    return (\n      <React.Fragment>\n        <hr />\n        {this.renderBookmarks()}\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Bookmarks\n","import * as React from 'react'\nimport { getEntity, getFiles } from '../../utils/SynapseClient'\nimport {\n  BatchFileRequest,\n  BatchFileResult,\n  FileEntity,\n  FileHandle,\n  FileHandleAssociateType,\n  FileHandleAssociation,\n} from '../../utils/synapseTypes/'\n\ntype SynapseImageProps = {\n  wikiId?: string\n  synapseId?: string\n  token?: string\n  fileName?: string\n  fileResults?: FileHandle[]\n  params: any\n}\n\ntype SynapseImageState = {\n  preSignedURL: string\n}\n\nclass SynapseImage extends React.Component<\n  SynapseImageProps,\n  SynapseImageState\n> {\n  constructor(props: SynapseImageProps) {\n    super(props)\n    this.getEntity = this.getEntity.bind(this)\n    this.getSynapseFiles = this.getSynapseFiles.bind(this)\n    this.state = {\n      preSignedURL: '',\n    }\n  }\n\n  public getEntity() {\n    const { token, synapseId } = this.props\n    if (synapseId) {\n      getEntity<FileEntity>(token, synapseId).then(\n        // https://docs.synapse.org/rest/org/sagebionetworks/repo/model/FileEntity.html\n        (data: FileEntity) => {\n          const fileHandleAssociationList = [\n            {\n              associateObjectId: synapseId,\n              associateObjectType: FileHandleAssociateType.FileEntity,\n              fileHandleId: data.dataFileHandleId,\n            },\n          ]\n          this.getSynapseFiles(fileHandleAssociationList, data.dataFileHandleId)\n        },\n      )\n    }\n  }\n  public getSynapseFiles(\n    fileHandleAssociationList: FileHandleAssociation[],\n    id: string,\n  ) {\n    // overload the method for two different use cases, one where\n    // the image is attached to an entity and creates a list on the spot,\n    // the other where list is passed in from componentDidMount in MarkdownSynapse\n    const request: BatchFileRequest = {\n      includeFileHandles: false,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList,\n    }\n    getFiles(request, this.props.token)\n      .then((data: BatchFileResult) => {\n        const { preSignedURL } = data.requestedFiles.filter(\n          el => el.fileHandleId === id,\n        )[0]\n        this.setState({\n          preSignedURL: preSignedURL!,\n        })\n      })\n      .catch(err => {\n        console.error('Error on getting image ', err)\n      })\n  }\n  public componentDidMount() {\n    if (!this.props.wikiId) {\n      // Get file handle as external attachment\n      this.getEntity()\n    } else {\n      // Can get presigned url right away from wiki association\n      const { fileName, fileResults = [] } = this.props\n      const { id } = fileResults.filter(el => el.fileName === fileName)[0]\n      const fileHandleAssociationList: FileHandleAssociation[] = [\n        {\n          associateObjectId: this.props.wikiId,\n          associateObjectType: FileHandleAssociateType.WikiAttachment,\n          fileHandleId: id,\n        },\n      ]\n      this.getSynapseFiles(fileHandleAssociationList, id)\n    }\n  }\n\n  public render() {\n    const imgStyle: React.CSSProperties = {}\n    const { params = {} } = this.props\n    const { align = '' } = params\n    const alignLowerCase = align.toLowerCase()\n    let className = ''\n    if (alignLowerCase === 'left') {\n      className = 'floatLeft'\n    }\n    if (alignLowerCase === 'right') {\n      className = 'floatright'\n    }\n    if (alignLowerCase === 'center') {\n      className = 'align-center'\n    }\n    if (!this.state.preSignedURL) {\n      return null\n    }\n    return (\n      <React.Fragment>\n        <img\n          alt=\"synapse\"\n          className={'img-fluid  ' + className}\n          src={this.state.preSignedURL}\n          style={imgStyle}\n        />\n      </React.Fragment>\n    )\n  }\n}\nexport default SynapseImage\n","import * as React from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faLongArrowAltUp,\n  faLongArrowAltDown,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { DOI_REGEX } from '../../../containers/GenericCard'\nlibrary.add(faLongArrowAltUp)\nlibrary.add(faLongArrowAltDown)\n\ntype State = {\n  isShowMoreOn: boolean\n  isDesktop: boolean\n}\n\ntype CardFooterProps = {\n  values: any[]\n  isHeader: boolean\n  secondaryLabelLimit?: number\n}\n\n// regex to see if string is url - https://stackoverflow.com/a/3809435\nconst URL_REGEX = /[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)?/gi\n\nclass CardFooter extends React.Component<CardFooterProps, State> {\n  constructor(props: CardFooterProps) {\n    super(props)\n    this.state = {\n      isShowMoreOn: false,\n      isDesktop: false,\n    }\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n    this.updatePredicate = this.updatePredicate.bind(this)\n  }\n\n  toggleShowMore() {\n    this.setState({\n      isShowMoreOn: !this.state.isShowMoreOn,\n    })\n  }\n\n  componentDidMount() {\n    this.updatePredicate()\n    window.addEventListener('resize', this.updatePredicate)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updatePredicate)\n  }\n\n  updatePredicate() {\n    this.setState({ isDesktop: window.innerWidth > 600 })\n  }\n\n  renderRowValue = (columnName: string, value: string) => {\n    let textColorClass = this.props.isHeader ? 'SRC-lightLink' : ''\n    if (!value.match) {\n      // value can sometimes be a react element, so it doesn't have a .match function, interestingly I didn't\n      // see typeof return 'object' for that case which would be a better check.\n      return value\n    }\n    if (value.match(DOI_REGEX)) {\n      return (\n        <a\n          className={textColorClass}\n          data-search-handle={columnName}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          href={`https://dx.doi.org/${value}`}\n        >\n          {value}\n        </a>\n      )\n    } else if (value.match(URL_REGEX)) {\n      return (\n        <a\n          className={textColorClass}\n          data-search-handle={columnName}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          href={value}\n        >\n          {value}\n        </a>\n      )\n    }\n    return value\n  }\n\n  renderRows = (values: string[][], limit: number, isDesktop: boolean) => {\n    return values.map((kv, index) => {\n      const hideClass = index >= limit ? 'SRC-hidden' : ''\n      const columnName = kv[0]\n      const value = this.renderRowValue(columnName, kv[1])\n      if (isDesktop) {\n        return (\n          <tr className={'SRC-cardRowDesktop ' + hideClass} key={index}>\n            <td className={'SRC-verticalAlignTop SRC-row-label'}>\n              {columnName}\n            </td>\n            <td\n              data-search-handle={columnName}\n              className={'SRC-row-data SRC-limitMaxWidth '}\n            >\n              {value}\n            </td>\n          </tr>\n        )\n      }\n      return (\n        <React.Fragment key={index}>\n          <tr className={'SRC-cardRowMobile ' + hideClass}>\n            <td className={'SRC-verticalAlignTop SRC-row-label'}>\n              {columnName}\n            </td>\n          </tr>\n          <tr className={'SRC-cardRowMobile ' + hideClass}>\n            <td\n              data-search-handle={columnName}\n              className=\"SRC-row-data SRC-limitMaxWidth\"\n            >\n              {value}\n            </td>\n          </tr>\n        </React.Fragment>\n      )\n    })\n  }\n\n  render() {\n    const { values, secondaryLabelLimit = 3 } = this.props\n    const { isShowMoreOn, isDesktop } = this.state\n    let valuesFiltered = values.filter(el => el[1])\n    const hasMoreValuesThanLimit = valuesFiltered.length > secondaryLabelLimit\n    const limit =\n      !hasMoreValuesThanLimit || isShowMoreOn ? Infinity : secondaryLabelLimit\n    return (\n      <div className=\"SRC-cardMetadata\">\n        <table>\n          <tbody>\n            {this.renderRows(valuesFiltered, limit, isDesktop)}\n            {hasMoreValuesThanLimit && (\n              <tr className=\"SRC-cardRow\">\n                <td>\n                  <button\n                    style={{ textAlign: 'left', margin: 0, padding: 0 }}\n                    className=\"SRC-primary-text-color SRC-basicButton\"\n                    onClick={this.toggleShowMore}\n                  >\n                    Show {isShowMoreOn ? 'Less' : 'More'}\n                    <FontAwesomeIcon\n                      style={{ marginLeft: '5px' }}\n                      icon={\n                        isShowMoreOn\n                          ? 'long-arrow-alt-up'\n                          : 'long-arrow-alt-down'\n                      }\n                    />\n                  </button>\n                </td>\n              </tr>\n            )}\n          </tbody>\n        </table>\n      </div>\n    )\n  }\n}\nexport default CardFooter\n","import * as React from 'react'\n\ntype ChipContainerProps = {\n  chips: any[]\n}\n\nconst ChipContainer: React.SFC<ChipContainerProps> = ({ chips }) => {\n  const chipsFormatted = chips.map((el, index) => {\n    if (!el) {\n      return false\n    }\n    return <span key={index}> {el}</span>\n  })\n  return <React.Fragment>{chipsFormatted}</React.Fragment>\n}\nexport default ChipContainer\n","import * as React from 'react'\nimport {\n  DATASET,\n  FUNDER,\n  PUBLICATION,\n  STUDY_ACTIVE,\n  STUDY_COMPLETE,\n  TOOL,\n  STUDY,\n  EXPERIMENTAL,\n  COMPUTATIONAL,\n  CLINICAL,\n  PROJECT,\n} from '../../../utils/SynapseConstants'\n\nimport Data2Svg from '../../../assets/icons/Data2.svg'\nimport studyActiveSvg from '../../../assets/icons/study-active.svg'\nimport studyCompleteSvg from '../../../assets/icons/study-complete.svg'\nimport DNA_TwoSvg from '../../../assets/icons/DNA_Two.svg'\n\nimport {\n  Project,\n  Publication,\n  Study,\n  ToolClinical,\n  ToolComputational,\n  ToolExperimental,\n} from '../../../assets/themed_icons'\n\nimport { KeyValue } from '../../../utils/functions/sqlFunctions'\n\ntype IconProps = {\n  type: string\n  iconOptions?: KeyValue\n  value?: string\n  isHeader?: boolean\n}\n\nconst defaultIcons = {\n  [DATASET]: Data2Svg,\n  [FUNDER]: Data2Svg,\n  [TOOL]: DNA_TwoSvg,\n  [STUDY_ACTIVE]: studyActiveSvg,\n  [STUDY_COMPLETE]: studyCompleteSvg,\n  // new icons\n  [PUBLICATION]: Publication,\n  [STUDY]: Study,\n  [EXPERIMENTAL]: ToolExperimental,\n  [COMPUTATIONAL]: ToolComputational,\n  [CLINICAL]: ToolClinical,\n  [PROJECT]: Project,\n}\nconst Icon: React.FunctionComponent<IconProps> = ({\n  type,\n  value = '',\n  iconOptions,\n}) => {\n  const iconSet = { ...defaultIcons, ...iconOptions }\n  // see if the value has a corresponding icon, e.g. 'Active' in a studies table\n  // or if the type of card has a corresponding icon, e.g. 'Publication'\n  const Icon = iconSet[value] || iconSet[type]\n  // TODO: get rid of dataset icon class, none of the icons should be special cased\n  const datasetIconClass =\n    value === DATASET || type === DATASET ? 'SRC-datasetIcon' : ''\n  if (typeof Icon == 'function') {\n    return <Icon />\n  }\n  return <img src={Icon} className={`iconImg ${datasetIconClass}`} />\n}\nexport default Icon\n","import * as React from 'react'\n\nexport const Publication = () => (\n  <svg width=\"61\" height=\"76\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M60.047 0H.953C.427 0 0 .387 0 .864v74.272c0 .477.427.864.953.864h59.094c.526 0 .953-.387.953-.864V.864C61 .387 60.573 0 60.047 0zm-.953 74.273H1.906V1.727h57.188v72.546z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n    <path\n      d=\"M11.438 44.91c1.51 0 2.802-.802 3.42-1.955l8.988 1.629c-.006.108-.018.215-.018.325 0 1.666.745 3.175 1.948 4.268l-5.867 7.088a3.09 3.09 0 0 0-.846-.129c-1.58 0-2.86 1.16-2.86 2.591 0 1.431 1.28 2.591 2.86 2.591 1.58 0 2.86-1.16 2.86-2.59 0-.532-.178-1.025-.481-1.436l5.859-7.078c.95.472 2.04.74 3.2.74 1.233 0 2.385-.309 3.376-.837l8.83 10.003c-.477.576-.77 1.285-.77 2.062 0 1.908 1.708 3.454 3.813 3.454 2.106 0 3.813-1.546 3.813-3.454 0-1.908-1.707-3.455-3.813-3.455a4.11 4.11 0 0 0-1.557.308l-8.828-9.999c1.118-1.08 1.807-2.53 1.807-4.127 0-.49-.071-.963-.192-1.418l9.52-3.45c.694.853 1.803 1.414 3.063 1.414 2.105 0 3.812-1.547 3.812-3.455 0-1.908-1.707-3.455-3.812-3.455-2.106 0-3.813 1.547-3.813 3.455 0 .149.029.29.049.434l-9.527 3.452c-.823-1.288-2.153-2.277-3.746-2.737l2.123-11.544c1.945-.156 3.476-1.62 3.476-3.423 0-1.908-1.707-3.455-3.812-3.455-2.106 0-3.813 1.547-3.813 3.455 0 1.408.933 2.614 2.267 3.152L30.645 38.87c-.049 0-.096-.006-.145-.006-.734 0-1.438.111-2.099.31l-3.469-6.288c.495-.466.803-1.097.803-1.795 0-1.431-1.28-2.591-2.86-2.591-1.58 0-2.86 1.16-2.86 2.59 0 1.432 1.28 2.592 2.86 2.592.12 0 .232-.02.347-.032l3.474 6.296c-1.134.715-2.008 1.743-2.478 2.944L15.23 41.26C15.116 39.445 13.47 38 11.438 38c-2.106 0-3.813 1.547-3.813 3.455 0 1.907 1.707 3.454 3.813 3.454z\"\n      className=\"SRC-icon-fill\"\n    />\n    <path\n      d=\"M30.5 6.045H7.625v1.728H30.5V6.045zM22.875 9.932H7.625v.864h15.25v-.864z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n  </svg>\n)\n","import * as React from 'react'\n\nexport const Study = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M39.456 57.627a2.799 2.799 0 0 0 2.79 2.801 2.798 2.798 0 0 0 2.787-2.8 2.798 2.798 0 0 0-2.788-2.803 2.8 2.8 0 0 0-2.789 2.802zm3.628 0a.843.843 0 0 1-.84.844.843.843 0 0 1-.84-.844c0-.467.376-.845.84-.845.464 0 .84.379.84.845z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n    <path\n      d=\"M37.349 21.019H28.92v1.957h8.428V21.02zM26.25 21H12v1.958h14.25V21zM26.34 24.933h-9.107v1.957h9.107v-1.957zM34.678 24.933h-5.757v1.958h5.757v-1.958zM14.667 24.933h-2.576v1.958h2.576v-1.958zM31.537 28.849h-5.213v1.957h5.212V28.85zM23.741 28.849h-11.65v1.957h11.65V28.85zM19.848 32.764H12.11v1.957h7.738v-1.957zM30.828 32.764h-8.4v1.958h8.4v-1.958zM20.533 36.678h-8.442v1.958h8.442v-1.958zM12.006 40.604l.004 1.957 5.874-.011-.004-1.958-5.874.012zM36.447 11.23H15v1.958h21.447V11.23zM32.674 16H19v1.958h13.674V16z\"\n      className=\"SRC-icon-fill\"\n    />\n    <path\n      d=\"M50.885 60.866h-2.834v-3.45C55.071 54.356 60 47.334 60 39.166c0-6.868-3.531-13.209-9.277-16.838l2.065-3.593 1.682.976.974-1.695-1.682-.976-8.757-5.081-1.693-.982-.974 1.695 1.692.982-1.824 3.174V6.054L7.791 6v25.527H0v14.87c0 2.24 1.59 4.112 3.694 4.538v.092l31.436.042-2.903 6.34.978.371c1.03.392 2.085.69 3.157.901v2.185H24.674V70h26.211c2.526 0 4.58-2.05 4.58-4.568s-2.054-4.566-4.58-4.566zM7.791 46.398a2.667 2.667 0 0 1-2.658 2.67h-.528a2.667 2.667 0 0 1-2.657-2.67V33.485h5.843v12.913zm41.19-7.232a8.82 8.82 0 0 1-6.775 8.58V37.153l2.998-5.219a8.789 8.789 0 0 1 3.776 7.232zM38.39 36.171l-2.063 3.59-2.612-1.517 2.062-3.59 2.613 1.517zM51.1 17.757L40.964 35.404l-5.385-3.124 10.14-17.647.538.313 4.845 2.81zM8.888 49.076a4.61 4.61 0 0 0 .852-2.678V7.96l30.52.048v12.21l-7.342 12.779 1.173.68-3.036 5.285 5.986 3.472 3.037-5.284.182.106v10.729l-.056.002a8.768 8.768 0 0 1-1.643-.161l1.164-2.026-13.412-7.781a1.87 1.87 0 0 0-.94-.254 1.89 1.89 0 0 0-1.633.945l-.451.787a1.901 1.901 0 0 0 .69 2.586L36.04 49.08l-.014.032-27.139-.036zm27.79-1.887l-11.67-6.77.387-.672 11.67 6.77-.388.672zm1.226 2.506c.753.166 1.523.25 2.3.25 5.914 0 10.726-4.835 10.726-10.779a10.75 10.75 0 0 0-4.266-8.606l2.619-5.723.474-.824a17.968 17.968 0 0 1 8.296 15.153c0 7.166-4.21 13.353-10.27 16.222-.708-2.176-2.74-3.756-5.135-3.756h-.88c-2.847 0-5.18 2.23-5.383 5.046a16.918 16.918 0 0 1-1.5-.388l3.019-6.595zm8.2 7.382v7.052h-7.792v-7.053c0-1.921 1.55-3.485 3.456-3.485h.88c1.906 0 3.456 1.564 3.456 3.486zm4.782 10.965H26.623v-5.219h9.74v3.263H48.05v-3.263h2.835c1.45 0 2.631 1.17 2.631 2.61.001 1.44-1.18 2.61-2.63 2.61z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n  </svg>\n)\n","import * as React from 'react'\n\nexport const ToolExperimental = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <g clipPath=\"url(#clip1)\">\n        <g clipPath=\"url(#clip2)\">\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M23.602 4c-.599 0-1.077.4-1.077.902v1.904c0 .602.478 1.003 1.077 1.003V26.85L10.556 46.496c-3.35 4.41-1.077 7.917 5.147 7.917h31.595c6.224 0 8.498-3.507 5.147-7.917L39.4 26.85V7.81c.598 0 1.077-.401 1.077-1.003V4.902c0-.501-.479-.902-1.077-.902H23.602zm.598 30.669l-9.335 14.032-.12.1c-.12.2-.598.902-.718 1.303.36.1 1.436.1 1.676.1h31.595c.24 0 1.317 0 1.676-.1-.12-.401-.598-1.103-.838-1.303v-.2l-9.335-13.932h-14.6zm3.232-27.462v20.446L13.787 48.1v.1c-1.676 2.205-1.197 3.007 1.915 3.007h31.595c3.112 0 3.591-.802 1.915-3.007v-.1L35.45 27.653V7.207h-8.019z\"\n            fill=\"#DCDCDC\"\n            className=\"SRC-header-only-fill\"\n          />\n          <path\n            d=\"M38.5 34.5h-14L14.5 50h34l-10-15.5z\"\n            fill=\"#5BB0B5\"\n            className=\"SRC-icon-fill\"\n          />\n        </g>\n      </g>\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <path fill=\"#fff\" d=\"M0 0h61v76H0z\" />\n      </clipPath>\n      <clipPath id=\"clip1\">\n        <path\n          fill=\"#fff\"\n          transform=\"matrix(.69 0 0 .69 2 4)\"\n          d=\"M0 0h85.507v85.507H0z\"\n        />\n      </clipPath>\n      <clipPath id=\"clip2\">\n        <path\n          fill=\"#fff\"\n          transform=\"matrix(.69 0 0 .69 9 4)\"\n          d=\"M0 0h65.217v73.063H0z\"\n        />\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import * as React from 'react'\n\nexport const ToolComputational = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <path\n        d=\"M55.513 13H4.537A2.518 2.518 0 0 0 2 15.537V51.94c0 1.357 1.121 2.537 2.537 2.537h20.532v4.602h-4.543c-.708 0-1.239.59-1.239 1.239v2.36c0 .708.59 1.239 1.239 1.239h19.057c.708 0 1.239-.59 1.239-1.239v-2.36c0-.708-.59-1.239-1.239-1.239H35.04v-4.602h20.532a2.518 2.518 0 0 0 2.537-2.537V15.537C58.05 14.121 56.929 13 55.513 13zM30.025 51.704c-.944 0-1.77-.767-1.77-1.77 0-.944.767-1.77 1.77-1.77.944 0 1.77.767 1.77 1.77 0 1.003-.826 1.77-1.77 1.77zm23.482-6.077H6.543V17.543h46.964v28.084z\"\n        fill=\"#DCDCDC\"\n        className=\"SRC-header-only-fill\"\n      />\n      <path\n        d=\"M20.29 38.827a.68.68 0 0 0 .908 0l1.623-1.57a.627.627 0 0 0 0-.878l-4.01-3.879 4.01-3.88a.627.627 0 0 0 0-.877l-1.623-1.57a.68.68 0 0 0-.908 0l-6.111 5.865a.627.627 0 0 0 0 .878l6.111 5.91zM38.226 37.257l1.614 1.57c.238.23.665.23.903 0l6.079-5.911a.63.63 0 0 0 0-.878l-6.127-5.865a.674.674 0 0 0-.902 0l-1.615 1.57a.63.63 0 0 0 0 .878l3.99 3.879-3.99 3.88c-.19.23-.19.646.048.877z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M27.558 39h1.74c.255 0 .467-.167.51-.376l4.159-11.872c.127-.376-.127-.752-.51-.752h-1.74c-.254 0-.466.167-.509.376l-4.16 11.872c-.169.376.128.752.51.752z\"\n        fill=\"#DCDCDC\"\n        className=\"SRC-header-only-fill\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <path\n          fill=\"#fff\"\n          transform=\"matrix(.69 0 0 .69 2 13)\"\n          d=\"M0 0h82.609v73.913H0z\"\n        />\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import * as React from 'react'\n\nexport const ToolClinical = () => (\n  <svg width=\"61\" height=\"76\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      d=\"M54.878 1.124A3.804 3.804 0 0 0 52.175 0H45.8c-.705 0-1.274.573-1.274 1.279v2.557c0 .707.57 1.279 1.274 1.279h5.1v9.913c0 3.083-1.976 5.705-3.573 8.181-2.511 3.894-8.191 3.894-10.703.002-1.652-2.56-3.573-4.99-3.573-8.183V5.115h5.1c.705 0 1.275-.572 1.275-1.279V1.279C39.426.573 38.856 0 38.15 0h-6.374a3.81 3.81 0 0 0-2.705 1.124 3.828 3.828 0 0 0-1.12 2.713v8.549c0 4.436 1.34 8.565 3.598 12.379 4.024 6.794 7.877 9.084 7.77 12.776-.07 2.368 0 4.742 0 7.113 0 5.64-4.577 10.23-10.2 10.23h-2.444c-5.624 0-10.2-4.59-10.2-10.23v-9.223a8.945 8.945 0 0 0 6.375-8.576c0-4.943-3.997-8.952-8.925-8.952-4.93 0-8.925 4.009-8.925 8.952a8.944 8.944 0 0 0 6.375 8.576v9.222C11.377 53.13 18.225 60 26.675 60h2.445c8.449 0 15.3-6.871 15.3-15.346v-4.139c0-1.953-.054-5.56.797-7.319 2.834-2.275 6.055-4.642 7.755-8.099C55.375 21.373 56 16.822 56 12.387v-8.55a3.83 3.83 0 0 0-1.122-2.713zM9.145 26.855c0-2.642 2.146-4.795 4.781-4.795s4.781 2.153 4.781 4.795c0 2.644-2.146 4.796-4.78 4.796-2.637 0-4.782-2.152-4.782-4.796z\"\n      fill=\"#DCDCDC\"\n      className=\"SRC-header-only-fill\"\n    />\n    <path\n      fillRule=\"evenodd\"\n      clipRule=\"evenodd\"\n      d=\"M14 36a9 9 0 1 0 0-18 9 9 0 0 0 0 18zm0-4a5 5 0 1 0 0-10 5 5 0 0 0 0 10z\"\n      className=\"SRC-icon-fill\"\n    />\n  </svg>\n)\n","import * as React from 'react'\n\nexport const Project = () => (\n  <svg width=\"60\" height=\"60\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <g clipPath=\"url(#clip0)\">\n      <path\n        d=\"M30 22a7.99 7.99 0 0 0-5.757 13.54 4.99 4.99 0 0 1 2.355-2.9 5 5 0 1 1 6.8 0 4.99 4.99 0 0 1 2.355 2.9A7.99 7.99 0 0 0 30 22z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M30 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM26.008 36.922a7.93 7.93 0 0 0 7.984 0A3 3 0 0 0 31 34h-2a3 3 0 0 0-2.992 2.922zM50.62 8.805a2.973 2.973 0 0 1 .259-3.926A3 3 0 0 1 56 6.999a2.972 2.972 0 0 1-.619 1.8 4 4 0 0 1 1.273 1.584 5 5 0 1 0-7.308 0 4 4 0 0 1 1.273-1.578z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M53 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM51.04 11.6a4.973 4.973 0 0 0 3.919 0 2 2 0 0 0-3.918 0zM53 54a1 1 0 1 0 0-2 1 1 0 0 0 0 2zM53 56a2 2 0 0 0-1.96 1.6 4.978 4.978 0 0 0 3.914 0A1.994 1.994 0 0 0 53 56z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M53 48a4.983 4.983 0 0 0-3.654 8.388 4 4 0 0 1 1.273-1.583 2.972 2.972 0 0 1 .26-3.926A3 3 0 0 1 55.998 53a2.967 2.967 0 0 1-.618 1.8c.554.409.993.955 1.273 1.584A4.982 4.982 0 0 0 53 48zM5.04 11.6a4.973 4.973 0 0 0 3.919 0 2 2 0 0 0-3.918 0zM7 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M4.619 8.805a2.972 2.972 0 0 1 .26-3.926A3 3 0 0 1 10 6.999a2.972 2.972 0 0 1-.619 1.8 4 4 0 0 1 1.273 1.584 5 5 0 1 0-7.308 0 4 4 0 0 1 1.273-1.578z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M29.562 9.981a5 5 0 1 0 0 0zM28.072 2.7a2.976 2.976 0 0 1 2.196-.688 3 3 0 1 1-2.144 5.328 3 3 0 0 1-.051-4.64z\"\n        className=\"SRC-header-only-fill\"\n        fill=\"#DDDDDF\"\n      />\n      <path\n        d=\"M7 56a2 2 0 0 0-1.96 1.6 4.973 4.973 0 0 0 3.919 0 2 2 0 0 0-1.96-1.6zM7 54a1 1 0 1 0 0-2 1 1 0 0 0 0 2z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M7 48a4.983 4.983 0 0 0-3.654 8.388 4 4 0 0 1 1.273-1.583 2.972 2.972 0 0 1 .26-3.926A3 3 0 0 1 9.999 53a2.972 2.972 0 0 1-.618 1.8 4 4 0 0 1 1.273 1.583A4.981 4.981 0 0 0 7 48z\"\n        className=\"SRC-icon-fill\"\n      />\n      <path\n        d=\"M18 29h-2v2h2v-2zM14 29h-2v2h2v-2zM48 29h-2v2h2v-2zM44 29h-2v2h2v-2zM31 16h-2v2h2v-2zM31 12h-2v2h2v-2zM31 46h-2v2h2v-2zM31 42h-2v2h2v-2zM29.562 50.019a5 5 0 1 0 .876 9.96 5 5 0 1 0-.876-9.96zm3.426 4.718a3 3 0 1 1-5.978.527 3 3 0 0 1 5.978-.528zM10 30a5 5 0 1 0-5 5 5.006 5.006 0 0 0 5-5zm-8 0a3 3 0 1 1 6 0 3 3 0 0 1-6 0zM55 25a5 5 0 1 0 5 5 5.006 5.006 0 0 0-5-5zm0 8a3 3 0 1 1 0-6 3 3 0 0 1 0 6zM40.7 22.787a16.249 16.249 0 0 0 9.258-10.512l-1.922-.55a14.263 14.263 0 0 1-8.124 9.224l-.309.132.788 1.838.309-.132zM49.961 47.725A16.248 16.248 0 0 0 40.7 37.213l-.309-.132-.788 1.838.309.132a14.261 14.261 0 0 1 8.124 9.224l1.925-.55zM11.961 11.725l-1.922.55A16.248 16.248 0 0 0 19.3 22.787l.31.132.787-1.838-.309-.132a14.263 14.263 0 0 1-8.127-9.224zM19.3 37.213a16.247 16.247 0 0 0-9.258 10.512l1.922.55a14.264 14.264 0 0 1 8.124-9.224l.309-.132-.788-1.838-.31.132z\"\n        fill=\"#DDDDDF\"\n        className=\"SRC-header-only-fill\"\n      />\n    </g>\n    <defs>\n      <clipPath id=\"clip0\">\n        <path fill=\"#fff\" d=\"M0 0h60v60H0z\" />\n      </clipPath>\n    </defs>\n  </svg>\n)\n","import { CardFooter, Icon } from './row_renderers/utils'\nimport { MarkdownValue } from './CardContainerLogic'\nimport MarkdownSynapse from './MarkdownSynapse'\nimport React, { useState, useEffect } from 'react'\n\nexport type IconOptions = {\n  [index: string]: string\n}\nexport type HeaderCardProps = {\n  iconOptions?: IconOptions\n  backgroundColor?: string\n  type: string\n  title: string\n  subTitle: string\n  description: string\n  iconValue: string\n  secondaryLabelLimit?: number\n  values?: string[][]\n  isAlignToLeftNav?: boolean\n  descriptionLinkConfig?: MarkdownValue\n}\n\nconst HeaderCard: React.FunctionComponent<HeaderCardProps> = ({\n  type,\n  title,\n  subTitle,\n  description,\n  iconOptions,\n  iconValue,\n  backgroundColor,\n  values,\n  secondaryLabelLimit,\n  isAlignToLeftNav,\n  descriptionLinkConfig,\n}) => {\n  // store old document title and description so that we can restore when this component is removed\n  const descriptionElement: Element | null = document.querySelector(\n    'meta[name=\"description\"]',\n  )\n  const [docTitle] = useState<string>(document.title)\n  const [docDescription] = useState<string>(\n    descriptionElement ? descriptionElement.getAttribute('content')! : '',\n  )\n  useEffect(() => {\n    // update page title and description based on header card values\n    if (title && document.title !== title) {\n      document.title = title\n    }\n\n    if (description || subTitle) {\n      descriptionElement?.setAttribute(\n        'content',\n        description ? description : subTitle,\n      )\n    }\n\n    return function cleanup() {\n      document.title = docTitle\n      descriptionElement?.setAttribute('content', docDescription)\n    }\n  })\n\n  const style: React.CSSProperties = {\n    background: backgroundColor,\n  }\n  return (\n    <div\n      style={style}\n      className={`SRC-portalCardHeader${\n        isAlignToLeftNav ? ' isAlignToLeftNav' : ''\n      }`}\n    >\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <div\n            className={`iconContainer${\n              isAlignToLeftNav ? ' col-md-offset-1 col-md-2' : ' col-md-1'\n            }`}\n          >\n            <Icon value={iconValue} iconOptions={iconOptions} type={type} />\n          </div>\n          <div\n            className={`SRC-cardContent${\n              isAlignToLeftNav ? ' col-md-8' : ' col-md-10'\n            }`}\n          >\n            <div className=\"SRC-type\">{type}</div>\n            <div>\n              <h3\n                className=\"SRC-boldText SRC-blackText\"\n                style={{ margin: 'none' }}\n              >\n                {title}\n              </h3>\n            </div>\n            {subTitle && <div className=\"SRC-author\"> {subTitle} </div>}\n            {description && (\n              <span className=\"SRC-font-size-base\">\n                {descriptionLinkConfig ? (\n                  <MarkdownSynapse markdown={description} />\n                ) : (\n                  description\n                )}\n              </span>\n            )}\n            <div\n              style={{\n                borderTop: '1px solid rgba(26, 28, 41, 0.2)',\n                marginTop: '15px',\n                paddingTop: '5px',\n              }}\n            >\n              {values && (\n                <CardFooter\n                  isHeader={true}\n                  secondaryLabelLimit={secondaryLabelLimit}\n                  values={values}\n                />\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default HeaderCard\n","import * as React from 'react'\nconst CHAR_COUNT_CUTOFF = 400\n\ntype ShowMoreState = {\n  showMore: boolean\n}\n\ntype ShowMoreProps = {\n  summary: string\n}\n\nexport default class ShowMore extends React.Component<\n  ShowMoreProps,\n  ShowMoreState\n> {\n  constructor(props: ShowMoreProps) {\n    super(props)\n    this.state = {\n      showMore: false,\n    }\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n  }\n\n  public toggleShowMore(event: React.MouseEvent<HTMLAnchorElement>) {\n    event.preventDefault()\n    this.setState({\n      showMore: true,\n    })\n  }\n\n  getCutoff = (summary: string) => {\n    let previewText = ''\n    if (!summary) {\n      return { previewText }\n    }\n    let hiddenText = ''\n    const summarySplit = summary!.split(' ')\n    // find num words to join such that its >= char_count_cutoff\n    let i = 0\n    while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n      previewText += `${summarySplit[i]} `\n      i += 1\n    }\n    if (i < summarySplit.length - 1) {\n      hiddenText = summarySplit.slice(i).join(' ')\n    }\n    return { previewText, hiddenText }\n  }\n\n  public render() {\n    const { summary } = this.props\n    const meetsCharRequirements = summary && summary.length >= CHAR_COUNT_CUTOFF\n    let { previewText, hiddenText } = this.getCutoff(summary)\n    const showMoreButton = meetsCharRequirements && (\n      <a\n        style={{ fontSize: '14px', cursor: 'pointer', marginLeft: '1px' }}\n        className=\"SRC-primary-text-color\"\n        onClick={this.toggleShowMore}\n      >\n        ...Show More\n      </a>\n    )\n    return (\n      <React.Fragment>\n        <span>\n          {previewText}\n          <span className={this.state.showMore ? '' : 'SRC-hidden'}>\n            {hiddenText}\n          </span>\n        </span>\n        {!this.state.showMore && showMoreButton}\n      </React.Fragment>\n    )\n  }\n}\n","export const unCamelCase = (str: string | undefined): string | undefined => {\n  // https://stackoverflow.com/questions/4149276/how-to-convert-camelcase-to-camel-case\n  if (!str) {\n    return str\n  }\n  return (\n    str\n      // insert a space between lower & upper\n      .replace(/([a-z])([A-Z])/g, '$1 $2')\n      // space before last upper in a sequence followed by lower\n      .replace(/\\b([A-Z]+)([A-Z])([a-z])/, '$1 $2$3')\n      // uppercase the first character\n      .replace(/^./, (str: string) => {\n        return str.toUpperCase()\n      })\n  )\n}\n","import * as React from 'react'\nimport HeaderCard from './HeaderCard'\nimport { CardFooter, Icon } from './row_renderers/utils'\nimport {\n  CardLink,\n  CommonCardProps,\n  MarkdownLink,\n  MarkdownValue,\n} from './CardContainerLogic'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport MarkdownSynapse from './MarkdownSynapse'\nimport { SelectColumn } from '../utils/synapseTypes'\n\nexport type KeyToAlias = {\n  key: string\n  alias?: string\n}\n\nexport type KeyToAliasMap = {\n  [index: number]: KeyToAlias\n  [index: string]: KeyToAlias\n}\n\nexport type GenericCardSchema = {\n  type: string\n  title: string\n  subTitle?: string\n  description?: string\n  icon?: string\n  secondaryLabels?: any[]\n  link?: string\n}\n\nexport type IconOptions = {\n  [index: string]: string\n}\n\nexport type GenericCardProps = {\n  selectColumns?: SelectColumn[]\n  facetAliases?: {}\n  iconOptions?: IconOptions\n  backgroundColor?: string\n  isHeader?: boolean\n  isAlignToLeftNav?: boolean\n  schema: any\n  data: any\n  token?: string\n} & CommonCardProps\n\nexport type GenericCardState = {\n  hasClickedShowMore: boolean\n}\n\nconst CHAR_COUNT_CUTOFF = 400\nexport const CARD_SHORT_DESCRIPTION_CSS = 'SRC-short-description'\nexport const CARD_LONG_DESCRIPTION_CSS = 'SRC-long-description'\n\n// doi regex here - https://www.crossref.org/blog/dois-and-matching-regular-expressions/\n// note - had to add an escape character for the second slash in the regex above\nexport const DOI_REGEX = /^10.\\d{4,9}\\/[-._;()/:a-z0-9]+$/\n// check for 'syn' followed and ended by a digit of unlimited length, must also begin the line\nexport const SYNAPSE_REGX = /^syn\\d+$/\n\n// This function isn't in the class only for ease of testing with renderShortDescription\nexport const getCutoff = (summary: string) => {\n  let previewText = ''\n  const summarySplit = summary!.split(' ')\n  // find num words to join such that its >= char_count_cutoff\n  let i = 0\n  while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n    previewText += `${summarySplit[i]} `\n    i += 1\n  }\n  previewText = previewText.trim()\n  return { previewText }\n}\n\nexport default class GenericCard extends React.Component<\n  GenericCardProps,\n  GenericCardState\n> {\n  constructor(props: GenericCardProps) {\n    super(props)\n    this.state = {\n      hasClickedShowMore: false,\n    }\n    this.renderTitleLink = this.renderTitleLink.bind(this)\n    this.renderLabel = this.renderLabel.bind(this)\n    this.renderLongDescription = this.renderLongDescription.bind(this)\n    this.renderShortDescription = this.renderShortDescription.bind(this)\n  }\n\n  public renderTitleLink(\n    link: string,\n    titleLink?: CardLink,\n    data?: string[],\n    schema?: any,\n  ) {\n    let linkDisplay = link\n    let target = '_self'\n    if (link.match(SYNAPSE_REGX)) {\n      // its a synId\n      linkDisplay = `https://www.synapse.org/#!Synapse:${link}`\n    } else if (link.match(DOI_REGEX)) {\n      target = '_blank'\n      linkDisplay = `https://dx.doi.org/${link}`\n    } else if (!titleLink) {\n      target = '_blank'\n    } else if (titleLink) {\n      if (!data || !schema) {\n        throw Error('Must specify CardLink and data for linking to work')\n      }\n      const { matchColumnName, URLColumnName } = titleLink\n      const indexInData = schema[matchColumnName]\n      if (indexInData === undefined) {\n        console.error(\n          `Could not find match for data: ${data} with columnName ${matchColumnName}`,\n        )\n      } else {\n        const value = data[indexInData]\n        linkDisplay = `/${titleLink.baseURL}?${URLColumnName}=${value}`\n      }\n    }\n    return { linkDisplay, target }\n  }\n\n  getCutoff = (summary: string) => {\n    let previewText = ''\n    const summarySplit = summary!.split(' ')\n    // find num words to join such that its >= char_count_cutoff\n    let i = 0\n    while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n      previewText += `${summarySplit[i]} `\n      i += 1\n    }\n    previewText = previewText.trim()\n    return { previewText }\n  }\n\n  toggleShowMore = () => {\n    this.setState({\n      hasClickedShowMore: true,\n    })\n  }\n\n  public renderLabel(\n    value: string,\n    labelLink: CardLink | MarkdownLink,\n    isHeader: boolean,\n  ) {\n    if (labelLink.isMarkdown) {\n      return <MarkdownSynapse renderInline={true} markdown={value} />\n    }\n    const split = value.split(',')\n    let className = ''\n    const style: React.CSSProperties = {}\n    if (isHeader) {\n      className = 'SRC-lightLink'\n    } else {\n      className = 'SRC-primary-text-color'\n    }\n    return split.map((el, index) => {\n      const { baseURL, URLColumnName } = labelLink\n      const href = `/${baseURL}?${URLColumnName}=${el}`\n      return (\n        <React.Fragment key={el}>\n          <a href={href} key={el} className={className} style={style}>\n            {el}\n          </a>\n          {index < split.length - 1 && (\n            <span style={{ marginRight: 4 }}> , </span>\n          )}\n        </React.Fragment>\n      )\n    })\n  }\n\n  render() {\n    const {\n      schema,\n      data,\n      genericCardSchema,\n      secondaryLabelLimit,\n      backgroundColor,\n      selectColumns,\n      iconOptions,\n      isHeader = false,\n      titleLinkConfig,\n      labelLinkConfig,\n      facetAliases = {},\n      isAlignToLeftNav = false,\n      descriptionLinkConfig,\n    } = this.props\n    // GenericCard inherits properties from CommonCardProps so that the properties have the same name\n    // and type, but theres one nuance which is that we can't override if one specific property will be\n    // defined, so we assert genericCardSchema is not null and assign to genericCardSchemaDefined\n    const genericCardSchemaDefined = genericCardSchema!\n    const { hasClickedShowMore } = this.state\n    const { link = '', type } = genericCardSchemaDefined\n    const title = data[schema[genericCardSchemaDefined.title]]\n    const subTitle =\n      genericCardSchemaDefined.subTitle &&\n      data[schema[genericCardSchemaDefined.subTitle]]\n    const description = data[schema[genericCardSchemaDefined.description || '']]\n    const iconValue = data[schema[genericCardSchemaDefined.icon || '']]\n    // wrap link in parens because undefined would throw an error\n    const linkValue: string = data[schema[link]] || ''\n    const { linkDisplay, target } = this.renderTitleLink(\n      linkValue,\n      titleLinkConfig,\n      data,\n      schema,\n    )\n    const values: string[][] = []\n    const { secondaryLabels = [] } = genericCardSchemaDefined\n    for (let i = 0; i < secondaryLabels.length; i += 1) {\n      const columnName = secondaryLabels[i]\n      let value = data[schema[columnName]]\n\n      const selectedColumnOrUndefined = selectColumns?.find(\n        el => el.name === columnName,\n      )\n      const isMultiValue =\n        selectedColumnOrUndefined?.columnType === 'STRING_LIST' ||\n        selectedColumnOrUndefined?.columnType === 'INTEGER_LIST'\n      if (value) {\n        const labelLink =\n          labelLinkConfig &&\n          labelLinkConfig.find(el => el.matchColumnName === columnName)\n        if (labelLink) {\n          // create link for this column\n          value = this.renderLabel(value, labelLink, isHeader)\n        }\n        const columnDisplayName =\n          facetAliases[columnName] || unCamelCase(columnName)\n        if (isMultiValue) {\n          try {\n            value = JSON.parse(value)\n            value = (value as string[]).join(' , ')\n          } catch (e) {\n            console.error('Error on parsing value for ', value)\n          }\n        }\n        const keyValue = [columnDisplayName, value]\n        values.push(keyValue)\n      }\n    }\n\n    const showFooter = values.length > 0\n\n    const style: React.CSSProperties = {\n      background: backgroundColor,\n      // undefined, take default value from class\n      marginTop: isHeader ? '0px' : undefined,\n      marginBottom: isHeader ? '0px' : undefined,\n      paddingBottom: showFooter ? undefined : '15px',\n    }\n\n    if (isHeader) {\n      return (\n        <HeaderCard\n          descriptionLinkConfig={descriptionLinkConfig}\n          type={type}\n          title={title}\n          subTitle={subTitle}\n          backgroundColor={backgroundColor}\n          description={description}\n          iconValue={iconValue}\n          iconOptions={iconOptions}\n          values={values}\n          isAlignToLeftNav={isAlignToLeftNav}\n          secondaryLabelLimit={secondaryLabelLimit}\n        />\n      )\n    }\n\n    const titleSearchHandle =\n      facetAliases[genericCardSchemaDefined.title] ||\n      unCamelCase(genericCardSchemaDefined.title)\n    const stubTitleSearchHandle =\n      facetAliases[genericCardSchemaDefined.subTitle || ''] ||\n      unCamelCase(genericCardSchemaDefined.subTitle)\n    const descriptionSubTitle =\n      facetAliases[genericCardSchemaDefined.description || ''] ||\n      unCamelCase(genericCardSchemaDefined.description)\n    return (\n      <div style={style} className={'SRC-portalCard'}>\n        <div className=\"SRC-cardThumbnail\">\n          <Icon iconOptions={iconOptions} value={iconValue} type={type} />\n        </div>\n        <div className=\"SRC-cardContent\">\n          <div className=\"SRC-type\">{type}</div>\n          <div>\n            <h3\n              className=\"SRC-boldText SRC-blackText\"\n              style={{ margin: 'none' }}\n            >\n              {linkDisplay ? (\n                <a\n                  data-search-handle={titleSearchHandle}\n                  className=\"SRC-primary-text-color\"\n                  target={target}\n                  href={linkDisplay}\n                >\n                  {title}\n                </a>\n              ) : (\n                <span data-search-handle={titleSearchHandle}> {title} </span>\n              )}\n            </h3>\n          </div>\n          {subTitle && (\n            <div\n              data-search-handle={stubTitleSearchHandle}\n              className=\"SRC-author\"\n            >\n              {subTitle}\n            </div>\n          )}\n          {/* \n            Below is a hack that allows word highlighting to work, the Search component insert's\n            html elements outside of the React DOM which if detected would break the app,\n            but as written below this avoids that reconcilliation process.\n          */}\n          {description &&\n            this.renderShortDescription(\n              description,\n              hasClickedShowMore,\n              descriptionSubTitle,\n              descriptionLinkConfig,\n            )}\n          {description &&\n            this.renderLongDescription(\n              description,\n              hasClickedShowMore,\n              descriptionSubTitle,\n              descriptionLinkConfig,\n              this.props.token,\n            )}\n        </div>\n        {showFooter && (\n          <CardFooter\n            isHeader={false}\n            secondaryLabelLimit={secondaryLabelLimit}\n            values={values}\n          />\n        )}\n      </div>\n    )\n  }\n\n  public renderLongDescription(\n    description: string,\n    hasClickedShowMore: boolean,\n    descriptionSubTitle: any,\n    descriptionLinkConfig?: MarkdownValue,\n    token?: string,\n  ): React.ReactNode {\n    let content: JSX.Element | string = description\n    if (descriptionLinkConfig?.isMarkdown) {\n      content = <MarkdownSynapse token={token} markdown={content} />\n    }\n    const show = hasClickedShowMore || descriptionLinkConfig\n    return (\n      <div className={show ? '' : 'SRC-hidden'}>\n        <span\n          data-search-handle={descriptionSubTitle}\n          className={`SRC-font-size-base ${CARD_LONG_DESCRIPTION_CSS}`}\n        >\n          {content}\n        </span>\n      </div>\n    )\n  }\n\n  public renderShortDescription(\n    description: string,\n    hasClickedShowMore: boolean,\n    descriptionSubTitle: any,\n    descriptionLinkConfig?: MarkdownValue,\n  ): React.ReactNode {\n    if (descriptionLinkConfig) {\n      return <></>\n    }\n    return (\n      <div className={hasClickedShowMore ? 'SRC-hidden' : ''}>\n        <span\n          data-search-handle={descriptionSubTitle}\n          className={`SRC-font-size-base ${CARD_SHORT_DESCRIPTION_CSS} SRC-short-description`}\n        >\n          {getCutoff(description).previewText}\n        </span>\n        {description.length >= CHAR_COUNT_CUTOFF && (\n          <button\n            style={{\n              fontSize: '14px',\n              cursor: 'pointer',\n              marginLeft: '-2px',\n            }}\n            className=\"SRC-primary-text-color\"\n            onClick={this.toggleShowMore}\n          >\n            ...Show More\n          </button>\n        )}\n      </div>\n    )\n  }\n}\n","import { lexer, parser } from 'sql-parser'\nimport { SYNAPSE_REGX } from '../../containers/GenericCard'\nimport { SelectColumn, Row } from '../synapseTypes'\n\nexport type KeyValue = {\n  [index: string]: string\n}\n\nexport type SQLOperator = 'LIKE' | '='\n\n// look for \"group by\", multi-line and case insensitive\nconst GROUP_BY_REGEX = /group by/im\nexport const isGroupByInSql = (sql: string): boolean => {\n  return GROUP_BY_REGEX.test(sql)\n}\nconst WITHOUT_SYN_PREFIX = 3\n\nconst generateTokenUsingOperator = (\n  literal: string,\n  operator: SQLOperator,\n  match: string,\n) => {\n  let usedMatchForLike = match\n  if (match.match(SYNAPSE_REGX)) {\n    // If we use a LIKE statement with a synId the backend will look for a string with the first three\n    // characters being 'syn', however, it stores synIds without 'syn', so the query will fail\n    // The backend usually parses 'syn' out, but not with the LIKE clause since its expecting a regex, so we\n    // parse this out. This will cause a bug if something matches the synId regex but is in free text.\n    usedMatchForLike = match.substring(WITHOUT_SYN_PREFIX)\n  }\n  switch (operator) {\n    case 'LIKE':\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        ['STRING', `%${usedMatchForLike}%`, '1'],\n      ]\n    case '=':\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        ['STRING', match, '1'],\n      ]\n  }\n}\n\n// This will construct a sql query by adding the conditions in searchParams\n// to the WHERE clause, preserving all other clauses\nexport const insertConditionsFromSearchParams = (\n  searchParams: KeyValue,\n  sql: string,\n  operator: SQLOperator = 'LIKE',\n) => {\n  const tokens: string[][] = lexer.tokenize(sql)\n  // we want to either create a where clause or insert into the where clause\n  const foundIndex = tokens.findIndex(el => el[0] === 'WHERE')\n  const whereClauseIndex =\n    foundIndex === -1\n      ? tokens.findIndex(el => el[0] === 'FROM') + 2\n      : foundIndex\n  const indexAfterWhereClause = whereClauseIndex + 1\n  if (foundIndex === -1) {\n    // insert a where clause\n    tokens.splice(whereClauseIndex, 0, ['WHERE', 'WHERE', '1'])\n  } else {\n    // if this is inserting into a where clause then we have to make sure that the logic is chained\n    tokens.splice(indexAfterWhereClause, 0, ['CONDITIONAL', 'AND', '1'])\n  }\n  const searchParamsLen = Object.keys(searchParams).length\n  Object.keys(searchParams).forEach((key, index) => {\n    const token = generateTokenUsingOperator(key, operator, searchParams[key])\n    if (index < searchParamsLen - 1) {\n      // make sure to chain the ANDs until the last one\n      token.unshift(['CONDITIONAL', 'AND', '1'])\n    }\n    tokens.splice(indexAfterWhereClause, 0, ...token)\n  })\n  return formatSQLFromParser(tokens)\n}\n\nexport const formatSQLFromParser = (tokens: string[][]) => {\n  // remove backtick from output sql (for table name): `syn1234` becomes syn1234\n  const synId = tokens[tokens.findIndex(el => el[0] === 'FROM') + 1][1]\n  const newSql = parser.parse(tokens).toString()\n  const splitString = `\\`${synId}\\``\n  return newSql.split(splitString).join(synId)\n}\n\n//parses synapse entity id from a sql query string\n//look for a pattern of 'from[some number of spaces]syn[somenumbers]` case insensitive\nexport const parseEntityIdFromSqlStatement = (sql:string): string => {\n  const matches = sql.match(/(from)\\s+(syn)\\d+/gi)\n  return  (matches && matches[0])? matches[0].substr(5).trim() : ''\n}\n\nexport const resultToJson = <T>(  \n  headerColumns: SelectColumn[],\n     rowColumns: Row[]\n   ): T[] => {\n     const result: T[] = [];\n     const rows = rowColumns.map(row => row.values);\n     const headers = headerColumns.map(column => column.name);\n     rows.forEach((row, index) => {\n       result[index] = {} as T;\n       row.forEach((text, cellIndex) => {\n         result[index][headers[cellIndex]] = text;\n       });\n     });\n     return result;\n   };\n  \n\n","import Plotly from 'plotly.js-basic-dist'\nimport * as React from 'react'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SynapseConstants } from '../../utils/'\nimport { getFullQueryTableResults } from '../../utils/SynapseClient'\nimport { QueryResultBundle, QueryBundleRequest } from '../../utils/synapseTypes/'\nimport {parseEntityIdFromSqlStatement} from '../../utils/functions/sqlFunctions'\nconst Plot = createPlotlyComponent(Plotly)\n\ntype SynapsePlotProps = {\n  token?: string\n  ownerId?: string\n  wikiId?: string\n  widgetparamsMapped?: any\n}\n\ntype SynapsePlotState = {\n  isLoaded: boolean\n  queryData: QueryResultBundle\n}\n\nclass SynapsePlot extends React.Component<SynapsePlotProps, SynapsePlotState> {\n  constructor(props: SynapsePlotProps) {\n    super(props)\n    this.state = {\n      isLoaded: false,\n      queryData: {} as QueryResultBundle,\n    }\n    this.fetchPlotlyData = this.fetchPlotlyData.bind(this)\n    this.showPlot = this.showPlot.bind(this)\n  }\n\n  public componentDidMount() {\n    this.fetchPlotlyData()\n  }\n  /**\n   * Get data for plotly\n   *\n   * @returns data corresponding to plotly widget\n   */\n  public fetchPlotlyData() {\n    const { token } = this.props\n    const { query } = this.props.widgetparamsMapped\n    const queryRequest: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask: SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n      entityId: parseEntityIdFromSqlStatement(query),\n      query: {\n        sql: query,\n      },\n    }\n\n    getFullQueryTableResults(queryRequest, token)\n      .then((data: QueryResultBundle) => {\n        this.setState({\n          isLoaded: true,\n          queryData: data,\n        })\n      })\n      .catch((err: any) => {\n        console.log('Error on full table query ', err)\n      })\n  }\n\n  public showPlot() {\n    if (!this.state.isLoaded) {\n      return\n    }\n    const {\n      title,\n      xtitle,\n      ytitle,\n      type,\n      xaxistype,\n      showlegend,\n    } = this.props.widgetparamsMapped\n    const queryData = this.state\n    const isHorizontal = this.props.widgetparamsMapped.horizontal.toLowerCase()\n    const layout: any = {\n      showlegend,\n      title,\n    }\n    if (xtitle) {\n      layout.xaxis = {\n        title: xtitle,\n      }\n    }\n    if (xaxistype) {\n      layout.xaxis = {\n        ...layout.xaxis,\n        xaxistype: xaxistype.toLowerCase(),\n      }\n    }\n    if (ytitle) {\n      layout.yaxis = {\n        title: ytitle,\n      }\n    }\n    // init plot_data\n    const plotData: any = []\n    const orientation = isHorizontal ? 'v' : 'h'\n    const headers = queryData.queryData.queryResult.queryResults.headers\n    for (let i = 0; i < headers.length - 1; i += 1) {\n      // make an entry for each set of data points\n      plotData[i] = {\n        orientation,\n        name: headers[i + 1].name,\n        type: type.toLowerCase(),\n        x: [],\n        y: [],\n      }\n    }\n    // grab all the data\n    for (const row of queryData.queryData.queryResult.queryResults.rows) {\n      for (let j = 1; j < row.values.length; j += 1) {\n        // create pairs of data\n        const rowValues: any = row.values\n        plotData[j - 1].x.push(rowValues[0])\n        plotData[j - 1].y.push(rowValues[j])\n      }\n    }\n    return <Plot layout={layout} data={plotData} />\n  }\n\n  public render() {\n    if (!this.state.isLoaded) {\n      return null\n    }\n    return this.showPlot()\n  }\n}\nexport default SynapsePlot\n","import * as React from 'react'\nimport { SynapseClient, SynapseConstants } from '../utils'\nimport { FileHandleResults, WikiPage } from '../utils/synapseTypes/'\nimport UserCard from './UserCard'\nimport Bookmarks from './widgets/Bookmarks'\nimport SynapseImage from './widgets/SynapseImage'\nimport SynapsePlot from './widgets/SynapsePlot'\nconst TOC_CLASS = {\n  1: 'toc-indent1',\n  2: 'toc-indent2',\n  3: 'toc-indent3',\n  4: 'toc-indent4',\n  5: 'toc-indent5',\n  6: 'toc-indent6',\n}\n\ndeclare var katex: any\n\ndeclare var markdownitSynapse: any\ndeclare var markdownit: any\ndeclare var markdownitSub: any\ndeclare var markdownitSup: any\ndeclare var markdownitCentertext: any\ndeclare var markdownitSynapseHeading: any\ndeclare var markdownitSynapseTable: any\ndeclare var markdownitStrikethroughAlt: any\ndeclare var markdownitContainer: any\ndeclare var markdownitEmphasisAlt: any\ndeclare var markdownitInlineComments: any\ndeclare var markdownitBr: any\ndeclare var sanitizeHtml: any\n\ndeclare var markdownitMath: any\n\nexport type MarkdownSynapseProps = {\n  errorMessageView?: React.FunctionComponent\n  token?: string\n  ownerId?: string\n  wikiId?: string\n  markdown?: string\n  renderInline?: boolean\n}\nconst md = markdownit({ html: true })\n\ntype MarkdownSynapseState = {\n  md: any\n  data: Partial<WikiPage>\n  fileHandles?: FileHandleResults\n  errorMessage: string\n}\n/**\n * Basic Markdown functionality for Synapse, supporting Images/Plots/References/Bookmarks/buttonlinks\n *\n * @class Markdown\n * @extends {React.Component}\n */\nexport default class MarkdownSynapse extends React.Component<\n  MarkdownSynapseProps,\n  MarkdownSynapseState\n> {\n  public markupRef: React.RefObject<HTMLInputElement>\n\n  /**\n   * Creates an instance of Markdown.\n   * @param {*} props\n   */\n  constructor(props: MarkdownSynapseProps) {\n    super(props)\n    // markdownitSynapse wraps around markdownit object and uses its own dependencies\n    markdownitSynapse.init_markdown_it(\n      md,\n      markdownitSub,\n      markdownitSup,\n      markdownitCentertext,\n      markdownitSynapseHeading,\n      markdownitSynapseTable,\n      markdownitStrikethroughAlt,\n      markdownitContainer,\n      markdownitEmphasisAlt,\n      markdownitInlineComments,\n      markdownitBr,\n    )\n\n    const mathSuffix = ''\n    // Update the internal markdownit object with the wrapped synapse object\n    md.use(markdownitSynapse, mathSuffix).use(markdownitMath, mathSuffix)\n    const data: any = {}\n    if (this.props.markdown) {\n      data.markdown = this.props.markdown\n    }\n    this.state = {\n      md,\n      errorMessage: '',\n      fileHandles: undefined,\n      data,\n    }\n    this.markupRef = React.createRef()\n    this.handleLinkClicks = this.handleLinkClicks.bind(this)\n    // handle widgets and math markdown\n    this.renderMarkdown = this.renderMarkdown.bind(this)\n    this.recursiveRender = this.recursiveRender.bind(this)\n    this.processMath = this.processMath.bind(this)\n    // handle init calls to get wiki related items\n    this.getWikiAttachments = this.getWikiAttachments.bind(this)\n    this.getWikiPageMarkdown = this.getWikiPageMarkdown.bind(this)\n    // handle rendering widgets\n    this.renderWidget = this.renderWidget.bind(this)\n    this.renderSynapseButton = this.renderSynapseButton.bind(this)\n    this.renderSynapseImage = this.renderSynapseImage.bind(this)\n    this.renderSynapsePlot = this.renderSynapsePlot.bind(this)\n    this.renderSynapseTOC = this.renderSynapseTOC.bind(this)\n    this.getErrorView = this.getErrorView.bind(this)\n    this.createHTML = this.createHTML.bind(this)\n    this.addBookmarks = this.addBookmarks.bind(this)\n    this.addIdsToReferenceWidgets = this.addIdsToReferenceWidgets.bind(this)\n    this.addIdsToTocWidgets = this.addIdsToTocWidgets.bind(this)\n  }\n\n  public componentWillUnmount() {\n    // @ts-ignore TODO: find better documentation on typescript/react event params\n    this.markupRef.current!.removeEventListener('click', this.handleLinkClicks)\n  }\n\n  // Manually handle clicks to anchor tags where the scrollto isn't handled by page hash\n  public handleLinkClicks(event: React.MouseEvent<HTMLElement>) {\n    const genericElement = event.target as HTMLElement\n    if (genericElement.tagName === 'A' || genericElement.tagName === 'BUTTON') {\n      const anchor = event.target as HTMLAnchorElement\n      if (anchor.id.substring(0, 3) === 'ref') {\n        event.preventDefault()\n        // its a reference, so we scroll to the appropriate bookmark\n        const referenceNumber = Number(event.currentTarget.id.substring(3)) // e.g. ref2 => '2'\n        const goTo = this.markupRef.current!.querySelector(\n          `#bookmark${referenceNumber}`,\n        )\n        try {\n          goTo!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center',\n          })\n        } catch (e) {\n          console.log('error on scroll', e)\n        }\n      } else if (\n        event.currentTarget.id !== null &&\n        anchor.getAttribute('data-anchor')\n      ) {\n        event.preventDefault()\n        // handle table of contents widget\n        const idOfContent = anchor.getAttribute('data-anchor')\n        const goTo = this.markupRef.current!.querySelector(`#${idOfContent}`)\n        try {\n          goTo!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center',\n          })\n        } catch (e) {\n          console.log('error on scroll', e)\n        }\n      }\n    }\n  }\n\n  /**\n   * Given input text, generate markdown object to be passed onto inner html of some container.\n   * @param {String} markdown The text being written in plain markdown\n   * @returns {Object} Dictionary to be passed into dangerouslySetInnerHTML with markdown text\n   */\n  public createHTML(markdown?: string) {\n    if (!markdown) {\n      return { __html: '' }\n    }\n    // Note - renderInline parses out any block level elements contained in the markdown\n    const initText = this.props.renderInline\n      ? this.state.md.renderInline(markdown)\n      : this.state.md.render(markdown)\n    const cleanText = sanitizeHtml(initText, {\n      allowedAttributes: {\n        a: ['href', 'target'],\n        button: ['class'],\n        div: ['class', 'style'],\n        h1: ['toc'],\n        h2: ['toc'],\n        h3: ['toc'],\n        h4: ['toc'],\n        h5: ['toc'],\n        h6: ['toc'],\n        li: ['class'],\n        ol: ['class'],\n        span: ['*'],\n        table: ['class'],\n        th: ['colspan'],\n        thead: ['class'],\n        ul: ['class'],\n        img: ['src', 'alt'],\n      },\n      allowedTags: [\n        'span',\n        'code',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'p',\n        'b',\n        'i',\n        'em',\n        'strong',\n        'a',\n        'id',\n        'table',\n        'tr',\n        'td',\n        'tbody',\n        'th',\n        'thead',\n        'button',\n        'div',\n        'img',\n        'image',\n        'ol',\n        'ul',\n        'li',\n        'svg',\n        'g',\n        'br',\n        'hr',\n        'summary',\n        'details',\n      ],\n    })\n    return { __html: cleanText }\n  }\n\n  /**\n   * Find all math identified elements of the form [id^=\\\"mathjax-\\\"]\n   * (e.g. <dom element id=\"mathjax-10\"> text </dom element>)\n   * and transform them to their math markedown equivalents\n   */\n  public processMath() {\n    if (!this.markupRef.current) {\n      return\n    }\n    // use regex to grab all elements\n    const mathExpressions = this.markupRef.current.querySelectorAll<\n      HTMLElement\n    >('[id^=\"mathjax-\"]')\n    // go through all obtained elements and transform them with katex\n    mathExpressions.forEach(element => {\n      element.textContent &&\n        katex.render(element.textContent, element, {\n          // @ts-ignore\n          output: 'html',\n          throwOnError: false,\n        })\n    })\n  }\n  /**\n   * Process all the corresponding bookmark tags of the references made throughout the page\n   *\n   * @memberof MarkdownSynapse\n   */\n  public addBookmarks() {\n    markdownitSynapse.resetFootnotes()\n    this.createHTML(this.state.data.markdown)\n    const footnotesHtml = this.createHTML(markdownitSynapse.footnotes()).__html\n    if (footnotesHtml.length > 0) {\n      return <Bookmarks footnotes={footnotesHtml} />\n    }\n    return\n  }\n\n  /**\n   * Get wiki page markdown and file attachment handles\n   */\n  public async getWikiPageMarkdown() {\n    const { ownerId, wikiId = '', token } = this.props\n    try {\n      const wikiPage = await SynapseClient.getEntityWiki(token, ownerId, wikiId)\n      try {\n        const fileHandles = await this.getWikiAttachments(\n          wikiId ? wikiId : wikiPage.id,\n        )\n        this.setState({\n          data: wikiPage,\n          fileHandles,\n        })\n      } catch (fileHandlesErr) {\n        console.error('fileHandlesErr = ', fileHandlesErr)\n      }\n    } catch (err) {\n      console.error('Error on wiki markdown load\\n', err)\n    }\n  }\n  public async getWikiAttachments(wikiId: string) {\n    const { token, ownerId } = this.props\n    if (!ownerId) {\n      console.error(\n        'Cannot get wiki attachments without ownerId on Markdown Component',\n      )\n      return undefined\n    }\n    return await SynapseClient.getWikiAttachmentsFromEntity(\n      token,\n      ownerId,\n      wikiId,\n    )\n      .then(data => {\n        return data\n      })\n      .catch(err => {\n        this.setState({\n          errorMessage: err.reason,\n        })\n        console.error('Error on wiki attachment load ', err)\n        return undefined\n      })\n  }\n  /**\n   * If theres an error loading the wiki page show an informative message\n   * likely a priveledge issue -- (e.g. not signed-in)\n   *\n   * @returns view that presents error message on error, otherwise null\n   */\n  public getErrorView() {\n    if (this.state.errorMessage && this.props.errorMessageView) {\n      const ErrorView = this.props.errorMessageView as React.FC\n      return <ErrorView>{this.state.errorMessage}</ErrorView>\n    }\n    return\n  }\n\n  public addIdsToReferenceWidgets(text: string) {\n    const referenceRegex = /<span id=\"wikiReference.*?<span data-widgetparams.*?span>/g\n    let referenceCount = 1\n\n    return text.replace(referenceRegex, () => {\n      // replace all reference tags with id's of the form id=\"ref<number>\"\" that we can read onClick\n      const current = referenceCount\n      referenceCount += 1\n      return `<a href=\"\" id=\"ref${current}\">[${current}]</a>`\n    })\n  }\n\n  public addIdsToTocWidgets(text: string) {\n    const tocId = 'SRC-header-'\n    let tocIdCount = 1\n    const TOC_HEADER_REGEX = /<h[1-6] toc=\"true\">.*<\\/h[1-6]>/gm\n\n    return text.replace(TOC_HEADER_REGEX, (match: string) => {\n      // replace with id of the form id=\"toc\" so we can read them with onclick events\n      const curTocId = tocIdCount\n      tocIdCount += 1\n      const matchWithId = `${match.substring(\n        0,\n        3,\n      )} id=\"${tocId}${curTocId}\"${match.substring(3)}`\n      return matchWithId\n    })\n  }\n\n  /**\n   * The 'main' method of this class that process all the markdown and transforms it to the appropriate\n   * Synapse widgets.\n   *\n   * @returns JSX of the markdown into widgets\n   * @memberof MarkdownSynapse\n   */\n  public renderMarkdown() {\n    // create initial markup\n    let markup = this.createHTML(this.state.data.markdown).__html\n    // process reference widgets\n    markup = this.addIdsToReferenceWidgets(markup)\n    // process table of contents widgets\n    markup = this.addIdsToTocWidgets(markup)\n    if (markup.length > 0) {\n      const domParser = new DOMParser()\n      const document = domParser.parseFromString(markup, 'text/html')\n      return <>{this.recursiveRender(document.body, markup)}</>\n    }\n    return\n  }\n\n  /**\n   * recursiveRender will render react tree from HTML tree\n   *\n   * @param {Node} element This will be either a text Node or an HTMLElement\n   * @param {string} markdown The original markdown, its kept as a special case for the table of contents widget\n   * @returns {*}\n   * @memberof MarkdownSynapse\n   */\n  public recursiveRender(element: Node, markdown: string): any {\n    /*\n      Recursively render the html tree created from the markdown, there are a few cases:\n      1. element is Node and is text in which case it is simply rendered\n      2. element is an HTMLElement and is: a self closing tag, has no children (e.g. <br>), or its a synapse widget and is \n      rendered accordingly\n      3. element is an HTMLElement and has children so we loop through its childNodes, recurively render those, and then render its own tag\n      as the parent of those child nodes. Note - childNodes was specifically chosen over .children because text Nodes\n      would not come through .children\n    */\n    if (element.nodeType === Node.TEXT_NODE) {\n      // case 1.\n      return <> {element.textContent} </>\n    } else if (\n      element.nodeType === Node.ELEMENT_NODE &&\n      element instanceof HTMLElement\n    ) {\n      const tagName =\n        element.tagName.toLowerCase() === 'body'\n          ? 'span'\n          : element.tagName.toLowerCase()\n      const widgetParams = element.getAttribute('data-widgetparams')\n      if (widgetParams) {\n        // case 2\n        // process widget\n        return this.processHTMLWidgetMapping(widgetParams, markdown)\n      }\n      // manually add on props, depending on what comes through the markdown their could\n      // be unforseen issues with attributes being misnamed according to what react will respect\n      // e.g. class instead of className\n      const attributes = element.attributes\n      const props = {}\n      for (let i = 0; i < attributes.length; i++) {\n        let name = ''\n        let value = ''\n        const attribute = attributes.item(i)\n        if (attribute) {\n          name = attribute.name\n          value = attribute.value\n        }\n        if (name && value) {\n          props[name] = value\n        }\n      }\n      if (element.childNodes.length === 0) {\n        // case 2\n        // e.g. self closing tag like <br/> or <img>\n        return React.createElement(tagName, props)\n      }\n      // case 3\n      // recursively render children\n      const children = Array.from(element.childNodes).map(el => {\n        return <>{this.recursiveRender(el, markdown)}</>\n      })\n      // Render tagName as parent element of the children below\n      return React.createElement(tagName, props, <>{children}</>)\n    }\n  }\n\n  /**\n   *  When the markdown string is transfered over the network certain characters get transformed,\n   * this does a simple transformation back to the original user's string.\n   *\n   * @param {string} xml\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public decodeXml(xml: string) {\n    const escapedOneToXmlSpecialMap = {\n      '&amp;': '&',\n      '&gt;': '>',\n      '&lt;': '<',\n      '&quot;': '\"',\n    }\n    return xml.replace(/(&quot;|&lt;|&gt;|&amp;)/g, (str, item) => {\n      return escapedOneToXmlSpecialMap[item]\n    })\n  }\n\n  /**\n   * Given widgetMap renders it in a React component (or originalMarkup in special cases.)\n   *\n   * @param {string} widgetMatch The synapse widget to be rendered\n   * @param {string} originalMarkup The original markup text, this is a special case for widgets that\n   * are html specific.\n   * @returns JSX of the widget to render\n   * @memberof MarkdownSynapse\n   */\n  public processHTMLWidgetMapping(\n    widgetParams: string,\n    originalMarkup: string,\n  ) {\n    // General workflow -\n    //   1. Capture widget parameters\n    //   2. Transform any widget xml parameters to standard text\n    //   3. Split those parameters into a map\n    //   4. Render that widget based on its parameters\n\n    // steps 1,2\n    const decodedWidgetParams = this.decodeXml(widgetParams)\n\n    // decodedWidgetParams look like {<widget>?param1=xxx&param2=yyy}\n    const questionIndex = decodedWidgetParams.indexOf('?')\n    if (questionIndex === -1) {\n      // e.g. toc is passed, there are no params\n      return this.renderWidget(decodedWidgetParams, {}, originalMarkup)\n    }\n    const widgetType = decodedWidgetParams.substring(0, questionIndex)\n    const widgetparamsMapped = {}\n    // map out params and their values\n    decodedWidgetParams\n      .substring(questionIndex + 1)\n      .split('&')\n      .forEach(keyPair => {\n        let [key, value] = keyPair.split('=')\n        value = decodeURIComponent(value)\n        widgetparamsMapped[key] = value\n      })\n    return this.renderWidget(widgetType, widgetparamsMapped, originalMarkup)\n  }\n\n  /**\n   *  Given widgetType renders the apppropriate widget\n   *\n   * @param {string} widgetType The type of synapse widget. (e.g. 'image', 'plot')\n   * @param {*} widgetparamsMapped The parameters for this widget\n   * @param {string} originalMarkup The original markup.\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public renderWidget(\n    widgetType: string,\n    widgetparamsMapped: any,\n    originalMarkup: string,\n  ) {\n    // we make keys out of the widget params\n    const key = JSON.stringify(widgetparamsMapped)\n    widgetparamsMapped.reactKey = key\n    switch (widgetType) {\n      case 'buttonlink':\n        return this.renderSynapseButton(widgetparamsMapped)\n      case 'image':\n        return this.renderSynapseImage(widgetparamsMapped)\n      case 'plot':\n        return this.renderSynapsePlot(widgetparamsMapped)\n      case 'toc':\n        return this.renderSynapseTOC(originalMarkup)\n      case 'badge':\n        return this.renderUserBadge(widgetparamsMapped)\n      default:\n        return\n    }\n  }\n\n  public renderSynapseButton(widgetparamsMapped: any) {\n    let buttonClasses = ''\n    const { align = '', highlight = '' } = widgetparamsMapped\n    const alignLowerCase = align.toLowerCase()\n    if (alignLowerCase === 'left') {\n      buttonClasses += 'floatLeft '\n    }\n    if (alignLowerCase === 'right') {\n      buttonClasses += 'floatright '\n    }\n    if (highlight === 'true') {\n      buttonClasses += ' SRC-primary-button '\n    } else {\n      buttonClasses += 'SRC-light-button '\n    }\n    if (alignLowerCase === 'center') {\n      return (\n        <div key={widgetparamsMapped.reactKey} style={{ textAlign: 'center' }}>\n          <a\n            href={widgetparamsMapped.url}\n            className={'SRC-standard-button-shape ' + buttonClasses}\n            role=\"button\"\n          >\n            {widgetparamsMapped.text}\n          </a>\n        </div>\n      )\n    }\n    return (\n      <a\n        key={widgetparamsMapped.reactKey}\n        href={widgetparamsMapped.url}\n        className={'SRC-standard-button-shape ' + buttonClasses}\n        role=\"button\"\n      >\n        {widgetparamsMapped.text}\n      </a>\n    )\n  }\n  public renderSynapsePlot(widgetparamsMapped: any) {\n    return (\n      <SynapsePlot\n        key={widgetparamsMapped.reactKey}\n        token={this.props.token}\n        ownerId={this.props.ownerId}\n        wikiId={this.props.wikiId || this.state.data.id}\n        widgetparamsMapped={widgetparamsMapped}\n      />\n    )\n  }\n\n  public renderSynapseImage(widgetparamsMapped: any) {\n    const { reactKey } = widgetparamsMapped\n    if (widgetparamsMapped.fileName) {\n      if (!this.state.fileHandles) {\n        // ensure files are loaded\n        return\n      }\n      // if file name is attached then the fileHandle ID is located\n      // in this wiki's file attachment list\n      return (\n        <SynapseImage\n          params={widgetparamsMapped}\n          key={reactKey}\n          token={this.props.token}\n          fileName={widgetparamsMapped.fileName}\n          wikiId={this.props.wikiId || this.state.data.id}\n          fileResults={this.state.fileHandles.list}\n        />\n      )\n    }\n    if (widgetparamsMapped.synapseId) {\n      // otherwise this image's fileHandle ID is not located\n      // in the file attachment list and will be loaded first\n      return (\n        <SynapseImage\n          params={widgetparamsMapped}\n          key={reactKey}\n          token={this.props.token}\n          synapseId={widgetparamsMapped.synapseId}\n        />\n      )\n    }\n    return\n  }\n  public renderSynapseTOC(originalMarkup: string) {\n    const elements: any[] = []\n    const TOC_HEADER_REGEX_WITH_ID = /<h([1-6]) id=\"(.*)\" .*toc=\"true\">(.*)<\\/h[1-6]>/gm\n    let text = ''\n    originalMarkup.replace(TOC_HEADER_REGEX_WITH_ID, (p1, p2, p3, p4) => {\n      text += p4\n      elements.push(\n        <div key={p4}>\n          <a className={`link ${TOC_CLASS[Number(p2)]}`} data-anchor={p3}>\n            {p4}\n          </a>\n        </div>,\n      )\n      return ''\n    })\n    return <div key={text}>{elements}</div>\n  }\n\n  public renderUserBadge(widgetparamsMapped: any) {\n    return (\n      <UserCard\n        key={JSON.stringify(widgetparamsMapped)}\n        size={SynapseConstants.SMALL_USER_CARD}\n        alias={widgetparamsMapped.alias}\n      />\n    )\n  }\n\n  public async componentDidMount() {\n    if (this.state.data.markdown) {\n      return\n    }\n    // we use this.markupRef.current && because in testing environment refs aren't defined\n    // @ts-ignore\n    this.markupRef.current &&\n      // @ts-ignore\n      this.markupRef.current!.addEventListener('click', this.handleLinkClicks)\n    // unpack and set default value if not specified\n    // get wiki attachments\n    await this.getWikiPageMarkdown()\n    this.processMath()\n  }\n\n  // on component update find and re-render the math/widget items accordingly\n  public async componentDidUpdate(prevProps: MarkdownSynapseProps) {\n    let shouldUpdate = this.props.token !== prevProps.token\n    shouldUpdate = shouldUpdate || this.props.ownerId !== prevProps.ownerId\n    shouldUpdate = shouldUpdate || this.props.wikiId !== prevProps.wikiId\n\n    // we have to carefully update the component so it doesn't encounter an infinite loop\n    if (shouldUpdate) {\n      await this.getWikiPageMarkdown()\n    }\n    this.processMath()\n  }\n\n  public render() {\n    const { renderInline } = this.props\n    const bookmarks = this.addBookmarks()\n    const content = (\n      <>\n        {this.renderMarkdown()}\n        {bookmarks && <div>{this.addBookmarks()}</div>}\n      </>\n    )\n    if (renderInline) {\n      return (\n        <span className=\"markdown markdown-inline\" ref={this.markupRef}>\n          {content}\n        </span>\n      )\n    }\n    return (\n      <div className=\"markdown\" ref={this.markupRef}>\n        {content}\n      </div>\n    )\n  }\n}\n","import { QueryBundleRequest } from '../synapseTypes/'\nimport { SynapseClient, SynapseConstants } from '..'\nimport { QueryResultBundle } from '../synapseTypes/'\nimport { cloneDeep } from 'lodash-es'\n\ntype PartialStateObject = {\n  hasMoreData: boolean\n  data: QueryResultBundle\n}\n\n/**\n * Grab the next page of data, pulling in 25 more rows.\n *\n * @param {*} queryRequest Query request as specified by\n *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n */\nexport const getNextPageOfData = async (\n  queryRequest: QueryBundleRequest,\n  data: QueryResultBundle,\n  token?: string,\n) => {\n  return await SynapseClient.getQueryTableResults(queryRequest, token)\n    .then((newData: QueryResultBundle) => {\n      const oldData: QueryResultBundle = cloneDeep(data)!\n      // push on the new data retrieved from the API call\n      const hasMoreData =\n        newData.queryResult.queryResults.rows.length ===\n        SynapseConstants.PAGE_SIZE\n      oldData.queryResult.queryResults.rows.push(\n        ...newData.queryResult.queryResults.rows,\n      )\n      const newState: PartialStateObject = {\n        hasMoreData,\n        data: oldData,\n      }\n      return newState\n    })\n    .catch(err => {\n      console.log('Failed to get data ', err)\n      return {} as PartialStateObject\n    })\n}\n","import * as React from 'react'\nimport { SynapseClient, SynapseConstants } from '../utils/'\nimport { getNextPageOfData } from '../utils/functions/queryUtils'\nimport {\n  AsynchronousJobStatus,\n  FacetColumnResultValues,\n  QueryBundleRequest,\n  QueryResultBundle,\n} from '../utils/synapseTypes/'\nimport { cloneDeep } from 'lodash-es'\n\nexport type QueryWrapperProps = {\n  initQueryRequest: QueryBundleRequest\n  rgbIndex?: number\n  token?: string\n  facet?: string\n  loadingScreen?: JSX.Element\n  unitDescription?: string\n  facetAliases?: {}\n  loadNow?: boolean\n  showBarChart?: boolean\n}\n\nexport type QueryWrapperState = {\n  /*\n    isAllFilterSelectedForFacet tracks whether for a particular\n     facet if the 'All' button has been selected, this tracks the\n     click event and syncs Facets.tsx and SynapseTable.tsx\n  */\n  isAllFilterSelectedForFacet: {}\n  data: QueryResultBundle | undefined\n  isLoadingNewData: boolean // occurs when props change\n  isLoading: boolean // occurs when state changes\n  lastQueryRequest: QueryBundleRequest\n  hasMoreData: boolean\n  lastFacetSelection: FacetSelection\n  chartSelectionIndex: number\n  asyncJobStatus?: AsynchronousJobStatus\n  facetAliases?: {}\n  loadNowStarted: boolean\n  initQueryRequest: QueryBundleRequest\n}\n\nexport type FacetSelection = {\n  columnName: string\n  facetValue: string\n  selector: string\n}\n\n// Since the component is an HOC we export the props passed down\nexport type QueryWrapperChildProps = {\n  isAllFilterSelectedForFacet?: {}\n  isLoading?: boolean\n  token?: string\n  entityId?: string\n  isLoadingNewData?: boolean\n  executeQueryRequest?: (param: QueryBundleRequest) => void\n  executeInitialQueryRequest?: () => void\n  getNextPageOfData?: (queryRequest: QueryBundleRequest) => void\n  getLastQueryRequest?: () => QueryBundleRequest\n  getInitQueryRequest?: () => QueryBundleRequest\n  data?: QueryResultBundle\n  facet?: string\n  updateParentState?: (param: any) => void\n  rgbIndex?: number\n  unitDescription?: string\n  facetAliases?: {}\n  lastFacetSelection?: FacetSelection\n  chartSelectionIndex?: number\n  asyncJobStatus?: AsynchronousJobStatus\n  showBarChart?: boolean\n  hasMoreData?: boolean\n}\n\n/**\n * Class wraps around any Synapse views that are dependent on a query bundle\n * Those classes then take in as props:\n *\n * @class QueryWrapper\n * @extends {React.Component}\n */\nexport default class QueryWrapper extends React.Component<\n  QueryWrapperProps,\n  QueryWrapperState\n> {\n  public static defaultProps = {\n    token: '',\n  }\n\n  public static initialState = {\n    data: undefined,\n    isLoading: true,\n    isLoadingNewData: true,\n    lastQueryRequest: {} as QueryBundleRequest,\n    hasMoreData: true,\n    lastFacetSelection: {\n      columnName: '',\n      facetValue: '',\n      selector: '',\n    },\n    chartSelectionIndex: 0,\n    isAllFilterSelectedForFacet: {},\n    loadNowStarted: false,\n  } as QueryWrapperState\n\n  constructor(props: QueryWrapperProps) {\n    super(props)\n    this.executeInitialQueryRequest = this.executeInitialQueryRequest.bind(this)\n    this.executeQueryRequest = this.executeQueryRequest.bind(this)\n    this.getLastQueryRequest = this.getLastQueryRequest.bind(this)\n    this.getNextPageOfData = this.getNextPageOfData.bind(this)\n    this.updateParentState = this.updateParentState.bind(this)\n    this.getInitQueryRequest = this.getInitQueryRequest.bind(this)\n    this.state = QueryWrapper.initialState\n  }\n\n  /**\n   * Compute default query request\n   *\n   * @memberof QueryWrapper\n   */\n  public componentDidMount() {\n    const { loadNow = true } = this.props\n    if (loadNow) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * @memberof QueryWrapper\n   */\n  public componentDidUpdate(prevProps: QueryWrapperProps) {\n    /**\n     *  If component updates and the token has changed (they signed in) then the data should be pulled in. Or if the\n     *  sql query has changed of the component then perform an update.\n     */\n\n    const { loadNow = true } = this.props\n    if (loadNow && !this.state.loadNowStarted) {\n      this.executeInitialQueryRequest()\n    } else if (loadNow && this.props.token && !prevProps.token) {\n      // if loadNow is true and they've logged in with a token that is not undefined, null, or an empty string when it was before\n      this.executeQueryRequest(this.getLastQueryRequest())\n    } else if (\n      prevProps.initQueryRequest.query.sql !==\n      this.props.initQueryRequest!.query.sql\n    ) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * last query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getLastQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.state.lastQueryRequest)\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * first query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getInitQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.props.initQueryRequest)\n  }\n\n  /**\n   * Execute the given query\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeQueryRequest(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true,\n      lastQueryRequest: cloneDeep(queryRequest),\n    })\n    return SynapseClient.getQueryTableResults(\n      queryRequest,\n      this.props.token,\n      this.updateParentState,\n    )\n      .then((data: QueryResultBundle) => {\n        const hasMoreData =\n          data.queryResult.queryResults.rows.length ===\n          SynapseConstants.PAGE_SIZE\n        const newState: any = {\n          hasMoreData,\n          data,\n          isLoading: false,\n          asyncJobStatus: undefined,\n        }\n        this.setState(newState)\n      })\n      .catch((err: string) => {\n        console.log('Failed to get data ', err)\n      })\n  }\n\n  /**\n   * Grab the next page of data, pulling in 25 more rows.\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public async getNextPageOfData(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true,\n    })\n\n    await getNextPageOfData(\n      queryRequest,\n      this.state.data!,\n      this.props.token,\n    ).then(newState => {\n      this.setState({\n        ...newState,\n        isLoading: false,\n        lastQueryRequest: cloneDeep(queryRequest),\n      })\n    })\n  }\n\n  /**\n   * Execute the initial query passed into the component\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeInitialQueryRequest() {\n    this.setState({\n      isLoading: true,\n      isLoadingNewData: true,\n      chartSelectionIndex: 0,\n      loadNowStarted: true,\n    })\n    SynapseClient.getQueryTableResults(\n      this.props.initQueryRequest,\n      this.props.token,\n      this.updateParentState,\n    )\n      .then((data: QueryResultBundle) => {\n        const lastQueryRequest: QueryBundleRequest = cloneDeep(\n          this.props.initQueryRequest!,\n        )\n        const hasMoreData =\n          data.queryResult.queryResults.rows.length ===\n          SynapseConstants.PAGE_SIZE\n        const isAllFilterSelectedForFacet = cloneDeep(\n          this.state.isAllFilterSelectedForFacet,\n        )\n        let { chartSelectionIndex } = this.state\n        if (this.props.facet) {\n          if (!data.facets) {\n            throw Error(\n              'Error on query request, must include facets in partmask to show facets',\n            )\n          }\n          const enumFacets = data.facets.filter(\n            el => el.facetType === 'enumeration',\n          ) as FacetColumnResultValues[]\n          enumFacets.forEach(el => {\n            // isAll is only true iff there are no facets selected or all elements are selected\n            const { facetValues } = el\n            const isAllFalse = facetValues.every(facet => !facet.isSelected)\n            const isAllTrue = facetValues.every(facet => facet.isSelected)\n            const isByDefaultSelected = isAllFalse || isAllTrue\n            isAllFilterSelectedForFacet[el.columnName] = isByDefaultSelected\n            if (el.columnName === this.props.facet && !isAllFalse) {\n              // Note - this picks the first selected facet\n              chartSelectionIndex = facetValues\n                .sort((a, b) => b.count - a.count)\n                .findIndex(facet => facet.isSelected)\n            }\n          })\n        }\n        const newState = {\n          isAllFilterSelectedForFacet,\n          hasMoreData,\n          data,\n          chartSelectionIndex,\n          lastQueryRequest,\n          isLoading: false,\n          isLoadingNewData: false,\n          asyncJobStatus: undefined,\n        }\n        this.setState(newState)\n      })\n      .catch(err => {\n        console.log('Failed to get data ', err)\n      })\n  }\n\n  public updateParentState(update: QueryWrapperState) {\n    this.setState(update)\n  }\n\n  /**\n   * Render the children without any formatting\n   */\n  public render() {\n    const { isLoading } = this.state\n    const { facetAliases = {} } = this.props\n    // inject props in children of this component\n    const childrenWithProps = React.Children.map(\n      this.props.children,\n      (child: any) => {\n        const queryWrapperChildProps: QueryWrapperChildProps = {\n          facetAliases,\n          isAllFilterSelectedForFacet: this.state.isAllFilterSelectedForFacet,\n          data: this.state.data,\n          token: this.props.token,\n          executeInitialQueryRequest: this.executeInitialQueryRequest,\n          executeQueryRequest: this.executeQueryRequest,\n          getLastQueryRequest: this.getLastQueryRequest,\n          getNextPageOfData: this.getNextPageOfData,\n          isLoading: this.state.isLoading,\n          isLoadingNewData: this.state.isLoadingNewData,\n          facet: this.props.facet,\n          rgbIndex: this.props.rgbIndex,\n          unitDescription: this.props.unitDescription,\n          updateParentState: this.updateParentState,\n          hasMoreData: this.state.hasMoreData,\n          lastFacetSelection: this.state.lastFacetSelection,\n          chartSelectionIndex: this.state.chartSelectionIndex,\n          getInitQueryRequest: this.getInitQueryRequest,\n          asyncJobStatus: this.state.asyncJobStatus,\n          showBarChart: this.props.showBarChart,\n        }\n        return React.cloneElement(child, queryWrapperChildProps)\n      },\n    )\n\n    const loadingCusrorClass = isLoading ? 'SRC-logo-cursor' : ''\n    return (\n      <div className={`SRC-wrapper ${loadingCusrorClass}`}>\n        {childrenWithProps}\n      </div>\n    )\n  }\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faAngleLeft, faAngleRight } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport ReactMeasure from 'react-measure'\nimport ReactTooltip from 'react-tooltip'\nimport { getColorPallette } from './ColorGradient'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport { FacetColumnResultValueCount } from '../utils/synapseTypes/'\nimport { getIsValueSelected } from '../utils/functions/facetUtils'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nlibrary.add(faAngleLeft)\nlibrary.add(faAngleRight)\n\nexport const PREVIOUS_ITEM_CLICK = 'left click'\nexport const NEXT_CLICK = 'right click'\n\ntype Rect = {\n  height: number\n  width: number\n  top: number\n  left: number\n  right: number\n  bottom: number\n}\n\ntype MeasureRect = {\n  bounds: Rect\n}\n\nexport type StackedBarChartState = {\n  selectedFacets: {}\n  dimensions: MeasureRect\n}\n\nexport type StackedBarChartProps = {\n  loadingScreen: JSX.Element\n  link?: string\n  linkText?: string\n}\n\ntype Info = {\n  value: string\n  count: number\n  index: number\n}\n\ntype InternalProps = StackedBarChartProps & QueryWrapperChildProps\n/**\n * Make a simple stacked bar chart\n *\n * @class StackedBarChart\n * @extends {React.Component}\n */\nexport default class StackedBarChart extends React.Component<\n  InternalProps,\n  StackedBarChartState\n> {\n  constructor(props: InternalProps) {\n    super(props)\n    this.handleHover = this.handleHover.bind(this)\n    this.handleExit = this.handleExit.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n    this.handleArrowClick = this.handleArrowClick.bind(this)\n    this.getTextForChartSelection = this.getTextForChartSelection.bind(this)\n    this.onMeasureResize = this.onMeasureResize.bind(this)\n    // the text currently under the cursor\n    this.state = {\n      // the dimensions of the bar chart itself\n      dimensions: {\n        bounds: { height: 1, width: 1, top: 0, left: 0, right: 0, bottom: 0 },\n      },\n      // the text of the current slice\n      // the count of this facet value occurence\n      selectedFacets: {},\n    }\n    this.extractPropsData = this.extractPropsData.bind(this)\n  }\n\n  /**\n   * Updates the hover text and update the view\n   *\n   * @memberof StackedBarChart\n   */\n  public handleHover(event: React.MouseEvent<SVGRectElement>) {\n    // add box shadow\n    event.currentTarget.style.boxShadow = '25px 20px'\n  }\n\n  /**\n   * Update the hover text and the view\n   *\n   * @param {*} event\n   * @memberof StackedBarChart\n   */\n  public handleExit(event: React.MouseEvent<SVGRectElement>) {\n    // remove box shadow\n    event.currentTarget.style.boxShadow = ''\n  }\n\n  /**\n   * Handle column click event\n   */\n  public handleClick = (dict: Info) => (\n    _event: React.MouseEvent<SVGElement>,\n  ) => {\n    // https://medium.freecodecamp.org/reactjs-pass-parameters-to-event-handlers-ca1f5c422b9\n    this.props.updateParentState!({ chartSelectionIndex: dict.index })\n  }\n\n  public handleArrowClick = (direction: string) => (\n    _event: React.MouseEvent,\n  ) => {\n    let { chartSelectionIndex = 0 } = this.props\n    let dict: any = this.extractPropsData(this.props.data)\n    const length = Object.keys(dict).length\n    if (direction === PREVIOUS_ITEM_CLICK) {\n      chartSelectionIndex -= 1\n      // if its at zero then we want to wrap around to the end\n      chartSelectionIndex =\n        chartSelectionIndex < 0 ? length - 1 : chartSelectionIndex\n    } else {\n      chartSelectionIndex += 1\n    }\n    chartSelectionIndex = chartSelectionIndex % length\n\n    dict = dict[chartSelectionIndex]\n    this.props.updateParentState!({ chartSelectionIndex })\n    // return is only for testing purposes\n    return chartSelectionIndex\n  }\n\n  public getTextForChartSelection(xData: any) {\n    const { chartSelectionIndex = 0 } = this.props\n    const { facetAliases = {}, facet } = this.props\n    const facetValueDisplay =\n      xData[chartSelectionIndex] && xData[chartSelectionIndex].value\n    const filterDisplay = facetAliases[facet!] || unCamelCase(facet)\n    return (\n      <span>\n        <span className=\"SRC-text-title SRC-filter-display\">\n          {filterDisplay}\n        </span>\n        :\n        <span className=\"SRC-facet-view SRC-text-title\">\n          {facetValueDisplay === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n            ? 'unannotated'\n            : facetValueDisplay}\n        </span>\n      </span>\n    )\n  }\n\n  public getFileCount(xData: any) {\n    const { chartSelectionIndex = 1 } = this.props\n    return xData[chartSelectionIndex] && xData[chartSelectionIndex].count\n  }\n\n  public render() {\n    const {\n      data,\n      isLoadingNewData,\n      loadingScreen,\n      rgbIndex,\n      facet = '',\n      unitDescription,\n      isLoading,\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n      chartSelectionIndex,\n      asyncJobStatus,\n    } = this.props\n    // while loading\n    if (isLoadingNewData) {\n      return (\n        <div className=\"SRC-loadingContainer SRC-centerContentColumn\">\n          {/*\n            check loading screen is not undefined or null and show\n            it if so\n          */}\n          {!!loadingScreen && loadingScreen}\n          <div>{asyncJobStatus && asyncJobStatus.progressMessage}</div>\n        </div>\n      )\n    }\n    const xData = this.extractPropsData(data)\n    let total: number = 0\n    const width: number = this.state.dimensions.bounds!.width\n    // sum up the counts of data\n    for (const key in xData) {\n      if (xData.hasOwnProperty(key)) {\n        total += xData[key].count\n      }\n    }\n    const { colorPalette, textColors } = getColorPallette(\n      rgbIndex!,\n      xData.length,\n    )\n    const originalColor = colorPalette[0]\n\n    return (\n      <React.Fragment>\n        {/* TODO: Refactor the chart into its own component */}\n        <div className=\"SRC-bar-border SRC-bar-marginTop SRC-bar-border-top\">\n          <ReactMeasure\n            bounds={true}\n            onResize={(contentRect: any) => {\n              this.setState({ dimensions: contentRect })\n            }}\n          >\n            {({ measureRef }) => (\n              <div className=\"SRC-flex\" ref={measureRef}>\n                {xData.map((obj: FacetColumnResultValueCount, index) => {\n                  const textColor: string = textColors[index]\n                  const rgbColor: string = colorPalette[index]\n                  let rectStyle: any\n                  const isValueSelected = isAllFilterSelectedForFacet![facet]\n                    ? true\n                    : getIsValueSelected({\n                        isLoading,\n                        lastFacetSelection,\n                        columnName: facet,\n                        curFacetSelection: obj,\n                      })\n                  if (isValueSelected) {\n                    rectStyle = {\n                      fill: rgbColor,\n                    }\n                  } else {\n                    rectStyle = {\n                      fill: '#C4C4C4',\n                    }\n                  }\n                  const svgHeight = 80\n                  const svgWidth = (obj.count / total) * width\n                  const style: any = {}\n                  if (chartSelectionIndex === index) {\n                    style.filter = 'drop-shadow(5px 5px 5px rgba(0,0,0,0.5))'\n                  }\n                  const label: string = `${facet}: ${obj.value}  - ${obj.count} ${unitDescription}`\n                  // there was one bug where a new line character was in the obj.value, making data-for\n                  // break because its a special character, below we remove that\n                  const tooltipId = obj.value.replace(/(\\r\\n|\\n|\\r)/gm, '')\n                  // basic heuristic to calculate the number of pixels needed to show the value on the bar chart\n                  const value = obj.count as number\n                  const numCharsInValue = value.toString().length * 4.5 // represents width of a character\n\n                  return (\n                    // each svg represents one of the bars\n                    // will need to change this to be responsive\n                    <React.Fragment key={label}>\n                      <span data-for={tooltipId} data-tip={label}>\n                        <svg\n                          className=\"SRC-hoverBox\"\n                          height={svgHeight + 15}\n                          width={svgWidth}\n                          style={style}\n                          onClick={this.handleClick({ ...obj, index })}\n                        >\n                          <rect\n                            onMouseEnter={this.handleHover}\n                            onMouseLeave={this.handleExit}\n                            height={svgHeight}\n                            width={svgWidth}\n                            className=\"SRC-chart-rect-style\"\n                            // can't remove inline style due to dynamic fill\n                            style={rectStyle}\n                          />\n                          {index < 3 && svgWidth > numCharsInValue && (\n                            <text\n                              textAnchor=\"middle\"\n                              className=\"SRC-text-title\"\n                              fontFamily={'bold sans-serif'}\n                              fill={textColor}\n                              x={'50%'}\n                              y={'50%'}\n                            >\n                              {obj.count}\n                            </text>\n                          )}\n                          {chartSelectionIndex === index && (\n                            <text\n                              fill={originalColor}\n                              x={0}\n                              y={svgHeight + 15}\n                              className=\"SRC-text-shadow SRC-text-large\"\n                            >\n                              {'\\u25CF'}\n                            </text>\n                          )}\n                        </svg>\n                      </span>\n                      <ReactTooltip delayShow={1000} id={tooltipId} />\n                    </React.Fragment>\n                  )\n                })}\n              </div>\n            )}\n          </ReactMeasure>\n        </div>\n        <div className=\"SRC-bar-border SRC-bar-border-bottom\">\n          <p className=\"SRC-noMargin SRC-padding-chart SRC-text-title\">\n            <strong>{this.getTextForChartSelection(xData)}</strong>\n          </p>\n          <p\n            id=\"fileCount\"\n            className=\"SRC-noMargin SRC-padding-chart SRC-text-chart\"\n          >\n            {this.getFileCount(xData)} {unitDescription}\n          </p>\n          {this.props.link && (\n            <div className=\"SRC-chart-link\">\n              <a href={`/${this.props.link}`}> {this.props.linkText} </a>\n            </div>\n          )}\n        </div>\n        <div className=\"SRC-chart-nav SRC-center-text\">\n          <button\n            className=\"SRC-chart-btn SRC-floatRight\"\n            type=\"button\"\n            onClick={this.handleArrowClick(NEXT_CLICK)}\n          >\n            <FontAwesomeIcon\n              style={{ fontSize: '11px' }}\n              className=\"SRC-primary-text-color\"\n              icon=\"angle-right\"\n            />\n          </button>\n          <button\n            className=\"SRC-chart-btn SRC-floatRight\"\n            type=\"button\"\n            onClick={this.handleArrowClick(PREVIOUS_ITEM_CLICK)}\n          >\n            <FontAwesomeIcon\n              style={{ fontSize: '11px' }}\n              className=\"SRC-primary-text-color\"\n              icon=\"angle-left\"\n            />\n          </button>\n        </div>\n      </React.Fragment>\n    )\n  }\n  public extractPropsData(data: any) {\n    const xData: any[] = []\n    const { facet } = this.props\n    // pull out the data corresponding to the filter in question\n    data.facets.forEach((item: any) => {\n      if (item.facetType === 'enumeration' && item.columnName === facet) {\n        item.facetValues.forEach((facetValue: any) => {\n          if (item.columnName) {\n            xData.push({ columnName: item.columnName, ...facetValue })\n          }\n        })\n      }\n    })\n    // sort the data so that the largest bars are at the front\n    xData.sort((a, b) => {\n      return b.count - a.count\n    })\n    return xData\n  }\n\n  public onMeasureResize(contentRect: any) {\n    this.setState({ dimensions: contentRect })\n  }\n}\n","import { IconProp, library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCircle,\n  faDatabase,\n  faLink,\n  faUnlockAlt,\n  faLock\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport ReactTooltip from 'react-tooltip'\nimport { SynapseClient } from '../utils'\nimport {\n  BackendDestinationEnum,\n  getEndpoint,\n} from '../utils/functions/getEndpoint'\nimport {\n  FileHandle,\n  RestrictableObjectType,\n  RestrictionInformationRequest,\n  RestrictionInformationResponse,\n  RestrictionLevel,\n  FileEntity\n} from '../utils/synapseTypes/'\nimport { TOOLTIP_DELAY_SHOW } from './table/SynapseTableConstants'\nlibrary.add(faUnlockAlt)\nlibrary.add(faDatabase)\nlibrary.add(faCircle)\n\nexport type HasAccessProps = {\n  fileHandle?: FileHandle\n  entityId: string\n  isInDownloadList?: boolean // set to show errors in UI about package creation\n  entityVersionNumber?: string\n  token?: string\n}\n\ntype HasAccessState = {\n  restrictionInformation?: RestrictionInformationResponse\n  fileHandleDownloadType?: FileHandleDownloadTypeEnum\n}\n\nexport enum ExternalFileHandleConcreteTypeEnum {\n  ProxyFileHandle = 'org.sagebionetworks.repo.model.file.ProxyFileHandle',\n  ExternalObjectStoreFileHandle = 'org.sagebionetworks.repo.model.file.ExternalObjectStoreFileHandle',\n  ExternalFileHandle = 'org.sagebionetworks.repo.model.file.ExternalFileHandle',\n}\n\nexport enum GoogleCloudFileHandleEnum {\n  GoogleCloudFileHandle = 'org.sagebionetworks.repo.model.file.GoogleCloudFileHandle',\n}\n\nexport const GIGABYTE_SIZE = 2 ** 30\n\nexport enum FileHandleDownloadTypeEnum {\n  ExternalCloudFile,\n  ExternalFileLink,\n  TooLarge,\n  Accessible,\n  AccessBlocked,\n  AccessBlockedToAnonymous,\n  NoFileHandle\n}\n\nexport const getDownloadTypeForFileHandle = (fileHandle: FileHandle, isInDownloadList?: boolean) => {\n  if (fileHandle && !isInDownloadList) {\n    return FileHandleDownloadTypeEnum.Accessible\n  }\n  const { concreteType, contentSize } = fileHandle\n  // check if it's too large\n  if (contentSize >= GIGABYTE_SIZE) {\n    return FileHandleDownloadTypeEnum.TooLarge\n  }\n  // check if it's a google cloud file handle\n  if (concreteType === GoogleCloudFileHandleEnum.GoogleCloudFileHandle) {\n    return FileHandleDownloadTypeEnum.ExternalCloudFile\n  }\n  // check if it's an external file handle\n  const isExternalFileHandle = Object.values<string>(\n    ExternalFileHandleConcreteTypeEnum,\n  ).includes(concreteType)\n  if (isExternalFileHandle) {\n    return FileHandleDownloadTypeEnum.ExternalFileLink\n  }\n  // otherwise its available\n  return FileHandleDownloadTypeEnum.Accessible\n}\n\n/**\n * HasAccess shows if the user has access to the file or not.\n *\n * The component's behavior changes whether it's passed in a FileHandle or not.\n * If passed a file handle then it will give more detailed information about the download.\n *\n * @export\n * @class HasAccess\n * @extends {React.Component<HasAccessProps, HasAccessState>}\n */\nexport default class HasAccess extends React.Component<\n  HasAccessProps,\n  HasAccessState\n> {\n  public static tooltipText = {\n    [FileHandleDownloadTypeEnum.AccessBlockedToAnonymous]:\n      'You must sign in to access this file.',\n    [FileHandleDownloadTypeEnum.AccessBlocked]:\n      'You must request access to this restricted file.',\n    [FileHandleDownloadTypeEnum.TooLarge]:\n      'This file is too large to download as a package and must be downloaded manually.',\n    [FileHandleDownloadTypeEnum.ExternalFileLink]:\n      'This is an external link, which must be downloaded manually.',\n    [FileHandleDownloadTypeEnum.ExternalCloudFile]:\n      'This file must be downloaded manually (e.g. a file in Google Cloud).',\n  }\n\n  constructor(props: HasAccessProps) {\n    super(props)\n    this.getRestrictionInformation = this.getRestrictionInformation.bind(this)\n    this.getFileEntityFileHandle = this.getFileEntityFileHandle.bind(this)\n    this.updateStateFileHandleAccessBlocked = this.updateStateFileHandleAccessBlocked.bind(this)\n    \n    const fileHandleDownloadType = props.fileHandle ? getDownloadTypeForFileHandle(props.fileHandle, props.isInDownloadList) : undefined\n    this.state = {\n      fileHandleDownloadType\n    }\n  }\n\n  componentDidMount() {\n    this.getRestrictionInformation()\n    this.getFileEntityFileHandle()\n  }\n\n  componentDidUpdate() {\n    this.getRestrictionInformation()\n    this.getFileEntityFileHandle()\n  }\n  getFileEntityFileHandle = () => {\n    const { entityId, entityVersionNumber, token, isInDownloadList } = this.props\n    if (this.state.fileHandleDownloadType) {\n      // already know the downloadType\n      return\n    }\n    // fileHandle was not passed to us, ask for it.\n    // is this a FileEntity?\n    SynapseClient.getEntity(token, entityId, entityVersionNumber)\n      .then((entity) => {\n        if (entity.hasOwnProperty('dataFileHandleId')) {\n          // looks like a FileEntity, get the FileHandle\n          SynapseClient.getFileEntityFileHandle(entity as FileEntity, token)\n            .then((fileHandle:FileHandle) => {\n              const fileHandleDownloadType = getDownloadTypeForFileHandle(fileHandle, isInDownloadList)\n              this.setState({\n                fileHandleDownloadType\n              })\n            }).catch(err => {\n              // could not get the file handle\n              this.updateStateFileHandleAccessBlocked()\n            })\n        } else {\n          // entity looks like something else.\n          this.setState({\n            fileHandleDownloadType: FileHandleDownloadTypeEnum.NoFileHandle\n          })\n        }\n      })\n      .catch(err => {\n        // could not get entity\n        this.updateStateFileHandleAccessBlocked()\n      })\n  }\n\n  updateStateFileHandleAccessBlocked = () => {\n    const { token } = this.props\n    const fileHandleDownloadType = token ? FileHandleDownloadTypeEnum.AccessBlocked : FileHandleDownloadTypeEnum.AccessBlockedToAnonymous\n        this.setState({\n          fileHandleDownloadType\n        })\n  }\n\n  getRestrictionInformation = () => {\n    const { entityId, token } = this.props\n    if (\n      this.state.restrictionInformation ||\n      !entityId ||\n      !token\n    ) {\n      return\n    }\n    const request: RestrictionInformationRequest = {\n      restrictableObjectType: RestrictableObjectType.ENTITY,\n      objectId: entityId,\n    }\n    SynapseClient.getRestrictionInformation(request, token)\n      .then(restrictionInformation => {\n        this.setState({\n          restrictionInformation,\n        })\n      })\n      .catch(err => {\n        console.log('Error on getRestrictionInformation: ', err)\n      })\n  }\n\n  renderIconHelper = (iconProp: IconProp, classColor: string) => {\n    return (\n      <span className=\"fa-layers fa-fw\">\n        <FontAwesomeIcon icon={faCircle} className={classColor} size=\"1x\" style={{fontSize: '24px'}} />\n        <FontAwesomeIcon\n          icon={iconProp}\n          className=\"SRC-whiteText\"\n          size=\"1x\"\n          transform={{ x: 5 }}\n          style={{fontSize: '13px'}}\n        />\n      </span>\n    )\n  }\n\n  renderIcon = (downloadType: FileHandleDownloadTypeEnum | string, restrictionInformation?:RestrictionInformationResponse) => {\n    // if there are any access restrictions\n    if (restrictionInformation?.hasUnmetAccessRequirement) {\n      return this.renderIconHelper(faLock, 'SRC-warning-color')\n    }\n    switch (downloadType) {\n      // fileHandle available\n      case FileHandleDownloadTypeEnum.ExternalFileLink:\n      case FileHandleDownloadTypeEnum.ExternalCloudFile:\n        return this.renderIconHelper(faLink, 'SRC-warning-color')\n      case FileHandleDownloadTypeEnum.TooLarge:\n        return this.renderIconHelper(faDatabase, 'SRC-danger-color')\n      // was FileEntity, but no fileHandle was available\n      case FileHandleDownloadTypeEnum.AccessBlocked:\n      case FileHandleDownloadTypeEnum.AccessBlockedToAnonymous:\n        return this.renderIconHelper(faLock, 'SRC-warning-color')\n      // was a FileEntity, and fileHandle was available\n      case FileHandleDownloadTypeEnum.Accessible:\n      // or was not a FileEntity, but no unmet access restrictions\n      case FileHandleDownloadTypeEnum.NoFileHandle:\n        return this.renderIconHelper(faUnlockAlt, 'SRC-success-color')\n      default:\n        // nothing is rendered until access requirement is loaded\n        return <></>\n    }\n  }\n\n  // Show Access Requirements\n  renderARsLink = () => {\n    const { restrictionInformation } = this.state\n    if (!restrictionInformation) {\n      // loading\n      return <></>\n    }\n    const { entityId } = this.props\n    const hasUnmetAccessRequirement =\n      restrictionInformation?.hasUnmetAccessRequirement\n    const restrictionLevel = restrictionInformation?.restrictionLevel\n    let linkText = ''\n    if (hasUnmetAccessRequirement) {\n      linkText = 'Request Access'\n    } else if (RestrictionLevel.OPEN === restrictionLevel) {\n      return <></>\n    } else {\n      linkText = 'View Terms'\n    }\n    return (\n      <a\n        style={{\n          fontSize: '14px',\n          cursor: 'pointer',\n          marginLeft: '9px',\n        }}\n        className=\"SRC-primary-text-color\"\n        href={`${getEndpoint(\n          BackendDestinationEnum.PORTAL_ENDPOINT,\n        )}#!AccessRequirements:ID=${entityId}&TYPE=ENTITY`}\n      >\n        {linkText}\n      </a>\n    )\n  }\n\n  render() {\n    const fileHandleDownloadType = this.state.fileHandleDownloadType\n    if (typeof fileHandleDownloadType === 'undefined') {\n      // note, this can't be \"if (!downloadType)\" since DownloadTypeEnum has a 0 value (which is falsy)\n      // loading\n      return <></>\n    }\n    const tooltipText = HasAccess.tooltipText[fileHandleDownloadType]\n    const entityId = this.props.entityId\n    const icon = this.renderIcon(fileHandleDownloadType, this.state.restrictionInformation)\n    const viewARsLink: React.ReactElement = this.renderARsLink()\n    return (\n      <span style={{ whiteSpace: 'nowrap' }}>\n        {tooltipText && (\n          <>\n            <span tabIndex={0} data-for={entityId} data-tip={tooltipText}>\n              {icon}\n            </span>\n            <ReactTooltip\n              delayShow={TOOLTIP_DELAY_SHOW}\n              place=\"top\"\n              type=\"dark\"\n              effect=\"solid\"\n              id={entityId}\n              className=\"has-access-tooltip-width\"\n            />\n            {viewARsLink}\n          </>\n        )}\n        {!tooltipText && (\n          <>\n            {icon} {viewARsLink}\n          </>\n        )}\n      </span>\n    )\n  }\n}\n","const sufixes: string[] = [\n  'Bytes',\n  'KB',\n  'MB',\n  'GB',\n  'TB',\n  'PB',\n  'EB',\n  'ZB',\n  'YB',\n]\n\nexport function calculateFriendlyFileSize(bytes: number) {\n  if (!bytes) {\n    return ''\n  }\n  // https://stackoverflow.com/questions/10420352/converting-file-size-in-bytes-to-human-readable-string\n  const i = Math.floor(Math.log(bytes) / Math.log(1024))\n  // tslint:disable-next-line\n  return (\n    (!bytes && '0 Bytes') ||\n    (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sufixes[i]\n  )\n}\n","import { useEffect, useState } from 'react'\nimport { EntityHeader, Reference, ReferenceList } from '../synapseTypes'\nimport { getEntityHeader } from '../SynapseClient'\nimport { getUserProfileWithProfilePicAttached } from '../functions/getUserData'\nimport { UserProfile } from '../synapseTypes'\nimport { SynapseConstants } from '..'\nimport { without, chunk } from 'lodash-es'\n\nexport type HookType = 'ENTITY_HEADER' | 'USER_PROFILE'\nexport type UseGetInfoFromIdsProps = {\n  ids: string[]\n  token?: string\n  type: HookType\n}\n\ntype LookupRequestType = string | Reference\n\nconst UserProfileTemplate: UserProfile = {\n  ownerId: '', // A foreign key to the ID of the 'principal' object for the user\n  firstName: 'Unknown', // This person's given name (forename)\n  lastName: 'Unknown', // This person's family name (surname)\n  userName: 'Unknown', // A name chosen by the user that uniquely identifies them\n}\n\nconst entityHeaderTemplate: EntityHeader = {\n  name: 'Unknown', //\tThe name of the entity\n  id: 'unknown', //\tThe id of the entity\n  type: 'unknown', //\tThe type of the entity\n  versionNumber: 0, //\tThe version number of the entity\n  versionLabel: 'placeholder', //\tThe user defined version label of the entity\n  benefactorId: 0, //\tThe ID of the entity that this Entity's ACL is inherited from.\n  createdOn: 'null', //\tThe date this entity was created.\n  modifiedOn: 'null', //\tThe date this entity was last modified.\n  createdBy: 'null', //\tThe ID of the user that created this entity.\n  modifiedBy: 'null', //\tThe ID of the user that last modified this entity.\n}\n\nconst getEntityHeaderItems = async (\n  lookupList: ReferenceList,\n  token: string | undefined,\n): Promise<EntityHeader[]> => {\n  const newData = await getEntityHeader(lookupList, token)\n  const notFound = lookupList.filter(\n    item =>\n      newData.results.map(item => item.id).indexOf(item.targetId) == -1,\n  )\n  const notFoundPlaceholders = notFound.map(item => ({\n    ...entityHeaderTemplate,\n    id: item.targetId,\n    name: `${item.targetId}`,\n  }))\n\n  return [...newData.results, ...notFoundPlaceholders]\n}\n\nconst getUserProfileItems = async (\n  lookupList: string[],\n  token: string | undefined,\n): Promise<UserProfile[]> => {\n  const newData = await getUserProfileWithProfilePicAttached(\n    lookupList,\n    token,\n  )\n  const notFound = lookupList.filter(\n    item => newData.list.map(item => item.ownerId).indexOf(item) == -1,\n  )\n  const notFoundPlaceholders = notFound.map(item => ({\n    ...UserProfileTemplate,\n    ownerId: item,\n    name: `Unknown User (${item})`,\n  }))\n\n  return [...newData.list, ...notFoundPlaceholders]\n}\n\n// React hook to get user profiles or entities\n//******************************************************************************************* */\nexport default function useGetInfoFromIds<T extends EntityHeader | UserProfile>(\n  props: UseGetInfoFromIdsProps,\n) {\n  const { token, ids, type } = props\n  const [data, setData] = useState<Array<T>>([])\n\n  const idProp = (type: HookType) =>\n    type === 'USER_PROFILE' ? 'ownerId' : 'id'\n\n  useEffect(() => {\n\n    const getData = async () => {\n      // look at current list of data, see if incoming ids has new data,\n      // if so grab those ids\n      const curList = data.map(el => el[idProp(type)])\n      const incomingList = ids.filter(\n        el => el !== SynapseConstants.VALUE_NOT_SET,\n      )\n      const newValues = without(incomingList, ...curList)\n      if (newValues.length > 0) {\n        try {\n          const newIds = Array.from<string>(newValues)\n          const newReferences: LookupRequestType[] =\n            type === 'USER_PROFILE'\n              ? newIds\n              : newIds.map(el => ({ targetId: el }))\n          const newReferencesChunks = chunk(newReferences, 45)\n\n          for (const newReferences of newReferencesChunks) {\n            const newData =\n              type === 'USER_PROFILE'\n                ? await getUserProfileItems(newReferences as string[], token)\n                : await getEntityHeaderItems(\n                    newReferences as ReferenceList,\n                    token,\n                  )\n\n            setData(oldData => oldData.concat(...(newData as T[])))\n          }\n        } catch (error) {\n          console.error('Error on data retrieval', error)\n        }\n      }\n    }\n    getData()\n  }, [token, ids])\n  return data\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCheck,\n  faDownload,\n  faFolder,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport React, { useState } from 'react'\nimport * as ReactBoostrap from 'react-bootstrap'\nimport {\n  getBulkFiles,\n  getDownloadOrder,\n  getFileHandleByIdURL,\n} from '../../utils/SynapseClient'\nimport {\n  BulkFileDownloadRequest,\n  BulkFileDownloadResponse,\n  FileDownloadStatus,\n  ZipFileFormat,\n} from '../../utils/synapseTypes/'\n\nlibrary.add(faCheck)\nlibrary.add(faDownload)\nlibrary.add(faFolder)\n\nexport type CreatePackageProps = {\n  token?: string\n  children?: JSX.Element\n  updateDownloadList: Function\n}\n\ntype Alert = {\n  message: string\n  variant: ReactBoostrap.AlertProps['variant']\n  className: string | undefined\n}\n\nexport const TEMPLATE_DOWNLOAD_MESSAGE =\n  'files were downloaded and removed from the list.'\nexport const TEMPLATE_ERROR_FILE_NAME =\n  'Please provide a package file name and try again.'\n\nexport const CreatePackage = (props: CreatePackageProps) => {\n  const [isLoading, setIsLoading] = useState(false)\n  const [fileName, setZipFileName] = useState('')\n  const [alert, setAlert] = useState<Alert>({\n    message: '',\n    className: undefined,\n    variant: undefined,\n  })\n  const [bulkFileDownloadResponse, setBulkFileDownloadResponse] = useState<\n    BulkFileDownloadResponse | undefined\n  >(undefined)\n  const { token, children, updateDownloadList } = props\n\n  const createPackageHandler = async (event: React.SyntheticEvent) => {\n    event.preventDefault()\n    if (!fileName) {\n      setAlert({\n        message: TEMPLATE_ERROR_FILE_NAME,\n        variant: 'danger',\n        className: undefined,\n      })\n      return\n    }\n    setAlert({ message: '', variant: undefined, className: undefined })\n    setIsLoading(true)\n    try {\n      const fileNameWithZipExtension = `${fileName}.zip`\n      const downloadOrder = await getDownloadOrder(\n        fileNameWithZipExtension,\n        token,\n      )\n      const bulkFileDownloadRequest: BulkFileDownloadRequest = {\n        concreteType:\n          'org.sagebionetworks.repo.model.file.BulkFileDownloadRequest',\n        requestedFiles: downloadOrder.files,\n        zipFileName: fileNameWithZipExtension,\n        zipFileFormat: ZipFileFormat.Flat,\n      }\n      const bulkFileDownloadResponse: BulkFileDownloadResponse = await getBulkFiles(\n        bulkFileDownloadRequest,\n        token,\n      )\n      setBulkFileDownloadResponse(bulkFileDownloadResponse)\n    } catch (err) {\n      setAlert({\n        message: err.reason,\n        variant: 'danger',\n        className: undefined,\n      })\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const downloadPackageHandler = async () => {\n    const { resultZipFileHandleId, fileSummary } = bulkFileDownloadResponse!\n    try {\n      const numfilesDownloaded = fileSummary.filter(\n        el => el.status === FileDownloadStatus.SUCCESS,\n      ).length\n      setAlert({\n        message: `${numfilesDownloaded} ${TEMPLATE_DOWNLOAD_MESSAGE}`,\n        className: 'SRC-primary-background-color SRC-whiteText',\n        variant: undefined,\n      })\n      const url = await getFileHandleByIdURL(resultZipFileHandleId, token)\n      window.location.href = url\n      updateDownloadList()\n      setBulkFileDownloadResponse(undefined)\n    } catch (err) {\n      console.error('Err on getFileHandleByIdURL = ', err)\n    }\n  }\n\n  const onChange = (event: React.SyntheticEvent<HTMLInputElement>) => {\n    setZipFileName(event.currentTarget.value)\n  }\n\n  return (\n    <>\n      {alert.message && (\n        <ReactBoostrap.Alert\n          transition={'div'}\n          variant={alert.variant}\n          show={true}\n          className={alert.className}\n        >\n          {alert.message}\n        </ReactBoostrap.Alert>\n      )}\n      <div className=\"create-package-container\">\n        {children}\n        <div>\n          {isLoading && (\n            <span className=\"SRC-centerContentInline\">\n              <span className=\"spinner\" />\n              <span style={{ marginLeft: 5 }} className=\"create-package-text\">\n                Creating package...\n              </span>\n            </span>\n          )}\n          <div className=\"SRC-split\">\n            {!isLoading && !bulkFileDownloadResponse && (\n              <>\n                <form onSubmit={createPackageHandler}>\n                  <input\n                    onChange={onChange}\n                    type=\"text\"\n                    placeholder=\"PackageFileName\"\n                  ></input>\n                  <span className=\"zip-extension SRC-boldText\">.zip</span>\n                </form>\n                <button\n                  className=\"SRC-standard-button-shape SRC-primary-button action-button\"\n                  onClick={createPackageHandler}\n                  type=\"button\"\n                >\n                  <FontAwesomeIcon icon=\"folder\" />\n                  Create Package\n                </button>\n              </>\n            )}\n            {bulkFileDownloadResponse && (\n              <>\n                <div className=\"package-created\">\n                  <FontAwesomeIcon icon=\"check\" color=\"green\" />\n                  <span className=\"create-package-text\">\n                    Package created! Ready for download.\n                  </span>\n                </div>\n                <button\n                  className=\"SRC-standard-button-shape SRC-primary-button action-button\"\n                  onClick={downloadPackageHandler}\n                >\n                  <FontAwesomeIcon icon=\"download\" color=\"white\" />\n                  Download Package\n                </button>\n              </>\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  )\n}\n","import { getEntity, getFileHandleContent, getFiles } from '../SynapseClient'\nimport { FileEntity } from '../synapseTypes/'\nimport { Entity } from '../synapseTypes/'\nimport { BatchFileResult } from '../synapseTypes/'\nimport { FileHandle } from '../synapseTypes/'\nimport { BatchFileRequest } from '../synapseTypes/'\nimport {\n  FileHandleAssociation,\n  FileHandleAssociateType,\n} from '../synapseTypes/'\n\nconst ESTIMATED_CORS_TIME_MS: number = 200\nconst ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME_KEY: string =\n  'ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME'\nconst ESTIMATED_DOWNLOAD_SPEED_KEY: string = 'ESTIMATED_DOWNLOAD_SPEED'\nconst TEST_FILE_ENTITY_ID: string = 'syn12600511'\n/**\n * Return the estimated download speed (bytes/second).  Result is cached.\n * Result is crude estimate since it's a single test file (small sample, only ~2MB), but is a valid test (since it's a Synapse file on s3).\n * The intent is to let the user know if the package download will take many hours to download.\n * @param sessionToken\n */\nexport const testDownloadSpeed = (sessionToken: string): Promise<number> => {\n  return new Promise((resolve, reject) => {\n    // check cache\n    const cachedSpeedExpireTime = localStorage.getItem(\n      ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME_KEY,\n    )\n    const cachedSpeed = localStorage.getItem(ESTIMATED_DOWNLOAD_SPEED_KEY)\n    if (cachedSpeedExpireTime && cachedSpeed) {\n      // is this value expired?\n      const now: number = new Date().getTime()\n      if (now < Number(cachedSpeedExpireTime)) {\n        resolve(Number(cachedSpeed))\n        return\n      }\n    }\n\n    /**\n     * 1.  Get the test File Entity\n     * 2.  Get the file handle and presigned URL associated to the latest version of the test File Entity\n     * 3.  Start the timer and fetch the file content using that presigned URL\n     */\n    getEntity(sessionToken, TEST_FILE_ENTITY_ID)\n      .then((entity: Entity) => {\n        const fileEntity: FileEntity = entity as FileEntity\n        const fileHandleAssociationList: FileHandleAssociation[] = [\n          {\n            associateObjectId: fileEntity.id!,\n            associateObjectType: FileHandleAssociateType.FileEntity,\n            fileHandleId: fileEntity.dataFileHandleId,\n          },\n        ]\n        const request: BatchFileRequest = {\n          includeFileHandles: true,\n          includePreSignedURLs: true,\n          includePreviewPreSignedURLs: false,\n          requestedFiles: fileHandleAssociationList,\n        }\n        getFiles(request, sessionToken).then((data: BatchFileResult) => {\n          const presignedUrl: string = data.requestedFiles[0].preSignedURL!\n          // we know this file exists\n          const fileHandle: FileHandle = data.requestedFiles[0].fileHandle!\n          // start test!\n          const startMs = new Date().getTime()\n          return getFileHandleContent(fileHandle, presignedUrl).then(() => {\n            // console.log(`Transferred ${fileHandle.contentSize/1000000} MB in ${((new Date().getTime() - startMs - ESTIMATED_CORS_TIME_MS)/1000)} seconds`)\n            // bytes/second\n            const result =\n              fileHandle.contentSize /\n              ((new Date().getTime() - startMs - ESTIMATED_CORS_TIME_MS) / 1000)\n            // save result in cache (for 5 minutes)\n            const now: number = new Date().getTime()\n            localStorage.setItem(\n              ESTIMATED_DOWNLOAD_SPEED_EXPIRE_TIME_KEY,\n              (now + 1000 * 60 * 5).toString(),\n            )\n            localStorage.setItem(\n              ESTIMATED_DOWNLOAD_SPEED_KEY,\n              result.toString(),\n            )\n            resolve(result)\n          })\n        })\n      })\n      .catch(err => reject(err))\n  })\n}\n","import React, { useState, useEffect } from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faFile, faDatabase, faClock } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { testDownloadSpeed } from '../../utils/functions/testDownloadSpeed'\nimport { calculateFriendlyFileSize } from '../../utils/functions/calculateFriendlyFileSize'\nimport ReactTooltip from 'react-tooltip'\nimport moment from 'moment'\nimport { TOOLTIP_DELAY_SHOW } from '../table/SynapseTableConstants'\n\nlibrary.add(faFile)\nlibrary.add(faDatabase)\nlibrary.add(faClock)\n\nexport type DownloadDetailsProps = {\n  numFiles: number\n  numBytes: number\n  token: string | undefined\n}\n\ntype State = {\n  isLoading: boolean\n  downloadSpeed: number\n}\n\nexport default function DownloadDetails(props: DownloadDetailsProps) {\n  const [state, setState] = useState<State>({\n    isLoading: true,\n    downloadSpeed: 0,\n  })\n  const { isLoading, downloadSpeed } = state\n  const { token, numFiles, numBytes } = props\n\n  useEffect(() => {\n    if (isLoading && token) {\n      testDownloadSpeed(token).then(speed => {\n        setState({\n          isLoading: false,\n          downloadSpeed: speed,\n        })\n      })\n    }\n  })\n\n  const timeEstimateInSeconds =\n    isLoading || downloadSpeed === 0 ? 0 : numBytes / downloadSpeed\n  const friendlyTime =\n    timeEstimateInSeconds === 0\n      ? ''\n      : moment.duration(timeEstimateInSeconds, 'seconds').humanize()\n  const numBytesTooltipId = 'num_bytes_id'\n  const friendlyTimeTooltipId = 'friendly_time_id'\n  const isInactive = numFiles === 0 || timeEstimateInSeconds === 0\n  const iconClassName = isInactive? 'SRC-inactive' : 'SRC-primary-text-color'\n  return (\n    <span className=\"download-details-container\">\n      <span>\n        <FontAwesomeIcon className={iconClassName} icon=\"file\" />\n        {!isInactive && <> {numFiles} &nbsp; files </>}\n      </span>\n      <span\n        data-for={numBytesTooltipId}\n        data-tip=\"This is the total size of all files. Zipped package(s) will likely be smaller.\"\n      >\n        <ReactTooltip\n          delayShow={TOOLTIP_DELAY_SHOW}\n          place=\"top\"\n          type=\"dark\"\n          effect=\"solid\"\n          id={numBytesTooltipId}\n        />\n        <FontAwesomeIcon className={iconClassName} icon=\"database\" />\n        {calculateFriendlyFileSize(numBytes)}\n      </span>\n      <span\n        data-for={friendlyTimeTooltipId}\n        data-tip=\"This is an estimate of how long package download will take.\"\n      >\n        <ReactTooltip\n          delayShow={TOOLTIP_DELAY_SHOW}\n          place=\"top\"\n          type=\"dark\"\n          effect=\"solid\"\n          id={friendlyTimeTooltipId}\n        />\n        <FontAwesomeIcon className={iconClassName} icon=\"clock\" />\n        {isLoading && <span className=\"loader\" />}\n        {!isLoading && friendlyTime}\n      </span>\n    </span>\n  )\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faTrash } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport moment from 'moment'\nimport React, { useEffect, useState } from 'react'\nimport * as ReactBootstrap from 'react-bootstrap'\nimport { calculateFriendlyFileSize } from '../../utils/functions/calculateFriendlyFileSize'\nimport useGetInfoFromIds from '../../utils/hooks/useGetInfoFromIds'\nimport {\n  deleteDownloadList,\n  deleteDownloadListFiles,\n  getDownloadList,\n  getEntityHeader,\n  getFiles,\n} from '../../utils/SynapseClient'\nimport {\n  BatchFileRequest,\n  BatchFileResult,\n  DownloadList,\n  EntityHeader,\n  FileHandleAssociateType,\n  FileHandleAssociation,\n  PaginatedResults,\n  Reference,\n  UserProfile,\n} from '../../utils/synapseTypes'\nimport HasAccess, {\n  getDownloadTypeForFileHandle,\n  FileHandleDownloadTypeEnum,\n} from '../HasAccess'\nimport UserCard from '../UserCard'\nimport { CreatePackage } from './CreatePackage'\nimport DownloadDetails from './DownloadDetails'\n\nlibrary.add(faTrash)\n\ntype DownloadListTableData = {\n  references?: PaginatedResults<EntityHeader>\n  batchFileResult?: BatchFileResult\n  downloadList?: DownloadList\n}\n\ntype LoadingState = boolean\nexport type DownloadListTableProps = {\n  token?: string,\n  listUpdatedCallback?: VoidFunction\n}\n\nexport const TESTING_TRASH_BTN_CLASS = 'TESTING_TRASH_BTN_CLASS'\nexport const TESTING_CLEAR_BTN_CLASS = 'TESTING_CLEAR_BTN_CLASS'\n\nexport default function DownloadListTable(props: DownloadListTableProps) {\n  // https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables\n  const [data, setData] = useState<DownloadListTableData>({\n    references: undefined,\n    batchFileResult: undefined,\n    downloadList: undefined,\n  })\n  // https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables\n  const [isLoading, setIsLoading] = useState<LoadingState>(true)\n  const [fileBeingDeleted, setFileBeingDeleted] = useState<string>('')\n  const { token } = props\n  const { references, batchFileResult, downloadList } = data\n  const requestedFiles =\n    (batchFileResult && batchFileResult.requestedFiles) || []\n  // Get owner ids from download list by filtering to items that have a file handle\n  // then map to ownerIds\n  const ownerIds: string[] = requestedFiles\n    .filter(el => el.fileHandle && el.fileHandle.createdBy)\n    // use bang operator because filter function guarentee's that file handle will be defined\n    .map(el => el.fileHandle!.createdBy!)\n  const userProfiles = useGetInfoFromIds<UserProfile>({ ids: ownerIds, token,type: 'USER_PROFILE' })\n\n  useEffect(() => {\n    fetchData(token)\n  }, [token])\n\n  const fetchData = async (token: string | undefined) => {\n    if (!token) {\n      setIsLoading(false)\n      // doesn't make sense with anonymous user!\n      return\n    }\n    try {\n      setIsLoading(true)\n      const downloadList = await getDownloadList(token)\n      const { filesToDownload } = downloadList\n      if (filesToDownload.length === 0) {\n        setData({\n          downloadList,\n        })\n        invokeDownloadListUpdatedEvent()\n        return\n      }\n      const batchFileRequest: BatchFileRequest = {\n        requestedFiles: filesToDownload,\n        includeFileHandles: true,\n        includePreSignedURLs: false,\n        includePreviewPreSignedURLs: false,\n      }\n      // batch file result gives FilesHandle for the files the user can download\n      // which has additional metadata - createdBy, numBytes, etc.\n      const batchFileResult = await getFiles(batchFileRequest, token)\n\n      // Only make entity header calls to the files that the user doesn't have access to,\n      // which can be determined by whether the batchFileResult has a failure code for the\n      // corresponding download list item\n      const referenceCall: Reference[] = filesToDownload\n        .filter(el => {\n          return (\n            batchFileResult.requestedFiles.find(\n              batchFile => batchFile.fileHandleId === el.fileHandleId,\n            )!.failureCode !== undefined\n          )\n        })\n        .map(el => {\n          return { targetId: el.associateObjectId }\n        })\n      // entity header is used to get the names of the files that the user\n      // doesn't have access to\n      const references = await getEntityHeader(referenceCall, token)\n      setData({\n        references,\n        batchFileResult,\n        downloadList,\n      })\n      invokeDownloadListUpdatedEvent()\n    } catch (e) {\n      console.error('Error in DownloadList API call : ', e)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const invokeDownloadListUpdatedEvent = () => {\n    if (props.listUpdatedCallback) {\n      props.listUpdatedCallback()\n    }\n  }\n  \n  const clearDownloadList = async (\n    _event: React.SyntheticEvent<HTMLButtonElement>,\n  ) => {\n    setIsLoading(true)\n    try {\n      await deleteDownloadList(token)\n      setData({\n        downloadList: undefined,\n      })\n      invokeDownloadListUpdatedEvent()\n    } catch (err) {\n      console.error('Error on clearing download list: ', err)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const deleteFileFromList = async (\n    fileHandleId: string,\n    associateObjectId: string,\n  ) => {\n    const list: FileHandleAssociation[] = [\n      {\n        fileHandleId,\n        associateObjectId,\n        associateObjectType: FileHandleAssociateType.FileEntity,\n      },\n    ]\n    setIsLoading(true)\n    setFileBeingDeleted(fileHandleId)\n    try {\n      const downloadList = await deleteDownloadListFiles(list, token)\n      // The current references and batchFileResult can be kept because the download\n      // list drives the view, so the stale values in those two won't be viewed.\n      setData({ downloadList, references, batchFileResult })\n      invokeDownloadListUpdatedEvent()\n    } catch (err) {\n      console.error('Error on delete from download list', err)\n    } finally {\n      setFileBeingDeleted('')\n      setIsLoading(false)\n    }\n  }\n\n  const filesToDownload = (downloadList && downloadList.filesToDownload) || []\n  const results = (references && references.results) || []\n  let numBytes = 0\n  let numFiles = 0\n  return (\n    <div>\n      <div className=\"SRC-split download-list-table-top\">\n        <span className=\"create-package-text SRC-centerContentInline\">\n          Download List &nbsp;&nbsp; {isLoading && <span className=\"spinner\" />}\n        </span>\n        <button\n          className=\"SRC-primary-text-color SRC-underline-on-hover\"\n          onClick={clearDownloadList}\n          id={TESTING_CLEAR_BTN_CLASS}\n        >\n          Clear All\n        </button>\n      </div>\n      <ReactBootstrap.Table responsive={true}>\n        <thead>\n          <tr>\n            <th>File Name</th>\n            <th>Access</th>\n            <th>Created By</th>\n            <th>Created On</th>\n            <th>Size</th>\n            {/* th below is made for trash can icon but holds no content */}\n            <th />\n          </tr>\n        </thead>\n        <tbody className=\"download-list-table\">\n          {filesToDownload.map(item => {\n            let createdBy = ''\n            let createdOn = ''\n            let fileName = ''\n            let contentSize = undefined\n            const synId = item.associateObjectId\n            const fileHandleId = item.fileHandleId\n            const isCurrentlyBeingDeletedClass =\n              fileBeingDeleted === fileHandleId ? 'SRC-inactive-bg' : ''\n            // See if batch file results has this fileHandleId\n            const fileResult = requestedFiles.find(\n              fileRes => fileRes.fileHandleId === fileHandleId,\n            )\n            const fileHandle = fileResult ? fileResult.fileHandle : undefined\n            const canDownload = fileHandle !== undefined\n            if (fileHandle) {\n              // fileHandle is defined, this file is downloadable, show its metadata\n              ;({ createdBy, createdOn, fileName, contentSize } = fileHandle)\n              createdOn = moment(createdOn).format('L LT')\n              if (\n                getDownloadTypeForFileHandle(fileHandle) ===\n                FileHandleDownloadTypeEnum.Accessible\n              ) {\n                numBytes += contentSize\n                numFiles += 1\n              }\n            } else {\n              // file is not downloadable, only show its name from entity header info\n              const requestedFile = results.find(\n                req => req.id === item.associateObjectId,\n              )!\n              fileName = requestedFile.name\n            }\n            const userProfile = userProfiles.find(\n              el => el.ownerId === createdBy,\n            )\n            return (\n              <tr className={isCurrentlyBeingDeletedClass} key={fileHandleId}>\n                <td>\n                  <a\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    href={`https://www.synapse.org/#!Synapse:${synId}`}\n                  >\n                    {fileName}\n                  </a>\n                </td>\n                <td>\n                  <HasAccess\n                    fileHandle={fileHandle}\n                    token={token}\n                    entityId={synId}\n                    isInDownloadList={true}\n                  />\n                </td>\n                <td>\n                  {userProfile && (\n                    <UserCard\n                      size={'SMALL USER CARD'}\n                      userProfile={userProfile}\n                      preSignedURL={userProfile.clientPreSignedURL}\n                    />\n                  )}\n                  {canDownload && !userProfile && <span className=\"spinner\" />}\n                </td>\n                <td>{createdOn}</td>\n                <td>{contentSize && calculateFriendlyFileSize(contentSize)}</td>\n                <td>\n                  <button\n                    className={TESTING_TRASH_BTN_CLASS}\n                    onClick={\n                      fileBeingDeleted === ''\n                        ? () => deleteFileFromList(fileHandleId, synId)\n                        : undefined\n                    }\n                  >\n                    <FontAwesomeIcon\n                      className=\"SRC-primary-text-color\"\n                      icon=\"trash\"\n                    />\n                  </button>\n                </td>\n              </tr>\n            )\n          })}\n        </tbody>\n      </ReactBootstrap.Table>\n      <CreatePackage updateDownloadList={() => fetchData(token)} token={token}>\n        <DownloadDetails\n          numBytes={numBytes}\n          numFiles={numFiles}\n          token={token}\n        />\n      </CreatePackage>\n    </div>\n  )\n}\n","import React, { FunctionComponent } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport ReactTooltip from 'react-tooltip'\nimport { TOOLTIP_DELAY_SHOW } from '../table/SynapseTableConstants'\nimport { IconDefinition } from '@fortawesome/fontawesome-svg-core'\nimport { Dropdown } from 'react-bootstrap'\n\ntype CustomImageProps = {\n  svgImg: string\n  altText: string\n}\n\nexport type TooltipVisualProps = {\n  delayShow: number\n  place: 'top' | 'right' | 'bottom' | 'left'\n  type: 'dark' | 'success' | 'warning' | 'error' | 'info' | 'light'\n  effect: 'float' | 'solid'\n  border?: boolean\n}\n\n/*****************************************\n *  The control needs to either have a child element or needs to have an image supplied\n *  If the child element is supplied the control renders the child applying additional proiperties\n *  If the image is supplied the control renders a clickable image\n *  If there are no children and callback Fn is not supplied it is assumed to be a a dropdown trigger\n */\n\ntype ElementWithTooltipProps = {\n  image?: IconDefinition | CustomImageProps\n  imageColor?: string\n  idForToolTip: string\n  tooltipText: string\n  callbackFn?: Function\n  className?: string\n  tooltipVisualProps?: TooltipVisualProps\n}\n\nfunction getTooltipTriggerContents(\n  image: IconDefinition | CustomImageProps,\n  imageColor?: string,\n): JSX.Element {\n  if ('svgImg' in image) {\n    return <img src={image.svgImg} alt={image.altText} />\n  } else {\n    return (\n      <FontAwesomeIcon size=\"1x\" color={imageColor || 'white'} icon={image} />\n    )\n  }\n}\n\nexport const ElementWithTooltip: FunctionComponent<ElementWithTooltipProps> = ({\n  image,\n  idForToolTip,\n  callbackFn,\n  tooltipText,\n  className,\n  imageColor,\n  tooltipVisualProps = { place: 'top', type: 'dark', effect: 'solid' },\n  children,\n}) => {\n  const { place, type, effect, border } = tooltipVisualProps\n  const tooltipTriggerContents = image\n    ? getTooltipTriggerContents(image, imageColor)\n    : children || <></>\n\n  //if there is no callbackFn - assume it's a toggle\n\n  let tooltipTrigger: JSX.Element\n  if (!children) {\n    tooltipTrigger = callbackFn ? (\n      <button\n        style={{ padding: '0 5px 0 5px' }}\n        tabIndex={0}\n        id={idForToolTip}\n        data-for={idForToolTip}\n        data-tip={tooltipText}\n        className={`SRC-hand-cursor ${\n          image ? 'SRC-primary-background-color-hover' : ''\n        } ${className}`}\n        onKeyPress={() => callbackFn()}\n        onClick={() => callbackFn()}\n        aria-label={tooltipText}\n      >\n        {tooltipTriggerContents}\n      </button>\n    ) : (\n      <Dropdown.Toggle\n        data-for={idForToolTip}\n        data-tip={tooltipText}\n        id={idForToolTip}\n        variant={'light'}\n      >\n        {tooltipTriggerContents}\n      </Dropdown.Toggle>\n    )\n  } else {\n    const outerChild = children as JSX.Element\n    tooltipTrigger = React.cloneElement(outerChild, {\n      className: `${outerChild.props.className} SRC-hand-cursor`,\n      id: idForToolTip,\n      ['data-for']: idForToolTip,\n      ['data-tip']: tooltipText,\n    })\n  }\n\n  return (\n    <>\n      {tooltipTrigger}\n      <ReactTooltip\n        delayShow={TOOLTIP_DELAY_SHOW}\n        place={place}\n        type={type}\n        effect={effect}\n        border={border ? true : false}\n        id={idForToolTip}\n      />\n    </>\n  )\n}\n","import moment from 'moment'\nimport React, { useEffect, useState } from 'react'\nimport { SynapseClient, SynapseConstants } from '../../utils'\nimport { testDownloadSpeed } from '../../utils/functions/testDownloadSpeed'\nimport {\n  AddFilesToDownloadListRequest,\n  Query,\n  QueryBundleRequest,\n} from '../../utils/synapseTypes/'\nimport DownloadDetails from './DownloadDetails'\n\nenum StatusEnum {\n  LOADING_INFO,\n  PROCESSING,\n  INFO,\n  SUCCESS,\n  ERROR,\n}\n\nexport type DownloadConfirmationState = {\n  fileCount: number\n  fileSize: number\n  downloadEstimate?: string\n  status: StatusEnum\n  errorMessage?: string\n  ownerId?: string\n}\nexport type DownloadConfirmationProps = {\n  fnClose: Function\n  token: string\n  queryBundleRequest: QueryBundleRequest\n}\n\n//get the info about the files stats\nasync function getFilesInformation(\n  queryBundleRequest: QueryBundleRequest,\n  token: string,\n): Promise<DownloadConfirmationState> {\n  const partMask =\n    SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n    SynapseConstants.BUNDLE_MASK_SUM_FILES_SIZE_BYTES\n\n  const queryBundleRequestSizeInformation: QueryBundleRequest = {\n    ...queryBundleRequest,\n    partMask,\n  }\n\n  const { queryCount, sumFileSizes } = await SynapseClient.getQueryTableResults(\n    queryBundleRequestSizeInformation,\n  )\n  const estimatedDownloadBytesPerSecond = await testDownloadSpeed(token)\n  const size = sumFileSizes ? sumFileSizes['sumFileSizesBytes'] : 0\n  const durationSeconds = size / estimatedDownloadBytesPerSecond\n  const duration = moment.duration(durationSeconds, 'seconds').humanize()\n\n  return {\n    fileCount: queryCount || 0,\n    fileSize: size,\n    downloadEstimate: duration,\n    status: StatusEnum.INFO,\n  }\n}\n\n// add files to download list\nasync function addToDownload(\n  query: Query,\n  token: string,\n): Promise<[StatusEnum, string]> {\n  const req: AddFilesToDownloadListRequest = {\n    concreteType:\n      'org.sagebionetworks.repo.model.file.AddFileToDownloadListRequest',\n    query: query,\n  }\n  try {\n    const result = await SynapseClient.addFilesToDownloadList(req, token)\n    const ownerId = result.downloadList.ownerId\n    return [StatusEnum.SUCCESS, ownerId]\n  } catch (error) {\n    return [StatusEnum.ERROR, error.reason]\n  }\n}\n\ntype UiStateDictionary = {\n  [key: string]: {\n    className: string\n    infoText: string\n    closeText: string\n  }\n}\n\n// css classes, text, and close button text associated with different stages\nconst StatusConstruct: UiStateDictionary = {\n  [StatusEnum.INFO]: {\n    className: 'alert-info',\n    infoText: 'Would you like to add all files to the download list?',\n    closeText: 'Cancel',\n  },\n\n  [StatusEnum.PROCESSING]: {\n    className: 'alert-info',\n    infoText: 'Adding Files To List',\n    closeText: 'Cancel',\n  },\n\n  [StatusEnum.LOADING_INFO]: {\n    className: 'alert-info',\n    infoText: 'Calculating File Size',\n    closeText: 'Cancel',\n  },\n\n  [StatusEnum.ERROR]: {\n    className: 'alert-danger',\n    closeText: 'Close',\n    infoText: '',\n  },\n  [StatusEnum.SUCCESS]: {\n    className: 'alert-info',\n    closeText: 'Close',\n    infoText: '',\n  },\n}\n\n//============= DownloadConfirmation component =============\n\nexport const DownloadConfirmation: React.FunctionComponent<DownloadConfirmationProps> = ({\n  queryBundleRequest,\n  token,\n  fnClose,\n}) => {\n  const [state, setState] = useState<DownloadConfirmationState>({\n    fileCount: 0,\n    fileSize: 0,\n    status: StatusEnum.LOADING_INFO,\n  })\n\n  useEffect(() => {\n    ;(async function getDataOnLoad(query: QueryBundleRequest, token: string) {\n      const result = await getFilesInformation(query, token)\n      setState(result)\n    })(queryBundleRequest, token)\n  }, [queryBundleRequest, token])\n\n  const hideComponent = () => fnClose()\n\n  const triggerAddToDownload = async () => {\n    setState({ ...state, status: StatusEnum.PROCESSING })\n    const result = await addToDownload(queryBundleRequest.query, token)\n    const status = result[0]\n\n    if (status === StatusEnum.SUCCESS) {\n      setState({ ...state, ownerId: result[1], status })\n    } else {\n      setState({ ...state, errorMessage: result[1], status })\n    }\n  }\n\n  const getContent = (\n    {\n      status,\n      fileCount,\n      fileSize,\n      errorMessage,\n      ownerId,\n    }: DownloadConfirmationState,\n    token: string,\n  ): JSX.Element => {\n    switch (status) {\n      case StatusEnum.LOADING_INFO:\n      case StatusEnum.PROCESSING:\n        return (\n          <div>\n            <span className={'spinner white'} />\n            <span className={'spinner__text'}>\n              {StatusConstruct[status].infoText}\n            </span>\n          </div>\n        )\n\n      case StatusEnum.ERROR:\n        return <>{errorMessage}</>\n\n      case StatusEnum.INFO:\n        return (\n          <>\n            <DownloadDetails\n              token={token}\n              numFiles={fileCount}\n              numBytes={fileSize}\n            ></DownloadDetails>\n            <span>{StatusConstruct[status].infoText}</span>\n          </>\n        )\n\n      case StatusEnum.SUCCESS:\n        return (\n          <span>\n            <a\n              href={`https://www.synapse.org/#!Profile:${ownerId}/downloads`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              View Download List\n            </a>\n          </span>\n        )\n\n      default:\n        return <></>\n    }\n  }\n\n  return (\n    <div\n      className={`alert download-confirmation ${\n        StatusConstruct[state.status].className\n      }`}\n    >\n      <div className=\"download-confirmation__section\">\n        {getContent(state, token)}\n      </div>\n      <div\n        className=\"download-confirmation__section text-right\"\n        style={{\n          width: '150px',\n        }}\n      >\n        {state.status !== StatusEnum.PROCESSING && (\n          <button className=\"btn btn-link\" onClick={hideComponent}>\n            {StatusConstruct[state.status].closeText}\n          </button>\n        )}\n\n        {state.status === StatusEnum.INFO && (\n          <button\n            type=\"button\"\n            className=\"btn btn-primary\"\n            onClick={triggerAddToDownload}\n          >\n            Add\n          </button>\n        )}\n      </div>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { EntityHeader } from '../utils/synapseTypes/'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faLink,\n  faFolder,\n  faFile,\n  faListAlt,\n  faTable,\n  faThList,\n  faArchive,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nlibrary.add(faLink)\nlibrary.add(faFolder)\nlibrary.add(faFile)\nlibrary.add(faListAlt)\nlibrary.add(faTable)\nlibrary.add(faThList)\nlibrary.add(faArchive)\n\ntype IconType =\n  | 'FileEntity'\n  | 'Folder'\n  | 'Link'\n  | 'Project'\n  | 'TableEntity'\n  | 'EntityView'\n\nconst getIconTypeForEntity = (name: IconType) => {\n  switch (name) {\n    case 'Link':\n      return 'link'\n    case 'Folder':\n      return 'folder'\n    case 'FileEntity':\n      return 'file'\n    case 'TableEntity':\n      return 'table'\n    case 'Project':\n      return 'list-alt'\n    case 'EntityView':\n      return 'th-list'\n    default:\n      return ''\n  }\n}\n\ntype EntityTypeIconProps = {\n  type: string\n}\nconst EntityTypeIcon: React.SFC<EntityTypeIconProps> = ({ type }) => {\n  const splitType = type.split('.')\n  const name = splitType[splitType.length - 1] as IconType\n  const iconType = getIconTypeForEntity(name)\n  const iconStyle: React.CSSProperties = {\n    marginRight: 5,\n  }\n  if (iconType === '') {\n    console.log('Entity Type not mapped = ', type)\n    return <React.Fragment />\n  }\n  return <FontAwesomeIcon style={iconStyle} icon={iconType} />\n}\n\ntype EntityLinkProps = {\n  entityHeader: EntityHeader\n  className?: string\n}\n\nexport const EntityLink: React.SFC<EntityLinkProps> = ({\n  entityHeader,\n  className,\n}) => {\n  const { id, name, type } = entityHeader\n  return (\n    <a\n      className={className}\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      href={`https://www.synapse.org/#!Synapse:${id}`}\n    >\n      <p className={className}>\n        <EntityTypeIcon type={type} />\n        {name}\n      </p>\n    </a>\n  )\n}\n","import { UiSchema } from 'react-jsonschema-form'\nimport { JSONSchema6 } from 'json-schema'\n\nexport const writeHeaderOption = \"First line is the columns names.\"\nexport const includeRowIdAndRowVersionOption = \"Include row metadata (Row Id and Row Version).\"\nexport const csvOption = \"Comma Separated Values (CSV)\"\nexport const tsvOption = \"Tab Separated Values (TSV)\"\n\n// Step 1\nconst stepOneFormSchema: JSONSchema6 = {\n  title: 'Download query results',\n  type: 'object',\n  properties: {\n    'File Type'  : {\n      type: \"string\",\n      oneOf: [\n        {\n          const: csvOption,\n          title: csvOption\n        },\n        {\n          const: tsvOption,\n          title: tsvOption\n        }\n      ],\n    },\n    Contents : {\n      type: \"array\",\n      title: 'Contents',\n      items: {\n        type: 'string',\n        enum: [writeHeaderOption, includeRowIdAndRowVersionOption],\n      },\n      uniqueItems: true\n    }\n  }\n}\n\nconst stepOneFormUISchema: UiSchema = {\n  'File Type': {\n    \"ui:widget\": \"radio\"\n  },\n  Contents: {\n    'ui:widget': 'checkboxes'\n  }\n}\n\n// Step 2\nconst stepTwoFormSchema: JSONSchema6 = {\n  title: 'Download query results',\n  description: 'File is ready for download. Select the download button to download the file.',\n  type: 'object',\n}\n\nconst stepTwoFormUISchema: UiSchema = {\n}\n\nexport const formSchemaArray = [stepOneFormSchema, stepTwoFormSchema]\nexport  const formSchemaUIArray = [stepOneFormUISchema, stepTwoFormUISchema]","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport { Modal } from 'react-bootstrap'\nimport Form, { IChangeEvent } from 'react-jsonschema-form'\nimport { SynapseClient } from '../utils'\nimport {\n  DownloadFromTableRequest,\n  DownloadFromTableResult,\n  FacetColumnRequest,\n  SortItem,\n} from '../utils/synapseTypes/'\nimport {\n  csvOption,\n  formSchemaArray,\n  formSchemaUIArray,\n  includeRowIdAndRowVersionOption,\n  writeHeaderOption,\n} from './ModalDownload.FormSchema'\n\nlibrary.add(faTimes)\n\nexport type ModalDownloadState = {\n  isLoading: boolean\n  step: number\n  data?: DownloadFromTableResult\n  formData: {}\n}\n\nexport type ModalDownloadProps = {\n  entityId: string\n  sql: string\n  onClose: (...args: any[]) => void\n  token?: string\n  includeEntityEtag?: boolean\n  selectedFacets?: FacetColumnRequest[] // The selected facet filters.\n  isConsistent?: boolean\n  offset?: number\n  limit?: number\n  sort?: SortItem[]\n}\n\nexport default class ModalDownload extends React.Component<\n  ModalDownloadProps,\n  ModalDownloadState\n> {\n  constructor(props: ModalDownloadProps) {\n    super(props)\n    this.state = {\n      isLoading: false,\n      step: 0,\n      formData: {\n        'File Type': csvOption,\n        Contents: [writeHeaderOption, includeRowIdAndRowVersionOption],\n      },\n    }\n  }\n\n  handleSubmit = (event: IChangeEvent) => {\n    if (this.state.step === 0) {\n      this.handleDownloadSetup(event)\n    } else {\n      this.onDownload()\n    }\n  }\n\n  handleDownloadSetup = (event: IChangeEvent) => {\n    this.setState({\n      isLoading: true,\n    })\n    const { formData } = event\n    const fileType = formData['File Type']\n    const contents = formData.Contents as string[]\n    const { token, onClose, ...rest } = this.props\n    const separator = fileType === csvOption ? ',' : '\\t'\n    const writeHeader = contents.includes(writeHeaderOption)\n    const includeRowIdAndRowVersion = contents.includes(\n      includeRowIdAndRowVersionOption,\n    )\n    const downloadFromTableRequest: DownloadFromTableRequest = {\n      ...rest,\n      concreteType:\n        'org.sagebionetworks.repo.model.table.DownloadFromTableRequest',\n      writeHeader,\n      includeRowIdAndRowVersion,\n      csvTableDescriptor: { separator },\n    }\n    SynapseClient.getDownloadFromTableRequest(downloadFromTableRequest, token)\n      .then(data => {\n        this.setState({\n          isLoading: false,\n          step: 1,\n          data,\n        })\n      })\n      .catch(err => {\n        console.log('Error getDownloadFromTableRequest: ', err)\n      })\n  }\n\n  onDownload = () => {\n    const { data } = this.state\n    const { token } = this.props\n    // data will always be defined if calling this function\n    SynapseClient.getFileHandleByIdURL(data!.resultsFileHandleId, token).then(\n      url => {\n        window.location.href = url\n        this.props.onClose()\n      },\n    )\n  }\n\n  handleChange = (event: IChangeEvent) => {\n    const { formData } = event\n    this.setState({\n      formData,\n    })\n  }\n\n  render() {\n    const closeBtn: React.CSSProperties = {\n      position: 'absolute',\n      top: 10,\n      right: 10,\n      zIndex: 10,\n    }\n    const submitBtn: React.CSSProperties = {\n      padding: '6px 10px',\n      borderRadius: 6,\n    }\n    const spinnerStyle: React.CSSProperties = {\n      height: 50,\n      width: 50,\n      backgroundSize: 50,\n    }\n    return (\n      <Modal\n        animation={false}\n        centered={true}\n        show={true}\n        onHide={this.props.onClose}\n      >\n        <Modal.Header>\n          <button style={closeBtn} onClick={this.props.onClose}>\n            <FontAwesomeIcon style={{ fontSize: '21px' }} icon=\"times\" />\n          </button>\n          <Form\n            schema={formSchemaArray[this.state.step]}\n            uiSchema={formSchemaUIArray[this.state.step]}\n            onChange={this.handleChange}\n            formData={this.state.formData}\n            onSubmit={this.handleSubmit}\n          >\n            {this.state.isLoading && (\n              <div className=\"SRC-centerAndJustifyContent\">\n                <div className=\"SRC-center-text\">\n                  <p> Creating the File </p>\n                  <div style={spinnerStyle} className=\"spinner\" />\n                  <p> Loading... </p>\n                </div>\n              </div>\n            )}\n            <hr />\n            <div style={{ textAlign: 'right' }}>\n              <button\n                id=\"cancelBtn\"\n                onClick={this.props.onClose}\n                className=\"SRC-primary-text-color SRC-roundBorder SRC-underline-on-hover \"\n                type=\"button\"\n              >\n                Cancel\n              </button>\n              <button\n                id=\"submitBtn\"\n                style={submitBtn}\n                className=\"SRC-primary-background-color SRC-roundBorder SRC-whiteText\"\n                type=\"submit\"\n              >\n                {this.state.step === 0 ? 'Next' : 'Download'}\n              </button>\n            </div>\n          </Form>\n        </Modal.Header>\n      </Modal>\n    )\n  }\n}\n","import { Modal, ModalBody, ModalFooter, Button } from 'react-bootstrap'\nimport ModalHeader from 'react-bootstrap/ModalHeader'\nimport React from 'react'\n\nexport type DownloadLoginModalProps = {\n  showModal?: boolean\n  onHide: Function\n}\n\nexport const DownloadLoginModal: React.FunctionComponent<DownloadLoginModalProps> = props => {\n  return (\n    <Modal\n      animation={false}\n      centered={true}\n      show={true}\n      onHide={() => props.onHide()}\n    >\n      <ModalHeader closeButton>\n        <span\n          style={{ fontWeight: 'bold', color: '#515359', fontSize: '1.5em' }}\n        >\n          Sign In Required\n        </span>\n      </ModalHeader>\n      <ModalBody>\n        <p>\n          Anyone can browse public content on the Synapse website, but in order\n          to download and create content you will need to register for an\n          account using an email address.\n        </p>\n        <p>\n          To find out more see&nbsp;\n          <a\n            href=\"https://docs.synapse.org/articles/user_profiles.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            User Accounts\n          </a>\n          <span> and </span>\n          <a\n            href=\"https://docs.synapse.org/articles/governance.html\"\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            Governance Overview\n          </a>\n          .\n        </p>\n      </ModalBody>\n      <ModalFooter>\n        <Button variant=\"secondary\" onClick={() => props.onHide()}>\n          CANCEL\n        </Button>\n        <Button\n          className=\"SRC-primary-button SRC-SIGN-IN-CLASS\"\n          variant=\"primary\"\n          onClick={() => props.onHide()}\n        >\n          Sign in\n        </Button>\n      </ModalFooter>\n    </Modal>\n  )\n}\n","import * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faEllipsisV } from '@fortawesome/free-solid-svg-icons'\nimport { DownloadLoginModal } from './DownloadLoginModal'\n\nlibrary.add(faEllipsisV)\n\ntype EllipsisDropdownProps = {\n  onDownloadFiles: Function\n  onDownloadTableOnly: Function\n  onShowColumns: Function\n  onFullScreen: Function\n  isExpanded: boolean\n  isUnauthenticated?: boolean\n  isGroupedQuery?: boolean\n  isFileView?: boolean\n}\nconst tooltipEllipsis = 'tooltip-ellipsis'\n\nexport const EllipsisDropdown: React.FunctionComponent<EllipsisDropdownProps> = props => {\n  const {\n    onDownloadFiles,\n    onDownloadTableOnly,\n    onShowColumns,\n    onFullScreen,\n    isExpanded,\n  } = props\n  const [showModal, setShowModal] = React.useState(false)\n  return (\n    <>\n      <Dropdown style={{ padding: 0 }}>\n        <ElementWithTooltip\n          idForToolTip={tooltipEllipsis}\n          tooltipText={'Table Options'}\n          image={faEllipsisV}\n        ></ElementWithTooltip>\n        <Dropdown.Menu\n          className=\"SRC-primary-color-hover-dropdown\"\n          alignRight={true}\n        >\n          {!props.isGroupedQuery && [\n            props.isFileView && (\n              <Dropdown.Item\n                key=\"download_files\"\n                onClick={() =>\n                  props.isUnauthenticated\n                    ? setShowModal(true)\n                    : onDownloadFiles()\n                }\n              >\n                Download Files\n              </Dropdown.Item>\n            ),\n            <Dropdown.Item\n              key=\"download_tables\"\n              onClick={() => onDownloadTableOnly()}\n            >\n              Download Table Only\n            </Dropdown.Item>,\n            <Dropdown.Divider key=\"divider1\" />,\n          ]}\n          <Dropdown.Item key=\"show_columns\" onClick={() => onShowColumns()}>\n            Show Columns\n          </Dropdown.Item>\n          <Dropdown.Item key=\"expand\" onClick={() => onFullScreen()}>\n            {isExpanded ? 'Shrink' : 'Full Screen'}\n          </Dropdown.Item>\n        </Dropdown.Menu>\n      </Dropdown>\n      {showModal && (\n        <DownloadLoginModal\n          showModal={showModal}\n          onHide={() => setShowModal(false)}\n        ></DownloadLoginModal>\n      )}\n    </>\n  )\n}\n","import * as React from 'react'\nimport ExpandSvg from '../../../assets/icons/expand.svg'\nimport ShrinkSvg from '../../../assets/icons/shrink.svg'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\n\ntype ExpandTableProps = {\n  onExpand: Function\n  isExpanded: boolean\n}\n\nexport const ExpandTable: React.FunctionComponent<ExpandTableProps> = props => {\n  const { onExpand, isExpanded } = props\n\n  return (\n    <>\n      <ElementWithTooltip\n        idForToolTip={'expand'}\n        callbackFn={() => onExpand()}\n        tooltipText={\n          isExpanded ? 'Shrink table to fit' : 'Expand table in full screen'\n        }\n        image={{\n          svgImg: isExpanded ? ShrinkSvg : ExpandSvg,\n          altText: isExpanded ? 'shrink table' : 'expand table',\n        }}\n      />\n    </>\n  )\n}\n","import { DownloadLoginModal } from './DownloadLoginModal'\nimport * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\nimport { faDownload } from '@fortawesome/free-solid-svg-icons'\n\nexport const DOWNLOAD_OPTIONS_CONTAINER_CLASS = 'SRC-download-options-container'\n\ntype DownloadOptionsProps = {\n  onDownloadFiles: Function\n  onExportMetadata: Function\n  isUnauthenticated?: boolean\n  isFileView?: boolean\n}\n\nexport const DOWNLOAD_FILES_MENU_TEXT = 'Download Files'\nconst tooltipDownloadId = 'download'\n\nexport const DownloadOptions: React.FunctionComponent<DownloadOptionsProps> = props => {\n  const [showModal, setShowModal] = React.useState(false)\n  const { onDownloadFiles, onExportMetadata } = props\n\n  return (\n    <React.Fragment>\n      <Dropdown style={{ padding: 0 }}>\n        <ElementWithTooltip\n          idForToolTip={tooltipDownloadId}\n          tooltipText={'Download Options'}\n          image={faDownload}\n        ></ElementWithTooltip>\n        <Dropdown.Menu\n          className=\"SRC-primary-color-hover-dropdown\"\n          alignRight={true}\n        >\n          <Dropdown.Item\n            // @ts-ignore\n            onClick={onExportMetadata}\n          >\n            Export Metadata\n          </Dropdown.Item>\n          {props.isFileView && (\n            <Dropdown.Item\n              onClick={() =>\n                props.isUnauthenticated ? setShowModal(true) : onDownloadFiles()\n              }\n            >\n              {DOWNLOAD_FILES_MENU_TEXT}\n            </Dropdown.Item>\n          )}\n        </Dropdown.Menu>\n      </Dropdown>\n      {showModal && (\n        <DownloadLoginModal\n          showModal={showModal}\n          onHide={() => setShowModal(false)}\n        ></DownloadLoginModal>\n      )}\n    </React.Fragment>\n  )\n}\n","import * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { ElementWithTooltip } from '../../widgets/ElementWithTooltip'\nimport { SelectColumn } from '../../../utils/synapseTypes/'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport ColumnsSvg from '../../../assets/icons/columns.svg'\n\ntype ColumnSelectionProps = {\n  headers: SelectColumn[]\n  isColumnSelected: boolean[]\n  visibleColumnCount?: number\n  show: boolean\n  onToggle: (\n    _show: boolean,\n    _event: React.SyntheticEvent<any, Event>,\n    metadata: any,\n  ) => void\n  toggleColumnSelection: (\n    index: number,\n  ) => (_event: React.MouseEvent<HTMLLIElement, MouseEvent>) => void\n}\n\nconst tooltipColumnSelectionId = 'addAndRemoveColumns'\n\nexport const ColumnSelection: React.FunctionComponent<ColumnSelectionProps> = (\n  props: ColumnSelectionProps,\n) => {\n  const {\n    headers,\n    isColumnSelected,\n    visibleColumnCount = Infinity,\n    show,\n    onToggle,\n    toggleColumnSelection,\n  } = props\n  return (\n    <Dropdown\n      style={{ padding: 0 }}\n      onToggle={(show: boolean, event: any, metadata: any) =>\n        onToggle(show, event, metadata)\n      }\n      show={show}\n    >\n      <ElementWithTooltip\n        idForToolTip={tooltipColumnSelectionId}\n        tooltipText={'Add / Remove Columns'}\n        image={{\n          svgImg: ColumnsSvg,\n          altText: 'columns selection',\n        }}\n      ></ElementWithTooltip>\n\n      {/* There's a known issue if the number of dropdown items is very large, ~30+, the dropdown\n          will unexpectedly render with the list going upwards instead of downwards.\n        */}\n      <Dropdown.Menu\n        className=\"SRC-primary-color-hover-dropdown\"\n        alignRight={true}\n      >\n        {headers.map((header, index) => {\n          let isCurrentColumnSelected: boolean | undefined =\n            isColumnSelected[index]\n          if (isCurrentColumnSelected === undefined) {\n            isCurrentColumnSelected = index < visibleColumnCount\n          }\n          const iconStyle: React.CSSProperties = {\n            width: '11px',\n            marginRight: '10px',\n          }\n          if (!isCurrentColumnSelected) {\n            iconStyle.visibility = 'hidden'\n          }\n          const maybeShowPrimaryColor = isCurrentColumnSelected\n            ? 'SRC-primary-text-color'\n            : ''\n          return (\n            <Dropdown.Item\n              // @ts-ignore\n              onClick={toggleColumnSelection(index)}\n              key={header.name}\n            >\n              <FontAwesomeIcon\n                style={iconStyle}\n                className={maybeShowPrimaryColor}\n                icon=\"check\"\n              />\n              {header.name}\n            </Dropdown.Item>\n          )\n        })}\n      </Dropdown.Menu>\n    </Dropdown>\n  )\n}\n","import * as React from 'react'\nimport { Dropdown } from 'react-bootstrap'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport {\n  FacetColumnResultValues,\n  FacetColumnResultValueCount,\n} from '../../../utils/synapseTypes/'\nimport { getIsValueSelected } from '../../../utils/functions/facetUtils'\nimport { SELECT_ALL } from '../SynapseTableConstants'\nimport { FacetSelection } from '../../../containers/QueryWrapper'\n\ntype FacetFilterProps = {\n  facetColumnResult: FacetColumnResultValues\n  isAllFilterSelectedForFacet: boolean\n  applyChanges: Function\n  lastFacetSelection: FacetSelection\n  isLoading: boolean\n}\n\ntype FacetFilterState = {\n  show: boolean\n}\n\nexport default class FacetFilter extends React.Component<\n  FacetFilterProps,\n  FacetFilterState\n> {\n  public ref: React.Ref<HTMLSpanElement>\n\n  style: React.CSSProperties = {\n    overflowY: 'auto',\n    maxHeight: 300,\n    zIndex: 1,\n  }\n\n  constructor(props: FacetFilterProps) {\n    super(props)\n    this.state = {\n      show: false,\n    }\n    this.ref = React.createRef()\n  }\n\n  // Any click event for the Dropdown will close the dropdown (assuming its open), so we have\n  // to handle the onToggle event and manually manage the dropdown open state. If metadata\n  // is defined the event occuring is inside the dropdown which we then want to keep open, otherwise\n  // we close it.\n  onToggle = (\n    _show: boolean,\n    _event: React.SyntheticEvent<Dropdown<'div'>, Event>,\n    metadata: any,\n  ) => {\n    if (metadata.source) {\n      this.setState({\n        show: true,\n      })\n    } else {\n      this.setState({\n        show: false,\n      })\n    }\n  }\n\n  render = () => {\n    const {\n      facetColumnResult,\n      isAllFilterSelectedForFacet,\n      applyChanges,\n      isLoading,\n      lastFacetSelection,\n    } = this.props\n    const { columnName } = facetColumnResult\n    const { show } = this.state\n    const color = show ? 'white' : ''\n    const allRef: React.Ref<HTMLInputElement> = React.createRef()\n    return (\n      <Dropdown show={show} onToggle={this.onToggle}>\n        <Dropdown.Toggle\n          className=\"SRC-primary-text-color SRC-primary-background-color-hover condenced\"\n          id={facetColumnResult.columnName}\n          variant={'light'}\n        >\n          <FontAwesomeIcon\n            style={{ margin: 'auto' }}\n            size={'1x'}\n            icon=\"filter\"\n            color={color}\n          />\n        </Dropdown.Toggle>\n        <Dropdown.Menu style={this.style}>\n          <Dropdown.Item\n            onClick={() => {\n              allRef.current!.click()\n            }}\n          >\n            <li className=\"checkbox SRC-table-checkbox\">\n              <label\n                className=\"dropdownList SRC-border-bottom-only SRC-overflowWrap SRC-base-font SRC-fullWidth\"\n                style={{ paddingBottom: 10 }}\n              >\n                <input\n                  ref={allRef}\n                  onClick={event =>\n                    applyChanges({\n                      ref: this.ref,\n                      columnName,\n                      selector: SELECT_ALL,\n                    })(event)\n                  }\n                  checked={isAllFilterSelectedForFacet}\n                  className=\"SRC-facet-checkboxes\"\n                  type=\"checkbox\"\n                />\n                <span> All </span>\n              </label>\n            </li>\n          </Dropdown.Item>\n          <span ref={this.ref}>\n            {facetColumnResult.facetValues.map(\n              (facetColumnResultValueCount: FacetColumnResultValueCount) => {\n                const { value: facetValue, count } = facetColumnResultValueCount\n                let displayValue = facetValue\n                if (\n                  displayValue === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n                ) {\n                  displayValue = 'unannotated'\n                }\n                const isValueSelected = isAllFilterSelectedForFacet\n                  ? false\n                  : getIsValueSelected({\n                      columnName,\n                      isLoading,\n                      lastFacetSelection,\n                      curFacetSelection: facetColumnResultValueCount,\n                    })\n                const inputRef: React.Ref<HTMLInputElement> = React.createRef()\n                return (\n                  <Dropdown.Item\n                    onClick={() => {\n                      inputRef.current!.click()\n                    }}\n                    key={facetValue}\n                  >\n                    <li\n                      className=\"checkbox SRC-table-checkbox\"\n                      key={facetValue}\n                    >\n                      <label className=\"dropdownList SRC-overflowWrap SRC-base-font SRC-fullWidth\">\n                        <input\n                          ref={inputRef}\n                          onChange={applyChanges({\n                            ref: this.ref,\n                            columnName,\n                            facetValue,\n                          })}\n                          checked={isValueSelected}\n                          className=\"SRC-facet-checkboxes\"\n                          type=\"checkbox\"\n                          value={facetValue}\n                        />\n                        <span>\n                          {displayValue}\n                          <span style={{ color: '#DDDDDF', marginLeft: '3px' }}>\n                            ({count})\n                          </span>\n                        </span>\n                      </label>\n                    </li>\n                  </Dropdown.Item>\n                )\n              },\n            )}\n          </span>\n        </Dropdown.Menu>\n      </Dropdown>\n    )\n  }\n}\n","import React, { useState } from 'react'\nimport moment from 'moment'\n\ntype ControlType = 'number' | 'date'\n\nexport type RangeValues = {\n  min?: string\n  max?: string\n}\n\nexport type RangeProps = {\n  type: ControlType\n  initialValues?: RangeValues\n  className?: string\n  errorText?: string\n  onChange: Function\n}\n\nexport const Range: React.FunctionComponent<RangeProps> = (\n  props: RangeProps,\n) => {\n  const errorText = 'Min value should be less then max value'\n  const [error, setError] = useState(false)\n  const [values, setValues] = useState(() =>\n    props.type === 'number' && props.initialValues\n      ? props.initialValues\n      : (props.initialValues && {\n          min: moment(props.initialValues.min).format('YYYY-MM-DD'),\n          max: moment(props.initialValues.max).format('YYYY-MM-DD'),\n        }) || {\n          min: undefined,\n          max: undefined,\n        },\n  )\n\n  const className = props.className ? `range ${props.className}` : `range`\n\n  const isValid = (\n    { min, max }: RangeValues,\n\n    type: ControlType = 'number',\n  ) => {\n    if (\n      min === null ||\n      min === undefined ||\n      max === null ||\n      max === undefined\n    ) {\n      setError(false)\n      return true\n    }\n\n    if (type === 'number') {\n      if (Number(min) > Number(max)) {\n        setError(true)\n        return false\n      }\n    }\n    if (Date.parse(min) > Date.parse(max)) {\n      setError(true)\n      return false\n    }\n    setError(false)\n    return true\n  }\n\n  const handleAppyChanges = (\n    values: RangeValues,\n    callBackFn: Function,\n    type: ControlType = 'number',\n  ) => {\n    if (isValid(values, type)) {\n      callBackFn(values)\n    }\n  }\n\n  return (\n    <div className={className} style={{ display: 'flex', flexWrap: 'wrap' }}>\n      <div style={{ marginRight: '10px' }}>\n        <input\n          key=\"range_min\"\n          type={props.type}\n          value={values.min}\n          onChange={({ target }: React.ChangeEvent<HTMLInputElement>) =>\n            setValues({ min: target.value, max: values.max })\n          }\n        />\n        <div>to</div>\n        <input\n          key=\"range_max\"\n          type={props.type}\n          value={values.max}\n          onChange={({ target }: React.ChangeEvent<HTMLInputElement>) =>\n            setValues({ min: values.min, max: target.value })\n          }\n        />\n      </div>\n      <button\n        className=\"btn btn-link SRC-noPadding\"\n        onClick={() => handleAppyChanges(values, props.onChange, props.type)}\n      >\n        Apply\n      </button>\n      {error && (\n        <div className=\"SRC-danger-color\">{props.errorText || errorText}</div>\n      )}\n    </div>\n  )\n}\n","import * as React from 'react'\n\nimport { Slider, Rail, Handles, Tracks, Ticks } from 'react-compound-slider'\nimport {\n  SliderItem,\n  GetHandleProps,\n  GetTrackProps,\n} from 'react-compound-slider'\nimport { RangeValues } from './Range'\nimport { useState } from 'react'\n\n\n/**************** RANGE SLIDER SUBCOMPONENTS *********************/\n\n/***  handles ***/\n\ninterface IHandleProps {\n  domain: number[]\n  handle: SliderItem\n  getHandleProps: GetHandleProps\n}\n\nexport const Handle: React.FunctionComponent<IHandleProps> = ({\n  domain: [min, max],\n  handle: { id, value, percent },\n  getHandleProps,\n}) => (\n  <div\n    role=\"slider\"\n    className=\"RangeSlider__handle\"\n    aria-valuemin={min}\n    aria-valuemax={max}\n    aria-valuenow={value}\n    style={{\n      left: `${percent}%`,\n    }}\n    {...getHandleProps(id)}\n  />\n)\n\n\n/***   track  ***/\ninterface ITrackProps {\n  source: SliderItem\n  target: SliderItem\n  getTrackProps: GetTrackProps\n}\n\nexport const Track: React.FunctionComponent<ITrackProps> = ({\n  source,\n  target,\n  getTrackProps,\n}) => (\n  <div\n    className=\"RangeSlider__track\"\n    style={{\n      left: `${source.percent}%`,\n      width: `${target.percent - source.percent}%`,\n    }}\n    {...getTrackProps()}\n  />\n)\n\n/***   tick  ***/\ninterface ITickProps {\n  key: string\n  tick: SliderItem\n  count: number\n  mode?: 'SHOWALL' | 'SHOWNONE' | 'SHOWMINMAX'\n}\n\nexport const Tick: React.FunctionComponent<ITickProps> = ({\n  tick,\n  count,\n  mode = 'SHOWMINMAX',\n}) => (\n  <div>\n    <div\n      className=\"RangeSlider__tick\"\n      style={{\n        left: `${tick.percent}%`,\n      }}\n    />\n    <div\n      className=\"RangeSlider__tickInner\"\n      style={{\n        marginLeft: `${-(100 / count) / 2}%`,\n        width: `${100 / count}%`,\n        left: `${tick.percent}%`,\n      }}\n    >\n      {(mode === 'SHOWALL' ||\n        (mode === 'SHOWMINMAX' &&\n          (tick.percent == 0 || tick.percent == 100))) &&\n        tick.value}\n    </div>\n  </div>\n)\n\n\n/*************  RANGE SLIDER COMPONENT ****************/\n\n\nexport type RangeSliderProps = {\n  domain: string[]\n  initialValues: RangeValues\n  step: number\n  doUpdateOnApply?: boolean\n  maxTickCount?: number\n  onChange: Function\n}\n\nexport type RangeSliderState = {\n  values: readonly number[]\n}\n\nfunction getInitialValues(initialValues: RangeValues, domain: string[]) {\n  const result = [\n    initialValues.min ? Number(initialValues.min) : Number(domain[0]),\n    initialValues.max ? Number(initialValues.max) : Number(domain[1]),\n  ]\n  return result\n}\n\nexport const RangeSlider: React.FunctionComponent<RangeSliderProps> = ({doUpdateOnApply=true, ...props} ) => {\n  const stringArrToNumArr = (inputArr: string[]) =>\n    inputArr.map(value => Number(value))\n\n  const [values, setValues] = useState<number[]>(() =>\n    getInitialValues(props.initialValues, props.domain),\n  )\n\n  const numDomain = stringArrToNumArr(props.domain)\n\n  const handleSliderChange = (\n    values: readonly number[],\n    callbackFn?: Function,\n  ) => {\n    setValues([...values])\n    if (callbackFn) {\n      callbackFn({ min: values[0], max: values[1] })\n    }\n  }\n\n  let ticksCount = numDomain[1] - numDomain[0]\n  if (props.maxTickCount && ticksCount > props.maxTickCount) {\n    ticksCount = props.maxTickCount\n  }\n\n  return (\n    <div className=\"RangeSlider\">\n      <div className=\"RangeSlider__values\">{values[0]} - {values[1]}</div>\n      <div\n        className={`RangeSlider__wrapper${\n          doUpdateOnApply ? '--flex' : '--block'\n        }`}\n      >\n        <Slider\n          mode={1}\n          step={props.step}\n          domain={stringArrToNumArr(props.domain)}\n          className=\"RangeSlider__slider\"\n          onChange={(values: readonly number[]) =>\n            handleSliderChange(\n              values,\n              doUpdateOnApply ? undefined : props.onChange,\n            )\n          }\n          values={getInitialValues(props.initialValues, props.domain)}\n        >\n          <Rail>\n            {({ getRailProps }) => (\n              <div className=\"RangeSlider__rail\" {...getRailProps()} />\n            )}\n          </Rail>\n          <Handles>\n            {({ handles, getHandleProps }) => (\n              <div className=\"slider-handles\">\n                {handles.map(handle => (\n                  <Handle\n                    key={handle.id + handle.percent}\n                    handle={handle}\n                    domain={stringArrToNumArr(props.domain)}\n                    getHandleProps={getHandleProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Handles>\n          <Tracks left={true} right={true}>\n            {({ tracks, getTrackProps }) => (\n              <div>\n                {tracks.map(({ id, source, target }) => (\n                  <Track\n                    key={id}\n                    source={source}\n                    target={target}\n                    getTrackProps={getTrackProps}\n                  />\n                ))}\n              </div>\n            )}\n          </Tracks>\n          <Ticks count={ticksCount}>\n            {({ ticks }) => (\n              <div>\n                {ticks.map(tick => (\n                  <Tick key={tick.id} tick={tick} count={ticks.length} />\n                ))}\n              </div>\n            )}\n          </Ticks>\n        </Slider>\n        {doUpdateOnApply && (\n          <button\n            className=\"RangeSlider__btnApply\"\n            onClick={() =>  props.onChange({ min: values[0], max: values[1] })}\n          >\n            Apply\n          </button>\n        )}\n      </div>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Range, RangeValues } from '../Range'\nimport { RangeSlider } from '../RangeSlider'\nimport { FacetColumnResultRange } from '../../../utils/synapseTypes/Table/FacetColumnResult'\nimport { ColumnModel } from '../../../utils/synapseTypes/Table/ColumnModel'\nimport { VALUE_NOT_SET } from '../../../utils/SynapseConstants'\nimport { FacetFilterHeader } from './FacetFilterHeader'\nimport { RadioGroup } from '../RadioGroup'\nimport { useState } from 'react'\n\nexport enum RadioValuesEnum {\n  NOT_SET = 'org.sagebionetworks.UNDEFINED_NULL_NOTSET',\n  RANGE = 'RANGE',\n  ANY = '',\n}\n\nexport type RangeFacetFilterProps = {\n  facetResult: FacetColumnResultRange\n  columnModel: ColumnModel\n  onChange: Function\n}\n\nexport type RangeFacetFilterState = {\n  facetResult: FacetColumnResultRange\n  columnModel: ColumnModel\n}\n\nexport const RangeFacetFilter: React.FunctionComponent<RangeFacetFilterProps> = ({\n  facetResult,\n  columnModel,\n  onChange,\n}: RangeFacetFilterProps) => {\n  const [isCollapsed, setIsCollapsed] = useState<boolean>(false)\n  const options = [\n    { label: 'Not Set', value: RadioValuesEnum.NOT_SET },\n    { label: 'Any', value: RadioValuesEnum.ANY },\n    { label: 'Range', value: RadioValuesEnum.RANGE },\n  ]\n\n  let { columnMin, columnMax, selectedMin, selectedMax } = facetResult // the upper bound of the selected range\n\n  const hasAnyValue = !selectedMin && !selectedMax\n\n  selectedMin = selectedMin || columnMin\n  selectedMax = selectedMax || columnMax\n\n  const rangeType = columnModel.columnType === 'DOUBLE' ? 'number' : 'date'\n\n  const getRadioValue = (min: string, isAnyValue: boolean) => {\n    if (isAnyValue) {\n      return RadioValuesEnum.ANY\n    } else if (min === VALUE_NOT_SET) {\n      return RadioValuesEnum.NOT_SET\n    }\n    return RadioValuesEnum.RANGE\n  }\n\n  const handleRadioGroupChange = (\n    radioValue: RadioValuesEnum,\n    onChangeCallback: Function,\n  ) => {\n    setRadioValue(radioValue)\n\n    if (radioValue !== RadioValuesEnum.RANGE) {\n      onChangeCallback([radioValue, radioValue])\n    }\n  }\n\n  const [radioValue, setRadioValue] = useState(\n    getRadioValue(selectedMin, hasAnyValue),\n  )\n\n  const result = (\n    <div>\n      <FacetFilterHeader\n        isCollapsed={isCollapsed}\n        label={columnModel.name}\n        onClick={(isCollapsed: boolean) => setIsCollapsed(isCollapsed)}\n      ></FacetFilterHeader>\n\n      <RadioGroup\n        value={radioValue}\n        id=\"rangeSelector\"\n        options={options}\n        onChange={(radioValue: RadioValuesEnum) =>\n          handleRadioGroupChange(radioValue, onChange)\n        }\n      ></RadioGroup>\n      {radioValue === RadioValuesEnum.RANGE &&\n        (columnMin === columnMax ? (\n          <label>{columnMax}</label>\n        ) : (\n          <>\n            {columnModel.columnType === 'INTEGER' && (\n              <RangeSlider\n                key=\"RangeSlider\"\n                domain={[columnMin, columnMax]}\n                initialValues={{ min: selectedMin, max: selectedMax }}\n                step={1}\n                doUpdateOnApply={true}\n                onChange={(values: RangeValues) =>\n                  onChange([values.min, values.max])\n                }\n              >\n                ) >\n              </RangeSlider>\n            )}\n\n            {(columnModel.columnType === 'DATE' ||\n              columnModel.columnType === 'DOUBLE') && (\n              <Range\n                key=\"Range\"\n                initialValues={{\n                  min: selectedMin,\n                  max: selectedMax,\n                }}\n                type={rangeType}\n                onChange={(values: RangeValues) =>\n                  onChange([values.min, values.max])\n                }\n              ></Range>\n            )}\n          </>\n        ))}\n    </div>\n  )\n  return result\n}\n","import * as React from 'react'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\n\nexport type FacetFilterHeaderProps = {\n  label: string\n  isCollapsed: boolean\n  onClick: Function\n}\nexport const FacetFilterHeader: React.FunctionComponent<FacetFilterHeaderProps> = ({\n  label,\n  isCollapsed,\n  onClick,\n}: FacetFilterHeaderProps) => {\n  return (\n    <div className=\"FacetFilterHeader\">\n      <label className=\"FacetFilterHeader__label\">{unCamelCase(label)}</label>\n      <button\n        className=\"FacetFilterHeader__collapseToggleBtn\"\n        onClick={() => onClick(!isCollapsed)}\n      >\n        {isCollapsed ? '+' : '-'}\n      </button>\n    </div>\n  )\n}\n","import * as React from 'react'\n\nexport type RadioGroupProps = {\n  options: { label: string; value: string }[]\n  id: string\n  className?: string\n  value?: string\n  onChange: Function\n}\n\nexport const RadioGroup: React.FunctionComponent<RadioGroupProps> = (\n  props: RadioGroupProps,\n) => {\n\n  const className = props.className\n    ? `radiogroup ${props.className}`\n    : `radiogroup`\n\n  return (\n    <div className={className}>\n      {props.options.map(option => (\n        <div className=\"radio\" key={option.value}>\n          {props.value == option.value}\n          <label>\n            <span>\n              <input\n                type=\"radio\"\n                checked={props.value === option.value}\n                value={option.value}\n                onChange={({ target }: React.ChangeEvent<HTMLInputElement>) =>\n                  props.onChange(target.value, target.checked)\n                }\n              />\n              <span>{option.label}</span>\n            </span>\n          </label>\n        </div>\n      ))}\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { useState, useEffect } from 'react'\nexport type CheckboxProps = {\n  label: string\n  id: string\n  checked?: boolean\n  className?: string\n  onChange: Function\n}\n\nexport const Checkbox: React.FunctionComponent<CheckboxProps> = (\n  props: CheckboxProps,\n) => {\n  const [checked, setChecked] = useState<boolean>(props.checked || false)\n\n  useEffect(() => {\n    setChecked(props.checked || false)\n  }, [props.checked])\n\n  const handleCheckboxChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    setChecked(event.target.checked)\n    props.onChange(event.target.checked)\n  }\n\n  const className = props.className ? `checkbox ${props.className}` : `checkbox`\n\n  return (\n    <div className={className}>\n      <label>\n        <span>\n          <input\n            type=\"checkbox\"\n            checked={checked}\n            id={props.id}\n            onChange={handleCheckboxChange}\n          />\n          <span>{props.label}</span>\n        </span>\n      </label>\n    </div>\n  )\n}\n","import * as React from 'react'\n\nimport {\n  FacetColumnResultValueCount,\n  ColumnModel,\n} from '../../../utils/synapseTypes/Table'\nimport { Checkbox } from '../Checkbox'\nimport { SynapseConstants } from '../../../utils'\nimport { useState } from 'react'\nimport { EntityHeader } from '../../../utils/synapseTypes/EntityHeader'\nimport { UserProfile } from '../../../utils/synapseTypes'\nimport useGetInfoFromIds from '../../../utils/hooks/useGetInfoFromIds'\nimport { FacetFilterHeader} from './FacetFilterHeader'\n\nexport type EnumFacetFilterProps = {\n  facetValues: FacetColumnResultValueCount[]\n  columnModel: ColumnModel\n  token?: string\n  onChange: Function\n  onClear: Function\n}\n\nfunction valueToId(value: string): string {\n  return value.replace(/\\s/g, '').toLowerCase()\n}\n\nfunction valueToLabel(\n  facet: FacetColumnResultValueCount,\n  profiles: UserProfile[] = [],\n  entityHeaders: EntityHeader[] = [],\n): string {\n  const { value } = facet\n  let displayValue = value\n  if (value === SynapseConstants.VALUE_NOT_SET) {\n    displayValue = 'Not Set'\n  }\n  const profile = profiles.find(profile => profile.ownerId === value)\n  if (profile) {\n    displayValue = profile ? profile.userName : `unknown (${value})`\n  }\n\n  const eh = entityHeaders.find(eh => eh.id === value)\n  if (eh) {\n    displayValue = eh ? eh.name : `unknown (${value})`\n  }\n\n  return `${displayValue}`\n}\n\nfunction formatFacetValuesForDisplay(\n  facetValues: FacetColumnResultValueCount[],\n  isShowAll: boolean,\n  visibleItemsCount: number,\n) {\n  //sort facets by count\n  const facets = [...facetValues.sort((a, b) => b.count - a.count)]\n  if (isShowAll || facets.length <= visibleItemsCount) {\n    return facets\n  } else {\n    //if we are not hiding elected facets\n    if (facets.slice(visibleItemsCount).find(item => item.isSelected)) {\n      return facets\n    } else {\n      return facets.splice(0, visibleItemsCount)\n    }\n  }\n}\n\n/************* QUERY ENUM CONMPONENT  *************/\n\nexport const EnumFacetFilter: React.FunctionComponent<EnumFacetFilterProps> = ({\n  token,\n  facetValues,\n  columnModel,\n  onClear,\n  onChange,\n}: EnumFacetFilterProps) => {\n  const [isShowAll, setIsShowAll] = useState<boolean>(false)\n  const [isCollapsed, setIsCollapsed] = useState<boolean>(false)\n  const visibleItemsCount = 5\n\n  const userIds =\n    columnModel.columnType === 'USERID'\n      ? facetValues.map(facet => facet.value)\n      : []\n  const userProfiles = useGetInfoFromIds<UserProfile>({\n    ids: userIds,\n    token,\n    type: 'USER_PROFILE',\n  })\n\n  const entityIds =\n    columnModel.columnType === 'ENTITYID'\n      ? facetValues.map(facet => facet.value)\n      : []\n  const entityHeaders = useGetInfoFromIds<EntityHeader>({\n    ids: entityIds,\n    token,\n    type: 'ENTITY_HEADER',\n  })\n\n  if (!columnModel) {\n    return <></>\n  }\n\n  return (\n    <div className=\"EnumFacetFilter\">\n      <FacetFilterHeader  isCollapsed = {isCollapsed} label={columnModel.name} onClick={(isCollapsed: boolean) => setIsCollapsed(isCollapsed)}></FacetFilterHeader>\n      <div style={{ display: isCollapsed ? 'none' : 'block' }}>\n        <div className=\"EnumFacetFilter__checkboxContainer--forAll\">\n          <Checkbox\n            className=\"EnumFacetFilter__checkbox\"\n            onChange={() => onClear(columnModel.name)}\n            key=\"select_all\"\n            checked={facetValues.filter(item => item.isSelected).length === 0}\n            label=\"All\"\n            id=\"select_all\"\n          ></Checkbox>\n        </div>\n        <div>\n          {formatFacetValuesForDisplay(\n            facetValues,\n            isShowAll,\n            visibleItemsCount,\n          ).map((facet, index: number) => {\n            const id = valueToId(facet.value)\n            return (\n              <div\n                className=\"EnumFacetFilter__checkboxContainer\"\n                key={`checkLabel${index}`}\n              >\n                <Checkbox\n                  className=\"EnumFacetFilter__checkbox\"\n                  onChange={(isChecked: boolean) =>\n                    onChange(facet.value, isChecked)\n                  }\n                  key={id + index}\n                  checked={facet.isSelected}\n                  label={valueToLabel(facet, userProfiles, entityHeaders)}\n                  id={id}\n                ></Checkbox>\n                <div className=\"EnumFacetFilter__count\">{facet.count}</div>\n              </div>\n            )\n          })}\n          {!isShowAll && facetValues.length > visibleItemsCount && (\n            <button\n              className=\"EnumFacetFilter__showMoreFacetsBtn\"\n              onClick={() => setIsShowAll(true)}\n            >\n              <div className=\"EnumFacetFilter__checkboxContainer\">\n                <div className=\"EnumFacetFilter__showMoreFacetsLabel\">\n                  Show more\n                </div>\n                <div className=\"EnumFacetFilter__howMoreFacetsCount\">\n                  {facetValues.length}\n                </div>\n              </div>\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { RangeFacetFilter } from './RangeFacetFilter'\nimport { EnumFacetFilter } from './EnumFacetFilter'\n\nimport {\n  FacetColumnResultValues,\n  FacetColumnResult,\n  FacetColumnResultRange,\n} from '../../../utils/synapseTypes/Table/FacetColumnResult'\nimport {\n  FacetColumnValuesRequest,\n  FacetColumnRangeRequest,\n  FacetColumnRequest,\n} from '../../../utils/synapseTypes/Table/FacetColumnRequest'\nimport {\n  QueryBundleRequest,\n  QueryResultBundle,\n} from '../../../utils/synapseTypes'\n\nexport type QueryFilterProps = {\n  applyChanges: Function\n  isLoading?: boolean\n  data: QueryResultBundle\n  getLastQueryRequest?: Function\n  token: string\n}\n\nconst convertFacetToFacetColumnValuesRequest = (\n  facet: FacetColumnResultValues,\n): FacetColumnValuesRequest => ({\n  concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n  columnName: facet.columnName,\n  facetValues: facet.facetValues\n    .filter(facet => facet.isSelected === true)\n    .map(facet => facet.value),\n})\n\nconst convertFacetColumnRangeRequest = (\n  facet: FacetColumnResultRange,\n): FacetColumnRangeRequest => {\n  let result = {\n    concreteType:\n      'org.sagebionetworks.repo.model.table.FacetColumnRangeRequest',\n    columnName: facet.columnName, // The name of the faceted column\n  }\n\n  if (facet.columnMin) {\n    result = { ...result, ...{ min: facet.columnMin, max: facet.columnMax } }\n  }\n  return result\n}\n\nconst patchRequestFacets = (\n  changedFacet: FacetColumnRequest,\n  lastRequest?: QueryBundleRequest,\n): FacetColumnRequest[] => {\n  const selections = lastRequest ? lastRequest.query.selectedFacets || [] : []\n  const changedFacetIndex = selections.findIndex(\n    facet => facet.columnName === changedFacet.columnName,\n  )\n\n  const isEmptyValuesFacet =\n    changedFacet.concreteType ===\n      'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest' &&\n    (!changedFacet.facetValues || !changedFacet.facetValues.length)\n  if (changedFacetIndex > -1) {\n    if (isEmptyValuesFacet) {\n      selections.splice(changedFacetIndex, 1)\n    } else {\n      selections[changedFacetIndex] = changedFacet\n    }\n  } else {\n    selections.push(changedFacet)\n  }\n  return selections\n}\n\nconst applyChangesToValuesColumn = (\n  lastRequest: QueryBundleRequest | undefined,\n\n  facet: FacetColumnResultValues,\n  onChangeFn: Function,\n  facetName?: string,\n  checked: boolean = false,\n) => {\n  if (facetName) {\n    facet.facetValues.forEach(facetValue => {\n      if (facetValue.value === facetName) {\n        facetValue.isSelected = checked\n      }\n    })\n  } else {\n    // else clear all\n    facet.facetValues.forEach(facet => {\n      facet.isSelected = false\n    })\n  }\n\n  const changedFacet = convertFacetToFacetColumnValuesRequest(facet)\n  const result = patchRequestFacets(changedFacet, lastRequest)\n  onChangeFn(result)\n}\n\n//rangeChanges\nconst applyChangesToRangeColumn = (\n  lastRequest: QueryBundleRequest | undefined,\n  facet: FacetColumnResultRange,\n  onChangeFn: Function,\n  values: string[],\n) => {\n  facet.columnMin = values[0]\n  facet.columnMax = values[1]\n  const changedFacet = convertFacetColumnRangeRequest(facet)\n  const result = patchRequestFacets(changedFacet, lastRequest)\n  onChangeFn(result)\n}\n\nexport const QueryFilter: React.FunctionComponent<QueryFilterProps> = ({\n  data,\n  isLoading = false,\n  getLastQueryRequest,\n  token,\n  applyChanges,\n}: QueryFilterProps): JSX.Element => {\n  const columnModels = data.columnModels\n  const facets = data.facets as FacetColumnResult[]\n  const lastRequest = getLastQueryRequest ? getLastQueryRequest() : undefined\n\n  return (\n    <div className=\"QueryFilter\">\n      {isLoading && <div>Loading...</div>}\n      {!isLoading &&\n        facets.map(facet => {\n          const columnModel = columnModels!.find(\n            model => model.name === facet.columnName,\n          )\n\n          return (\n            <div className=\"QueryFilter__facet\" key={facet.columnName}>\n              {facet.facetType === 'enumeration' && columnModel && (\n                <EnumFacetFilter\n                  facetValues={(facet as FacetColumnResultValues).facetValues}\n                  columnModel={columnModel!}\n                  token={token}\n                  onChange={(facetName: string, checked: boolean) =>\n                    applyChangesToValuesColumn(\n                      lastRequest,\n                      facet as FacetColumnResultValues,\n                      applyChanges,\n                      facetName,\n                      checked,\n                    )\n                  }\n                  onClear={() =>\n                    applyChangesToValuesColumn(\n                      lastRequest,\n\n                      facet as FacetColumnResultValues,\n                      applyChanges,\n                    )\n                  }\n                ></EnumFacetFilter>\n              )}\n              {facet.facetType === 'range' && columnModel && (\n                <RangeFacetFilter\n                  facetResult={facet as FacetColumnResultRange}\n                  columnModel={columnModel}\n                  onChange={(values: string[]) =>\n                    applyChangesToRangeColumn(\n                      lastRequest,\n                      facet as FacetColumnResultRange,\n                      applyChanges,\n                      values,\n                    )\n                  }\n                ></RangeFacetFilter>\n              )}\n            </div>\n          )\n        })}\n    </div>\n  )\n}\n","import { ElementWithTooltip } from '../widgets/ElementWithTooltip'\nimport { IconProp, library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCheck,\n  faColumns,\n  faDownload,\n  faCog,\n  faFilter,\n  faGlobeAmericas,\n  faSort,\n  faSortAmountDown,\n  faSortAmountUp,\n  faTimes,\n  faUsers,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { cloneDeep, noop } from 'lodash-es'\nimport * as React from 'react'\nimport { Dropdown, Modal } from 'react-bootstrap'\nimport { lexer } from 'sql-parser'\nimport { SynapseClient } from '../../utils'\nimport { readFacetValues } from '../../utils/functions/facetUtils'\nimport { getUserProfileWithProfilePicAttached } from '../../utils/functions/getUserData'\nimport {\n  formatSQLFromParser,\n  isGroupByInSql,\n} from '../../utils/functions/sqlFunctions'\nimport { AUTHENTICATED_USERS } from '../../utils/SynapseConstants'\nimport {\n  EntityColumnType,\n  EntityHeader,\n  FacetColumnResult,\n  FacetColumnResultValues,\n  QueryBundleRequest,\n  QueryResultBundle,\n  ReferenceList,\n  Row,\n  SelectColumn,\n  SortItem,\n  UserGroupHeader,\n  UserProfile,\n  FacetColumnRequest,\n} from '../../utils/synapseTypes/'\nimport { getColorPallette } from '../ColorGradient'\nimport { DownloadConfirmation } from '../download_list/DownloadConfirmation'\nimport { EntityLink } from '../EntityLink'\nimport HasAccess from '../HasAccess'\nimport MarkdownSynapse from '../MarkdownSynapse'\nimport ModalDownload from '../ModalDownload'\nimport { FacetSelection, QueryWrapperChildProps } from '../QueryWrapper'\nimport TotalQueryResults from '../TotalQueryResults'\nimport UserCard from '../UserCard'\nimport { unCamelCase } from './../../utils/functions/unCamelCase'\nimport { ICON_STATE, SELECT_ALL } from './SynapseTableConstants'\nimport {\n  ColumnSelection,\n  DownloadOptions,\n  EllipsisDropdown,\n  ExpandTable,\n} from './table-top/'\nimport FacetFilter from './table-top/FacetFilter'\nimport { QueryFilter } from '../widgets/query-filter/QueryFilter'\nimport NoData from '../../assets/icons/file-dotted.svg'\n\nconst EMPTY_HEADER: EntityHeader = {\n  id: '',\n  name: '',\n  type: '',\n  versionNumber: -1,\n  versionLabel: '',\n  benefactorId: -1,\n  createdBy: '',\n  createdOn: '',\n  modifiedBy: '',\n  modifiedOn: '',\n}\n// Add all icons to the library so you can use it in your page\nlibrary.add(faColumns)\nlibrary.add(faSort)\nlibrary.add(faSortAmountUp)\nlibrary.add(faSortAmountDown)\nlibrary.add(faCheck)\nlibrary.add(faTimes)\nlibrary.add(faFilter)\nlibrary.add(faCog)\nlibrary.add(faDownload)\nlibrary.add(faUsers)\nlibrary.add(faGlobeAmericas)\n// Hold constants for next and previous button actions\nconst NEXT = 'NEXT'\nconst PREVIOUS = 'PREVIOUS'\n\ntype Direction = '' | 'ASC' | 'DESC'\nexport const SORT_STATE: Direction[] = ['', 'DESC', 'ASC']\nexport const DOWNLOAD_OPTIONS_CONTAINER_CLASS = 'SRC-download-options-container'\ntype Info = {\n  index: number\n  name: string\n}\nexport interface Dictionary<T> {\n  [key: string]: T\n}\nexport type SynapseTableState = {\n  sortedColumnSelection: SortItem[]\n  isColumnSelected: boolean[]\n  columnIconSortState: number[]\n  isModalDownloadOpen: boolean\n  isDownloadConfirmationOpen: boolean\n  isExpanded: boolean\n  isFileView: boolean\n  mapEntityIdToHeader: Dictionary<EntityHeader>\n  mapUserIdToHeader: Dictionary<Partial<UserGroupHeader & UserProfile>>\n  showColumnSelection: boolean\n  isShowLeftFilter?: boolean\n  isUserModifiedQuery?: boolean //flag to signal that the selection criterial has been defined by user and if no records are returned do not hide the table\n}\nexport type SynapseTableProps = {\n  visibleColumnCount?: number\n  title: string\n  loadingScreen?: JSX.Element\n  showAccessColumn?: boolean\n  markdownColumns?: string[] // array of column names which should render as markdown\n  enableDownloadConfirmation?: boolean\n  enableLeftFacetFilter?: boolean\n}\n\nexport default class SynapseTable extends React.Component<\n  QueryWrapperChildProps & SynapseTableProps,\n  SynapseTableState\n> {\n  constructor(props: QueryWrapperChildProps & SynapseTableProps) {\n    super(props)\n    this.handleColumnSortPress = this.handleColumnSortPress.bind(this)\n    this.handlePaginationClick = this.handlePaginationClick.bind(this)\n    this.findSelectionIndex = this.findSelectionIndex.bind(this)\n    this.toggleColumnSelection = this.toggleColumnSelection.bind(this)\n    this.onToggleColumnSelectionShow = this.onToggleColumnSelectionShow.bind(\n      this,\n    )\n    this.advancedSearch = this.advancedSearch.bind(this)\n    this.getLengthOfPropsData = this.getLengthOfPropsData.bind(this)\n    this.configureFacetDropdown = this.configureFacetDropdown.bind(this)\n    this.applyChanges = this.applyChanges.bind(this)\n    // store the offset and sorted selection that is currently held\n    this.state = {\n      /* columnIconSortState tells what icon to display for a table\n         header. There are three states for a particular header-\n          0 - show descending icon but *deselected*\n          1 - show descending icon selected\n          2 - show ascending icon selected\n      */\n      columnIconSortState: [],\n      isColumnSelected: [],\n      isModalDownloadOpen: false,\n      isDownloadConfirmationOpen: false,\n      isExpanded: false,\n      showColumnSelection: false,\n      isShowLeftFilter: this.props.enableLeftFacetFilter,\n      isFileView: false,\n      // sortedColumnSelection contains the columns which are\n      // selected currently and their sort status as eithet\n      // off, desc, or asc.\n      sortedColumnSelection: [],\n      mapEntityIdToHeader: {},\n      mapUserIdToHeader: {},\n    }\n    this.getEntityHeadersInData = this.getEntityHeadersInData.bind(this)\n    this.getColumnIndiciesWithType = this.getColumnIndiciesWithType.bind(this)\n  }\n\n  componentDidMount() {\n    this.getEntityHeadersInData()\n  }\n\n  componentDidUpdate(prevProps: QueryWrapperChildProps & SynapseTableProps) {\n    this.getEntityHeadersInData()\n    this.getTableConcreteType(prevProps)\n  }\n\n  public async getTableConcreteType(\n    prevProps: QueryWrapperChildProps & SynapseTableProps,\n  ) {\n    const { data, token } = this.props\n    if (!data) {\n      return\n    }\n    const currentTableId = data?.queryResult.queryResults.tableId\n    const previousTableId = prevProps.data?.queryResult.queryResults.tableId\n    if (currentTableId && previousTableId !== currentTableId) {\n      const entityData = await SynapseClient.getEntity(token, currentTableId)\n      this.setState({\n        isFileView: entityData.concreteType.includes('EntityView'),\n      })\n    }\n  }\n\n  public async getEntityHeadersInData() {\n    const { data, token } = this.props\n    if (!data) {\n      return\n    }\n    const mapEntityIdToHeader = cloneDeep(this.state.mapEntityIdToHeader)\n    const mapUserIdToHeader = cloneDeep(this.state.mapUserIdToHeader)\n    const entityIdColumnIndicies = this.getColumnIndiciesWithType('ENTITYID')\n    const userIdColumnIndicies = this.getColumnIndiciesWithType('USERID')\n    const distinctEntityIds = this.getUniqueEntities(\n      data,\n      mapEntityIdToHeader,\n      entityIdColumnIndicies,\n    )\n    const distinctUserIds = this.getUniqueEntities(\n      data,\n      mapUserIdToHeader,\n      userIdColumnIndicies,\n    )\n    // Make call to resolve entity ids\n    if (distinctEntityIds.size > 0) {\n      const referenceList: ReferenceList = Array.from(distinctEntityIds).map(\n        id => {\n          return { targetId: id }\n        },\n      )\n      try {\n        // initialize mapEntityIdToHeader\n        referenceList.forEach(el => {\n          mapEntityIdToHeader[el.targetId] = EMPTY_HEADER\n        })\n        const data = await SynapseClient.getEntityHeader(referenceList, token)\n        const { results } = data\n        results.forEach(el => {\n          mapEntityIdToHeader[el.id] = el\n        })\n      } catch (err) {\n        console.error('Error on retrieving entity header list , ', err)\n      }\n    }\n    if (distinctUserIds.size === 0) {\n      if (distinctEntityIds.size > 0) {\n        this.setState({ mapEntityIdToHeader })\n      }\n      return\n    }\n    // Make call to get group headers and user profiles\n    const ids = Array.from(distinctUserIds)\n    const userPorfileIds: string[] = []\n    // TODO: Grab Team Badge\n    try {\n      const data = await SynapseClient.getGroupHeadersBatch(ids, token)\n      data.children.forEach(el => {\n        if (el.isIndividual) {\n          userPorfileIds.push(el.ownerId)\n        } else {\n          mapUserIdToHeader[el.ownerId] = el\n        }\n      })\n    } catch (err) {\n      console.error('Error on getGroupHeaders batch: ', err)\n    }\n    if (userPorfileIds.length > 0) {\n      try {\n        const data = await getUserProfileWithProfilePicAttached(\n          userPorfileIds,\n          token,\n        )\n        data.list.forEach((el: UserProfile) => {\n          mapUserIdToHeader[el.ownerId] = el\n        })\n      } catch (err) {\n        console.error('Error on getUserProfile : ', err)\n      }\n    }\n    if (distinctEntityIds.size > 0 || distinctUserIds.size > 0) {\n      this.setState({\n        mapEntityIdToHeader,\n        mapUserIdToHeader,\n      })\n    }\n  }\n\n  public getUniqueEntities(\n    data: QueryResultBundle,\n    mapIdToHeader: {},\n    indicies: number[],\n  ) {\n    const distinctEntities = new Set<string>()\n    data!.queryResult.queryResults.rows.forEach(row => {\n      row.values.forEach((el: any, colIndex: number) => {\n        // make sure this is a column of type entity and that we haven't retrieved this entity's information prior\n        if (\n          indicies.includes(colIndex) &&\n          !Object.prototype.hasOwnProperty.call(mapIdToHeader, el) &&\n          el\n        ) {\n          distinctEntities.add(el)\n        }\n      })\n    })\n    return distinctEntities\n  }\n\n  public getColumnIndiciesWithType(...columnTypes: EntityColumnType[]) {\n    const { data } = this.props\n    const columnsOfTypeEntity: number[] = []\n    data &&\n      data.selectColumns &&\n      data.selectColumns.forEach((el, index) => {\n        if (columnTypes.includes(el.columnType)) {\n          columnsOfTypeEntity.push(index)\n        }\n      })\n    return columnsOfTypeEntity\n  }\n\n  /**\n   * Display the view\n   */\n  public render() {\n    if (this.props.data === undefined) {\n      return this.props.loadingScreen || <div />\n    }\n    // unpack all the data\n    const {\n      data,\n      isLoading = true,\n      unitDescription,\n      token,\n      showBarChart,\n    } = this.props\n    const { queryResult } = data\n    const { queryResults } = queryResult\n    const { rows } = queryResults\n    const { headers } = queryResults\n    const { facets = [] } = data\n    const { isModalDownloadOpen, isExpanded } = this.state\n    const queryRequest = this.props.getLastQueryRequest!()\n    const { sql, selectedFacets } = queryRequest.query\n\n    let className = 'SRC-marginTopMinusTen'\n    if (showBarChart) {\n      className = 'SRC-marginBottomTop'\n    }\n    const hasResults = data.queryResult.queryResults.rows.length > 0\n    if (!hasResults && !this.state.isUserModifiedQuery) {\n      return (\n        <div className=\"text-center SRCBorderedPanel SRCBorderedPanel--padded2x\">\n          <img src={NoData} alt=\"no data\"></img>\n          <div style={{ marginTop: '20px', fontStyle: 'italic' }}>\n            This table is currently empty\n          </div>\n        </div>\n      )\n    }\n    const content = (\n      <>\n        <div className={className}>\n          <div\n            className={`SRC-centerContent text-left`}\n            style={{ height: '20px' }}\n          >\n            {unitDescription && !isGroupByInSql(queryRequest.query.sql) && (\n              <TotalQueryResults\n                isLoading={isLoading}\n                style={{ fontSize: 15 }}\n                unitDescription={unitDescription}\n                getLastQueryRequest={this.props.getLastQueryRequest}\n                token={token}\n                frontText={'Showing'}\n              />\n            )}\n          </div>\n          {this.renderTableTop(headers, this.props.enableLeftFacetFilter)}\n          <div className=\"row \">\n            {this.state.isShowLeftFilter && (\n              <div\n                className=\"col-xs-12 col-sm-3 col-lg-3\"\n                style={{ paddingRight: '0px' }}\n              >\n                {\n                  <QueryFilter\n                    {...this.props}\n                    data={this.props.data!}\n                    token={this.props.token!}\n                    applyChanges={(newFacets: FacetColumnRequest[]) =>\n                      this.applyChangesFromQueryFilter(newFacets)\n                    }\n                  />\n                }\n              </div>\n            )}\n            <div\n              className={`${\n                this.state.isShowLeftFilter\n                  ? 'col-xs-12 col-sm-9 col-lg-9'\n                  : 'col-xs-12'\n              }`}\n            >\n              {this.renderTable(headers, facets, rows)}\n            </div>\n          </div>\n        </div>\n      </>\n    )\n    return (\n      <React.Fragment>\n        {// modal can render anywhere, this is not a particular location\n        isModalDownloadOpen && (\n          <ModalDownload\n            onClose={() => this.setState({ isModalDownloadOpen: false })}\n            sql={sql}\n            selectedFacets={selectedFacets}\n            token={token}\n            entityId={queryRequest.entityId}\n          />\n        )}\n        {isExpanded && (\n          <Modal\n            animation={false}\n            centered={true}\n            show={true}\n            // @ts-ignore\n            onHide={() => this.setState({ isExpanded: false })}\n            dialogClassName={'modal-90w'}\n          >\n            <Modal.Header\n              // @ts-ignore\n              onHide={() => this.setState({ isExpanded: false })}\n              closeButton={true}\n            ></Modal.Header>\n            <Modal.Body>{content}</Modal.Body>\n          </Modal>\n        )}\n        {!isExpanded && content}\n      </React.Fragment>\n    )\n  }\n\n  private showGroupRowData = (selectedRow: Row) => {\n    // magic happens - parse query, deep copy query bundle request, modify, encode, send to Synapse.org.  Easy!\n    const queryCopy = this.props.getLastQueryRequest!().query\n    const parsed = this.getSqlUnderlyingDataForRow(selectedRow, queryCopy.sql)\n    queryCopy.sql = parsed.newSql\n    const queryJSON = JSON.stringify(queryCopy)\n    // encode this copy of the query (json)\n    const encodedQuery = btoa(queryJSON)\n    return `https://www.synapse.org/#!Synapse:${parsed.synId}/tables/query/${encodedQuery}`\n  }\n\n  private renderDropdownDownloadOptions = (isFileView?: boolean) => {\n    const partialState = {\n      isModalDownloadOpen: true,\n      isExpanded: false,\n    }\n    return (\n      <DownloadOptions\n        onDownloadFiles={(e: React.SyntheticEvent) => this.showDownload(e)}\n        onExportMetadata={() => this.setState(partialState)}\n        isUnauthenticated={!this.props.token}\n        isFileView={isFileView}\n      />\n    )\n  }\n\n  /* \n    The ColumnSelection dropdown state is held in SynapseTable because the EllipsisDropdown has\n    an option to open the dropdown, 'show columns'\n  */\n  public onToggleColumnSelectionShow(\n    _show: boolean,\n    _event: React.SyntheticEvent<Dropdown<'div'>, Event>,\n    metadata: any,\n  ) {\n    // Any click event for the Dropdown will close the dropdown (assuming its open), so we have\n    // to handle the onToggle event and manually manage the dropdown open state. If metadata\n    // is defined the event occuring is inside the dropdown which we then want to keep open, otherwise\n    // we close it.\n    if (metadata.source) {\n      this.setState({\n        showColumnSelection: true,\n      })\n    } else {\n      this.setState({\n        showColumnSelection: false,\n      })\n    }\n  }\n\n  private renderColumnSelection = (headers: SelectColumn[]) => {\n    return (\n      <ColumnSelection\n        headers={headers}\n        isColumnSelected={this.state.isColumnSelected}\n        visibleColumnCount={this.props.visibleColumnCount}\n        show={this.state.showColumnSelection}\n        toggleColumnSelection={this.toggleColumnSelection}\n        onToggle={this.onToggleColumnSelectionShow}\n      />\n    )\n  }\n\n  private renderTable = (\n    headers: SelectColumn[],\n    facets: FacetColumnResult[],\n    rows: Row[],\n  ) => {\n    const lastQueryRequest = this.props.getLastQueryRequest!()\n    // handle displaying the previous button -- if offset is zero then it\n    // shouldn't be displayed\n    const pastZero: boolean = lastQueryRequest.query.offset! > 0\n    const { hasMoreData, showAccessColumn, token } = this.props\n\n    const zeroMarginRight: React.CSSProperties = {\n      marginRight: 0,\n    }\n    const nextBtn = (\n      <button\n        onClick={this.handlePaginationClick(NEXT)}\n        className=\"SRC-light-button SRC-standard-button-shape\"\n        style={zeroMarginRight}\n        type=\"button\"\n      >\n        Next\n      </button>\n    )\n    const previousBtn = (\n      <button\n        onClick={this.handlePaginationClick(PREVIOUS)}\n        className=\"SRC-light-button SRC-standard-button-shape\"\n        type=\"button\"\n        style={!hasMoreData && pastZero ? zeroMarginRight : undefined}\n      >\n        Previous\n      </button>\n    )\n\n    let isShowingAccessColumn: boolean | undefined = showAccessColumn\n    if (showAccessColumn && rows.length > 0) {\n      // PORTALS-924: verify that row actualy contains a defined rowId\n      isShowingAccessColumn = rows[0].rowId !== undefined\n    }\n    /* min height ensure if no rows are selected that a dropdown menu is still accessible */\n    return (\n      <div style={{ minHeight: '300px' }} className=\"SRC-overflowAuto\">\n        {this.state.isDownloadConfirmationOpen && (\n          <DownloadConfirmation\n            token={token!}\n            queryBundleRequest={this.props.getLastQueryRequest!()}\n            fnClose={() => this.setState({ isDownloadConfirmationOpen: false })}\n          />\n        )}\n        <table className=\"table table-striped table-condensed\">\n          <thead className=\"SRC_bordered\">\n            <tr>\n              {this.createTableHeader(headers, facets, isShowingAccessColumn)}\n            </tr>\n          </thead>\n          <tbody>\n            {this.createTableRows(rows, headers, isShowingAccessColumn)}\n          </tbody>\n        </table>\n        <div style={{ textAlign: 'right' }}>\n          {pastZero && previousBtn}\n          {hasMoreData && nextBtn}\n        </div>\n      </div>\n    )\n  }\n\n  private renderTableTop = (\n    headers: SelectColumn[],\n    enableLeftFacetFilter?: boolean,\n  ) => {\n    const { title } = this.props\n    const { isExpanded, isFileView } = this.state\n    const { colorPalette } = getColorPallette(this.props.rgbIndex!, 1)\n    const background = colorPalette[0]\n    const onDownloadTableOnlyArguments = {\n      isExpanded: false,\n      isModalDownloadOpen: true,\n    }\n    const onExpandArguments = {\n      isExpanded: !isExpanded,\n    }\n    const queryRequest = this.props.getLastQueryRequest!()\n    return (\n      <div\n        className={`SRC-centerContent${\n          this.state.isShowLeftFilter ? ' SRC-marginBottomTen' : ''\n        }`}\n        style={{ background, padding: 8 }}\n      >\n        <h3 className=\"SRC-tableHeader\"> {title}</h3>\n        <span className=\"SRC-inlineFlex\" style={{ marginLeft: 'auto' }}>\n          {!isGroupByInSql(queryRequest.query.sql) && (\n            <>\n              {!enableLeftFacetFilter /* without filter flag*/ && (\n                <ElementWithTooltip\n                  idForToolTip={'advancedSearch'}\n                  image={faFilter}\n                  callbackFn={this.advancedSearch}\n                  tooltipText={'Open Advanced Search in Synapse'}\n                />\n              )}\n              {enableLeftFacetFilter && (\n                <>\n                  <ElementWithTooltip\n                    idForToolTip={'advancedSearch'}\n                    image={faCog}\n                    callbackFn={this.advancedSearch}\n                    tooltipText={'Open Advanced Search in Synapse'}\n                  />\n                  <ElementWithTooltip\n                    idForToolTip={'filter'}\n                    image={faFilter}\n                    callbackFn={() =>\n                      this.setState({\n                        isShowLeftFilter: !this.state.isShowLeftFilter,\n                      })\n                    }\n                    tooltipText={'Toggle Search Panel'}\n                  />\n                </>\n              )}\n              {this.renderDropdownDownloadOptions(isFileView)}\n              {this.renderColumnSelection(headers)}\n            </>\n          )}\n          <ExpandTable\n            isExpanded={isExpanded}\n            onExpand={() => this.setState(onExpandArguments)}\n          />\n        </span>\n        <EllipsisDropdown\n          onDownloadFiles={(e: React.SyntheticEvent) => this.showDownload(e)}\n          onDownloadTableOnly={() =>\n            this.setState(onDownloadTableOnlyArguments)\n          }\n          onShowColumns={() => this.setState({ showColumnSelection: true })}\n          onFullScreen={() => this.setState(onExpandArguments)}\n          isExpanded={isExpanded}\n          isUnauthenticated={!this.props.token}\n          isGroupedQuery={isGroupByInSql(queryRequest.query.sql)}\n          isFileView={this.state.isFileView}\n        />\n      </div>\n    )\n  }\n\n  /**\n   * Return the select column indexes for columns that use the aggregate count function.\n   * If sql does not have a GROUP BY, this returns an empty array.\n   * @param originalSql\n   */\n  public getCountFunctionColumnIndexes(originalSql: string): number[] {\n    const indexes: number[] = []\n    if (isGroupByInSql(originalSql)) {\n      const tokens: string[][] = lexer.tokenize(originalSql)\n      const selectIndex = tokens.findIndex(el => el[0] === 'SELECT')\n      const fromIndex = tokens.findIndex(el => el[0] === 'FROM')\n      let columnIndex = 0\n      for (\n        let index = selectIndex + 1;\n        index < fromIndex - selectIndex - 1;\n        index += 1\n      ) {\n        const token = tokens[index]\n        if (token[0] === 'FUNCTION' && token[1].toLowerCase() === 'count') {\n          // found a count column!\n          indexes.push(columnIndex)\n        } else if (token[0] === 'SEPARATOR') {\n          // next column\n          columnIndex += 1\n        }\n      }\n    }\n    return indexes\n  }\n\n  public getSqlUnderlyingDataForRow(\n    selectedRow: Row,\n    originalSql: string,\n  ): { synId: string; newSql: string } {\n    let tokens: string[][] = lexer.tokenize(originalSql)\n    const selectIndex = tokens.findIndex(el => el[0] === 'SELECT')\n    const fromIndex = tokens.findIndex(el => el[0] === 'FROM')\n\n    // gather all of the column names literals between select and from (and their indices)\n    const columnReferences: ColumnReference[] = []\n    let columnIndex = 0\n    let foundFunctionForColumn = false\n    for (\n      let index = selectIndex + 1;\n      index < fromIndex - selectIndex - 1;\n      index += 1\n    ) {\n      const token = tokens[index]\n      // parsing error.  concat function is reported as a LITERAL instead of a function\n      if (\n        token[0] === 'FUNCTION' ||\n        token[1].toLocaleLowerCase() === 'concat'\n      ) {\n        foundFunctionForColumn = true\n      } else if (token[0] === 'LITERAL' && !foundFunctionForColumn) {\n        // found a column\n        columnReferences.push({ index: columnIndex, name: token[1] })\n      } else if (token[0] === 'SEPARATOR') {\n        // next column\n        columnIndex += 1\n        // reset \"found function\"\n        foundFunctionForColumn = false\n      }\n    }\n\n    // remove all tokens after (and including) group\n    tokens = tokens.slice(\n      0,\n      tokens.findIndex(el => el[0] === 'GROUP'),\n    )\n    // replace all columns with *\n    tokens.splice(selectIndex + 1, fromIndex - selectIndex - 1, [\n      'STAR',\n      '*',\n      '1',\n    ])\n    // add new items to where clause, but only if the column name corresponds to a real column in the table/view!\n    // use row.values\n    if (this.props.data === undefined) {\n      return { synId: '', newSql: '' }\n    }\n    const whereIndex = tokens.findIndex(el => el[0] === 'WHERE')\n    if (whereIndex === -1) {\n      // does not contain a where clause\n      tokens.push(['WHERE', 'WHERE', '1'])\n    } else {\n      // alreay contains a where clause, add the first AND\n      tokens.push(['CONDITIONAL', 'AND', '1'])\n    }\n\n    // look for headers in column models, if they match then add a where clause\n    columnReferences.forEach((value: ColumnReference, index: number) => {\n      const rowValue = selectedRow.values[value.index]\n      // PORTALS-712: support null values\n      if (rowValue) {\n        tokens.push(\n          ['LITERAL', value.name, '1'],\n          ['OPERATOR', '=', '1'],\n          ['STRING', rowValue, '1'],\n          ['CONDITIONAL', 'AND', '1'],\n        )\n      } else {\n        tokens.push(\n          ['LITERAL', value.name, '1'],\n          ['OPERATOR', 'IS', '1'],\n          ['BOOLEAN', 'null', '1'],\n          ['CONDITIONAL', 'AND', '1'],\n        )\n      }\n    })\n    // remove the last AND\n    tokens.pop()\n    // remove backtick from output sql (for table name): `syn1234` becomes syn1234\n    const synId = tokens[tokens.findIndex(el => el[0] === 'FROM') + 1][1]\n    tokens.push(['EOF', '', '1'])\n    return { synId, newSql: formatSQLFromParser(tokens) }\n  }\n\n  /**\n   * Handle a click on next or previous\n   *\n   * @memberof SynapseTable\n   */\n  private handlePaginationClick = (eventType: string) => (\n    _event: React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    const queryRequest = this.props.getLastQueryRequest!()\n    let currentOffset = queryRequest.query.offset!\n    // if its a \"previous\" click subtract from the offset\n    // otherwise its next and we paginate forward\n    if (eventType === PREVIOUS) {\n      currentOffset -= 25\n    }\n    if (eventType === NEXT) {\n      currentOffset += 25\n    }\n    queryRequest.query.offset = currentOffset\n    this.props.executeQueryRequest!(queryRequest)\n  }\n  /**\n   * Handle a column having been selected\n   *\n   * @memberof SynapseTable\n   */\n  public handleColumnSortPress = (dict: Info) => (_: React.SyntheticEvent) => {\n    // by using Synthetic event we can use the handler on both key press and mouse click\n    let columnIconSortState = cloneDeep(this.state.columnIconSortState)\n    if (columnIconSortState.length === 0) {\n      columnIconSortState = Array(this.getLengthOfPropsData()).fill(0)\n    }\n    // get currently sorted items and remove/insert/update this selection\n    const sortedColumnSelection = cloneDeep(this.state.sortedColumnSelection)\n    const index = this.findSelectionIndex(sortedColumnSelection, dict.name)\n    // if its present then remove it\n    if (index !== -1) {\n      sortedColumnSelection.splice(index, 1)\n    }\n    columnIconSortState[dict.index] =\n      (columnIconSortState[dict.index] + 1) % ICON_STATE.length\n    if (columnIconSortState[dict.index] > 0) {\n      sortedColumnSelection.unshift({\n        column: dict.name,\n        direction: SORT_STATE[columnIconSortState[dict.index]],\n      })\n    }\n    const queryRequest = this.props.getLastQueryRequest!()\n    queryRequest.query.sort = sortedColumnSelection\n    this.props.executeQueryRequest!(queryRequest)\n    this.setState({\n      columnIconSortState,\n      sortedColumnSelection,\n    })\n  }\n\n  private createTableRows(\n    rows: Row[],\n    headers: SelectColumn[],\n    isShowingAccessColumn: boolean | undefined,\n  ) {\n    const rowsFormatted: JSX.Element[] = []\n    const { token } = this.props\n    const {\n      isColumnSelected,\n      mapEntityIdToHeader,\n      mapUserIdToHeader,\n    } = this.state\n    const entityColumnIndicies = this.getColumnIndiciesWithType('ENTITYID')\n    const userColumnIndicies = this.getColumnIndiciesWithType('USERID')\n    const dateColumnIndicies = this.getColumnIndiciesWithType('DATE')\n    const dateListColumnIndicies = this.getColumnIndiciesWithType('DATE_LIST')\n    const booleanListColumnIndicies = this.getColumnIndiciesWithType(\n      'BOOLEAN_LIST',\n    )\n    const otherListColumnIndicies = this.getColumnIndiciesWithType(\n      'STRING_LIST',\n      'INTEGER_LIST',\n    )\n    const isColumnSelectedLen = isColumnSelected.length\n    // find column indices that are COUNT type\n    const countColumnIndexes = this.getCountFunctionColumnIndexes(\n      this.props.getLastQueryRequest!().query.sql,\n    )\n    const { visibleColumnCount = Infinity, markdownColumns = [] } = this.props\n    rows.forEach((row, rowIndex) => {\n      const rowContent = row.values.map(\n        (columnValue: string, colIndex: number) => {\n          const columnName = headers[colIndex].name\n          const isMarkdownColumn = markdownColumns.includes(columnName)\n          const index = this.findSelectionIndex(\n            this.state.sortedColumnSelection,\n            columnName,\n          )\n          const usedVisibleColumnCount = isGroupByInSql(\n            this.props.getLastQueryRequest!().query.sql,\n          )\n            ? Infinity\n            : visibleColumnCount\n          // on iniital load isColumnSelected is null and we by default show all columns that come\n          // before visibileColumnCount\n          const isColumnActiveInitLoad: boolean =\n            colIndex < usedVisibleColumnCount && isColumnSelectedLen === 0\n          // past the initial load -- when a user has started clicking items, then isColumnSelected is\n          // not null and we verify that this column is part of the selection.\n          const isColumnActivePastInitLoad =\n            isColumnSelectedLen !== 0 && this.state.isColumnSelected[colIndex]\n          const isCountColumn = countColumnIndexes.includes(colIndex)\n          const isBold = index === -1 ? '' : 'SRC-boldText'\n          if (isColumnActiveInitLoad || isColumnActivePastInitLoad) {\n            return (\n              <td\n                className=\"SRC_noBorderTop\"\n                key={`(${rowIndex}${columnValue}${colIndex})`}\n              >\n                {isCountColumn && (\n                  <a\n                    href={this.showGroupRowData(row)}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    <p className={isBold}>{columnValue}</p>\n                  </a>\n                )}\n                {!isCountColumn &&\n                  this.renderTableCell({\n                    entityColumnIndicies,\n                    userColumnIndicies,\n                    dateColumnIndicies,\n                    dateListColumnIndicies,\n                    booleanListColumnIndicies,\n                    otherListColumnIndicies,\n                    colIndex,\n                    columnValue,\n                    isBold,\n                    mapEntityIdToHeader,\n                    mapUserIdToHeader,\n                    isMarkdownColumn,\n                    rowIndex,\n                  })}\n              </td>\n            )\n          }\n          return <td className=\"SRC-hidden\" key={`(${rowIndex},${colIndex})`} />\n        },\n      )\n      // also push the access column value if we are showing user access for individual items (still shown if not logged in)\n      if (isShowingAccessColumn) {\n        const rowSynapseId = `syn${row.rowId}`\n        rowContent.push(\n          <td key={`(${rowIndex},accessColumn)`} className=\"SRC_noBorderTop\">\n            <HasAccess\n              entityId={rowSynapseId}\n              entityVersionNumber={row.versionNumber?.toString()}\n              token={token}\n            ></HasAccess>\n          </td>,\n        )\n      }\n\n      const rowFormatted = <tr key={row.rowId}>{rowContent}</tr>\n      rowsFormatted.push(rowFormatted)\n    })\n    return rowsFormatted\n  }\n\n  // Render table cell, supports Entity's and User Icons\n  public renderTableCell({\n    entityColumnIndicies,\n    userColumnIndicies,\n    dateColumnIndicies,\n    dateListColumnIndicies,\n    booleanListColumnIndicies,\n    otherListColumnIndicies,\n    colIndex,\n    columnValue,\n    isBold,\n    mapEntityIdToHeader,\n    mapUserIdToHeader,\n    isMarkdownColumn,\n    rowIndex,\n  }: {\n    entityColumnIndicies: number[]\n    userColumnIndicies: number[]\n    dateColumnIndicies: number[]\n    dateListColumnIndicies: number[]\n    booleanListColumnIndicies: number[]\n    otherListColumnIndicies: number[]\n    colIndex: number\n    columnValue: string\n    isBold: string\n    mapEntityIdToHeader: Dictionary<EntityHeader>\n    mapUserIdToHeader: Dictionary<any>\n    isMarkdownColumn: boolean\n    rowIndex?: number\n  }): React.ReactNode {\n    const getShortString = (\n      longString: string,\n      maxCharCount = 20,\n    ): [string, boolean] => {\n      if (!longString || longString.length <= maxCharCount) {\n        return [longString, false]\n      } else {\n        return [longString.substr(0, maxCharCount), true]\n      }\n    }\n    if (!columnValue) {\n      return <></>\n    }\n    if (isMarkdownColumn) {\n      return <MarkdownSynapse renderInline={true} markdown={columnValue} />\n    }\n    if (\n      entityColumnIndicies.includes(colIndex) &&\n      Object.prototype.hasOwnProperty.call(mapEntityIdToHeader, columnValue)\n    ) {\n      return (\n        <EntityLink\n          entityHeader={mapEntityIdToHeader[columnValue]}\n          className={isBold}\n        />\n      )\n    }\n    if (dateListColumnIndicies.includes(colIndex)) {\n      const jsonData: number[] = JSON.parse(columnValue)\n      return jsonData.map((val: number, index: number) => {\n        return (\n          <span className={isBold}>\n            {new Date(val).toLocaleString()}\n            {index !== jsonData.length - 1 ? ', ' : ''}\n          </span>\n        )\n      })\n    }\n    if (booleanListColumnIndicies.includes(colIndex)) {\n      const jsonData: boolean[] = JSON.parse(columnValue)\n      return jsonData.map((val: boolean, index: number) => {\n        return (\n          <span className={isBold}>\n            {val ? 'true' : 'false'}\n            {index !== jsonData.length - 1 ? ', ' : ''}\n          </span>\n        )\n      })\n    }\n    if (otherListColumnIndicies.includes(colIndex)) {\n      const jsonData: string[] = JSON.parse(columnValue)\n      return jsonData.map((val: string, index: number) => {\n        return (\n          <span className={isBold}>\n            {val}\n            {index !== jsonData.length - 1 ? ', ' : ''}\n          </span>\n        )\n      })\n    }\n    if (dateColumnIndicies.includes(colIndex)) {\n      return (\n        <p className={isBold}>\n          {new Date(Number(columnValue)).toLocaleString()}\n        </p>\n      )\n    } else if (\n      userColumnIndicies.includes(colIndex) &&\n      Object.prototype.hasOwnProperty.call(mapUserIdToHeader, columnValue)\n    ) {\n      const { ownerId, userName } = mapUserIdToHeader[columnValue]\n      if (mapUserIdToHeader[columnValue].isIndividual === false) {\n        // isUserGroupHeader\n        const icon =\n          userName === AUTHENTICATED_USERS ? 'globe-americas' : 'users'\n        if (userName === AUTHENTICATED_USERS) {\n          return (\n            <span>\n              <FontAwesomeIcon icon={icon} /> All registered Synapse users\n            </span>\n          )\n        }\n        return (\n          <a\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            href={`https://www.synapse.org/#!Team:${ownerId}`}\n          >\n            <FontAwesomeIcon icon={icon} /> {userName}\n          </a>\n        )\n      } else {\n        // isUserCard\n        return (\n          <UserCard\n            userProfile={mapUserIdToHeader[columnValue]}\n            preSignedURL={mapUserIdToHeader[columnValue].clientPreSignedURL}\n            size={'SMALL USER CARD'}\n          />\n        )\n      }\n    } else {\n      const [displayString, isShortened] = getShortString(columnValue)\n      if (!isShortened) {\n        return <p className={isBold}> {columnValue}</p>\n      } else {\n        return (\n          <p className={isBold}>\n            <ElementWithTooltip\n              tooltipText={columnValue}\n              callbackFn={noop}\n              idForToolTip={`${colIndex}_${rowIndex}`}\n            >\n              <p className={isBold}> {displayString}...</p>\n            </ElementWithTooltip>\n          </p>\n        )\n      }\n    }\n  }\n\n  private createTableHeader(\n    headers: SelectColumn[],\n    facets: FacetColumnResult[],\n    isShowingAccessColumn: boolean | undefined,\n  ) {\n    const {\n      isColumnSelected,\n      sortedColumnSelection,\n      columnIconSortState,\n    } = this.state\n    const { visibleColumnCount = Infinity, facetAliases = {} } = this.props\n    const usedVisibleColumnCount = isGroupByInSql(\n      this.props.getLastQueryRequest!().query.sql,\n    )\n      ? Infinity\n      : visibleColumnCount\n    const tableColumnHeaderElements: JSX.Element[] = headers.map(\n      (column: SelectColumn, index: number) => {\n        // two cases when rendering the column headers on init load\n        // of the page we have to show only this.props.visibleColumnCount many\n        // columns, afterwards we rely on the isColumnSelected to get choices\n        const initRender: boolean =\n          index < usedVisibleColumnCount && isColumnSelected.length === 0\n        const subsequentRender =\n          isColumnSelected[index] && isColumnSelected.length !== 0\n        if (initRender || subsequentRender) {\n          // for background color\n          const isSelected: boolean =\n            this.findSelectionIndex(sortedColumnSelection, column.name) !== -1\n          // for icon state\n          const columnIndex: number =\n            columnIconSortState[index] === undefined\n              ? 0\n              : columnIconSortState[index]\n          // we have to figure out if the current column is a facet selection\n          const facetIndex: number = facets.findIndex(\n            (facetColumnResult: FacetColumnResult) => {\n              const facetDisplayValue =\n                facetAliases[facetColumnResult.columnName] ||\n                facetColumnResult.columnName\n              return facetDisplayValue === column.name\n            },\n          )\n          // the header must be included in the facets and it has to be enumerable for current rendering capabilities\n          const isFacetSelection: boolean =\n            facetIndex !== -1 && facets[facetIndex].facetType === 'enumeration'\n          const isSelectedSpanClass = isSelected\n            ? 'SRC-primary-background-color SRC-anchor-light'\n            : ''\n          const isSelectedIconClass = isSelected\n            ? 'SRC-selected-table-icon'\n            : 'SRC-primary-text-color'\n          const sortSpanBackgoundClass = `SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover  ${isSelectedSpanClass}`\n          const displayColumnName: string | undefined = unCamelCase(column.name)\n          return (\n            <th key={column.name}>\n              <div className=\"SRC-split\">\n                <span style={{ whiteSpace: 'nowrap' }}>\n                  {displayColumnName}\n                </span>\n                <div className=\"SRC-centerContent\">\n                  {isFacetSelection &&\n                    !this.props.enableLeftFacetFilter &&\n                    this.configureFacetDropdown(facets, facetIndex)}\n                  <span\n                    tabIndex={0}\n                    className={sortSpanBackgoundClass}\n                    onKeyPress={this.handleColumnSortPress({\n                      index,\n                      name: column.name,\n                    })}\n                    onClick={this.handleColumnSortPress({\n                      index,\n                      name: column.name,\n                    })}\n                  >\n                    <FontAwesomeIcon\n                      className={`SRC-primary-background-color-hover  ${isSelectedIconClass}`}\n                      icon={ICON_STATE[columnIndex] as IconProp}\n                    />\n                  </span>\n                </div>\n              </div>\n            </th>\n          )\n        } else {\n          return <th className=\"SRC-hidden\" key={column.name} />\n        }\n      },\n    )\n    // also push the access column if we are showing user access for individual items (must be logged in)\n    if (isShowingAccessColumn) {\n      tableColumnHeaderElements.push(\n        <th key=\"accessColumn\">\n          <div className=\"SRC-centerContent\">\n            <span style={{ whiteSpace: 'nowrap' }}>Access</span>\n          </div>\n        </th>,\n      )\n    }\n    return tableColumnHeaderElements\n  }\n\n  /**\n   * Utility to search through array of objects and find object with key \"column\"\n   * equal to input parameter \"name\"\n   *\n   * @param {*} sortedColumnSelection\n   * @param {*} name\n   * @returns -1 if not present, otherwise the index of the object\n   * @memberof SynapseTable\n   */\n  private findSelectionIndex(sortedColumnSelection: SortItem[], name: string) {\n    if (sortedColumnSelection.length !== 0) {\n      // find if the current selection exists already and remove it\n      return sortedColumnSelection.findIndex(\n        (el: SortItem) => el.column === name,\n      )\n    }\n    return -1\n  }\n\n  // Direct user to corresponding query on synapse\n  private advancedSearch(event: React.SyntheticEvent) {\n    event && event.preventDefault()\n    const lastQueryRequest = this.props.getLastQueryRequest!()\n    const { query } = lastQueryRequest\n    // base 64 encode the json of the query and go to url with the encoded object\n    const encodedQuery = btoa(JSON.stringify(query))\n    const synTable = lastQueryRequest.entityId\n    window.open(\n      `https://www.synapse.org/#!Synapse:${synTable}/tables/query/${encodedQuery}`,\n      '_blank',\n    )\n  }\n\n  private showDownload(event: React.SyntheticEvent) {\n    if (this.props.enableDownloadConfirmation) {\n      this.setState({ isDownloadConfirmationOpen: true })\n    } else {\n      this.advancedSearch(event)\n    }\n  }\n\n  private getLengthOfPropsData() {\n    const { data } = this.props\n    return data!.queryResult.queryResults.headers.length\n  }\n  /**\n   * Handles the toggle of a column select, this will cause the table to\n   * either show the column or hide depending on the prior state of the column\n   *\n   * @memberof SynapseTable\n   */\n  public toggleColumnSelection = (index: number) => (\n    _event: React.MouseEvent<HTMLLIElement>,\n  ) => {\n    let isColumnSelected: boolean[]\n    // lazily initialize isColumnSelected, at first it's empty\n    // and then on first column click we set it\n    if (this.state.isColumnSelected.length === 0) {\n      const { visibleColumnCount = Infinity } = this.props\n      // unpack all the data\n      const lengthOfPropsData = this.getLengthOfPropsData()\n      let defaultSelection\n      // fill up to visibleColumnCount with true and the rest as false\n      if (visibleColumnCount === Infinity) {\n        // if set to zero then its all true\n        defaultSelection = Array(lengthOfPropsData).fill(true)\n      } else {\n        // fill in whole array as false\n        defaultSelection = Array(lengthOfPropsData).fill(false)\n        // then fill in up until lengthOfPropsData with true\n        defaultSelection.fill(true, 0, visibleColumnCount)\n      }\n      isColumnSelected = defaultSelection\n    } else {\n      isColumnSelected = cloneDeep(this.state.isColumnSelected)\n    }\n    isColumnSelected[index] = !isColumnSelected[index]\n    this.setState({ isColumnSelected })\n  }\n\n  /**\n   * Show the dropdown menu for a column that has been faceted\n   *\n   * @param {number} index this is column index of the query table data\n   * @param {string} columnName this is the name of the column\n   * @param {FacetColumnResult[]} facetColumnResults\n   * @param {number} facetIndex\n   * @returns\n   * @memberof SynapseTable\n   */\n  public configureFacetDropdown(\n    facetColumnResults: FacetColumnResult[],\n    facetIndex: number,\n  ) {\n    // this grabs the specific facet selection\n    const facetColumnResult = facetColumnResults[\n      facetIndex\n    ] as FacetColumnResultValues\n    const isChecked = this.props.isAllFilterSelectedForFacet![\n      facetColumnResult.columnName\n    ]\n    return (\n      <FacetFilter\n        lastFacetSelection={this.props.lastFacetSelection!}\n        isLoading={this.props.isLoading!}\n        applyChanges={this.applyChanges}\n        isAllFilterSelectedForFacet={isChecked}\n        facetColumnResult={facetColumnResult}\n      />\n    )\n  }\n\n  public applyChangesFromQueryFilter = (facets: FacetColumnRequest[]) => {\n    const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n    queryRequest.query.selectedFacets = facets\n    this.setState({ isUserModifiedQuery: true })\n    this.props.executeQueryRequest!(queryRequest)\n  }\n\n  /**\n   * When the user decides to submit their changes for the dropdown menu with the facet, they have an\n   * apply button, this method handles that submission.\n   *\n   * @memberof SynapseTable\n   */\n  public applyChanges = ({\n    ref,\n    columnName,\n    facetValue = '',\n    selector = '',\n  }: {\n    ref: React.RefObject<HTMLSpanElement>\n    columnName: string\n    facetValue?: string\n    selector?: string\n  }) => (_: React.SyntheticEvent<HTMLElement>) => {\n    const htmlCheckboxes = Array.from(\n      ref.current!.querySelectorAll('.SRC-facet-checkboxes'),\n    ) as HTMLInputElement[]\n    const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n    const { isAllFilterSelectedForFacet } = this.props\n    const { newQueryRequest } = readFacetValues({\n      htmlCheckboxes,\n      queryRequest,\n      selector,\n      facet: columnName,\n    })\n\n    const lastFacetSelection = {\n      columnName,\n      facetValue,\n      selector,\n    } as FacetSelection\n    isAllFilterSelectedForFacet![columnName] = selector === SELECT_ALL\n    this.props.updateParentState!({\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n    })\n\n    this.props.executeQueryRequest!(newQueryRequest)\n    this.setState({ isUserModifiedQuery: true })\n  }\n}\ntype ColumnReference = {\n  index: number\n  name: string\n}\n","export enum StepStateEnum {\n  TODO,\n  PROGRESS,\n  COMPLETED,\n  EXCLUDED,\n  ERROR,\n}\n\nexport type Step = {\n  id: string\n  title: string\n  order: number\n  state: StepStateEnum\n  inProgress: boolean\n  rules?: any[]\n  validationRules?: any[]\n  default: string\n  excluded?: boolean\n  final?: boolean\n  description?: string\n  copy?: string\n  static?: boolean\n  child?: boolean\n  children?: string[]\n}\n\nexport enum NavActionEnum {\n  PREVIOUS,\n  NEXT,\n  GO_TO_STEP,\n  SAVE,\n  SUBMIT,\n  VALIDATE,\n  NONE,\n}\n\nexport enum StatusEnum {\n  PROGRESS,\n  ERROR,\n  SAVE_SUCCESS,\n  SUBMIT_SUCCESS,\n  ERROR_CRITICAL,\n}\n\nexport interface SummaryFormat {\n  screen: Step\n  label: string\n  value: string\n}\n\nexport type FormSchema = {\n  properties?: any\n  definitions?: any\n}\n\nexport interface IRulesEvent {\n  type: string\n  params: any\n}\nexport interface IRulesNavigationEvent extends IRulesEvent {\n  params: {\n    next: string\n  }\n}\n\nexport interface IRulesValidationEvent extends IRulesEvent {\n  params: {\n    message: string\n    name: string\n    property: string\n  }\n}\n\nexport type RulesResult = {\n  events: IRulesNavigationEvent[] | IRulesValidationEvent[]\n}\n\nexport interface IAdditionalError {\n  screen: string\n  field: string\n  message: string\n}\n","import { SynapseConstants, SynapseClient } from '../utils/'\nimport * as React from 'react'\nimport {\n  QueryBundleRequest,\n  FacetColumnValuesRequest,\n} from '../utils/synapseTypes/'\n\nexport type QueryCountProps = {\n  sql: string\n  selectedFacets?: FacetColumnValuesRequest[]\n  entityId: string\n  name: string\n  token?: string\n}\n\ntype QueryCountState = {\n  storedSqlQueryCount: {}\n  // maps sql string to true/false, true if already made a request for this sql's query count\n  // false or undefined if not\n  isCalculatingQueryCountForSql: {}\n}\n\n/**\n * QueryCount shows a query count\n *\n * @export\n * @class QueryCount\n * @extends {React.Component<QueryCountProps, QueryCountState>}\n */\nexport default class QueryCount extends React.Component<\n  QueryCountProps,\n  QueryCountState\n> {\n  constructor(props: QueryCountProps) {\n    super(props)\n    this.state = {\n      storedSqlQueryCount: {},\n      isCalculatingQueryCountForSql: {},\n    }\n    this.calculateRowCount = this.calculateRowCount.bind(this)\n  }\n\n  componentDidMount() {\n    this.calculateRowCount()\n  }\n\n  componentDidUpdate() {\n    this.calculateRowCount()\n  }\n\n  calculateRowCount() {\n    const { sql, token, entityId, selectedFacets } = this.props\n    if (\n      this.state.isCalculatingQueryCountForSql[sql] ||\n      this.state.storedSqlQueryCount[sql]\n    ) {\n      // its either in progress or its already been calculated\n      return\n    }\n    const request: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      query: {\n        sql,\n        selectedFacets,\n      },\n      entityId,\n      partMask: SynapseConstants.BUNDLE_MASK_QUERY_COUNT,\n    }\n    const { isCalculatingQueryCountForSql, storedSqlQueryCount } = this.state\n    isCalculatingQueryCountForSql[sql] = true\n    this.setState({\n      isCalculatingQueryCountForSql,\n    })\n    SynapseClient.getQueryTableResults(request, token).then(data => {\n      storedSqlQueryCount[sql] = data!.queryCount\n      this.setState({\n        storedSqlQueryCount,\n      })\n    })\n  }\n\n  render() {\n    const { sql, name } = this.props\n    const count = this.state.storedSqlQueryCount[sql]\n    /* https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString#Using_toLocaleString */\n    return (\n      <React.Fragment>\n        {name} ({count && count.toLocaleString()})\n      </React.Fragment>\n    )\n  }\n}\n","import * as React from 'react'\nimport { DATASET } from '../../utils/SynapseConstants'\nimport { calculateFriendlyFileSize } from '../../utils/functions/calculateFriendlyFileSize'\nimport * as Utils from './utils'\n\ntype DatasetProps = {\n  data?: any\n  schema?: any\n  secondaryLabelLimit?: number\n}\n\nclass Dataset extends React.Component<DatasetProps, {}> {\n  constructor(props: DatasetProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n\n  public handleLinkClick = (link: string) => (\n    event: React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    event.preventDefault()\n    window.open(`https://www.synapse.org/#!Synapse:${link}`, '_blank')\n  }\n\n  public render() {\n    const { data, schema } = this.props\n    const datasetName = data[schema.datasetName]\n    const summary = data[schema.summary]\n    const tumorType = data[schema.tumorType]\n    const diseaseFocus = data[schema.diseaseFocus]\n    const id = data[schema.id]\n    const fundingAgency = data[schema.fundingAgency]\n    const fileCount = data[schema.fileCount]\n    const fileSize = calculateFriendlyFileSize(data[schema.fileSize])\n    const values = [\n      ['FUNDER', fundingAgency],\n      ['SIZE', fileSize],\n      ['FILES', fileCount],\n    ]\n    return (\n      <div className=\"SRC-portalCard SRC-typeDataset  \">\n        <div className=\"SRC-cardThumbnail\">\n          <Utils.Icon type={DATASET} />\n          <div>{fileSize}</div>\n        </div>\n        <div className=\"SRC-cardContent SRC-dataset\">\n          <div className=\"SRC-type\">Dataset </div>\n          <div>\n            <h3>\n              <a\n                target=\"_self\"\n                href={`https://www.synapse.org/#!Synapse:${id}`}\n              >\n                {datasetName}\n              </a>\n            </h3>\n          </div>\n          <div className=\"SRC-description-dataset\">\n            <p className=\"SRC-description-text\">{summary}</p>\n            <div className=\"SRC-cardAction\">\n              <button\n                className=\"SRC-datasetButton\"\n                onClick={this.handleLinkClick(id)}\n                type=\"button\"\n              >\n                Download Dataset\n              </button>\n            </div>\n          </div>\n          <div className=\"SRC-cardAnnotations\">\n            <Utils.ChipContainer chips={[tumorType, diseaseFocus]} />\n          </div>\n        </div>\n        <Utils.CardFooter\n          isHeader={false}\n          secondaryLabelLimit={this.props.secondaryLabelLimit}\n          values={values}\n        />\n      </div>\n    )\n  }\n}\nexport default Dataset\n","// EntityForm:\n// Will generate a Form (based on your schema files).\n// Gathers user input (including files)\n// Will give you the Synapse ID of the FileEntity that contains the user form data.\nimport * as React from 'react'\nimport Form from 'react-jsonschema-form'\nimport { SynapseClient } from '../utils'\nimport {\n  EntityId,\n  EntityLookupRequest,\n  FileEntity,\n  UserProfile,\n} from '../utils/synapseTypes/'\n\nexport type EntityFormProps = {\n  // Provide the parent container (folder/project), that should contain a folder (named <user_id>) that this user can write to.\n  parentContainerId: string\n  formSchemaEntityId: string // Synapse file that contains the form schema.\n  formUiSchemaEntityId: string // Synapse file that contains the form ui schema.\n  initFormData: boolean // If true, it indicates that you’d like to download and pre-fill the form with the user's previous response.\n  token?: string // user's session token\n  synIdCallback: (synId: string) => void // callback.  Once the form output has been saved to a FileEntity, will send synID back\n}\ntype EntityFormState = {\n  error?: any\n  isLoading?: boolean\n  successfullyUploaded: boolean\n  containerId?: string\n  userprofile?: UserProfile\n  currentFileEntity?: FileEntity // file holding user form data\n  formData?: any // form data that prepopulates the form\n  formSchema?: any // schema that drives the form\n  formUiSchema?: any // ui schema that directs how to render the form elements\n}\n\nexport default class EntityForm extends React.Component<\n  EntityFormProps,\n  EntityFormState\n> {\n  formRef: any\n\n  constructor(props: EntityFormProps) {\n    super(props)\n    this.formRef = React.createRef()\n    this.state = {\n      isLoading: true,\n      successfullyUploaded: false,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh()\n  }\n\n  componentDidUpdate(prevProps: any) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      this.refresh()\n    }\n  }\n\n  submitForm = () => {\n    this.formRef.current.submit()\n  }\n\n  refresh = () => {\n    if (this.props.token) {\n      const promises = [\n        SynapseClient.getUserProfile(this.props.token),\n        SynapseClient.getEntity(\n          this.props.token,\n          this.props.formSchemaEntityId,\n        ),\n        SynapseClient.getEntity(\n          this.props.token,\n          this.props.formUiSchemaEntityId,\n        ),\n      ] as Promise<any>[]\n      Promise.all(promises)\n        .then(values => {\n          const userprofile: UserProfile = values[0]\n          this.getTargetContainer(userprofile, this.props.token!).then(\n            // @ts-ignore\n            (targetContainerId: string) => {\n              const formSchemaFileEntity: FileEntity = values[1]\n              const formUiSchemaFileEntity: FileEntity = values[2]\n              this.getSchemaFileContent(\n                targetContainerId,\n                formSchemaFileEntity,\n                formUiSchemaFileEntity,\n              )\n            },\n          )\n        })\n        .catch(error => {\n          this.onError(error)\n        })\n    }\n  }\n\n  getSchemaFileContent = (\n    targetFolderId: string,\n    formSchemaFileEntity: FileEntity,\n    formUiSchemaFileEntity: FileEntity,\n  ) => {\n    const promises = [\n      SynapseClient.getFileEntityContent(\n        this.props.token!,\n        formSchemaFileEntity,\n      ),\n      SynapseClient.getFileEntityContent(\n        this.props.token!,\n        formUiSchemaFileEntity,\n      ),\n    ]\n    Promise.all(promises)\n      .then(values => {\n        const formSchemaContent = JSON.parse(values[0])\n        const formUiSchemaContent = JSON.parse(values[1])\n        this.getExistingFileData(\n          targetFolderId,\n          formSchemaContent,\n          formUiSchemaContent,\n        )\n      })\n      .catch(error => {\n        this.onError(error)\n      })\n  }\n\n  getExistingFileData = (\n    targetFolderId: string,\n    formSchemaContent: any,\n    formUiSchemaContent: any,\n  ) => {\n    // if data already exists, save a reference to the existing entity and prefill the form\n    const fileName = `${formSchemaContent.title}.json`\n    const entityLookupRequest = {\n      entityName: fileName,\n      parentId: targetFolderId,\n    }\n    let formData: any\n    let currentFileEntity: FileEntity\n    SynapseClient.lookupChildEntity(entityLookupRequest, this.props.token)\n      .then((entityId: EntityId) => {\n        // ok, found the existing file\n        return SynapseClient.getEntity<FileEntity>(\n          this.props.token,\n          entityId.id,\n        ).then(entity => {\n          currentFileEntity = entity\n          if (this.props.initFormData) {\n            return SynapseClient.getFileEntityContent(\n              this.props.token!,\n              currentFileEntity,\n            ).then(existingFileData => {\n              formData = JSON.parse(existingFileData)\n            })\n          }\n          // else we're done\n          return Promise.resolve()\n        })\n      })\n      .finally(() => {\n        this.setState({\n          formData,\n          currentFileEntity,\n          formSchema: formSchemaContent,\n          formUiSchema: formUiSchemaContent,\n        })\n      })\n  }\n\n  getTargetContainer = async (userprofile: UserProfile, token: string) => {\n    const entityLookupRequest: EntityLookupRequest = {\n      entityName: userprofile.ownerId,\n      parentId: this.props.parentContainerId,\n    }\n    try {\n      const entityId = await SynapseClient.lookupChildEntity(\n        entityLookupRequest,\n        token,\n      )\n      // ok, found an entity of the same name.\n      console.log(\n        `EntityForm uploading to https://www.synapse.org/#!Synapse:${entityId.id}`,\n      )\n      this.setState({\n        userprofile,\n        containerId: entityId.id,\n        isLoading: false,\n      })\n      return entityId.id\n    } catch (error) {\n      if (error.status === 404) {\n        return this.onError(\n          new Error(\n            'Your folder has not yet been set up, please retry in a few minutes.',\n          ),\n        )\n      }\n      // else\n      return this.onError(error)\n    }\n  }\n\n  finishedProcessing = () => {\n    this.setState({\n      isLoading: false,\n      successfullyUploaded: true,\n    })\n  }\n\n  onError = (error: any) => {\n    this.setState({\n      error,\n      isLoading: false,\n      successfullyUploaded: false,\n    })\n  }\n\n  onSubmit = ({ formData }: any) => {\n    this.setState({\n      isLoading: true,\n      successfullyUploaded: false,\n    })\n\n    const submissionFileAndForm: Blob = new Blob([JSON.stringify(formData)], {\n      type: 'text/json',\n    })\n    this.createEntityFile(submissionFileAndForm)\n  }\n\n  createEntityFile = (fileContentsBlob: Blob) => {\n    const fileName = `${this.state.formSchema.title}.json`\n    SynapseClient.uploadFile(this.props.token, fileName, fileContentsBlob)\n      .then(fileUploadComplete => {\n        // do we need to create a new file entity, or update an existing file entity?\n        const newFileHandleId = fileUploadComplete.fileHandleId\n        if (this.state.currentFileEntity) {\n          this.state.currentFileEntity.dataFileHandleId = newFileHandleId\n          return SynapseClient.updateEntity(\n            this.state.currentFileEntity,\n            this.props.token,\n          )\n        }\n        // else, it's a new file entity\n        const newFileEntity: FileEntity = {\n          parentId: this.state.containerId!,\n          name: fileName,\n          concreteType: 'org.sagebionetworks.repo.model.FileEntity',\n          dataFileHandleId: newFileHandleId,\n        }\n        return SynapseClient.createEntity(newFileEntity, this.props.token)\n      })\n      .then(fileEntity => {\n        // by this point we've either found and updated the existing file entity, or created a new one.\n        this.finishedProcessing()\n        if (this.props.synIdCallback) {\n          this.props.synIdCallback(fileEntity.id!)\n        }\n      })\n      .catch((error: any) => {\n        this.onError(error)\n      })\n  }\n\n  render() {\n    return (\n      <div>\n        {this.state.error && (\n          <div className=\"panel panel-danger errors\">\n            <div className=\"panel-heading\">\n              <h3 className=\"panel-title\">Error</h3>\n            </div>\n            <ul className=\"list-group\">\n              <li className=\"list-group-item text-danger\">\n                {this.state.error.name} {this.state.error.reason}\n                {this.state.error.message}\n              </li>\n            </ul>\n          </div>\n        )}\n        {this.props.token &&\n          !this.state.isLoading &&\n          !this.state.successfullyUploaded &&\n          this.state.formSchema &&\n          this.state.formUiSchema &&\n          !this.state.error && (\n            <Form\n              formData={this.state.formData}\n              schema={this.state.formSchema}\n              uiSchema={this.state.formUiSchema}\n              onSubmit={this.onSubmit}\n              showErrorList={true}\n              ref={this.formRef}\n            >\n              <div style={{ display: 'none' }}>\n                <button type=\"submit\" className=\"btn btn-info\">\n                  Submit\n                </button>\n              </div>\n            </Form>\n          )}\n        {!this.state.error && this.props.token && this.state.isLoading && (\n          <React.Fragment>\n            <span>Saving&hellip;</span>\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          </React.Fragment>\n        )}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n\ntype FunderProps = {\n  data?: any\n  schema?: any\n}\n\nexport default class Funder extends React.Component<FunderProps, {}> {\n  constructor(props: FunderProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n  public handleLinkClick = (link: string) => (\n    event: React.MouseEvent<HTMLButtonElement>,\n  ) => {\n    event.preventDefault()\n    window.open(link, '_blank')\n  }\n  public render() {\n    const { data, schema } = this.props\n    const organizationName = data[schema.organizationName]\n    const organizationPath = data[schema.organizationPath]\n    const summary = data[schema.summary]\n    const website = data[schema.website]\n    const logoHref: string = data[schema.logo]\n    const orgPath = `${window.location.origin}/#${organizationPath}`\n    // remove leading http(s):// and trailing /\n    let websiteDisplayName = website.replace('https://', '')\n    websiteDisplayName = websiteDisplayName.replace('http://', '')\n    if (websiteDisplayName.charAt(websiteDisplayName.length - 1) === '/') {\n      websiteDisplayName = websiteDisplayName.substring(\n        0,\n        websiteDisplayName.length - 1,\n      )\n    }\n    const isOnOrgPath = window.location.hash.substring(1) === organizationPath\n    const style: any = {}\n    let showOrgLink\n    if (!isOnOrgPath) {\n      showOrgLink = (\n        <div className=\"SRC-marginAuto SRC-cardAction\">\n          <button onClick={this.handleLinkClick(orgPath)} type=\"button\">\n            View Funded Research\n          </button>\n        </div>\n      )\n    } else {\n      style.paddingBottom = '42px'\n    }\n    return (\n      <div className=\"SRC-portalCard SRC-typeFunder \" style={style}>\n        <div className=\"SRC-cardContent\">\n          <div className=\"SRC-type\">Organization</div>\n          {logoHref && (\n            <div className=\"SRC-cardThumbnail\">\n              <img alt=\"funder logo\" className=\"SRC-logo\" src={logoHref} />\n            </div>\n          )}\n          <div>\n            <h3>\n              {isOnOrgPath && organizationName}\n              {!isOnOrgPath && <a href={orgPath}>{organizationName}</a>}\n            </h3>\n          </div>\n          <div className=\"SRC-website\">\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href={website}>\n              {websiteDisplayName}\n            </a>\n          </div>\n          <div className=\"SRC-description\">{summary}</div>\n        </div>\n        {showOrgLink}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { getUserProfileWithProfilePicAttached } from '../utils/functions/getUserData'\nimport { UserProfileList } from '../utils/SynapseClient'\nimport { MEDIUM_USER_CARD } from '../utils/SynapseConstants'\nimport { QueryResultBundle, UserProfile } from '../utils/synapseTypes/'\nimport UserCard, { UserCardSize } from './UserCard'\nimport { without } from 'lodash-es'\n\nexport type UserCardListProps = {\n  list: string[]\n  size?: UserCardSize\n  // Data should not be needed, however, it gives the option to fill in a user profile with other column\n  // fields. This is required specifically by AMP-AD Explore/People page\n  data?: QueryResultBundle\n}\n\ntype MapOwnerIdToUserProfile = {\n  [index: number]: UserProfile\n}\nexport type UserCardListState = {\n  userProfileMap: MapOwnerIdToUserProfile\n}\nexport default class UserCardList extends React.Component<\n  UserCardListProps,\n  UserCardListState\n> {\n  constructor(props: UserCardListProps) {\n    super(props)\n    this.state = {\n      userProfileMap: {},\n    }\n    this.update = this.update.bind(this)\n  }\n\n  componentDidMount() {\n    const { list } = this.props\n    this.update(list)\n  }\n\n  componentDidUpdate(prevProps: UserCardListProps) {\n    const priorListOfIds = prevProps.list\n    const newValues = without(\n      this.props.list.filter(el => el),\n      ...priorListOfIds,\n    )\n    // check that the props have changed by seeing that at least one element is different\n    if (newValues.length > 0) {\n      this.update(newValues)\n    }\n  }\n\n  update(list: string[]) {\n    getUserProfileWithProfilePicAttached(list.filter(el => el))\n      .then((data: UserProfileList) => {\n        const newEntries = {}\n        data.list.forEach(el => {\n          const { ownerId } = el\n          newEntries[ownerId] = el\n        })\n        this.setState({\n          userProfileMap: { ...this.state.userProfileMap, ...newEntries },\n        })\n      })\n      .catch((err: string) => {\n        console.log('Error on batch call =', err)\n      })\n  }\n\n  /**\n   * Given data this will find rows where there is no userId columnType and create faux user profiles\n   * using firstName, lastName, and instituion (company in UserProfile object).\n   * @param {QueryResultBundle} data\n   * @returns list of UserProfiles with firstName, lastName, company, userName (first letter of firstName) filled out.\n   * @memberof UserCardList\n   */\n  manuallyExtractData(data: QueryResultBundle) {\n    const firstNameIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.name === 'firstName',\n    )\n    const lastNameIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.name === 'lastName',\n    )\n    const institutionIndex = data.queryResult.queryResults.headers.findIndex(\n      el => el.name === 'institution',\n    )\n    const ownerId = data.queryResult.queryResults.headers.findIndex(\n      el => el.columnType === 'USERID',\n    )\n    const nullOwnerIdsRows = data.queryResult.queryResults.rows.filter(\n      el => !el.values[ownerId],\n    )\n    return nullOwnerIdsRows.map<UserProfile>(el => {\n      const values = el.values\n      return {\n        firstName: values[firstNameIndex],\n        lastName: values[lastNameIndex],\n        company: values[institutionIndex],\n        ownerId: '',\n        userName: values[firstNameIndex][0],\n      }\n    })\n  }\n\n  render() {\n    const { size = MEDIUM_USER_CARD, data, list } = this.props\n    const { userProfileMap = {} } = this.state\n    const fauxUserProfilesList = data && this.manuallyExtractData(data)\n    let fauxUserProfileIndex = 0\n    return (\n      <div className=\"SRC-card-grid-row SRC-adjust-for-bootstrap-margin\">\n        {// we loop through the list from the props because thats the 'active set of data' whereas the data stored in state could be stale\n        list.map(ownerId => {\n          const userProfile = userProfileMap[ownerId]\n          if (userProfile) {\n            return (\n              <div\n                key={JSON.stringify(userProfile)}\n                className=\"SRC-grid-item SRC-narrow-grid-item\"\n              >\n                <UserCard\n                  size={size}\n                  preSignedURL={userProfile.clientPreSignedURL}\n                  userProfile={userProfile}\n                />\n              </div>\n            )\n          }\n          const fauxUserProfile =\n            fauxUserProfilesList && fauxUserProfilesList[fauxUserProfileIndex]\n          if (!fauxUserProfile) {\n            // This could happen in one of two cases:\n            // - The props just updated with a new userlist where the data is being gathered for this particular user\n            //   OR there is no mapping for this user\n            return false\n          }\n          fauxUserProfileIndex += 1\n          return (\n            <div\n              key={JSON.stringify(fauxUserProfile)}\n              className=\"SRC-grid-item SRC-narrow-grid-item\"\n            >\n              <UserCard\n                disableLink={true}\n                hideEmail={true}\n                size={size}\n                userProfile={fauxUserProfile}\n              />\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport {\n  DATASET,\n  FUNDER,\n  GENERIC_CARD,\n  MEDIUM_USER_CARD,\n} from '../utils/SynapseConstants'\nimport { QueryBundleRequest, QueryResultBundle } from '../utils/synapseTypes/'\nimport { CardConfiguration } from './CardContainerLogic'\nimport GenericCard from './GenericCard'\nimport { Dataset, Funder } from './row_renderers'\nimport TotalQueryResults from './TotalQueryResults'\nimport UserCardList from './UserCardList'\n\nconst PAGE_SIZE: number = 25\n\nexport type CardContainerProps = {\n  data?: QueryResultBundle\n  limit?: number\n  isHeader?: boolean\n  isAlignToLeftNav?: boolean\n  title?: string\n  facetAliases?: {}\n  getLastQueryRequest?: () => QueryBundleRequest\n  getNextPageOfData?: (queryRequest: QueryBundleRequest) => void\n  isLoading?: boolean\n  facet?: string\n  unitDescription?: string\n  hasMoreData?: boolean\n  showBarChart?: boolean\n  token?: string\n} & CardConfiguration\n\ntype CardContainerState = {\n  cardLimit: number\n}\n\nexport class CardContainer extends React.Component<\n  CardContainerProps,\n  CardContainerState\n> {\n  constructor(props: CardContainerProps) {\n    super(props)\n    this.handleViewMore = this.handleViewMore.bind(this)\n  }\n\n  /**\n   * Handle a click on next or previous\n   *\n   * @memberof SynapseTable\n   */\n  public handleViewMore() {\n    const queryRequest = this.props.getLastQueryRequest!()\n    let offset = queryRequest.query.offset!\n    // paginate forward\n    offset += PAGE_SIZE\n    queryRequest.query.offset = offset\n    this.props.getNextPageOfData!(queryRequest)\n  }\n\n  public renderCard = (props: any, type: string) => {\n    switch (type) {\n      case DATASET:\n        return <Dataset {...props} />\n      case FUNDER:\n        return <Funder {...props} />\n      case GENERIC_CARD:\n        return <GenericCard {...props} />\n      default:\n        return <div /> // this should never happen\n    }\n  }\n  public render() {\n    const {\n      data,\n      limit = Infinity,\n      isHeader = false,\n      facet,\n      unitDescription,\n      type,\n      isLoading,\n      loadingScreen,\n      secondaryLabelLimit = 3,\n      showBarChart = true,\n      title,\n      token,\n      getLastQueryRequest,\n      ...rest\n    } = this.props\n    // the cards only show the loading screen on initial load, this occurs when data is undefined\n    if (!data) {\n      return <div>{isLoading && loadingScreen}</div>\n    } else if (data && data.queryResult.queryResults.rows.length === 0) {\n      // data was retrieved from the backend but there is none to show, we return a empty fragment\n      // there could be a more informed UX decision here but the current use case right now\n      // should display nothing\n      return <React.Fragment />\n    }\n    const schema = {}\n    data.queryResult.queryResults.headers.forEach((element, index) => {\n      schema[element.name] = index\n    })\n\n    // We want to hide the view more button if:\n    //   1. The data fed in has !== PAGE_SIZE number of results\n    //   2. The hasMoreData prop is false\n    //   3. The limit is set to less than PAGE_SIZE\n    // below we show the view more button by following the opposite logic from above.\n    let showViewMore: boolean =\n      limit >= PAGE_SIZE &&\n      data.queryResult.queryResults.rows.length >= PAGE_SIZE\n    showViewMore = showViewMore && this.props.hasMoreData!\n\n    const showViewMoreButton = showViewMore && (\n      <div>\n        <button\n          onClick={this.handleViewMore}\n          className=\"pull-right SRC-standard-button-shape SRC-light-button\"\n        >\n          View More\n        </button>\n      </div>\n    )\n    let cards\n    if (type === MEDIUM_USER_CARD) {\n      // Hard coding ownerId as a column name containing the user profile ownerId\n      // for each row, grab the column with the ownerId\n      const userIdColumnIndex = data.queryResult.queryResults.headers.findIndex(\n        el => el.columnType === 'USERID',\n      )\n      if (userIdColumnIndex === -1) {\n        throw Error(\n          'Type MEDIUM_USER_CARD specified but no columnType USERID found',\n        )\n      }\n      const listIds = data.queryResult.queryResults.rows.map(\n        el => el.values[userIdColumnIndex],\n      )\n      cards = (\n        <UserCardList data={data} list={listIds} size={MEDIUM_USER_CARD} />\n      )\n    } else {\n      // render the cards\n      cards = data.queryResult.queryResults.rows.map((rowData: any, index) => {\n        if (index < limit) {\n          const key = JSON.stringify(rowData.values)\n          const propsForCard = {\n            key,\n            type,\n            schema,\n            isHeader,\n            secondaryLabelLimit,\n            data: rowData.values,\n            selectColumns: data.selectColumns,\n            token,\n            ...rest,\n          }\n          return this.renderCard(propsForCard, type)\n        }\n        return false\n      })\n    }\n\n    return (\n      <div>\n        {title && <h2 className=\"SRC-card-overview-title\">{title}</h2>}\n        {!title && unitDescription && showBarChart && (\n          <TotalQueryResults\n            token={token}\n            isLoading={isLoading!}\n            unitDescription={unitDescription}\n            getLastQueryRequest={getLastQueryRequest}\n            frontText={'Displaying'}\n          />\n        )}\n        {/* ReactCSSTransitionGroup adds css fade in property for cards that come into view */}\n        {cards}\n        {showViewMoreButton}\n      </div>\n    )\n  }\n}\n\nexport default CardContainer\n","import * as React from 'react'\n\nexport type HeaderProps = {\n  isSubmitted?: boolean\n  bodyText?: string //should never take user input only use cardcoded text from a parent component. Uses dangerouslySetInnerHTML\n  title: string\n}\n\nexport default function Header(props: HeaderProps) {\n  let bodyText = <></>\n\n  if (props.isSubmitted) {\n    bodyText = <div>Your information has been submitted</div>\n  } else {\n    if (props.bodyText) {\n      bodyText = (\n        <div dangerouslySetInnerHTML={{ __html: props.bodyText }}></div>\n      )\n    }\n  }\n\n  return (\n    <div\n      className={`submission-header${props.isSubmitted ? ' submitted' : ''}`}\n    >\n      <h2>{props.title}</h2>\n      {bodyText}\n      <hr></hr>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Step, StepStateEnum } from './types'\n\nimport { FlipProp, IconDefinition } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCheckCircle,\n  faCircle,\n  faBan,\n  faExclamationCircle,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport type StepsSideNavProps = {\n  stepList: Step[]\n  onStepChange: Function\n  isWizardMode?: boolean\n}\n\nexport default function StepsSideNav(props: StepsSideNavProps) {\n  const nonChildSteps = props.stepList.filter(step => step.child !== true)\n\n  const getIcon = (\n    state: StepStateEnum,\n    isExcluded: boolean | undefined,\n    isStatic: boolean | undefined,\n    isSubmit: boolean | undefined,\n  ): { iconDef: IconDefinition; flip: FlipProp | undefined } => {\n    let iconDef: IconDefinition = faCircle\n    let flip: FlipProp | undefined = undefined\n    if (isStatic || isSubmit) {\n      return {\n        iconDef,\n        flip,\n      }\n    }\n\n    if (isExcluded) {\n      iconDef = faBan\n      flip = 'horizontal'\n    } else if (state == StepStateEnum.COMPLETED) {\n      iconDef = faCheckCircle\n    } else if (state == StepStateEnum.ERROR) {\n      iconDef = faExclamationCircle\n    }\n    return { iconDef, flip }\n  }\n\n  const getItemClass = (\n    isInProgress: boolean,\n    isStatic: boolean = false,\n  ): string => {\n    let liClassName = 'item'\n    if (isInProgress) {\n      liClassName = `${liClassName} pointed `\n    }\n    if (isStatic) {\n      liClassName = `${liClassName} static`\n    }\n    return liClassName\n  }\n\n  const getListItem = (\n    step: Step,\n    isWizard: boolean,\n    isRenderChild = false,\n  ): JSX.Element => {\n    if (!step || (step.child && !isRenderChild)) {\n      return <></>\n    }\n    const renderStepName = (\n      step: Step,\n      isWizard: boolean,\n      callback: Function,\n    ): JSX.Element => {\n      if (!step.inProgress && (!isWizard || !!step.final)) {\n        return (\n          <button className=\"btn btn-link\" onClick={() => callback(step)}>\n            {step.title}\n          </button>\n        )\n      } else {\n        return <span>{step.title}</span>\n      }\n    }\n    const icon = getIcon(step.state, step.excluded, step.static, step.final)\n    const itemClass = getItemClass(step.inProgress, step.static)\n\n    return (\n      <div className={itemClass}>\n        <FontAwesomeIcon icon={icon.iconDef} flip={icon.flip} />\n        {renderStepName(step, isWizard, props.onStepChange)}\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"SRC-menuLayout json-forms-menu\" style={{ flex: '1' }}>\n      <ul>\n        {nonChildSteps.map((step: Step, i: number) => {\n          return (\n            <li className=\"item-wrap\" key={i + step.id}>\n              {getListItem(step, !!props.isWizardMode)}\n              {step.children && step.children.length > 0 && (\n                <div className=\"subMenu\">\n                  <ul>\n                    {step.children &&\n                      step.children.map((stepChildId: string, j: number) => {\n                        const childStep = props.stepList.find(\n                          step => step.id === stepChildId,\n                        )\n                        return typeof childStep === 'undefined' ? (\n                          <></>\n                        ) : (\n                          <li className=\"item-wrap\" key={j + stepChildId}>\n                            {getListItem(childStep, !!props.isWizardMode, true)}\n                          </li>\n                        )\n                      })}\n                  </ul>\n                </div>\n              )}\n            </li>\n          )\n        })}\n      </ul>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { Step, NavActionEnum } from './types'\nimport {\n  faChevronLeft,\n  faChevronRight,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport interface NavButtonsProps {\n  isWizardMode?: boolean\n  previousStepIds: string[]\n  onNavAction: Function\n  steps: Step[]\n  currentStep: Step\n  isFormSubmitted?: boolean\n}\n\nexport interface NextStepLinkProps {\n  onNavAction: Function\n  steps: Step[]\n  nextStepId: string | undefined\n}\n\nexport function NavButtons(props: NavButtonsProps): JSX.Element {\n  // in wizard mode we build an array of the previous steps. In regular mode back goes to\n  // a previous order step\n  const canGoBack = (props: NavButtonsProps): boolean => {\n    if (props.isWizardMode) {\n      return props.previousStepIds && props.previousStepIds.length > 0\n    } else {\n      return props.steps.findIndex(step => step.id === props.currentStep.id) > 0\n    }\n  }\n\n  const previousButton = canGoBack(props) ? (\n    <button\n      type=\"button\"\n      onClick={e => props.onNavAction(NavActionEnum.PREVIOUS)}\n      className=\"btn btn-link nav-link prev\"\n    >\n      <FontAwesomeIcon icon={faChevronLeft} />\n    </button>\n  ) : (\n    <></>\n  )\n\n  const nextButton = !props.currentStep.final ? (\n    <button\n      type=\"button\"\n      onClick={e => props.onNavAction(NavActionEnum.NEXT)}\n      className=\"btn btn-link nav-link next\"\n    >\n      <FontAwesomeIcon icon={faChevronRight} />\n    </button>\n  ) : (\n    <></>\n  )\n\n  const saveButton = (\n    <button\n      type=\"button\"\n      className=\"btn btn-action save\"\n      disabled={props.isFormSubmitted}\n      onClick={e => props.onNavAction(NavActionEnum.SAVE)}\n    >\n      SAVE\n    </button>\n  )\n\n  return (\n    <div>\n      <hr></hr>\n      <div className=\"buttonWrapper pull-right\">\n        {previousButton} {nextButton} {saveButton}\n      </div>\n    </div>\n  )\n}\n\nexport function NextStepLink(props: NextStepLinkProps): JSX.Element {\n  const nextStep = props.steps.find(step => step.id === props.nextStepId)\n  if (typeof nextStep === 'undefined') {\n    return <></>\n  }\n  return (\n    <span className=\"nav-link\">\n      <a onClick={e => props.onNavAction(nextStep)}>{nextStep.title}</a>\n      <FontAwesomeIcon icon={faChevronRight}></FontAwesomeIcon>\n    </span>\n  )\n}\n","import * as React from 'react'\n\ninterface DataDebugProps {\n  formData: any\n  hidden: boolean\n}\n\nexport default function DataDebug(props: DataDebugProps) {\n  const myData = (\n    <div>\n      <h6>Data</h6>\n      <pre>{JSON.stringify(props.formData, null, 2)}</pre>\n    </div>\n  )\n  return <>{!props.hidden && myData}</>\n}\n","import * as React from 'react'\n\nimport { UiSchema } from 'react-jsonschema-form'\nimport { SummaryFormat, Step, FormSchema } from './types'\nimport {\n  first,\n  cloneDeep,\n  keys,\n  find,\n  isObject,\n  get,\n  isArray,\n  isString,\n  isDate,\n} from 'lodash-es'\n\nexport interface SummaryTableProps {\n  isWizard?: boolean\n  formData: any\n  callbackFn?: Function\n  steps: Step[]\n  schema: FormSchema\n  uiSchema: UiSchema\n}\n\nfunction findLabel(key: string, schema: any, uiSchema: UiSchema): string {\n  const regex1 = /\\[\\d+\\]\\./g\n  const regex3 = /\\.(\\d)+/g\n\n  key = key.replace(regex3, '[$1]')\n\n  const propArr = key.split('.')\n  // some things require labels in schema (e.g. checkboxes) so this is preferred\n  const labelFromSchema = `${propArr.join('.properties.')}.title`\n  //can be overriden by label in UI\n  const labelFromUi = `${key}.ui:title`\n  //for array fields we need to change the property e.g.\n  //  ld50.experiments[0].species_other should look like 'ld50.experiments.items.species_other'\n  const arrayLabelFromSchema = labelFromSchema.replace(regex1, '.items.')\n  const arrayLabelFromUiSchema = labelFromUi.replace(regex1, '.items.')\n  const indexMatch = labelFromSchema.match(regex1)\n  let index = first(indexMatch)\n\n  if (index) {\n    index = index.substring(1, index.length - 2)\n    index = !isNaN(parseInt(index)) ? parseInt(index) + 1 + '' : ''\n  }\n\n  const label =\n    get(uiSchema, labelFromUi) ||\n    get(schema.properties, labelFromSchema) ||\n    get(uiSchema, arrayLabelFromUiSchema) ||\n    get(schema.properties, arrayLabelFromSchema) ||\n    `${arrayLabelFromSchema}`\n  return `${index ? '[' + index + '] ' : ''}${label}`\n}\n\nexport function getFlatData(\n  formData: any,\n  steps: Step[],\n  schema: FormSchema,\n  uiSchema: UiSchema,\n): SummaryFormat[] {\n  //takes nested json and converts it into flattened item list\n\n  function flatten(\n    object: any,\n    flattenedObject: any,\n    prefix: string,\n  ): string[] {\n    const separator = '.'\n    Object.keys(object).forEach(key => {\n      if (object[key] === null) {\n        flattenedObject[prefix + key] = ''\n      } else if (\n        //if the value is a proper array\n        isArray(object[key]) &&\n        !isString(object[key])\n      ) {\n        for (const i in object[key]) {\n          if (\n            isArray(object[key][i]) ||\n            (isObject(object[key]) && !isString(object[key][i]))\n          ) {\n            flatten(\n              object[key][i],\n              flattenedObject,\n              `${prefix}${key}[${i}]${separator}`,\n            )\n          } else {\n            let prevVal = flattenedObject[`${prefix}${key}`]\n            prevVal = prevVal ? prevVal + ', ' : ''\n            flattenedObject[`${prefix}${key}`] = prevVal + object[key][i]\n          }\n        }\n      } else if (isObject(object[key]) && !isDate(object[key])) {\n        flatten(object[key], flattenedObject, `${prefix}${key}${separator}`)\n      } else {\n        flattenedObject[prefix + key] = object[key]\n      }\n    })\n    return flattenedObject\n  }\n\n  const flatData = flatten(cloneDeep(formData), [], '')\n  const flatFormData = keys(flatData)\n    .map(key => {\n      let val = flatData[key]\n      if (flatData[key] === false) {\n        val = 'false'\n      }\n      if (flatData[key] === true) {\n        val = 'true'\n      }\n      const boundary = key.indexOf('.')\n      return {\n        screen: find(steps, { id: key.substring(0, boundary) }),\n        label: findLabel(key, schema, uiSchema),\n        value: val,\n      }\n    })\n    .filter(item => item.label.indexOf('.properties.included.title') === -1) //included is the property we generate to help with validation of optional forms\n\n  const result = flatFormData\n    .filter(item => item.screen && typeof item.value !== 'undefined')\n    .map(item => {\n      return {\n        label: item.label,\n        value: item.value,\n        screen: item.screen!,\n      }\n    })\n    .sort((a, b) => a.screen.order - b.screen.order)\n\n  return result\n}\n\nexport default function SummaryTable(props: SummaryTableProps): JSX.Element {\n  let flatFormData: SummaryFormat[] = []\n\n  flatFormData = getFlatData(\n    cloneDeep(props.formData),\n    props.steps,\n    props.schema,\n    props.uiSchema,\n  )\n\n  let prevScreenId = ''\n  const table = (\n    <>\n      <table className=\"table summary-table-header\">\n        <thead>\n          <tr>\n            <th>Step</th>\n            <th>Label</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n      </table>\n\n      <div className=\"scroll-area table-body\">\n        <table className=\"table summary-table\">\n          <tbody>\n            {flatFormData.map((line: SummaryFormat, i: number) => {\n              return (\n                <tr key={i + line.screen.id + line.label}>\n                  <td>\n                    {prevScreenId !== line.screen.id &&\n                      (prevScreenId = line.screen.id) && (\n                        <span>{line.screen.title}</span>\n                      )}\n                  </td>\n                  <td>{line.label}</td>\n\n                  <td>{line.value}</td>\n                </tr>\n              )\n            })}\n          </tbody>\n        </table>\n      </div>\n    </>\n  )\n\n  return (\n    <>\n      <p className=\"step-exclude-directions\">\n        Below is all of the data you have entered. Before submitting, click\n        'Validate' to ensure that all of the required data has been entered.\n      </p>\n      <button className=\"nav-link pull-right\" onClick={() => window.print()}>\n        Print this data\n      </button>\n      <div className=\"panel panel-default padding-full wrap\">\n        <div className=\"summary scroll-area\">{table}</div>\n      </div>\n    </>\n  )\n}\n","import React from 'react'\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\n\nexport type WarningModalProps = {\n  title: string\n  copy: string | JSX.Element\n  confirmCopy?: string\n  className?: string\n  show: boolean\n  onOK: Function\n  onCancel: Function\n  callbackArgs: any\n}\n\nexport default function WarningModal(props: WarningModalProps) {\n  return (\n    <Modal show={props.show} animation={false} className={props.className}>\n      <Modal.Header closeButton={false} onHide={() => props.onCancel()}>\n        <Modal.Title>{props.title}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>{props.copy}</Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"secondary\" onClick={() => props.onCancel()}>\n          Cancel\n        </Button>\n        <Button\n          variant=\"success\"\n          onClick={() => props.onOK(...props.callbackArgs)}\n        >\n          <span>{props.confirmCopy || 'OK'}</span>\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  )\n}\n","import * as React from 'react'\nimport _ from 'lodash-es'\nimport { Engine } from 'json-rules-engine'\nimport {\n  default as Form,\n  UiSchema,\n  AjvError,\n  ErrorListProps,\n} from 'react-jsonschema-form'\n\nimport {\n  Step,\n  StepStateEnum,\n  NavActionEnum,\n  StatusEnum,\n  FormSchema,\n  RulesResult,\n  IRulesValidationEvent,\n  IRulesNavigationEvent,\n} from './types'\nimport Header from './Header'\nimport StepsSideNav from './StepsSideNav'\nimport { NavButtons, NextStepLink } from './NavButtons'\nimport DataDebug from './DataDebug'\nimport SummaryTable from './SummaryTable'\nimport WarningModal from './WarningModal'\nimport Switch from 'react-switch'\nimport { Prompt } from 'react-router-dom'\n\nexport interface IFormData {\n  [key: string]: {\n    included?: boolean\n    [key: string]: any\n  }\n}\n\nexport type SynapseFormProps = {\n  schema: FormSchema\n  uiSchema: UiSchema\n  navSchema: {\n    steps: any[]\n  }\n  formData: IFormData\n  onSubmit: Function\n  onSave: Function\n  formTitle: string\n  formClass?: string\n  isWizardMode?: boolean\n  callbackStatus?: StatusEnum\n  isSubmitted?: boolean\n}\n\ntype SynapseFormState = {\n  formData: IFormData // form data that prepopulates the form\n  currentStep: Step\n  nextStep?: Step\n  steps: Step[]\n  previousStepIds: string[]\n  hasValidated?: boolean //validation has been called and it passed\n  doShowErrors: boolean //if we should show error summary at the top of the page\n  doShowHelp: boolean\n  modalContext?: { action: Function; arguments: any[] }\n  hasUnsavedChanges: boolean\n  isSubmitted?: boolean\n  isLoadingSaved: boolean\n}\n\nexport interface SummaryFormat {\n  label: string\n  value: string\n}\n\nexport default class SynapseForm extends React.Component<\n  SynapseFormProps,\n  SynapseFormState\n> {\n  excludeWarningText = (\n    <div>\n      <p>\n        This action will clear any entered data on this page and remove this\n        form from your submission. You can include it again at anytime. Only\n        this page will be affected.\n      </p>\n      <p>Are you sure you want to skip this step and clear any entered data?</p>\n    </div>\n  )\n  excludeWarningHeader = 'Skip This Step?'\n  unsavedDataWarning = `You might have some unsaved data. Are you sure you want to leave?`\n  formRef: any //ref to form for submission\n  formDivRef: any // ref to the div containing form (for scrolling on validation failure)\n  navAction: NavActionEnum = NavActionEnum.NONE\n  uiSchema: {}\n  nextStep: Step | undefined\n  extraErrors: AjvError[] = []\n\n  isNewForm = (formData: IFormData): boolean => {\n    return (\n      (Object.keys(formData).length == 1 &&\n        Object.keys(formData)[0] === 'metadata') ||\n      Object.keys(formData).length == 0\n    )\n  }\n\n  getFirstStep = (steps: Step[], formData: IFormData): Step => {\n    if (!this.isNewForm(formData)) {\n      return steps.find(step => step.final === true) || steps[0]\n    } else {\n      return steps[0]\n    }\n  }\n\n  constructor(props: SynapseFormProps) {\n    super(props)\n\n    //will modify the ui:help to render html vs text\n    this.uiSchema = stringToElementForProp(\n      _.cloneDeep(props.uiSchema),\n      'ui:help',\n    )\n    //create steps array from the navSchema\n    const steps = props.navSchema.steps\n      .map((step, i) => {\n        return {\n          ...step,\n          inProgress: i === 0 ? true : false,\n        }\n      })\n      .sort((a, b) => a.order - b.order)\n\n    this.formRef = React.createRef()\n    this.formDivRef = React.createRef()\n    const currentStep = this.getFirstStep(steps, props.formData)\n    this.state = {\n      currentStep,\n      steps,\n      previousStepIds: [],\n      formData: props.formData,\n      doShowErrors: false,\n      doShowHelp: true,\n      hasUnsavedChanges: false,\n      isSubmitted: props.isSubmitted,\n      isLoadingSaved: !this.isNewForm(this.props.formData),\n    }\n  }\n\n  onUnload = (ev: any) => {\n    {\n      if (this.state.hasUnsavedChanges) {\n        ev.preventDefault()\n        return (ev.returnValue = this.unsavedDataWarning)\n      }\n      return\n    }\n  }\n  // Setup the `beforeunload` event listener\n  setupBeforeUnloadListener = () => {\n    window.addEventListener('beforeunload', this.onUnload)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeunload', this.onUnload)\n  }\n\n  componentDidUpdate(prevProps: SynapseFormProps) {\n    const shouldUpdate = this.props.callbackStatus !== prevProps.callbackStatus\n    const isSuccess =\n      this.props.callbackStatus === StatusEnum.SAVE_SUCCESS ||\n      this.props.callbackStatus === StatusEnum.SUBMIT_SUCCESS\n    if (shouldUpdate && isSuccess) {\n      this.setState({ hasUnsavedChanges: false })\n      if (this.props.callbackStatus === StatusEnum.SUBMIT_SUCCESS) {\n        this.setState({ isSubmitted: true })\n        window.history.back()\n      }\n    }\n  }\n\n  _setIncludedPropInFormDataNonWizard = (\n    currentState: SynapseFormState,\n    schemaScreens: any,\n  ): IFormData => {\n    const result = {}\n    const currentStateFormData = currentState.formData\n    //if there is a top level 'included' property in schema - update the form.\n    Object.keys(schemaScreens).forEach((key: string) => {\n      if (_.get(schemaScreens[key], `properties.included`)) {\n        _.set(result, `${key}.included`, true)\n      }\n    })\n    return { ...currentStateFormData, ...result }\n  }\n\n  _setIncludedPropInFormDataWizard = (\n    currentState: SynapseFormState,\n  ): IFormData => {\n    const firstStepId = currentState.currentStep.id\n    const newStateData = _.cloneDeep(currentState.formData)\n    _.set(newStateData, `${firstStepId}.included`, true)\n    return newStateData\n  }\n\n  componentDidMount() {\n    this.setupBeforeUnloadListener()\n    const isNewForm = this.isNewForm(this.state.formData)\n    if (!isNewForm) {\n      //when loading saved form - validate to see the steps status\n      this.triggerAction(NavActionEnum.VALIDATE)\n    } else {\n      // for validation of optional forms. Validation is enforced only if included property is set.\n      this.setState(prevState => {\n        const newFormData = this.props.isWizardMode\n          ? this._setIncludedPropInFormDataWizard(prevState)\n          : this._setIncludedPropInFormDataNonWizard(\n              prevState,\n              this.props.schema,\n            )\n        return {\n          formData: newFormData,\n        }\n      })\n    }\n  }\n\n  // get the schema slice for the current screen/step\n  getSchema = ({ id, final }: Step): FormSchema => {\n    if (final) {\n      return this.props.schema\n    }\n    //only get schema for current step. Only the portion of entire form is shown\n\n    const currentStepSlice = _.pick(this.props.schema, [\n      'title',\n      'type',\n      `properties.${id}`,\n    ])\n    return currentStepSlice\n  }\n\n  // find the next step\n  getNextStepId = async (\n    currentStep: Step,\n    formData: any,\n    nextStepId?: string,\n  ): Promise<string> => {\n    if (nextStepId) {\n      return nextStepId\n    }\n    if (!currentStep.rules || currentStep.rules.length === 0) {\n      return currentStep.default\n    }\n\n    // if there are rules - run the engine and go to the first next step\n    const engine = new Engine(currentStep.rules)\n\n    try {\n      const result: RulesResult = await engine.run(formData)\n      if (result.events.length > 0) {\n        return (result.events[0] as IRulesNavigationEvent).params.next\n      } else {\n        return currentStep.default\n      }\n    } catch (error) {\n      return currentStep.default\n    }\n  }\n\n  // called when going next, previous or a given step\n  moveStep = async (\n    formData: any,\n    nextStepId: string | undefined,\n    isError: boolean,\n    previousStack = [...this.state.previousStepIds],\n  ) => {\n    const currentStep = this.state.currentStep\n    let currentStepState: StepStateEnum\n    //we don't wnat to display errors on the page - this will be done explicitly in validation\n    this.formRef.current.setState({ errorSchema: {} })\n    //in wizard mode we can only move forwards (don't know next step yet) or backwards (do know next step)\n    const isMoveForwardInWizardMode = this.props.isWizardMode && !nextStepId\n\n    //previousStack is used for 'back' navigation is wizard mode.\n    //only need to do it if moving forward i.e. nextStepId is undefined\n    if (isMoveForwardInWizardMode) {\n      previousStack.push(currentStep.id)\n    }\n\n    if (!isError) {\n      currentStepState = StepStateEnum.COMPLETED\n\n      if (!isMoveForwardInWizardMode && this.props.isWizardMode) {\n        currentStepState = StepStateEnum.TODO\n      }\n    } else {\n      currentStepState = StepStateEnum.ERROR\n    }\n    // determine next step\n    nextStepId = await this.getNextStepId(currentStep, formData, nextStepId)\n\n    const steps = this.state.steps.map(step => {\n      if (step.id === currentStep.id) {\n        return {\n          ...step,\n          ...{ state: currentStepState, inProgress: false },\n        }\n      } else if (step.id === nextStepId) {\n        return { ...step, ...{ inProgress: true } }\n      }\n      return step\n    })\n    //if we are in wizard mode we want to make sure that we include the step we are about to go to\n    if (isMoveForwardInWizardMode) {\n      _.set(formData, `${nextStepId}.included`, true)\n    }\n\n    //at this point the form is valid and submitted and the data reflects the latest\n    const nextStep = this.state.steps.find(step => step.id === nextStepId)!\n    // clean up unused screens in wizard before getting to submit\n    if (this.props.isWizardMode && nextStep.final) {\n      Object.keys(formData).forEach(key => {\n        if (formData[key].included === undefined) {\n          formData[key] = {}\n        }\n      })\n    }\n\n    this.saveStepState(previousStack, steps, nextStep!, formData)\n  }\n\n  //save the state of the current screen\n  saveStepState = (\n    previousStepIds: string[],\n    steps: Step[],\n    currentStep: Step,\n    formData: any,\n  ) => {\n    this.setState({\n      previousStepIds,\n      steps,\n      currentStep,\n      formData,\n      hasValidated: false,\n      doShowErrors: false,\n    })\n  }\n\n  //--------- fns to support navigation --------------------//\n  goPrevious = async (formData: any, isError: boolean) => {\n    let previousStepId: string | undefined\n    const previousStack: string[] = [...this.state.previousStepIds]\n    // in wizard mode we go to the previously visited screen.\n    // In regular mode go to the screen with previous index\n    if (this.props.isWizardMode) {\n      previousStepId = previousStack.pop()\n      if (!this.isSubmitScreen()) {\n        //since we don't know if we'll get back to that step again - exclude it. We will include it again if we\n        // get to it.\n        _.set(formData, `${this.state.currentStep.id}.included`, undefined)\n      }\n    } else {\n      const currentIndex = _.findIndex(this.state.steps, {\n        id: this.state.currentStep.id,\n      })\n      if (currentIndex > 0) {\n        previousStepId = this.state.steps[currentIndex - 1].id\n      }\n    }\n    if (!_.isUndefined(previousStepId)) {\n      return this.moveStep(formData, previousStepId, isError, previousStack)\n    }\n  }\n\n  triggerAction = async (navAction: NavActionEnum) => {\n    // we don't need to validate on save so bypassing submit\n    if (navAction === NavActionEnum.SAVE) {\n      return this.props.onSave(this.state.formData)\n    } else {\n      this.navAction = navAction\n      // first run whatever custom validaton we have\n      this.extraErrors = await this.runCustomValidation(\n        this.state.formData,\n        this.state.currentStep,\n        this.state.steps,\n      )\n      if (this.formRef.current) {\n        this.formRef.current.submit()\n      }\n    }\n  }\n\n  // triggered when we click on the step name in left nav (doesn't happen in wizard mode)\n  triggerStepChange = (step: Step) => {\n    this.nextStep = step\n    this.triggerAction(NavActionEnum.GO_TO_STEP)\n  }\n\n  onError = (args: any) => {\n    this.setState({\n      doShowErrors: true,\n      hasValidated: false,\n    })\n    if (this.navAction === NavActionEnum.VALIDATE) {\n      const modifiedSteps = this.setStepStatusForFailedValidation(\n        args.props,\n        this.state.steps,\n        !!this.props.isWizardMode,\n        this.state.formData,\n        this.getSchema(this.state.currentStep).properties ||\n          this.getSchema(this.state.currentStep),\n      )\n      this.setState({ steps: modifiedSteps })\n      this.formDivRef.current.scrollTo(0, 0)\n      if (this.state.isLoadingSaved) {\n        this.moveStep(this.state.formData, modifiedSteps[0].id, true)\n        this.setState({ isLoadingSaved: false })\n      }\n    }\n  }\n\n  setStepStatusForFailedValidation = (\n    errors: AjvError[],\n    steps: Step[],\n    isWizard: boolean,\n    formData: IFormData,\n    currentSchemaProperties: any,\n  ): Step[] => {\n    //error property is in the format: step.somevalue.etc  .welcome.submission_name example\n    //find all the steps where there is an error\n    const stepsWithError = errors.map(\n      error => _.trimStart(error.property, '.').split('.')[0],\n    )\n    //find all steps in current schema\n    const stepsInCurrentSchema = Object.keys(currentSchemaProperties)\n    const updatedSteps: Step[] = steps.map(step => {\n      //if there is an error in this step\n      if (stepsWithError.indexOf(step.id) > -1) {\n        return {\n          ...step,\n          state: StepStateEnum.ERROR,\n        }\n        //if no error and included in schema\n      } else if (stepsInCurrentSchema.indexOf(step.id) > -1) {\n        let state = StepStateEnum.COMPLETED\n        //if we are in wizard and possibly have not visited this step\n        if (isWizard && !_.get(formData[step.id], 'included')) {\n          state = step.state\n        }\n\n        return {\n          ...step,\n          state: state,\n        }\n      } else {\n        return step\n      }\n    })\n    return updatedSteps\n  }\n\n  //we are constantly saving form data. Needed to overwrite on-error behavior\n  handleOnChange({ formData }: any) {\n    //this is just for form updates. submit screen goes different route\n    if (!this.isSubmitScreen() && !this.state.currentStep.excluded) {\n      const hasUnsavedChanges = !_.isEqual(this.state.formData, formData)\n      this.setState({ formData, hasUnsavedChanges })\n    }\n  }\n\n  performAction(navAction: NavActionEnum, hasError: boolean) {\n    const formData = this.state.formData\n\n    switch (navAction) {\n      case NavActionEnum.NEXT: {\n        return this.moveStep(formData, undefined, hasError)\n      }\n      case NavActionEnum.PREVIOUS: {\n        return this.goPrevious(formData, hasError)\n      }\n      case NavActionEnum.GO_TO_STEP: {\n        //nextStep is returned when clicked on the Steps left nav\n        if (!this.nextStep) {\n          return\n        }\n        return this.moveStep(formData, this.nextStep.id, hasError)\n      }\n\n      case NavActionEnum.SUBMIT: {\n        this.props.onSubmit(formData)\n        return\n      }\n      case NavActionEnum.VALIDATE: {\n        //we get here is we clicked validate and the data is valid.\n        // if it's not valid we handle it in onError fn\n        const steps = this.setStepStatusForFailedValidation(\n          [],\n          this.state.steps,\n          !!this.props.isWizardMode,\n          this.state.formData,\n          this.getSchema(this.state.currentStep).properties ||\n            this.getSchema(this.state.currentStep),\n        )\n        const currentStep = {\n          ...this.state.currentStep,\n          state: StepStateEnum.COMPLETED,\n        }\n\n        this.setState({ hasValidated: true, currentStep, steps })\n        if (this.state.isLoadingSaved) {\n          this.moveStep(this.state.formData, steps[0].id, false)\n          this.setState({ isLoadingSaved: false })\n        }\n        return\n      }\n      default:\n        return\n    }\n  }\n\n  //we need to route things through submit - otherwise validation does not kick in\n  // it triggers internal library validation and calls the performAction with the params for action\n  onSubmit = (): any => {\n    this.performAction(\n      this.navAction,\n      this.state.currentStep.state === StepStateEnum.ERROR,\n    )\n  }\n\n  isSubmitScreen = (): boolean => {\n    return this.state.currentStep.final === true && !this.state.isLoadingSaved\n  }\n\n  showExcludeStateWarningModal = (\n    stepId: string,\n    isUpdateFlattenedData: boolean = false,\n  ): void => {\n    this.setState({\n      modalContext: {\n        action: this.toggleExcludeStep,\n        arguments: [stepId, true, isUpdateFlattenedData],\n      },\n    })\n  }\n\n  toggleExcludeStep = (stepId: string, isExclude: boolean): void => {\n    this.setState((prevState, props) => {\n      const steps = prevState.steps.map(stp => {\n        if (stp.id === stepId) {\n          return { ...stp, ...{ excluded: isExclude } }\n        }\n        return stp\n      })\n\n      const formDataUpdated = _.cloneDeep(prevState.formData)\n      const currentStep = _.cloneDeep(prevState.currentStep)\n      //we need this because you can exclude on the ifnal screen so the currentStep.id\n      //is not always the one we need to exclude\n      if (currentStep.id === stepId) {\n        currentStep.excluded = isExclude\n      }\n      //if exluding - blow away the data for the step\n      if (isExclude) {\n        formDataUpdated[stepId] = {}\n        //_.set(formDataUpdated, `${stepId}.included`, false);\n      } else {\n        _.set(formDataUpdated, `${stepId}.included`, true)\n      }\n      return {\n        steps,\n        formData: formDataUpdated,\n        modalContext: undefined,\n        currentStep,\n      }\n    })\n  }\n\n  private renderNotification = (status?: StatusEnum): JSX.Element => {\n    if (status === StatusEnum.SAVE_SUCCESS) {\n      return <div className=\"notification-area\"> Successfully saved </div>\n    }\n    if (status === StatusEnum.SUBMIT_SUCCESS) {\n      return <div className=\"notification-area\"> Successfully submitted </div>\n    }\n    if (status === StatusEnum.PROGRESS) {\n      return <div className=\"notification-area\"> working on it ....</div>\n    }\n    return <></>\n  }\n\n  // displays the text for screens that don't have any form data\n  private renderTextForStaticScreen = (): JSX.Element => {\n    if (!this.state.currentStep.copy) {\n      return <></>\n    }\n    const copy = this.state.currentStep.copy\n    return (\n      <div\n        className=\"static-screen\"\n        dangerouslySetInnerHTML={{ __html: copy! }}\n      />\n    )\n  }\n\n  //displays subheader for forms that can be excluded\n  renderOptionalFormSubheader = (isWizard: boolean = false): JSX.Element => {\n    if (isWizard) {\n      return <></>\n    }\n    const currentStep = this.state.currentStep\n\n    if (currentStep.excluded === true) {\n      return (\n        <div className=\"step-exclude-directions\">\n          This form is currently not included in the submission.\n          <button\n            className=\"btn btn-link\"\n            onClick={() => this.toggleExcludeStep(currentStep.id, false)}\n          >\n            INCLUDE\n          </button>\n        </div>\n      )\n    } else if (currentStep.excluded === false) {\n      return (\n        <div className=\"step-exclude-directions\">\n          This form is currently included in the submission. Enter some data if\n          you have it, or click \"Skip\".\n          <button\n            className=\"btn btn-link\"\n            onClick={() =>\n              this.showExcludeStateWarningModal(this.state.currentStep.id)\n            }\n          >\n            SKIP\n          </button>\n        </div>\n      )\n    }\n    return <></>\n  }\n\n  renderHelpToggle = (\n    currentStep: Step,\n    showHelp: boolean,\n    callbackFn: Function,\n  ): JSX.Element => {\n    if (currentStep.static || currentStep.final) {\n      return <></>\n    }\n    return (\n      <>\n        <label className=\"pull-right toggle-help-label\">\n          <span>Hide help</span>\n          <Switch\n            checkedIcon={false}\n            uncheckedIcon={false}\n            height={20}\n            width={45}\n            className=\"toggle-help\"\n            offColor=\"#ccc\"\n            onChange={() => callbackFn()}\n            checked={showHelp}\n          />\n          <span>Show help</span>\n        </label>\n      </>\n    )\n  }\n\n  runCustomValidation = async (\n    formData: IFormData,\n    currentStep: Step,\n    allSteps: Step[],\n  ): Promise<AjvError[]> => {\n    const errors: AjvError[] = []\n\n    //default - running on current step\n    let rules = currentStep.validationRules || []\n    let data = {\n      [currentStep.id]: formData[currentStep.id],\n    }\n\n    // for final step -- concatenate all rules and run on all data\n    if (currentStep.final) {\n      rules = allSteps.reduce((acc: any, value: Step) => {\n        return value.validationRules && value.validationRules.length > 0\n          ? acc.concat(value.validationRules)\n          : acc\n      }, [])\n      data = _.cloneDeep(formData)\n    }\n\n    if (rules.length === 0) {\n      return []\n    }\n\n    //this is a workaround for inability to define a rule to run on all members of the data array\n    // we define the generic rule with path e.g.\"path\": \".experiments[*].dose_range.dose_range_min\",\n    const allRules: any[] = []\n    rules.forEach(rule => {\n      //take a rule\n      const paramProp = rule.event.params.property\n      // if it's just a normal rule - add it\n      if (paramProp.indexOf('[*]') === -1) {\n        allRules.push(rule)\n      } else {\n        const path = paramProp.split('[*]')[0].substring(1)\n        const data = _.get(formData, path)\n        // generate a rule for each item in the data array by substituting [*] w/ appropriate index\n        if (Array.isArray(data) && typeof data !== 'string') {\n          for (let i = 0; i < data.length; i++) {\n            const newRule = JSON.parse(\n              JSON.stringify(rule).replace(/\\[\\*\\]/g, `[${i}]`),\n            )\n            allRules.push(newRule)\n          }\n        } else {\n          allRules.push(rule)\n        }\n      }\n    })\n    // no we run  all the rules through the engine\n    const engine = new Engine(allRules, {\n      allowUndefinedFacts: true,\n    })\n\n    try {\n      const result: RulesResult = await engine.run(data)\n      const validationEvents = result.events as IRulesValidationEvent[]\n      validationEvents.forEach(event => {\n        const err: AjvError = {\n          ...event.params,\n          ...{\n            params: {},\n            stack: `${event.params.property} ${event.params.message}`,\n          },\n        }\n        errors.push(err)\n      })\n    } catch (error) {\n      console.log(error)\n    }\n\n    return errors\n  }\n\n  transformErrors = (errors: AjvError[]): AjvError[] => {\n    // if we are not in wizard mode and not trying to submit or validate we just want to skip\n    // over the errors and just set the step status\n    // https://github.com/rjsf-team/react-jsonschema-form/issues/1263\n    this.extraErrors.forEach(extraError => {\n      if (!errors.find(error => error.stack === extraError.stack)) {\n        errors.push(extraError)\n      }\n    })\n\n    if (\n      this.navAction !== NavActionEnum.SUBMIT &&\n      this.navAction !== NavActionEnum.VALIDATE &&\n      (!this.props.isWizardMode || this.state.currentStep.final)\n    ) {\n      const currentStep = {\n        ...this.state.currentStep,\n      }\n      if (errors.length > 0) {\n        currentStep.state = StepStateEnum.ERROR\n      } else {\n        currentStep.state = StepStateEnum.COMPLETED\n      }\n\n      this.setState({ currentStep })\n\n      return []\n    }\n\n    // there is an odd behavior in the lib that in cases when we have additional fields depending on enum\n    // value if it's required and not entered we get 3 error: enum, required, and oneOf\n    // so if there is an error Oneof on a parent - ignore it and enum on a child. and just output 'required'\n    // if there is an enum error and there is required with the same prefix remove it\n\n    const reqErrors = errors.filter(error => error.name === 'required')\n    reqErrors.forEach(error => {\n      const parentPath = error.property.substring(\n        0,\n        error.property.lastIndexOf('.'),\n      )\n      _.remove(errors, (error: AjvError) => {\n        return (\n          error.property.indexOf(parentPath) > -1 &&\n          (error.name === 'enum' || error.name === 'oneOf')\n        )\n      })\n    })\n\n    return errors.map(error => {\n      error.message = error.message.replace('property', 'field')\n\n      return error\n    })\n  }\n\n  renderErrorListTemplate = (props: ErrorListProps) => {\n    const { errors } = props\n    const currentLis = errors\n      .map((error, i) => {\n        return renderTransformedErrorObject(\n          this.state.steps,\n          error,\n          this.uiSchema,\n          i,\n          this.props.schema,\n        )\n      })\n      .sort((a, b) => a.order - b.order)\n      .map(li => li.element)\n\n    return (\n      <div className=\"form-error-summary\">\n        <ul className=\"error-detail\">{currentLis}</ul>\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"outter-wrap\">\n        <Prompt\n          when={this.state.hasUnsavedChanges}\n          message={this.unsavedDataWarning}\n        />\n        <Header\n          isSubmitted={this.state.isSubmitted}\n          bodyText={this.state.currentStep.description}\n          title={this.props.formTitle}\n        ></Header>\n        <div>\n          <div className=\"inner-wrap\">\n            <StepsSideNav\n              stepList={this.state.steps}\n              isWizardMode={this.props.isWizardMode}\n              onStepChange={this.triggerStepChange}\n            ></StepsSideNav>\n            {this.state.isLoadingSaved && (\n              <div className=\"text-center\">\n                <span className={'spinner'} />\n              </div>\n            )}\n            <div className=\"form-wrap\">\n              <div className=\"form-title\">{this.state.currentStep.title}</div>\n              {this.renderNotification(this.props.callbackStatus)}\n              <div\n                className={`right-top-actions ${\n                  this.state.isSubmitted ? 'hide' : ''\n                }`}\n              >\n                {!this.state.currentStep.static && (\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-action save pull-right\"\n                    onClick={() => this.triggerAction(NavActionEnum.VALIDATE)}\n                  >\n                    VALIDATE\n                  </button>\n                )}\n                {this.renderHelpToggle(\n                  this.state.currentStep,\n                  this.state.doShowHelp,\n                  () =>\n                    this.setState({\n                      doShowHelp: !this.state.doShowHelp,\n                    }),\n                )}\n                {this.isSubmitScreen() && (\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-action save pull-right\"\n                    disabled={this.state.isSubmitted}\n                    onClick={() => this.triggerAction(NavActionEnum.SUBMIT)}\n                  >\n                    SUBMIT\n                  </button>\n                )}\n              </div>\n              {this.renderOptionalFormSubheader(this.props.isWizardMode)}\n              <div\n                className={\n                  this.isSubmitScreen() || this.state.currentStep.static\n                    ? 'hide-form-only'\n                    : 'wrap'\n                }\n              >\n                {this.state.hasValidated && (\n                  <div className=\"notification-area\">\n                    Great! All required data on this form has been entered.\n                  </div>\n                )}\n                <div\n                  ref={this.formDivRef}\n                  className={`scroll-area ${\n                    this.state.currentStep.excluded ? 'disabled' : ' '\n                  } `}\n                >\n                  <Form\n                    className={\n                      this.state.doShowHelp\n                        ? 'submissionInputForm'\n                        : 'submissionInputForm no-help'\n                    }\n                    liveValidate={false}\n                    formData={this.state.formData}\n                    schema={this.getSchema(this.state.currentStep)}\n                    uiSchema={this.uiSchema}\n                    onSubmit={this.onSubmit}\n                    onChange={args => this.handleOnChange(args)}\n                    onError={args =>\n                      this.onError({\n                        props: args,\n                        form: this.formRef,\n                      })\n                    }\n                    showErrorList={\n                      !!this.state.doShowErrors || !!this.props.isWizardMode\n                    }\n                    ErrorList={this.renderErrorListTemplate}\n                    transformErrors={this.transformErrors}\n                    ref={this.formRef}\n                    disabled={\n                      this.state.currentStep.excluded || this.state.isSubmitted\n                    }\n                  >\n                    <div style={{ display: 'none' }}>\n                      <button type=\"submit\"></button>\n                    </div>\n                  </Form>\n                  {this.renderTextForStaticScreen()}\n                  {!this.props.isWizardMode && (\n                    <NextStepLink\n                      steps={this.state.steps}\n                      nextStepId={this.state.currentStep.default}\n                      onNavAction={(step: Step) => this.triggerStepChange(step)}\n                    ></NextStepLink>\n                  )}\n                </div>\n              </div>\n\n              {this.isSubmitScreen() && (\n                <SummaryTable\n                  formData={this.state.formData}\n                  steps={this.state.steps}\n                  callbackFn={(screenId: string) =>\n                    this.showExcludeStateWarningModal(screenId, true)\n                  }\n                  uiSchema={this.props.uiSchema}\n                  schema={this.props.schema}\n                ></SummaryTable>\n              )}\n\n              <NavButtons\n                currentStep={this.state.currentStep}\n                steps={this.state.steps}\n                previousStepIds={this.state.previousStepIds}\n                isFormSubmitted={this.state.isSubmitted}\n                onNavAction={(e: NavActionEnum) => this.triggerAction(e)}\n              ></NavButtons>\n            </div>\n          </div>\n        </div>\n        {this.state.modalContext && (\n          <WarningModal\n            show={true}\n            title={this.excludeWarningHeader}\n            copy={this.excludeWarningText}\n            className={`theme-${this.props.formClass}`}\n            callbackArgs={this.state.modalContext.arguments}\n            onCancel={() => this.setState({ modalContext: undefined })}\n            onOK={(stepId: string, isExclude: boolean) =>\n              this.toggleExcludeStep(stepId, isExclude)\n            }\n          ></WarningModal>\n        )}\n        <DataDebug formData={this.state.formData} hidden={true}></DataDebug>\n      </div>\n    )\n  }\n}\n\n// takes in a single validation error and  and displays it in more readable manner\n// used by renderErrorListTemplate\nfunction renderTransformedErrorObject(\n  steps: Step[],\n  error: AjvError,\n  uiSchema: UiSchema,\n  i: number,\n  schema: any,\n): { order: number; element: JSX.Element } {\n  const propPath = _.trimStart(error.property, '.')\n  const propArr = propPath.split('.')\n\n  // some things require labels in schema (e.g. checkboxes) so this is preferred\n  const labelFromSchema = `${propArr.join('.properties.')}.title`\n  //can be overriden by label in UI\n  const labelFromUi = `${propPath}.ui:title`\n  //for array fields we need to change the property e.g.\n  //  ld50.experiments[0].species_other should look like 'ld50.experiments.items.species_other'\n  const arrayLabelFromSchema = labelFromSchema.replace(/\\[.*?\\]/, '.items')\n  const arrayLabelFromUI = labelFromUi.replace(/\\[.*?\\]/, '.items')\n  const indexMatch = labelFromSchema.match(/\\[.*?\\]/)\n\n  let index = _.first(indexMatch)\n\n  if (index) {\n    index = index.substring(1, index.length - 1)\n    index = !isNaN(parseInt(index)) ? ` [${parseInt(index) + 1}]` : ''\n  }\n\n  const label =\n    _.get(uiSchema, labelFromUi) ||\n    _.get(schema.properties, labelFromSchema) ||\n    _.get(uiSchema, arrayLabelFromUI) ||\n    _.get(schema.properties, arrayLabelFromSchema) ||\n    error.property\n\n  const screen = _.find(steps, { id: propArr[0] }) || {\n    title: propArr[0],\n    order: 0,\n  }\n  const element = (\n    <li key={i} className=\"\">\n      <span>\n        <strong>\n          {screen.title}\n          {index}:\n        </strong>\n        {label}&nbsp; {error.message}\n      </span>\n    </li>\n  )\n  return { order: screen.order, element }\n}\n\n//recursively sets property value to dangerouslySetInnerHTML of that value\nfunction stringToElementForProp(srcObject: any, key: string): object {\n  _.keys(srcObject).some(k => {\n    if (k === key) {\n      const value = srcObject[k]\n      srcObject[k] = <span dangerouslySetInnerHTML={{ __html: value }}></span>\n\n      return srcObject\n    }\n    if (srcObject[k] && typeof srcObject[k] === 'object') {\n      stringToElementForProp(srcObject[k], key)\n    }\n  })\n  return srcObject\n}\n","import $RefParser from 'json-schema-ref-parser'\nimport { get, includes } from 'lodash-es'\nimport * as React from 'react'\nimport Alert from 'react-bootstrap/Alert'\nimport { UiSchema } from 'react-jsonschema-form'\nimport { SynapseClient } from '../../utils'\nimport { SRC_SIGN_IN_CLASS } from '../../utils/SynapseConstants'\nimport { FileEntity, FormData } from '../../utils/synapseTypes/'\nimport SynapseForm from './SynapseForm'\nimport { StatusEnum } from './types'\n\nexport type UploadToolSearchParams = {\n  formDataId?: string //formDataId for user data form data\n  dataFileHandleId?: string //fileHandle to get userData\n  submitted?: boolean // if the file has been submitted\n  formGroupId: string\n}\n\nexport type SynapseFormWrapperProps = {\n  // Provide the parent container (folder/project), that should contain a folder (named <user_id>) that this user can write to.\n  formSchemaEntityId: string // Synapse file that contains the form schema.\n  formUiSchemaEntityId: string // Synapse file that contains the form ui schema.\n  formNavSchemaEntityId: string //Synapse file that consists screen nav schema\n  token?: string // user's session token\n  searchParams?: UploadToolSearchParams\n  isWizardMode?: boolean // if we are displaying the form in wizard mode\n  fileNamePath: string // path in data to specify the name of saved file\n  formTitle: string //for UI customization\n  formClass?: string // to support potential theaming\n}\n\ntype SynapseFormWrapperState = {\n  notification?: Notification\n  isLoading?: boolean\n  formDataId?: string // file holding user form data\n  formData?: any // form data that prepopulates the form\n  formSchema?: any // schema that drives the form\n  formUiSchema?: UiSchema // ui schema that directs how to render the form elements\n  formNavSchema?: any // drives the steps left panel\n\n  status?: StatusEnum\n}\n\ntype Error = {\n  name?: string\n  message?: string\n}\n\ninterface Notification extends Error {\n  type: StatusEnum\n}\n\nclass SynapseFormWrapper extends React.Component<\n  SynapseFormWrapperProps,\n  SynapseFormWrapperState\n> {\n  constructor(props: SynapseFormWrapperProps) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      formDataId: this.props?.searchParams?.formDataId,\n    }\n  }\n\n  async componentDidMount() {\n    await this.getData(this.props.token)\n  }\n\n  async componentDidUpdate(prevProps: SynapseFormWrapperProps) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      await this.getData(this.props.token)\n    }\n  }\n\n  //gets a file entity with content\n  getFileEntityData = async (\n    token: string,\n    entityId: string,\n    versionNumber?: string,\n  ): Promise<{ version?: number; content: JSON }> => {\n    try {\n      const entity: FileEntity = await SynapseClient.getEntity(\n        token,\n        entityId,\n        versionNumber,\n      )\n      const entityContent = await SynapseClient.getFileEntityContent(\n        token,\n        entity,\n      )\n      const content = JSON.parse(entityContent)\n      return {\n        version: entity.versionNumber,\n        content: content,\n      }\n    } catch (error) {\n      const newError = {\n        message: `${error.message}:  configuration data for ${entityId} failed to load`,\n      }\n      this.onError(newError)\n      return Promise.reject(newError)\n    }\n  }\n\n  //same as above but also uses $RefParser to convert json $refs to regular json\n  getFileEntityDataDereferenced = async (\n    token: string,\n    entityId: string,\n    versionNumber?: string,\n  ): Promise<{ version?: number; content: JSON }> => {\n    const { version, content } = await this.getFileEntityData(\n      token,\n      entityId,\n      versionNumber,\n    )\n    const derefContent = (await $RefParser.dereference(content)) as JSON\n    return {\n      version: version,\n      content: derefContent,\n    }\n  }\n\n  getData = async (token?: string): Promise<void> => {\n    if (!token) {\n      return\n    }\n    try {\n      let formData = {}\n      let dataFileHandleId: string | undefined\n      let submitted: boolean | undefined\n      let formSchemaVersion = undefined\n      let uiSchemaVersion = undefined\n      let navSchemaVersion = undefined\n      const { searchParams } = this.props\n      if (searchParams) {\n        ;({ dataFileHandleId, submitted } = searchParams)\n      }\n\n      //for not new form we need to get the data\n      //and if it is submitted form we need to pull appropriave schema versions\n      //for new form (no dataFileHandleId) we need to populate schema versions\n\n      if (dataFileHandleId) {\n        const fileData = await SynapseClient.getFileHandleContentFromID(\n          dataFileHandleId,\n          token,\n        )\n        formData = JSON.parse(fileData)\n        if (submitted && formData && formData['metadata']) {\n          ;({ formSchemaVersion, uiSchemaVersion, navSchemaVersion } = formData[\n            'metadata'\n          ])\n        }\n      }\n\n      const promises = [\n        this.getFileEntityDataDereferenced(\n          token,\n          this.props.formSchemaEntityId,\n          formSchemaVersion,\n        ),\n        this.getFileEntityData(\n          token,\n          this.props.formUiSchemaEntityId,\n          uiSchemaVersion,\n        ),\n        this.getFileEntityData(\n          token,\n          this.props.formNavSchemaEntityId,\n          navSchemaVersion,\n        ),\n      ]\n      const configData = await Promise.all(promises)\n\n      if (!dataFileHandleId) {\n        //if we are creating a new file - store the versions\n        formData = {\n          metadata: {\n            formSchemaVersion: configData[0].version,\n            uiSchemaVersion: configData[1].version,\n            navSchemaVersion: configData[2].version,\n          },\n        }\n      }\n      this.setState({\n        formData: formData,\n        formSchema: configData[0].content,\n        formUiSchema: configData[1].content,\n        formNavSchema: configData[2].content,\n        isLoading: false,\n      })\n    } catch (error) {\n      this.onError({ message: error })\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  finishedProcessing = (status: StatusEnum, message?: string) => {\n    this.setState({\n      isLoading: false,\n      notification: { type: status, message: message },\n      status: status,\n    })\n    //this will show the update message for 7 seconds\n    setTimeout(() => {\n      this.setState({ status: undefined })\n    }, 7000)\n  }\n\n  onError = (error: Error) => {\n    this.setState({\n      notification: {\n        type: StatusEnum.ERROR,\n        message: error.message,\n        name: error.name,\n      },\n      status: StatusEnum.ERROR,\n      isLoading: false,\n    })\n  }\n\n  submitForm = async (formData: any) => {\n    await this.saveToFile(formData)\n\n    this.setState({\n      isLoading: true,\n    })\n\n    await SynapseClient.submitFormData(this.state.formDataId!, this.props.token)\n    this.finishedProcessing(StatusEnum.SUBMIT_SUCCESS, 'File Submitted')\n  }\n\n  createOrUpdateFormDataFile = async (\n    fileName: string,\n    fileContentsBlob: Blob,\n  ): Promise<FormData> => {\n    fileName = `${fileName}.json`\n    const fileUploadComplete = await SynapseClient.uploadFile(\n      this.props.token,\n      fileName,\n      fileContentsBlob,\n    )\n    const { searchParams } = this.props\n    const formGroupId = searchParams && searchParams.formGroupId\n    if (!formGroupId) {\n      console.error('formGroupId must be defined')\n      throw 'formGroupId must be defined'\n    }\n    try {\n      // do we need to create a new file entity, or update an existing file entity?\n      const newFileHandleId = fileUploadComplete.fileHandleId\n\n      let formData\n      if (this.state.formDataId) {\n        formData = await SynapseClient.updateFormData(\n          this.state.formDataId,\n          fileName,\n          newFileHandleId,\n          this.props.token!,\n        )\n      } else {\n        formData = await SynapseClient.createFormData(\n          formGroupId,\n          fileName,\n          newFileHandleId,\n          this.props.token!,\n        )\n      }\n\n      return formData\n    } catch (error) {\n      this.onError(error)\n      throw error\n    }\n  }\n\n  saveToFile = async (data: any) => {\n    const fileName = get(data, this.props.fileNamePath)\n    this.setState({\n      status: StatusEnum.PROGRESS,\n      notification: { type: StatusEnum.PROGRESS, message: 'Progress' },\n      isLoading: true,\n    })\n\n    if (!fileName) {\n      // try to find corresponding property. By convention it should be first level property\n      // and follow pattern screen.prop\n      let errorTitle = 'File Name'\n      try {\n        // get it to the schema format\n        const searchString = `${this.props.fileNamePath.replace(\n          '.',\n          '.properties.',\n        )}.title`\n        errorTitle = get(\n          this.state.formSchema.properties,\n          searchString,\n          errorTitle,\n        )\n      } finally {\n        const error = `Please Provide the ${errorTitle} before saving`\n        this.onError({ message: error })\n      }\n      return\n    }\n\n    try {\n      const fileContent: Blob = new Blob([JSON.stringify(data)], {\n        type: 'text/json',\n      })\n\n      const formData = await this.createOrUpdateFormDataFile(\n        fileName,\n        fileContent,\n      )\n      this.setState({\n        formDataId: formData.formDataId,\n      })\n\n      this.finishedProcessing(StatusEnum.SAVE_SUCCESS, 'File Saved')\n    } catch (error) {\n      this.onError({ message: error })\n    }\n  }\n\n  isReadyToDisplayForm = (state: SynapseFormWrapperState): boolean => {\n    return (\n      this.state.status !== StatusEnum.ERROR_CRITICAL &&\n      state.formSchema &&\n      state.formUiSchema &&\n      state.formNavSchema &&\n      state.formData\n    )\n  }\n\n  renderLoader = (\n    state: SynapseFormWrapperState,\n    props: SynapseFormWrapperProps,\n  ): JSX.Element => {\n    if (\n      includes([StatusEnum.ERROR, StatusEnum.ERROR_CRITICAL], state.status) &&\n      props.token &&\n      state.isLoading\n    ) {\n      return (\n        <div className=\"text-center\">\n          <span className={'spinner'} />\n        </div>\n      )\n    } else {\n      return <></>\n    }\n  }\n\n  renderNotification = (notification?: Notification): JSX.Element => {\n    if (!notification) {\n      return <></>\n    }\n    if (notification.type === StatusEnum.ERROR) {\n      return (\n        <Alert\n          variant=\"danger\"\n          onClose={() => this.setState({ status: undefined })}\n        >\n          <Alert.Heading>Error</Alert.Heading>\n\n          <p>\n            {notification.name} {notification.message}\n          </p>\n        </Alert>\n      )\n    }\n\n    return <></>\n  }\n\n  renderUnauthenticatedView = (token: string | undefined) => {\n    if (token) {\n      return <></>\n    } else {\n      return (\n        <div className=\"panel padding-full unauthenticated text-center\">\n          Please\n          <button\n            className={`SRC-standard-button-shape SRC-light-button SRC-sign-in-button ${SRC_SIGN_IN_CLASS}`}\n          >\n            sign in\n          </button>\n          to initiate or continue your submission\n        </div>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div className={`theme-${this.props.formClass}`}>\n        <div className=\"SRC-ReactJsonForm\">\n          {this.renderNotification(this.state.notification)}\n          {this.renderLoader(this.state, this.props)}\n          {this.renderUnauthenticatedView(this.props.token)}\n\n          {this.isReadyToDisplayForm(this.state) && (\n            <div>\n              <SynapseForm\n                schema={this.state.formSchema}\n                uiSchema={this.state.formUiSchema!}\n                formData={this.state.formData}\n                navSchema={this.state.formNavSchema}\n                isWizardMode={this.props.isWizardMode}\n                formTitle={this.props.formTitle}\n                formClass={this.props.formClass}\n                callbackStatus={this.state.status}\n                onSave={(data: any) => this.saveToFile(data)}\n                onSubmit={(data: any) => this.submitForm(data)}\n                isSubmitted={\n                  this.props.searchParams && !!this.props.searchParams.submitted\n                }\n              ></SynapseForm>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default SynapseFormWrapper\n","import * as React from 'react'\n\nimport { SynapseClient } from '../../utils'\nimport {\n  FormData,\n  ListRequest,\n  StatusEnum,\n  ListResponse,\n} from '../../utils/synapseTypes/'\nimport { faTrash, faPhone } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport WarningModal from './WarningModal'\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\n\nimport moment from 'moment'\nimport { SRC_SIGN_IN_CLASS } from '../../utils/SynapseConstants'\nimport NoSubmissionsIcon from '../../assets/icons/json-form-tool-no-submissions.svg'\n\n\nexport type SynapseFormSubmissionGridProps = {\n  token?: string\n  formGroupId: string\n  pathpart: string\n  formClass?: string\n  itemNoun: string\n}\n\ntype FileListType = 'IN_PROGRESS' | 'SUBMITTED'\n\ntype SynapseFormSubmissionGridState = {\n  inProgress: {\n    fileList: FormData[]\n    nextPageToken?: string\n  }\n  submitted: {\n    fileList: FormData[]\n    nextPageToken?: string\n  }\n  isLoading: boolean\n  isShowInfoModal: boolean\n  modalContext?: { action: Function; arguments: any[] }\n}\n\nexport default class SynapseFormSubmissionGrid extends React.Component<\n  SynapseFormSubmissionGridProps,\n  SynapseFormSubmissionGridState\n> {\n  modalTitle = 'Trash Submission?'\n  listingText = {\n    inProgress: {\n      subhead: 'In Progress',\n      noRecords: `You don't have submissions in progress`,\n    },\n    submitted: {\n      subhead: 'Submitted',\n      noRecords: `You don't have anything submitted`,\n    },\n  }\n  modalCopy = (\n    <>\n      <p>\n        This submission is currently incomplete and has not been submitted. If\n        you trash this submission, you won't be able to recover the data.\n      </p>\n      <p>Are you sure you want to trash this submission?</p>\n    </>\n  )\n  static requestFilter = {\n    IN_PROGRESS: [StatusEnum.WAITING_FOR_SUBMISSION],\n    SUBMITTED: [\n      StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n      StatusEnum.ACCEPTED,\n      StatusEnum.REJECTED,\n    ],\n  }\n\n  constructor(props: SynapseFormSubmissionGridProps) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      isShowInfoModal: false,\n      inProgress: {\n        fileList: [],\n      },\n      submitted: {\n        fileList: [],\n      },\n    }\n  }\n\n  async componentDidMount() {\n    await this.refresh(this.props.token)\n  }\n\n  async componentDidUpdate(prevProps: SynapseFormSubmissionGridProps) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      await this.refresh(this.props.token)\n    }\n  }\n\n  async refresh(token?: string) {\n    if (token) {\n      await this.getUserFileListing().catch(error => {\n        this.onError(error)\n      })\n    }\n  }\n\n  getTypeFileListing = async (\n    filter: StatusEnum[],\n    nextPageToken?: string,\n  ): Promise<{ fileList: FormData[]; nextPageToken?: string }> => {\n    this.setState({\n      isLoading: true,\n    })\n    const token = this.props.token\n    const groupId = this.props.formGroupId\n    try {\n      const cleanUpName = (item: FormData): FormData => {\n        item = { ...item, ...{ name: item.name.replace('.json', '') } }\n        return item\n      }\n      const request: ListRequest = {\n        filterByState: filter,\n        groupId,\n        nextPageToken: nextPageToken,\n      }\n\n      const response: ListResponse = await SynapseClient.listFormData(\n        request,\n        token,\n      )\n      const fileList = response.page\n        ? response.page.map(item => cleanUpName(item))\n        : []\n\n      return {\n        fileList,\n        nextPageToken: response.nextPageToken,\n      }\n    } catch (error) {\n      this.onError(error)\n      return Promise.reject(error)\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  getMore = async (fileListType: FileListType, nextPageToken: string) => {\n    const statusList =\n      fileListType === 'SUBMITTED'\n        ? SynapseFormSubmissionGrid.requestFilter.SUBMITTED\n        : SynapseFormSubmissionGrid.requestFilter.IN_PROGRESS\n    const result = await this.getTypeFileListing(statusList, nextPageToken)\n    if (fileListType === 'SUBMITTED') {\n      this.setState(prevState => ({\n        submitted: {\n          fileList: [...prevState.submitted.fileList, ...result.fileList],\n          nextPageToken: result.nextPageToken,\n        },\n      }))\n    } else {\n      this.setState(prevState => ({\n        inProgress: {\n          fileList: [...prevState.inProgress.fileList, ...result.fileList],\n          nextPageToken: result.nextPageToken,\n        },\n      }))\n    }\n  }\n\n  getUserFileListing = async (): Promise<void> => {\n    const inProgress = await this.getTypeFileListing(\n      SynapseFormSubmissionGrid.requestFilter.IN_PROGRESS,\n      this.state.inProgress.nextPageToken,\n    )\n    const submitted = await this.getTypeFileListing(\n      SynapseFormSubmissionGrid.requestFilter.SUBMITTED,\n      this.state.submitted.nextPageToken,\n    )\n\n    this.setState({\n      inProgress: inProgress,\n      submitted: submitted,\n    })\n\n    return\n  }\n  onError = (args: any) => {\n    console.log(args)\n  }\n\n  deleteFile = async (token: string, formDataId: string): Promise<any> => {\n    this.setState({\n      isLoading: true,\n      modalContext: undefined,\n    })\n    try {\n      await SynapseClient.deleteFormData(formDataId, token)\n      //await this.getUserFileListing(token, this.props.formGroupId)\n      this.setState((prevState, props) => ({\n        inProgress: {\n          fileList: prevState.inProgress.fileList.filter(\n            item => item.formDataId !== formDataId,\n          ),\n          nextPageToken: prevState.inProgress.nextPageToken,\n        },\n      }))\n    } catch (error) {\n      this.onError(error)\n      return []\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  setModalConfirmationState = (token: string, formDataId: string) => {\n    this.setState({\n      modalContext: {\n        action: this.deleteFile,\n        arguments: [token, formDataId],\n      },\n    })\n  }\n  /* ------------------------------------------   rendering fns  ------------------------------------------------*/\n\n  renderLoading = (\n    token: string | undefined,\n    isLoading: boolean,\n  ): JSX.Element => {\n    if (token && isLoading) {\n      return (\n        <div className=\"text-center\">\n          <span>Loading&hellip;</span>\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        </div>\n      )\n    } else {\n      return <></>\n    }\n  }\n\n  renderUnauthenticatedView = (token: string | undefined) => {\n    if (token) {\n      return <></>\n    } else {\n      return (\n        <div className=\"file-grid\">\n          <h3>Your Submissions</h3>\n          <div className=\"panel padding-full unauthenticated text-center\">\n          <p className=\"padding-full\">Please sign in or register to initiate or continue your submission</p>\n            <button className={`btn btn-large ${SRC_SIGN_IN_CLASS}`}>\n              sign in\n            </button>\n          </div>\n        </div>\n      )\n    }\n  }\n\n  renderSubmissionsTable = (\n    fileList: FormData[],\n    pathpart: string,\n    formGroupId: string,\n    fileListType: FileListType,\n    nextPageToken?: string,\n  ): JSX.Element => {\n    if (!formGroupId) {\n      this.onError('Form Group ID is undefined')\n      return <></>\n    }\n    const isInProgress = fileListType === 'IN_PROGRESS'\n    const textSource = isInProgress\n      ? this.listingText.inProgress\n      : this.listingText.submitted\n\n    const subhead = <h4>{textSource.subhead}</h4>\n    const tableTitleRow = isInProgress ? (\n      <tr>\n        <th>Submission Name</th>\n        <th>Edited On</th>\n        <th></th>\n        <th></th>\n      </tr>\n    ) : (\n      <tr>\n        <th>Submission Name</th>\n        <th>Submitted On</th>\n        <th>Status</th>\n        <th></th>\n      </tr>\n    )\n\n    let content = (\n      <h5 className=\"text-center no-submissions padding-full\">\n        {textSource.noRecords}\n      </h5>\n    )\n    const viewMore = nextPageToken ? (\n      <div className=\"view-more\">\n        <button\n          className=\"btn btn-link\"\n          onClick={() => this.getMore(fileListType, nextPageToken)}\n        >\n          more ...\n        </button>\n      </div>\n    ) : (\n      <></>\n    )\n    if (fileList.length > 0) {\n      content = (\n        <div className=\"file-table\" key={`table${fileListType}`}>\n          <table className=\"table\">\n            <thead>{tableTitleRow}</thead>\n            <tbody>\n              {fileList.map((dataFileRecord, key) => {\n                if (isInProgress) {\n                  return (\n                    <tr key={dataFileRecord.formDataId! + key + fileListType}>\n                      <td>\n                        <a\n                          href={`${pathpart}?formGroupId=${formGroupId}&formDataId=${dataFileRecord.formDataId}&dataFileHandleId=${dataFileRecord.dataFileHandleId}`}\n                        >\n                          {dataFileRecord.name}\n                        </a>\n                      </td>\n                      <td>{moment(dataFileRecord.modifiedOn).calendar()}</td>\n                      <td>&nbsp;</td>\n                      <td className=\"text-right\">\n                        <button\n                          className=\"btn\"\n                          aria-label=\"delete\"\n                          onClick={() =>\n                            this.setModalConfirmationState(\n                              this.props.token!,\n                              dataFileRecord.formDataId!,\n                            )\n                          }\n                        >\n                          <FontAwesomeIcon\n                            icon={faTrash}\n                            aria-hidden=\"true\"\n                          ></FontAwesomeIcon>\n                        </button>\n                      </td>\n                    </tr>\n                  )\n                } else {\n                  return (\n                    <tr key={dataFileRecord.formDataId! + key}>\n                      <td>\n                        <a\n                          href={`${pathpart}?formGroupId=${formGroupId}&formDataId=${dataFileRecord.formDataId}&dataFileHandleId=${dataFileRecord.dataFileHandleId}&submitted=1`}\n                        >\n                          {dataFileRecord.name}\n                        </a>\n                      </td>\n                      <td>{moment(dataFileRecord.modifiedOn).calendar()}</td>\n                      <td>{dataFileRecord.submissionStatus.state}</td>\n                      <td className=\"text-right\">\n                        <button\n                          className=\"btn\"\n                          aria-label=\"information\"\n                          onClick={() =>\n                            this.setState({ isShowInfoModal: true })\n                          }\n                        >\n                          <FontAwesomeIcon\n                            icon={faPhone}\n                            aria-hidden=\"true\"\n                          ></FontAwesomeIcon>\n                        </button>\n                      </td>\n                    </tr>\n                  )\n                }\n              })}\n            </tbody>\n          </table>\n          {viewMore}\n        </div>\n      )\n    }\n    return (\n      <div key={`grid-${fileListType}`}>\n        {subhead} {content}\n      </div>\n    )\n  }\n\n  renderSubmissionsTables = (\n    inProgress: { fileList: FormData[]; nextPageToken?: string },\n    submitted: { fileList: FormData[]; nextPageToken?: string },\n    pathpart: string,\n    formGroupId: string,\n  ): JSX.Element[] | JSX.Element => {\n    if (inProgress.fileList.length === 0 && submitted.fileList.length === 0) {\n      return (\n        <div className=\"text-center\">\n          <img src={NoSubmissionsIcon} alt=\"no submissions\"></img>\n          <p className=\"padding-full\">You have no submissions</p>\n        </div>\n      )\n    } else {\n      return [\n        this.renderSubmissionsTable(\n          inProgress.fileList,\n          pathpart,\n          formGroupId,\n          'IN_PROGRESS',\n          inProgress.nextPageToken,\n        ),\n\n       this.renderSubmissionsTable(\n          submitted.fileList,\n          pathpart,\n          formGroupId,\n          'SUBMITTED',\n          submitted.nextPageToken,\n        ),\n      ]\n    }\n  }\n\n  render() {\n    return (\n      <div className={`theme-${this.props.formClass}`}>\n        <div className=\"SRC-ReactJsonForm\">\n          {this.renderLoading(this.props.token, this.state.isLoading)}\n          {this.renderUnauthenticatedView(this.props.token)}\n\n          {!this.state.isLoading && (\n            <div className=\"file-grid \">\n              <h3>Your Submissions</h3>\n              <div className=\"panel panel-default padding-full\">\n                {this.renderSubmissionsTables(\n                  this.state.inProgress,\n                  this.state.submitted,\n                  this.props.pathpart,\n                  this.props.formGroupId,\n                )}\n\n                <div className=\"text-center\">\n                  <a\n                    className=\"btn btn-large\"\n                    href={`${this.props.pathpart}?formGroupId=${this.props.formGroupId}`}\n                  >\n                    Add new {this.props.itemNoun}\n                  </a>\n                </div>\n              </div>\n            </div>\n          )}\n          {this.state.modalContext && (\n            <WarningModal\n              className={`theme-${this.props.formClass}`}\n              show={typeof this.state.modalContext !== 'undefined'}\n              title={this.modalTitle}\n              copy={this.modalCopy}\n              callbackArgs={this.state.modalContext.arguments}\n              onCancel={() => this.setState({ modalContext: undefined })}\n              onOK={(token: string, formDataId: string) =>\n                this.deleteFile(token, formDataId)\n              }\n            />\n          )}\n\n          <Modal\n            show={this.state.isShowInfoModal}\n            animation={false}\n            className={`theme-${this.props.formClass}`}\n          >\n            <Modal.Header\n              closeButton={false}\n              onHide={() => this.setState({ isShowInfoModal: false })}\n            >\n              <Modal.Title>More Information</Modal.Title>\n            </Modal.Header>\n            <Modal.Body>\n              Please <a href=\"mailto:ModelAD@iupui.edu\">contact us</a> for more\n              information about your submission\n            </Modal.Body>\n            <Modal.Footer>\n              <Button\n                variant=\"success\"\n                onClick={() => this.setState({ isShowInfoModal: false })}\n              >\n                OK\n              </Button>\n            </Modal.Footer>\n          </Modal>\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { SynapseClient, SynapseConstants } from '../utils'\nimport { getNextPageOfData } from '../utils/functions/queryUtils'\nimport {\n  insertConditionsFromSearchParams,\n  KeyValue,\n  SQLOperator,\n} from '../utils/functions/sqlFunctions'\nimport { QueryBundleRequest, QueryResultBundle } from '../utils/synapseTypes/'\nimport CardContainer from './CardContainer'\nimport { GenericCardSchema, IconOptions } from './GenericCard'\n// TODO: this import nearly doubles the package size of SRC as a UMD build by ~400KB\n// will have to find a way to use individual lodash packages instead of the entire thing\nimport { cloneDeep, isEqual } from 'lodash-es'\nexport interface CardLink {\n  baseURL: string\n  // the key that will go into the url\n  URLColumnName: string\n  // the column name who's value will be used\n  matchColumnName: string\n  isMarkdown: false\n}\n\nexport type MarkdownLink = {\n  isMarkdown: true\n  // the columns whos value will be used for the markdown\n  matchColumnName: string\n}\n\nexport type MarkdownValue = {\n  isMarkdown: true\n}\n\n// Specify the indices in the values [] that should be rendered specially\nexport type LabelLinkConfig = (MarkdownLink | CardLink)[]\n\nexport type CommonCardProps = {\n  genericCardSchema?: GenericCardSchema\n  secondaryLabelLimit?: number\n  titleLinkConfig?: CardLink\n  labelLinkConfig?: LabelLinkConfig\n  descriptionLinkConfig?: MarkdownValue\n}\n\nexport type CardConfiguration = {\n  type: string\n  hasInternalLink?: boolean\n  iconOptions?: IconOptions\n  loadingScreen?: React.FunctionComponent | JSX.Element\n} & CommonCardProps\n\nexport type CardContainerLogicProps = {\n  token?: string\n  limit?: number\n  title?: string\n  unitDescription?: string\n  sqlOperator?: SQLOperator\n  searchParams?: KeyValue\n  facet?: string\n  entityId: string\n  facetAliases?: {}\n  backgroundColor?: string\n  isHeader?: boolean\n  isAlignToLeftNav?: boolean\n  sql: string\n} & CardConfiguration\n\ntype State = {\n  data: QueryResultBundle | undefined\n  isLoading: boolean\n  queryRequest: QueryBundleRequest\n  totalResultsNoFacet: number\n  hasMoreData: boolean\n}\n\n/**\n * Class wraps around CardContainer and serves as a standalone logic container for rendering cards.\n * This same logic exists in QueryWrapper, but the two serve two distinct purposes, making this component\n * sufficiently distinct.\n *\n * @class CardContainerLogic\n * @extends {React.Component}\n */\nexport default class CardContainerLogic extends React.Component<\n  CardContainerLogicProps,\n  State\n> {\n  public static defaultProps = {\n    token: '',\n  }\n\n  public static defaultState = {\n    data: undefined,\n    isLoading: true,\n    queryRequest: {} as QueryBundleRequest,\n    totalResultsNoFacet: 0,\n    hasMoreData: true,\n  }\n\n  constructor(props: CardContainerLogicProps) {\n    super(props)\n    this.executeInitialQueryRequest = this.executeInitialQueryRequest.bind(this)\n    this.getLastQueryRequest = this.getLastQueryRequest.bind(this)\n    this.getNextPageOfData = this.getNextPageOfData.bind(this)\n    this.state = CardContainerLogic.defaultState\n  }\n\n  /**\n   * Compute default query request\n   *\n   * @memberof QueryWrapper\n   */\n  public componentDidMount() {\n    this.executeInitialQueryRequest()\n  }\n\n  /**\n   * @memberof QueryWrapper\n   *\n   */\n  public componentDidUpdate(prevProps: CardContainerLogicProps) {\n    /**\n     *  If token has changed (they signed in) or sql query has changed\n     *  or search params have updated then perform an update.\n     */\n    const { searchParams: prevSearchParams = {} } = prevProps\n    const { searchParams: currentSearchParams = {} } = this.props\n    const hasSearchParamsChanged = !isEqual(\n      prevSearchParams,\n      currentSearchParams,\n    )\n    const hasTokenBeenAquired =\n      this.props.token !== '' && prevProps.token === ''\n    const hasSqlChanged = this.props.sql !== prevProps.sql\n    if (hasTokenBeenAquired || hasSqlChanged || hasSearchParamsChanged) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * last query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getLastQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.state.queryRequest)\n  }\n\n  /**\n   * Grab the next page of data, pulling in 25 more rows.\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public async getNextPageOfData(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true,\n    })\n\n    await getNextPageOfData(\n      queryRequest,\n      this.state.data!,\n      this.props.token,\n    ).then(newState => {\n      this.setState({\n        ...newState,\n        isLoading: false,\n        queryRequest: cloneDeep(queryRequest),\n      })\n    })\n  }\n\n  /**\n   * Execute the initial query passed into the component\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeInitialQueryRequest() {\n    this.setState({\n      isLoading: true,\n    })\n\n    let sqlUsed = this.props.sql\n    if (this.props.searchParams) {\n      sqlUsed = insertConditionsFromSearchParams(\n        this.props.searchParams,\n        this.props.sql,\n        this.props.sqlOperator,\n      )\n    }\n    const entityId = this.props.entityId\n\n    // we don't set this in the state because it hardcodes the sql query, on componentDidUpdate\n    // we need the sql to change\n    const initQueryRequest: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask:\n        SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n        SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n        SynapseConstants.BUNDLE_MASK_QUERY_RESULTS |\n        SynapseConstants.BUNDLE_MASK_QUERY_COUNT,\n      entityId,\n      query: {\n        sql: sqlUsed,\n        isConsistent: false,\n        limit: 25,\n        offset: 0,\n      },\n    }\n\n    SynapseClient.getQueryTableResults(initQueryRequest, this.props.token)\n      .then((data: QueryResultBundle) => {\n        const queryRequestWithoutCount = cloneDeep(initQueryRequest)\n        queryRequestWithoutCount.partMask =\n          SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n          SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n          SynapseConstants.BUNDLE_MASK_QUERY_RESULTS\n\n        const hasMoreData =\n          data.queryResult.queryResults.rows.length ===\n          SynapseConstants.PAGE_SIZE\n        const newState = {\n          hasMoreData,\n          data,\n          queryRequest: queryRequestWithoutCount,\n          isLoading: false,\n          totalResultsNoFacet: data.queryCount!,\n        }\n        this.setState(newState)\n      })\n      .catch(err => {\n        console.log('Failed to get data ', err)\n      })\n  }\n\n  /**\n   * Render the children without any formatting\n   */\n  public render() {\n    // only forward the necessary props\n    const { sql, searchParams, token, ...rest } = this.props\n    return (\n      <CardContainer\n        {...rest}\n        data={this.state.data}\n        token={token}\n        getLastQueryRequest={this.getLastQueryRequest}\n        getNextPageOfData={this.getNextPageOfData}\n        hasMoreData={this.state.hasMoreData}\n        isLoading={this.state.isLoading}\n      />\n    )\n  }\n}\n","import * as React from 'react'\nimport { library, IconProp } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faLongArrowAltUp,\n  faLongArrowAltDown,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport Parser from 'rss-parser'\nlibrary.add(faLongArrowAltUp)\nlibrary.add(faLongArrowAltDown)\nlet rssParser = new Parser()\ntype RssState = {\n  rssFeed: any\n  isLoadingError: boolean\n  isShowingMoreItems: boolean\n  itemId2MoreItem: {}\n}\n\nexport type RssFeedProps = {\n  url: string\n  defaultItemsToShow: number\n}\n\nconst parser = new DOMParser()\n\nexport default class RssFeed extends React.Component<RssFeedProps, RssState> {\n  // only update the state if this component is mounted\n  _isMounted = false\n  \n  constructor(props: RssFeedProps) {\n    super(props)\n    this.state = {\n      rssFeed: {},\n      isLoadingError: false,\n      isShowingMoreItems: false,\n      itemId2MoreItem: {},\n    }\n  }\n  \n  componentDidMount() {\n    this._isMounted = true\n    const { url } = this.props\n    fetch(url)\n      .then(response => response.text())\n      .then(responseData => rssParser.parseString(responseData))\n      .then(rss => {\n        if (this._isMounted) {\n          this.setState({ rssFeed: rss })\n        }\n      })\n      .catch(err => {\n        if (this._isMounted) {\n          this.setState({ isLoadingError: true })\n        }\n      })\n  }\n\n  componentWillUnmount() {\n    this._isMounted = false\n  }\n  public onToggleReadMore = (itemId: string) => (\n    event: React.SyntheticEvent<HTMLButtonElement>,\n  ) => {\n    let feedItemContentDiv = document.getElementById(itemId)\n    if (!this.state.itemId2MoreItem[itemId]) {\n      this.state.itemId2MoreItem[itemId] = {\n        text: 'View full post',\n        icon: 'long-arrow-alt-down',\n      }\n    }\n    const isShow: boolean = this.state.itemId2MoreItem[itemId].text.includes(\n      'View full post',\n    )\n    if (feedItemContentDiv) {\n      let foundMoreItem: boolean = false\n      // hide or show the elements after the More element\n      for (let i = 0; i < feedItemContentDiv.children.length; i++) {\n        // skip over children until we find the id that starts with 'more-'\n        let child = feedItemContentDiv.children[i]\n        if (foundMoreItem) {\n          if (isShow) {\n            child.classList.remove('hidden')\n          } else {\n            child.classList.add('hidden')\n          }\n        } else {\n          foundMoreItem = child.id.includes('more-')\n        }\n      }\n    }\n    // toggle, by updating text and icon\n    const newText: string = isShow ? 'Hide' : 'View full post'\n    const newIcon: IconProp = isShow\n      ? 'long-arrow-alt-up'\n      : 'long-arrow-alt-down'\n    this.state.itemId2MoreItem[itemId] = {\n      text: newText,\n      icon: newIcon,\n    }\n    this.setState({ itemId2MoreItem: this.state.itemId2MoreItem })\n  }\n\n  public onClickShowMoreItems = () => (\n    event: React.SyntheticEvent<HTMLButtonElement>,\n  ) => {\n    this.setState({ isShowingMoreItems: true })\n  }\n\n  render() {\n    return (\n      <ul className=\"srcRssFeed\">\n        {this.state.rssFeed.items &&\n          this.state.rssFeed.items.map((item: any, index: any) => {\n            // There are 2 \"more\" buttons here.  One is to hide long article content.  See moreElement and onClickReadMore()\n            // The other is to hide the large number of items in a particular feed (usually a max of 10 are returned).  See state.isShowingMoreItems\n            let parsedHtml = parser.parseFromString(\n              item['content:encoded'],\n              'text/html',\n            )\n            let bodyElement = parsedHtml.querySelector('body')\n            let moreElement = parsedHtml.querySelector('[id^=\"more-\"]')\n            if (moreElement && bodyElement) {\n              let foundMoreElement = false\n              const children = bodyElement.children\n              for (let i = 0; i < children.length; i++) {\n                let child = children[i]\n                if (foundMoreElement) {\n                  child.classList.add('hidden')\n                }\n                if (child === moreElement) {\n                  foundMoreElement = true\n                }\n              }\n            }\n            let isItemVisible: boolean =\n              index < this.props.defaultItemsToShow ||\n              this.state.isShowingMoreItems\n\n            let showMoreText: string = 'View full post'\n            let showMoreIcon: IconProp = 'long-arrow-alt-down'\n            if (this.state.itemId2MoreItem[item.guid]) {\n              showMoreText = this.state.itemId2MoreItem[item.guid].text\n              showMoreIcon = this.state.itemId2MoreItem[item.guid].icon\n            }\n            return (\n              <li\n                key={item.guid}\n                className={`srcRssFeedItem ${isItemVisible ? '' : 'hidden'}`}\n              >\n                <div className=\"srcRssFeedItemContent\">\n                  <div\n                    id={item.guid}\n                    dangerouslySetInnerHTML={{\n                      __html: parsedHtml.documentElement.innerHTML,\n                    }}\n                  ></div>\n                  {moreElement && (\n                    <div className=\"clearfix\">\n                      <button\n                        style={{\n                          textAlign: 'left',\n                          margin: 0,\n                          padding: '0px 50px 25px 35px',\n                        }}\n                        className=\"SRC-primary-text-color SRC-basicButton SRC-floatRight\"\n                        onClick={this.onToggleReadMore(item.guid)}\n                      >\n                        {showMoreText}\n                        <FontAwesomeIcon\n                          key={`${item.guid}${index}`}\n                          style={{ marginLeft: '5px' }}\n                          icon={showMoreIcon}\n                        />\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </li>\n            )\n          })}\n        {this.state.rssFeed.items &&\n          this.state.rssFeed.items.length > this.props.defaultItemsToShow &&\n          !this.state.isShowingMoreItems && (\n            <div className=\"clearfix\">\n              <button\n                className=\"btn SRC-grayBackground SRC-roundBorder SRC-floatRight\"\n                onClick={this.onClickShowMoreItems()}\n              >\n                View All\n              </button>\n            </div>\n          )}\n        {this.state.isLoadingError && (\n          <div>Unable to load feed: {this.props.url}</div>\n        )}\n      </ul>\n    )\n  }\n}\n","import * as React from 'react'\n\nexport type TwitterFeedProps = {\n  href: string\n}\n\nexport default class TwitterFeed extends React.Component<TwitterFeedProps> {\n  constructor(props: TwitterFeedProps) {\n    super(props)\n  }\n\n  componentDidMount() {\n    if (typeof (window as any).twttr !== 'undefined') {\n      ;(window as any).twttr.widgets.load(\n        document.getElementById(this.props.href),\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        <a\n          id={this.props.href}\n          className=\"twitter-timeline\"\n          data-height=\"600\"\n          data-theme=\"light\"\n          href={this.props.href}\n        ></a>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport RssFeed from './RssFeed'\nimport TwitterFeed from './TwitterFeed'\nimport MailchimpSubscribe from 'react-mailchimp-subscribe'\nimport { KeyValue } from '../utils/functions/sqlFunctions'\nimport { isEqual } from 'lodash-es'\nimport { Link } from 'react-router-dom'\n\nexport type MenuConfig = {\n  feedName: string\n  feedDescription: string\n  feedUrl: string\n  feedKeyValue?: KeyValue\n  defaultItemsToShow: number\n  mailChimpListName?: string\n  mailChimpUrl?: string\n  twitterFeedUrl?: string\n}\nexport type NewsFeedMenuProps = {\n  menuConfig: MenuConfig[]\n  searchParams?: KeyValue\n  routeToNewsFeed: string // news feed nav bar links are hardcoded to this route, with query params set to the selected menu config key/value\n}\n\nexport default class NewsFeedMenu extends React.Component<\n  NewsFeedMenuProps,\n  {}\n> {\n  constructor(props: NewsFeedMenuProps) {\n    super(props)\n    this.getMenuIndex = this.getMenuIndex.bind(this)\n  }\n\n  public render() {\n    const menuIndex = this.getMenuIndex()\n    const menuDropdown = this.renderMenu()\n    const { menuConfig } = this.props\n    const {\n      feedName,\n      feedDescription,\n      feedUrl,\n      feedKeyValue,\n      defaultItemsToShow,\n      mailChimpUrl,\n      twitterFeedUrl,\n      mailChimpListName,\n    } = menuConfig[menuIndex]\n    let modifiedFeedUrl = feedUrl\n    if (feedKeyValue) {\n      Object.getOwnPropertyNames(feedKeyValue).forEach(key => {\n        modifiedFeedUrl = `${modifiedFeedUrl}&${key}=${feedKeyValue[key]}`\n      })\n    }\n    return (\n      <div className=\"row\">\n        <div className=\"col-xs-2 SRC-menuLayout SRC-menuPadding\">\n          {menuDropdown}\n        </div>\n        <div className=\"col-xs-10\">\n          {\n            <>\n              {mailChimpUrl && (\n                <div className=\"SRC-mailchimpSubscribeContainer\">\n                  <h4>Subscribe</h4>\n                  <p className=\"SRC-marginBottomTop\">\n                    Subscribe to receive the {mailChimpListName} by e-mail,\n                    which provides information and updates related to the\n                    Portal. You can opt out at any time by using the unsubscribe\n                    link within the e-mail. We will not share your information\n                    with any third parties or use it for any other purposes.\n                  </p>\n                  <div className=\"SRC-marginBottomTop\">\n                    <MailchimpSubscribe url={mailChimpUrl} />\n                  </div>\n                </div>\n              )}\n              <h3 className=\"srcRssFeed\">{feedName}</h3>\n              <p>{feedDescription}</p>\n              <RssFeed\n                key={modifiedFeedUrl}\n                url={modifiedFeedUrl}\n                defaultItemsToShow={defaultItemsToShow}\n              />\n            </>\n          }\n          {twitterFeedUrl && <TwitterFeed href={twitterFeedUrl} />}\n        </div>\n      </div>\n    )\n  }\n\n  getMenuIndex = () => {\n    let menuIndex = 0\n    if (this.props.searchParams) {\n      // do the search params match a menu config?\n      this.props.menuConfig.forEach((config, index) => {\n        if (\n          config.feedKeyValue &&\n          isEqual(this.props.searchParams, config.feedKeyValue)\n        ) {\n          menuIndex = index\n        }\n      })\n    }\n    return menuIndex\n  }\n\n  private renderMenu() {\n    const menuIndex = this.getMenuIndex()\n    const { menuConfig, routeToNewsFeed } = this.props\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const isSelected: boolean = index === menuIndex\n      const style: any = {}\n      let selectedStyling: string = ''\n      if (isSelected) {\n        selectedStyling =\n          'SRC-pointed SRC-whiteText SRC-primary-background-color SRC-pointed-triangle-right SRC-primary-background-color-border-left'\n      } else {\n        selectedStyling = 'SRC-blackText SRC-light-background'\n      }\n      const urlParams = new URLSearchParams(window.location.search)\n      if (config.feedKeyValue) {\n        Object.getOwnPropertyNames(config.feedKeyValue).forEach(key => {\n          urlParams.set(key, config.feedKeyValue![key])\n        })\n      }\n      return (\n        <Link\n          key={config.feedName}\n          className={`SRC-hand-cursor SRC-menu-button-base SRC-gap SRC-hoverWhiteText SRC-primary-background-color-hover ${selectedStyling}`}\n          role=\"button\"\n          tabIndex={0}\n          style={style}\n          to={{\n            pathname: routeToNewsFeed,\n            search: urlParams + '',\n          }}\n        >\n          {config.feedName}\n        </Link>\n      )\n    })\n  }\n}\n","import React, { FunctionComponent/*, useState , useEffect */ } from 'react' // importing FunctionComponent\nimport Plotly from 'plotly.js-basic-dist'\nimport * as PlotlyTyped from 'plotly.js'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { GraphItem, PlotStyle, Dictionary} from './types'\nimport _ from 'lodash-es'\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type DotPlotProps = {\n  plotData: GraphItem[]\n  layoutConfig: Partial<PlotlyTyped.Layout>\n  optionsConfig: Partial<PlotlyTyped.Config>\n  label?: string, \n  style?: React.CSSProperties\n  id: string,\n  isLegend?: boolean,\n  isXAxis?: boolean,\n  xMax?: number,\n  plotStyle?: PlotStyle,\n  markerSymbols?: Dictionary\n  onClick?: Function\n}\n\n\ntype LayoutOptions = {\n  isLegend: boolean\n  isXAxis: boolean\n  maxValue?: number\n  backgroundColor?: string\n}\n\nfunction getLayout(\n  dotPlotLayoutConfig: Partial<PlotlyTyped.Layout>,\n  layoutOptions?: LayoutOptions,\n): Partial<PlotlyTyped.Layout> {\n  const result = _.cloneDeep(dotPlotLayoutConfig)\n  if (!layoutOptions) {\n    return result\n  }\n  if (layoutOptions.backgroundColor) {\n    result.plot_bgcolor = layoutOptions.backgroundColor\n  }\n  result.yaxis!.showticklabels = false\n  result.xaxis!.range = [-5, layoutOptions.maxValue! + 30]\n  result.xaxis!.visible = layoutOptions.isXAxis\n  result.showlegend = layoutOptions.isLegend\n  result.margin = {\n    t: 0,\n    b: layoutOptions.isXAxis ? 50 : 0,\n    l: 0,\n    r: 0,\n    pad: 15,\n  }\n  let height = 30\n  if (layoutOptions.isLegend) {\n    height = 35\n    result.margin.pad = 0\n    result.xaxis = {\n      visible: false,\n      zeroline: false,\n      showgrid: false,\n      showline: false,\n      range: [0, 1],\n    }\n\n    result.yaxis = {\n      visible: false,\n      showline: false,\n    }\n  }\n  if (layoutOptions.isXAxis) {\n    result.yaxis = {\n      visible: false,\n      showgrid: false,\n      showline: false,\n    }\n    height = 50\n  }\n\n  result.height = height\n\n  return result\n}\n\nfunction createArrayOfGroupValues(\n  headers: string[],\n  items: GraphItem[],\n): any[] {\n  const result = new Array(headers.length)\n  items.forEach(item => {\n    const index = headers.indexOf(item.y)\n    result[index] = item.x\n  })\n  return result\n}\n\nfunction getPlotDataPoints(\n  graphItems: GraphItem[],\n  plotStyle: PlotStyle,\n  ySorted?: string[],\n  markerSymbols?: Dictionary\n): any[] {\n  const isFakeData = ySorted === undefined\n  var groups = _.uniq(graphItems.map(item => item.group))\n  let data: any = []\n  let defaultSymbols = [\n    'y-down',\n    'triangle-up',\n    'cross-thin-open',\n    'triangle-up-open-dot',\n    'star-square-open',\n    'diamond-x',\n  ]\n\n  groups.forEach((group, i) => {\n    data.push({\n      type: 'scatter',\n\n      x: isFakeData\n        ? [-10]  // fake datavalue outside of the bounds\n        : createArrayOfGroupValues(\n            ySorted!,\n            graphItems.filter(row => row.group === group),\n          ),\n      y: ySorted,\n      text: [group],\n      hovertemplate: `%{x} %{text}<extra></extra>`,\n      mode: 'markers',\n      name: group,\n      marker: {\n        color: plotStyle.markerFill,\n        line: {\n          color: plotStyle.markerLine,\n          width: 1,\n        },\n     \n        symbol: markerSymbols? markerSymbols[group] : defaultSymbols[i],\n        size: plotStyle.markerSize,\n      },\n    })\n  })\n  return data\n}\n\nconst DotPlot: FunctionComponent<DotPlotProps> = ({\n  plotData,\n  optionsConfig,\n  layoutConfig,\n  label,\n  id,\n  xMax,\n  style = { width: '100%', height: '100%' },\n  markerSymbols,\n  plotStyle= { markerFill: '#515359', markerLine: '#515359', markerSize: 9, backgroundColor: 'transparent'},\n  onClick, isLegend= false, isXAxis = false\n}: DotPlotProps) => {\n  const pointsTypes = label? [label]: undefined\n\n  return (\n    <Plot\n      key={`dotPlot_${id}`}\n      layout={getLayout(layoutConfig, {\n        isLegend: isLegend,\n        isXAxis: isXAxis,\n        maxValue: xMax,\n        backgroundColor: plotStyle.backgroundColor\n      })}\n      style={style}\n      data={getPlotDataPoints(plotData, plotStyle, pointsTypes, markerSymbols )}\n      config={optionsConfig}\n      onClick={(e: any) => onClick? onClick(e): _.noop}\n    />\n  )\n}\n\nexport default DotPlot\n","import React, { FunctionComponent } from 'react'\nimport Plotly from 'plotly.js-basic-dist'\nimport * as PlotlyTyped from 'plotly.js'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { GraphItem, BarPlotColors, PlotStyle } from './types'\nimport _ from 'lodash-es'\n\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type BarPlotProps = {\n  isTop: boolean\n  style?: React.CSSProperties\n  plotData: GraphItem[]\n  layoutConfig: Partial<PlotlyTyped.Layout>\n  optionsConfig: Partial<PlotlyTyped.Config>\n  label: string\n  xMax: number\n  colors?: BarPlotColors\n  plotStyle?: PlotStyle\n  onClick?: Function\n}\n\ntype LayoutOptions = {\n  isTop: boolean\n  maxValue: number\n  isLegend?: boolean\n  backgroundColor?: string\n}\n\nfunction getBarPlotDataPoints(\n  data: any[],\n  filter?: string,\n  colors?: BarPlotColors,\n): any[] {\n  if (filter) {\n    data = data.filter(item => item.y === filter)\n  }\n  var groups = _.uniq(data.map(item => item['group'])).sort()\n  const result: any[] = []\n  const defaultColors = [`(28,118,175,1)`, `rgba(91,176,181,1)`]\n\n  groups.forEach((group, i) => {\n    const items = data.filter(item => item.group === group)\n    result.push({\n      x: items.map(item => item.x),\n      y: items.map(item => item.y),\n      name: group,\n      orientation: 'h',\n      marker: {\n        color: colors ? colors[group] : defaultColors[i],\n        width: 1,\n      },\n      text: [group],\n      hovertemplate: `%{x} %{text}<extra></extra>`,\n      type: 'bar',\n    })\n  })\n\n  return result\n}\n\nfunction getLayout(\n  layoutConfig: Partial<PlotlyTyped.Layout>,\n  { isTop, maxValue, backgroundColor }: LayoutOptions,\n): Partial<PlotlyTyped.Layout> {\n  const layout = _.cloneDeep(layoutConfig)\n  layout.xaxis = {\n    visible: false,\n    range: [0, maxValue],\n  }\n  if (backgroundColor) {\n    layout.plot_bgcolor = backgroundColor\n    layout.paper_bgcolor = backgroundColor\n  }\n  if (!isTop) {\n    layout.hoverlabel = {\n      font: {\n        size: 10,\n      },\n    }\n  }\n  layout.showlegend = false\n  layout.height = isTop ? 40 : 20\n  return layout\n}\n\nconst BarPlot: FunctionComponent<BarPlotProps> = ({\n  plotData,\n  optionsConfig,\n  isTop,\n  layoutConfig,\n  label,\n  xMax,\n  colors,\n  plotStyle = { backgroundColor: 'transparent' },\n  style = { width: '100%', height: '100%' },\n  onClick,\n}: BarPlotProps) => {\n  return (\n    <Plot\n      style={style}\n      layout={getLayout(layoutConfig, {\n        isTop,\n        maxValue: xMax,\n        backgroundColor: plotStyle.backgroundColor,\n      })}\n      config={optionsConfig}\n      data={getBarPlotDataPoints(plotData, label, colors)}\n      onClick={(e: any) => (onClick ? onClick(e) : _.noop)}\n    />\n  )\n}\n\nexport default BarPlot\n","import React, { FunctionComponent, useState, useEffect } from 'react' // importing FunctionComponent\nimport * as PlotlyTyped from 'plotly.js'\n\nimport { ElementWithTooltip, TooltipVisualProps } from '../ElementWithTooltip'\nimport { unCamelCase } from '../../../utils/functions/unCamelCase'\n\nimport { SynapseConstants } from '../../../utils'\nimport { getFullQueryTableResults } from '../../../utils/SynapseClient'\nimport {\n  QueryResultBundle,\n  QueryBundleRequest,\n  RowSet,\n} from '../../../utils/synapseTypes'\nimport { resultToJson } from '../../../utils/functions/sqlFunctions'\nimport {\n  GraphItem,\n  PlotProps,\n  BarPlotColors,\n  ClickCallbackParams,\n} from './types'\nimport _ from 'lodash-es'\nimport DotPlot from './DotPlot'\nimport BarPlot from './BarPlot'\n\nexport type ThemesPlotProps = {\n  token?: string\n  onPointClick: ({ facetValue, type }: ClickCallbackParams) => void\n  dotPlot: PlotProps\n  topBarPlot: PlotProps\n  sideBarPlot: PlotProps\n  tooltipProps?: TooltipVisualProps\n  dotPlotYAxisLabel?: string\n}\n\ntype TotalsGroupByY = { y: string; count: number }\ntype TotalsGroupByGroup = { group: string; count: number }\n\nconst optionsConfig: Partial<PlotlyTyped.Config> = {\n  displayModeBar: false,\n  responsive: true,\n  scrollZoom: false,\n  editable: false,\n  autosizable: true,\n}\n\nconst tooltipVisualProps: TooltipVisualProps = {\n  delayShow: 0,\n  place: 'right',\n  type: 'light',\n  effect: 'solid',\n  border: true,\n}\nconst dotPlotLayoutConfig: Partial<PlotlyTyped.Layout> = {\n  showlegend: true,\n  dragmode: false,\n  legend: {\n    font: {\n      size: 11,\n    },\n\n    y: 1.1,\n    xanchor: 'right',\n    x: 1,\n\n    orientation: 'h',\n  },\n  xaxis: {\n    visible: true,\n    fixedrange: true,\n    zeroline: false,\n    showgrid: false,\n    showline: true,\n    linecolor: '#ddd', //bottom line\n    autotick: true,\n    ticks: 'outside',\n    tickcolor: '#ddd',\n  },\n\n  yaxis: {\n    fixedrange: true,\n    zeroline: false,\n    gridcolor: '#ddd', //horizontal lines\n    automargin: true,\n  },\n\n  margin: {\n    pad: 20,\n  },\n  hovermode: 'closest',\n}\n\nconst barLayoutConfig: Partial<PlotlyTyped.Layout> = {\n  barmode: 'stack',\n  showlegend: false,\n  dragmode: false,\n  hovermode: 'closest',\n  yaxis: { visible: false, fixedrange: true },\n  margin: {\n    l: 0,\n    r: 0,\n    b: 0,\n    t: 0,\n    pad: 0,\n  },\n}\n\nfunction fetchData(\n  token: string,\n  { xField, yField, groupField, entityId, whereClause, infoField }: PlotProps,\n): Promise<RowSet> {\n  const sql = `SELECT ${xField} as \"x\", ${yField} as \"y\", ${\n    infoField ? infoField + ' as \"info\", ' : ''\n  }   ${groupField} as \"group\" FROM ${entityId} ${\n    whereClause ? ' WHERE ' + whereClause : ''\n  }`\n\n  const queryRequest: QueryBundleRequest = {\n    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n    partMask: SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n    entityId: entityId,\n    query: {\n      sql: sql,\n    },\n  }\n\n  return getFullQueryTableResults(queryRequest, token).then(\n    (data: QueryResultBundle) => {\n      return data.queryResult.queryResults\n    },\n  )\n}\n\nfunction getTotalsByProp<T>(data: GraphItem[], prop: string): T[] {\n  const resultObject = data.reduce((res, obj) => {\n    res[obj[prop]] = (obj[prop] in res ? Number(res[obj[prop]]) : 0) + Number(obj.x)\n    return res\n  }, {})\n  const result = []\n  for (const property in resultObject) {\n    result.push({ [prop]: property, count: resultObject[property] as number } as unknown as T)\n  }\n  return result\n}\n\nconst getClickTargetData = (e: PlotlyTyped.PlotMouseEvent, swap: boolean) => {\n  const pointData = e.points[0].data\n\n  let facetValue = pointData.y[0]\n  let type = pointData.name\n\n  if (swap) {\n    // @ts-ignore\n    ;[facetValue, type] = [type, facetValue]\n  }\n  return { facetValue, type }\n}\n\nconst renderTopBarLegend = (\n  colors: BarPlotColors | undefined,\n  xLabels: string[],\n): JSX.Element => (\n  <div className=\"ThemesPlot__barPlotLegend\">\n    {xLabels.map((item, i) => (\n      <div style={{ float: 'left' }} key={`topBar_${i}`}>\n        <div\n          className=\"ThemesPlot__barPlotLegend__label\"\n          key=\"topBar_label\"\n          style={{\n            backgroundColor: `${colors ? colors[item] : 'transparent'}`,\n          }}\n        ></div>\n        <div className=\"ThemesPlot__barPlotLegend__graph\" key=\"topBar_graph\">\n          {item}\n        </div>{' '}\n      </div>\n    ))}\n  </div>\n)\n\nconst fadeColors = (colors: { [key: string]: string }, opacity: string) => {\n  for (let key in colors) {\n    colors[key] = colors[key]\n      .replace(',1)', `, ${opacity})`)\n      .replace(',1.0)', `, ${opacity})`)\n  }\n  return colors\n}\n\nconst getTooltip = (data: GraphItem[], filter: string) => {\n  return _.first(data.filter(item => item.y === filter).map(item => item.info))\n}\n\nconst ThemesPlot: FunctionComponent<ThemesPlotProps> = ({\n  token,\n  dotPlot,\n  topBarPlot,\n  sideBarPlot,\n  tooltipProps = tooltipVisualProps,\n  onPointClick,\n  dotPlotYAxisLabel = 'Research Themes'\n}: ThemesPlotProps) => {\n  const [isLoaded, setIsLoaded] = useState(false)\n  const [dotPlotQueryData, setDotPlotQueryData] = useState<GraphItem[]>([])\n  const [topBarPlotData, setTopBarQueryData] = useState<GraphItem[]>([])\n  const [sideBarPlotData, setSideBarQueryData] = useState<GraphItem[]>([])\n\n  useEffect(() => {\n    const dotPlotData = fetchData(token!, dotPlot)\n    const topBarPlotData = fetchData(token!, topBarPlot)\n    const sideBarPlotData = fetchData(token!, sideBarPlot)\n    Promise.all([dotPlotData, topBarPlotData, sideBarPlotData])\n      .then(result => {\n        setDotPlotQueryData(resultToJson(result[0].headers, result[0].rows))\n        setTopBarQueryData(resultToJson(result[1].headers, result[1].rows))\n        setSideBarQueryData(resultToJson(result[2].headers, result[2].rows))\n        setIsLoaded(true)\n      })\n      .catch(err => {\n        throw err\n      })\n    return () => {}\n  }, [token, dotPlot, topBarPlot, sideBarPlot])\n  let yLabelsForDotPlot: string[] = []\n  let xLabelsForTopBarPlot: string[] = []\n  let xMaxForDotPlot = 0\n  let xMaxForSideBarPlot = 0\n  let topBarPlotDataSorted: TotalsGroupByY[] = []\n  let totalsByDotPlotY: TotalsGroupByY[] = []\n  if (isLoaded) {\n    totalsByDotPlotY = getTotalsByProp(sideBarPlotData, 'y')\n    yLabelsForDotPlot = totalsByDotPlotY\n      .sort((a, b) => b.count - a.count)\n      .map(item => item.y)\n    xMaxForSideBarPlot = Math.max(...totalsByDotPlotY.map(item => item.count))\n    xMaxForDotPlot = Math.max(...dotPlotQueryData.map(item => Number(item.x)))\n    topBarPlotDataSorted = _.orderBy(getTotalsByProp(topBarPlotData, 'y'), ['y'])\n   xLabelsForTopBarPlot = _.orderBy(getTotalsByProp<TotalsGroupByGroup>(topBarPlotData, 'group'), ['group']).map(item => item.group)\n  }\n\n  return (\n    <>\n      {!isLoaded && (\n        <div className=\"text-center\">\n          <span className=\"spinner\" />\n        </div>\n      )}\n\n      {isLoaded && (\n        <div className=\"ThemesPlot\">\n          <div className=\"ThemesPlot__dotPlotLegend\">\n            <DotPlot\n              id=\"head\"\n              plotData={dotPlotQueryData}\n              isLegend={true}\n              markerSymbols={dotPlot.markerSymbols}\n              style={{ width: '100%', height: '100%' }}\n              layoutConfig={dotPlotLayoutConfig}\n              optionsConfig={{\n                ...optionsConfig,\n                responsive: true,\n                staticPlot: true,\n              }}\n              plotStyle={{\n                ...dotPlot.plotStyle!,\n                backgroundColor: 'transparent',\n              }}\n            ></DotPlot>\n          </div>\n          {topBarPlot.colors &&\n            renderTopBarLegend(topBarPlot.colors, xLabelsForTopBarPlot)}\n          {topBarPlotDataSorted.map((item, i) => (\n            <div className=\"ThemesPlot__topBarPlot\" key={`topBarDiv_${i}`}>\n              <div className=\"ThemesPlot__topBarPlot__label\">\n                {item.count}&nbsp;{unCamelCase(item.y)}\n              </div>\n              <div className=\"ThemesPlot__topBarPlot__plot\">\n                <BarPlot\n                  style={{ width: '100%', height: '100%' }}\n                  layoutConfig={_.cloneDeep(barLayoutConfig)}\n                  optionsConfig={{ ...optionsConfig }}\n                  plotData={topBarPlotData}\n                  isTop={true}\n                  label={item.y}\n                  xMax={item.count}\n                  onClick={(e: any) =>\n                    onPointClick(getClickTargetData(e, true))\n                  }\n                  colors={\n                    // we are not actually fading colors for now. But keeping implemenation in case it changes\n                    i % 2 === 0\n                      ? topBarPlot.colors\n                      : fadeColors({ ...topBarPlot.colors }, '1')\n                  }\n                />\n              </div>\n            </div>\n          ))}\n          <div style={{ display: 'flex', position: 'relative'}}>\n            <div className=\"ThemesPlot__dotPlotYLabel\">{dotPlotYAxisLabel}</div>\n            <div className=\"ThemesPlot__dotPlot\">\n              {yLabelsForDotPlot.map((label, i) => (\n                <div\n                  key={`plotDiv_${+i}`}\n                  className=\"ThemesPlot__dotPlot__row\"\n                  style={{\n                    backgroundColor: dotPlot.plotStyle?.backgroundColor,\n                  }}\n                >\n                  <div className=\"ThemesPlot__dotPlot__barColumn\">\n                    <ElementWithTooltip\n                      idForToolTip={`plotDiv1_${+i}`}\n                      tooltipText={`${getTooltip(dotPlotQueryData, label)} `}\n                      tooltipVisualProps={tooltipProps}\n                      callbackFn={() => _.noop}\n                    >\n                      <div>\n                        <span className=\"ThemesPlot__dotPlot__themeLabel\">\n                          {label}\n                        </span>\n                        <br />\n                        <span className=\"ThemesPlot__dotPlot__countLabel\">\n                          {totalsByDotPlotY[i].count} {sideBarPlot.countLabel}\n                        </span>\n                        <br />\n                        <BarPlot\n                          style={{ width: '100%' }}\n                          layoutConfig={barLayoutConfig}\n                          optionsConfig={optionsConfig}\n                          plotData={sideBarPlotData}\n                          isTop={false}\n                          xMax={xMaxForSideBarPlot}\n                          label={label}\n                          colors={fadeColors({ ...topBarPlot.colors }, '1')}\n                        />\n                      </div>\n                    </ElementWithTooltip>\n                  </div>\n                  <div className=\"ThemesPlot__dotPlot__dotPlotColumn\">\n                    <div\n                      style={{\n                        width: '100%',\n                        backgroundColor: dotPlot.plotStyle?.backgroundColor,\n                      }}\n                    >\n                      <DotPlot\n                        id={i + ''}\n                        onClick={(e: any) =>\n                          onPointClick(getClickTargetData(e, false))\n                        }\n                        plotData={dotPlotQueryData}\n                        plotStyle={dotPlot.plotStyle}\n                        markerSymbols={dotPlot.markerSymbols}\n                        xMax={xMaxForDotPlot}\n                        label={label}\n                        layoutConfig={dotPlotLayoutConfig}\n                        optionsConfig={{\n                          ...optionsConfig,\n                          responsive: false,\n                        }}\n                      ></DotPlot>\n                    </div>\n                  </div>\n                </div>\n              ))}\n              <div className=\"ThemesPlot__dotPlot__row\">\n                <div\n                  className=\"ThemesPlot__dotPlot__barColumn\"\n                  style={{ textAlign: 'right' }}\n                >\n                  VOLUME:\n                </div>\n                <div\n                  className=\"ThemesPlot__dotPlot__dotPlotColumn\"\n                  style={{ marginTop: '0px' }}\n                >\n                  <DotPlot\n                    id={'footer'}\n                    plotData={dotPlotQueryData}\n                    isXAxis={true}\n                    xMax={xMaxForDotPlot}\n                    layoutConfig={dotPlotLayoutConfig}\n                    optionsConfig={{ ...optionsConfig, responsive: false }}\n                  ></DotPlot>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div></div>\n        </div>\n      )}\n    </>\n  )\n}\n\nexport default ThemesPlot\n","import * as React from 'react'\nimport { QueryBundleRequest } from '../utils/synapseTypes'\nimport { SynapseClient, SynapseConstants } from '../'\n\nexport type TotalQueryResultsProps = {\n  isLoading: boolean\n  style?: React.CSSProperties\n  getLastQueryRequest: (() => QueryBundleRequest) | undefined\n  token: string | undefined\n  unitDescription: string\n  frontText: string\n}\n\ntype State = {\n  total: number\n  isLoading: boolean\n}\n\n// This is a stateful component so that during load the component can hold onto the previous\n// total instead of showing 0 results for the intermittent loading state.\nexport default class TotalQueryResults extends React.Component<\n  TotalQueryResultsProps,\n  State\n> {\n  constructor(props: TotalQueryResultsProps) {\n    super(props)\n    this.state = {\n      total: 0,\n      isLoading: false,\n    }\n  }\n\n  componentDidMount() {\n    this.calculateTotal()\n  }\n\n  componentDidUpdate(prevProps: TotalQueryResultsProps) {\n    // Check that it has entered a loading state, meaning that there is new data\n    if (this.props.isLoading && !prevProps.isLoading) {\n      this.calculateTotal()\n    }\n  }\n\n  calculateTotal() {\n    const { getLastQueryRequest, token } = this.props\n    const queryRequest = getLastQueryRequest!()\n    queryRequest.partMask = SynapseConstants.BUNDLE_MASK_QUERY_COUNT\n\n    this.setState({\n      isLoading: true,\n    })\n    SynapseClient.getQueryTableResults(queryRequest, token).then(data => {\n      this.setState({\n        total: data.queryCount!,\n        isLoading: false,\n      })\n    })\n  }\n\n  render() {\n    const { style, unitDescription, frontText } = this.props\n    const { total, isLoading } = this.state\n    return (\n      <p\n        style={style}\n        className=\"SRC-boldText SRC-text-title SRC-centerContent\"\n      >\n        {frontText} {total} {unitDescription}{' '}\n        {isLoading && (\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        )}\n      </p>\n    )\n  }\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faPlus } from '@fortawesome/free-solid-svg-icons'\nimport * as React from 'react'\nimport {\n  getIsValueSelected,\n  readFacetValues,\n} from '../utils/functions/facetUtils'\nimport {\n  FacetColumnResultValues,\n  QueryBundleRequest,\n} from '../utils/synapseTypes/'\nimport { getColorPallette } from './ColorGradient'\nimport { FacetSelection, QueryWrapperChildProps } from './QueryWrapper'\nimport { SELECT_ALL } from './table/SynapseTableConstants'\nimport TotalQueryResults from './TotalQueryResults'\nlibrary.add(faPlus)\n\nexport const SELECT_SINGLE_FACET = 'SELECT_SINGLE_FACET'\n\ntype CheckboxGroupProps = {\n  isAllFilterSelected: boolean\n  rgbIndex: number\n  facetColumnResult: FacetColumnResultValues\n  applyChanges: (\n    ref: React.RefObject<HTMLSpanElement>,\n    facetValue: string,\n    selector: string,\n    index: number,\n  ) => (_event: React.MouseEvent<HTMLSpanElement>) => void\n  showAllFacets: boolean\n  lastFacetSelection: FacetSelection\n  isLoading: boolean\n}\n\nexport const FACET_SELECTED_CLASS = 'FACET_SELECTED_CLASS'\nexport const FACET_NOT_SELECTED_CLASS = 'FACET_NOT_SELECTED_CLASS'\n\n/**\n * Checkbox group represents one column's set of checkbox filters\n *\n * @class CheckboxGroup\n * @extends {React.Component}\n */\nconst CheckboxGroup: React.FunctionComponent<CheckboxGroupProps> = (\n  props: CheckboxGroupProps,\n) => {\n  const {\n    facetColumnResult,\n    showAllFacets,\n    lastFacetSelection,\n    isLoading,\n    rgbIndex,\n    isAllFilterSelected,\n  } = props\n  const children: any = []\n  const ref: React.RefObject<HTMLSpanElement> = React.createRef()\n  // Note: this actually sorts the data when it appears in the\n  // table as it stands currently, this may change depending on\n  // if that arrangment is no longer desired\n  facetColumnResult.facetValues.sort((a: any, b: any) => {\n    return b.count - a.count\n  })\n  const { colorPalette, textColors } = getColorPallette(\n    rgbIndex,\n    facetColumnResult.facetValues.length,\n  )\n  facetColumnResult.facetValues.forEach(\n    (facetColumnResultValues, index: number) => {\n      const key =\n        facetColumnResult.columnName +\n        facetColumnResultValues.value +\n        facetColumnResultValues.count\n      const textColor = textColors[index]\n      const curColor = colorPalette[index]\n      let style: any = {}\n\n      const isSelected = isAllFilterSelected\n        ? true\n        : getIsValueSelected({\n            isLoading,\n            lastFacetSelection,\n            columnName: facetColumnResult.columnName,\n            curFacetSelection: facetColumnResultValues,\n          })\n\n      if (isSelected) {\n        style = {\n          background: curColor,\n        }\n      } else {\n        style = {\n          background: '#C4C4C4',\n        }\n      }\n      // we add this class for testability\n      const backgroundClass = isSelected\n        ? FACET_SELECTED_CLASS\n        : FACET_NOT_SELECTED_CLASS\n      style.color = textColor\n      const { value, count } = facetColumnResultValues\n      const displayValue =\n        value === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n          ? 'unannotated'\n          : value\n\n      children.push(\n        <label\n          style={style}\n          className=\"SRC-facets SRC-primary-background-color-hover \"\n          key={key}\n        >\n          <span className=\"SRC-facets-text\">\n            {displayValue} ({count})\n          </span>\n          <input\n            // @ts-ignore\n            onChange={props.applyChanges(\n              ref,\n              value,\n              SELECT_SINGLE_FACET,\n              index,\n            )}\n            checked={isSelected}\n            type=\"checkbox\"\n            value={value}\n            className={`SRC-hidden SRC-facet-checkboxes ${backgroundClass}`}\n          />\n        </label>,\n      )\n    },\n  )\n  // By default only show 5 facets unless the user has clicked a facet, in which case\n  // showAllFacets will be true.\n  const childrenView = showAllFacets ? children : children.slice(0, 5)\n  return (\n    // need a span so that we can have a ref attachable\n    <span ref={ref}>{childrenView}</span>\n  )\n}\n\ntype FacetsState = {\n  showAllFacets: boolean\n}\n\nclass Facets extends React.Component<QueryWrapperChildProps, FacetsState> {\n  constructor(props: QueryWrapperChildProps) {\n    super(props)\n    this.applyChanges = this.applyChanges.bind(this)\n    this.state = {\n      showAllFacets: false,\n    }\n    this.showAllFacets = this.showAllFacets.bind(this)\n    this.showButtons = this.showButtons.bind(this)\n  }\n  /**\n   * Display the view of the facets\n   *\n   * @returns\n   * @memberof Facets\n   */\n  public showFacetFilter() {\n    if (!this.props.data!.facets) {\n      throw Error(\n        'Error on query request, must include facets in partmask to show facets',\n      )\n    }\n    // Find the facetcolumn result according to the input filter\n    const facetColumnResult = this.props.data!.facets!.find(\n      el =>\n        el.columnName === this.props.facet && el.facetType === 'enumeration',\n    ) as FacetColumnResultValues\n    if (!facetColumnResult) {\n      throw Error('Error no matching facet found given specified facet')\n    }\n\n    return (\n      <CheckboxGroup\n        isAllFilterSelected={\n          this.props.isAllFilterSelectedForFacet![this.props.facet!]\n        }\n        showAllFacets={this.state.showAllFacets}\n        rgbIndex={this.props.rgbIndex!}\n        key={facetColumnResult.columnName}\n        facetColumnResult={facetColumnResult}\n        applyChanges={this.applyChanges}\n        isLoading={this.props.isLoading!}\n        lastFacetSelection={this.props.lastFacetSelection!}\n      />\n    )\n  }\n\n  /**\n   * Handle checkbox click event\n   */\n  public applyChanges = (\n    ref: React.RefObject<HTMLSpanElement>,\n    facetValue: string,\n    selector: string,\n    index: number,\n  ) => (event: React.MouseEvent<HTMLSpanElement>) => {\n    event.preventDefault()\n    if (!this.state.showAllFacets) {\n      this.setState({\n        showAllFacets: true,\n      })\n    }\n\n    const { facet = '', isAllFilterSelectedForFacet = {} } = this.props\n\n    const lastFacetSelection = {\n      facetValue,\n      selector,\n      columnName: facet,\n    } as FacetSelection\n    isAllFilterSelectedForFacet[facet] = selector === SELECT_ALL\n    this.props.updateParentState!({\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n      chartSelectionIndex: index,\n    })\n\n    // read input and fetch data\n    const htmlCheckboxes = Array.from(\n      ref.current!.querySelectorAll('.SRC-facet-checkboxes'),\n    ) as HTMLInputElement[]\n    // queryRequest is a deep clone\n    const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n    const { newQueryRequest } = readFacetValues({\n      htmlCheckboxes,\n      queryRequest,\n      selector,\n      facet,\n      value: facetValue,\n    })\n\n    queryRequest.query.offset = 0\n    this.props.executeQueryRequest!(newQueryRequest)\n  }\n\n  public showAllFacets(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault()\n    this.setState({\n      showAllFacets: true,\n    })\n  }\n\n  public showButtons(\n    curFacetsLength: number,\n    ref: React.RefObject<HTMLDivElement>,\n  ) {\n    if (this.state.showAllFacets || curFacetsLength <= 5) {\n      // this is hidden if there are > 5 facets, wait for user to make\n      // an action for this to appear\n      return (\n        <button\n          className=\"SRC-primary-text-color SRC-facet-select-all SRC-no-text-decor\"\n          onClick={this.applyChanges(ref, '', SELECT_ALL, 0)}\n        >\n          Select All\n        </button>\n      )\n    }\n    return (\n      <button\n        id=\"showAllFacetsButton\"\n        className=\"SRC-primary-text-color SRC-no-text-decor\"\n        onClick={this.showAllFacets}\n      >\n        Show All ({curFacetsLength})\n      </button>\n    )\n  }\n\n  public render() {\n    if (!this.props.data) {\n      return <div />\n    }\n    const { data, facet, unitDescription, isLoading, showBarChart } = this.props\n    const { facets } = data\n    if (!facets) {\n      throw Error(\n        'Error on query request, must include facets in partmask to show facets',\n      )\n    }\n    const curFacetsIndex = facets.findIndex(\n      curFacet =>\n        curFacet.columnName === facet && curFacet.facetType === 'enumeration',\n    )\n    // cast is necessary because filter returns an array of arrays\n    const facetColumnResultValues = facets[\n      curFacetsIndex\n    ] as FacetColumnResultValues\n\n    if (!facetColumnResultValues) {\n      return <div />\n    }\n    const ref: React.RefObject<HTMLDivElement> = React.createRef()\n    return (\n      <div className=\"SRC-syn-border-spacing\">\n        {!showBarChart && (\n          <TotalQueryResults\n            getLastQueryRequest={this.props.getLastQueryRequest}\n            token={this.props.token}\n            unitDescription={unitDescription!}\n            frontText={'Displaying'}\n            isLoading={isLoading!}\n          />\n        )}\n        <form>\n          <div ref={ref} className=\"SRC-marginFive form-group\">\n            {this.showFacetFilter()}\n            {this.showButtons(facetColumnResultValues.facetValues.length, ref)}\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport { Facets, CheckboxGroup }\n","import * as React from 'react'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faCaretDown,\n  faCaretUp,\n  faSearch,\n  faTimes,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { insertConditionsFromSearchParams } from '../utils/functions/sqlFunctions'\nimport TotalQueryResults from './TotalQueryResults'\nimport getColorPallette from './ColorGradient'\nimport { SEARCH_CLASS_CSS } from './QueryWrapperMenu'\nimport { Dropdown } from 'react-bootstrap'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\n\nlibrary.add(faCaretDown)\nlibrary.add(faCaretUp)\nlibrary.add(faSearch)\nlibrary.add(faTimes)\n\ntype SearchState = {\n  dropdownIndex: number\n  show: boolean\n  searchText: string\n  submittedSearchText: string\n  lastSearchedFacet: string\n}\nexport type Searchable = {\n  columnName: string\n  hintText: string\n}[]\n\nexport type SearchProps = {\n  searchable: Searchable\n  isQueryWrapperMenuChild?: boolean\n}\n\ntype InternalSearchProps = QueryWrapperChildProps & SearchProps\n\nclass Search extends React.Component<InternalSearchProps, SearchState> {\n  public inputRef: React.RefObject<HTMLInputElement>\n\n  constructor(props: InternalSearchProps) {\n    super(props)\n    this.state = {\n      dropdownIndex: 0,\n      show: false,\n      searchText: '',\n      submittedSearchText: '',\n      lastSearchedFacet: '',\n    }\n    this.inputRef = React.createRef()\n  }\n\n  componentDidUpdate(prevProps: InternalSearchProps) {\n    if (this.props.isLoading === false && prevProps.isLoading === true) {\n      // highlighting will sometimes outpace the render method for react, adding the slight delay\n      // mitigates this\n      setTimeout(this.highlightText, 100)\n    }\n  }\n\n  public toggleDropdown = (value: boolean) => (_: React.SyntheticEvent) => {\n    this.setState({\n      show: value,\n    })\n  }\n\n  public setDropdownIndex = (index: number) => (_: React.SyntheticEvent) => {\n    this.inputRef.current && this.inputRef.current.focus()\n    this.setState({\n      dropdownIndex: index,\n      show: false,\n    })\n  }\n\n  public highlightText = () => {\n    const { submittedSearchText, dropdownIndex } = this.state\n    const {\n      searchable,\n      rgbIndex,\n      facetAliases = {},\n      isQueryWrapperMenuChild = true,\n    } = this.props\n    const { colorPalette } = getColorPallette(rgbIndex!, 1)\n    const originalColor = colorPalette[0]\n    const searchItem = searchable[dropdownIndex]\n\n    const highlightedSpans = document.querySelectorAll<HTMLSpanElement>(\n      '.highlight',\n    )\n    highlightedSpans.forEach(span => {\n      span.outerHTML = span.innerText\n    })\n    if (submittedSearchText) {\n      const searchItemView =\n        facetAliases[searchItem.columnName] ||\n        unCamelCase(searchItem.columnName)\n      const frontText = isQueryWrapperMenuChild ? `.${SEARCH_CLASS_CSS} ` : ''\n      const querySelector = `${frontText}[data-search-handle=\"${searchItemView}\"]`\n      const trs = document.querySelectorAll<HTMLElement>(querySelector)\n      // Target elements and apply styles\n      trs.forEach(textElement => {\n        if (textElement.innerHTML !== null) {\n          const regex = new RegExp(submittedSearchText, 'gi')\n          const match = textElement.innerText.match(regex)\n          if (match) {\n            // innerHTML contains only text\n            textElement.innerHTML = textElement.innerHTML.replace(\n              regex,\n              match => {\n                return `<span style=\"background: ${originalColor}; color: white;\" class=\"highlight\">${match}</span>`\n              },\n            )\n          }\n        }\n      })\n    }\n  }\n\n  public static addEscapeCharacters = (searchText: string) => {\n    // We have to escape the following characters\n    // ' % \\\n    let escapedSearchText = searchText\n    // escape ' by adding additional '\n    escapedSearchText = escapedSearchText.split(\"'\").join(\"''\")\n    // escape % by adding \\\n    // eslint-disable-next-line no-useless-escape\n    escapedSearchText = escapedSearchText.split('%').join('%')\n    // escape \\ by adding \\\n    escapedSearchText = escapedSearchText.split('\\\\').join('\\\\\\\\')\n    return escapedSearchText\n  }\n\n  public clearSearchText = () => {\n    this.setState({\n      searchText: '',\n    })\n  }\n\n  public search = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    // form completion by default causes the page to reload, so we prevent that\n    event.preventDefault()\n    const { searchText, dropdownIndex } = this.state\n\n    const { searchable } = this.props\n    const searchItem = searchable[dropdownIndex]\n    // Always grabs initQueryRequest so that it doesn't build a chain of\n    // LIKE clauses\n    const lastQueryRequestDeepCopy = this.props.getInitQueryRequest!()\n    const { sql } = lastQueryRequestDeepCopy.query\n    const searchParams = {\n      [searchItem.columnName]: Search.addEscapeCharacters(searchText),\n    }\n    const newSql = insertConditionsFromSearchParams(searchParams, sql)\n    lastQueryRequestDeepCopy.query.sql = newSql\n    this.setState({\n      submittedSearchText: searchText,\n      lastSearchedFacet: searchItem.columnName,\n    })\n    this.props.executeQueryRequest!(lastQueryRequestDeepCopy)\n  }\n\n  public handleChange = (event: React.FormEvent<HTMLInputElement>) => {\n    this.setState({\n      searchText: event.currentTarget.value,\n    })\n  }\n\n  render() {\n    const {\n      searchable,\n      isLoading,\n      getLastQueryRequest,\n      unitDescription = '',\n      facetAliases = {},\n    } = this.props\n    const {\n      show,\n      dropdownIndex,\n      searchText,\n      submittedSearchText,\n      lastSearchedFacet,\n    } = this.state\n    const searchableItem = searchable[dropdownIndex]\n    const containerStyle: React.CSSProperties = {\n      border: '1px solid #DCDCDC',\n      display: 'flex',\n      marginTop: 10,\n      alignItems: 'center',\n    }\n    const fieldStyle: React.CSSProperties = {\n      background: '#F9F9F9',\n      height: '51px',\n      display: 'inline-flex',\n      alignItems: 'center',\n    }\n    const caretIconStyle: React.CSSProperties = {\n      fontSize: '16px',\n      marginRight: 8,\n    }\n    const searchIconStyle: React.CSSProperties = {\n      color: '#C4C4C4',\n      position: 'absolute',\n      left: 10,\n      fontSize: 16,\n    }\n    const cancelIconStyle: React.CSSProperties = {\n      width: 30,\n      height: 30,\n      position: 'absolute',\n      right: 10,\n    }\n    const inputStyle: React.CSSProperties = {\n      border: 1,\n      paddingLeft: 40,\n      height: 49,\n    }\n    const dropdownBtnStyle: React.CSSProperties = {\n      justifyContent: 'space-between',\n      margin: 0,\n      paddingLeft: 10,\n    }\n    const totalQueryResultsStyle: React.CSSProperties = {\n      margin: '20px 0px',\n    }\n    const curFacetDisplayText =\n      facetAliases[searchableItem.columnName] ||\n      unCamelCase(searchableItem.columnName)\n    const lastSearchedFacetDisplayText =\n      facetAliases[lastSearchedFacet] || unCamelCase(lastSearchedFacet)\n    const usedUnitDescription = submittedSearchText\n      ? `${unitDescription} containing \"${submittedSearchText}\" in ${lastSearchedFacetDisplayText}`\n      : unitDescription\n    return (\n      <div>\n        <p>\n          Search within <strong> {curFacetDisplayText} </strong> using keywords\n        </p>\n        <div style={containerStyle}>\n          <div className=\"SRC-centerContent SRC-fullWidth\">\n            <div\n              style={{\n                ...fieldStyle,\n                flex: 1,\n                borderRight: '1px solid #DCDCDC',\n              }}\n            >\n              <Dropdown\n                show={show}\n                onToggle={() => this.setState({ show: !show })}\n                className=\"SRC-inherit-height SRC-fullWidth\"\n              >\n                <Dropdown.Toggle\n                  style={dropdownBtnStyle}\n                  className=\"SRC-primary-color-hover-dropdown SRC-inlineFlex SRC-inherit-height SRC-fullWidth\"\n                  variant=\"light\"\n                  id=\"search-toggle\"\n                >\n                  {curFacetDisplayText}\n                  <FontAwesomeIcon\n                    style={caretIconStyle}\n                    icon={show ? 'caret-up' : 'caret-down'}\n                    color={show ? 'white' : undefined}\n                  />\n                </Dropdown.Toggle>\n                <Dropdown.Menu>\n                  {searchable.map((el, index) => {\n                    const displayName =\n                      facetAliases[el.columnName] || unCamelCase(el.columnName)\n                    return (\n                      <Dropdown.Item\n                        // @ts-ignore\n                        onSelect={this.setDropdownIndex(index)}\n                        key={displayName}\n                        className=\"SRC-hand-cursor SRC-primary-background-color-hover\"\n                      >\n                        {displayName}\n                      </Dropdown.Item>\n                    )\n                  })}\n                </Dropdown.Menu>\n              </Dropdown>\n            </div>\n            <form\n              style={{\n                ...fieldStyle,\n                flex: 3,\n                alignItems: 'center',\n                position: 'relative',\n              }}\n              onSubmit={this.search}\n            >\n              <FontAwesomeIcon\n                size={'sm'}\n                style={searchIconStyle}\n                icon={'search'}\n              />\n              <input\n                placeholder={`e.g. \"${searchableItem.hintText}\"`}\n                style={inputStyle}\n                ref={this.inputRef}\n                onChange={this.handleChange}\n                value={searchText}\n                type=\"text\"\n                className=\"SRC-fullWidth\"\n              />\n              {searchText.length > 0 && (\n                <button\n                  type=\"reset\"\n                  className=\"SRC-button-focus-primary-color SRC-centerContentInline\"\n                  style={cancelIconStyle}\n                  onClick={this.clearSearchText}\n                  tabIndex={0}\n                >\n                  <FontAwesomeIcon\n                    size={'sm'}\n                    color={'#C4C4C4'}\n                    style={{ fontSize: 16 }}\n                    icon={'times'}\n                  />\n                </button>\n              )}\n            </form>\n          </div>\n        </div>\n        <TotalQueryResults\n          style={totalQueryResultsStyle}\n          isLoading={isLoading!}\n          frontText={'Displaying'}\n          token={this.props.token}\n          getLastQueryRequest={getLastQueryRequest}\n          unitDescription={usedUnitDescription}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Search\n","import { CSSTransition, TransitionGroup } from 'react-transition-group'\nimport * as React from 'react'\nimport { SynapseConstants } from '../utils/'\nimport { getColorPallette } from './ColorGradient'\nimport { Facets } from './Facets'\nimport QueryCount from './QueryCount'\nimport QueryWrapper from './QueryWrapper'\nimport StackedBarChart from './StackedBarChart'\nimport SynapseTable, { SynapseTableProps } from './table/SynapseTable'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport CardContainer from './CardContainer'\nimport { CardConfiguration } from './CardContainerLogic'\nimport { StackedBarChartProps } from './StackedBarChart'\nimport {\n  isGroupByInSql,\n  insertConditionsFromSearchParams,\n} from '../utils/functions/sqlFunctions'\nimport { FacetColumnValuesRequest } from '../utils/synapseTypes/'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus, faSearch } from '@fortawesome/free-solid-svg-icons'\nimport Search, { SearchProps } from './Search'\n\nlibrary.add(faPlus)\nlibrary.add(faSearch)\n\ntype MenuState = {\n  activeMenuIndices: number[]\n  accordionGroupIndex: number\n}\n\nexport type MenuConfig = {\n  sql: string\n  facet?: string\n}\n\n// represents the entirety of the menu\nexport const MENU_DROPDOWN_CSS = 'SRC-menuLayout'\n// represent an accordiong 'group' within the menu\nexport const ACCORDION_GROUP_CSS = 'SRC-accordion-key'\n// represents the single accordiong group which is active within the menu\nexport const ACCORDION_GROUP_ACTIVE_CSS = 'SRC-IS-ACTIVE'\n// for search component querying on cardcontainer\nexport const SEARCH_CLASS_CSS = 'SRC-search-component'\n\ninterface MenuSearchParams {\n  facetValue: string\n  facet: string\n}\n\ntype CommonMenuProps = {\n  tableConfiguration?: SynapseTableProps\n  cardConfiguration?: CardConfiguration\n  stackedBarChartConfiguration?: StackedBarChartProps\n  searchConfiguration?: SearchProps\n  showBarChart?: boolean\n  unitDescription?: string\n}\n\ntype AccordionConfig = {\n  searchConfiguration?: SearchProps\n  menuConfig: MenuConfig[]\n  name: string\n} & CommonMenuProps\n\nexport type QueryWrapperMenuProps = {\n  facetAliases?: {}\n  menuConfig?: MenuConfig[]\n  accordionConfig?: AccordionConfig[]\n  isConsistent?: boolean\n  token?: string\n  entityId: string\n  rgbIndex: number\n  searchParams?: MenuSearchParams\n  name?: string\n  globalQueryCountSql?: string\n} & CommonMenuProps\n\ntype Info = {\n  isSelected: boolean\n  originalColor: string\n  hoverWhiteTextClass?: string\n}\n\nexport default class QueryWrapperMenu extends React.Component<\n  QueryWrapperMenuProps,\n  MenuState\n> {\n  constructor(props: QueryWrapperMenuProps) {\n    super(props)\n    // See note about initializing props from state here\n    //  - https://stackoverflow.com/questions/40063468/react-component-initialize-state-from-props/47341539#47341539\n    const { searchParams, accordionConfig, menuConfig } = this.props\n    let activeMenuIndices = []\n    const facetIndexFromFacetSearchParam = menuConfig?.findIndex(\n      el => el.facet && el.facet === searchParams?.facet,\n    )\n    const usedFacetIndex =\n      facetIndexFromFacetSearchParam === -1 ? 0 : facetIndexFromFacetSearchParam\n    const indexFromURLOrDefaultZero = usedFacetIndex || 0\n    if (accordionConfig) {\n      activeMenuIndices = new Array(accordionConfig.length).fill(0)\n    } else {\n      activeMenuIndices = [indexFromURLOrDefaultZero]\n    }\n    this.state = {\n      activeMenuIndices,\n      accordionGroupIndex: 0,\n    }\n    this.handleHoverLogic = this.handleHoverLogic.bind(this)\n    this.switchFacet = this.switchFacet.bind(this)\n    this.getUnitDescription = this.getUnitDescription.bind(this)\n    this.getPartMask = this.getPartMask.bind(this)\n    this.getSelectedFacets = this.getSelectedFacets.bind(this)\n    this.getSqlWithAdditionalClause = this.getSqlWithAdditionalClause.bind(this)\n    this.getTableLoadingScreen = this.getTableLoadingScreen.bind(this)\n  }\n\n  componentDidUpdate(prevProps: QueryWrapperMenuProps, _prevState: MenuState) {\n    /*\n      Update the row count or the menu index if the props changed by looking at whether the sql or the rgbIndex\n      changed\n    */\n    let { activeMenuIndices } = this.state\n    const { rgbIndex, accordionConfig } = this.props\n    if (rgbIndex !== prevProps.rgbIndex) {\n      activeMenuIndices = accordionConfig\n        ? new Array(accordionConfig.length).fill(0)\n        : [0]\n      this.setState({\n        activeMenuIndices,\n        accordionGroupIndex: 0,\n      })\n    }\n  }\n\n  /**\n   * Handle the user hovering over a facet selection, it must be programatically\n   * handled because the color used is dynamic\n   *\n   * @memberof Menu\n   */\n  public handleHoverLogic = (info: Info) => (\n    event: React.MouseEvent<HTMLDivElement>,\n  ) => {\n    // This prevents a bug where there is both light text and a light background,\n    // otherwise SRC-hoverWhiteText would be placed on the group and item keys statically\n    if (!event.currentTarget.classList.contains('SRC-hoverWhiteText')) {\n      event.currentTarget.classList.add('SRC-hoverWhiteText')\n    }\n    if (!info.isSelected && event.currentTarget.tagName === 'DIV') {\n      event.currentTarget.style.backgroundColor = info.originalColor\n    }\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public switchFacet = (menuIndexIn: number, accordionIndexIn: number) => (\n    _: React.SyntheticEvent<HTMLDivElement>,\n  ) => {\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    // there's an odd bug where clicking a menu item twice will select the first tab,\n    // this is a fix for that, but this shouldn't be necessary\n    const isClickingCurrentSelection =\n      accordionGroupIndex === accordionIndexIn &&\n      activeMenuIndices[accordionIndexIn] === menuIndexIn\n    activeMenuIndices[accordionIndexIn] = menuIndexIn\n    if (!isClickingCurrentSelection) {\n      this.setState({\n        activeMenuIndices,\n        accordionGroupIndex: accordionIndexIn,\n      })\n    }\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public toggleGroupAccordionIndex = (accordionGroupIndexIn: number) => (\n    _event: React.SyntheticEvent<HTMLDivElement>,\n  ) => {\n    const { accordionGroupIndex } = this.state\n    if (accordionGroupIndex === accordionGroupIndexIn) {\n      return\n    } else {\n      this.setState({\n        accordionGroupIndex: accordionGroupIndexIn,\n      })\n    }\n  }\n\n  public render() {\n    const {\n      stackedBarChartConfiguration,\n      name,\n      menuConfig,\n      token,\n      globalQueryCountSql = '',\n      entityId,\n    } = this.props\n    const { activeMenuIndices } = this.state\n\n    let sql = ''\n    if (menuConfig) {\n      sql = menuConfig![activeMenuIndices[0]].sql\n    }\n    if (globalQueryCountSql) {\n      // globalQueryCountSql takes precendence over menuconfig sql\n      sql = globalQueryCountSql\n    }\n    const hasGroupByInSql = isGroupByInSql(sql)\n    const menuDropdown = this.renderMenuDropdown()\n    const queryWrapper = this.renderQueryChildren()\n    const showBarChart = stackedBarChartConfiguration !== undefined\n    return (\n      <React.Fragment>\n        {name && sql && !hasGroupByInSql && (\n          <h3 id=\"exploreCount\" className=\"SRC-boldText\">\n            <QueryCount\n              entityId={entityId}\n              token={token}\n              name={name}\n              sql={sql}\n            />\n          </h3>\n        )}\n        {hasGroupByInSql && (\n          <h3 id=\"exploreCount\" className=\"SRC-boldText\">\n            {name}\n          </h3>\n        )}\n        <div className=\"break\">\n          <hr />\n        </div>\n        <div className=\"row\" key=\"row\">\n          <div\n            className={`col-xs-12 col-sm-3 col-lg-2 SRC-menuLayout ${\n              showBarChart ? 'SRC-menuPadding' : 'SRC-menuPaddingLess'\n            }`}\n          >\n            {menuDropdown}\n          </div>\n          <div className=\"col-xs-12 col-sm-9 col-lg-10\" key=\"queryWrapper\">\n            {queryWrapper}\n          </div>\n        </div>\n      </React.Fragment>\n    )\n  }\n\n  private renderQueryChild(\n    menuConfig: MenuConfig[],\n    queryConfig: CommonMenuProps,\n    groupIndex: number,\n  ) {\n    const {\n      token,\n      rgbIndex = 0,\n      isConsistent = false,\n      searchParams,\n      accordionConfig = [],\n      facetAliases = {},\n      entityId,\n    } = this.props\n    const {\n      cardConfiguration,\n      tableConfiguration,\n      stackedBarChartConfiguration,\n      unitDescription = '',\n      searchConfiguration,\n    } = queryConfig\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    let facetValue = ''\n    let facetValueFromSearchParams = ''\n    if (searchParams) {\n      ;({\n        facetValue = '',\n        facet: facetValueFromSearchParams = '',\n      } = searchParams)\n    }\n\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const isSelected: boolean =\n        groupIndex === accordionGroupIndex &&\n        activeMenuIndices[accordionGroupIndex] === index\n      const { facet, sql } = config\n      const name =\n        accordionConfig[groupIndex] && accordionConfig[groupIndex].name\n      const hasGroupByInSql = isGroupByInSql(sql)\n      // only show search component if its the last item in the menu config\n      const showSearch =\n        index === menuConfig.length - 1 && searchConfiguration !== undefined\n      const showBarChart =\n        stackedBarChartConfiguration !== undefined &&\n        !showSearch &&\n        !hasGroupByInSql\n      const aliasedFacet: string =\n        facet && (facetAliases[facet] || unCamelCase(facet))\n\n      // search class is only used for testing, no css is actually applied\n      let searchClass = showSearch ? SEARCH_CLASS_CSS : ''\n      if (!isSelected) {\n        searchClass = 'SRC-hidden'\n      }\n\n      // Get props for query wrapper\n      const usedUnitDescription = this.getUnitDescription(\n        unitDescription,\n        aliasedFacet,\n        showSearch,\n        accordionConfig.length > 0,\n        name,\n      )\n      const isSelectedFromURL =\n        config.facet !== undefined &&\n        config.facet === facetValueFromSearchParams\n      const selectedFacets = this.getSelectedFacets(\n        isSelectedFromURL,\n        facet,\n        facetValue,\n      )\n      const partMask = this.getPartMask(facet, hasGroupByInSql)\n      const tableLoadingScreen = this.getTableLoadingScreen(\n        hasGroupByInSql,\n        stackedBarChartConfiguration,\n        tableConfiguration,\n      )\n      return (\n        <span key={(facet || 'nofacet') + index} className={searchClass}>\n          <QueryWrapper\n            showBarChart={showBarChart}\n            loadNow={isSelected}\n            initQueryRequest={{\n              partMask,\n              concreteType:\n                'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n              entityId,\n              query: {\n                sql,\n                selectedFacets,\n                isConsistent,\n                limit: 25,\n                offset: 0,\n              },\n            }}\n            unitDescription={usedUnitDescription}\n            facet={facet}\n            token={token}\n            rgbIndex={rgbIndex}\n            facetAliases={facetAliases}\n          >\n            {showBarChart ? (\n              <StackedBarChart {...stackedBarChartConfiguration!} />\n            ) : (\n              <React.Fragment />\n            )}\n            {!showSearch ? <Facets /> : <React.Fragment />}\n            {showSearch ? (\n              <Search searchable={searchConfiguration!.searchable} />\n            ) : (\n              <React.Fragment />\n            )}\n            {/*\n                Using a conditional render fails here because QueryWrapper can't clone an undefined element\n                which will happen if either configuration is undefined.\n            */}\n            {tableConfiguration ? (\n              <SynapseTable\n                {...{\n                  ...tableConfiguration,\n                  loadingScreen: tableLoadingScreen,\n                }}\n              />\n            ) : (\n              <React.Fragment />\n            )}\n            {cardConfiguration ? (\n              <CardContainer {...cardConfiguration} />\n            ) : (\n              <React.Fragment />\n            )}\n          </QueryWrapper>\n        </span>\n      )\n    })\n  }\n\n  public getUnitDescription(\n    unitDescription: string,\n    aliasedFacet: string,\n    showSearch: boolean,\n    isAccordionConfigDefined: boolean,\n    name: string,\n  ) {\n    if (isAccordionConfigDefined && !showSearch) {\n      return `${name} Tools by ${aliasedFacet}`\n    }\n    if (isAccordionConfigDefined && showSearch) {\n      // This is also a hardcoded setting to detect if search within a tools accordion is being shown\n      return `${name} Tools`\n    }\n    return unitDescription\n  }\n\n  public getPartMask(facet: string | undefined, hasGroupByInSql: boolean) {\n    let partMask =\n      SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n      SynapseConstants.BUNDLE_MASK_QUERY_RESULTS |\n      SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS\n    if (facet) {\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_FACETS\n    } else {\n      // Needed to calculate the total count for TotalQueryResults\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_COUNT\n    }\n    // note: COLUMN_MODELS unnecessary for Synapse Table link for aggregate functions since we now rely on the sql parser to distinguish.\n    return partMask\n  }\n\n  public getSelectedFacets(\n    isSelected: boolean,\n    facet: string | undefined,\n    facetValue: string | undefined,\n  ): FacetColumnValuesRequest[] {\n    if (isSelected && facet && facetValue) {\n      return [\n        {\n          concreteType:\n            'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n          facetValues: [facetValue],\n          columnName: facet,\n        },\n      ]\n    }\n    return []\n  }\n\n  public getSqlWithAdditionalClause(\n    isSelected: boolean,\n    facet: string | undefined,\n    facetValue: string | undefined,\n    sql: string,\n  ): string {\n    if (isSelected && facet && facetValue && this.props.searchParams) {\n      return insertConditionsFromSearchParams(\n        { [facet]: facetValue },\n        sql,\n        'LIKE',\n      )\n    }\n    return sql\n  }\n\n  public getTableLoadingScreen(\n    hasGroupByInSql: boolean,\n    stackedBarChartConfiguration: StackedBarChartProps | undefined,\n    tableConfiguration: SynapseTableProps | undefined,\n  ): JSX.Element {\n    if (hasGroupByInSql && stackedBarChartConfiguration && tableConfiguration) {\n      // Since the bar chart doesnt show when theres a a groupy statement we use the\n      // loadingScreen from the chart configuration\n      return stackedBarChartConfiguration.loadingScreen\n    }\n    return <></>\n  }\n\n  private renderQueryChildren() {\n    const { accordionConfig, menuConfig } = this.props\n    const { accordionGroupIndex } = this.state\n    if (accordionConfig) {\n      return accordionConfig.map((el, index) => {\n        return (\n          <div\n            key={JSON.stringify(el) + index}\n            className={accordionGroupIndex === index ? '' : 'SRC-hidden'}\n          >\n            {this.renderQueryChild(el.menuConfig, el, index)}\n          </div>\n        )\n      })\n    } else {\n      return this.renderQueryChild(menuConfig!, this.props, 0)\n    }\n  }\n\n  private renderMenuDropdown() {\n    const { accordionConfig, menuConfig, searchConfiguration } = this.props\n    const { accordionGroupIndex } = this.state\n    const { rgbIndex } = this.props\n    const { colorPalette } = getColorPallette(rgbIndex, 5)\n    const lightColor = '#F5F5F5'\n    if (accordionConfig) {\n      return accordionConfig.map((el, index) => {\n        const isActive = accordionGroupIndex === index\n        const primaryColor = colorPalette[0]\n        const style: React.CSSProperties = {\n          background: isActive ? primaryColor : lightColor,\n          color: isActive ? 'white' : '',\n        }\n        const indicatorClasses = isActive\n          ? 'SRC-whiteText SRC-pointed-triangle-down'\n          : ' SRC-hand-cursor '\n        if (isActive) {\n          style.borderTopColor = primaryColor\n        }\n        const hoverEnter: Info = {\n          isSelected: isActive,\n          originalColor: primaryColor,\n        }\n        const hoverLeave: Info = {\n          isSelected: isActive,\n          originalColor: lightColor,\n        }\n        const iconContainerStyle: React.CSSProperties = {\n          marginLeft: 5,\n        }\n        const iconStyle: React.CSSProperties = {\n          fontSize: '0.55em',\n        }\n        return (\n          <div\n            key={JSON.stringify(el)}\n            className={isActive ? ACCORDION_GROUP_ACTIVE_CSS : ''}\n          >\n            <div\n              style={style}\n              role={isActive ? '' : 'button'}\n              onMouseEnter={this.handleHoverLogic(hoverEnter)}\n              onMouseLeave={this.handleHoverLogic(hoverLeave)}\n              className={`${ACCORDION_GROUP_CSS} SRC-gap SRC-menu-button-base SRC-background-unset ${indicatorClasses}`}\n              onClick={\n                !isActive ? this.toggleGroupAccordionIndex(index) : undefined\n              }\n            >\n              {el.name}\n              <span style={iconContainerStyle}>\n                {!isActive && (\n                  <FontAwesomeIcon\n                    style={iconStyle}\n                    color={primaryColor}\n                    icon={'plus'}\n                  />\n                )}\n              </span>\n            </div>\n            <TransitionGroup component={null}>\n              {isActive && (\n                <CSSTransition\n                  // The component doesn't run a transition on mount, we override this\n                  // by setting appear to true because otherwise the triangle indicator wouldn't show\n                  appear={true}\n                  key={JSON.stringify(el)}\n                  classNames=\"SRC-accordion-menu\"\n                  timeout={{ enter: 1000, exit: 500 }}\n                >\n                  <div className={'SRC-accordion-menu'}>\n                    {this.renderFacetMenu(\n                      el.menuConfig,\n                      index,\n                      el.searchConfiguration,\n                    )}\n                  </div>\n                </CSSTransition>\n              )}\n            </TransitionGroup>\n          </div>\n        )\n      })\n    }\n    return this.renderFacetMenu(menuConfig!, 0, searchConfiguration)\n  }\n\n  private renderFacetMenu(\n    menuConfig: MenuConfig[],\n    curLevel: number,\n    searchConfiguration?: SearchProps,\n  ) {\n    const { rgbIndex, accordionConfig, facetAliases = {} } = this.props\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    const { colorPalette } = getColorPallette(rgbIndex, 5)\n    let originalColor = colorPalette[0]\n    let defaultColor = '#F5F5F5'\n    if (accordionConfig) {\n      originalColor = colorPalette[2]\n      defaultColor = colorPalette[4]\n    }\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const searchIconStyle: React.CSSProperties = {\n        margin: 'auto 0',\n        opacity: 0.4,\n      }\n      const { facet } = config\n      const isSelected: boolean =\n        activeMenuIndices[accordionGroupIndex] === index &&\n        curLevel === accordionGroupIndex\n      const style: React.CSSProperties = {}\n      const isSearchConfig =\n        index === menuConfig.length - 1 && searchConfiguration\n      let selectedStyling: string = ''\n      if (isSelected) {\n        // we have to programatically set the style since the color is chosen from a color\n        // wheel\n        style.background = originalColor\n        // below has to be set so the pseudo element created will inherit its color\n        // appropriately\n        style.borderLeftColor = originalColor\n        selectedStyling = 'SRC-pointed-triangle-right SRC-whiteText'\n        searchIconStyle.color = 'white'\n      } else {\n        // change background to class\n        selectedStyling = 'SRC-blackText'\n        style.background = defaultColor\n      }\n      const infoEnter: Info = { isSelected, originalColor }\n      const infoLeave: Info = { isSelected, originalColor: defaultColor }\n      const facetDisplayValue: string =\n        (facet && facetAliases[facet]) || unCamelCase(facet)\n      return (\n        <div\n          onMouseEnter={this.handleHoverLogic(infoEnter)}\n          onMouseLeave={this.handleHoverLogic(infoLeave)}\n          key={(config.facet || 'nofacet') + index}\n          className={`SRC-hand-cursor SRC-background-unset ${selectedStyling} SRC-menu-button-base SRC-gap`}\n          onClick={this.switchFacet(index, curLevel)}\n          onKeyPress={this.switchFacet(index, curLevel)}\n          role=\"button\"\n          tabIndex={0}\n          style={style}\n        >\n          {isSearchConfig ? 'Search' : facetDisplayValue}\n          {isSearchConfig && (\n            <span>\n              <FontAwesomeIcon\n                className={selectedStyling}\n                size={'sm'}\n                style={searchIconStyle}\n                icon=\"search\"\n              />\n            </span>\n          )}\n        </div>\n      )\n    })\n  }\n}\n","import React, { useState, useEffect } from 'react'\nimport { AccessRequirement } from '../../utils/synapseTypes/AccessRequirement/AccessRequirement'\nimport { getAllAccessRequirements } from '../../utils/SynapseClient'\nimport { SynapseConstants } from '../../utils/'\nimport Modal from 'react-bootstrap/Modal'\nimport SelfSignAccessRequirement from './SelfSignAccessRequirement'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faCircle } from '@fortawesome/free-solid-svg-icons'\nimport TermsOfUseAccessRequirement from './TermsOfUseAccessRequirement'\n\nlibrary.add(faCircle)\n\ntype Props = {\n  entityId: string\n  token: string | undefined\n  onHide?: Function\n}\n\nenum SUPPORTED_ACCESS_REQUIREMENTS {\n  SelfSignAccessRequirement = 'org.sagebionetworks.repo.model.SelfSignAccessRequirement',\n  TermsOfUseAccessRequirement = 'org.sagebionetworks.repo.model.TermsOfUseAccessRequirement',\n}\n\nexport default function AccessRequirementList({\n  entityId,\n  token,\n  onHide,\n}: Props) {\n  const [accessRequirements, setAccessRequirements] = useState<\n    Array<AccessRequirement>\n  >([])\n  const [isLoading, setIsLoading] = useState<boolean>(false)\n\n  useEffect(() => {\n    const getAccessRequirements = async () => {\n      if (!token) {\n        setAccessRequirements([])\n        // this view only makes sense when the user is logged in\n        return\n      }\n      setIsLoading(true)\n      try {\n        const incomingAccessRequirements = await getAllAccessRequirements(\n          token,\n          entityId,\n        )\n        // we use a functional update below https://reactjs.org/docs/hooks-reference.html#functional-updates\n        // because we want react hooks to update without a dependency on accessRequirements\n        setAccessRequirements(prevAcessRequirements =>\n          prevAcessRequirements.concat(incomingAccessRequirements),\n        )\n      } catch (err) {\n        console.error('Error on get access requirements: ', err)\n      } finally {\n        setIsLoading(false)\n      }\n    }\n    getAccessRequirements()\n  }, [token, entityId])\n\n  /**\n   * Returns rendering for the access requirement.\n   *\n   * Only supports SelfSignAccessRequirement and TermsOfUseAccessRequirement\n   *\n   * @param {AccessRequirement} accessRequirement accessRequirement being rendered\n   */\n  const renderAccessRequirement = (accessRequirement: AccessRequirement) => {\n    switch (accessRequirement.concreteType) {\n      case SUPPORTED_ACCESS_REQUIREMENTS.SelfSignAccessRequirement:\n        return (\n          <SelfSignAccessRequirement accessRequirement={accessRequirement} />\n        )\n      case SUPPORTED_ACCESS_REQUIREMENTS.TermsOfUseAccessRequirement:\n        return (\n          <TermsOfUseAccessRequirement accessRequirement={accessRequirement} />\n        )\n      default:\n        // case not supported yet, go to synapse\n        return (\n          <a\n            href={`https://www.synapse.org/#!AccessRequirements:ID=${entityId}&TYPE=ENTITY`}\n          >\n            See Requirements on synapse.org\n          </a>\n        )\n    }\n  }\n\n  return (\n    <Modal onHide={() => onHide?.()} show={true} animation={false}>\n      <Modal.Header closeButton={true}>\n        <Modal.Title>Data Access Request</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>\n        <h4 className=\"uppercase-text bold-text\">You Requested Access For:</h4>\n        <p> TODO: Entity Name </p>\n        <h4 className=\"uppercase-text bold-text\"> What do I need to do? </h4>\n        <div className=\"requirement-container\">\n          <div className=\"direction-label\">1</div>\n          <div>\n            <p className=\"bold-text\">\n              <button\n                className={`${SynapseConstants.SRC_SIGN_IN_CLASS} sign-in-btn`}\n              >\n                Sign in\n              </button>\n              with a Sage Platform (synapse) user account.\n            </p>\n            <p>\n              If you do not have a Sage Account, you can\n              <a href=\"https://www.synapse.org/#!RegisterAccount:0\">\n                &nbsp;Register for free.\n              </a>\n            </p>\n          </div>\n        </div>\n        {isLoading && <span className=\"spinner\" />}\n        {accessRequirements.map(req => {\n          return renderAccessRequirement(req)\n        })}\n      </Modal.Body>\n    </Modal>\n  )\n}\n","import * as React from 'react'\nimport {\n  createEntity,\n  getEntity,\n  lookupChildEntity,\n  updateEntity,\n  uploadFile,\n} from '../utils/SynapseClient'\nimport {\n  EntityId,\n  EntityLookupRequest,\n  FileEntity,\n  FileUploadComplete,\n} from '../utils/synapseTypes/'\n\ntype UploaderState = {\n  token?: string\n  error?: any\n  totalFilesToUploadCount: number\n  filesUploadedCount: number\n  isUploading?: boolean\n  successfullyUploaded: boolean\n}\n\nexport type UploaderProps = {\n  token?: string\n  parentContainerId: string\n}\n\nexport default class Uploader extends React.Component<\n  UploaderProps,\n  UploaderState\n> {\n  private readonly inputOpenFileRef: React.RefObject<HTMLInputElement>\n\n  constructor(props: UploaderProps) {\n    super(props)\n    this.state = {\n      token: '',\n      isUploading: false,\n      filesUploadedCount: 0,\n      totalFilesToUploadCount: 0,\n      successfullyUploaded: false,\n    }\n    this.inputOpenFileRef = React.createRef()\n  }\n\n  showOpenFileDlg = () => {\n    if (this.inputOpenFileRef && this.inputOpenFileRef.current) {\n      this.inputOpenFileRef.current.click()\n    }\n  }\n\n  handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files) {\n      this.handleFilesChanged(event.target.files)\n    }\n  }\n\n  finishedProcessingOneFile = () => {\n    const incrementedFilesUploadedCount = this.state.filesUploadedCount + 1\n    const isStillUploading =\n      incrementedFilesUploadedCount < this.state.totalFilesToUploadCount\n    this.setState({\n      isUploading: isStillUploading,\n      filesUploadedCount: incrementedFilesUploadedCount,\n      successfullyUploaded: !isStillUploading,\n    })\n  }\n\n  handleUploadError = (error: any) => {\n    this.finishedProcessingOneFile()\n    this.setState({ error })\n  }\n\n  handleFilesChanged = (selectorFiles: FileList) => {\n    this.setState({\n      error: undefined,\n      isUploading: true,\n      filesUploadedCount: 0,\n      totalFilesToUploadCount: selectorFiles.length,\n      successfullyUploaded: false,\n    })\n    Array.from(selectorFiles).forEach(file => {\n      // check for existing filename in parent folder before upload (add new version if exists).\n      // note that the parent container (project/folder) is configurable.\n      const newFileEntity: FileEntity = {\n        parentId: this.props.parentContainerId,\n        name: file.name,\n        concreteType: 'org.sagebionetworks.repo.model.FileEntity',\n        dataFileHandleId: '',\n      }\n      const entityLookupRequest: EntityLookupRequest = {\n        entityName: file.name,\n        parentId: this.props.parentContainerId,\n      }\n      lookupChildEntity(entityLookupRequest, this.props.token)\n        .then((entityId: EntityId) => {\n          // ok, found an entity of the same name.\n          getEntity<FileEntity>(this.props.token, entityId.id).then(\n            (existingEntity: FileEntity) => {\n              if (\n                existingEntity.concreteType ===\n                'org.sagebionetworks.repo.model.FileEntity'\n              ) {\n                this.updateEntityFile(existingEntity, file)\n              } else {\n                this.updateEntityFile(newFileEntity, file)\n              }\n            },\n          )\n        })\n        .catch((error: any) => {\n          if (error.status === 404) {\n            // great, it's a new file!\n            this.updateEntityFile(newFileEntity, file)\n          } else {\n            this.handleUploadError(error)\n          }\n        })\n    })\n  }\n\n  updateEntityFile = (fileEntity: FileEntity, file: File) => {\n    uploadFile(this.props.token, file.name, file)\n      .then((fileUploadComplete: FileUploadComplete) => {\n        const isCreate = fileEntity.dataFileHandleId === ''\n        fileEntity.dataFileHandleId = fileUploadComplete.fileHandleId\n        const createOrUpdate = isCreate ? createEntity : updateEntity\n        createOrUpdate(fileEntity, this.props.token).then(() => {\n          this.finishedProcessingOneFile()\n        })\n      })\n      .catch((error: any) => {\n        this.handleUploadError(error)\n      })\n  }\n\n  render() {\n    return (\n      <div>\n        {/** This input field is used for it's functionally (browse for files), the button acts as the UI. */}\n        <input\n          ref={this.inputOpenFileRef}\n          type=\"file\"\n          style={{ display: 'none' }}\n          onChange={this.handleChange}\n          multiple={true}\n        />\n        <button\n          type=\"button\"\n          onClick={this.showOpenFileDlg}\n          className=\"SRC-uploadButton\"\n        >\n          Browse...\n        </button>\n        {this.state.isUploading && (\n          <React.Fragment>\n            <span style={{ marginLeft: '10px' }}>\n              {this.state.filesUploadedCount} /\n              {this.state.totalFilesToUploadCount} file(s)\n            </span>\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          </React.Fragment>\n        )}\n        {this.state.successfullyUploaded && (\n          <span style={{ marginLeft: '10px' }}>\n            Successfully uploaded {this.state.totalFilesToUploadCount} file(s)\n            to\n            <a\n              style={{ marginLeft: '2px' }}\n              href={`https://www.synapse.org/#!Synapse:${this.props.parentContainerId}`}\n              rel=\"noopener noreferrer\"\n              target=\"_blank\"\n            >\n              {this.props.parentContainerId}\n            </a>\n          </span>\n        )}\n        {this.state.error && <p>Upload error!</p>}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport {\n  getEntity,\n  getFileEntityContent,\n  updateEntity,\n  uploadFile,\n} from '../utils/SynapseClient'\nimport { Entity, FileEntity, FileUploadComplete } from '../utils/synapseTypes/'\n\ntype FileContentDownloadUploadDemoState = {\n  token?: string\n  error?: any\n  isLoading?: boolean\n  fileContent?: string\n  targetEntity?: FileEntity\n}\n\nexport type FileContentDownloadUploadDemoProps = {\n  token?: string\n  targetEntityId: string\n}\n\nexport default class FileContentDownloadUploadDemo extends React.Component<\n  FileContentDownloadUploadDemoProps,\n  FileContentDownloadUploadDemoState\n> {\n  constructor(props: FileContentDownloadUploadDemoProps) {\n    super(props)\n    this.state = {\n      token: '',\n      isLoading: false,\n    }\n  }\n\n  public componentDidMount() {\n    const { token, targetEntityId } = this.props\n    // must be logged in to download content\n    if (token) {\n      this.setState({ isLoading: true })\n      getEntity(token, targetEntityId)\n        .then((entity: Entity) => {\n          // if file entity\n          if (\n            entity.concreteType === 'org.sagebionetworks.repo.model.FileEntity'\n          ) {\n            const fileEntity: FileEntity = entity as FileEntity\n            getFileEntityContent(token, fileEntity).then(content => {\n              this.setState({\n                fileContent: content,\n                targetEntity: fileEntity,\n                isLoading: false,\n              })\n            })\n          } else {\n            this.setState({ error: 'invalid type', isLoading: false })\n          }\n        })\n        .catch(err => {\n          this.setState({ error: err, isLoading: false })\n        })\n    }\n  }\n\n  updateFileContent = (event: React.MouseEvent<HTMLButtonElement>) => {\n    // create a new FileHandle, and update the FileEntity\n    if (this.props.token && this.state.targetEntity && this.state.fileContent) {\n      this.setState({ isLoading: true })\n      const newFileContent = new Blob([this.state.fileContent], {\n        type: 'text/plain',\n      })\n      uploadFile(this.props.token, this.state.targetEntity.name, newFileContent)\n        .then((fileUploadComplete: FileUploadComplete) => {\n          // now update the entity!\n          if (this.state.targetEntity) {\n            this.state.targetEntity.dataFileHandleId =\n              fileUploadComplete.fileHandleId\n            updateEntity(this.state.targetEntity, this.props.token)\n              .then((entity: Entity) => {\n                const fileEntity = entity as FileEntity\n                // updated the target entity, force it to get the updated entity\n                this.setState({ targetEntity: fileEntity, isLoading: false })\n              })\n              .catch((err: string) => {\n                this.setState({ error: err, isLoading: false })\n              })\n          }\n        })\n        .catch((err: string) => {\n          this.setState({ error: err, isLoading: false })\n        })\n    }\n  }\n  handleContentChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.setState({ fileContent: event.target.value })\n  }\n\n  render() {\n    return (\n      <div>\n        {this.state.fileContent && (\n          <React.Fragment>\n            <div>\n              <textarea\n                style={{ width: '100%', height: '300px' }}\n                value={this.state.fileContent}\n                onChange={this.handleContentChange}\n              />\n            </div>\n            <button onClick={this.updateFileContent}>\n              Update File Content...\n            </button>\n          </React.Fragment>\n        )}\n        {this.state.isLoading && (\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        )}\n\n        {this.state.error && <p>Download error!</p>}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport Plotly from 'plotly.js-basic-dist'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SynapseClient } from '../utils'\nimport {\n  ProjectFilesStatisticsRequest,\n  ProjectFilesStatisticsResponse,\n  FilesCountStatistics,\n} from '../utils/synapseTypes/'\nconst Plot = createPlotlyComponent(Plotly)\n\nconst months = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec',\n]\n\nexport type StatisticsPlotProps = {\n  request: ProjectFilesStatisticsRequest\n  token?: string\n  title?: string\n  xtitle?: string\n  ytitle?: string\n  isHorizontal?: boolean\n  xaxistype?: string\n  showlegend?: boolean\n}\n\ntype StatisticsPlotState = {\n  isLoaded: boolean\n  plotData?: ProjectFilesStatisticsResponse\n}\n\nclass StatisticsPlot extends React.Component<\n  StatisticsPlotProps,\n  StatisticsPlotState\n> {\n  constructor(props: StatisticsPlotProps) {\n    super(props)\n    this.state = {\n      isLoaded: false,\n      plotData: {} as ProjectFilesStatisticsResponse,\n    }\n  }\n\n  public componentDidMount() {\n    this.fetchPlotlyData()\n  }\n  /**\n   * Get data for plotly\n   *\n   * @returns data corresponding to plotly widget\n   */\n  fetchPlotlyData = async () => {\n    const { request, token } = this.props\n    return SynapseClient.getProjectStatistics(request, token)\n      .then((data: ProjectFilesStatisticsResponse) => {\n        this.setState({\n          isLoaded: true,\n          plotData: data,\n        })\n      })\n      .catch((err: any) => {\n        console.log('Error on call to get statistics ', err)\n      })\n  }\n\n  getTrace = (\n    traceName: string,\n    stats: FilesCountStatistics[],\n    orientation: string,\n    markerColor: string,\n  ) => {\n    const x: string[] = []\n    const y: number[] = []\n    const trace = {\n      orientation,\n      x,\n      y,\n      name: traceName,\n      type: 'bar',\n      marker: { color: markerColor },\n      hovertemplate:\n        // see S3 Formatting options: https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format\n        `%{y:n} <br><extra>${traceName}</extra>`,\n    }\n    for (const statPoint of stats) {\n      const statPointDate: Date = new Date(statPoint.rangeStart)\n      trace.x.push(\n        `${\n          months[statPointDate.getUTCMonth()]\n        } ${statPointDate.getUTCFullYear()}`,\n      )\n      trace.y.push(statPoint.filesCount)\n    }\n    return trace\n  }\n\n  showPlot = () => {\n    if (!this.state.isLoaded || !this.state.plotData) {\n      return\n    }\n    const {\n      title,\n      xtitle,\n      ytitle,\n      isHorizontal,\n      xaxistype,\n      showlegend,\n    } = this.props\n    const plotData = this.state.plotData\n    const layout: any = {\n      showlegend,\n      title,\n      barmode: 'stack',\n      hovermode: 'x',\n    }\n    const config: any = {\n      displayModeBar: true,\n      displaylogo: false,\n      // options found here: https://github.com/plotly/plotly.js/blob/master/src/components/modebar/buttons.js\n      modeBarButtonsToRemove: [\n        'sendDataToCloud',\n        'hoverCompareCartesian',\n        'select2d',\n        'lasso2d',\n        'zoom2d',\n        'resetScale2d',\n        'hoverClosestCartesian',\n        'toggleSpikelines',\n      ],\n    }\n    if (xtitle) {\n      layout.xaxis = {\n        title: xtitle,\n      }\n    }\n    if (xaxistype) {\n      layout.xaxis = {\n        ...layout.xaxis,\n        xaxistype: xaxistype.toLowerCase(),\n      }\n    }\n\n    if (ytitle) {\n      layout.yaxis = {\n        title: ytitle,\n      }\n    }\n    // init plot_data\n    const orientation: string = isHorizontal ? 'h' : 'v'\n    const traces: any = []\n    if (\n      plotData.fileDownloads &&\n      plotData.fileDownloads.months &&\n      plotData.fileDownloads.months.length > 0\n    ) {\n      // add file downloads trace\n      traces.push(\n        this.getTrace(\n          'File Downloads',\n          plotData.fileDownloads.months,\n          orientation,\n          '#7CC0C4',\n        ),\n      )\n    }\n    if (\n      plotData.fileUploads &&\n      plotData.fileUploads.months &&\n      plotData.fileUploads.months.length > 0\n    ) {\n      // add file uploads trace\n      traces.push(\n        this.getTrace(\n          'File Uploads',\n          plotData.fileUploads.months,\n          orientation,\n          '#D4689A',\n        ),\n      )\n    }\n    if (traces.length > 0)\n      return (\n        <Plot\n          layout={layout}\n          data={traces}\n          config={config}\n          className=\"SRC-fullWidth\"\n          useResizeHandler={true}\n        />\n      )\n    else return <></>\n  }\n\n  public render() {\n    if (!this.state.isLoaded) {\n      return null\n    }\n    return this.showPlot()\n  }\n}\nexport default StatisticsPlot\n","import * as React from 'react'\nimport { SynapseVersion } from '../../lib/utils/synapseTypes/'\nimport { SynapseClient } from '../../lib/utils/'\nimport QueryWrapperMenu, {\n  MenuConfig, QueryWrapperMenuProps,\n} from '../../lib/containers/QueryWrapperMenu'\nimport Uploader from '../../lib/containers/Uploader'\nimport FileContentDownloadUploadDemo from '../../lib/containers/FileContentDownloadUploadDemo'\nimport StatisticsPlot from 'lib/containers/StatisticsPlot'\nimport { testDownloadSpeed } from '../../lib/utils/functions/testDownloadSpeed'\nimport HasAccess from 'lib/containers/HasAccess'\n\ntype DemoState = {\n  token: string | null\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  tabOne: QueryWrapperMenuProps\n  tabTwo: QueryWrapperMenuProps\n  showTabOne: boolean\n  userFormDataSynId?: string\n  estimatedDownloadBytesPerSecond?: number\n}\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n\n */\nclass Demo extends React.Component<{}, DemoState> {\n  entityFormRef: any\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    this.entityFormRef = React.createRef()\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      token: '',\n      version: 0,\n      showTabOne: true,\n      tabOne: {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          enableDownloadConfirmation: true,\n          enableLeftFacetFilter: true\n        },\n        entityId: 'syn16787123',\n        menuConfig: [\n          {\n            facet: 'dataStatus',\n            sql: 'SELECT studyStatus, dataStatus FROM syn16787123',\n          },\n          {\n            facet: 'projectStatus',\n            sql: 'SELECT * FROM syn16787123',\n          },\n          {\n            facet: 'name',\n            sql: 'SELECT name, grant FROM syn11346063',\n          },\n          {\n            facet: 'grant',\n            sql: 'SELECT name, grant FROM syn11346063 Group by grant',\n          },\n          {\n            facet: 'name',\n            sql: 'SELECT name, grant, sex, dataType, consortium FROM syn11346063 WHERE ( ( \"consortium\" = \\'AMP-AD\\') )',\n          },\n\n          {\n            facet: 'model',\n            sql: 'SELECT * FROM syn21498718',\n          },\n          {\n            facet: 'metadataType',\n            sql: \"SELECT `id`, `metadataType`, `dataType`, `assay`↵  FROM syn11346063↵  WHERE ((`study` LIKE '%BroadAstrom109%') AND (`dataSubtype` = 'metadata'))\"\n          }\n        ],\n        rgbIndex: 2,\n      },\n      tabTwo: {\n        entityId: 'syn16858331',\n        tableConfiguration: {\n          title: 'title',\n          showAccessColumn: true,\n        },\n        menuConfig: [\n          {\n            facet: 'assay',\n            sql: 'SELECT * FROM syn21156352',\n          },\n          {\n            facet: 'study',\n            sql:\n            'SELECT study, dataType, assay, id AS file_id, specimenID, individualID, diagnosis, sex, consortium as \"Program\", grant, species, organ, tissue, cellType, fileFormat FROM syn11346063',\n          },\n          {\n            facet: 'diagnosis',\n            sql:\n              'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          },\n          {\n            facet: 'individuals',\n            sql:\n              'SELECT diagnosis, sex, dataType, assay, count(distinct(id)) as \"Files\", count(distinct(specimenID)) as \"Specimens\", count(distinct(individualID)) as \"Individuals\" FROM syn11346063 GROUP BY 1,2,3,4 ORDER BY 1 DESC',\n          },\n        ] as MenuConfig[],\n        rgbIndex: 5,\n      },\n    }\n    this.getVersion = this.getVersion.bind(this)\n    this.onRunDownloadSpeedTest = this.onRunDownloadSpeedTest.bind(this)\n  }\n\n  public onSubmitEntityForm() {\n    this.entityFormRef.current.submitForm()\n  }\n\n  public onEntityFormSubmitted(synId: string) {\n    this.setState({ userFormDataSynId: synId })\n  }\n\n  public onRunDownloadSpeedTest() {\n    const { token } = this.state\n    if (token) {\n      testDownloadSpeed(token)\n        .then((estimatedDownloadBytesPerSecond: number) => {\n          this.setState({ estimatedDownloadBytesPerSecond })\n        })\n        .catch((error: any) => {\n          console.error('estimate download speed failed', error)\n        })\n    }\n  }\n\n  /**\n   * Get the current version of Synapse\n   */\n  public getVersion(): void {\n    // IMPORTANT: Your component should have a property (with default) to change the endpoint.  This is necessary for Synapse.org integration.\n    // Pass your endpoint through to the rpc call:\n    // SynapseClient.getVersion('https://repo-staging.prod.sagebase.org')\n    SynapseClient.getVersion()\n      .then((data: SynapseVersion) => this.setState({ version: data.version }))\n      .catch((error: any) => {\n        // Handle HTTPError.  Has status and message.\n        console.error('Get version failed', error)\n      })\n  }\n\n  public componentDidMount() {\n    // Note:  All portals should do this once on the initial app load.\n    // This looks for the session token cookie (HttpOnly, unable to directly access), and initialize the session if it does exists.\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then(sessionToken => {\n        this.setState({\n          token: sessionToken,\n        })\n      })\n      .catch((error: any) => {\n        console.error(error)\n      })\n    this.getVersion()\n  }\n  public render(): JSX.Element {\n    const { token, estimatedDownloadBytesPerSecond } = this.state\n    return (\n      <div>\n        <p className=\"App-intro text-center\">\n          Synapse production version: {this.state.version}\n        </p>\n        {token && (\n          <div className=\"container\">\n            <button\n              className=\"btn btn-default\"\n              onClick={this.onRunDownloadSpeedTest}\n            >\n              Run Download Speed Test\n            </button>\n            <hr />\n          </div>\n        )}\n        {estimatedDownloadBytesPerSecond && (\n          <div className=\"container\">\n            <h5>\n              Estimated Download Speed:{' '}\n              {(estimatedDownloadBytesPerSecond / 1000000).toFixed(2)} MBps\n            </h5>\n            <hr />\n          </div>\n        )}\n        {token && (\n          <div className=\"container\">\n            <h5>Upload File(s) Demo</h5>\n            <Uploader token={token} parentContainerId=\"syn18987891\" />\n            <hr />\n          </div>\n        )}\n        {token && (\n          <div className=\"container\">\n            <h5>Download File Content Demo (syn12196718)</h5>\n            <FileContentDownloadUploadDemo\n              token={token}\n              targetEntityId=\"syn12196718\"\n            />\n            <hr />\n          </div>\n        )}\n        { \n        <div className=\"container\">\n            <h5>Public Folder - HasAccess widget</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn7122428'}\n              isInDownloadList={false}\n            />\n            <h5>A Controlled Access Folder - HasAccess widget</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn7383419'}\n              isInDownloadList={false}\n            />\n            <h5>Open Data</h5>\n            <HasAccess\n              token={token ? token : undefined}\n              entityId={'syn5481758'}\n              isInDownloadList={false}\n            />\n            <hr />\n          </div>\n        }\n        {token && (\n          <div className=\"container\">\n            <h5>Project Statistics Demo</h5>\n            <StatisticsPlot\n              token={token}\n              request={{\n                concreteType:\n                  'org.sagebionetworks.repo.model.statistics.ProjectFilesStatisticsRequest',\n                objectId: 'syn2580853',\n                fileDownloads: true,\n                fileUploads: true,\n              }}\n            />\n            <StatisticsPlot\n              token={token}\n              request={{\n                concreteType:\n                  'org.sagebionetworks.repo.model.statistics.ProjectFilesStatisticsRequest',\n                objectId: 'syn5585645',\n                fileDownloads: true,\n                fileUploads: true,\n              }}\n            />\n            <hr />\n          </div>\n        )}\n        <div className=\"container\">\n          <button\n            className=\"btn btn-default\"\n            onClick={() => {\n              this.setState({ showTabOne: !this.state.showTabOne })\n            }}\n          >\n            toggle config for query wrapper menu\n          </button>\n          <QueryWrapperMenu\n            isConsistent={true}\n            name={'Demo'}\n            entityId={ this.state.showTabOne\n              ? this.state.tabOne.entityId\n              : this.state.tabTwo.entityId}\n            token={\n              SynapseClient.IS_OUTSIDE_SYNAPSE_ORG ? token! : this.state.token!\n            }\n            unitDescription={\n              this.state.showTabOne\n                ? this.state.tabOne.unitDescription\n                : this.state.tabTwo.unitDescription\n            }\n            tableConfiguration={\n              this.state.showTabOne\n                ? this.state.tabOne.tableConfiguration\n                : this.state.tabTwo.tableConfiguration\n            }\n            menuConfig={\n              this.state.showTabOne\n                ? this.state.tabOne.menuConfig\n                : this.state.tabTwo.menuConfig\n            }\n            rgbIndex={\n              this.state.showTabOne\n                ? this.state.tabOne.rgbIndex\n                : this.state.tabTwo.rgbIndex\n            }\n            stackedBarChartConfiguration={{\n              loadingScreen: <div />,\n            }}\n          />\n        </div>\n      </div>\n    )\n  }\n}\nexport default Demo\n","import * as React from 'react'\nimport QueryWrapperMenu, {\n  MenuConfig,\n  QueryWrapperMenuProps,\n} from '../../../lib/containers/QueryWrapperMenu'\nimport { SynapseConstants } from '../../../lib/utils'\nimport { GenericCardSchema } from '../../../lib/containers/GenericCard'\n\ntype DemoState = {\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  tabOne: QueryWrapperMenuProps\n  tabTwo: QueryWrapperMenuProps\n  tabThree: QueryWrapperMenuProps\n  tabFour: QueryWrapperMenuProps\n  activeTab: number\n}\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nclass QueryWrapperMenuDemo extends React.Component<\n  { rgbIndex: number },\n  DemoState\n> {\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    const experimentalSql =\n      \"SELECT * FROM syn20337467 WHERE toolType = 'experimental' LIMIT 100\"\n    const computationalSql =\n      \"SELECT * FROM syn20337467 WHERE toolType = 'computational' LIMIT 100\"\n    const genericCardSchema: GenericCardSchema = {\n      title: 'Title',\n      type: 'Generic Tool',\n      subTitle: 'softwareType',\n      description: 'summary',\n      icon: 'icon',\n      secondaryLabels: ['contributor', 'diagnosis', 'program'],\n    }\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      activeTab: 3,\n      tabFour: {\n        stackedBarChartConfiguration: {\n          loadingScreen: <div> Im loading as fast I can! </div>,\n        },\n        unitDescription: 'apples',\n        entityId: 'syn21085100',\n        tableConfiguration: {\n          title: 'title',\n          markdownColumns: ['fruit', 'vegetable'],\n        },\n        menuConfig: [\n          {\n            facet: 'fruit',\n            sql: 'select * from syn21085100',\n          },\n        ],\n        rgbIndex: 3,\n      },\n      tabThree: {\n        stackedBarChartConfiguration: {\n          loadingScreen: <div> Im loading as fast I can! </div>,\n        },\n        entityId: 'syn11346063',\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n        },\n        searchConfiguration: {\n          searchable: [\n            {\n              columnName: 'study',\n              hintText: 'study name',\n            },\n          ],\n        },\n        menuConfig: [\n          {\n            facet: 'species',\n            sql: 'SELECT id, name FROM syn11346063 LIMIT 1000',\n          },\n          {\n            facet: 'study',\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n          {\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n        ] as MenuConfig[],\n        rgbIndex: 5,\n      },\n      tabTwo: {\n        name: 'Demo',\n        unitDescription: 'persons',\n        cardConfiguration: {\n          genericCardSchema,\n          type: SynapseConstants.MEDIUM_USER_CARD,\n          loadingScreen: (\n            <div style={{ height: 450 }}> I'm loading as fast I can! </div>\n          ),\n        },\n        rgbIndex: 1,\n        facetAliases: {\n          grant: 'Grant',\n        },\n        entityId: 'syn20337467',\n        accordionConfig: [\n          {\n            name: 'Compuational',\n            cardConfiguration: {\n              genericCardSchema,\n              type: SynapseConstants.GENERIC_CARD,\n              loadingScreen: (\n                <div style={{ height: 450 }}> I'm loading as fast I can! </div>\n              ),\n            },\n            menuConfig: [\n              {\n                facet: 'grant',\n                sql: computationalSql,\n              },\n              {\n                facet: 'diagnosis',\n                sql: computationalSql,\n              },\n              {\n                facet: 'modelType',\n                sql: computationalSql,\n              },\n            ],\n          },\n          {\n            name: 'Experimental',\n            cardConfiguration: {\n              genericCardSchema,\n              type: SynapseConstants.GENERIC_CARD,\n              loadingScreen: (\n                <div style={{ height: 450 }}> I'm loading as fast I can! </div>\n              ),\n            },\n            menuConfig: [\n              {\n                facet: 'program',\n                sql: experimentalSql,\n              },\n              {\n                facet: 'reagentType',\n                sql: experimentalSql,\n              },\n              {\n                facet: 'softwareType',\n                sql: experimentalSql,\n              },\n            ],\n          },\n        ],\n      },\n      tabOne: {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n        },\n        entityId: 'syn11346063',\n        searchConfiguration: {\n          searchable: [\n            {\n              columnName: 'study',\n              hintText: 'study name',\n            },\n          ],\n        },\n        menuConfig: [\n          {\n            facet: 'diagnosis',\n            sql:\n              'SELECT study, assay, count(distinct id) AS files, concat(organ) AS organs' +\n              \" FROM syn17024112 WHERE species='Human' AND assay='rnaSeq' group by 1,2 order by 3 desc limit 1000\",\n          },\n          {\n            facet: 'PORTALS-712',\n            sql:\n              'SELECT dataType, assay, fileFormat, COUNT(distinct id) AS Files ' +\n              \"FROM syn11346063 WHERE (study LIKE '%MODEL-AD_5XFAD%') GROUP BY 1, 2, 3 ORDER BY 4 DESC\",\n          },\n          {\n            facet: 'PORTALS-803',\n            sql:\n              'SELECT diagnosis AS \"Diagnosis\", sex as \"Sex\", dataType as \"Data Type\", assay as \"Assay\", count(distinct(id)) as \"Files\", count(distinct(specimenID)) as \"Specimens\", count(distinct(individualID)) as \"Individuals\" FROM syn11346063 GROUP BY 1,2,3,4 ORDER BY 1 DESC',\n          },\n          {\n            facet: 'study',\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n          // {\n          //   facet: 'dataType',\n          //   sql: 'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          //   synapseId: 'syn16858331',\n          //   title: 'title',\n          //   unitDescription: 'descriptive unit'\n          // },\n        ] as MenuConfig[],\n        rgbIndex: 5,\n      },\n      version: 0,\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.removeHandler = this.removeHandler.bind(this)\n  }\n\n  /**\n   * Update internal state\n   * @param {Object} updatedState new state to be updated by the component\n   */\n  public handleChange(updatedState: {}): void {\n    this.setState(updatedState)\n  }\n\n  public removeHandler(): void {\n    this.setState({ showMarkdown: !this.state.showMarkdown })\n  }\n\n  public render(): JSX.Element {\n    const { activeTab } = this.state\n    let props: QueryWrapperMenuProps = {} as QueryWrapperMenuProps\n    if (activeTab === 0) {\n      props = this.state.tabOne\n    } else if (activeTab === 1) {\n      props = this.state.tabTwo\n    } else if (activeTab === 2) {\n      props = this.state.tabThree\n    } else {\n      props = this.state.tabFour\n    }\n    return (\n      <div className=\"container\">\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 0 })\n          }}\n        >\n          With Group By\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 1 })\n          }}\n        >\n          With Tools\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 2 })\n          }}\n        >\n          Standard\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ activeTab: 3 })\n          }}\n        >\n          Table with markdown\n        </button>\n        <h2>Demo of table</h2>\n        <QueryWrapperMenu isConsistent={true} {...props} />\n      </div>\n    )\n  }\n}\nexport default QueryWrapperMenuDemo\n","import * as React from 'react'\nimport CardContainerLogic, {\n  CardConfiguration,\n} from '../../../lib/containers/CardContainerLogic'\nimport { SynapseConstants } from '../../../lib'\nimport brainSvg from './icons/brain.svg'\nimport circleSvg from './icons/circle.svg'\nimport mouseSvg from './icons/mouse.svg'\nimport resilienceadSvg from './icons/resiliencead.svg'\n\ntype State = {\n  tabIndex: Number\n}\n\nexport default class CardContainerLogicDemo extends React.Component<{}, State> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      tabIndex: 2,\n    }\n  }\n\n  render() {\n    const { tabIndex } = this.state\n    const iconOptions = {\n      'AMP-AD': circleSvg,\n      'M2OVE-AD': brainSvg,\n      'MODEL-AD': mouseSvg,\n      'Resilience-AD': resilienceadSvg,\n    }\n    \n    const genericCardSchema: CardConfiguration = {\n      type: SynapseConstants.GENERIC_CARD,\n      genericCardSchema: {\n        type: SynapseConstants.DATASET,\n        title: 'portalDisplayName',\n        subTitle: 'centerName',\n        description: 'summary',\n        secondaryLabels: ['externalLink'],\n      },\n      labelLinkConfig: [\n        {\n          isMarkdown: true,\n          matchColumnName: 'externalLink',\n        },\n      ],\n    }\n    return (\n      <div>\n        <hr />\n        <p> Generic Card Rendering </p>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.setState({ tabIndex: 0 })}\n        >\n          Header Card\n        </button>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.setState({ tabIndex: 1 })}\n        >\n          People Card\n        </button>\n        <button\n          className=\"btn btn-primary\"\n          onClick={() => this.setState({ tabIndex: 2 })}\n        >\n          Other Card\n        </button>\n        <div style={{ height: 50 }} />\n        {tabIndex === 0 && (\n          <CardContainerLogic\n            type={SynapseConstants.GENERIC_CARD}\n            sql={'SELECT * FROM syn17024173'}\n            entityId={'syn17024173'}\n            searchParams={{ Program: 'AMP-AD' }}\n            genericCardSchema={{\n              type: 'Program',\n              title: 'Full Name',\n              subTitle: 'Short Description',\n              icon: 'Program',\n            }}\n            backgroundColor={'#5960a5'}\n            isHeader={true}\n            iconOptions={iconOptions}\n          />\n        )}\n        {tabIndex === 1 && (\n          <CardContainerLogic\n            type={SynapseConstants.MEDIUM_USER_CARD}\n            sql={'SELECT ownerID as ownerId FROM syn13897207'}\n            entityId={'syn13897207'}\n            loadingScreen={<div> Im loading as fast I can !!! </div>}\n          />\n        )}\n        {tabIndex === 2 && (\n          <div className=\"container-fluid\">\n            <div className=\"row\">\n              <div className=\"col-md-10 col-md-offset-1\">\n                <CardContainerLogic\n                  type={SynapseConstants.GENERIC_CARD}\n                  sql={'SELECT * FROM syn18488466 group by externalLink'}\n                  entityId={'syn18488466'}\n                  unitDescription=\"studies\"\n                  {...genericCardSchema}\n                  secondaryLabelLimit={3}\n                />\n              </div>\n            </div>\n          </div>\n        )}\n        <div style={{ height: 50 }} />\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport QueryWrapper from 'lib/containers/QueryWrapper'\nimport Search, { Searchable } from 'lib/containers/Search'\nimport { SynapseConstants } from 'lib'\nimport { GenericCardSchema } from 'lib/containers/GenericCard'\nimport { CardConfiguration } from 'lib/containers/CardContainerLogic'\nimport CardContainer from 'lib/containers/CardContainer'\n\nexport const SearchDemo: React.SFC = () => {\n  const sql = 'SELECT * FROM syn20337467'\n  const facetAliases = {\n    contributor: 'Contributor',\n    diagnosis: 'Diagnosis',\n  }\n  const searchable: Searchable = [\n    {\n      columnName: 'summary',\n      hintText: 'summary',\n    },\n    {\n      columnName: 'contributor',\n      hintText: 'Jane',\n    },\n    {\n      columnName: 'diagnosis',\n      hintText: 'LOAD',\n    },\n    {\n      columnName: 'modelType',\n      hintText: 'hint',\n    },\n  ]\n  const genericCardSchema: GenericCardSchema = {\n    title: 'Title',\n    type: 'Generic Tool',\n    subTitle: 'softwareType',\n    description: 'summary',\n    icon: 'icon',\n    secondaryLabels: ['contributor', 'diagnosis', 'program'],\n  }\n  const cardConfiguration: CardConfiguration = {\n    type: SynapseConstants.GENERIC_CARD,\n    genericCardSchema,\n  }\n  return (\n    <div className=\"col-xs-8 col-xs-offset-2\">\n      <QueryWrapper\n        facetAliases={facetAliases}\n        rgbIndex={5}\n        initQueryRequest={{\n          entityId: 'syn20337467',\n          concreteType:\n            'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n          partMask:\n            SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n            SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n            SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n            SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n            SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n          query: {\n            sql,\n            limit: 25,\n            offset: 0,\n          },\n        }}\n        showBarChart={false}\n        unitDescription={'studies'}\n      >\n        <Search searchable={searchable} isQueryWrapperMenuChild={false} />\n        <CardContainer {...cardConfiguration} />\n      </QueryWrapper>\n    </div>\n  )\n}\n\nexport default SearchDemo\n","import * as React from 'react'\nimport ModalDownload from '../../../lib/containers/ModalDownload'\n\ntype State = {\n  showModal: boolean\n}\n\nclass ModalDownloadDemo extends React.Component<{}, State> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      showModal: false,\n    }\n  }\n\n  onClose = () => {\n    this.setState({\n      showModal: false,\n    })\n  }\n\n  onOpen = () => {\n    console.log('opening')\n    this.setState({\n      showModal: true,\n    })\n  }\n\n  render() {\n    return (\n      <div className=\"container\">\n        <button onClick={this.onOpen} className=\"btn btn-primary\">\n          {' '}\n          Show ModalDownload{' '}\n        </button>\n        {this.state.showModal && (\n          <ModalDownload\n            sql={'SELECT * from syn17328596'}\n            entityId={'syn17328596'}\n            onClose={this.onClose}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default ModalDownloadDemo\n","import * as React from 'react'\nimport UserCard from '../../../lib/containers/UserCard'\nimport { SynapseConstants } from '../../../lib'\nimport MarkdownSynapse from '../../../lib/containers/MarkdownSynapse'\n\nexport default class UserBadgeSmallDemo extends React.Component<any, any> {\n  constructor(props: any) {\n    super(props)\n  }\n  public render() {\n    const profiles = [\n      '3376985',\n      '1131050',\n      '273960',\n      '3346401',\n      '3374422',\n      '273950',\n      '273950',\n    ]\n    return (\n      <React.Fragment>\n        <div className=\"container\">\n          <div className=\"row\">\n            <h3>User Card Small </h3>\n            <p> sans photo- </p>\n            <UserCard\n              ownerId={'273950'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <p> without text </p>\n            <UserCard\n              ownerId={'3374422'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <hr />\n            <p> with custom link- </p>\n            <UserCard\n              ownerId={'273950'}\n              size={SynapseConstants.SMALL_USER_CARD}\n              link={'https://google.com'}\n            />\n            <UserCard\n              ownerId={'3374422'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n              link={'https://google.com'}\n            />\n            <hr />\n            <p> without tooltip </p>\n            <div className=\"SRC-centerContent\">\n              <UserCard\n                ownerId={'3374422'}\n                hideTooltip={true}\n                size={SynapseConstants.SMALL_USER_CARD}\n              />\n              <UserCard\n                ownerId={'3346401'}\n                hideTooltip={true}\n                size={SynapseConstants.SMALL_USER_CARD}\n              />\n            </div>\n            <hr />\n            <p> with photo- </p>\n            <UserCard\n              ownerId={'3346401'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <UserCard\n              ownerId={'1131050'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <p> without text- </p>\n            <UserCard\n              ownerId={'273960'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <hr />\n            <p>inside of markdown-</p>\n            <MarkdownSynapse wikiId={'588827'} ownerId={'syn18380882'} />\n          </div>\n          <div className=\"row\">\n            <h3> User Card Large </h3>\n            <p> with photo- </p>\n            <UserCard\n              ownerId={'1131050'}\n              // tslint:disable-next-line:jsx-no-lambda\n              size={SynapseConstants.LARGE_USER_CARD}\n              menuActions={[\n                {\n                  field: 'Projects',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'Profile',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'SEPERATOR',\n                },\n                {\n                  field: 'Teams',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n              ]}\n            />\n            <br />\n            <p> sans photo- </p>\n            <br />\n            <UserCard\n              ownerId={'3374422'}\n              size={SynapseConstants.LARGE_USER_CARD}\n            />\n            <br />\n            <br />\n            <UserCard\n              ownerId={'345424'}\n              size={SynapseConstants.LARGE_USER_CARD}\n              menuActions={[\n                {\n                  field: 'Projects',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'Profile',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n                {\n                  field: 'SEPERATOR',\n                },\n                {\n                  field: 'Teams',\n                  callback: userProfile => {\n                    console.log(userProfile)\n                  },\n                },\n              ]}\n            />\n          </div>\n        </div>\n        <h3> User Card Medium Wrapping Example </h3>\n        <div className=\"SRC-card-grid-row\">\n          {[1, 2, 3, 4, 5].map((_el, index) => {\n            return (\n              <div className=\"SRC-grid-item\" key={index}>\n                <UserCard\n                  hideEmail={index % 2 === 0}\n                  menuActions={[\n                    {\n                      field: 'Projects',\n                      callback: userProfile => {\n                        console.log(userProfile)\n                      },\n                    },\n                    {\n                      field: 'Profile',\n                      callback: userProfile => {\n                        console.log(userProfile)\n                      },\n                    },\n                    {\n                      field: 'SEPERATOR',\n                    },\n                    {\n                      field: 'Teams',\n                      callback: userProfile => {\n                        console.log(userProfile)\n                      },\n                    },\n                  ]}\n                  ownerId={profiles[index]}\n                  size={SynapseConstants.MEDIUM_USER_CARD}\n                  link={index % 2 ? 'https://google.com' : ''}\n                />\n              </div>\n            )\n          })}\n        </div>\n      </React.Fragment>\n    )\n  }\n}\n","import * as React from 'react'\nimport MarkdownSynapse, {\n  MarkdownSynapseProps,\n} from '../../../lib/containers/MarkdownSynapse'\n\ntype State = {\n  index: number\n  markdownPropsArray: MarkdownSynapseProps[]\n}\n\nexport default class MarkdownSynapseDemo extends React.Component<{}, State> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      index: 3,\n      markdownPropsArray: [\n        {\n          // footnotes with html\n          ownerId: 'syn18380882',\n          wikiId: '588827',\n        },\n        {\n          // with details tag\n          ownerId: 'syn12666371',\n          wikiId: '585317',\n        },\n        {\n          //  with references\n          ownerId: 'syn17100797',\n          wikiId: '587923',\n        },\n        {\n          // with bookmark\n          ownerId: 'syn21097753',\n          wikiId: '597236',\n        },\n        {\n          // lego man\n          ownerId: 'syn18142975',\n        },\n        {\n          // nested link\n          ownerId: 'syn12666371',\n          wikiId: '595383',\n        },\n      ],\n    }\n  }\n  render() {\n    const { index, markdownPropsArray } = this.state\n    const props = markdownPropsArray[index]\n    return (\n      <div className=\"container\">\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 0 })\n          }}\n        >\n          Footnotes with html\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 1 })\n          }}\n        >\n          Details tag\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 2 })\n          }}\n        >\n          References\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 3 })\n          }}\n        >\n          Table of Contents\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 4 })\n          }}\n        >\n          Lego Man\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {\n            this.setState({ index: 5 })\n          }}\n        >\n          Show nested anchor\n        </button>\n        {/* footnotes with html */}\n        <MarkdownSynapse {...props} />\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport NewsFeedMenu from '../../../lib/containers/NewsFeedMenu'\n\nexport const NewsFeedDemo:React.SFC = () => {\n  // in the portal, search params should be filled in based on URL query parameters.\n  const searchParams: any = {'cat':'3'}\n  return (\n    <NewsFeedMenu\n      menuConfig={[\n        {\n          feedName:'Data Releases',\n          feedDescription:'The AMP-AD Knowledge Portal releases new Alzheimer\\'s disease data twice annually, in May and November. Data releases may include new data, analyses, and results; as well as changes and updates to previously released data.',\n          feedUrl:'https://portalnews.wpengine.com/?feed=rss2',\n          feedKeyValue: {'cat':'4'},\n          defaultItemsToShow:3,\n        },\n        {\n          feedName:'Updates',\n          feedDescription:'The AMP-AD Knowledge Portal reaches the broader scientific community through multiple channels that encourage open-science collaborations. News updates include videos, events, and presentations that highlight the community behind the data.',\n          feedUrl:'https://portalnews.wpengine.com/?feed=rss2',\n          feedKeyValue: {'cat':'3'},\n          defaultItemsToShow:3,\n          twitterFeedUrl:'https://twitter.com/AMPADPortal?ref_src=twsrc%5Etfw'\n        },\n        {\n          feedName:'Newsletter',\n          feedDescription:'The AMP-AD Knowledge Portal sends a quarterly newsletter to interested members of the scientific community, delivering consolidated information and updates related to the Portal.',\n          feedUrl:'https://portalnews.wpengine.com/?feed=rss2',\n          feedKeyValue: {'cat':'5'},\n          defaultItemsToShow:3,\n          mailChimpListName:'AMP-AD quarterly newsletter',\n          mailChimpUrl:'https://sagebase.us7.list-manage.com/subscribe/post?u=b146de537186191a9d2110f3a&amp;id=96b614587a'\n        },\n      ]}\n      searchParams={searchParams}\n      routeToNewsFeed={'/Playground/NewsFeedDemo'}\n    />\n  )\n}\n\n\n","import { SynapseClient } from 'lib'\nimport {\n  FileUploadComplete,\n  FormData,\n  FormGroup,\n  ListRequest,\n  ListResponse,\n  StatusEnum,\n} from 'lib/utils/synapseTypes/'\nimport * as React from 'react'\nimport { TokenContext } from '../App'\n\ntype FormServicesIntegrationDemoState = {\n  token?: string\n  formGroup?: FormGroup\n  formData?: FormData\n  myFormDataList?: ListResponse\n  formAdminFormDataList?: ListResponse\n}\n\nclass FormServicesIntegrationDemo extends React.Component<\n  {},\n  FormServicesIntegrationDemoState\n> {\n  constructor(props: any) {\n    super(props)\n    this.state = {}\n    this.onCreateFormGroup = this.onCreateFormGroup.bind(this)\n    this.onCreateFormData = this.onCreateFormData.bind(this)\n    this.onUpdateFormData = this.onUpdateFormData.bind(this)\n    this.onSubmitFormData = this.onSubmitFormData.bind(this)\n    this.listMyFormData = this.listMyFormData.bind(this)\n    this.listFormAdminFormData = this.listFormAdminFormData.bind(this)\n    this.onReadFormDataFileHandleContents = this.onReadFormDataFileHandleContents.bind(\n      this,\n    )\n  }\n\n  public onCreateFormGroup(): void {\n    SynapseClient.createFormGroup(\n      'AAMP-ADExternalContribution(production)',\n      this.state.token!,\n    )\n      .then((data: FormGroup) => {\n        console.log('Successfully created FormGroup', data)\n        this.setState({ formGroup: data })\n      })\n      .catch((error: any) =>\n        console.error('Failed to create form group', error),\n      )\n  }\n  public onUpdateFormData(): void {\n    SynapseClient.uploadFile(\n      this.state.token,\n      'my test file',\n      new Blob(['hello form data 2']),\n    )\n      .then((fileUploadComplete: FileUploadComplete) => {\n        console.log(\n          'Successfully created test file handle, now update the form data!',\n        )\n        SynapseClient.updateFormData(\n          this.state.formData!.formDataId!,\n          'my test form data',\n          fileUploadComplete.fileHandleId,\n          this.state.token!,\n        )\n          .then((data: FormData) => {\n            console.log('Successfully updated FormData', data)\n            this.setState({ formData: data })\n          })\n          .catch((error: any) =>\n            console.error('Failed to update FormData', error),\n          )\n      })\n      .catch((error: any) =>\n        console.error('Failed to update a new file handle:', error),\n      )\n  }\n\n  public onCreateFormData(): void {\n    SynapseClient.uploadFile(\n      this.state.token,\n      'my test file',\n      new Blob(['hello form data']),\n    )\n      .then((fileUploadComplete: FileUploadComplete) => {\n        console.log(\n          'Successfully created test file handle, now create the form data!',\n        )\n        SynapseClient.createFormData(\n          this.state.formGroup!.groupId!,\n          'my test form data',\n          fileUploadComplete.fileHandleId,\n          this.state.token!,\n        )\n          .then((data: FormData) => {\n            console.log('Successfully created FormData', data)\n            this.setState({ formData: data })\n          })\n          .catch((error: any) =>\n            console.error('Failed to create FormData', error),\n          )\n      })\n      .catch((error: any) =>\n        console.error('Failed to create a new file handle:', error),\n      )\n  }\n\n  public onSubmitFormData(): void {\n    SynapseClient.submitFormData(\n      this.state.formData!.formDataId!,\n      this.state.token!,\n    )\n      .then((data: FormData) => {\n        console.log('Successfully submitted FormData', data)\n      })\n      .catch((error: any) => console.error('Failed to submit form data', error))\n  }\n\n  private listMyFormData = () => {\n    if (\n      this.state.token &&\n      this.state.formGroup &&\n      !this.state.myFormDataList\n    ) {\n      let request: ListRequest = {\n        groupId: this.state.formGroup.groupId!,\n        filterByState: [\n          StatusEnum.ACCEPTED,\n          StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n          StatusEnum.WAITING_FOR_SUBMISSION,\n        ],\n      }\n      SynapseClient.listFormData(request, this.state.token)\n        .then((resp: ListResponse) => {\n          console.log('Successfully got a my FormData list', resp)\n          this.setState({ myFormDataList: resp })\n        })\n        .catch((error: any) =>\n          console.error('Failed to get my FormData list', error),\n        )\n    }\n  }\n\n  private listFormAdminFormData = () => {\n    if (\n      this.state.token &&\n      this.state.formGroup &&\n      !this.state.formAdminFormDataList\n    ) {\n      let request: ListRequest = {\n        groupId: this.state.formGroup.groupId!,\n        filterByState: [\n          StatusEnum.ACCEPTED,\n          StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n        ],\n      }\n      SynapseClient.listFormDataAsFormAdmin(request, this.state.token)\n        .then((resp: ListResponse) => {\n          console.log('Successfully got FormGroup admin list', resp)\n          this.setState({ formAdminFormDataList: resp })\n        })\n        .catch((error: any) =>\n          console.error('Failed to get FormGroup admin FormData list', error),\n        )\n    }\n  }\n\n  private onReadFormDataFileHandleContents = () => {\n    SynapseClient.getFileHandleContentFromID(\n      this.state.formData!.dataFileHandleId,\n      this.state.token!,\n    )\n      .then((data: string) => {\n        console.log('Successfully fetched file handle contents: ', data)\n      })\n      .catch((error: any) =>\n        console.error('Failed to read form data file handle contents', error),\n      )\n  }\n\n  public componentDidUpdate() {\n    this.listMyFormData()\n    this.listFormAdminFormData()\n  }\n\n  render() {\n    return (\n      <TokenContext.Consumer>\n        {(token: string) => {\n          if (token !== this.state.token) {\n            this.setState({\n              token,\n            })\n          }\n          if (token) {\n            return (\n              <>\n                <div>\n                  <a onClick={this.onCreateFormGroup}>\n                    Create Form Group\n                    <br />\n                  </a>\n                  {!this.state.formData && (\n                    <a onClick={this.onCreateFormData}>\n                      Create Form Data\n                      <br />\n                    </a>\n                  )}\n                  {this.state.formData && (\n                    <a onClick={this.onReadFormDataFileHandleContents}>\n                      Get Form Data FileHandle contents\n                      <br />\n                    </a>\n                  )}\n\n                  {this.state.formData && (\n                    <a onClick={this.onUpdateFormData}>\n                      Update Form Data\n                      <br />\n                    </a>\n                  )}\n                  {this.state.formData && (\n                    <a onClick={this.onSubmitFormData}>\n                      Submit Form Data\n                      <br />\n                    </a>\n                  )}\n                </div>\n                {<h3>My FormData</h3>}\n                {this.state.myFormDataList && (\n                  <table>\n                    <thead>\n                      <tr>\n                        <th>Form Data name</th>\n                        <th>Data File Handle ID</th>\n                        <th>Status</th>\n                        <th>Rejection Reason</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {this.state.myFormDataList.page.map(value => {\n                        return (\n                          <tr key={value.formDataId}>\n                            <td>{value.name}</td>\n                            <td>{value.dataFileHandleId}</td>\n                            <td>{value.submissionStatus.state}</td>\n                            <td>{value.submissionStatus.rejectionMessage}</td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                )}\n                {<h3>FormGroup Admin FormData</h3>}\n                {this.state.formAdminFormDataList && (\n                  <table>\n                    <thead>\n                      <tr>\n                        <th>Form Data name</th>\n                        <th>Data File Handle ID</th>\n                        <th>Status</th>\n                        <th>Rejection Reason</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {this.state.formAdminFormDataList.page.map(value => {\n                        return (\n                          <tr key={value.formDataId}>\n                            <td>{value.name}</td>\n                            <td>{value.dataFileHandleId}</td>\n                            <td>{value.submissionStatus.state}</td>\n                            <td>{value.submissionStatus.rejectionMessage}</td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                )}\n              </>\n            )\n          } else\n            return (\n              <>\n                <p>Please log in and reload this route</p>\n              </>\n            )\n        }}\n      </TokenContext.Consumer>\n    )\n  }\n}\n\nexport default FormServicesIntegrationDemo\n","import Plotly from 'plotly.js-basic-dist'\nimport * as React from 'react'\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { unCamelCase } from '../utils/functions/unCamelCase'\nimport {\n  FacetColumnResultValueCount,\n  FacetColumnResultValues,\n  FacetColumnValuesRequest,\n  QueryBundleRequest,\n  QueryResultBundle,\n} from '../utils/synapseTypes/'\nimport getColorPallette from './ColorGradient'\nimport { SELECT_SINGLE_FACET } from './Facets'\nimport { FacetSelection, QueryWrapperChildProps } from './QueryWrapper'\n\nexport const Plot = createPlotlyComponent(Plotly)\nconst ROW_HEIGHT: number = 160\nconst CHARTS_PER_ROW: number = 5\n\nexport type FacetsPlotNavState = {\n  isShowingMore: boolean\n  isResetPossible: boolean\n}\n\nexport type FacetsPlotNavProps = {\n  loadingScreen?: React.FunctionComponent | JSX.Element\n  facetsToPlot?: string[]\n}\n\ntype InternalProps = FacetsPlotNavProps & QueryWrapperChildProps\n/**\n * Make a chart for each facet\n *\n * @class FacetsPlotNav\n * @extends {React.Component}\n */\nexport default class FacetsPlotNav extends React.Component<\n  InternalProps,\n  FacetsPlotNavState\n> {\n  constructor(props: InternalProps) {\n    super(props)\n    this.handleClick = this.handleClick.bind(this)\n    // the text currently under the cursor\n    this.state = {\n      isShowingMore: false,\n      isResetPossible: false,\n    }\n    this.extractPlotDataArray = this.extractPlotDataArray.bind(this)\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n    this.onReset = this.onReset.bind(this)\n    // this.onHover = this.onHover.bind(this)\n    // this.onUnhover = this.onUnhover.bind(this)\n  }\n\n  public toggleShowMore(event: React.MouseEvent<HTMLAnchorElement>) {\n    event.preventDefault()\n    this.setState({\n      isShowingMore: !this.state.isShowingMore,\n    })\n  }\n\n  public onReset(event: React.MouseEvent<HTMLAnchorElement>) {\n    event.preventDefault()\n    const { executeInitialQueryRequest } = this.props\n    if (executeInitialQueryRequest) {\n      executeInitialQueryRequest()\n    }\n    this.setState({\n      isResetPossible: false,\n    })\n  }\n\n  // public onHover = (event: any) => {\n  //   this.updateHover(true, event)\n  // }\n\n  // NOTE: There's an issue where onUnhover() is not called after the first onHover().\n  // Moving the plotData to state requires some consideration.  The plot must be updated by the table filter selection.\n  // Also, the Plot will not update if it points to the same (shallow compare) data object.  One way to force a Plot update is to\n  // update the layout.datarevision.\n  // public onUnhover = (event: any) => {\n  //   this.updateHover(false, event)\n  // }\n\n  // public updateHover = (isHover:boolean, event: any) => {\n  //   if (event.points && event.points[0] && this.state.plotData) {\n  //     const plotPointData: any = event.points[0]\n  //     const domain = plotPointData.data.domain\n  //     const newMarkerLineWidth: number = isHover ? 1 : 0\n  //     this.state.plotData[(domain.row * CHARTS_PER_ROW) + domain.column].marker.line.width[plotPointData.pointNumber] = newMarkerLineWidth\n  //     this.setState({datarevision: this.state.datarevision + 1})\n  //   }\n  // }\n\n  /**\n   * Handle click event\n   */\n  public handleClick = (event: any) => {\n    if (event.points && event.points[0]) {\n      const plotPointData: any = event.points[0]\n      const facetName = plotPointData.data.name\n      const facetValueClicked =\n        plotPointData.data.facetEnumerationValues[plotPointData.pointNumber]\n      // update the facet\n      const { isAllFilterSelectedForFacet = {} } = this.props\n      isAllFilterSelectedForFacet[facetName] = false\n      const lastFacetSelection = {\n        selector: SELECT_SINGLE_FACET,\n        facetValue: facetValueClicked,\n        columnName: facetName,\n      } as FacetSelection\n      this.props.updateParentState!({\n        lastFacetSelection,\n        isAllFilterSelectedForFacet,\n      })\n\n      // run the query with the selected facet value\n      const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n      const { selectedFacets = [] } = queryRequest.query\n      const specificFacet = selectedFacets!.find(\n        el => el.columnName === facetName,\n      )!\n      if (!specificFacet) {\n        const facetColumnValuesRequest: FacetColumnValuesRequest = {\n          facetValues: [facetValueClicked],\n          concreteType:\n            'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n          columnName: facetName,\n        }\n        selectedFacets.push(facetColumnValuesRequest)\n        // align the reference to selectedFacets\n        queryRequest.query.selectedFacets = selectedFacets\n      } else {\n        specificFacet.facetValues = [facetValueClicked]\n      }\n\n      queryRequest.query.offset = 0\n      this.props.executeQueryRequest!(queryRequest)\n    }\n    this.setState({\n      isResetPossible: true,\n    })\n  }\n\n  public render() {\n    const {\n      data,\n      isLoadingNewData,\n      loadingScreen,\n      // rgbIndex,\n      asyncJobStatus,\n    } = this.props\n    // while loading\n    if (isLoadingNewData || !data) {\n      return (\n        <div className=\"SRC-loadingContainer SRC-centerContentColumn\">\n          {/*\n            check loading screen is not undefined or null and show\n            it if so\n          */}\n          {!!loadingScreen && loadingScreen}\n          <div>{asyncJobStatus && asyncJobStatus.progressMessage}</div>\n        </div>\n      )\n    }\n    const plotData = this.extractPlotDataArray(data!)\n    const showMoreButton = plotData.length > CHARTS_PER_ROW && (\n      <a\n        style={{\n          fontSize: '14px',\n          cursor: 'pointer',\n          marginLeft: '5px',\n          marginBottom: '10px',\n        }}\n        className=\"SRC-primary-text-color\"\n        onClick={this.toggleShowMore}\n      >\n        {this.state.isShowingMore ? 'Show Less' : 'Show More'}\n      </a>\n    )\n    const resetButton = (\n      <a\n        style={{\n          fontSize: '14px',\n          cursor: 'pointer',\n          marginLeft: '5px',\n          marginRight: '5px',\n          marginBottom: '10px',\n          float: 'right',\n        }}\n        className=\"SRC-primary-text-color\"\n        onClick={this.onReset}\n      >\n        Reset\n      </a>\n    )\n\n    // create a pie chart for each facet (values) result\n    const plotDataToShow: any[] = this.state.isShowingMore\n      ? plotData\n      : plotData.slice(0, CHARTS_PER_ROW)\n\n    const rowCount: number = Math.ceil(plotDataToShow.length / CHARTS_PER_ROW)\n    const layout = {\n      grid: { rows: rowCount, columns: CHARTS_PER_ROW },\n      showlegend: false,\n      annotations: [],\n      margin: { l: 20, r: 20, b: 10, t: 10, pad: 40 },\n      height: ROW_HEIGHT * rowCount,\n      // datarevision: this.state.datarevision\n    }\n\n    return (\n      <>\n        <div className=\"SRC-bar-border SRC-bar-marginTop SRC-bar-border-top\">\n          <div>\n            <Plot\n              layout={layout}\n              data={plotDataToShow}\n              className=\"SRC-fullWidth\"\n              config={{ displayModeBar: false }}\n              useResizeHandler={true}\n              onClick={this.handleClick}\n              // onHover={this.onHover}\n              // onUnhover={this.onUnhover}\n            ></Plot>\n          </div>\n        </div>\n        <div\n          className=\"SRC-bar-border SRC-bar-border-bottom\"\n          style={{ marginBottom: '15px' }}\n        >\n          {showMoreButton}\n          {this.state.isResetPossible && resetButton}\n        </div>\n      </>\n    )\n  }\n  public extractPlotDataArray(data: QueryResultBundle) {\n    const { facetsToPlot } = this.props\n    const plotData: any[] = []\n\n    // pull out the data corresponding to the filter in question\n    let enumerationFacets = data.facets!.filter(\n      item => item.facetType === 'enumeration',\n    ) as FacetColumnResultValues[]\n    if (facetsToPlot) {\n      // filter to show plots for the chosen facets\n      enumerationFacets = enumerationFacets.filter(item =>\n        facetsToPlot.includes(item.columnName),\n      )\n    }\n\n    enumerationFacets.forEach(\n      (item: FacetColumnResultValues, index: number) => {\n        const { colorPalette } = getColorPallette(\n          index,\n          item.facetValues.length,\n        )\n        const singlePieChartData: any = {\n          values: [],\n          labels: [],\n          facetEnumerationValues: [],\n          name: item.columnName,\n          // The only thing supported in hoverlabel today is bordercolor, but this also effects the hoverlabel text color!\n          // https://github.com/plotly/plotly.js/issues/2342\n          // hoverlabel: {\n          //   bordercolor: 'rgb(216, 216, 218)',\n          //   opacity: 0.7\n          // },\n          hovertemplate:\n            '<b>%{label}</b><br>' +\n            '%{value} (%{percent})<br>' +\n            '<extra></extra>',\n          textposition: 'inside',\n          textinfo: 'none',\n          type: 'pie',\n          title: {\n            text: unCamelCase(item.columnName),\n            font: {\n              size: 14,\n            },\n            position: 'top center',\n          },\n          marker: {\n            colors: colorPalette,\n            line: {\n              width: [],\n            },\n          },\n          pull: [],\n          domain: {\n            row: Math.floor(index / CHARTS_PER_ROW),\n            column: index % CHARTS_PER_ROW,\n          },\n        }\n        plotData.push(singlePieChartData)\n        item.facetValues.forEach((facetValue: FacetColumnResultValueCount) => {\n          singlePieChartData.values.push(facetValue.count)\n          const displayValue =\n            facetValue.value === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET'\n              ? 'unannotated'\n              : facetValue.value\n\n          singlePieChartData.labels.push(displayValue)\n          singlePieChartData.facetEnumerationValues.push(facetValue.value)\n          singlePieChartData.marker.line.width.push(\n            facetValue.isSelected ? 1 : 0,\n          )\n          singlePieChartData.pull.push(facetValue.isSelected ? 0.09 : 0)\n        })\n      },\n    )\n\n    return plotData\n  }\n}\n","import * as React from 'react'\nimport { QueryWrapperProps } from './QueryWrapper'\nimport QueryWrapper from './QueryWrapper'\nimport FacetsPlotNav, { FacetsPlotNavProps } from './FacetsPlotNav'\nimport { SynapseTableProps } from './table/SynapseTable'\nimport SynapseTable from './table/SynapseTable'\nimport { insertConditionsFromSearchParams, SQLOperator } from '../utils/functions/sqlFunctions'\n\ntype SearchParams = {\n  searchParams?: {\n    facetValue: string\n  }\n}\ntype Operator = {\n  sqlOperator: SQLOperator\n}\nexport type QueryWrapperPlotNavProps = QueryWrapperProps & Partial<FacetsPlotNavProps> & Partial<SynapseTableProps> & SearchParams & Operator\n\nconst QueryWrapperPlotNav: React.FunctionComponent<QueryWrapperPlotNavProps> = (props) => {\n  const {\n    title,\n    searchParams,\n    initQueryRequest,\n    sqlOperator,\n    facetsToPlot,\n    enableLeftFacetFilter,\n    loadingScreen,\n    ...rest\n  } = props\n  if (searchParams) {\n    let sqlUsed = initQueryRequest.query.sql\n    if (searchParams) {\n      sqlUsed = insertConditionsFromSearchParams(searchParams, initQueryRequest.query.sql, sqlOperator)\n    }\n    initQueryRequest.query.sql = sqlUsed\n  }\n  return (\n    <QueryWrapper\n      {...rest}\n      initQueryRequest={initQueryRequest}\n    >\n      {\n        <FacetsPlotNav\n          loadingScreen={loadingScreen}\n          facetsToPlot={facetsToPlot}\n        />\n      }\n      {\n        title ?\n        <SynapseTable\n          loadingScreen={loadingScreen}\n          title={title}\n          enableLeftFacetFilter={enableLeftFacetFilter}\n        />\n        :\n        <></>\n      }\n    </QueryWrapper>\n  )\n}\n\nexport default QueryWrapperPlotNav\n","import * as React from 'react'\nimport { SynapseConstants } from '../../../lib/utils'\nimport QueryWrapperPlotNav, { QueryWrapperPlotNavProps } from 'lib/containers/QueryWrapperPlotNav'\n\ntype DemoState = {\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  tableProps: QueryWrapperPlotNavProps\n  activeTab: number\n}\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nclass QueryWrapperPlotNavDemo extends React.Component<{},\n  DemoState\n> {\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    const sql:string =\n      \"SELECT * FROM syn16858331\"\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      activeTab: 3,\n      version: 0,\n      tableProps: \n      {\n        title: 'Test only',\n        sqlOperator: '=',\n        unitDescription: 'datum',\n        initQueryRequest:{\n          entityId: 'syn16858331',\n          concreteType:\n            'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n          partMask:\n            SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n            SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n            SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n            SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n            SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n          query: {\n            sql,\n            limit: 25,\n            offset: 0,\n          },\n        },\n        enableLeftFacetFilter: true,\n        rgbIndex: 5,\n        // facetsToPlot: ['assay', 'dataType'],\n        loadingScreen:<div> Im loading as fast I can !!! </div>\n      }\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.removeHandler = this.removeHandler.bind(this)\n  }\n\n  /**\n   * Update internal state\n   * @param {Object} updatedState new state to be updated by the component\n   */\n  public handleChange(updatedState: {}): void {\n    this.setState(updatedState)\n  }\n\n  public removeHandler(): void {\n    this.setState({ showMarkdown: !this.state.showMarkdown })\n  }\n\n  public render(): JSX.Element {\n    return (\n      <div className=\"container\">\n        <h2>Demo of plot nav table</h2>\n        <QueryWrapperPlotNav {...this.state.tableProps} />\n      </div>\n    )\n  }\n}\nexport default QueryWrapperPlotNavDemo\n","import * as React from 'react'\nimport { Checkbox } from '../../../lib/containers/widgets/Checkbox'\nimport { RadioGroup } from '../../../lib/containers/widgets/RadioGroup'\nimport ThemesPlot from '../../../lib/containers/widgets/themes-plot/ThemesPlot'\nimport { PlotProps, ClickCallbackParams} from '../../../lib/containers/widgets/themes-plot/types'\nimport { Range, RangeValues } from '../../../lib/containers/widgets/Range'\nimport { RangeSlider } from '../../../lib/containers/widgets/RangeSlider'\nimport { useState } from 'react'\n\ntype WigetDemoPros = {\n  token: string\n}\n\nexport const WidgetDemo: React.FunctionComponent<WigetDemoPros> = (\n  props: WigetDemoPros,\n) => {\n  const options = [\n    { label: 'option 1', value: 'option1' },\n    { label: 'option 2', value: 'option2' },\n    { label: 'option 3', value: 'option3' },\n  ]\n  const [check1, setCheck1] = useState(true)\n  const [check2, setCheck2] = useState(false)\n  const [optionValue, setOptionValue] = useState('option2')\n  const [rangeNumberValue, setRangeNumberValue] = useState(() => {\n    const result: RangeValues = {\n      min: '10.5',\n      max: '30',\n    }\n    return result\n  })\n  const [rangeDateValue, setRangeDateValue] = useState(() => {\n    const result: RangeValues = {\n      min: new Date(2019, 5, 10).toISOString(),\n      max: new Date(2019, 6, 11).toISOString(),\n    }\n    return result\n  })\n\n  const [rangeSliderValue, setRangeSliderValue] = useState({\n    min: '10',\n    max: '25',\n  })\n\n  const topBarPlotProps: PlotProps = {\n    entityId: 'syn21641485',\n    xField: 'totalCount',\n    yField: 'groupBy',\n    groupField: 'consortium',\n    whereClause: 'totalCount is not NULL',\n    colors: {\n      ['CSBC']: 'rgba(64,123,160, 1)',\n      ['PS-ON']: 'rgba(91,176,181,1)'\n    }\n  }\n  \n  const sideBarPlotProps: PlotProps = {\n    entityId: 'syn21649281',\n    xField: 'totalCount',\n    yField: 'theme',\n    groupField: 'consortium',\n    countLabel: 'projects',\n    plotStyle: {\n      backgroundColor: '#f5f9fa'\n    },\n    colors: {\n      ['CSBC']: '#4788A5',\n      ['PS-ON']: '#5bb0b5'\n    }\n  }\n\n  const dotPlotProps:PlotProps = {\n    entityId: 'syn21639584',\n    xField: 'totalCount',\n    yField: 'theme',\n    groupField: 'groupBy',\n    infoField:  'themeDescription',\n    whereClause: \"groupBy IN ('publications', 'tools', 'datasets')\",\n    markerSymbols: {\n      tools: 'y-down',\n      datasets: 'diamond-x',\n      publications: 'circle',\n    },\n    plotStyle: {\n      markerLine: 'rgba(0, 0, 0,1)',\n      markerFill: 'rgba(255, 255, 255,1)',\n      markerSize: 11,\n      backgroundColor: '#f5f9fa'\n    }\n  }\n\n  const plotCallback = ({\n    facetValue,\n    type,\n  }: ClickCallbackParams) => {\n    alert(`facetValue: ${facetValue} type: ${type}`)\n  }\n\n  return (\n    <div className=\"container\">\n      <div style={{ fontWeight: 'bold' }}></div>\n      <h4 style={{ marginTop: '20px' }}>Checkbox</h4>\n      Checkbox 1 is {check1 ? 'checked' : 'unchecked'}\n      <br />\n      Checkbox 2 is {check2 ? 'checked' : 'unchecked'}\n      <br />\n      <Checkbox\n        label=\"Initially Checked Checkbox\"\n        id=\"ch1\"\n        checked={true}\n        onChange={(checked: boolean) => setCheck1(checked)}\n      ></Checkbox>\n      <Checkbox\n        label=\"Initially Unchecked Checkbox\"\n        id=\"ch2\"\n        onChange={(checked: boolean) => setCheck2(checked)}\n      ></Checkbox>\n      <hr></hr>\n      <h4 style={{ marginTop: '20px' }}>Radio</h4>\n      Option Value is: {optionValue}\n      <br />\n      <RadioGroup\n        id=\"radioGroup1\"\n        options={options}\n        value={optionValue}\n        onChange={(value: string) => setOptionValue(value)}\n      ></RadioGroup>\n      <hr></hr>\n      <h4 style={{ marginTop: '20px' }}>Number Range</h4>\n      Number Range Value is:\n      {` ${rangeNumberValue.min} - ${rangeNumberValue.max}`}\n      <br />\n      <Range\n        type=\"number\"\n        initialValues={{ min: rangeNumberValue.min, max: rangeNumberValue.max }}\n        onChange={(values: RangeValues) => setRangeNumberValue(values)}\n      ></Range>\n      <hr></hr>\n      <h4>Date Range</h4>\n      Number Date Value is: {rangeDateValue.min} - {rangeDateValue.max}\n      <br />\n      <Range\n        type=\"date\"\n        initialValues={{ min: rangeDateValue.min, max: rangeDateValue.max }}\n        onChange={(values: RangeValues) => setRangeDateValue(values)}\n      ></Range>\n      <hr></hr>\n      <h4>Range Slider</h4>\n      Range Slider Value is: {rangeSliderValue.min} - {rangeSliderValue.max}\n      <br />\n      <RangeSlider\n        initialValues={rangeSliderValue}\n        onChange={(values: { min: string; max: string }) =>\n          setRangeSliderValue(values)\n        }\n        domain={['0', '100']}\n        step={1}\n      ></RangeSlider>\n      <ThemesPlot\n        token={props.token}\n        onPointClick={plotCallback}\n        topBarPlot={topBarPlotProps}\n        sideBarPlot={sideBarPlotProps}\n        dotPlot={dotPlotProps}\n      ></ThemesPlot>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport { AccessRequirement } from 'lib/utils/synapseTypes/AccessRequirement/AccessRequirement'\n\nexport type SelfSignAccessRequirement = {\n  accessRequirement: AccessRequirement\n}\n\nexport default function SelfSignAccessRequirement({\n  accessRequirement,\n}: SelfSignAccessRequirement) {\n  return <div></div>\n}\n","import * as React from 'react'\nimport { AccessRequirement } from 'lib/utils/synapseTypes/AccessRequirement/AccessRequirement'\n\nexport type TermsOfUseAccessRequirement = {\n  accessRequirement: AccessRequirement\n}\n\nexport default function TermsOfUseAccessRequirement({\n  accessRequirement,\n}: TermsOfUseAccessRequirement) {\n  return <div></div>\n}\n","import * as React from 'react'\nimport AccessRequirementList from 'lib/containers/access_requirement_list/AccessRequirementList'\n\ntype Props = {\n  token: string\n}\n\nexport const AccessRequirementDemo: React.FunctionComponent<Props> = props => {\n  const { token } = props\n  return (\n    <AccessRequirementList\n      onHide={() => {\n        window.location.href = 'http://localhost:3000/Playground'\n      }}\n      entityId={'syn2426398'}\n      token={token}\n    />\n  )\n}\n","import React, { useState } from 'react'\n\ntype Props = {\n  userId: string\n}\n\nexport default function TemplateComponent({ userId }: Props) {\n  const [count, setCount] = useState<number>(0)\n\n  return (\n    <div>\n      <button\n        style={{ backgroundColor: 'blue', color: 'white' }}\n        onClick={() => setCount(count + 1)}\n      >\n        Click to increment count!\n      </button>\n      <p> Count = {count} </p>\n\n      <p> Passed in userId = {userId} </p>\n    </div>\n  )\n}\n","import * as React from 'react'\nimport TemplateComponent from '../../../lib/containers/TemplateComponent'\n\nexport default function TemplateComponentDemo() {\n  /*\n    Setup component with props for various scenarios\n  */\n  return <TemplateComponent userId={'1234'} />\n}\n","import * as React from 'react'\nimport { Link, Route } from 'react-router-dom'\nimport QueryWrapperMenuDemo from './QueryWrapperMenuDemo'\nimport CardContainerLogicDemo from './CardContainerLogicDemo'\nimport SearchDemo from './SearchDemo'\nimport ModalDownloadDemo from './ModalDownloadDemo'\nimport UserCardDemo from './UserCardDemo'\nimport MarkdownSynapseDemo from './MarkdownSynapseDemo'\nimport { NewsFeedDemo } from './NewsFeedDemo'\nimport FormServicesIntegrationDemo from './FormServicesIntegrationDemo'\nimport QueryWrapperPlotNavDemo from './QueryWrapperPlotNavDemo'\nimport DownloadListTable from 'lib/containers/download_list/DownloadListTable'\nimport { WidgetDemo } from './WidgetDemo'\nimport { RouteChildrenProps } from 'react-router'\nimport { AccessRequirementDemo } from './AccessRequirementDemo'\nimport TemplateComponentDemo from './TemplateComponentDemo'\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nconst App = ({\n  match,\n  token,\n}: {\n  match?: RouteChildrenProps['match']\n  token: string\n}) => {\n  if (!match) {\n    return <div />\n  }\n  return (\n    <div>\n      <h2>Links to components under development </h2>\n      <ul>\n        <li>\n          <Link to={`${match.url}/QueryWrapperMenuDemo`}>\n            QueryWrapperMenuDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/QueryWrapperPlotNavDemo`}>\n            QueryWrapperPlotNavDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/SearchDemo`}>SearchDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/CardContainerLogicDemo`}>\n            CardContainerLogicDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/UserBadgeDemo`}>UserBadgeDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/MarkdownSynapseDemo`}>\n            MarkdownSynapseDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/NewsFeedDemo`}>NewsFeedDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/FormServicesIntegrationDemo`}>\n            FormServicesIntegrationDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/ModalDownloadDemo`}>ModalDownload</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/DownloadListTableDemo`}>\n            DownloadListTableDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/WidgetDemo`}>WidgetDemo</Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/AccessRequirementDemo`}>\n            AccessRequirementDemo\n          </Link>\n        </li>\n        <li>\n          <Link to={`${match.url}/TemplateComponentDemo`}>\n            TemplateComponentDemo\n          </Link>\n        </li>\n      </ul>\n\n      <Route\n        exact={true}\n        path={`${match.url}/QueryWrapperMenuDemo`}\n        render={() => <QueryWrapperMenuDemo rgbIndex={0} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/QueryWrapperPlotNavDemo`}\n        render={() => <QueryWrapperPlotNavDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/SearchDemo`}\n        render={() => <SearchDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/CardContainerLogicDemo`}\n        component={CardContainerLogicDemo}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/UserBadgeDemo`}\n        component={() => <UserCardDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/MarkdownSynapseDemo`}\n        component={() => <MarkdownSynapseDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/NewsFeedDemo`}\n        component={() => <NewsFeedDemo />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/FormServicesIntegrationDemo`}\n        component={() => <FormServicesIntegrationDemo />}\n      />\n      <Route\n        exact={true}\n        path={`${match.url}/ModalDownloadDemo`}\n        component={() => <ModalDownloadDemo />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/DownloadListTableDemo`}\n        component={() => (\n          <div className=\"container download-list-demo\">\n            <div className=\"col-xs-10\">\n              <DownloadListTable token={token} listUpdatedCallback={() => {console.log('DownloadList updated')}} />\n            </div>\n          </div>\n        )}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/WidgetDemo`}\n        component={() => <WidgetDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/AccessRequirementDemo`}\n        component={() => <AccessRequirementDemo token={token} />}\n      />\n\n      <Route\n        exact={true}\n        path={`${match.url}/TemplateComponentDemo`}\n        component={() => <TemplateComponentDemo />}\n      />\n\n      <Route exact={true} path={match.path} component={() => <div />} />\n    </div>\n  )\n}\n\nexport default App\n","import * as React from 'react'\nimport { Link, BrowserRouter as Router, Route } from 'react-router-dom'\nimport Login from '../../lib/containers/Login'\nimport logoSvg from '../../images/logo.svg'\nimport '../style/App.scss'\nimport '../style/DemoStyle.scss'\nimport Demo from './Demo'\nimport Playground from './playground/Playground'\nimport SynapseFormWrapper from '../../lib/containers/synapse_form_wrapper/SynapseFormWrapper'\nimport SynapseFormSubmissionsGrid from '../../lib/containers/synapse_form_wrapper/SynapseFormSubmissionsGrid'\nimport { SynapseClient } from '../../lib/utils/'\nimport { RouteChildrenProps } from 'react-router'\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\n\ntype AppState = {\n  token: string\n}\nexport const TokenContext = React.createContext('')\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      token: '',\n    }\n  }\n\n  handleChange = (updatedState: {}): void => {\n    this.setState(updatedState)\n  }\n\n  public componentDidMount() {\n    // Note:  All portals should do this once on the initial app load.\n    // This looks for the session token cookie (HttpOnly, unable to directly access), and initialize the session if it does exists.\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then(sessionToken => this.handleChange({ token: sessionToken }))\n      .catch((error: any) => {\n        console.error(error)\n      })\n  }\n\n  getSession = () => {\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then(sessionToken => this.handleChange({ token: sessionToken }))\n      .catch((error: any) => {\n        console.error(error)\n      })\n  }\n\n  renderLoginAndSignout(token: string): JSX.Element {\n    const signedInState = (\n      <div className=\"bg-success text-center\" role=\"alert\">\n        You are logged in.&nbsp;\n        <button\n          onClick={() => {\n            SynapseClient.signOut(this.getSession)\n          }}\n        >\n          <span aria-hidden=\"true\">Sign out</span>\n        </button>\n      </div>\n    )\n\n    const notSignedInState = (\n      <div className=\"text-center\">\n        <h4>Synapse Production (Google SSO redirects here)</h4>\n        <Login sessionCallback={this.getSession} theme={'light'} icon={true} />\n        <details>\n          <summary>\n            Synapse Staging (Google SSO redirects to staging site)\n          </summary>\n          <Login\n            sessionCallback={this.getSession}\n            theme={'dark'}\n            icon={true}\n            googleRedirectUrl={\n              'https://staging.synapse.org/Portal/oauth2callback?oauth2provider=GOOGLE_OAUTH_2_0'\n            }\n          />\n        </details>\n        <hr />\n      </div>\n    )\n\n    if (token && token !== '') {\n      return signedInState\n    } else {\n      return notSignedInState\n    }\n  }\n\n  public render(): JSX.Element {\n    const { token } = this.state\n    return (\n      <TokenContext.Provider value={token}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <div>\n            <div className=\"App-header text-center\">\n              <img src={logoSvg} className=\"App-logo\" alt=\"logo\" />\n              <h4 className=\"white-text\">Synapse React Client Demo</h4>\n            </div>\n            {this.renderLoginAndSignout(token)}\n            <ul>\n              <li>\n                <Link to=\"/\">Demo</Link>\n              </li>\n              <li>\n                <Link to=\"/Playground\">Playground</Link>\n              </li>\n              <li>\n                <Link to=\"/drugUploadTool\">Drug Upload Tool</Link>\n              </li>\n              <li>\n                <Link to=\"/contribReqForm\">\n                  AMP-AD external data contribution{' '}\n                </Link>\n              </li>\n            </ul>\n\n            <Route exact={true} path=\"/\" component={Demo} />\n            <Route\n              path=\"/Playground\"\n              component={(props: RouteChildrenProps) => (\n                <Playground {...props} token={token} />\n              )}\n            />\n            <Route\n              exact={true}\n              path=\"/drugUploadTool\"\n              render={props => {\n                const searchParamsProps: any = {}\n                // https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams -- needs polyfill for ie11\n                const searchParams = new URLSearchParams(props.location.search)\n                searchParams.forEach((value, key) => {\n                  searchParamsProps[key] = value\n                })\n                return !props.location.search ? (\n                  <SynapseFormSubmissionsGrid\n                    pathpart=\"drugUploadTool\"\n                    token={token}\n                    formClass=\"drug-upload-tool\"\n                    formGroupId=\"9\"\n                    itemNoun=\"Compound\"\n                  />\n                ) : (\n                  <SynapseFormWrapper\n                    {...props}\n                    formSchemaEntityId=\"syn20680102\"\n                    fileNamePath=\"naming.compound_name\"\n                    formUiSchemaEntityId=\"syn20693568\"\n                    formNavSchemaEntityId=\"syn20680027\"\n                    token={token}\n                    formTitle=\"Your Submission\"\n                    formClass=\"drug-upload-tool\"\n                    searchParams={searchParamsProps}\n                  />\n                )\n              }}\n            />\n\n            {/*------------------- contributions request form ---------------------------------*/}\n            <Route\n              exact={true}\n              path=\"/contribReqForm\"\n              render={props => {\n                let searchParamsProps: any = {}\n                // https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams -- needs polyfill for ie11\n                const searchParams = new URLSearchParams(props.location.search)\n                searchParams.forEach((value, key) => {\n                  searchParamsProps[key] = value\n                })\n                return !props.location.search ? (\n                  <SynapseFormSubmissionsGrid\n                    pathpart=\"contribReqForm\"\n                    formGroupId=\"11\"\n                    token={token}\n                    formClass=\"contribution-request\"\n                    itemNoun={'Contribution Request'}\n                  />\n                ) : (\n                  <SynapseFormWrapper\n                    {...props}\n                    formSchemaEntityId=\"syn20692910\"\n                    fileNamePath=\"study.submission_name\"\n                    formUiSchemaEntityId=\"syn20692911\"\n                    formNavSchemaEntityId=\"syn20968007\"\n                    isWizardMode={true}\n                    token={token}\n                    formTitle=\"Your Contribution Request\"\n                    formClass=\"contribution-request\"\n                    searchParams={searchParamsProps}\n                  />\n                )\n              }}\n            />\n          </div>\n        </Router>\n      </TokenContext.Provider>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\nimport App from './demo/containers/App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","export * from './QueryTableResults'","module.exports = __webpack_public_path__ + \"static/media/Data2.1104e430.svg\";","// Folder exports\nexport * from './Download'\nexport * from './EvaluationQueryTable'\nexport * from './Table'\nexport * from './AccessRequirement'\n// https://basarat.gitbooks.io/typescript/docs/tips/barrel.html\nexport * from './AccessCodeResponse'\nexport * from './AccessControlList'\nexport * from './AddFilesToDownloadListRequest'\nexport * from './AddFilesToDownloadListResponse'\nexport * from './AddPartResponse'\nexport * from './AttachmentData'\nexport * from './BatchFileRequest'\nexport * from './BatchFileResult'\nexport * from './BatchPresignedUploadUrlRequest'\nexport * from './BatchPresignedUploadUrlResponse'\nexport * from './BulkFileDownloadRequest'\nexport * from './BulkFileDownloadResponse'\nexport * from './Entity'\nexport * from './EntityHeader'\nexport * from './EntityId'\nexport * from './EntityLookupRequest'\nexport * from './Evaluation'\nexport * from './EvaluationQueryTable'\nexport * from './FileDownloadSummary'\nexport * from './FileEntity'\nexport * from './FileHandle'\nexport * from './FileHandleAssociation'\nexport * from './FileHandleResults'\nexport * from './FileResult'\nexport * from './FileUploadComplete'\nexport * from './Forms'\nexport * from './LoginRequest'\nexport * from './LoginResponse'\nexport * from './MultipartUploadRequest'\nexport * from './MultipartUploadStatus'\nexport * from './OAuthClientPublic'\nexport * from './OIDCAuthorizationRequest'\nexport * from './OAuthConsentGrantedResponse'\nexport * from './OIDCAuthorizationRequestDescription'\nexport * from './PaginatedResults'\nexport * from './PartPresignedUrl'\nexport * from './ReferenceList'\nexport * from './ResourceAccess'\nexport * from './RestrictionInformation'\nexport * from './Statistics'\nexport * from './Submission'\nexport * from './SubmissionContributor'\nexport * from './SubmissionQuota'\nexport * from './SynapseVersion'\nexport * from './UserBundle'\nexport * from './UserGroupHeader'\nexport * from './UserGroupHeaderResponsePage'\nexport * from './UserPreference'\nexport * from './UserProfile'\nexport * from './VerificationSubmission'\nexport * from './WikiPage'\nexport * from './Evaluation'\nexport * from './AccessApproval'\n","export * from './DownloadList'\nexport * from './DownloadOrder'","export * from './AsyncJobId'\nexport * from './AsynchronousJobStatus'\nexport * from './ColumnModel'\nexport * from './ColumnType'\nexport * from './CsvTableDescription'\nexport * from './DownloadFromTableRequest'\nexport * from './DownloadFromTableResult'\nexport * from './FacetColumnRequest'\nexport * from './FacetColumnResult'\nexport * from './FacetType'\nexport * from './Query'\nexport * from './QueryBundleRequest'\nexport * from './QueryResult'\nexport * from './QueryResultBundle'\nexport * from './SelectColumn'\nexport * from './SumFileSizes'","// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/ColumnType.html\nexport enum ColumnType {\n  STRING = 'STRING',\n  DOUBLE = 'DOUBLE',\n  BOOLEAN = 'BOOLEAN',\n  INTEGER = 'INTEGER',\n  DATE = 'DATE',\n  FILEHANDLEID = 'FILEHANDLEID',\n  ENTITYID = 'ENTITYID',\n  LINK = 'LINK',\n  LARGETEXT = 'LARGETEXT',\n  USERID = 'USERID',\n}\n","export * from './AccessRequirement'\nexport * from './RestrictableObjectDescriptor'\nexport * from './SelfSignAccessRequirement'\nexport * from './SelfSignAccessRequirementInterface'\nexport * from './TermsOfUseAccessRequirement'\n","import { RestrictableObjectDescriptor } from './RestrictableObjectDescriptor'\n\nexport enum ACCESS_TYPE {\n  CREATE = 'CREATE',\n  READ = 'READ',\n  UPDATE = 'UPDATE',\n  DELETE = 'DELETE',\n  CHANGE_PERMISSIONS = 'CHANGE_PERMISSIONS',\n  DOWNLOAD = 'DOWNLOAD',\n  UPLOAD = 'UPLOAD',\n  PARTICIPATE = 'PARTICIPATE',\n  SUBMIT = 'SUBMIT',\n  READ_PRIVATE_SUBMISSION = 'READ_PRIVATE_SUBMISSION',\n  UPDATE_SUBMISSION = 'UPDATE_SUBMISSION',\n  DELETE_SUBMISSION = 'DELETE_SUBMISSION',\n  TEAM_MEMBERSHIP_UPDATE = 'TEAM_MEMBERSHIP_UPDATE',\n  SEND_MESSAGE = 'SEND_MESSAGE',\n  CHANGE_SETTINGS = 'CHANGE_SETTINGS',\n  MODERATE = 'MODERATE',\n}\n\nexport interface AccessRequirement {\n  versionNumber: number //\tThe version number issued to this version on the object.\n  id: number //\tThe unique immutable ID. Provided by the system, the user may not set this field.\n  etag: string //\tSynapse employs an Optimistic Concurrency Control (OCC) scheme to handle concurrent updates. Since the E-Tag changes every time an entity is updated it is used to detect when a client's current representation of an object is out-of-date.\n  createdOn: string //\tThe date this object was created. Provided by the system, the user may not set this field.\n  modifiedOn: string //\tThe date this object was last modified. Provided by the system, the user may not set this field.\n  createdBy: string //\tThe user that created this object. Provided by the system, the user may not set this field.\n  modifiedBy: string //\tThe user that last modified this object. Provided by the system, the user may not set this field.\n  subjectIds: Array<RestrictableObjectDescriptor> // The IDs of the items controlled by this Access Requirement. Required when creating or updating.\n  accessType: ACCESS_TYPE //\tThe enumeration of possible permission.\n  concreteType: string //\tIndicates which type of AccessRequirement this object represents. Provided by the system, the user may not set this field.\n}\n","import { FileHandleAssociation } from './FileHandleAssociation'\n\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/ZipFileFormat.html\nexport enum ZipFileFormat {\n  CommandLineCache = 'CommandLineCache', // This is the default format. Zip file format structure is: (%1000)//\n  Flat = 'Flat', // Files are writtent to the zip 'flat' with no directory structure.\n  //Each file is named after the original file. Duplicate file names are appended with a number in parenthesis to ensure all names are unique.\n}\n\n// Request for a bulk file download.\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/BulkFileDownloadRequest.html\nexport type BulkFileDownloadRequest = {\n  concreteType: 'org.sagebionetworks.repo.model.file.BulkFileDownloadRequest'\n  requestedFiles: FileHandleAssociation[] // The files to be included in the download.\n  zipFileName: string // Optional parameter to set the name of the resulting zip file.\n  zipFileFormat?: ZipFileFormat // Enumeration of all possible zip file formats produced by bulk file download worker\n}\n","import { FileHandleAssociateType } from './FileHandleAssociation'\n\n// The download status of this file.\nexport enum FileDownloadStatus {\n  SUCCESS = 'SUCCESS',\n  FAILURE = 'FAILURE',\n}\n\n// If the download status of this file is set to 'FAILURE', then this will be the failure code. Null for 'SUCCESS'.\nexport enum FileDownloadCode {\n  NOT_FOUND = 'NOT_FOUND',\n  UNAUTHORIZED = 'UNAUTHORIZED',\n  DUPLICATE = 'DUPLICATE',\n  EXCEEDS_SIZE_LIMIT = 'EXCEEDS_SIZE_LIMIT',\n  UNKNOWN_ERROR = 'UNKNOWN_ERROR',\n}\n\n// https://docs.synapse.org/rest/org/sagebionetworks/repo/model/file/FileDownloadSummary.html\nexport type FileDownloadSummary = {\n  fileHandleId: string //\tThe file handle id of a requested file.\n  associateObjectId: string //\tThe ID of the object associated with the file\n  associateObjectType: FileHandleAssociateType //\tEnumeration of all possible objects types that can be associated with a file.\n  zipEntryName: string //\tThe zip entry name used for this file. This entry includes both the path and file name. The value will only be set if the status is set to 'SUCCESS'\n  status: FileDownloadStatus //\tThe download status of this file.\n  failureMessage: string //\tIf the download status of this file is set to 'FAILURE', then this will be the failure message. Null for 'SUCCESS'.\n  failureCode: FileDownloadCode | null // If the download status of this file is set to 'FAILURE', then this will be the failure code. Null for 'SUCCESS'.\n}\n","export enum FileHandleAssociateType {\n  FileEntity = 'FileEntity',\n  TableEntity = 'TableEntity',\n  WikiAttachment = 'WikiAttachment',\n  WikiMarkdown = 'WikiMarkdown',\n  UserProfileAttachment = 'UserProfileAttachment',\n  MessageAttachment = 'MessageAttachment',\n  TeamAttachment = 'TeamAttachment',\n  SubmissionAttachment = 'SubmissionAttachment',\n  VerificationSubmission = 'VerificationSubmission',\n  AccessRequirementAttachment = 'AccessRequirementAttachment',\n  DataAccessRequestAttachment = 'DataAccessRequestAttachment',\n  DataAccessSubmissionAttachment = 'DataAccessSubmissionAttachment',\n}\n\nexport type FileHandleAssociation = {\n  fileHandleId: string //\tThe ID of the FileHandle.\n  associateObjectId: string //\tThe ID of the object associated with the file\n  associateObjectType: FileHandleAssociateType //\tEnumeration of all possible objects types that can be associated with a file.\n}\n","//https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormGroup.html\nexport type FormGroup = {\n  groupId: string\n  name: string\n  createdBy: string\n  createdOn: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormData.html\nexport type FormData = {\n  formDataId: string\n  etag: string\n  groupId: string\n  name: string\n  createdBy: string\n  createdOn: string\n  modifiedOn: string\n  dataFileHandleId: string\n  submissionStatus: SubmissionStatus\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormChangeRequest.html\nexport type FormChangeRequest = {\n  name: string\n  fileHandleId: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormRejection.html\nexport type FormRejection = {\n  reason: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/SubmissionStatus.html\nexport type SubmissionStatus = {\n  submittedOn?: string\n  reviewedOn?: string\n  reviewedBy?: string\n  state: StatusEnum\n  rejectionMessage?: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/StatusEnum.html\nexport enum StatusEnum {\n  WAITING_FOR_SUBMISSION = 'WAITING_FOR_SUBMISSION',\n  SUBMITTED_WAITING_FOR_REVIEW = 'SUBMITTED_WAITING_FOR_REVIEW',\n  ACCEPTED = 'ACCEPTED',\n  REJECTED = 'REJECTED',\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/ListRequest.html\nexport type ListRequest = {\n  filterByState?: StatusEnum[]\n  groupId: string\n  nextPageToken?: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/ListResponse.html\nexport type ListResponse = {\n  page: FormData[]\n  nextPageToken?: string\n}\n","// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictableObjectType.html\nexport enum RestrictableObjectType {\n  ENTITY = 'ENTITY',\n  EVALUATION = 'EVALUATION',\n  TEAM = 'TEAM',\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictionInformationRequest.html\nexport type RestrictionInformationRequest = {\n  restrictableObjectType: RestrictableObjectType\n  objectId: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictionLevel.html\nexport enum RestrictionLevel {\n  OPEN = 'OPEN',\n  RESTRICTED_BY_TERMS_OF_USE = 'RESTRICTED_BY_TERMS_OF_USE',\n  CONTROLLED_BY_ACT = 'CONTROLLED_BY_ACT',\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/RestrictionInformationResponse.html\nexport type RestrictionInformationResponse = {\n  restrictionLevel: RestrictionLevel\n  hasUnmetAccessRequirement: boolean\n}\n","export enum ApprovalState {\n  APPROVED = 'APPROVED',\n  REVOKED = 'REVOKED',\n}\n\nexport interface AccessApproval {\n  id: number //\tThe unique immutable ID\n  etag: string //\tSynapse employs an Optimistic Concurrency Control (OCC) scheme to handle concurrent updates. Since the E-Tag changes every time an entity is updated it is used to detect when a client's current representation of an object is out-of-date.\n  createdOn: string //\tThe date this object was created.\n  modifiedOn: string //\tThe date this object was last modified.\n  createdBy: string //\tThe user that created this object.\n  modifiedBy: string //\tThe user that last modified this object.\n  requirementId: number //\tThe ID of the Access Requirement that this object approves.\n  requirementVersion: number //\tThe version of the Access Requirement that this object approves.\n  submitterId: string //\tThe user who performed the necessary action(s) to gain this approval.\n  accessorId: string //\tThe ID of the principal (user or group) approved for access\n  expiredOn: string //\tThe date this object will be expired.\n  state: ApprovalState //\tJSON enum for the state of AccessApproval\n}\n","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","module.exports = __webpack_public_path__ + \"static/media/study-active.bc52e72b.svg\";","module.exports = __webpack_public_path__ + \"static/media/study-complete.b012f80b.svg\";","module.exports = __webpack_public_path__ + \"static/media/DNA_Two.d8f80972.svg\";","module.exports = __webpack_public_path__ + \"static/media/expand.2b935894.svg\";","module.exports = __webpack_public_path__ + \"static/media/shrink.199a8060.svg\";","module.exports = __webpack_public_path__ + \"static/media/columns.94835d60.svg\";","module.exports = __webpack_public_path__ + \"static/media/file-dotted.2dcc2eac.svg\";","module.exports = __webpack_public_path__ + \"static/media/json-form-tool-no-submissions.e64940c0.svg\";","module.exports = __webpack_public_path__ + \"static/media/brain.c6301611.svg\";","module.exports = __webpack_public_path__ + \"static/media/circle.ed6d433a.svg\";","module.exports = __webpack_public_path__ + \"static/media/mouse.7e294e96.svg\";","module.exports = __webpack_public_path__ + \"static/media/resiliencead.7500217a.svg\";"],"sourceRoot":""}