import{r as g}from"./jsx-runtime.6fc4771b.js";import{u as S}from"./use-deep-compare-effect.esm.d30c5f7a.js";import{h as O,az as T,aD as R,aB as h,aC as _,n as k,al as A,aE as y}from"./index.bff2d9c7.js";import{u as F,c as N}from"./uniq.5c9ab91a.js";import{w as D}from"./without.11ee909d.js";const b={ownerId:"",firstName:"Unknown",lastName:"Unknown",userName:"Unknown",isIndividual:!1},H={name:"Unknown",id:"unknown",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:0,versionLabel:"placeholder",benefactorId:0,createdOn:"null",modifiedOn:"null",createdBy:"null",modifiedBy:"null",isLatestVersion:!0},v={id:"unknown",etag:"Unknown",name:"Unknown",description:"Unknown",ownerId:"null",createdOn:"null",contentSource:"Unknown",submissionInstructionsMessage:"Unknown",submissionReceiptMessage:"Unknown"},L=async(o,c)=>{const e=await k(o,c),n=o.filter(t=>e.results.map(d=>d.id).indexOf(t.targetId)===-1).map(t=>({...H,id:t.targetId,name:`${t.targetId}`}));return[...e.results,...n]},P=async o=>{const c=(await A(o)).children,i=o.filter(n=>c.map(t=>t.ownerId).indexOf(n)===-1).map(n=>({...b,ownerId:n,name:`Unknown User (${n})`}));return[...c,...i]},x=async(o,c)=>{const e=await y(o,c),n=o.filter(t=>e.results.map(d=>d.id).indexOf(t)===-1).map(t=>({...v,id:t,name:t}));return[...e.results,...n]};function K(o){const{ids:c,type:e}=o,{accessToken:i}=O(),[n,t]=g.exports.useState([]),d=a=>a==="USER_PROFILE"?"ownerId":"id",w=a=>{switch(a){case"USER_PROFILE":return _;case"ENTITY_HEADER":return h;case"EVALUATION_QUEUE":return R;default:return""}},p=n.map(a=>a[d(e)]),U=c.filter(a=>a!==T),I=F(D(U,...p));return g.exports.useEffect(()=>{((l,r)=>{if(!l.length)return;const E=sessionStorage.getItem(w(r));try{const u=E?JSON.parse(E):[],m=u.map(s=>s[d(r)]);for(const s of l)m.includes(s[d(r)])||u.push(s);sessionStorage.setItem(w(r),JSON.stringify(u))}catch{sessionStorage.setItem(w(r),JSON.stringify(l))}})(n,e)},[n,e]),S(()=>{let a=!1;return(async()=>{if(I.length>0)try{const r=Array.from(I),E=e==="ENTITY_HEADER"?r.map(s=>({targetId:s})):r,u=N(E,45),m=[];for(const s of u){let f=[];switch(e){case"USER_PROFILE":f=await P(s);break;case"ENTITY_HEADER":f=await L(s,i);break;case"EVALUATION_QUEUE":f=await x(s,i);break}m.push(...f)}a||t(s=>s.concat(...m))}catch(r){console.error("Error on data retrieval",r)}})(),()=>{a=!0}},[i,e,I]),n}export{K as u};
