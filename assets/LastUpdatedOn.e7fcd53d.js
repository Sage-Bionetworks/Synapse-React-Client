import{d as K,e as ye,j as ge,k as Se,n as dt,o as ct,C as ut,p as pt,q as ht,T as mt,E as ft,h as yt,i as gt}from"./TotalQueryResults.1f6dc509.js";import{H as Ve}from"./HelpPopover.40707dff.js";import{u as St,I as $,S as bt}from"./IconSvg.f48e59e1.js";import{j as r,a as E,F as A}from"./jsx-runtime.2e925369.js";import{a as Pe}from"./Collapse.b335a5d4.js";import{u as $e}from"./unCamelCase.d070537b.js";import{C as q}from"./ColumnType.744125d2.js";import"./assert.11368392.js";import{C as Ct,d as Me}from"./ToastMessage.574c0fe0.js";import{bS as wt,bd as vt,r as Tt,bT as Rt,am as It,bU as Et,W as _t,bJ as xt,bu as Lt,aE as qt,bV as Qe,K as Dt,C as Ot,H as Nt}from"./index.5cb3fa28.js";import{T as be}from"./Typography.e08e7569.js";import{h as Y,j as U,k as At,l as Ft}from"./EntityTypeUtils.8627ed97.js";import{c as kt}from"./useGetQueryResultBundle.748b96c3.js";import{c as X}from"./createSvgIcon.53013205.js";import{Q as Vt}from"./QueryCount.39945aa4.js";import{E as Ce}from"./ElementWithTooltip.9459eec0.js";import{R as tt}from"./index.es.82d55a6a.js";import{b as Pt,a as J,e as $t}from"./useUserBundle.b392c93a.js";import{M as Q,a as Bt,b as zt}from"./Modal.739750b1.js";import{B as me}from"./Button.77571428.js";import{u as Mt}from"./use-deep-compare-effect.esm.9d3fc03b.js";import{P as Qt}from"./ProgrammaticInstructionsModal.de567c5d.js";import{D as z}from"./Dropdown.edf6576c.js";import{c as H}from"./cloneDeep.fef89611.js";import{a as Ht,z as Ut}from"./iframe.beffb7c0.js";import{N as Wt}from"./NoData.928742eb.js";import{P as Oe}from"./getEndpoint.0de7fccf.js";import{a as Gt,U as Yt,g as Kt}from"./UserCard.07e91ba9.js";import{p as jt,b as nt,f as Xt}from"./sqlFunctions.b49ac766.js";import{D as ot}from"./DirectDownload.eda84e8c.js";import{H as Jt}from"./HasAccessV2.40931ed3.js";import{l as Zt}from"./LoadingScreen.85210ad1.js";import{I as en}from"./index.0eae8170.js";import{u as Be}from"./react-intersection-observer.m.66de6abb.js";import{E as Ne}from"./EntityLink.d667fd1e.js";import{S as tn}from"./GenericCard.4c2dc16c.js";import{N as nn,I as He}from"./SynapseTableConstants.07ecdebd.js";import{n as on}from"./uniq.1da436f4.js";import{C as an}from"./Checkbox.995e1545.js";import{S as rn,N as sn}from"./SearchResultsNotFound.263a233e.js";import{_ as W}from"./objectWithoutPropertiesLoose.d29fb19f.js";import{a as ze,_ as P}from"./toConsumableArray.5f669646.js";import{w as at,j as M,b as Ae,d as Re}from"./withStyles.4f64abe1.js";import{_ as ln}from"./utils.ebacc06c.js";import{u as dn}from"./useTheme.735ed160.js";import{B as cn}from"./ButtonBase.ab38336e.js";import{e as te}from"./_Uint8Array.692793fe.js";import{h as un}from"./moment.81704e1d.js";import{f as pn}from"./DateFormatter.03fd1e7d.js";const hn=window.React;var mn=X(hn.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function fn(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=p.boundaryCount,n=t===void 0?1:t,o=p.componentName,d=o===void 0?"usePagination":o,i=p.count,c=i===void 0?1:i,h=p.defaultPage,C=h===void 0?1:h,f=p.disabled,T=f===void 0?!1:f,l=p.hideNextButton,m=l===void 0?!1:l,w=p.hidePrevButton,I=w===void 0?!1:w,y=p.onChange,R=p.page,s=p.showFirstButton,L=s===void 0?!1:s,a=p.showLastButton,e=a===void 0?!1:a,u=p.siblingCount,g=u===void 0?1:u,S=ze(p,["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"]),v=St({controlled:R,default:C,name:d,state:"page"}),b=ln(v,2),_=b[0],x=b[1],F=function(V,B){R||x(B),y&&y(V,B)},O=function(V,B){var it=B-V+1;return Array.from({length:it},function(lo,lt){return V+lt})},D=O(1,Math.min(n,c)),k=O(Math.max(c-n+1,n+1),c),Z=Math.max(Math.min(_-g,c-n-g*2-1),n+2),ee=Math.min(Math.max(_+g,n+g*2+2),k[0]-2),we=[].concat(P(L?["first"]:[]),P(I?[]:["previous"]),P(D),P(Z>n+2?["start-ellipsis"]:n+1<c-n?[n+1]:[]),P(O(Z,ee)),P(ee<c-n-1?["end-ellipsis"]:c-n>n?[c-n]:[]),P(k),P(m?[]:["next"]),P(e?["last"]:[])),ve=function(V){switch(V){case"first":return 1;case"previous":return _-1;case"next":return _+1;case"last":return c;default:return null}},Te=we.map(function(N){return typeof N=="number"?{onClick:function(B){F(B,N)},type:"page",page:N,selected:N===_,disabled:T,"aria-current":N===_?"true":void 0}:{onClick:function(B){F(B,ve(N))},type:N,page:ve(N),selected:!1,disabled:T||N.indexOf("ellipsis")===-1&&(N==="next"||N==="last"?_>=c:_<=1)}});return W({items:Te},S)}const yn=window.React;var Ue=X(yn.createElement("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}));const gn=window.React;var We=X(gn.createElement("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}));const Sn=window.React;var Ge=X(Sn.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}));const bn=window.React;var Ye=X(bn.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}));const ne=window.React;var Cn=function(t){return{root:W({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:t.palette.text.primary}),page:{transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:t.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},"&$focusVisible":{backgroundColor:t.palette.action.focus},"&$selected":{backgroundColor:t.palette.action.selected,"&:hover, &$focusVisible":{backgroundColor:M(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:1,color:t.palette.action.disabled,backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:t.palette.action.disabledOpacity}},sizeSmall:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px","& $icon":{fontSize:t.typography.pxToRem(18)}},sizeLarge:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15),"& $icon":{fontSize:t.typography.pxToRem(22)}},textPrimary:{"&$selected":{color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.primary.dark,"@media (hover: none)":{backgroundColor:t.palette.primary.main}},"&$disabled":{color:t.palette.action.disabled}}},textSecondary:{"&$selected":{color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.secondary.dark,"@media (hover: none)":{backgroundColor:t.palette.secondary.main}},"&$disabled":{color:t.palette.action.disabled}}},outlined:{border:"1px solid ".concat(t.palette.type==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$selected":{"&$disabled":{border:"1px solid ".concat(t.palette.action.disabledBackground)}}},outlinedPrimary:{"&$selected":{color:t.palette.primary.main,border:"1px solid ".concat(M(t.palette.primary.main,.5)),backgroundColor:M(t.palette.primary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:M(t.palette.primary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},outlinedSecondary:{"&$selected":{color:t.palette.secondary.main,border:"1px solid ".concat(M(t.palette.secondary.main,.5)),backgroundColor:M(t.palette.secondary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:M(t.palette.secondary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},rounded:{borderRadius:t.shape.borderRadius},ellipsis:{height:"auto","&$disabled":{opacity:t.palette.action.disabledOpacity}},focusVisible:{},disabled:{},selected:{},icon:{fontSize:t.typography.pxToRem(20),margin:"0 -8px"}}},wn=ne.forwardRef(function(t,n){var o=t.classes,d=t.className,i=t.color,c=i===void 0?"standard":i,h=t.component,C=t.disabled,f=C===void 0?!1:C,T=t.page,l=t.selected,m=l===void 0?!1:l,w=t.shape,I=w===void 0?"round":w,y=t.size,R=y===void 0?"medium":y,s=t.type,L=s===void 0?"page":s,a=t.variant,e=a===void 0?"text":a,u=ze(t,["classes","className","color","component","disabled","page","selected","shape","size","type","variant"]),g=dn(),S=g.direction==="rtl"?{previous:Ye,next:Ge,last:Ue,first:We}:{previous:Ge,next:Ye,first:Ue,last:We},v=S[L];return L==="start-ellipsis"||L==="end-ellipsis"?ne.createElement("div",{ref:n,className:Ae(o.root,o.ellipsis,f&&o.disabled,R!=="medium"&&o["size".concat(Re(R))])},"\u2026"):ne.createElement(cn,W({ref:n,component:h,disabled:f,focusVisibleClassName:o.focusVisible,className:Ae(o.root,o.page,o[e],o[I],d,c!=="standard"&&o["".concat(e).concat(Re(c))],f&&o.disabled,m&&o.selected,R!=="medium"&&o["size".concat(Re(R))])},u),L==="page"&&T,v?ne.createElement(v,{className:o.icon}):null)}),vn=at(Cn,{name:"MuiPaginationItem"})(wn);const j=window.React;var Tn={root:{},ul:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}};function Rn(p,t,n){return p==="page"?"".concat(n?"":"Go to ","page ").concat(t):"Go to ".concat(p," page")}var In=j.forwardRef(function(t,n){t.boundaryCount;var o=t.classes,d=t.className,i=t.color,c=i===void 0?"standard":i;t.count,t.defaultPage,t.disabled;var h=t.getItemAriaLabel,C=h===void 0?Rn:h;t.hideNextButton,t.hidePrevButton,t.onChange,t.page;var f=t.renderItem,T=f===void 0?function(e){return j.createElement(vn,e)}:f,l=t.shape,m=l===void 0?"round":l;t.showFirstButton,t.showLastButton,t.siblingCount;var w=t.size,I=w===void 0?"medium":w,y=t.variant,R=y===void 0?"text":y,s=ze(t,["boundaryCount","classes","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"]),L=fn(W({},t,{componentName:"Pagination"})),a=L.items;return j.createElement("nav",W({"aria-label":"pagination navigation",className:Ae(o.root,d),ref:n},s),j.createElement("ul",{className:o.ul},a.map(function(e,u){return j.createElement("li",{key:u},T(W({},e,{color:c,"aria-label":C(e.type,e.page,e.selected),shape:m,size:I,variant:R})))})))}),En=at(Tn,{name:"MuiPagination"})(In);const _n=window.React.useRef,xn=window.React.useState,Ie=3,Ee=({helpMessage:p="This search bar is powered by MySQL Full Text Search.",helpUrl:t})=>{const{executeQueryRequest:n,getLastQueryRequest:o}=K(),{topLevelControlsState:{showSearchBar:d,showFacetFilter:i}}=ye(),[c,h]=xn(""),C=_n(null),f=l=>{var m;if(l.preventDefault(),c.trim().length<Ie)(m=C.current)==null||m.setCustomValidity(`Search term must have a minimum of ${Ie} characters`);else{const w=o(),{additionalFilters:I=[]}=w.query,y={concreteType:"org.sagebionetworks.repo.model.table.TextMatchesQueryFilter",searchExpression:c};if(I.find(s=>s.concreteType==y.concreteType&&s.searchExpression==y.searchExpression))return;I.push(y),w.query.additionalFilters=I,n(w),h("")}},T=l=>{var m;(m=C.current)==null||m.setCustomValidity(""),h(l.currentTarget.value)};return r("div",{className:`QueryWrapperSearchInput ${i?ge:Se}`,children:r(Pe,{in:d,timeout:{enter:300,exit:300},children:E("div",{className:"QueryWrapperSearchInput__helppopoverwrapper",children:[E("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:f,children:[r("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:r($,{options:{icon:"search"}})}),r("input",{ref:C,minLength:Ie,onChange:T,placeholder:"Enter Search Terms",value:c,type:"text"}),c.length>0&&r("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{h("")},children:r($,{options:{icon:"close"}})})]}),r("div",{className:"QueryWrapperSearchInput__helppopover",children:r(Ve,{markdownText:p,helpUrl:t,placement:"left"})})]})})})};try{Ee.displayName="FullTextSearch",Ee.__docgenInfo={description:"",displayName:"FullTextSearch",props:{helpMessage:{defaultValue:{value:"This search bar is powered by MySQL Full Text Search."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:null,description:"",name:"helpUrl",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/FullTextSearch.tsx#FullTextSearch"]={docgenInfo:Ee.__docgenInfo,name:"FullTextSearch",path:"src/lib/containers/FullTextSearch.tsx#FullTextSearch"})}catch{}const Fe="First line is the columns names.",ke="Include row metadata (Row Id and Row Version).",fe="Comma Separated Values (CSV)",Ke="Tab Separated Values (TSV)",Ln={title:"Download query results",type:"object",properties:{"File Type":{type:"string",oneOf:[{const:fe,title:fe},{const:Ke,title:Ke}]},Contents:{type:"array",title:"Contents",items:{type:"string",enum:[Fe,ke]},uniqueItems:!0}}},qn={"File Type":{"ui:widget":"radio"},Contents:{"ui:widget":"checkboxes"}},Dn={title:"Download query results",description:"File is ready for download. Select the download button to download the file.",type:"object"},On={},Nn=[Ln,Dn],An=[qn,On],Fn=window.React,kn=window.JSONSchemaForm;class G extends Fn.Component{constructor(t){super(t),this.handleSubmit=n=>{this.state.step===0?this.handleDownloadSetup(n):this.onDownload()},this.handleDownloadSetup=n=>{this.setState({isLoading:!0});const{formData:o}=n,d=o["File Type"],i=o.Contents,{queryBundleRequest:c,getLastQueryRequest:h}=this.props,C=d===fe?",":"	",f=i.includes(Fe),T=i.includes(ke),l=c!=null?c:h(),m=l.query.sql,w={sql:m,entityId:jt(m),selectedFacets:l.query.selectedFacets,concreteType:"org.sagebionetworks.repo.model.table.DownloadFromTableRequest",writeHeader:f,includeRowIdAndRowVersion:T,csvTableDescriptor:{separator:C},additionalFilters:l.query.additionalFilters};wt(w,this.context.accessToken).then(I=>{this.setState({isLoading:!1,step:1,data:I})}).catch(I=>{console.log("Error getDownloadFromTableRequest: ",I)})},this.onDownload=()=>{const{data:n}=this.state;vt(n.resultsFileHandleId,this.context.accessToken).then(o=>{window.location.href=o,this.props.onClose()})},this.handleChange=n=>{const{formData:o}=n;this.setState({formData:o})},this.state={isLoading:!1,step:0,formData:{"File Type":fe,Contents:[Fe,ke]}}}render(){const t={position:"absolute",top:10,right:10,zIndex:10},n={height:50,width:50,backgroundSize:50};return r(Q,{animation:!1,show:!0,onHide:this.props.onClose,backdrop:"static",children:E(Q.Body,{children:[r("button",{style:t,onClick:this.props.onClose,children:r($,{options:{icon:"close"}})}),E(kn,{schema:Nn[this.state.step],uiSchema:An[this.state.step],onChange:this.handleChange,formData:this.state.formData,onSubmit:this.handleSubmit,children:[this.state.isLoading&&r("div",{className:"SRC-centerAndJustifyContent",children:E("div",{className:"SRC-center-text",children:[r("p",{children:" Creating the File "}),r("div",{style:n,className:"spinner"}),r("p",{children:" Loading... "})]})}),E("div",{style:{textAlign:"right"},children:[r(me,{variant:"default",onClick:this.props.onClose,style:{marginRight:"5px"},children:"Cancel"}),r(me,{type:"submit",variant:"primary",children:this.state.step===0?"Next":"Download"})]})]})]})})}}G.contextType=Pt;try{G.displayName="ModalDownload",G.__docgenInfo={description:"",displayName:"ModalDownload",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(...args: any[]) => void"}},includeEntityEtag:{defaultValue:null,description:"",name:"includeEntityEtag",required:!1,type:{name:"boolean"}},queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!1,type:{name:"QueryBundleRequest"}},getLastQueryRequest:{defaultValue:null,description:"",name:"getLastQueryRequest",required:!1,type:{name:"(() => QueryBundleRequest)"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}},limit:{defaultValue:null,description:"",name:"limit",required:!1,type:{name:"number"}},sort:{defaultValue:null,description:"",name:"sort",required:!1,type:{name:"SortItem[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/ModalDownload.tsx#ModalDownload"]={docgenInfo:G.__docgenInfo,name:"ModalDownload",path:"src/lib/containers/ModalDownload.tsx#ModalDownload"})}catch{}const _e=window.React;class xe extends _e.Component{constructor(t){var n;super(t),this.handleClickOutsideForm=o=>{var d,i;!((d=this.searchFormRef.current)!=null&&d.contains(o==null?void 0:o.target))&&!((i=this.radioFormRef.current)!=null&&i.contains(o==null?void 0:o.target))&&(this.state.didUpdateRanLast?this.setState({didUpdateRanLast:!1}):this.setState({show:!1}))},this.search=o=>{var w,I,y,R,s,L,a;o.preventDefault();const{searchText:d}=this.state;let{columnName:i}=this.state;const{searchable:c,lockedFacet:h}=this.props;if(i==="")if(c)i=c.filter(e=>e!==(h==null?void 0:h.facet))[0];else{const e=(y=(I=(w=this.props.queryContext)==null?void 0:w.data)==null?void 0:I.columnModels)==null?void 0:y.filter(u=>u.name!==(h==null?void 0:h.facet)).filter(u=>this.isSupportedColumn(u));i=(R=e==null?void 0:e[0].name)!=null?R:""}this.setState({show:!1});const{executeQueryRequest:C,getLastQueryRequest:f}=this.props.queryContext,T=f(),{additionalFilters:l=[]}=T.query,m=l.findIndex(e=>!!(dt(e)||ct(e)&&e.columnName===i));if(m===-1){const e=(a=(L=(s=this.props.queryContext)==null?void 0:s.data)==null?void 0:L.columnModels)==null?void 0:a.filter(u=>u.name===i)[0];if(e!=null&&e.columnType.endsWith("_LIST")){const u={columnName:i,function:ut.HAS_LIKE,values:[`%${d}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnMultiValueFunctionQueryFilter"};l.push(u)}else{const u={columnName:i,operator:pt.LIKE,values:[`%${d}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};l.push(u)}}else l[m].values.push(`%${d}%`);T.query.additionalFilters=l,C(T)},this.handleChange=o=>{this.setState({searchText:o.currentTarget.value})},this.isSupportedColumn=o=>{switch(o==null?void 0:o.columnType){case q.FILEHANDLEID:case q.ENTITYID:case q.DATE:case q.DATE_LIST:case q.USERID:return!1;default:return!0}},this.isSupportedColumnAndInProps=o=>{if(this.isSupportedColumn(o)){const{searchable:d}=this.props;return d==null?void 0:d.some(i=>i===(o==null?void 0:o.name))}return!1},this.state={show:!1,didUpdateRanLast:!1,searchText:"",columnName:(n=this.props.defaultColumn)!=null?n:""},this.searchFormRef=_e.createRef(),this.radioFormRef=_e.createRef()}componentDidMount(){document.addEventListener("click",this.handleClickOutsideForm)}componentDidUpdate(t){var n,o,d,i,c;!((n=t.queryVisualizationContext)!=null&&n.topLevelControlsState.showSearchBar)&&((o=this.props.queryVisualizationContext)==null?void 0:o.topLevelControlsState.showSearchBar)&&(this.setState({show:!0,didUpdateRanLast:!0}),(c=(i=(d=this.searchFormRef)==null?void 0:d.current)==null?void 0:i.querySelector("input"))==null||c.focus())}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutsideForm)}render(){var l;const{searchable:t,lockedFacet:n,queryContext:{data:o},queryVisualizationContext:{topLevelControlsState:d,facetAliases:i}}=this.props,{searchText:c,show:h,columnName:C}=this.state;let f=[];t?f=t.map(m=>{var w;return(w=o==null?void 0:o.columnModels)==null?void 0:w.find(I=>I.name===m)}).filter(this.isSupportedColumnAndInProps).map(m=>m.name):o!=null&&o.columnModels&&(f=(l=o.columnModels)==null?void 0:l.filter(this.isSupportedColumn).map(m=>m.name)),f.length&&(n==null?void 0:n.facet)&&(f=f.filter(m=>m!==(n==null?void 0:n.facet)));const T=d==null?void 0:d.showFacetFilter;return E("div",{className:`QueryWrapperSearchInput ${T?ge:Se}`,children:[r(Pe,{in:d==null?void 0:d.showSearchBar,children:E("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:this.search,onClick:()=>{this.setState({show:!0})},ref:this.searchFormRef,children:[r("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:r($,{options:{icon:"search"}})}),r("input",{onChange:this.handleChange,onClick:()=>{this.setState({show:!0})},placeholder:"Enter Search Terms",value:c,type:"text"}),this.state.searchText.length>0&&r("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{this.setState({searchText:""})},children:r($,{options:{icon:"close"}})})]})}),r("div",{className:"QueryWrapperSearchInput__dropdown_pos",children:r(Ct,{in:h,classNames:"QueryWrapperSearchInput__animate_dropdown",timeout:{enter:0,exit:300},children:E("form",{ref:this.radioFormRef,className:"QueryWrapperSearchInput__column-select QueryWrapperSearchInput__animate_height",children:[r("p",{className:"deemphasized",children:r("i",{children:" Search In Field: "})}),f.map((m,w)=>{const I=$e(m,i);return r("div",{className:"radio",children:r("label",{children:E("span",{children:[r("input",{id:m,type:"radio",value:m,checked:C===""&&w===0||C===m,onClick:()=>{var R,s,L;(L=(s=(R=this.searchFormRef)==null?void 0:R.current)==null?void 0:s.querySelector("input"))==null||L.focus(),this.setState({columnName:m})}}),r("span",{children:I})]})})},`search-field-${m}-${w}`)})]})})})]})}}try{xe.displayName="Search",xe.__docgenInfo={description:"",displayName:"Search",props:{queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},isQueryWrapperMenuChild:{defaultValue:null,description:"",name:"isQueryWrapperMenuChild",required:!1,type:{name:"boolean"}},defaultColumn:{defaultValue:null,description:"",name:"defaultColumn",required:!1,type:{name:"string"}},searchable:{defaultValue:null,description:"",name:"searchable",required:!1,type:{name:"SearchableColumnsV2"}},lockedFacet:{defaultValue:null,description:"",name:"lockedFacet",required:!1,type:{name:"LockedFacet"}},fullTextSearchHelpURL:{defaultValue:null,description:"",name:"fullTextSearchHelpURL",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/SearchV2.tsx#Search"]={docgenInfo:xe.__docgenInfo,name:"Search",path:"src/lib/containers/SearchV2.tsx#Search"})}catch{}const Vn=window.React.useEffect,Pn=window.React.useRef,$n=window.React.useState,Bn="The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients.",zn="https://help.synapse.org/docs/Searching-Tables-and-Views.2009596168.html#SearchingTablesandViews-UsingAdvancedSearchQueries",Le=({helpMessage:p=Bn,helpUrl:t=zn})=>{const{executeQueryRequest:n,getLastQueryRequest:o}=K(),{topLevelControlsState:{showSqlEditor:d,showFacetFilter:i}}=ye(),[c,h]=$n(""),C=Pn(null);Vn(()=>{var l;if(d){const m=o().query.sql;h(m),(l=C.current)==null||l.focus()}},[d,o]);const f=l=>{l.preventDefault();const m=o();m.query.sql=c,m.query.offset=0,m.query.additionalFilters=[],m.query.selectedFacets=[],n(m)},T=l=>{var m;(m=C.current)==null||m.setCustomValidity(""),h(l.currentTarget.value)};return r("div",{className:`QueryWrapperSqlEditorInput ${i?ge:Se}`,children:r(Pe,{in:d,timeout:{enter:300,exit:300},children:E("div",{className:"QueryWrapperSqlEditorInput__helppopoverwrapper",children:[E("form",{className:"QueryWrapperSqlEditorInput__searchbar",onSubmit:f,children:[r(bt,{className:"QueryWrapperSqlEditorInput__searchbar__searchicon"}),r("input",{ref:C,onChange:T,placeholder:"Enter Query",value:c,type:"text"})]}),r("div",{className:"QueryWrapperSqlEditorInput__helppopover",children:r(Ve,{markdownText:p,helpUrl:t,placement:"right"})})]})})})};try{Le.displayName="SqlEditor",Le.__docgenInfo={description:"",displayName:"SqlEditor",props:{helpMessage:{defaultValue:{value:"The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:{value:"https://help.synapse.org/docs/Searching-Tables-and-Views.2009596168.html#SearchingTablesandViews-UsingAdvancedSearchQueries"},description:"",name:"helpUrl",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/SqlEditor.tsx#SqlEditor"]={docgenInfo:Le.__docgenInfo,name:"SqlEditor",path:"src/lib/containers/SqlEditor.tsx#SqlEditor"})}catch{}const Mn="Files may be unavailable because you do not have permission to see them, they have been deleted, or the Dataset has been misconfigured.",Qn="Files may be unavailable because you do not have permission to see them or the Dataset was misconfigured.",ae=({entity:p})=>{var d,i;const t=p&&Y(p),n={concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",query:{sql:`SELECT * FROM ${p.id}${!p.isLatestVersion&&p.versionNumber?`.${p.versionNumber}`:""}`},entityId:p.id,partMask:Tt},{data:o}=kt(n,{enabled:t});if(t&&o&&p){const c=o.queryCount,h=(i=(d=p.items)==null?void 0:d.length)!=null?i:0;if(c===h)return r(A,{});const C=h-c;let f="";return p.isLatestVersion?f=Mn:f=Qn,E(be,{className:"SRC-centerContent",style:{marginLeft:10},variant:"smallText1",color:"textSecondary",children:[r(mn,{className:"SRC-color-warning",style:{fontSize:"16px"}}),C.toLocaleString()+" Unavailable",r(Ve,{className:"SRC-margin-left-5",markdownText:f,placement:"right"})]})}else return r(A,{})};try{ae.displayName="MissingQueryResultsWarning",ae.__docgenInfo={description:`If possible, this component will render a warning message if results may be missing from the query due to user permissions or
entities being deleted. If not possible, it will render an empty fragment.`,displayName:"MissingQueryResultsWarning",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Table"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/MissingQueryResultsWarning.tsx#MissingQueryResultsWarning"]={docgenInfo:ae.__docgenInfo,name:"MissingQueryResultsWarning",path:"src/lib/containers/MissingQueryResultsWarning.tsx#MissingQueryResultsWarning"})}catch{}const re=p=>E(Q,{animation:!1,show:!0,onHide:()=>p.onHide(),backdrop:"static",children:[r(Q.Header,{closeButton:!0,children:r("span",{style:{fontWeight:"bold",color:"#515359",fontSize:"1.5em"},children:"Sign In Required"})}),E(Bt,{children:[r("p",{children:"Anyone can browse public content on the Synapse website, but in order to download and create content you will need to register for an account using an email address."}),E("p",{children:["To find out more see\xA0",r("a",{href:"https://help.synapse.org/docs/Managing-your-account.2055405596.html",target:"_blank",rel:"noopener noreferrer",children:"User Accounts"}),r("span",{children:" and "}),r("a",{href:"https://help.synapse.org/docs/Governance-Overview.2009597114.html",rel:"noopener noreferrer",target:"_blank",children:"Governance Overview"}),"."]})]}),E(zt,{children:[r(me,{variant:"secondary",onClick:()=>p.onHide(),children:"CANCEL"}),r(me,{className:"SRC-SIGN-IN-CLASS",variant:"primary",onClick:()=>p.onHide(),children:"Sign in"})]})]});try{re.displayName="DownloadLoginModal",re.__docgenInfo={description:"",displayName:"DownloadLoginModal",props:{showModal:{defaultValue:null,description:"",name:"showModal",required:!1,type:{name:"boolean"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/DownloadLoginModal.tsx#DownloadLoginModal"]={docgenInfo:re.__docgenInfo,name:"DownloadLoginModal",path:"src/lib/containers/table/table-top/DownloadLoginModal.tsx#DownloadLoginModal"})}catch{}const je=window.React.useMemo,Hn=window.React.useState;function se({queryBundleRequest:p,queryResultBundle:t,onHide:n}){const[o,d]=Hn("");Mt(()=>{(async()=>{const{query:C}=p,{sql:f,selectedFacets:T=[]}=C,{columnModels:l}=t;l||console.error("Column Models must be included to complete transform sql request");const m={concreteType:"org.sagebionetworks.repo.model.table.TransformSqlWithFacetsRequest",sqlToTransform:f,selectedFacets:T,schema:l};try{const w=await Rt(m),I=w.transformedSql.toUpperCase().indexOf("FROM SYN"),y=`SELECT * ${w.transformedSql.substring(I)}`;d(y)}catch(w){console.error("Error on getTransformSqlWithFacetsRequest ",w)}})()},[p,t]);const i=je(()=>o.replace(/(["`])/g,"\\$1"),[o]),c=je(()=>o.replace(/"/g,'\\"'),[o]);return r(Qt,{show:!0,onClose:n,title:"Download Programmatically",cliNotes:r(A,{children:"This command line code will download Synapse files AND file annotations to your working directory."}),cliCode:`synapse get -q "${i}"`,rNotes:E(A,{children:["This R code will download file annotations only. Use"," ",E("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:["synGet","()"]})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),rCode:`query <- synTableQuery("${c}")
read.table(query$filepath, sep = ",")`,pythonNotes:E(A,{children:["This Python code will download file annotations only. Use"," ",r("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:"syn.get"})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),pythonCode:`query = syn.tableQuery("${c}")
query.asDataFrame()`})}try{se.displayName="ProgrammaticOptions",se.__docgenInfo={description:"",displayName:"ProgrammaticOptions",props:{queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!0,type:{name:"QueryBundleRequest"}},queryResultBundle:{defaultValue:null,description:"",name:"queryResultBundle",required:!0,type:{name:"QueryResultBundle"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/ProgrammaticTableDownload.tsx#ProgrammaticOptions"]={docgenInfo:se.__docgenInfo,name:"ProgrammaticOptions",path:"src/lib/containers/table/table-top/ProgrammaticTableDownload.tsx#ProgrammaticOptions"})}catch{}const oe=window.React,Un="Add To Download Cart",Wn="download",ie=p=>{const{accessToken:t}=J(),{entity:n,data:o,getLastQueryRequest:d}=K(),i=d(),[c,h]=oe.useState(!1),[C,f]=oe.useState(!1),[T,l]=oe.useState(!1),{onDownloadFiles:m,darkTheme:w=!0}=p,I=n&&(U(n)&&At(n)||Y(n)),y=n&&Y(n)&&n.isLatestVersion,R=`download-menu-tooltip-${n==null?void 0:n.id}`;return E(oe.Fragment,{children:[E(z,{as:"span",children:[r(Ce,{idForToolTip:Wn,tooltipText:"Download Options",size:"lg",darkTheme:w,icon:"download"}),E(z.Menu,{className:"SRC-primary-color-hover-dropdown",alignRight:!0,children:[r(tt,{delayShow:300,place:"left",type:"dark",effect:"solid",multiline:!0,id:R}),r(z.Item,{onClick:()=>{f(!0)},children:"Export Table"}),I&&r(z.Item,{className:y?"ignoreLink":void 0,"data-for":R,"data-tip":"A draft version of a dataset cannot<br />be added to the Download Cart","data-tip-disable":!y,disabled:y,style:y?{pointerEvents:"auto"}:{},onClick:()=>t?m():h(!0),children:Un}),r(z.Item,{className:y?"ignoreLink":void 0,"data-for":R,"data-tip":"A draft version of a dataset cannot<br />be downloaded programmatically","data-tip-disable":!y,disabled:y,style:y?{pointerEvents:"auto"}:{},onClick:()=>l(!0),children:"Programmatic Options"})]})]}),c&&r(re,{showModal:c,onHide:()=>h(!1)}),C&&r(G,{onClose:()=>f(!1),queryBundleRequest:i}),T&&o&&r(se,{onHide:()=>l(!1),queryBundleRequest:i,queryResultBundle:o})]})};try{ie.displayName="DownloadOptions",ie.__docgenInfo={description:"",displayName:"DownloadOptions",props:{onDownloadFiles:{defaultValue:null,description:"",name:"onDownloadFiles",required:!0,type:{name:"() => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/DownloadOptions.tsx#DownloadOptions"]={docgenInfo:ie.__docgenInfo,name:"DownloadOptions",path:"src/lib/containers/table/table-top/DownloadOptions.tsx#DownloadOptions"})}catch{}const Gn=window.React.useState,Yn="addAndRemoveColumns",le=p=>{const{headers:t,isColumnSelected:n,toggleColumnSelection:o,darkTheme:d,facetAliases:i}=p,[c,h]=Gn(!1),C=(f,T,l)=>{l.source==="rootClose"?h(!1):h(!0)};return E(z,{as:"span",onToggle:(f,T,l)=>C(f,T,l),show:c,drop:"down",children:[r(Ce,{idForToolTip:Yn,tooltipText:"Show/Hide Columns",icon:d?"columnsdark":"columns",darkTheme:d}),r(z.Menu,{className:"SRC-primary-color-hover-dropdown",alignRight:!0,children:t==null?void 0:t.map(f=>{const{name:T}=f,l=n.includes(T),m={width:"11px",marginRight:"10px",visibility:l?void 0:"hidden"},w=l?"SRC-primary-text-color":"";return E(z.Item,{onClick:()=>o(T),children:[r("span",{className:w,style:m,children:r($,{options:{icon:"check",size:"14px"}})}),$e(T,i)]},T)})})]})};try{le.displayName="ColumnSelection",le.__docgenInfo={description:"",displayName:"ColumnSelection",props:{headers:{defaultValue:null,description:"",name:"headers",required:!1,type:{name:"SelectColumn[]"}},isColumnSelected:{defaultValue:null,description:"",name:"isColumnSelected",required:!0,type:{name:"string[]"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(() => void)"}},toggleColumnSelection:{defaultValue:null,description:"",name:"toggleColumnSelection",required:!0,type:{name:"(name: string) => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}},facetAliases:{defaultValue:null,description:"",name:"facetAliases",required:!1,type:{name:"Record<string, string>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/ColumnSelection.tsx#ColumnSelection"]={docgenInfo:le.__docgenInfo,name:"ColumnSelection",path:"src/lib/containers/table/table-top/ColumnSelection.tsx#ColumnSelection"})}catch{}const Kn=[{icon:"search",key:"showSearchBar",tooltipText:"Show / Hide Search Bar"},{icon:"chart",key:"showFacetVisualization",tooltipText:"Show / Hide Visualizations"},{icon:"filter",key:"showFacetFilter",tooltipText:"Show / Hide Filters"},{icon:"download",key:"showDownloadConfirmation",tooltipText:"Show options for download"},{icon:It,key:"showSqlEditor",tooltipText:"Show / Hide the Advanced Query Editor"}],qe=p=>{const{name:t,showColumnSelection:n=!1,hideDownload:o=!1,hideVisualizationsControl:d=!1,hideFacetFilterControl:i=!1,hideQueryCount:c=!1,hideSqlEditorControl:h=!0,customControls:C}=p,{data:f,entity:T,getInitQueryRequest:l,executeQueryRequest:m,getLastQueryRequest:w}=K(),{topLevelControlsState:I,setTopLevelControlsState:y,columnsToShowInTable:R,selectedRowIndices:s,facetAliases:L,setColumnsToShowInTable:a}=ye(),e=v=>{const b={[v]:!I[v]};v==="showSearchBar"&&(b.showDownloadConfirmation=!1),v==="showDownloadConfirmation"&&(b.showSearchBar=!1),y(_=>({..._,...b}))},u=()=>{m(w())},g=v=>{let b=H(R);b.includes(v)?b=b.filter(_=>_!==v):b.push(v),a(b)},S=I==null?void 0:I.showFacetFilter;return r("div",{className:`TopLevelControls ${S?ge:Se}`,"data-testid":"TopLevelControls",children:E("h3",{children:[r("div",{className:"TopLevelControls__querycount",children:t&&E(A,{children:[E(be,{variant:"sectionTitle",role:"heading",children:[t," ",!c&&r(Vt,{sql:l().query.sql,parens:!0})]}),!c&&T&&r(ae,{entity:T})]})}),E("div",{className:"TopLevelControls__actions",children:[C&&C.map(v=>{var b;return E("button",{className:`btn SRC-roundBorder SRC-primary-background-color SRC-whiteText ${(b=v.classNames)!=null?b:""}`,style:{marginRight:"5px"},type:"button",onClick:()=>v.onClick({data:f,selectedRowIndices:s,refresh:u}),children:[v.icon,"\xA0",v.buttonText]},v.buttonText)}),Kn.map(v=>{const{key:b,icon:_,tooltipText:x}=v;return b==="showDownloadConfirmation"&&o||b==="showFacetVisualization"&&d||b==="showFacetFilter"&&i||b==="showSqlEditor"&&h?r(A,{}):b==="showDownloadConfirmation"?r(ie,{darkTheme:!0,onDownloadFiles:()=>e(b)},b):r(Ce,{idForToolTip:b,tooltipText:x,callbackFn:()=>e(b),darkTheme:!0,icon:_},b)}),n&&r(le,{headers:f==null?void 0:f.selectColumns,isColumnSelected:R,toggleColumnSelection:g,darkTheme:!0,facetAliases:L})]})]})})};try{qe.displayName="TopLevelControls",qe.__docgenInfo={description:"",displayName:"TopLevelControls",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},hideVisualizationsControl:{defaultValue:null,description:"",name:"hideVisualizationsControl",required:!1,type:{name:"boolean"}},hideFacetFilterControl:{defaultValue:null,description:"",name:"hideFacetFilterControl",required:!1,type:{name:"boolean"}},hideQueryCount:{defaultValue:null,description:"",name:"hideQueryCount",required:!1,type:{name:"boolean"}},hideSqlEditorControl:{defaultValue:null,description:"",name:"hideSqlEditorControl",required:!1,type:{name:"boolean"}},showColumnSelection:{defaultValue:null,description:"",name:"showColumnSelection",required:!1,type:{name:"boolean"}},customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/TopLevelControls.tsx#TopLevelControls"]={docgenInfo:qe.__docgenInfo,name:"TopLevelControls",path:"src/lib/containers/table/TopLevelControls.tsx#TopLevelControls"})}catch{}var rt={exports:{}};(function(p,t){(function(o,d){p.exports=d()})(Ht,function(){return(()=>{var n={67:(i,c,h)=>{h.r(c),h.d(c,{default:()=>I});var C=h(887),f=h.n(C);function T(y,R){if(!(y instanceof R))throw new TypeError("Cannot call a class as a function")}function l(y,R,s){return R in y?Object.defineProperty(y,R,{value:s,enumerable:!0,configurable:!0,writable:!0}):y[R]=s,y}var m,w=(m=0,function(){return m++}),I=function y(R){var s=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};T(this,y),l(this,"ID","id"),l(this,"PX","px"),l(this,"RESIZABLE","grip-resizable"),l(this,"FLEX","grip-flex"),l(this,"legacyIE",navigator.userAgent.indexOf("Trident/4.0")>0),l(this,"reset",function(a){return s.init(a)}),l(this,"onResize",function(){var a=s.tb;if(a.classList.remove(s.RESIZABLE),a.opt.fixed){a.tableWidth=Number(window.getComputedStyle(a).width.replace(/px/,"")).valueOf();for(var e=0,u=0;u<a.columnCnt;u++)e+=a.columns[u].w;for(var g=0;g<a.columnCnt;g++)a.columns[g].style.width=Math.round(1e3*a.columns[g].w/e)/10+"%",a.columns[g].locked=!0}else s.applyBounds(),a.opt.resizeMode==="flex"&&a.opt.serialize&&s.serializeStore();a.classList.add(s.RESIZABLE),s.syncGrips()}),l(this,"onGripMouseDown",function(a){var e=a.target.parentNode.data,u=s.tb,g=u.grips[e.i],S=a.touches;if(g.ox=S?S[0].pageX:a.pageX,g.l=g.offsetLeft,g.x=g.l,s.createStyle(document.querySelector("head"),"*{cursor:"+u.opt.dragCursor+"!important}"),document.addEventListener("touchmove",s.onGripDrag),document.addEventListener("mousemove",s.onGripDrag),document.addEventListener("touchend",s.onGripDragOver),document.addEventListener("mouseup",s.onGripDragOver),g.classList.add(u.opt.draggingClass),s.grip=g,u.columns[e.i].locked)for(var v,b=0;b<u.columnCnt;b++)(v=u.columns[b]).locked=!1,v.w=Number(window.getComputedStyle(v).width.replace(/px/,"")).valueOf();a.preventDefault()}),l(this,"onGripDrag",function(a){var e=s.grip;if(e){var u=e.t,g=a.touches,S=(g?g[0].pageX:a.pageX)-e.ox+e.l,v=u.opt.minWidth,b=e.i,_=1.5*u.cellSpace+v+u.borderSpace,x=b===u.columnCnt-1,F=b?u.grips[b-1].offsetLeft+u.cellSpace+v:_,O=u.opt.fixed?b===u.columnCnt-1?u.tableWidth-_:u.grips[b+1].offsetLeft-u.cellSpace-v:1/0;if(S=Math.max(F,Math.min(O,S)),e.x=S,e.style.left=S+s.PX,x&&(e.w=u.columns[b].w+S-e.l),u.opt.liveDrag){x?(u.columns[b].style.width=e.w+s.PX,!u.opt.fixed&&u.opt.overflow?u.style.minWidth=u.tableWidth+S-e.l+s.PX:u.tableWidth=Number(window.getComputedStyle(u).width.replace(/px/,"")).valueOf()):s.syncCols(u,b,!1,u.opt),s.syncGrips();var D=u.opt.onDrag;D&&D(a)}a.preventDefault()}}),l(this,"onGripDragOver",function(a){var e=s.grip;document.removeEventListener("touchend",s.onGripDragOver),document.removeEventListener("mouseup",s.onGripDragOver),document.removeEventListener("touchmove",s.onGripDrag),document.removeEventListener("mousemove",s.onGripDrag);var u=document.querySelector("head").lastChild;if(u.parentNode.removeChild(u),e){if(e.classList.remove(e.t.opt.draggingClass),e.x-e.l!=0){var g=e.t,S=g.opt.onResize,v=e.i;if(v===g.columnCnt-1){var b=g.columns[v];b.style.width=e.w+s.PX,b.w=e.w}else s.syncCols(g,v,!0,g.opt);g.opt.fixed||s.applyBounds(),s.syncGrips(),S&&S(a),g.opt.serialize&&s.serializeStore()}s.grip=null}}),l(this,"init",function(a){if(a.disable)return s.destroy();var e=s.tb,u=e.getAttribute(s.ID)||s.RESIZABLE+w();if(!e.matches("table")||e.extended&&!a.partialRefresh)return null;var g=document.querySelector("head");if(s.createStyle(g," .grip-resizable{table-layout:fixed;} .grip-resizable > tbody > tr > td, .grip-resizable > tbody > tr > th{overflow:hidden} .grip-padding > tbody > tr > td, .grip-padding > tbody > tr > th{padding-left:0!important; padding-right:0!important;} .grip-container{ height:0px; position:relative;} .grip-handle{margin-left:-5px; position:absolute; z-index:5; } .grip-handle .grip-resizable{position:absolute;background-color:red;filter:alpha(opacity=1);opacity:0;width:10px;height:100%;cursor: col-resize;top:0px} .grip-lastgrip{position:absolute; width:1px; } .grip-drag{ border-left:1px dotted black;	} .grip-flex{width:auto!important;} .grip-handle.grip-disabledgrip .grip-resizable{cursor:default; display:none;}"),a.hoverCursor&&a.hoverCursor!=="col-resize"){var S=".grip-handle .grip-resizable:hover{cursor:"+a.hoverCursor+"!important}";s.createStyle(g,S)}e.setAttribute(s.ID,u);var v=e.opt;e.opt=s.extendOptions(a);var b=s.getTableHeaders(e);if(s.extendTable(b),a.remoteTable&&a.remoteTable.matches("table")){var _=s.getTableHeaders(e.opt.remoteTable);b.length===_.length?s.extendRemoteTable(e.opt.remoteTable,_,e):console.warn("column count for remote table did not match")}return v}),l(this,"applyBounds",function(){var a=s.tb,e=a.columns.map(function(u){return window.getComputedStyle(u).width});a.style.width=window.getComputedStyle(a).width,a.tableWidth=Number(a.style.width.replace(/px/,"")).valueOf(),a.classList.remove(s.FLEX),a.columns.forEach(function(u,g){u.style.width=e[g],u.w=Number(e[g].replace(/px/,"")).valueOf()}),a.classList.add(s.FLEX)}),l(this,"serializeStore",function(){var a=s.store,e=s.tb;a[e.getAttribute(s.ID)]="";for(var u=0,g=0;g<e.columns.length;g++){var S=window.getComputedStyle(e.columns[g]).width.replace(/px/,"");a[e.getAttribute(s.ID)]+=S+";",u+=Number(S).valueOf()}a[e.getAttribute(s.ID)]+=u.toString(),e.opt.fixed||(a[e.getAttribute(s.ID)]+=";"+window.getComputedStyle(e).width.replace(/px/,""))}),l(this,"syncGrips",function(){var a=s.tb;a.gripContainer.style.width=a.tableWidth+s.PX;for(var e=0;e<a.columnCnt;e++){var u=a.columns[e],g=u.getBoundingClientRect(),S=a.getBoundingClientRect();a.grips[e].style.left=g.left-S.left+u.offsetWidth+a.cellSpace/2+s.PX,a.grips[e].style.height=(a.opt.headerOnly?a.columns[0].offsetHeight:a.offsetHeight)+s.PX}}),l(this,"destroy",function(){var a=s.tb,e=a.getAttribute(s.ID);return e?(s.store[e]="",a.classList.remove(s.RESIZABLE),a.classList.remove(s.FLEX),a.remote&&(a.remote.classList.remove(s.RESIZABLE),a.remote.classList.remove(s.FLEX)),a.gripContainer&&a.gripContainer.parentNode&&a.gripContainer.parentNode.removeChild(a.gripContainer),delete a.extended,a.opt):null}),l(this,"createStyle",function(a,e){var u=f()(e).toString(),g=a.querySelectorAll("style");if(!Array.from(g).filter(function(v){return v.gripid===u}).length){var S=document.createElement("style");S.type="text/css",S.gripid=u,S.styleSheet?S.styleSheet.cssText=e:S.appendChild(document.createTextNode(e)),a.appendChild(S)}}),l(this,"extendOptions",function(a){var e=Object.assign({},y.DEFAULTS,a);switch(e.fixed=!0,e.overflow=!1,e.resizeMode){case"flex":e.fixed=!1;break;case"overflow":e.fixed=!1,e.overflow=!0}return e}),l(this,"getTableHeaders",function(a){var e="#"+a.id,u=Array.from(a.querySelectorAll(e+">thead>tr:nth-of-type(1)>th"));return(u=u.concat(Array.from(a.querySelectorAll(e+">thead>tr:nth-of-type(1)>td")))).length||(u=(u=(u=(u=Array.from(a.querySelectorAll(e+">tbody>tr:nth-of-type(1)>th"))).concat(Array.from(a.querySelectorAll(e+">tr:nth-of-type(1)>th")))).concat(Array.from(a.querySelectorAll(e+">tbody>tr:nth-of-type(1)>td")))).concat(Array.from(a.querySelectorAll(e+">tr:nth-of-type(1)>td")))),s.filterInvisible(u,!1)}),l(this,"filterInvisible",function(a,e){return a.filter(function(u){var g=e?-1:u.offsetWidth,S=e?-1:u.offsetHeight;return!(g===0&&S===0||u.style&&u.style.display&&window.getComputedStyle(u).display==="none")})}),l(this,"extendTable",function(a){var e=s.tb;e.opt.removePadding&&e.classList.add("grip-padding"),e.classList.add(s.RESIZABLE),e.insertAdjacentHTML("beforebegin",'<div class="grip-container"/>'),e.grips=[],e.columns=[],e.tableWidth=Number(window.getComputedStyle(e).width.replace(/px/,"")).valueOf(),e.gripContainer=e.previousElementSibling,e.opt.marginLeft&&(e.gripContainer.style.marginLeft=e.opt.marginLeft),e.opt.marginRight&&(e.gripContainer.style.marginRight=e.opt.marginRight),e.cellSpace=parseInt(s.legacyIE?e.cellSpacing||e.currentStyle.borderSpacing:window.getComputedStyle(e).borderSpacing.split(" ")[0].replace(/px/,""))||2,e.borderSpace=parseInt(s.legacyIE?e.border||e.currentStyle.borderLeftWidth:window.getComputedStyle(e).borderLeftWidth.replace(/px/,""))||1,e.extended=!0,s.createGrips(a)}),l(this,"extendRemoteTable",function(a,e,u){u.opt.removePadding&&a.classList.add("grip-padding"),a.classList.add(s.RESIZABLE),a.getAttribute(s.ID)||a.setAttribute(s.ID,u.getAttribute(s.ID)+"remote"),a.columns=[],e.forEach(function(S,v){var b=e[v];b.w=u.columns[v].w,b.style.width=b.w+s.PX,b.removeAttribute("width"),a.columns.push(b)}),a.tableWidth=u.tableWidth,a.cellSpace=u.cellSpace,a.borderSpace=u.borderSpace;var g=Array.from(a.querySelectorAll("col"));a.columnGrp=s.filterInvisible(g,!0),a.columnGrp.forEach(function(S,v){S.removeAttribute("width"),S.style.width=u.columnGrp[v].style.width}),u.remote=a}),l(this,"createGrips",function(a){var e=s.tb;e.columnGrp=s.filterInvisible(Array.from(e.querySelectorAll("col")),!0),e.columnGrp.forEach(function(S){S.removeAttribute("width")}),e.columnCnt=a.length;var u=!1;s.store[e.getAttribute(s.ID)]&&(s.deserializeStore(a),u=!0),e.opt.widths||(e.opt.widths=[]),a.forEach(function(S,v){var b=a[v],_=e.opt.disabledColumns.indexOf(v)!==-1;s.createDiv(e.gripContainer,"grip-handle");var x=e.gripContainer.lastChild;!_&&e.opt.gripInnerHtml&&(x.innerHTML=e.opt.gripInnerHtml),s.createDiv(x,s.RESIZABLE),v===e.columnCnt-1&&(x.classList.add("grip-lastgrip"),e.opt.fixed&&(x.innerHTML="")),x.addEventListener("touchstart",s.onGripMouseDown,{capture:!0,passive:!0}),x.addEventListener("mousedown",s.onGripMouseDown,!0),_?x.classList.add("grip-disabledgrip"):(x.classList.remove("grip-disabledgrip"),x.addEventListener("touchstart",s.onGripMouseDown,{capture:!0,passive:!0}),x.addEventListener("mousedown",s.onGripMouseDown,!0)),x.t=e,x.i=v,e.opt.widths[v]?b.w=e.opt.widths[v]:b.w=u?Number(b.style.width.replace(/px/,"")).valueOf():Number(window.getComputedStyle(b).width.replace(/px/,"")).valueOf(),b.style.width=b.w+s.PX,b.removeAttribute("width"),x.data={i:v,t:e.getAttribute(s.ID),last:v===e.columnCnt-1},e.grips.push(x),e.columns.push(b)});var g=Array.from(e.querySelectorAll("td"));g.concat(Array.from(e.querySelectorAll("th"))),(g=(g=g.filter(function(S){for(var v=0;v<a.length;v++)if(a[v]===S)return!1;return!0})).filter(function(S){return!(S.querySelectorAll("table th").length||S.querySelectorAll("table td").length)})).forEach(function(S){S.removeAttribute("width")}),e.opt.fixed||(e.removeAttribute("width"),e.classList.add(s.FLEX)),s.syncGrips()}),l(this,"deserializeStore",function(a){var e=s.tb;if(e.columnGrp.forEach(function(v){v.removeAttribute("width")}),e.opt.flush)s.store[e.getAttribute(s.ID)]="";else{var u=s.store[e.getAttribute(s.ID)].split(";"),g=u[e.columnCnt+1];!e.opt.fixed&&g&&(e.style.width=g+s.PX,e.opt.overflow&&(e.style.minWidth=g+s.PX,e.tableWidth=Number(g).valueOf()));for(var S=0;S<e.columnCnt;S++)a[S].style.width=u[S]+s.PX,e.columnGrp[S]&&(e.columnGrp[S].style.width=100*Number(u[S]).valueOf()/Number(u[e.columnCnt]).valueOf()+"%")}}),l(this,"createDiv",function(a,e,u){var g=document.createElement("div");g.classList.add(e),u&&(g.innerHTML=u),a.appendChild(g)}),l(this,"syncCols",function(a,e,u,g){var S=a.remote,v=s.grip.x-s.grip.l,b=a.columns[e],_=a.columns[e+1];if(b&&_){var x=b.w+v,F=_.w-v,O=x+s.PX;if(b.style.width=O,a.columnGrp[e]&&a.columnGrp[e].style.width&&(a.columnGrp[e].style.width=O),S&&(S.columns[e].style.width=O,S.columnGrp[e]&&S.columnGrp[e].style.width&&(S.columnGrp[e].style.width=O)),g.fixed){var D=F+s.PX;_.style.width=D,a.columnGrp[e+1]&&a.columnGrp[e+1].style.width&&(a.columnGrp[e+1].style.width=D),S&&(S.columns[e+1].style.width=D,S.columnGrp[e+1]&&S.columnGrp[e+1].style.width&&(S.columnGrp[e+1].style.width=D))}else g.overflow&&(a.style.minWidth=a.tableWidth+v+s.PX);u&&(b.w=x,_.w=g.fixed?F:_.w,S&&(S.columns[e].w=x,S.columns[e+1].w=g.fixed?F:_.w))}});try{this.store=sessionStorage}catch{this.store={}}this.grip=null,this.tb=R,window.addEventListener("resize",this.onResize),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),this.init(L)};I.DEFAULTS={resizeMode:"fit",draggingClass:"grip-drag",gripInnerHtml:"",liveDrag:!1,minWidth:15,headerOnly:!1,hoverCursor:"col-resize",dragCursor:"col-resize",flush:!1,marginLeft:null,marginRight:null,remoteTable:null,disable:!1,partialRefresh:!1,disabledColumns:[],removePadding:!0,widths:[],serialize:!0,onDrag:null,onResize:null}},887:i=>{i.exports=function(h){for(var C=5381,f=h.length;f;)C=33*C^h.charCodeAt(--f);return C>>>0}}},o={};function d(i){if(o[i])return o[i].exports;var c=o[i]={exports:{}};return n[i](c,c.exports,d),c.exports}return d.n=i=>{var c=i&&i.__esModule?()=>i.default:()=>i;return d.d(c,{a:c}),c},d.d=(i,c)=>{for(var h in c)d.o(c,h)&&!d.o(i,h)&&Object.defineProperty(i,h,{enumerable:!0,get:c[h]})},d.o=(i,c)=>Object.prototype.hasOwnProperty.call(i,c),d.r=i=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},d(67)})()})})(rt);var jn=Ut(rt.exports);const de=p=>{const{entityId:t,entityVersionNumber:n}=p,{accessToken:o}=J(),d=$t();if(!o)return r(A,{});const i=async()=>{try{await Et(t,n,o),d.invalidateQueries(["downloadliststatsv2"]);const c=await _t(o,t,n?n==null?void 0:n.toString():void 0);Me(`${c.name} was successfully added to your Download Cart.`,"success")}catch(c){Me(`Unable to add the file to your Download Cart. ${c}`,"danger")}};return r(A,{children:E("a",{"data-testid":"AddToDownloadListV2","data-tip":"Add this file to your Download Cart","data-for":`${t}_${n}_download-list-v2-button`,onClick:i,className:"ignoreLink",children:[r(tt,{delayShow:300,place:"right",type:"dark",effect:"solid",id:`${t}_${n}_download-list-v2-button`}),r($,{options:{icon:"addToCart"}})]})})};try{de.displayName="AddToDownloadListV2",de.__docgenInfo={description:"",displayName:"AddToDownloadListV2",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},entityVersionNumber:{defaultValue:null,description:"",name:"entityVersionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AddToDownloadListV2.tsx#AddToDownloadListV2"]={docgenInfo:de.__docgenInfo,name:"AddToDownloadListV2",path:"src/lib/containers/AddToDownloadListV2.tsx#AddToDownloadListV2"})}catch{}const Xn=window.React.useEffect,Jn=window.React.useState,ce=p=>{const{accessToken:t}=J(),{entityIdList:n}=p,[o,d]=Jn([r(A,{})]),{ref:i,inView:c}=Be();let h=!0;Xn(()=>(c&&C(),()=>{h=!1}),[n,c]);const C=()=>{!n.length||xt(n,t).then(f=>{if(h){const T=f.results.map(l=>r("p",{children:r(Ne,{entity:l,displayTextField:"name"})},l.id));d(T)}}).catch(f=>{console.log("EntityIdList: Error getting entity headers",f)})};return r("span",{ref:i,children:o})};try{ce.displayName="EntityIdList",ce.__docgenInfo={description:"",displayName:"EntityIdList",props:{entityIdList:{defaultValue:null,description:"",name:"entityIdList",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/EntityIdList.tsx#EntityIdList"]={docgenInfo:ce.__docgenInfo,name:"EntityIdList",path:"src/lib/containers/EntityIdList.tsx#EntityIdList"})}catch{}const Zn=window.React.useEffect,eo=window.React.useState,ue=p=>{const{accessToken:t}=J(),{evaluationId:n}=p,[o,d]=eo(),{ref:i,inView:c}=Be();let h=!0;Zn(()=>(h&&c&&C(),()=>{h=!1}),[n,c]);const C=()=>{!n||Lt(n,t).then(f=>{d(f.name)}).catch(f=>{console.log("EvaluationIdListRenderer: Error getting evaluation queue names",f)})};return r("span",{ref:i,children:o})};try{ue.displayName="EvaluationIdRenderer",ue.__docgenInfo={description:"",displayName:"EvaluationIdRenderer",props:{evaluationId:{defaultValue:null,description:"",name:"evaluationId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/EvaluationIdRenderer.tsx#EvaluationIdRenderer"]={docgenInfo:ue.__docgenInfo,name:"EvaluationIdRenderer",path:"src/lib/containers/EvaluationIdRenderer.tsx#EvaluationIdRenderer"})}catch{}const to=window.React.useEffect,no=window.React.useState,pe=p=>{const{accessToken:t}=J(),{userIds:n}=p,[o,d]=no(),{ref:i,inView:c}=Be();let h=!0;to(()=>(h&&c&&C(),()=>{h=!1}),[n,c]);const C=()=>{!n.length||qt(n,t).then(f=>{const T=f.list.map(l=>r(Gt,{userProfile:l,className:"SRC-marginFifteen"},l.ownerId));d(T)}).catch(f=>{console.log("UserIdList: Error getting user profiles",f)})};return r("span",{ref:i,children:o})};try{pe.displayName="UserIdList",pe.__docgenInfo={description:"",displayName:"UserIdList",props:{userIds:{defaultValue:null,description:"",name:"userIds",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/UserIdList.tsx#UserIdList"]={docgenInfo:pe.__docgenInfo,name:"UserIdList",path:"src/lib/containers/UserIdList.tsx#UserIdList"})}catch{}const he=({columnType:p,columnValue:t,isBold:n,mapEntityIdToHeader:o,mapUserIdToHeader:d,columnLinkConfig:i,rowIndex:c,columnName:h,selectColumns:C,columnModels:f,rowData:T,rowId:l,rowVersionNumber:m})=>{const{entity:w}=K(),I=(y,R=20)=>!y||y.length<=R;if(!t)return E("p",{className:"SRC-center-text SRC-inactive",children:[" ",nn]});if(i)return r(tn,{value:t,columnName:h,selectColumns:C,columnModels:f,isHeader:!1,labelLink:i,rowData:T});if(w&&(U(w)||Y(w))&&(h==="id"||h==="name")&&l&&m){const y=`syn${l.toString()}`;if(Object.prototype.hasOwnProperty.call(o,y))return r("p",{children:r(Ne,{entity:o[y],versionNumber:m,className:`${n}`,showIcon:!1,displayTextField:h})})}switch(p){case q.ENTITYID:if(Object.prototype.hasOwnProperty.call(o,t))return r("p",{children:r(Ne,{entity:o[t],className:`${n}`,displayTextField:"name"})});break;case q.DATE_LIST:{const y=JSON.parse(t);return E("p",{children:[y.map((R,s)=>E("span",{className:n,children:[new Date(R).toLocaleString(),s!==y.length-1?", ":""]},s))," "]})}case q.BOOLEAN_LIST:{const y=JSON.parse(t);return r("p",{children:y.map((R,s)=>E("span",{className:n,children:[R?"true":"false",s!==y.length-1?", ":""]},s))})}case q.FILEHANDLEID:return r(A,{children:w&&r(ot,{associatedObjectId:w.id,associatedObjectType:Dt.TableEntity,fileHandleId:t,displayFileName:!0})});case q.ENTITYID_LIST:{const y=JSON.parse(t);return r(ce,{entityIdList:y})}case q.USERID_LIST:{const y=JSON.parse(t);return r(pe,{userIds:y})}case q.STRING_LIST:case q.INTEGER_LIST:{const y=JSON.parse(t);return r("p",{children:y.map((R,s)=>E("span",{className:n,children:[R,s!==y.length-1?", ":""]},R))})}case q.EVALUATIONID:return r(ue,{evaluationId:t});case q.DATE:return r("p",{className:n,children:new Date(Number(t)).toLocaleString()});case q.USERID:if(Object.prototype.hasOwnProperty.call(d,t)){const{ownerId:y,userName:R}=d[t];if(d[t].isIndividual===!1){const s=R===Qe?"public":"people";return R===Qe?E("span",{children:[r($,{options:{icon:s}})," All registered Synapse users"]}):E("a",{target:"_blank",rel:"noopener noreferrer",href:`${Oe.PORTAL}#!Team:${y}`,children:[r($,{options:{icon:s}})," ",R]})}else return r(Yt,{userProfile:d[t],preSignedURL:d[t].clientPreSignedURL,size:"SMALL USER CARD"})}break;case q.LINK:return r("a",{target:"_blank",rel:"noopener noreferrer",href:t,children:t});case q.STRING:case q.DOUBLE:case q.INTEGER:case q.BOOLEAN:case q.LARGETEXT:return I(t)?E("p",{className:n,children:[" ",t]}):r("div",{className:n,children:r(Ce,{tooltipText:t,callbackFn:on,idForToolTip:`${h}_${c}`,children:E("p",{className:n,children:[" ",t]})})});default:return console.warn(`ColumnType ${p} has unspecified handler. Rendering the column value.`),r("p",{className:n,children:t})}return r("p",{className:n,children:t})};try{he.displayName="SynapseTableCell",he.__docgenInfo={description:"",displayName:"SynapseTableCell",props:{columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'}]}},columnValue:{defaultValue:null,description:"",name:"columnValue",required:!0,type:{name:"string"}},isBold:{defaultValue:null,description:"",name:"isBold",required:!0,type:{name:"string"}},columnLinkConfig:{defaultValue:null,description:"",name:"columnLinkConfig",required:!1,type:{name:"CardLink | ColumnSpecifiedLink | MarkdownLink"}},mapEntityIdToHeader:{defaultValue:null,description:"",name:"mapEntityIdToHeader",required:!0,type:{name:"Record<string, EntityHeader>"}},mapUserIdToHeader:{defaultValue:null,description:"",name:"mapUserIdToHeader",required:!0,type:{name:"Partial<UserGroupHeader & UserProfile>"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!1,type:{name:"number"}},columnName:{defaultValue:null,description:"",name:"columnName",required:!0,type:{name:"string"}},selectColumns:{defaultValue:null,description:"",name:"selectColumns",required:!1,type:{name:"SelectColumn[]"}},columnModels:{defaultValue:null,description:"",name:"columnModels",required:!1,type:{name:"ColumnModel[]"}},rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"string[]"}},rowId:{defaultValue:null,description:"",name:"rowId",required:!1,type:{name:"number"}},rowVersionNumber:{defaultValue:null,description:"",name:"rowVersionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/synapse_table_functions/SynapseTableCell.tsx#SynapseTableCell"]={docgenInfo:he.__docgenInfo,name:"SynapseTableCell",path:"src/lib/containers/synapse_table_functions/SynapseTableCell.tsx#SynapseTableCell"})}catch{}const st=window.SQLParser.lexer,Xe=(p,...t)=>{var o;const n=[];return(o=p==null?void 0:p.selectColumns)==null||o.forEach((d,i)=>{t.includes(d.columnType)&&n.push(i)}),n},Je=(p,t,n)=>{const o=new Set;return p.queryResult.queryResults.rows.forEach(d=>{d.values.forEach((i,c)=>{n.includes(c)&&!Object.prototype.hasOwnProperty.call(t,i)&&i&&o.add(i)})}),o};function oo(p){const t=[];if(nt(p)){const n=st.tokenize(p),o=n.findIndex(c=>c[0]==="SELECT"),d=n.findIndex(c=>c[0]==="FROM");let i=0;for(let c=o+1;c<d-o-1;c+=1){const h=n[c];h[0]==="FUNCTION"&&h[1].toLowerCase()==="count"?t.push(i):h[0]==="SEPARATOR"&&(i+=1)}}return t}function ao(p,t,n){let o=st.tokenize(t);const d=o.findIndex(l=>l[0]==="SELECT"),i=o.findIndex(l=>l[0]==="FROM"),c=[];let h=0,C=!1;for(let l=d+1;l<i-d-1;l+=1){const m=o[l];m[0]==="FUNCTION"||m[1].toLocaleLowerCase()==="concat"?C=!0:m[0]==="LITERAL"&&!C?c.push({index:h,name:m[1]}):m[0]==="SEPARATOR"&&(h+=1,C=!1)}if(o=o.slice(0,o.findIndex(l=>l[0]==="GROUP")),o.splice(d+1,i-d-1,["STAR","*","1"]),n===void 0)return{synId:"",newSql:""};o.findIndex(l=>l[0]==="WHERE")===-1?o.push(["WHERE","WHERE","1"]):o.push(["CONDITIONAL","AND","1"]),c.forEach((l,m)=>{const w=p.values[l.index];w?o.push(["LITERAL",l.name,"1"],["OPERATOR","=","1"],["STRING",w,"1"],["CONDITIONAL","AND","1"]):o.push(["LITERAL",l.name,"1"],["OPERATOR","IS","1"],["BOOLEAN","null","1"],["CONDITIONAL","AND","1"])}),o.pop();const T=o[o.findIndex(l=>l[0]==="FROM")+1][1];return o.push(["EOF","","1"]),{synId:T,newSql:Xt(o)}}const ro=()=>{const{data:p,goToPage:t,pageSize:n,setPageSize:o,currentPage:d}=ht(),i=p==null?void 0:p.queryCount,c=(C,f)=>{t(f)},h=C=>{const f=C.target.value;o(f)};return E("div",{children:[r(En,{page:d,count:Math.ceil(i/n),color:"secondary",onChange:c,style:{display:"inline-block",float:"left"}}),r(be,{variant:"body1",style:{display:"inline-block"},children:`${i==null?void 0:i.toLocaleString()} total rows /`}),E("select",{name:"page size",onChange:h,style:{padding:"4px",marginLeft:"4px"},children:[r("option",{value:10,children:"10 per page"}),r("option",{selected:!0,value:25,children:"25 per page"}),r("option",{value:100,children:"100 per page"}),r("option",{value:500,children:"500 per page"})]})]})},Ze=window.React,so={id:"",name:"",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:-1,versionLabel:"",benefactorId:-1,createdBy:"",createdOn:"",modifiedBy:"",modifiedOn:""},io=["","DESC","ASC"],et={resizeMode:"overflow",partialRefresh:"true",liveDrag:!0,headerOnly:"true"};class De extends Ze.Component{constructor(t){super(t),this.tableElement=void 0,this.showGroupRowData=n=>{const o=this.props.queryContext.getLastQueryRequest().query,d=ao(n,o.sql,this.props.queryContext.data);o.sql=d.newSql;const i=JSON.stringify(o),c=btoa(i);return`${Oe.PORTAL}#!Synapse:${d.synId}/tables/query/${c}`},this.renderTable=(n,o,d,i)=>{var s,L;const c=(L=(s=this.props.queryContext).getLastQueryRequest)==null?void 0:L.call(s),{queryContext:{entity:h},showAccessColumn:C,showDownloadColumn:f,isRowSelectionVisible:T}=this.props,l=h&&(U(h)&&Ft(h)||Y(h)),m=C&&h&&this.isEntityViewOrDataset()&&this.allRowsHaveId(),w=!!this.props.synapseContext.accessToken,I=h&&l&&w&&this.allRowsHaveId(),y=!!(I&&!this.props.hideDownload),R=I&&f;return E("div",{className:"SynapseTable SRC-overflowAuto","data-testid":"SynapseTable",children:[E("table",{ref:a=>this.tableElement=a,className:"table table-striped table-condensed",children:[r("thead",{className:"SRC_bordered",children:r("tr",{children:this.createTableHeader(n,o,d,m,R,y,T,c)})}),r("tbody",{children:this.createTableRows(i,n,m,R,y,T)})]}),r("div",{className:"bootstrap-4-backport",style:{textAlign:"right"},children:r(ro,{})})]})},this.handleColumnSortPress=n=>o=>{let d=H(this.state.columnIconSortState);d.length===0&&(d=Array(this.getLengthOfPropsData()).fill(0));const i=H(this.state.sortedColumnSelection),c=this.findSelectionIndex(i,n.name);c!==-1&&i.splice(c,1),d[n.index]=(d[n.index]+1)%He.length,d[n.index]>0&&i.unshift({column:n.name,direction:io[d[n.index]]});const h=this.props.queryContext.getLastQueryRequest();h.query.sort=i,h.query.offset=0,this.props.queryContext.executeQueryRequest(h),this.setState({columnIconSortState:d,sortedColumnSelection:i})},this.toggleColumnSelection=n=>{const{queryVisualizationContext:{columnsToShowInTable:o,setColumnsToShowInTable:d}}=this.props;let i=H(o);i.includes(n)?i=i.filter(c=>c!==n):i.push(n),d(i)},this.applyChangesFromQueryFilter=n=>{const o=this.props.queryContext.getLastQueryRequest();o.query.selectedFacets=n,o.query.offset=0,this.props.queryContext.executeQueryRequest(o)},this.componentDidMount=this.componentDidMount.bind(this),this.componentWillUnmount=this.componentWillUnmount.bind(this),this.componentDidUpdate=this.componentDidUpdate.bind(this),this.shouldComponentUpdate=this.shouldComponentUpdate.bind(this),this.handleColumnSortPress=this.handleColumnSortPress.bind(this),this.findSelectionIndex=this.findSelectionIndex.bind(this),this.toggleColumnSelection=this.toggleColumnSelection.bind(this),this.advancedSearch=this.advancedSearch.bind(this),this.getLengthOfPropsData=this.getLengthOfPropsData.bind(this),this.configureFacetDropdown=this.configureFacetDropdown.bind(this),this.enableResize=this.enableResize.bind(this),this.disableResize=this.disableResize.bind(this),this.isEntityViewOrDataset=this.isEntityViewOrDataset.bind(this),this.allRowsHaveId=this.allRowsHaveId.bind(this),this.state={columnIconSortState:[],isExportTableDownloadOpen:!1,isExpanded:!1,isColumnSelectionOpen:!1,sortedColumnSelection:[],mapEntityIdToHeader:{},mapUserIdToHeader:{},isFetchingEntityHeaders:!1},this.getEntityHeadersInData=this.getEntityHeadersInData.bind(this)}componentWillUnmount(){this.disableResize()}componentDidMount(){this.getEntityHeadersInData(!0),this.enableResize()}shouldComponentUpdate(t,n){const{isFetchingEntityHeaders:o,...d}=this.state,{isFetchingEntityHeaders:i,...c}=n,h=!te(this.props,t),C=!te(d,c),f=h||C;return f&&this.disableResize(),f}componentDidUpdate(t,n){te(t.queryContext.data,this.props.queryContext.data)?t.queryContext.entity&&this.props.queryContext.entity&&!te(U(t.queryContext.entity),U(this.props.queryContext.entity))&&this.getEntityHeadersInData(!0):this.getEntityHeadersInData(!1),this.enableResize()}enableResize(){this.resizer?setTimeout(()=>{this.resizer.reset(et)},1e3):this.tableElement&&this.getLengthOfPropsData()>1&&(this.resizer=new jn(this.tableElement,et))}disableResize(){this.resizer&&this.resizer.reset({disable:!0})}async getEntityHeadersInData(t){const{data:n,entity:o}=this.props.queryContext;if(!n||!o)return;if(this.state.isFetchingEntityHeaders&&!t)return;const d=H(this.state.mapEntityIdToHeader),i=H(this.state.mapUserIdToHeader),c=Xe(n,q.ENTITYID),h=Xe(n,q.USERID),C=Je(n,d,c);if(this.isEntityViewOrDataset()&&this.allRowsHaveId()){const{queryResult:l}=n,{queryResults:m}=l,{rows:w}=m;w.forEach(I=>{const y=`syn${I.rowId}`;C.add(y)})}const f=Je(n,i,h);if(C.size===0&&f.size===0)return;if(this.setState({isFetchingEntityHeaders:!0}),C.size>0){const l=Array.from(C).map(m=>({targetId:m}));try{l.forEach(I=>{d[I.targetId]=so});const m=await Ot(l,this.props.synapseContext.accessToken),{results:w}=m;w.forEach(I=>{d[I.id]=I})}catch(m){console.error("Error on retrieving entity header list , ",m)}}const T=[];if(f.size>0){const l=Array.from(f);try{(await Nt(l,this.props.synapseContext.accessToken)).children.forEach(w=>{w.isIndividual?T.push(w.ownerId):i[w.ownerId]=w})}catch(m){console.error("Error on getGroupHeaders batch: ",m)}}if(T.length>0)try{(await Kt(T)).list.forEach(m=>{i[m.ownerId]=m})}catch(l){console.error("Error on getUserProfile : ",l)}this.setState({mapEntityIdToHeader:d,mapUserIdToHeader:i,isFetchingEntityHeaders:!1})}render(){if(!this.props.queryContext.data&&this.props.queryContext.isLoadingNewBundle)return Zt;if(!this.props.queryContext.data)return r(A,{});const{queryContext:{data:t},queryVisualizationContext:{topLevelControlsState:n,unitDescription:o},showNoContentAvailableWhenEmpty:d}=this.props,{queryResult:i,columnModels:c=[]}=t,{queryResults:h}=i,{rows:C}=h,{headers:f}=h,{facets:T=[]}=t,{isExpanded:l,isExportTableDownloadOpen:m}=this.state,w=this.props.queryContext.getLastQueryRequest(),{showFacetFilter:I}=n;let y="";if(!(t.queryResult.queryResults.rows.length>0)&&w.query.offset===0)return w.query.additionalFilters?r(rn,{}):d?r(sn,{}):E("div",{className:"text-center SRCBorderedPanel SRCBorderedPanel--padded2x",children:[Wt,r("div",{style:{marginTop:"20px",fontStyle:"italic"},children:"This table is currently empty"})]});const s=r("div",{children:this.renderTable(f,c,T,C)}),L=r(A,{children:E("div",{className:y,children:[m&&r(G,{onClose:()=>{this.setState({isExportTableDownloadOpen:!1})},queryBundleRequest:w}),!I&&o&&!nt(w.query.sql)&&r("div",{className:"SRC-centerContent text-left",style:{minHeight:"20px"},children:r(mt,{style:{fontSize:15},frontText:"Showing",applyChanges:a=>this.applyChangesFromQueryFilter(a)})}),r("div",{children:s})]})});return E(Ze.Fragment,{children:[l&&E(Q,{animation:!1,show:!0,onHide:()=>this.setState({isExpanded:!1}),dialogClassName:"modal-90w",backdrop:"static",children:[r(Q.Header,{onHide:()=>this.setState({isExpanded:!1}),closeButton:!0}),r(Q.Body,{children:L})]}),!l&&L]})}allRowsHaveId(){var n;const{queryContext:{data:t}}=this.props;return(n=t==null?void 0:t.queryResult.queryResults.rows.every(o=>!!o.rowId))!=null?n:!1}isEntityViewOrDataset(){var n;const{queryContext:{entity:t}}=this.props;return(n=t&&(U(t)||Y(t)))!=null?n:!1}createTableRows(t,n,o,d,i,c){const h=[],{queryContext:{data:C},queryVisualizationContext:{columnsToShowInTable:f,selectedRowIndices:T,setSelectedRowIndices:l},columnLinks:m=[],linkCountToDisaggregatedQuery:w=!1}=this.props,{selectColumns:I=[],columnModels:y=[]}=C,{mapEntityIdToHeader:R,mapUserIdToHeader:s}=this.state,L=oo(this.props.queryContext.getLastQueryRequest().query.sql);return t.forEach((a,e)=>{var _,x,F;const u=(_=a.versionNumber)==null?void 0:_.toString(),g=`syn${a.rowId}`,S=a.values.map((O,D)=>{const k=n[D].name,Z=f.includes(k),ee=m.find(V=>V.matchColumnName===k),we=this.findSelectionIndex(this.state.sortedColumnSelection,k),Te=L.includes(D)&&w,N=we===-1?"":"SRC-boldText";return Z?r("td",{className:"SRC_noBorderTop SRC-synapseTableTd",children:Te?r("a",{href:this.showGroupRowData(a),target:"_blank",rel:"noopener noreferrer",children:r("p",{className:N,children:O})}):r(he,{columnType:n[D].columnType,columnValue:O,isBold:N,mapEntityIdToHeader:R,mapUserIdToHeader:s,rowIndex:e,columnLinkConfig:ee,columnName:k,rowData:a.values,selectColumns:I,columnModels:y,rowId:a.rowId,rowVersionNumber:a.versionNumber})},`(${e}${O}${D})`):r("td",{className:"SRC-hidden"},`(${e},${D})`)});o&&S.unshift(r("td",{className:"SRC_noBorderTop",children:r(Jt,{entityId:g,entityVersionNumber:u},g)},g));const v=((x=R[g])==null?void 0:x.type)=="org.sagebionetworks.repo.model.FileEntity";d&&S.unshift(r("td",{className:"SRC_noBorderTop direct-download",children:v&&r(ot,{associatedObjectId:g,entityVersionNumber:u})},`direct-download-${g}`)),i&&S.unshift(r("td",{className:"SRC_noBorderTop add-to-download-list-v2",children:v&&r(de,{entityId:g,entityVersionNumber:parseInt(u)})},`add-to-download-list-v2-${g}`)),c&&T&&S.unshift(r("td",{className:"SRC_noBorderTop",children:r(an,{label:"",checked:T.includes(e),onChange:O=>{const D=[...T];if(O)D.push(e);else{const k=D.indexOf(e);k>-1&&D.splice(k,1)}l(D)}})},`(${e},rowSelectColumn)`));const b=r("tr",{children:S},(F=a.rowId)!=null?F:e);h.push(b)}),h}isSortableColumn(t){switch(t){case q.USERID:case q.ENTITYID:case q.FILEHANDLEID:return!1;default:return!0}}createTableHeader(t,n,o,d,i,c,h,C){const{sortedColumnSelection:f,columnIconSortState:T}=this.state,{queryVisualizationContext:{facetAliases:l={},columnsToShowInTable:m},queryContext:{lockedFacet:w}}=this.props,I=t.map((y,R)=>{var L;if(m.includes(y.name)){const a=this.findSelectionIndex(f,y.name)!==-1,e=T[R]===void 0?0:T[R],u=o.findIndex(D=>D.columnName===y.name),g=u!==-1&&o[u].facetType==="enumeration",S=o[u],v=a?"SRC-primary-background-color SRC-anchor-light":"",b=a?"SRC-selected-table-icon tool-icon":"SRC-primary-text-color tool-icon",_=`SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover  ${v}`,x=$e(y.name,l),F=n.find(D=>D.name===y.name),O=y.name.toLowerCase()===((L=w==null?void 0:w.facet)==null?void 0:L.toLowerCase());return r("th",{children:E("div",{className:"SRC-split",children:[r("span",{style:{whiteSpace:"nowrap"},children:x}),E("div",{className:"SRC-centerContent",children:[g&&!O&&this.configureFacetDropdown(S,F,C,l),this.isSortableColumn(y.columnType)&&r("span",{role:"button","aria-label":"sort",tabIndex:0,className:_,onKeyPress:this.handleColumnSortPress({index:R,name:y.name}),onClick:this.handleColumnSortPress({index:R,name:y.name}),children:r(en,{type:He[e],cssClass:b})})]})]})},y.name)}else return r("th",{className:"SRC-hidden"},y.name)});return d&&I.unshift(r("th",{children:r("div",{className:"SRC-centerContent",children:r("span",{style:{whiteSpace:"nowrap"},children:"Access"})})},"accessColumn")),i&&I.unshift(r("th",{children:r("div",{className:"SRC-centerContent",children:"\xA0"})},"downloadColumn")),c&&I.unshift(r("th",{"data-testid":"AddToDownloadListV2ColumnHeader",children:r("div",{className:"SRC-centerContent",children:"\xA0"})},"addToV2DownloadListColumn")),h&&I.unshift(r("th",{children:r("div",{className:"SRC-centerContent"})},"rowSelectionColumn")),I}findSelectionIndex(t,n){return t.length!==0?t.findIndex(o=>o.column===n):-1}advancedSearch(t){t&&t.preventDefault();const n=this.props.queryContext.getLastQueryRequest(),{query:o}=n,d=btoa(JSON.stringify(o)),i=n.entityId;window.open(`${Oe.PORTAL}#!Synapse:${i}/tables/query/${d}`,"_blank")}getLengthOfPropsData(){const{data:t}=this.props.queryContext;return t.queryResult.queryResults.headers.length}configureFacetDropdown(t,n,o,d){return r(ft,{containerAs:"Dropdown",facetValues:t.facetValues,columnModel:n,facetAliases:d,onChange:i=>{yt(o,t,this.applyChangesFromQueryFilter,i)},onClear:()=>{gt(o,t,this.applyChangesFromQueryFilter)}})}}try{De.displayName="SynapseTable",De.__docgenInfo={description:"",displayName:"SynapseTable",props:{synapseContext:{defaultValue:null,description:"",name:"synapseContext",required:!0,type:{name:"SynapseContextType"}},queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},showAccessColumn:{defaultValue:null,description:"",name:"showAccessColumn",required:!1,type:{name:"boolean"}},showDownloadColumn:{defaultValue:null,description:"",name:"showDownloadColumn",required:!1,type:{name:"boolean"}},columnLinks:{defaultValue:null,description:"",name:"columnLinks",required:!1,type:{name:"LabelLinkConfig"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},isRowSelectionVisible:{defaultValue:null,description:"",name:"isRowSelectionVisible",required:!1,type:{name:"boolean"}},linkCountToDisaggregatedQuery:{defaultValue:null,description:`If true, columns created by the COUNT function will render with a link to Synapse that opens the disaggregated query results filtered by the conditions of that row.
Note that this is very brittle and only supports one column at a time. See SWC-6075 for more information. Default false.`,name:"linkCountToDisaggregatedQuery",required:!1,type:{name:"boolean"}},showNoContentAvailableWhenEmpty:{defaultValue:null,description:"",name:"showNoContentAvailableWhenEmpty",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/SynapseTable.tsx#SynapseTable"]={docgenInfo:De.__docgenInfo,name:"SynapseTable",path:"src/lib/containers/table/SynapseTable.tsx#SynapseTable"})}catch{}function ra(){const{data:p}=K(),{showLastUpdatedOn:t}=ye();return t&&p&&p.lastUpdatedOn?r("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:E(be,{variant:"body2",children:["Last updated on ",pn(un(p.lastUpdatedOn))]})}):r(A,{})}export{Ee as F,ra as L,G as M,De as S,qe as T,xe as a,Le as b};
//# sourceMappingURL=LastUpdatedOn.e7fcd53d.js.map
