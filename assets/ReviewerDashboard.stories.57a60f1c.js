import{c as xe,R as we,a as Ue,b as Ee,i as ge,d as Fe,e as Ae,m as ke,u as le,f as de,M as je,S as Be,g as K,h as Ve}from"./react-router.2274575a.js";import{_ as Te}from"./withStyles.4f64abe1.js";import{a as ue,_ as W}from"./objectWithoutPropertiesLoose.d29fb19f.js";import{a as me,c as Ke,e as He,I as $e,J as De,K as Ge}from"./useUserBundle.1ce41d85.js";import{T as u}from"./Typography.e08e7569.js";import{I as pe}from"./IconSvg.d5022c82.js";import{S as ee}from"./LoadingScreen.85210ad1.js";import"./assert.ee5a549a.js";import{aR as Ye,L as Ne,aS as he,aT as qe,aU as ze,aV as Qe,K as We}from"./index.87d1c7b9.js";import{h as D}from"./moment.81704e1d.js";import{A as M}from"./AccessApproval.493867d3.js";import{D as w}from"./EntityChildren.50133102.js";import{U}from"./UserCard.7f39e657.js";import{P as _e}from"./getEndpoint.0de7fccf.js";import{u as Je}from"./useInfiniteQuery.884c146c.js";import{S as j}from"./Sort.0abe0a9a.js";import{f as _}from"./DateFormatter.329ada42.js";import{a as s,j as e,F as g}from"./jsx-runtime.2e925369.js";import{T as fe}from"./Table.8573b1c6.js";import{u as Se,o as ve,t as Xe}from"./toLower.ae48f9f7.js";import{B as P}from"./Button.77571428.js";import{S as Ce,u as Ze}from"./AccessSubmission.cfe54352.js";import{U as T}from"./UserOrTeamBadge.e57a07fa.js";import{U as J}from"./UserSearchBoxV2.dd811571.js";import{A as Pe}from"./AccessRequirementSearchBox.9ca8f514.js";import{c as N,b as ye}from"./FormLabel.a635baa2.js";import{E as er}from"./EntityTypeUtils.6e676053.js";import{E as rr}from"./EntityFinderModal.ba48c249.js";import{F as tr}from"./EntityFinder.8ed4cee7.js";import{a as ar,u as ir,b as sr,c as nr}from"./useGetAccessRequirement.95723c83.js";import{E as or}from"./EntityLink.3becc327.js";import{I as cr}from"./CalendarWithIconFormGroup.85a77604.js";import{S as X}from"./ManagedACTAccessRequirementStatus.be369a71.js";import{a as lr}from"./useEntity.a3aec278.js";import{M as dr}from"./MarkdownSynapse.079d4808.js";import{W as ur}from"./WarningModal.14601faa.js";import{F as mr}from"./FileHandleLink.fee54f7c.js";import{S as I}from"./Skeleton.bf1489f0.js";import"./index.06f4a415.js";import"./toConsumableArray.5f669646.js";import"./Alert.ad748791.js";import"./index.f252d424.js";import"./Fade.7bfbed49.js";import"./Transition.f54f11c8.js";import"./createWithBsPrefix.f7715523.js";import"./_Uint8Array.692793fe.js";import"./isObject.7e2c8eb3.js";import"./isArray.949e1480.js";import"./makeStyles.5f6bad01.js";import"./SvgIcon.1f1b3522.js";import"./utils.ebacc06c.js";import"./useTheme.735ed160.js";import"./createSvgIcon.53013205.js";import"./InfoOutlined.748401db.js";import"./Clear.53a62cf5.js";import"./Modal.739750b1.js";import"./useWaitForDOMRef.088a2ede.js";import"./useWillUnmount.4a16e5cd.js";import"./removeClass.27874bcb.js";import"./hasClass.56fd144a.js";import"./iframe.ca48114a.js";import"./index.8cde812d.js";import"./index.es.82d55a6a.js";import"./IconCopy.b1eba79c.js";import"./SkeletonTable.c89db73e.js";import"./times.0103cf28.js";import"./toInteger.9c26e41e.js";import"./toNumber.81238efb.js";import"./isSymbol.a6e5b306.js";import"./ToastMessage.574c0fe0.js";import"./FullWidthAlert.a054f15b.js";import"./debounce.6a99f8f3.js";import"./uniqueId.4eca3697.js";import"./Overlay.5ce67f19.js";import"./usePopperMarginModifiers.09a60569.js";import"./_baseSlice.50189bc5.js";import"./_baseMap.1baf3720.js";import"./_baseIsEqual.0aa7d9c9.js";import"./_cacheHas.e524ea96.js";import"./_setToArray.a82100c8.js";import"./_getTag.a9dbc6d6.js";import"./_Set.ec75fc93.js";import"./hasIn.87b4195e.js";import"./pick.41eb3858.js";import"./react-select.esm.4406e33b.js";import"./stateManager-845a3300.esm.4bc2dc68.js";import"./classCallCheck.8304ed06.js";import"./inherits.428c75c6.js";import"./useGetInfoFromIds.fd3ee364.js";import"./use-deep-compare-effect.esm.9d3fc03b.js";import"./uniq.c5e688cd.js";import"./without.541f6c3d.js";import"./TypeUtils.a2c41307.js";import"./EntityModal.a0d099d8.js";import"./useEntityBundle.39b10b3c.js";import"./queryKeys.e0d3085f.js";import"./SchemaDrivenAnnotationEditor.d1742129.js";import"./isEmpty.9a5eda9b.js";import"./useListState.7f5a3e64.js";import"./Collapse.b335a5d4.js";import"./groupBy.f6cb55ac.js";import"./ExternalFileHandleInterface.efb87ba3.js";import"./HelpPopover.b71f479f.js";import"./MarkdownPopover.9e272e6c.js";import"./react-sizeme.eec43ab8.js";import"./Arrow.c6e8b887.js";import"./sqlFunctions.b49ac766.js";import"./useGetEntityChildren.cfebf48c.js";import"./react-intersection-observer.m.66de6abb.js";import"./LockTwoTone.5189d348.js";import"./Checkbox.995e1545.js";import"./EntityIcon.d3c9039e.js";import"./cloneDeep.b49f3b67.js";import"./Dropdown.edf6576c.js";import"./isRequiredForA11y.61bbc671.js";import"./useFavorites.112f3b6b.js";import"./index.5ef2ed87.js";import"./factory.27692410.js";import"./SynapseVideo.c5a3cffb.js";const E=window.React;var pr=function(r){Te(i,r);function i(){for(var n,t=arguments.length,p=new Array(t),o=0;o<t;o++)p[o]=arguments[o];return n=r.call.apply(r,[this].concat(p))||this,n.history=xe(n.props),n}var a=i.prototype;return a.render=function(){return E.createElement(we,{history:this.history,children:this.props.children})},i}(E.Component);E.Component;var ne=function(i,a){return typeof i=="function"?i(a):i},oe=function(i,a){return typeof i=="string"?Fe(i,null,null,a):i},Re=function(i){return i},O=E.forwardRef;typeof O=="undefined"&&(O=Re);function hr(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}var fr=O(function(r,i){var a=r.innerRef,n=r.navigate,t=r.onClick,p=ue(r,["innerRef","navigate","onClick"]),o=p.target,c=W({},p,{onClick:function(h){try{t&&t(h)}catch(b){throw h.preventDefault(),b}!h.defaultPrevented&&h.button===0&&(!o||o==="_self")&&!hr(h)&&(h.preventDefault(),n())}});return Re!==O?c.ref=i||a:c.ref=a,E.createElement("a",c)}),Oe=O(function(r,i){var a=r.component,n=a===void 0?fr:a,t=r.replace,p=r.to,o=r.innerRef,c=ue(r,["component","replace","to","innerRef"]);return E.createElement(Ee.Consumer,null,function(m){m||ge(!1);var h=m.history,b=oe(ne(p,m.location),m.location),C=b?h.createHref(b):"",f=W({},c,{href:C,navigate:function(){var l=ne(p,m.location),A=Ae(m.location)===Ae(oe(l)),d=t||A?h.replace:h.push;d(l)}});return Re!==O?f.ref=i||o:f.innerRef=o,E.createElement(n,f)})}),Le=function(i){return i},Z=E.forwardRef;typeof Z=="undefined"&&(Z=Le);function Sr(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return i.filter(function(n){return n}).join(" ")}var vr=Z(function(r,i){var a=r["aria-current"],n=a===void 0?"page":a,t=r.activeClassName,p=t===void 0?"active":t,o=r.activeStyle,c=r.className,m=r.exact,h=r.isActive,b=r.location,C=r.sensitive,f=r.strict,R=r.style,l=r.to,A=r.innerRef,d=ue(r,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return E.createElement(Ee.Consumer,null,function(v){v||ge(!1);var S=b||v.location,y=oe(ne(l,S),S),q=y.pathname,B=q&&q.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),L=B?ke(S.pathname,{path:B,exact:m,sensitive:C,strict:f}):null,V=!!(h?h(L,S):L),re=typeof c=="function"?c(V):c,te=typeof R=="function"?R(V):R;V&&(re=Sr(re,p),te=W({},te,o));var ae=W({"aria-current":V&&n||null,className:re,style:te,to:y},d);return Le!==Z?ae.ref=i||A:ae.innerRef=A,E.createElement(Oe,ae)})});const Rr=window.React.useEffect,be=(r,i,a)=>{Rr(()=>{const n=setTimeout(()=>r(),a);return()=>clearTimeout(n)},[...i||[],a])};function br(r,i){const{accessToken:a}=me();return Je(["accessApprovalSearch",r],async n=>await Ye({...r,nextPageToken:n.pageParam},a),{...i,getNextPageParam:n=>n.nextPageToken})}const Ar=window.React.useMemo,Cr=window.React.useState,G=({accessorId:r,accessRequirementId:i})=>{var C;const[a,n]=Cr({field:M.MODIFIED_ON,direction:w.DESC}),t=Ar(()=>({accessorId:r,accessRequirementId:i,sort:[a]}),[r,i,a]),{data:p,hasNextPage:o,fetchNextPage:c,isLoading:m}=br(t),h=(C=p==null?void 0:p.pages.flatMap(f=>f.results))!=null?C:[],b=f=>{a.field===f?n({field:f,direction:a.direction===w.DESC?w.ASC:w.DESC}):n({field:f,direction:w.DESC})};return s("div",{className:"AccessApprovalsTable bootstrap-4-backport",children:[s(fe,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{children:s("tr",{children:[e("th",{children:"AR ID"}),e("th",{children:"Access Requirement Name"}),e("th",{children:"Submitter"}),e("th",{children:"Status"}),e("th",{children:s("span",{className:"SRC-split",children:[e("span",{children:"Modified Date"}),e(j,{role:"button",active:a.field===M.MODIFIED_ON,direction:a.field==="MODIFIED_ON"?a.direction==="DESC"?w.DESC:w.ASC:w.DESC,onClick:()=>b(M.MODIFIED_ON)})]})}),e("th",{children:s("span",{className:"SRC-split",children:[e("span",{children:"Expires"}),e(j,{role:"button",active:a.field===M.EXPIRED_ON,direction:a.field==="EXPIRED_ON"?a.direction==="DESC"?w.DESC:w.ASC:w.DESC,onClick:()=>b(M.EXPIRED_ON)})]})})]})}),e("tbody",{children:h.map(f=>s("tr",{children:[e("td",{children:e("a",{href:`${_e.PORTAL}#!AccessRequirement:AR_ID=${f.accessRequirementId}`,children:f.accessRequirementId})}),e("td",{children:f.accessRequirementName}),e("td",{children:e(U,{size:Ne,ownerId:f.submitterId})}),e("td",{children:Se(f.state.toLocaleLowerCase())}),e("td",{children:_(D(f.modifiedOn))}),e("td",{className:`${f.expiredOn?new Date>new Date(f.expiredOn)?"expired":"":"non-expire"} remove-border`,children:f.expiredOn?_(D(f.expiredOn)):"Never"})]},f.id))})]}),m&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!m&&h.length===0&&e(u,{className:"SRC-center-text",variant:"body1",children:"No Results"}),o?e(P,{variant:"outline",onClick:()=>c,children:"Show More"}):""]})};try{G.displayName="AccessApprovalsTable",G.__docgenInfo={description:"",displayName:"AccessApprovalsTable",props:{accessorId:{defaultValue:null,description:"",name:"accessorId",required:!0,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AccessApprovalsTable.tsx#AccessApprovalsTable"]={docgenInfo:G.__docgenInfo,name:"AccessApprovalsTable",path:"src/lib/containers/AccessApprovalsTable.tsx#AccessApprovalsTable"})}catch{}const yr=window.React.useMemo,Ir=window.React.useState,F=({showSubmitter:r,showStatus:i,showRequesters:a,accessorId:n,accessRequirementId:t,reviewerId:p,submissionState:o,reviewerFilterType:c})=>{var v;const[m,h]=Ir({field:Ce.CREATED_ON,direction:w.DESC}),b=yr(()=>({accessorId:n,accessRequirementId:t,submissionState:o,reviewerId:p,reviewerFilterType:c,sort:[m]}),[n,t,o,p,c,m]),{data:C,hasNextPage:f,fetchNextPage:R,isLoading:l}=Ze(b),A=(v=C==null?void 0:C.pages.flatMap(S=>S.results))!=null?v:[],d=S=>{m.field===S?h({field:S,direction:m.direction==="DESC"?"ASC":"DESC"}):h({field:S,direction:"DESC"})};return s("div",{className:"bootstrap-4-backport AccessSubmissionTable",children:[s(fe,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{children:s("tr",{children:[e("th",{children:"REQUEST"}),e("th",{children:"Access Requirement Name"}),r&&e("th",{children:"Submitter"}),i&&e("th",{children:"Status"}),a&&e("th",{children:"Requesters"}),e("th",{children:"Reviewer(s)"}),s("th",{children:["Created Date",e(j,{role:"button",style:{float:"right"},active:m.field==="CREATED_ON","aria-label":"Sort by Created On",direction:m.field==="CREATED_ON"?m.direction==="DESC"?"DESC":"ASC":"DESC",onClick:()=>d(Ce.CREATED_ON)})]})]})}),e("tbody",{children:A.map(S=>s("tr",{children:[e("td",{children:e(Oe,{to:`/Submissions/${S.id}`,children:S.id})}),e("td",{children:S.accessRequirementName}),r&&e("td",{children:e(T,{principalId:S.submitterId})}),i&&e("td",{children:Se(S.state.toLocaleLowerCase())}),a&&s("td",{children:[e(T,{principalId:S.submitterId}),S.accessorChanges.filter(y=>S.submitterId!==y.userId).map(y=>e("li",{children:e(U,{size:Ne,ownerId:y.userId,className:"requester"})},y.userId))]}),e("td",{children:S.accessRequirementReviewerIds.length===0?e(T,{principalId:he}):S.accessRequirementReviewerIds.map(y=>e(T,{principalId:y},y))}),e("td",{children:_(D(S.createdOn))})]},S.id))})]}),l&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!l&&A.length==0&&e(u,{className:"SRC-center-text",variant:"body1",children:"No Results"}),f?e(P,{variant:"outline",onClick:()=>R(),children:"Show More"}):""]})};try{F.displayName="AccessRequestSubmissionTable",F.__docgenInfo={description:"",displayName:"AccessRequestSubmissionTable",props:{showSubmitter:{defaultValue:null,description:"",name:"showSubmitter",required:!1,type:{name:"boolean"}},showStatus:{defaultValue:null,description:"",name:"showStatus",required:!1,type:{name:"boolean"}},showRequesters:{defaultValue:null,description:"",name:"showRequesters",required:!1,type:{name:"boolean"}},accessorId:{defaultValue:null,description:"",name:"accessorId",required:!1,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!1,type:{name:"string"}},reviewerId:{defaultValue:null,description:"",name:"reviewerId",required:!1,type:{name:"string"}},submissionState:{defaultValue:null,description:"",name:"submissionState",required:!1,type:{name:"enum",value:[{value:'"SUBMITTED"'},{value:'"APPROVED"'},{value:'"REJECTED"'},{value:'"CANCELLED"'}]}},reviewerFilterType:{defaultValue:null,description:"",name:"reviewerFilterType",required:!1,type:{name:"enum",value:[{value:'"ALL"'},{value:'"ACT_ONLY"'},{value:'"DELEGATED_ONLY"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AccessRequestSubmissionTable.tsx#AccessRequestSubmissionTable"]={docgenInfo:F.__docgenInfo,name:"AccessRequestSubmissionTable",path:"src/lib/containers/AccessRequestSubmissionTable.tsx#AccessRequestSubmissionTable"})}catch{}const wr=window.React.useCallback,Er=window.React.useEffect,H=window.React.useState,gr=()=>{const[r,i]=H(),[a,n]=H(""),[t,p]=H({accessorId:a,accessRequirementId:r}),[o,c]=H({showStatus:!0,showSubmitter:!0,accessorId:a,accessRequirementId:r}),m=le(),h=de(),b=500,C=wr(R=>{n(R||"")},[]);Er(()=>{(()=>{var A,d;const l=new URLSearchParams(m.search);i((A=l.get("accessRequirementId"))!=null?A:void 0),n((d=l.get("accessorId"))!=null?d:"")})()},[m.search]),be(()=>{((l,A)=>{const d=new URLSearchParams(ve({accessRequirementId:l,accessorId:A},v=>v===void 0||v===""));h.replace({pathname:m.pathname,search:d.toString()})})(r,a),p({accessorId:a,accessRequirementId:r}),c({showStatus:!0,showSubmitter:!0,accessorId:a,accessRequirementId:r})},[r,a,h,m],b);const f=()=>s("div",{className:"text-center",children:[e("img",{className:"SearchPlaceholderImage",alt:"Begin searching",src:"https://s3.amazonaws.com/static.synapse.org/images/search-happy.svg"}),e(u,{variant:"body2",children:"Enter a user or team name in the search field above to view their data access history"})]});return s("div",{className:"UserHistoryDashboard bootstrap-4-backport",children:[s("div",{className:"InputPanel SubmissionGrid",children:[s("div",{children:[e(N,{htmlFor:"user-filter",children:"Select a user to view their access history"}),e(J,{inputId:"user-filter",onChange:C,defaultValue:a,placeholder:"Search for a user name",typeFilter:qe.USERS_ONLY})]}),a&&s("div",{children:[e(N,{htmlFor:"arName-filter",children:"Filter by Access Requirement Name"}),e(Pe,{inputId:"arName-filter",placeholder:"Search for an Access Requirement Name ",onChange:i})]})]}),a?s(g,{children:[s(u,{variant:"headline3",children:["Submissions including ",e(T,{principalId:a})]}),e(F,{...o}),e(u,{variant:"headline3",children:"Status in Access Requirements"}),e(G,{...t})]}):e(f,{})]})},Tr=window.React,Dr=window.React.useMemo,Nr=window.React.useState;function Y(r){var A;const{nameContains:i,relatedProjectId:a,reviewerId:n,accessType:t,onCreateNewAccessRequirementClicked:p}=r,[o,c]=Nr({field:"CREATED_ON",direction:"DESC"}),m=Dr(()=>({nameContains:i,relatedProjectId:a,reviewerId:n,accessType:t,sort:[o]}),[i,a,n,t,o]),{data:h,hasNextPage:b,fetchNextPage:C,isLoading:f}=ar(m),R=(A=h==null?void 0:h.pages.flatMap(d=>d.results))!=null?A:[],l=d=>{o.field===d?c({field:d,direction:o.direction==="DESC"?"ASC":"DESC"}):c({field:d,direction:"DESC"})};return s("div",{className:"bootstrap-4-backport",children:[s("div",{className:"SRC-split",children:[e(u,{variant:"headline3",style:{marginBottom:0},children:"Access Requirements"}),p&&s(P,{variant:"outline",onClick:p,children:[e(pe,{options:{icon:"favTwoTone",padding:"right"}}),"New Access Requirement"]})]}),s("div",{className:"AccessRequirementsTable",children:[s(fe,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{className:"access-requirements-header",children:s("tr",{children:[e("th",{children:"AR ID"}),e("th",{children:s("span",{className:"SRC-split",children:[e("span",{children:"Access Requirement Name"}),e(j,{role:"button",onClick:()=>l("NAME"),"aria-label":"Sort by Name",active:o.field==="NAME",direction:o.field==="NAME"?o.direction:"DESC"})]})}),e("th",{children:"Related to Projects"}),e("th",{children:"Reviewer"}),e("th",{children:"Last Modified"}),e("th",{children:s("span",{className:"SRC-split",children:[e("span",{children:"Created On"}),e(j,{role:"button",onClick:()=>l("CREATED_ON"),active:o.field==="CREATED_ON","aria-label":"Sort by Created On",direction:o.field==="CREATED_ON"?o.direction:"DESC"})]})})]})}),e("tbody",{children:R.map(d=>s("tr",{children:[e("td",{children:e("a",{href:`${_e.PORTAL}#!AccessRequirement:AR_ID=${d.id}`,children:d.id})}),e("td",{children:d.name}),e("td",{children:d.relatedProjectIds.map(v=>s(Tr.Fragment,{children:[e(or,{entity:v})," ",s("span",{className:"InlineLabel",children:["(",v,")"]}),e("br",{})]},v))}),e("td",{children:d.reviewerIds.length===0?e(T,{principalId:he}):d.reviewerIds.map(v=>e(T,{principalId:v},v))}),e("td",{children:_(D(d.modifiedOn))}),e("td",{children:_(D(d.createdOn))})]},d.id))})]}),f&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!f&&R.length===0&&e(u,{className:"SRC-center-text",variant:"body1",children:"No Results"}),b?e(P,{variant:"outline",onClick:()=>{C()},children:"Show More"}):e(g,{})]})]})}try{Y.displayName="AccessRequirementTable",Y.__docgenInfo={description:"",displayName:"AccessRequirementTable",props:{nameContains:{defaultValue:null,description:"",name:"nameContains",required:!1,type:{name:"string"}},relatedProjectId:{defaultValue:null,description:"",name:"relatedProjectId",required:!1,type:{name:"string"}},reviewerId:{defaultValue:null,description:"",name:"reviewerId",required:!1,type:{name:"string"}},accessType:{defaultValue:null,description:"",name:"accessType",required:!1,type:{name:"enum",value:[{value:'"CREATE"'},{value:'"READ"'},{value:'"UPDATE"'},{value:'"DELETE"'},{value:'"CHANGE_PERMISSIONS"'},{value:'"DOWNLOAD"'},{value:'"UPLOAD"'},{value:'"PARTICIPATE"'},{value:'"SUBMIT"'},{value:'"READ_PRIVATE_SUBMISSION"'},{value:'"UPDATE_SUBMISSION"'},{value:'"DELETE_SUBMISSION"'},{value:'"TEAM_MEMBERSHIP_UPDATE"'},{value:'"SEND_MESSAGE"'},{value:'"CHANGE_SETTINGS"'},{value:'"MODERATE"'},{value:'"REVIEW_SUBMISSIONS"'}]}},onCreateNewAccessRequirementClicked:{defaultValue:null,description:"",name:"onCreateNewAccessRequirementClicked",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/AccessRequirementTable.tsx#AccessRequirementTable"]={docgenInfo:Y.__docgenInfo,name:"AccessRequirementTable",path:"src/lib/containers/dataaccess/AccessRequirementTable.tsx#AccessRequirementTable"})}catch{}const qr=window.React.useCallback,_r=window.React.useEffect,x=window.React.useState;function z(r){const{onCreateNewAccessRequirementClicked:a}=r,n=le(),t=de(),[p,o]=x(""),[c,m]=x(void 0),[h,b]=x(void 0);_r(()=>{function d(){var S,y,q;const v=new URLSearchParams(n.search);o((S=v.get("nameContains"))!=null?S:""),m((y=v.get("relatedProjectId"))!=null?y:void 0),b((q=v.get("reviewerId"))!=null?q:void 0)}d()},[n.search]);const[C,f]=x(!1),[R,l]=x({nameContains:p,relatedProjectId:c,reviewerId:h,onCreateNewAccessRequirementClicked:a});be(()=>{function d(v,S,y){const q=ve({nameContains:v,relatedProjectId:S,reviewerId:y},L=>L===void 0||L===""),B=new URLSearchParams(q);t.replace({pathname:n.pathname,search:B.toString()})}l({nameContains:p,relatedProjectId:c,reviewerId:h,onCreateNewAccessRequirementClicked:a}),d(p,c,h)},[p,c,h,a,t,n],500);const A=qr(d=>{b(d||void 0)},[]);return s("div",{className:"AccessRequirementDashboard bootstrap-4-backport",children:[e(rr,{configuration:{initialScope:tr.ALL_PROJECTS,initialContainer:null,selectMultiple:!1,selectableTypes:[er.PROJECT]},show:C,onClose:()=>{f(!1)},onCancel:()=>{f(!1)},title:"Select Project to Filter Access Requirements",promptCopy:"Select a project to find Access Requirements that are associated with that project. Access Requirements will be found if the Access Requirement is applied to the project, or if it is applied to any item inside the project.",onConfirm:d=>{m(d[0].targetId),f(!1)},confirmButtonCopy:"Select"}),s("div",{className:"InputPanel",children:[s("div",{children:[e(N,{htmlFor:"ar-name-filter",children:"Filter by Access Requirement Name"}),s(cr,{children:[e(ye,{id:"ar-name-filter",type:"text",placeholder:"Search for an Access Requirement Name",value:p,onChange:d=>{o(d.target.value)}}),e(pe,{options:{icon:"searchOutlined"}})]})]}),s("div",{children:[e(N,{htmlFor:"project-id-filter",children:"Filter by Project"}),s("div",{className:"ProjectIdInputGroup",children:[e(ye,{id:"project-id-filter",type:"text",placeholder:"Enter a project SynID",value:c,onChange:d=>{const v=d.target.value;m(v===""?void 0:v)}}),e(P,{variant:"outline",onClick:()=>{f(!0)},children:"Browse"})]})]}),s("div",{children:[e(N,{htmlFor:"reviewer-filter",children:"Filter by Reviewer"}),e(J,{inputId:"reviewer-filter",placeholder:"Search for a username or team name",defaultValue:h,onChange:A})]})]}),e(Y,{...R})]})}try{z.displayName="AccessRequirementDashboard",z.__docgenInfo={description:"",displayName:"AccessRequirementDashboard",props:{onCreateNewAccessRequirementClicked:{defaultValue:null,description:"",name:"onCreateNewAccessRequirementClicked",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/AccessRequirementDashboard.tsx#AccessRequirementDashboard"]={docgenInfo:z.__docgenInfo,name:"AccessRequirementDashboard",path:"src/lib/containers/dataaccess/AccessRequirementDashboard.tsx#AccessRequirementDashboard"})}catch{}const Ie=window.React.useCallback,Pr=window.React.useEffect,$=window.React.useState,Or=()=>{const[r,i]=$(),[a,n]=$(),[t,p]=$(),[o,c]=$({accessRequirementId:r,accessorId:a,reviewerId:t,showRequesters:!0,submissionState:X.SUBMITTED}),m=le(),h=de(),b=500;Pr(()=>{(()=>{var A,d,v;const l=new URLSearchParams(m.search);i((A=l.get("accessRequirementId"))!=null?A:void 0),n((d=l.get("accessorId"))!=null?d:void 0),p((v=l.get("reviewerId"))!=null?v:void 0)})()},[m.search]);const C=Ie(R=>{n(R||void 0)},[]),f=Ie(R=>{p(R||void 0)},[]);return be(()=>{((l,A,d)=>{const v=new URLSearchParams(ve({accessRequirementId:l,accessorId:A,reviewerId:d},S=>S===void 0||S===""));h.replace({pathname:m.pathname,search:v.toString()})})(r,a,t),c({accessRequirementId:r,accessorId:a,reviewerId:t,showRequesters:!0,submissionState:X.SUBMITTED})},[r,a,t,h,m],b),s("div",{className:"AccessSubmissionDashboard bootstrap-4-backport",children:[s("div",{className:"InputPanel SubmissionGrid",children:[s("div",{children:[e(N,{htmlFor:"arId-filter",children:"Filter by Access Requirement Name"}),e(Pe,{inputId:"arId-filter",onChange:i,placeholder:"Search for an Access Requirement Name "})]}),s("div",{children:[e(N,{htmlFor:"requester-filter",children:"Filter by Requester"}),e(J,{inputId:"requester-filter",placeholder:"Search for a user name",defaultValue:a,onChange:C,typeFilter:qe.USERS_ONLY})]}),s("div",{children:[e(N,{htmlFor:"reviewer-filter",children:"Filter by Reviewer"}),e(J,{inputId:"reviewer-filter",placeholder:"Search for a user or team name",defaultValue:t,onChange:f})]})]}),e(u,{variant:"headline3",children:"Access Request Submissions"}),e(F,{...o})]})},ce={submission:r=>["dataAccessSubmission",r],search:r=>r?["accessSubmissionSearch",r]:["accessSubmissionSearch"]};function Lr(r,i){const{accessToken:a}=me();return Ke(ce.submission(r),()=>ze(r,a),i)}function Mr(r){const i=He(),{accessToken:a}=me();return lr(n=>Qe(n,a),{...r,onSuccess:async(n,t,p)=>{i.invalidateQueries(ce.search()),i.setQueryData(ce.submission(t.submissionId),n),r!=null&&r.onSuccess&&await r.onSuccess(n,t,p)}})}const Me=window.React,xr=window.React.useState;function ie(r){const{submissionId:i,fileHandleId:a}=r,n=Me.useMemo(()=>({fileHandleId:a,associateObjectId:i,associateObjectType:We.DataAccessSubmissionAttachment}),[a,i]);return e(mr,{showDownloadIcon:!0,fileHandleAssociation:n},a)}function Ur(r){return e(ur,{show:r.show,title:"Approve Request?",modalBody:s(g,{children:[e(u,{variant:"body1",children:"Approving the request will grant access to controlled data."}),e(u,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."})]}),onConfirm:r.onConfirm,onConfirmCallbackArgs:[],onCancel:r.onCancel,confirmButtonText:"Approve"})}function Fr(r){const{data:i}=nr(r.accessRequirementId,{useErrorBoundary:!0});return i?e("div",{className:"AccessRequirementWikiContainer",children:s("div",{className:"AccessRequirementWikiContent",children:[e(u,{variant:"headline1",children:"Access Requirement"}),e("hr",{}),e(dr,{wikiId:i==null?void 0:i.wikiPageId,ownerId:i==null?void 0:i.ownerObjectId,objectType:i==null?void 0:i.ownerObjectType})]})}):e(I,{width:"100%",height:"600px"})}function Q(r){var R;const{submissionId:i,onRejectClicked:a}=r,n=$e(),{data:t,refetch:p}=Lr(i,{useErrorBoundary:!0}),{mutateAsync:o}=Mr(),{data:c}=ir(parseInt(t==null?void 0:t.accessRequirementId),{enabled:!!t}),{data:m}=sr(t==null?void 0:t.accessRequirementId,{enabled:!!t,useErrorBoundary:!0}),[h,b]=xr(!1);function C(){var l;return o({submissionId:(l=t==null?void 0:t.id)!=null?l:"",newState:X.APPROVED})}function f(l){var A;return o({submissionId:(A=t==null?void 0:t.id)!=null?A:"",newState:X.REJECTED,rejectedReason:l})}return s("div",{className:"SubmissionPage",children:[e(Ur,{show:h,onCancel:()=>{b(!1)},onConfirm:async()=>{try{await C()}catch(l){n(l)}b(!1),p()}}),s("div",{className:"SubmissionSummary",children:[e(u,{variant:"dataFieldKey",children:"Status"}),e(u,{variant:"headline3",children:t?t.state:e(I,{width:100})}),e("br",{}),t?t.state==="SUBMITTED"&&s("div",{className:"bootstrap-4-backport ButtonContainer",children:[e(P,{onClick:()=>{b(!0)},variant:"success",children:"Approve"}),e(P,{onClick:()=>{a(l=>{f(l)})},variant:"danger",children:"Reject"})]}):e(I,{width:200}),e(u,{variant:"dataFieldKey",children:"Access Requirement Name"}),e(u,{variant:"smallText1",children:(R=c==null?void 0:c.name)!=null?R:e(I,{width:100})}),e("br",{}),e(u,{variant:"dataFieldKey",children:"Assigned Reviewer"}),e(u,{variant:"smallText1",children:m!==void 0?m!==null?m.resourceAccess.map(l=>e(T,{principalId:l.principalId},l.principalId)):e(T,{principalId:he}):e(I,{width:100})}),e("br",{}),e(u,{variant:"dataFieldKey",children:"Conditions"}),c?e(u,{variant:"smallText1",children:s("ul",{children:[s("li",{children:["Expiration period:"," ",D.duration(c.expirationPeriod,"milliseconds").asDays()," ","day(s)",c.expirationPeriod===0&&" (no expiration)"]}),c.isCertifiedUserRequired&&e("li",{children:"User must be Certified"}),c.isValidatedProfileRequired&&e("li",{children:"User Profile must be Validated"}),c.isDUCRequired&&e("li",{children:"DUC is required"}),c.isIDURequired&&e("li",{children:"IDU is required"}),c.isIDUPublic&&e("li",{children:"IDU will be made public"}),c.isIRBApprovalRequired&&e("li",{children:"IRB Approval is required"}),c.areOtherAttachmentsRequired&&e("li",{children:"Other attachments are required"})]})}):e(I,{width:100}),e("br",{}),s("div",{className:"SubmissionSummaryGrid",children:[e(u,{variant:"dataFieldKey",children:"Submitted By"}),e(u,{variant:"smallText1",children:t?e(U,{size:"SMALL USER CARD",ownerId:t.submittedBy}):e(I,{width:100})}),e(u,{variant:"dataFieldKey",children:"Submitted On"}),e(u,{variant:"smallText1",children:t?_(D(t.submittedOn)):e(I,{width:100})}),e(u,{variant:"dataFieldKey",children:"Modified By"}),e(u,{variant:"smallText1",children:t?e(U,{size:"SMALL USER CARD",ownerId:t.modifiedBy}):e(I,{width:100})}),e(u,{variant:"dataFieldKey",children:"Modified On"}),e(u,{variant:"smallText1",children:t?_(D(t.modifiedOn)):e(I,{width:100})}),s(u,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${t?` (${t.accessorChanges.length})`:""}`]}),t?t.accessorChanges.map(l=>s(Me.Fragment,{children:[e(u,{className:"Key DataAccessor",variant:"smallText1",children:e("span",{style:{whiteSpace:"nowrap"},children:e(U,{size:"SMALL USER CARD",ownerId:l.userId},l.userId)})}),e(u,{className:"Value DataAccessor",variant:"smallText1",children:Se(Xe(l.type.substring(0,l.type.indexOf("_"))))})]},l.userId)):e(I,{width:100}),e(u,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e(u,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.institution:e(I,{width:100})}),e(u,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e(u,{className:"Value",variant:"smallText1",children:t?t.researchProjectSnapshot.projectLead:e(I,{width:100})})]})]}),s("div",{className:"SubmissionRightPane",children:[e(De,{children:t?e(Fr,{accessRequirementId:t.accessRequirementId}):e(g,{})}),s("div",{children:[(t==null?void 0:t.rejectedReason)&&s(g,{children:[e(u,{variant:"headline1",children:"Reason for rejection given by reviewer"}),e("hr",{}),e(u,{variant:"body1",style:{whiteSpace:"pre-line"},children:t.rejectedReason})]}),e(u,{variant:"headline1",children:"Contents of the Access Request"}),e("hr",{}),(t==null?void 0:t.researchProjectSnapshot.intendedDataUseStatement)&&s(g,{children:[e(u,{variant:"headline2",children:"Intended Data Use Statement"}),e(u,{variant:"body1",style:{whiteSpace:"pre-line"},children:t.researchProjectSnapshot.intendedDataUseStatement})]}),e(u,{variant:"headline2",children:"Documents"}),(t==null?void 0:t.ducFileHandleId)&&s(g,{children:[e(u,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e(ie,{submissionId:t.id,fileHandleId:t.ducFileHandleId})]}),(t==null?void 0:t.irbFileHandleId)&&s(g,{children:[e(u,{variant:"smallText2",children:"IRB Approval Letter"}),e(ie,{submissionId:t.id,fileHandleId:t.irbFileHandleId})]}),(t==null?void 0:t.attachments)&&s(g,{children:[e(u,{variant:"smallText2",children:"Other Attachments"}),t.attachments.map(l=>s(g,{children:[e(ie,{submissionId:t.id,fileHandleId:l},l),e("br",{})]}))]})]})]})]})}try{Q.displayName="SubmissionPage",Q.__docgenInfo={description:"Page for a Data Access Submission that a designated reviewer can view, and choose to approve or reject.",displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}},onRejectClicked:{defaultValue:null,description:'Invoked when a reviewer clicks "Reject". Provides a parameter for an external component to provide a reason for rejection, which will reject the submission when invoked.',name:"onRejectClicked",required:!0,type:{name:"(onReject: (rejectedReason: string) => void) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/SubmissionPage.tsx#SubmissionPage"]={docgenInfo:Q.__docgenInfo,name:"SubmissionPage",path:"src/lib/containers/dataaccess/SubmissionPage.tsx#SubmissionPage"})}catch{}const kr=window.React.useCallback;function se(r){const{href:i,children:a,icon:n}=r;return s(vr,{className:"Tab",role:"tab",to:i,children:[e(pe,{options:{icon:n,padding:"right"}}),e(u,{variant:"buttonLink",children:a})]})}function k(r){const{routerBaseName:i="#!DataAccessManagement:default",useMemoryRouter:a=!1,onRejectSubmissionClicked:n}=r,{data:t,isLoading:p}=Ge(),o=t==null?void 0:t.isACTMember,c=(t==null?void 0:t.isACTMember)||(t==null?void 0:t.isARReviewer),m=kr(h=>a?e(je,{...h}):e(pr,{...h}),[a]);return p?e(ee,{size:50}):e(m,{basename:i,children:s("div",{className:"ReviewerDashboard",children:[s("div",{className:"Tabs",role:"tablist",children:[o&&e(se,{href:"/AccessRequirements",icon:"accessClosed",children:"Access Requirements"}),c&&e(se,{href:"/Submissions",icon:"discussion",children:"Submissions"}),o&&e(se,{href:"/UserAccessHistory",icon:"history",children:"User Access History"})]}),e("div",{className:"TabContentContainer",children:e(De,{children:s(Be,{children:[o&&e(K,{path:"/AccessRequirements",children:e(z,{})}),c&&[e(K,{exact:!0,path:"/Submissions",children:e(Or,{})},"/Submissions"),e(K,{path:"/Submissions/:id",children:e(jr,{onRejectSubmissionClicked:n})},"/Submissions/:id")],e(K,{exact:!0,path:"/UserAccessHistory",children:e(gr,{})})]})})})]})})}function jr(r){const{id:i}=Ve();return e(Q,{submissionId:i,onRejectClicked:r.onRejectSubmissionClicked})}try{k.displayName="ReviewerDashboard",k.__docgenInfo={description:"",displayName:"ReviewerDashboard",props:{routerBaseName:{defaultValue:null,description:"Used to determine the base path for the component. Default is #!DataAccessManagement:default",name:"routerBaseName",required:!1,type:{name:"string"}},useMemoryRouter:{defaultValue:null,description:"If true use a MemoryRouter, which prevents the browser URL from updating. For demo purposes only.",name:"useMemoryRouter",required:!1,type:{name:"boolean"}},onRejectSubmissionClicked:{defaultValue:null,description:"Used to show the reject submission dialog",name:"onRejectSubmissionClicked",required:!0,type:{name:"(onReject: (reason: string) => void) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/ReviewerDashboard.tsx#ReviewerDashboard"]={docgenInfo:k.__docgenInfo,name:"ReviewerDashboard",path:"src/lib/containers/dataaccess/ReviewerDashboard.tsx#ReviewerDashboard"})}catch{}var ei={parameters:{storySource:{source:`import React from 'react'
import { ComponentStory, ComponentMeta } from '@storybook/react'

import ReviewerDashboard from './ReviewerDashboard'

// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export
export default {
  title: 'Synapse/Governance/ReviewerDashboard',
  component: ReviewerDashboard,
  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes
  argTypes: {},
} as ComponentMeta<typeof ReviewerDashboard>

// More on component templates: https://storybook.js.org/docs/react/writing-stories/introduction#using-args
const Template: ComponentStory<typeof ReviewerDashboard> = args => (
  <ReviewerDashboard {...args} />
)

export const Demo = Template.bind({})

Demo.args = {
  useMemoryRouter: true,
  routerBaseName: '#!/Other Components/ReviewerDashboard',
}
`,locationsMap:{demo:{startLoc:{col:59,line:15},endLoc:{col:1,line:17},startBody:{col:59,line:15},endBody:{col:1,line:17}}}}},title:"Synapse/Governance/ReviewerDashboard",component:k,argTypes:{}};const Br=r=>e(k,{...r}),Vr=Br.bind({});Vr.args={useMemoryRouter:!0,routerBaseName:"#!/Other Components/ReviewerDashboard"};const ri=["Demo"];export{Vr as Demo,ri as __namedExportsOrder,ei as default};
//# sourceMappingURL=ReviewerDashboard.stories.57a60f1c.js.map
