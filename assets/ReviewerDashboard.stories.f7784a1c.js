import{c as Le,R as we,a as xe,b as Ie,i as Ee,d as Me,e as be,m as Fe,u as le,f as de,M as Ue,S as je,g as H,h as ke}from"./react-router.8a85c8dd.js";import{_ as ge}from"./withStyles.670aaa99.js";import{_ as ue,a as Q}from"./objectWithoutPropertiesLoose.090b3c10.js";import{T as Be,b1 as Ve,w as He,I as Te,b2 as me,b3 as De,b4 as Ke,b5 as Ne,H as $e,b6 as Ye}from"./index.272215ce.js";import{T as d}from"./Typography.3a9e45b6.js";import{I as pe}from"./IconSvg.4a41f208.js";import{S as ee}from"./LoadingScreen.efad5b29.js";import"./assert.caef3bfc.js";import{h as D}from"./moment.53181859.js";import{A as x}from"./AccessApproval.493867d3.js";import{D as I}from"./EntityChildren.50133102.js";import{U as F}from"./UserCard.667db179.js";import{P as qe}from"./getEndpoint.0de7fccf.js";import{S as k}from"./Sort.58c069e6.js";import{f as _}from"./DateFormatter.ca47405e.js";import{a as n,j as e,F as g}from"./jsx-runtime.2e925369.js";import{T as he}from"./Table.9806fafe.js";import{u as fe}from"./upperFirst.d0db7d5a.js";import{B as P}from"./Button.c582ea4c.js";import{S as Ae,u as Ge,a as ze,b as We}from"./AccessSubmission.c8503001.js";import{U as T}from"./UserOrTeamBadge.8082059b.js";import{U as J}from"./UserSearchBoxV2.dd7a6154.js";import{A as _e}from"./AccessRequirementSearchBox.9aff326b.js";import{c as N,b as Ce}from"./toString.8ef640ae.js";import{o as ve,t as Qe}from"./toLower.33adf070.js";import{E as Je}from"./EntityTypeUtils.578c1e68.js";import{E as Xe}from"./EntityFinderModal.b35a42e7.js";import{F as Ze}from"./EntityFinder.a4865643.js";import{a as er,u as rr,b as tr,c as ar}from"./useGetAccessRequirement.866064e8.js";import{E as ir}from"./EntityLink.bf1b7a1c.js";import{I as nr}from"./CalendarWithIconFormGroup.e7b7ccb1.js";import{S as X}from"./ManagedACTAccessRequirementStatus.be369a71.js";import{M as sr}from"./MarkdownSynapse.0a663573.js";import{W as or}from"./WarningModal.1c7626c2.js";import{F as cr}from"./FileHandleLink.712da856.js";import{S as w}from"./Skeleton.3847d4da.js";import"./index.06f4a415.js";import"./objectWithoutProperties.07f8cd75.js";import"./toConsumableArray.8f496188.js";import"./createClass.67a84016.js";import"./Alert.5f67d407.js";import"./index.f252d424.js";import"./Transition.8d049b2f.js";import"./SvgIcon.2998c199.js";import"./makeStyles.72aedf90.js";import"./Tooltip.8a506c05.js";import"./createSvgIcon.0bfcb8f8.js";import"./slicedToArray.e9a7fa03.js";import"./useTheme.05af6e65.js";import"./InfoOutlined.d201fe9f.js";import"./Modal.9056450d.js";import"./useWaitForDOMRef.37941199.js";import"./useWillUnmount.4a16e5cd.js";import"./removeClass.27874bcb.js";import"./hasClass.56fd144a.js";import"./iframe.6ce0a742.js";import"./index.8cde812d.js";import"./IconCopy.b1eba79c.js";import"./SkeletonTable.355cadb6.js";import"./times.ff2f1d49.js";import"./toInteger.e5135150.js";import"./ToastMessage.6439b7b0.js";import"./FullWidthAlert.279e31cc.js";import"./uniqueId.fa0dadf5.js";import"./Overlay.bf042904.js";import"./usePopperMarginModifiers.4ced5867.js";import"./react-select.esm.d3dc6345.js";import"./stateManager-845a3300.esm.e37b74c8.js";import"./classCallCheck.8304ed06.js";import"./inherits.0fdbf119.js";import"./useGetInfoFromIds.1df9b0ae.js";import"./use-deep-compare-effect.esm.76673280.js";import"./uniq.202ea839.js";import"./_cacheHas.c79db210.js";import"./_baseDifference.78023f01.js";import"./_setToArray.a82100c8.js";import"./without.a5ce379c.js";import"./_baseMap.42713638.js";import"./_baseIsEqual.7a9ccfb0.js";import"./FileEntity.4f8cb425.js";import"./TypeUtils.a2c41307.js";import"./EntityModal.ae987ce0.js";import"./useEntityBundle.8dca40b2.js";import"./HelpPopover.106c2c62.js";import"./MarkdownPopover.4a413c8d.js";import"./HelpOutlineTwoTone.6ff08a10.js";import"./SchemaDrivenAnnotationEditor.24121690.js";import"./isEmpty.68a6fa8f.js";import"./lodash.35ce6cb8.js";import"./Collapse.8d0a3062.js";import"./groupBy.47714e83.js";import"./ExternalFileHandleInterface.ddcaae88.js";import"./pluralize.d02aac9f.js";import"./react-sizeme.a019049e.js";import"./Arrow.c6e8b887.js";import"./sqlFunctions.b49ac766.js";import"./useGetEntityChildren.a73e59b3.js";import"./Checkbox.85bb9cd4.js";import"./EntityIcon.2f317c72.js";import"./SynapseTableConstants.07ecdebd.js";import"./react-intersection-observer.m.66de6abb.js";import"./LockTwoTone.67127f07.js";import"./cloneDeep.cfb3156d.js";import"./Dropdown.b16d4176.js";import"./isRequiredForA11y.61bbc671.js";import"./useFavorites.4640a780.js";import"./index.5ef2ed87.js";import"./factory.44e1c15f.js";import"./SynapseVideo.5a7160d6.js";function lr(t,i){const{accessToken:a}=He();return Be(["accessApprovalSearch",t],async s=>await Ve({...t,nextPageToken:s.pageParam},a),{...i,getNextPageParam:s=>s.nextPageToken})}const E=window.React;var dr=function(t){ge(i,t);function i(){for(var s,r=arguments.length,h=new Array(r),o=0;o<r;o++)h[o]=arguments[o];return s=t.call.apply(t,[this].concat(h))||this,s.history=Le(s.props),s}var a=i.prototype;return a.render=function(){return E.createElement(we,{history:this.history,children:this.props.children})},i}(E.Component);E.Component;var se=function(i,a){return typeof i=="function"?i(a):i},oe=function(i,a){return typeof i=="string"?Me(i,null,null,a):i},Se=function(i){return i},O=E.forwardRef;typeof O=="undefined"&&(O=Se);function ur(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var mr=O(function(t,i){var a=t.innerRef,s=t.navigate,r=t.onClick,h=ue(t,["innerRef","navigate","onClick"]),o=h.target,l=Q({},h,{onClick:function(p){try{r&&r(p)}catch(A){throw p.preventDefault(),A}!p.defaultPrevented&&p.button===0&&(!o||o==="_self")&&!ur(p)&&(p.preventDefault(),s())}});return Se!==O?l.ref=i||a:l.ref=a,E.createElement("a",l)}),Pe=O(function(t,i){var a=t.component,s=a===void 0?mr:a,r=t.replace,h=t.to,o=t.innerRef,l=ue(t,["component","replace","to","innerRef"]);return E.createElement(Ie.Consumer,null,function(u){u||Ee(!1);var p=u.history,A=oe(se(h,u.location),u.location),C=A?p.createHref(A):"",f=Q({},l,{href:C,navigate:function(){var b=se(h,u.location),m=be(u.location)===be(oe(b)),c=r||m?p.replace:p.push;c(b)}});return Se!==O?f.ref=i||o:f.innerRef=o,E.createElement(s,f)})}),Oe=function(i){return i},Z=E.forwardRef;typeof Z=="undefined"&&(Z=Oe);function pr(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return i.filter(function(s){return s}).join(" ")}var hr=Z(function(t,i){var a=t["aria-current"],s=a===void 0?"page":a,r=t.activeClassName,h=r===void 0?"active":r,o=t.activeStyle,l=t.className,u=t.exact,p=t.isActive,A=t.location,C=t.sensitive,f=t.strict,R=t.style,b=t.to,m=t.innerRef,c=ue(t,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return E.createElement(Ie.Consumer,null,function(S){S||Ee(!1);var v=A||S.location,y=oe(se(b,v),v),q=y.pathname,B=q&&q.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),L=B?Fe(v.pathname,{path:B,exact:u,sensitive:C,strict:f}):null,V=!!(p?p(L,v):L),re=typeof l=="function"?l(V):l,te=typeof R=="function"?R(V):R;V&&(re=pr(re,h),te=Q({},te,o));var ae=Q({"aria-current":V&&s||null,className:re,style:te,to:y},c);return Oe!==Z?ae.ref=i||m:ae.innerRef=m,E.createElement(Pe,ae)})});const fr=window.React.useEffect,Re=(t,i,a)=>{fr(()=>{const s=setTimeout(()=>t(),a);return()=>clearTimeout(s)},[...i||[],a])},vr=window.React.useMemo,Sr=window.React.useState,Y=({accessorId:t,accessRequirementId:i})=>{var C;const[a,s]=Sr({field:x.MODIFIED_ON,direction:I.DESC}),r=vr(()=>({accessorId:t,accessRequirementId:i,sort:[a]}),[t,i,a]),{data:h,hasNextPage:o,fetchNextPage:l,isLoading:u}=lr(r),p=(C=h==null?void 0:h.pages.flatMap(f=>f.results))!=null?C:[],A=f=>{a.field===f?s({field:f,direction:a.direction===I.DESC?I.ASC:I.DESC}):s({field:f,direction:I.DESC})};return n("div",{className:"AccessApprovalsTable bootstrap-4-backport",children:[n(he,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{children:n("tr",{children:[e("th",{children:"AR ID"}),e("th",{children:"Access Requirement Name"}),e("th",{children:"Submitter"}),e("th",{children:"Status"}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Modified Date"}),e(k,{role:"button",active:a.field===x.MODIFIED_ON,direction:a.field==="MODIFIED_ON"?a.direction==="DESC"?I.DESC:I.ASC:I.DESC,onClick:()=>A(x.MODIFIED_ON)})]})}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Expires"}),e(k,{role:"button",active:a.field===x.EXPIRED_ON,direction:a.field==="EXPIRED_ON"?a.direction==="DESC"?I.DESC:I.ASC:I.DESC,onClick:()=>A(x.EXPIRED_ON)})]})})]})}),e("tbody",{children:p.map(f=>n("tr",{children:[e("td",{children:e("a",{href:`${qe.PORTAL}#!AccessRequirement:AR_ID=${f.accessRequirementId}`,children:f.accessRequirementId})}),e("td",{children:f.accessRequirementName}),e("td",{children:e(F,{size:Te,ownerId:f.submitterId})}),e("td",{children:fe(f.state.toLocaleLowerCase())}),e("td",{children:_(D(f.modifiedOn))}),e("td",{className:`${f.expiredOn?new Date>new Date(f.expiredOn)?"expired":"":"non-expire"} remove-border`,children:f.expiredOn?_(D(f.expiredOn)):"Never"})]},f.id))})]}),u&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!u&&p.length===0&&e(d,{className:"SRC-center-text",variant:"body1",children:"No Results"}),o?e(P,{variant:"outline",onClick:()=>l,children:"Show More"}):""]})};try{Y.displayName="AccessApprovalsTable",Y.__docgenInfo={description:"",displayName:"AccessApprovalsTable",props:{accessorId:{defaultValue:null,description:"",name:"accessorId",required:!0,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AccessApprovalsTable.tsx#AccessApprovalsTable"]={docgenInfo:Y.__docgenInfo,name:"AccessApprovalsTable",path:"src/lib/containers/AccessApprovalsTable.tsx#AccessApprovalsTable"})}catch{}const Rr=window.React.useMemo,br=window.React.useState,U=({showSubmitter:t,showStatus:i,showRequesters:a,accessorId:s,accessRequirementId:r,reviewerId:h,submissionState:o,reviewerFilterType:l})=>{var S;const[u,p]=br({field:Ae.CREATED_ON,direction:I.DESC}),A=Rr(()=>({accessorId:s,accessRequirementId:r,submissionState:o,reviewerId:h,reviewerFilterType:l,sort:[u]}),[s,r,o,h,l,u]),{data:C,hasNextPage:f,fetchNextPage:R,isLoading:b}=Ge(A),m=(S=C==null?void 0:C.pages.flatMap(v=>v.results))!=null?S:[],c=v=>{u.field===v?p({field:v,direction:u.direction==="DESC"?"ASC":"DESC"}):p({field:v,direction:"DESC"})};return n("div",{className:"bootstrap-4-backport AccessSubmissionTable",children:[n(he,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{children:n("tr",{children:[e("th",{children:"REQUEST"}),e("th",{children:"Access Requirement Name"}),t&&e("th",{children:"Submitter"}),i&&e("th",{children:"Status"}),a&&e("th",{children:"Requesters"}),e("th",{children:"Reviewer(s)"}),n("th",{children:["Created Date",e(k,{role:"button",style:{float:"right"},active:u.field==="CREATED_ON","aria-label":"Sort by Created On",direction:u.field==="CREATED_ON"?u.direction==="DESC"?"DESC":"ASC":"DESC",onClick:()=>c(Ae.CREATED_ON)})]})]})}),e("tbody",{children:m.map(v=>n("tr",{children:[e("td",{children:e(Pe,{to:`/Submissions/${v.id}`,children:v.id})}),e("td",{children:v.accessRequirementName}),t&&e("td",{children:e(T,{principalId:v.submitterId})}),i&&e("td",{children:fe(v.state.toLocaleLowerCase())}),a&&n("td",{children:[e(T,{principalId:v.submitterId}),v.accessorChanges.filter(y=>v.submitterId!==y.userId).map(y=>e("li",{children:e(F,{size:Te,ownerId:y.userId,className:"requester"})},y.userId))]}),e("td",{children:v.accessRequirementReviewerIds.length===0?e(T,{principalId:me}):v.accessRequirementReviewerIds.map(y=>e(T,{principalId:y},y))}),e("td",{children:_(D(v.createdOn))})]},v.id))})]}),b&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!b&&m.length==0&&e(d,{className:"SRC-center-text",variant:"body1",children:"No Results"}),f?e(P,{variant:"outline",onClick:()=>R(),children:"Show More"}):""]})};try{U.displayName="AccessRequestSubmissionTable",U.__docgenInfo={description:"",displayName:"AccessRequestSubmissionTable",props:{showSubmitter:{defaultValue:null,description:"",name:"showSubmitter",required:!1,type:{name:"boolean"}},showStatus:{defaultValue:null,description:"",name:"showStatus",required:!1,type:{name:"boolean"}},showRequesters:{defaultValue:null,description:"",name:"showRequesters",required:!1,type:{name:"boolean"}},accessorId:{defaultValue:null,description:"",name:"accessorId",required:!1,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!1,type:{name:"string"}},reviewerId:{defaultValue:null,description:"",name:"reviewerId",required:!1,type:{name:"string"}},submissionState:{defaultValue:null,description:"",name:"submissionState",required:!1,type:{name:"enum",value:[{value:'"SUBMITTED"'},{value:'"APPROVED"'},{value:'"REJECTED"'},{value:'"CANCELLED"'}]}},reviewerFilterType:{defaultValue:null,description:"",name:"reviewerFilterType",required:!1,type:{name:"enum",value:[{value:'"ALL"'},{value:'"ACT_ONLY"'},{value:'"DELEGATED_ONLY"'}]}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AccessRequestSubmissionTable.tsx#AccessRequestSubmissionTable"]={docgenInfo:U.__docgenInfo,name:"AccessRequestSubmissionTable",path:"src/lib/containers/AccessRequestSubmissionTable.tsx#AccessRequestSubmissionTable"})}catch{}const Ar=window.React.useCallback,Cr=window.React.useEffect,K=window.React.useState,yr=()=>{const[t,i]=K(),[a,s]=K(""),[r,h]=K({accessorId:a,accessRequirementId:t}),[o,l]=K({showStatus:!0,showSubmitter:!0,accessorId:a,accessRequirementId:t}),u=le(),p=de(),A=500,C=Ar(R=>{s(R||"")},[]);Cr(()=>{(()=>{var m,c;const b=new URLSearchParams(u.search);i((m=b.get("accessRequirementId"))!=null?m:void 0),s((c=b.get("accessorId"))!=null?c:"")})()},[u.search]),Re(()=>{((b,m)=>{const c=new URLSearchParams(ve({accessRequirementId:b,accessorId:m},S=>S===void 0||S===""));p.replace({pathname:u.pathname,search:c.toString()})})(t,a),h({accessorId:a,accessRequirementId:t}),l({showStatus:!0,showSubmitter:!0,accessorId:a,accessRequirementId:t})},[t,a,p,u.pathname],A);const f=()=>n("div",{className:"text-center",children:[e("img",{className:"SearchPlaceholderImage",alt:"Begin searching",src:"https://s3.amazonaws.com/static.synapse.org/images/search-happy.svg"}),e(d,{variant:"body2",children:"Enter a user or team name in the search field above to view their data access history"})]});return n("div",{className:"UserHistoryDashboard bootstrap-4-backport",children:[n("div",{className:"InputPanel",children:[n("div",{children:[e(N,{htmlFor:"user-filter",children:"Select a user to view their access history"}),e(J,{inputId:"user-filter",onChange:C,defaultValue:a,placeholder:"Search for a user name",typeFilter:De.USERS_ONLY})]}),a&&n("div",{children:[e(N,{htmlFor:"arName-filter",children:"Filter by Access Requirement Name"}),e(_e,{inputId:"arName-filter",placeholder:"Search for an Access Requirement Name ",onChange:i})]})]}),a?n(g,{children:[n(d,{variant:"headline3",children:["Submissions including ",e(T,{principalId:a})]}),e(U,{...o}),e(d,{variant:"headline3",children:"Status in Access Requirements"}),e(Y,{...r})]}):e(f,{})]})},wr=window.React,Ir=window.React.useMemo,Er=window.React.useState;function G(t){var m;const{nameContains:i,relatedProjectId:a,reviewerId:s,accessType:r,onCreateNewAccessRequirementClicked:h}=t,[o,l]=Er({field:"CREATED_ON",direction:"DESC"}),u=Ir(()=>({nameContains:i,relatedProjectId:a,reviewerId:s,accessType:r,sort:[o]}),[i,a,s,r,o]),{data:p,hasNextPage:A,fetchNextPage:C,isLoading:f}=er(u),R=(m=p==null?void 0:p.pages.flatMap(c=>c.results))!=null?m:[],b=c=>{o.field===c?l({field:c,direction:o.direction==="DESC"?"ASC":"DESC"}):l({field:c,direction:"DESC"})};return n("div",{className:"bootstrap-4-backport",children:[n("div",{className:"SRC-split",children:[e(d,{variant:"headline3",style:{marginBottom:0},children:"Access Requirements"}),h&&n(P,{variant:"outline",onClick:h,children:[e(pe,{options:{icon:"favTwoTone",padding:"right"}}),"New Access Requirement"]})]}),n("div",{className:"AccessRequirementsTable",children:[n(he,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{className:"access-requirements-header",children:n("tr",{children:[e("th",{children:"AR ID"}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Access Requirement Name"}),e(k,{role:"button",onClick:()=>b("NAME"),"aria-label":"Sort by Name",active:o.field==="NAME",direction:o.field==="NAME"?o.direction:"DESC"})]})}),e("th",{children:"Related to Projects"}),e("th",{children:"Reviewer"}),e("th",{children:"Last Modified"}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Created On"}),e(k,{role:"button",onClick:()=>b("CREATED_ON"),active:o.field==="CREATED_ON","aria-label":"Sort by Created On",direction:o.field==="CREATED_ON"?o.direction:"DESC"})]})})]})}),e("tbody",{children:R.map(c=>n("tr",{children:[e("td",{children:e("a",{href:`${qe.PORTAL}#!AccessRequirement:AR_ID=${c.id}`,children:c.id})}),e("td",{children:c.name}),e("td",{children:c.relatedProjectIds.map(S=>n(wr.Fragment,{children:[e(ir,{entity:S})," ",n("span",{className:"InlineLabel",children:["(",S,")"]}),e("br",{})]},S))}),e("td",{children:c.reviewerIds.length===0?e(T,{principalId:me}):c.reviewerIds.map(S=>e(T,{principalId:S},S))}),e("td",{children:_(D(c.modifiedOn))}),e("td",{children:_(D(c.createdOn))})]},c.id))})]}),f&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!f&&R.length===0&&e(d,{className:"SRC-center-text",variant:"body1",children:"No Results"}),A?e(P,{variant:"outline",onClick:()=>{C()},children:"Show More"}):e(g,{})]})]})}try{G.displayName="AccessRequirementTable",G.__docgenInfo={description:"",displayName:"AccessRequirementTable",props:{nameContains:{defaultValue:null,description:"",name:"nameContains",required:!1,type:{name:"string"}},relatedProjectId:{defaultValue:null,description:"",name:"relatedProjectId",required:!1,type:{name:"string"}},reviewerId:{defaultValue:null,description:"",name:"reviewerId",required:!1,type:{name:"string"}},accessType:{defaultValue:null,description:"",name:"accessType",required:!1,type:{name:"enum",value:[{value:'"CREATE"'},{value:'"READ"'},{value:'"UPDATE"'},{value:'"DELETE"'},{value:'"CHANGE_PERMISSIONS"'},{value:'"DOWNLOAD"'},{value:'"UPLOAD"'},{value:'"PARTICIPATE"'},{value:'"SUBMIT"'},{value:'"READ_PRIVATE_SUBMISSION"'},{value:'"UPDATE_SUBMISSION"'},{value:'"DELETE_SUBMISSION"'},{value:'"TEAM_MEMBERSHIP_UPDATE"'},{value:'"SEND_MESSAGE"'},{value:'"CHANGE_SETTINGS"'},{value:'"MODERATE"'},{value:'"REVIEW_SUBMISSIONS"'}]}},onCreateNewAccessRequirementClicked:{defaultValue:null,description:"",name:"onCreateNewAccessRequirementClicked",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/AccessRequirementTable.tsx#AccessRequirementTable"]={docgenInfo:G.__docgenInfo,name:"AccessRequirementTable",path:"src/lib/containers/dataaccess/AccessRequirementTable.tsx#AccessRequirementTable"})}catch{}const gr=window.React.useCallback,Tr=window.React.useEffect,M=window.React.useState;function z(t){const{onCreateNewAccessRequirementClicked:a}=t,s=le(),r=de(),[h,o]=M(""),[l,u]=M(void 0),[p,A]=M(void 0);Tr(()=>{function c(){var v,y,q;const S=new URLSearchParams(s.search);o((v=S.get("nameContains"))!=null?v:""),u((y=S.get("relatedProjectId"))!=null?y:void 0),A((q=S.get("reviewerId"))!=null?q:void 0)}c()},[s.search]);const[C,f]=M(!1),[R,b]=M({nameContains:h,relatedProjectId:l,reviewerId:p,onCreateNewAccessRequirementClicked:a});Re(()=>{function c(S,v,y){const q=ve({nameContains:S,relatedProjectId:v,reviewerId:y},L=>L===void 0||L===""),B=new URLSearchParams(q);r.replace({pathname:s.pathname,search:B.toString()})}b({nameContains:h,relatedProjectId:l,reviewerId:p,onCreateNewAccessRequirementClicked:a}),c(h,l,p)},[h,l,p,a,r,s.pathname],500);const m=gr(c=>{A(c||void 0)},[]);return n("div",{className:"AccessRequirementDashboard bootstrap-4-backport",children:[e(Xe,{configuration:{initialScope:Ze.ALL_PROJECTS,initialContainer:null,selectMultiple:!1,selectableTypes:[Je.PROJECT]},show:C,onClose:()=>{f(!1)},onCancel:()=>{f(!1)},title:"Select Project to Filter Access Requirements",promptCopy:"Select a project to find Access Requirements that are associated with that project. Access Requirements will be found if the Access Requirement is applied to the project, or if it is applied to any item inside the project.",onConfirm:c=>{u(c[0].targetId),f(!1)},confirmButtonCopy:"Select"}),n("div",{className:"InputPanel",children:[n("div",{children:[e(N,{htmlFor:"ar-name-filter",children:"Filter by Access Requirement Name"}),n(nr,{children:[e(Ce,{id:"ar-name-filter",type:"text",placeholder:"Search for an Access Requirement Name",value:h,onChange:c=>{o(c.target.value)}}),e(pe,{options:{icon:"searchOutlined"}})]})]}),n("div",{children:[e(N,{htmlFor:"project-id-filter",children:"Filter by Project"}),n("div",{className:"ProjectIdInputGroup",children:[e(Ce,{id:"project-id-filter",type:"text",placeholder:"Enter a project SynID",value:l,onChange:c=>{const S=c.target.value;u(S===""?void 0:S)}}),e(P,{variant:"outline",onClick:()=>{f(!0)},children:"Browse"})]})]}),n("div",{children:[e(N,{htmlFor:"reviewer-filter",children:"Filter by Reviewer"}),e(J,{inputId:"reviewer-filter",placeholder:"Search for a username or team name",defaultValue:p,onChange:m})]})]}),e(G,{...R})]})}try{z.displayName="AccessRequirementDashboard",z.__docgenInfo={description:"",displayName:"AccessRequirementDashboard",props:{onCreateNewAccessRequirementClicked:{defaultValue:null,description:"",name:"onCreateNewAccessRequirementClicked",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/AccessRequirementDashboard.tsx#AccessRequirementDashboard"]={docgenInfo:z.__docgenInfo,name:"AccessRequirementDashboard",path:"src/lib/containers/dataaccess/AccessRequirementDashboard.tsx#AccessRequirementDashboard"})}catch{}const ye=window.React.useCallback,Dr=window.React.useEffect,$=window.React.useState,Nr=()=>{const[t,i]=$(),[a,s]=$(),[r,h]=$(),[o,l]=$({accessRequirementId:t,accessorId:a,reviewerId:r,showRequesters:!0,submissionState:X.SUBMITTED}),u=le(),p=de(),A=500;Dr(()=>{(()=>{var m,c,S;const b=new URLSearchParams(u.search);i((m=b.get("accessRequirementId"))!=null?m:void 0),s((c=b.get("accessorId"))!=null?c:void 0),h((S=b.get("reviewerId"))!=null?S:void 0)})()},[u.search]);const C=ye(R=>{s(R||void 0)},[]),f=ye(R=>{h(R||void 0)},[]);return Re(()=>{((b,m,c)=>{const S=new URLSearchParams(ve({accessRequirementId:b,accessorId:m,reviewerId:c},v=>v===void 0||v===""));p.replace({pathname:u.pathname,search:S.toString()})})(t,a,r),l({accessRequirementId:t,accessorId:a,reviewerId:r,showRequesters:!0,submissionState:X.SUBMITTED})},[t,a,r,p,u.pathname],A),n("div",{className:"AccessSubmissionDashboard bootstrap-4-backport",children:[n("div",{className:"InputPanel",children:[n("div",{children:[e(N,{htmlFor:"arId-filter",children:"Filter by Access Requirement Name"}),e(_e,{inputId:"arId-filter",onChange:i,placeholder:"Search for an Access Requirement Name "})]}),n("div",{children:[e(N,{htmlFor:"requester-filter",children:"Filter by Requester"}),e(J,{inputId:"requester-filter",placeholder:"Search for a user name",defaultValue:a,onChange:C,typeFilter:De.USERS_ONLY})]}),n("div",{children:[e(N,{htmlFor:"reviewer-filter",children:"Filter by Reviewer"}),e(J,{inputId:"reviewer-filter",placeholder:"Search for a user or team name",defaultValue:r,onChange:f})]})]}),e(d,{variant:"headline3",children:"Access Request Submissions"}),e(U,{...o})]})},ce=window.React,qr=window.React.useState;function ie(t){const{submissionId:i,fileHandleId:a}=t,s=ce.useMemo(()=>({fileHandleId:a,associateObjectId:i,associateObjectType:$e.DataAccessSubmissionAttachment}),[a,i]);return e(cr,{showDownloadIcon:!0,fileHandleAssociation:s},a)}function _r(t){return e(or,{show:t.show,title:"Approve Request?",modalBody:n(g,{children:[e(d,{variant:"body1",children:"Approving the request will grant access to controlled data."}),e(d,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."})]}),onConfirm:t.onConfirm,onConfirmCallbackArgs:[],onCancel:t.onCancel,confirmButtonText:"Approve"})}function Pr(t){const{data:i}=ar(t.accessRequirementId,{useErrorBoundary:!0});return i?e("div",{className:"AccessRequirementWikiContainer",children:n("div",{className:"AccessRequirementWikiContent",children:[e(d,{variant:"headline1",children:"Access Requirement"}),e("hr",{}),e(sr,{wikiId:i==null?void 0:i.wikiPageId,ownerId:i==null?void 0:i.ownerObjectId,objectType:i==null?void 0:i.ownerObjectType})]})}):e(w,{width:"100%",height:"600px"})}function W(t){var R,b;const{submissionId:i,onRejectClicked:a}=t,s=Ke(),{data:r,refetch:h}=ze(i,{useErrorBoundary:!0}),{mutateAsync:o}=We(),{data:l}=rr(parseInt(r==null?void 0:r.accessRequirementId),{enabled:!!r}),{data:u}=tr(r==null?void 0:r.accessRequirementId,{enabled:!!r,useErrorBoundary:!0}),[p,A]=qr(!1);function C(){var m;return o({submissionId:(m=r==null?void 0:r.id)!=null?m:"",newState:X.APPROVED})}function f(m){var c;return o({submissionId:(c=r==null?void 0:r.id)!=null?c:"",newState:X.REJECTED,rejectedReason:m})}return n("div",{className:"SubmissionPage",children:[e(_r,{show:p,onCancel:()=>{A(!1)},onConfirm:async()=>{try{await C()}catch(m){s(m)}A(!1),h()}}),n("div",{className:"SubmissionSummary",children:[e(d,{variant:"dataFieldKey",children:"Status"}),e(d,{variant:"headline3",children:r?r.state:e(w,{width:100})}),e("br",{}),r?r.state==="SUBMITTED"&&n("div",{className:"bootstrap-4-backport ButtonContainer",children:[e(P,{onClick:()=>{A(!0)},variant:"success",children:"Approve"}),e(P,{onClick:()=>{a(m=>{f(m)})},variant:"danger",children:"Reject"})]}):e(w,{width:200}),e(d,{variant:"dataFieldKey",children:"Access Requirement Name"}),e(d,{variant:"smallText1",children:(R=l==null?void 0:l.name)!=null?R:e(w,{width:100})}),e("br",{}),e(d,{variant:"dataFieldKey",children:"Assigned Reviewer"}),e(d,{variant:"smallText1",children:u!==void 0?u!==null?u.resourceAccess.map(m=>e(T,{principalId:m.principalId},m.principalId)):e(T,{principalId:me}):e(w,{width:100})}),e("br",{}),e(d,{variant:"dataFieldKey",children:"Conditions"}),l?e(d,{variant:"smallText1",children:n("ul",{children:[n("li",{children:["Expiration period:"," ",D.duration(l.expirationPeriod,"milliseconds").asDays()," ","day(s)",l.expirationPeriod===0&&" (no expiration)"]}),l.isCertifiedUserRequired&&e("li",{children:"User must be Certified"}),l.isValidatedProfileRequired&&e("li",{children:"User Profile must be Validated"}),l.isDUCRequired&&e("li",{children:"DUC is required"}),l.isIDURequired&&e("li",{children:"IDU is required"}),l.isIDUPublic&&e("li",{children:"IDU will be made public"}),l.isIRBApprovalRequired&&e("li",{children:"IRB Approval is required"}),l.areOtherAttachmentsRequired&&e("li",{children:"Other attachments are required"})]})}):e(w,{width:100}),e("br",{}),n("div",{className:"SubmissionSummaryGrid",children:[e(d,{variant:"dataFieldKey",children:"Submitted By"}),e(d,{variant:"smallText1",children:r?e(F,{size:"SMALL USER CARD",ownerId:r.submittedBy}):e(w,{width:100})}),e(d,{variant:"dataFieldKey",children:"Submitted On"}),e(d,{variant:"smallText1",children:r?_(D(r.submittedOn)):e(w,{width:100})}),e(d,{variant:"dataFieldKey",children:"Modified By"}),e(d,{variant:"smallText1",children:r?e(F,{size:"SMALL USER CARD",ownerId:r.modifiedBy}):e(w,{width:100})}),e(d,{variant:"dataFieldKey",children:"Modified On"}),e(d,{variant:"smallText1",children:r?_(D(r.modifiedOn)):e(w,{width:100})}),n(d,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${r?` (${r.accessorChanges.length})`:""}`]}),r?r.accessorChanges.map(m=>n(ce.Fragment,{children:[e(d,{className:"Key DataAccessor",variant:"smallText1",children:e("span",{style:{whiteSpace:"nowrap"},children:e(F,{size:"SMALL USER CARD",ownerId:m.userId},m.userId)})}),e(d,{className:"Value DataAccessor",variant:"smallText1",children:fe(Qe(m.type.substring(0,m.type.indexOf("_"))))})]},m.userId)):e(w,{width:100}),e(d,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e(d,{className:"Value",variant:"smallText1",children:r?r.researchProjectSnapshot.institution:e(w,{width:100})}),e(d,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e(d,{className:"Value",variant:"smallText1",children:r?r.researchProjectSnapshot.projectLead:e(w,{width:100})})]})]}),n("div",{className:"SubmissionRightPane",children:[e(Ne,{children:r?e(Pr,{accessRequirementId:r.accessRequirementId}):e(g,{})}),n("div",{children:[(r==null?void 0:r.rejectedReason)&&n(g,{children:[e(d,{variant:"headline1",children:"Reason for rejection given by reviewer"}),e("hr",{}),e(d,{variant:"body1",style:{whiteSpace:"pre-line"},children:r.rejectedReason})]}),e(d,{variant:"headline1",children:"Contents of the Access Request"}),e("hr",{}),((b=r==null?void 0:r.researchProjectSnapshot)==null?void 0:b.intendedDataUseStatement)&&n(g,{children:[e(d,{variant:"headline2",children:"Intended Data Use Statement"}),e(d,{variant:"body1",style:{whiteSpace:"pre-line"},children:r.researchProjectSnapshot.intendedDataUseStatement})]}),e(d,{variant:"headline2",children:"Documents"}),(r==null?void 0:r.ducFileHandleId)&&n(g,{children:[e(d,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e(ie,{submissionId:r.id,fileHandleId:r.ducFileHandleId})]}),(r==null?void 0:r.irbFileHandleId)&&n(g,{children:[e(d,{variant:"smallText2",children:"IRB Approval Letter"}),e(ie,{submissionId:r.id,fileHandleId:r.irbFileHandleId})]}),(r==null?void 0:r.attachments)&&n(g,{children:[e(d,{variant:"smallText2",children:"Other Attachments"}),r.attachments.map(m=>n(ce.Fragment,{children:[e(ie,{submissionId:r.id,fileHandleId:m}),e("br",{})]},m))]})]})]})]})}try{W.displayName="SubmissionPage",W.__docgenInfo={description:"Page for a Data Access Submission that a designated reviewer can view, and choose to approve or reject.",displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}},onRejectClicked:{defaultValue:null,description:'Invoked when a reviewer clicks "Reject". Provides a parameter for an external component to provide a reason for rejection, which will reject the submission when invoked.',name:"onRejectClicked",required:!0,type:{name:"(onReject: (rejectedReason: string) => void) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/SubmissionPage.tsx#SubmissionPage"]={docgenInfo:W.__docgenInfo,name:"SubmissionPage",path:"src/lib/containers/dataaccess/SubmissionPage.tsx#SubmissionPage"})}catch{}const Or=window.React.useCallback;function ne(t){const{href:i,children:a,icon:s}=t;return n(hr,{className:"Tab",role:"tab",to:i,children:[e(pe,{options:{icon:s,padding:"right"}}),e(d,{variant:"buttonLink",children:a})]})}function j(t){const{routerBaseName:i="#!DataAccessManagement:default",useMemoryRouter:a=!1,onRejectSubmissionClicked:s}=t,{data:r,isLoading:h}=Ye(),o=r==null?void 0:r.isACTMember,l=(r==null?void 0:r.isACTMember)||(r==null?void 0:r.isARReviewer),u=Or(p=>a?e(Ue,{...p}):e(dr,{...p}),[a]);return h?e(ee,{size:50}):e(u,{basename:i,children:n("div",{className:"ReviewerDashboard",children:[n("div",{className:"Tabs",role:"tablist",children:[o&&e(ne,{href:"/AccessRequirements",icon:"accessClosed",children:"Access Requirements"}),l&&e(ne,{href:"/Submissions",icon:"discussion",children:"Submissions"}),o&&e(ne,{href:"/UserAccessHistory",icon:"history",children:"User Access History"})]}),e("div",{className:"TabContentContainer",children:e(Ne,{children:n(je,{children:[o&&e(H,{path:"/AccessRequirements",children:e(z,{})}),l&&[e(H,{exact:!0,path:"/Submissions",children:e(Nr,{})},"/Submissions"),e(H,{path:"/Submissions/:id",children:e(Lr,{onRejectSubmissionClicked:s})},"/Submissions/:id")],e(H,{exact:!0,path:"/UserAccessHistory",children:e(yr,{})})]})})})]})})}function Lr(t){const{id:i}=ke();return e(W,{submissionId:i,onRejectClicked:t.onRejectSubmissionClicked})}try{j.displayName="ReviewerDashboard",j.__docgenInfo={description:"",displayName:"ReviewerDashboard",props:{routerBaseName:{defaultValue:null,description:"Used to determine the base path for the component. Default is #!DataAccessManagement:default",name:"routerBaseName",required:!1,type:{name:"string"}},useMemoryRouter:{defaultValue:null,description:"If true use a MemoryRouter, which prevents the browser URL from updating. For demo purposes only.",name:"useMemoryRouter",required:!1,type:{name:"boolean"}},onRejectSubmissionClicked:{defaultValue:null,description:"Used to show the reject submission dialog",name:"onRejectSubmissionClicked",required:!0,type:{name:"(onReject: (reason: string) => void) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/ReviewerDashboard.tsx#ReviewerDashboard"]={docgenInfo:j.__docgenInfo,name:"ReviewerDashboard",path:"src/lib/containers/dataaccess/ReviewerDashboard.tsx#ReviewerDashboard"})}catch{}var Ua={parameters:{storySource:{source:`import React from 'react'
import { ComponentStory, ComponentMeta } from '@storybook/react'

import ReviewerDashboard from './ReviewerDashboard'

// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export
export default {
  title: 'Synapse/Governance/ReviewerDashboard',
  component: ReviewerDashboard,
  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes
  argTypes: {},
} as ComponentMeta<typeof ReviewerDashboard>

// More on component templates: https://storybook.js.org/docs/react/writing-stories/introduction#using-args
const Template: ComponentStory<typeof ReviewerDashboard> = args => (
  <ReviewerDashboard {...args} />
)

export const Demo = Template.bind({})

Demo.args = {
  useMemoryRouter: true,
  routerBaseName: '#!/Other Components/ReviewerDashboard',
}
`,locationsMap:{demo:{startLoc:{col:59,line:15},endLoc:{col:1,line:17},startBody:{col:59,line:15},endBody:{col:1,line:17}}}}},title:"Synapse/Governance/ReviewerDashboard",component:j,argTypes:{}};const xr=t=>e(j,{...t}),Mr=xr.bind({});Mr.args={useMemoryRouter:!0,routerBaseName:"#!/Other Components/ReviewerDashboard"};const ja=["Demo"];export{Mr as Demo,ja as __namedExportsOrder,Ua as default};
//# sourceMappingURL=ReviewerDashboard.stories.f7784a1c.js.map
