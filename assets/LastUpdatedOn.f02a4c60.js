import{d as H,e as ge,j as Se,k as Ce,n as pt,o as ht,C as mt,p as ft,q as yt,E as gt,h as St,i as Ct}from"./TotalQueryResults.80edce2e.js";import{H as Be}from"./HelpPopover.106c2c62.js";import{I as $,S as bt}from"./IconSvg.4a41f208.js";import{j as o,a as _,F as k}from"./jsx-runtime.2e925369.js";import{a as Me}from"./Collapse.8d0a3062.js";import{u as ze}from"./unCamelCase.d070537b.js";import{C as x}from"./ColumnType.744125d2.js";import"./assert.caef3bfc.js";import{C as wt,d as me}from"./ToastMessage.6439b7b0.js";import{cI as vt,bS as Tt,C as Rt,cJ as It,w as K,f as _t,cq as Et,ai as Lt,bi as xt,cK as qt,X as Dt,cr as Nt,ca as Ot,aA as At,cL as Ue,H as Ft,B as kt,Z as Vt,bC as te,x as Pt,y as $t}from"./index.272215ce.js";import{E as be}from"./ElementWithTooltip.9cefef98.js";import{k as U,l as Bt,m as Y,n as at,o as Mt}from"./EntityTypeUtils.578c1e68.js";import{b as zt,T as Ae}from"./Tooltip.8a506c05.js";import{M as Q,a as Qt,b as Ht}from"./Modal.9056450d.js";import{B as fe}from"./Button.c582ea4c.js";import{u as Ut}from"./use-deep-compare-effect.esm.76673280.js";import{P as Gt}from"./ProgrammaticInstructionsModal.ef2d2f71.js";import{D as M}from"./Dropdown.b16d4176.js";import{T as we}from"./Typography.3a9e45b6.js";import{Q as Wt}from"./QueryCount.7869e803.js";import{I as rt}from"./index.b66e9392.js";import{c as J}from"./createSvgIcon.0bfcb8f8.js";import{c as j}from"./cloneDeep.cfb3156d.js";import{a as Yt,z as Kt}from"./iframe.6ce0a742.js";import{N as Xt}from"./NoData.928742eb.js";import{P as Fe}from"./getEndpoint.0de7fccf.js";import{b as jt,U as Jt,g as Zt}from"./UserCard.667db179.js";import{D as st,I as en}from"./InteractiveCopyIdsIcon.387046c5.js";import{H as tn}from"./HasAccessV2.92eea662.js";import{S as nn,l as on}from"./LoadingScreen.efad5b29.js";import{p as an,b as rn,f as sn,a as ln}from"./sqlFunctions.b49ac766.js";import{u as Qe}from"./react-intersection-observer.m.66de6abb.js";import{E as ke}from"./EntityLink.bf1b7a1c.js";import{S as dn}from"./GenericCard.41c62676.js";import{N as cn,I as Ge}from"./SynapseTableConstants.07ecdebd.js";import{n as un}from"./uniq.202ea839.js";import{C as pn}from"./Checkbox.85bb9cd4.js";import{S as hn,N as mn}from"./SearchResultsNotFound.263a233e.js";import{a as G}from"./objectWithoutPropertiesLoose.090b3c10.js";import{_ as He}from"./objectWithoutProperties.07f8cd75.js";import{w as it,e as z,a as Ve,b as Ie}from"./withStyles.670aaa99.js";import{_ as P}from"./toConsumableArray.8f496188.js";import{_ as fn}from"./slicedToArray.e9a7fa03.js";import{u as yn}from"./useTheme.05af6e65.js";import{B as gn}from"./ButtonBase.86e584b9.js";import{h as Sn}from"./moment.53181859.js";import{f as Cn}from"./DateFormatter.ca47405e.js";const bn=window.React;var wn=J(bn.createElement("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function vn(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=h.boundaryCount,a=t===void 0?1:t,n=h.componentName,i=n===void 0?"usePagination":n,l=h.count,d=l===void 0?1:l,p=h.defaultPage,C=p===void 0?1:p,f=h.disabled,R=f===void 0?!1:f,u=h.hideNextButton,g=u===void 0?!1:u,v=h.hidePrevButton,I=v===void 0?!1:v,m=h.onChange,T=h.page,s=h.showFirstButton,q=s===void 0?!1:s,r=h.showLastButton,e=r===void 0?!1:r,c=h.siblingCount,y=c===void 0?1:c,S=He(h,["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"]),w=zt({controlled:T,default:C,name:i,state:"page"}),b=fn(w,2),E=b[0],L=b[1],A=function(V,B){T||L(B),m&&m(V,B)},N=function(V,B){var ct=B-V+1;return Array.from({length:ct},function(go,ut){return V+ut})},D=N(1,Math.min(a,d)),F=N(Math.max(d-a+1,a+1),d),Z=Math.max(Math.min(E-y,d-a-y*2-1),a+2),ee=Math.min(Math.max(E+y,a+y*2+2),F[0]-2),ve=[].concat(P(q?["first"]:[]),P(I?[]:["previous"]),P(D),P(Z>a+2?["start-ellipsis"]:a+1<d-a?[a+1]:[]),P(N(Z,ee)),P(ee<d-a-1?["end-ellipsis"]:d-a>a?[d-a]:[]),P(F),P(g?[]:["next"]),P(e?["last"]:[])),Te=function(V){switch(V){case"first":return 1;case"previous":return E-1;case"next":return E+1;case"last":return d;default:return null}},Re=ve.map(function(O){return typeof O=="number"?{onClick:function(B){A(B,O)},type:"page",page:O,selected:O===E,disabled:R,"aria-current":O===E?"true":void 0}:{onClick:function(B){A(B,Te(O))},type:O,page:Te(O),selected:!1,disabled:R||O.indexOf("ellipsis")===-1&&(O==="next"||O==="last"?E>=d:E<=1)}});return G({items:Re},S)}const Tn=window.React;var We=J(Tn.createElement("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"}));const Rn=window.React;var Ye=J(Rn.createElement("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"}));const In=window.React;var Ke=J(In.createElement("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}));const _n=window.React;var Xe=J(_n.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}));const ne=window.React;var En=function(t){return{root:G({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:t.palette.text.primary}),page:{transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:t.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},"&$focusVisible":{backgroundColor:t.palette.action.focus},"&$selected":{backgroundColor:t.palette.action.selected,"&:hover, &$focusVisible":{backgroundColor:z(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:1,color:t.palette.action.disabled,backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:t.palette.action.disabledOpacity}},sizeSmall:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px","& $icon":{fontSize:t.typography.pxToRem(18)}},sizeLarge:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15),"& $icon":{fontSize:t.typography.pxToRem(22)}},textPrimary:{"&$selected":{color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.primary.dark,"@media (hover: none)":{backgroundColor:t.palette.primary.main}},"&$disabled":{color:t.palette.action.disabled}}},textSecondary:{"&$selected":{color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.secondary.dark,"@media (hover: none)":{backgroundColor:t.palette.secondary.main}},"&$disabled":{color:t.palette.action.disabled}}},outlined:{border:"1px solid ".concat(t.palette.type==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$selected":{"&$disabled":{border:"1px solid ".concat(t.palette.action.disabledBackground)}}},outlinedPrimary:{"&$selected":{color:t.palette.primary.main,border:"1px solid ".concat(z(t.palette.primary.main,.5)),backgroundColor:z(t.palette.primary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:z(t.palette.primary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},outlinedSecondary:{"&$selected":{color:t.palette.secondary.main,border:"1px solid ".concat(z(t.palette.secondary.main,.5)),backgroundColor:z(t.palette.secondary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:z(t.palette.secondary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},rounded:{borderRadius:t.shape.borderRadius},ellipsis:{height:"auto","&$disabled":{opacity:t.palette.action.disabledOpacity}},focusVisible:{},disabled:{},selected:{},icon:{fontSize:t.typography.pxToRem(20),margin:"0 -8px"}}},Ln=ne.forwardRef(function(t,a){var n=t.classes,i=t.className,l=t.color,d=l===void 0?"standard":l,p=t.component,C=t.disabled,f=C===void 0?!1:C,R=t.page,u=t.selected,g=u===void 0?!1:u,v=t.shape,I=v===void 0?"round":v,m=t.size,T=m===void 0?"medium":m,s=t.type,q=s===void 0?"page":s,r=t.variant,e=r===void 0?"text":r,c=He(t,["classes","className","color","component","disabled","page","selected","shape","size","type","variant"]),y=yn(),S=y.direction==="rtl"?{previous:Xe,next:Ke,last:We,first:Ye}:{previous:Ke,next:Xe,first:We,last:Ye},w=S[q];return q==="start-ellipsis"||q==="end-ellipsis"?ne.createElement("div",{ref:a,className:Ve(n.root,n.ellipsis,f&&n.disabled,T!=="medium"&&n["size".concat(Ie(T))])},"\u2026"):ne.createElement(gn,G({ref:a,component:p,disabled:f,focusVisibleClassName:n.focusVisible,className:Ve(n.root,n.page,n[e],n[I],i,d!=="standard"&&n["".concat(e).concat(Ie(d))],f&&n.disabled,g&&n.selected,T!=="medium"&&n["size".concat(Ie(T))])},c),q==="page"&&R,w?ne.createElement(w,{className:n.icon}):null)}),xn=it(En,{name:"MuiPaginationItem"})(Ln);const X=window.React;var qn={root:{},ul:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}};function Dn(h,t,a){return h==="page"?"".concat(a?"":"Go to ","page ").concat(t):"Go to ".concat(h," page")}var Nn=X.forwardRef(function(t,a){t.boundaryCount;var n=t.classes,i=t.className,l=t.color,d=l===void 0?"standard":l;t.count,t.defaultPage,t.disabled;var p=t.getItemAriaLabel,C=p===void 0?Dn:p;t.hideNextButton,t.hidePrevButton,t.onChange,t.page;var f=t.renderItem,R=f===void 0?function(e){return X.createElement(xn,e)}:f,u=t.shape,g=u===void 0?"round":u;t.showFirstButton,t.showLastButton,t.siblingCount;var v=t.size,I=v===void 0?"medium":v,m=t.variant,T=m===void 0?"text":m,s=He(t,["boundaryCount","classes","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"]),q=vn(G({},t,{componentName:"Pagination"})),r=q.items;return X.createElement("nav",G({"aria-label":"pagination navigation",className:Ve(n.root,i),ref:a},s),X.createElement("ul",{className:n.ul},r.map(function(e,c){return X.createElement("li",{key:c},R(G({},e,{color:d,"aria-label":C(e.type,e.page,e.selected),shape:g,size:I,variant:T})))})))}),On=it(qn,{name:"MuiPagination"})(Nn);const An=window.React.useRef,Fn=window.React.useState,_e=3,Ee=({helpMessage:h="This search bar is powered by MySQL Full Text Search.",helpUrl:t})=>{const{executeQueryRequest:a,getLastQueryRequest:n}=H(),{topLevelControlsState:{showSearchBar:i,showFacetFilter:l}}=ge(),[d,p]=Fn(""),C=An(null),f=u=>{var g;if(u.preventDefault(),d.trim().length<_e)(g=C.current)==null||g.setCustomValidity(`Search term must have a minimum of ${_e} characters`);else{const v=n(),{additionalFilters:I=[]}=v.query,m={concreteType:"org.sagebionetworks.repo.model.table.TextMatchesQueryFilter",searchExpression:d};if(I.find(s=>s.concreteType==m.concreteType&&s.searchExpression==m.searchExpression))return;I.push(m),v.query.additionalFilters=I,a(v),p("")}},R=u=>{var g;(g=C.current)==null||g.setCustomValidity(""),p(u.currentTarget.value)};return o("div",{className:`QueryWrapperSearchInput ${l?Se:Ce}`,children:o(Me,{in:i,timeout:{enter:300,exit:300},children:_("div",{className:"QueryWrapperSearchInput__helppopoverwrapper",children:[_("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:f,children:[o("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:o($,{options:{icon:"search"}})}),o("input",{ref:C,minLength:_e,onChange:R,placeholder:"Enter Search Terms",value:d,type:"text"}),d.length>0&&o("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{p("")},children:o($,{options:{icon:"close"}})})]}),o("div",{className:"QueryWrapperSearchInput__helppopover",children:o(Be,{markdownText:h,helpUrl:t,placement:"left"})})]})})})};try{Ee.displayName="FullTextSearch",Ee.__docgenInfo={description:"",displayName:"FullTextSearch",props:{helpMessage:{defaultValue:{value:"This search bar is powered by MySQL Full Text Search."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:null,description:"",name:"helpUrl",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/FullTextSearch.tsx#FullTextSearch"]={docgenInfo:Ee.__docgenInfo,name:"FullTextSearch",path:"src/lib/containers/FullTextSearch.tsx#FullTextSearch"})}catch{}const Pe="First line is the columns names.",$e="Include row metadata (Row Id and Row Version).",ye="Comma Separated Values (CSV)",je="Tab Separated Values (TSV)",kn={title:"Download query results",type:"object",properties:{"File Type":{type:"string",oneOf:[{const:ye,title:ye},{const:je,title:je}]},Contents:{type:"array",title:"Contents",items:{type:"string",enum:[Pe,$e]},uniqueItems:!0}}},Vn={"File Type":{"ui:widget":"radio"},Contents:{"ui:widget":"checkboxes"}},Pn={title:"Download query results",description:"File is ready for download. Select the download button to download the file.",type:"object"},$n={},Bn=[kn,Pn],Mn=[Vn,$n],zn=window.React,Qn=window.JSONSchemaForm;class W extends zn.Component{constructor(t){super(t),this.handleSubmit=a=>{this.state.step===0?this.handleDownloadSetup(a):this.onDownload()},this.handleDownloadSetup=a=>{this.setState({isLoading:!0});const{formData:n}=a,i=n["File Type"],l=n.Contents,{queryBundleRequest:d,getLastQueryRequest:p}=this.props,C=i===ye?",":"	",f=l.includes(Pe),R=l.includes($e),u=d!=null?d:p(),g=u.query.sql,v={sql:g,entityId:an(g),selectedFacets:u.query.selectedFacets,concreteType:"org.sagebionetworks.repo.model.table.DownloadFromTableRequest",writeHeader:f,includeRowIdAndRowVersion:R,csvTableDescriptor:{separator:C},additionalFilters:u.query.additionalFilters};vt(v,this.context.accessToken).then(I=>{this.setState({isLoading:!1,step:1,data:I})}).catch(I=>{console.log("Error getDownloadFromTableRequest: ",I)})},this.onDownload=()=>{const{data:a}=this.state;Tt(a.resultsFileHandleId,this.context.accessToken).then(n=>{window.location.href=n,this.props.onClose()})},this.handleChange=a=>{const{formData:n}=a;this.setState({formData:n})},this.state={isLoading:!1,step:0,formData:{"File Type":ye,Contents:[Pe,$e]}}}render(){const t={position:"absolute",top:10,right:10,zIndex:10},a={height:50,width:50,backgroundSize:50};return o(Q,{animation:!1,show:!0,onHide:this.props.onClose,backdrop:"static",children:_(Q.Body,{children:[o("button",{style:t,onClick:this.props.onClose,children:o($,{options:{icon:"close"}})}),_(Qn,{schema:Bn[this.state.step],uiSchema:Mn[this.state.step],onChange:this.handleChange,formData:this.state.formData,onSubmit:this.handleSubmit,children:[this.state.isLoading&&o("div",{className:"SRC-centerAndJustifyContent",children:_("div",{className:"SRC-center-text",children:[o("p",{children:" Creating the File "}),o("div",{style:a,className:"spinner"}),o("p",{children:" Loading... "})]})}),_("div",{style:{textAlign:"right"},children:[o(fe,{variant:"default",onClick:this.props.onClose,style:{marginRight:"5px"},children:"Cancel"}),o(fe,{type:"submit",variant:"primary",children:this.state.step===0?"Next":"Download"})]})]})]})})}}W.contextType=Rt;try{W.displayName="ModalDownload",W.__docgenInfo={description:"",displayName:"ModalDownload",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(...args: any[]) => void"}},includeEntityEtag:{defaultValue:null,description:"",name:"includeEntityEtag",required:!1,type:{name:"boolean"}},queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!1,type:{name:"QueryBundleRequest"}},getLastQueryRequest:{defaultValue:null,description:"",name:"getLastQueryRequest",required:!1,type:{name:"(() => QueryBundleRequest)"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}},limit:{defaultValue:null,description:"",name:"limit",required:!1,type:{name:"number"}},sort:{defaultValue:null,description:"",name:"sort",required:!1,type:{name:"SortItem[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/ModalDownload.tsx#ModalDownload"]={docgenInfo:W.__docgenInfo,name:"ModalDownload",path:"src/lib/containers/ModalDownload.tsx#ModalDownload"})}catch{}const Le=window.React;class xe extends Le.Component{constructor(t){var a;super(t),this.handleClickOutsideForm=n=>{var i,l;!((i=this.searchFormRef.current)!=null&&i.contains(n==null?void 0:n.target))&&!((l=this.radioFormRef.current)!=null&&l.contains(n==null?void 0:n.target))&&(this.state.didUpdateRanLast?this.setState({didUpdateRanLast:!1}):this.setState({show:!1}))},this.search=n=>{var v,I,m,T,s,q,r;n.preventDefault();const{searchText:i}=this.state;let{columnName:l}=this.state;const{searchable:d,lockedFacet:p}=this.props;if(l==="")if(d)l=d.filter(e=>e!==(p==null?void 0:p.facet))[0];else{const e=(m=(I=(v=this.props.queryContext)==null?void 0:v.data)==null?void 0:I.columnModels)==null?void 0:m.filter(c=>c.name!==(p==null?void 0:p.facet)).filter(c=>this.isSupportedColumn(c));l=(T=e==null?void 0:e[0].name)!=null?T:""}this.setState({show:!1});const{executeQueryRequest:C,getLastQueryRequest:f}=this.props.queryContext,R=f(),{additionalFilters:u=[]}=R.query,g=u.findIndex(e=>!!(pt(e)||ht(e)&&e.columnName===l));if(g===-1){const e=(r=(q=(s=this.props.queryContext)==null?void 0:s.data)==null?void 0:q.columnModels)==null?void 0:r.filter(c=>c.name===l)[0];if(e!=null&&e.columnType.endsWith("_LIST")){const c={columnName:l,function:mt.HAS_LIKE,values:[`%${i}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnMultiValueFunctionQueryFilter"};u.push(c)}else{const c={columnName:l,operator:ft.LIKE,values:[`%${i}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};u.push(c)}}else u[g].values.push(`%${i}%`);R.query.additionalFilters=u,C(R)},this.handleChange=n=>{this.setState({searchText:n.currentTarget.value})},this.isSupportedColumn=n=>{switch(n==null?void 0:n.columnType){case x.FILEHANDLEID:case x.ENTITYID:case x.DATE:case x.DATE_LIST:case x.USERID:return!1;default:return!0}},this.isSupportedColumnAndInProps=n=>{if(this.isSupportedColumn(n)){const{searchable:i}=this.props;return i==null?void 0:i.some(l=>l===(n==null?void 0:n.name))}return!1},this.state={show:!1,didUpdateRanLast:!1,searchText:"",columnName:(a=this.props.defaultColumn)!=null?a:""},this.searchFormRef=Le.createRef(),this.radioFormRef=Le.createRef()}componentDidMount(){document.addEventListener("click",this.handleClickOutsideForm)}componentDidUpdate(t){var a,n,i,l,d;!((a=t.queryVisualizationContext)!=null&&a.topLevelControlsState.showSearchBar)&&((n=this.props.queryVisualizationContext)==null?void 0:n.topLevelControlsState.showSearchBar)&&(this.setState({show:!0,didUpdateRanLast:!0}),(d=(l=(i=this.searchFormRef)==null?void 0:i.current)==null?void 0:l.querySelector("input"))==null||d.focus())}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutsideForm)}render(){var u;const{searchable:t,lockedFacet:a,queryContext:{data:n},queryVisualizationContext:{topLevelControlsState:i,facetAliases:l}}=this.props,{searchText:d,show:p,columnName:C}=this.state;let f=[];t?f=t.map(g=>{var v;return(v=n==null?void 0:n.columnModels)==null?void 0:v.find(I=>I.name===g)}).filter(this.isSupportedColumnAndInProps).map(g=>g.name):n!=null&&n.columnModels&&(f=(u=n.columnModels)==null?void 0:u.filter(this.isSupportedColumn).map(g=>g.name)),f.length&&(a==null?void 0:a.facet)&&(f=f.filter(g=>g!==(a==null?void 0:a.facet)));const R=i==null?void 0:i.showFacetFilter;return _("div",{className:`QueryWrapperSearchInput ${R?Se:Ce}`,children:[o(Me,{in:i==null?void 0:i.showSearchBar,children:_("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:this.search,onClick:()=>{this.setState({show:!0})},ref:this.searchFormRef,children:[o("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:o($,{options:{icon:"search"}})}),o("input",{onChange:this.handleChange,onClick:()=>{this.setState({show:!0})},placeholder:"Enter Search Terms",value:d,type:"text"}),this.state.searchText.length>0&&o("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{this.setState({searchText:""})},children:o($,{options:{icon:"close"}})})]})}),o("div",{className:"QueryWrapperSearchInput__dropdown_pos",children:o(wt,{in:p,classNames:"QueryWrapperSearchInput__animate_dropdown",timeout:{enter:0,exit:300},children:_("form",{ref:this.radioFormRef,className:"QueryWrapperSearchInput__column-select QueryWrapperSearchInput__animate_height",children:[o("p",{className:"deemphasized",children:o("i",{children:" Search In Field: "})}),f.map((g,v)=>{const I=ze(g,l);return o("div",{className:"radio",children:o("label",{children:_("span",{children:[o("input",{id:g,type:"radio",value:g,checked:C===""&&v===0||C===g,onClick:()=>{var T,s,q;(q=(s=(T=this.searchFormRef)==null?void 0:T.current)==null?void 0:s.querySelector("input"))==null||q.focus(),this.setState({columnName:g})}}),o("span",{children:I})]})})},`search-field-${g}-${v}`)})]})})})]})}}try{xe.displayName="Search",xe.__docgenInfo={description:"",displayName:"Search",props:{queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},isQueryWrapperMenuChild:{defaultValue:null,description:"",name:"isQueryWrapperMenuChild",required:!1,type:{name:"boolean"}},defaultColumn:{defaultValue:null,description:"",name:"defaultColumn",required:!1,type:{name:"string"}},searchable:{defaultValue:null,description:"",name:"searchable",required:!1,type:{name:"SearchableColumnsV2"}},lockedFacet:{defaultValue:null,description:"",name:"lockedFacet",required:!1,type:{name:"LockedFacet"}},fullTextSearchHelpURL:{defaultValue:null,description:"",name:"fullTextSearchHelpURL",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/SearchV2.tsx#Search"]={docgenInfo:xe.__docgenInfo,name:"Search",path:"src/lib/containers/SearchV2.tsx#Search"})}catch{}const Hn=window.React.useEffect,Un=window.React.useRef,Gn=window.React.useState,Wn="The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients.",Yn="https://help.synapse.org/docs/Searching-Tables-and-Views.2009596168.html#SearchingTablesandViews-UsingAdvancedSearchQueries",qe=({helpMessage:h=Wn,helpUrl:t=Yn})=>{const{executeQueryRequest:a,getLastQueryRequest:n}=H(),{topLevelControlsState:{showSqlEditor:i,showFacetFilter:l}}=ge(),[d,p]=Gn(""),C=Un(null);Hn(()=>{var u;if(i){const g=n().query.sql;p(g),(u=C.current)==null||u.focus()}},[i,n]);const f=u=>{u.preventDefault();const g=n();g.query.sql=d,g.query.offset=0,g.query.additionalFilters=[],g.query.selectedFacets=[],a(g)},R=u=>{var g;(g=C.current)==null||g.setCustomValidity(""),p(u.currentTarget.value)};return o("div",{className:`QueryWrapperSqlEditorInput ${l?Se:Ce}`,children:o(Me,{in:i,timeout:{enter:300,exit:300},children:_("div",{className:"QueryWrapperSqlEditorInput__helppopoverwrapper",children:[_("form",{className:"QueryWrapperSqlEditorInput__searchbar",onSubmit:f,children:[o(bt,{className:"QueryWrapperSqlEditorInput__searchbar__searchicon"}),o("input",{ref:C,onChange:R,placeholder:"Enter Query",value:d,type:"text"})]}),o("div",{className:"QueryWrapperSqlEditorInput__helppopover",children:o(Be,{markdownText:h,helpUrl:t,placement:"right"})})]})})})};try{qe.displayName="SqlEditor",qe.__docgenInfo={description:"",displayName:"SqlEditor",props:{helpMessage:{defaultValue:{value:"The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:{value:"https://help.synapse.org/docs/Searching-Tables-and-Views.2009596168.html#SearchingTablesandViews-UsingAdvancedSearchQueries"},description:"",name:"helpUrl",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/SqlEditor.tsx#SqlEditor"]={docgenInfo:qe.__docgenInfo,name:"SqlEditor",path:"src/lib/containers/SqlEditor.tsx#SqlEditor"})}catch{}const ae=h=>_(Q,{animation:!1,show:!0,onHide:()=>h.onHide(),backdrop:"static",children:[o(Q.Header,{closeButton:!0,children:o("span",{style:{fontWeight:"bold",color:"#515359",fontSize:"1.5em"},children:"Sign In Required"})}),_(Qt,{children:[o("p",{children:"Anyone can browse public content on the Synapse website, but in order to download and create content you will need to register for an account using an email address."}),_("p",{children:["To find out more see\xA0",o("a",{href:"https://help.synapse.org/docs/Managing-your-account.2055405596.html",target:"_blank",rel:"noopener noreferrer",children:"User Accounts"}),o("span",{children:" and "}),o("a",{href:"https://help.synapse.org/docs/Governance-Overview.2009597114.html",rel:"noopener noreferrer",target:"_blank",children:"Governance Overview"}),"."]})]}),_(Ht,{children:[o(fe,{variant:"secondary",onClick:()=>h.onHide(),children:"CANCEL"}),o(fe,{className:"SRC-SIGN-IN-CLASS",variant:"primary",onClick:()=>h.onHide(),children:"Sign in"})]})]});try{ae.displayName="DownloadLoginModal",ae.__docgenInfo={description:"",displayName:"DownloadLoginModal",props:{showModal:{defaultValue:null,description:"",name:"showModal",required:!1,type:{name:"boolean"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/DownloadLoginModal.tsx#DownloadLoginModal"]={docgenInfo:ae.__docgenInfo,name:"DownloadLoginModal",path:"src/lib/containers/table/table-top/DownloadLoginModal.tsx#DownloadLoginModal"})}catch{}const Je=window.React.useMemo,Kn=window.React.useState;function re({queryBundleRequest:h,queryResultBundle:t,onHide:a}){const[n,i]=Kn("");Ut(()=>{(async()=>{const{query:C}=h,{sql:f,selectedFacets:R=[]}=C,{columnModels:u}=t;u||console.error("Column Models must be included to complete transform sql request");const g={concreteType:"org.sagebionetworks.repo.model.table.TransformSqlWithFacetsRequest",sqlToTransform:f,selectedFacets:R,schema:u};try{const v=await It(g),I=v.transformedSql.toUpperCase().indexOf("FROM SYN"),m=`SELECT * ${v.transformedSql.substring(I)}`;i(m)}catch(v){console.error("Error on getTransformSqlWithFacetsRequest ",v)}})()},[h,t]);const l=Je(()=>n.replace(/(["`])/g,"\\$1"),[n]),d=Je(()=>n.replace(/"/g,'\\"'),[n]);return o(Gt,{show:!0,onClose:a,title:"Download Programmatically",cliNotes:o(k,{children:"This command line code will download Synapse files AND file annotations to your working directory."}),cliCode:`synapse get -q "${l}"`,rNotes:_(k,{children:["This R code will download file annotations only. Use"," ",_("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:["synGet","()"]})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),rCode:`query <- synTableQuery("${d}")
read.table(query$filepath, sep = ",")`,pythonNotes:_(k,{children:["This Python code will download file annotations only. Use"," ",o("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:"syn.get"})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),pythonCode:`query = syn.tableQuery("${d}")
query.asDataFrame()`})}try{re.displayName="ProgrammaticOptions",re.__docgenInfo={description:"",displayName:"ProgrammaticOptions",props:{queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!0,type:{name:"QueryBundleRequest"}},queryResultBundle:{defaultValue:null,description:"",name:"queryResultBundle",required:!0,type:{name:"QueryResultBundle"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/ProgrammaticTableDownload.tsx#ProgrammaticOptions"]={docgenInfo:re.__docgenInfo,name:"ProgrammaticOptions",path:"src/lib/containers/table/table-top/ProgrammaticTableDownload.tsx#ProgrammaticOptions"})}catch{}const oe=window.React,Xn="Add To Download Cart",jn="download",se=h=>{const{accessToken:t}=K(),{entity:a,data:n,getLastQueryRequest:i}=H(),l=i(),[d,p]=oe.useState(!1),[C,f]=oe.useState(!1),[R,u]=oe.useState(!1),{onDownloadFiles:g,darkTheme:v=!0}=h,I=a&&(U(a)&&Bt(a)||Y(a)),m=a&&Y(a)&&a.isLatestVersion;return _(oe.Fragment,{children:[_(M,{as:"span",children:[o(be,{idForToolTip:jn,tooltipText:"Download Options",size:"lg",darkTheme:v,icon:"download"}),_(M.Menu,{className:"SRC-primary-color-hover-dropdown",alignRight:!0,children:[o(M.Item,{onClick:()=>{f(!0)},children:"Export Table"}),I&&o(Ae,{title:"A draft version of a dataset cannot be added to the Download Cart",placement:"left",enterNextDelay:300,disableHoverListener:!m,children:o(M.Item,{className:m?"ignoreLink":void 0,disabled:m,style:m?{pointerEvents:"auto"}:{},onClick:()=>t?g():p(!0),children:Xn})}),o(Ae,{title:"A draft version of a dataset cannot be downloaded programmatically",placement:"left",enterNextDelay:300,disableHoverListener:!m,children:o(M.Item,{className:m?"ignoreLink":void 0,disabled:m,style:m?{pointerEvents:"auto"}:{},onClick:()=>u(!0),children:"Programmatic Options"})})]})]}),d&&o(ae,{showModal:d,onHide:()=>p(!1)}),C&&o(W,{onClose:()=>f(!1),queryBundleRequest:l}),R&&n&&o(re,{onHide:()=>u(!1),queryBundleRequest:l,queryResultBundle:n})]})};try{se.displayName="DownloadOptions",se.__docgenInfo={description:"",displayName:"DownloadOptions",props:{onDownloadFiles:{defaultValue:null,description:"",name:"onDownloadFiles",required:!0,type:{name:"() => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/DownloadOptions.tsx#DownloadOptions"]={docgenInfo:se.__docgenInfo,name:"DownloadOptions",path:"src/lib/containers/table/table-top/DownloadOptions.tsx#DownloadOptions"})}catch{}const Jn=window.React.useState,Ze="addAndRemoveColumns",ie=h=>{const{headers:t,isColumnSelected:a,toggleColumnSelection:n,darkTheme:i,facetAliases:l}=h,[d,p]=Jn(!1),C=(f,R,u)=>{u.source==="rootClose"?p(!1):p(!0)};return _(M,{as:"span",onToggle:(f,R,u)=>C(f,R,u),show:d,drop:"down",children:[o(be,{idForToolTip:Ze,tooltipText:"Show/Hide Columns",icon:i?"columnsdark":"columns",darkTheme:i}),o(M.Menu,{id:`${Ze}-dropdown`,className:"SRC-primary-color-hover-dropdown",alignRight:!0,children:t==null?void 0:t.map(f=>{const{name:R}=f,u=a.includes(R),g={width:"11px",marginRight:"10px",visibility:u?void 0:"hidden"},v=u?"SRC-primary-text-color":"";return _(M.Item,{onClick:()=>n(R),children:[o("span",{className:v,style:g,children:o($,{options:{icon:"check",size:"14px"}})}),ze(R,l)]},R)})})]})};try{ie.displayName="ColumnSelection",ie.__docgenInfo={description:"",displayName:"ColumnSelection",props:{headers:{defaultValue:null,description:"",name:"headers",required:!1,type:{name:"SelectColumn[]"}},isColumnSelected:{defaultValue:null,description:"",name:"isColumnSelected",required:!0,type:{name:"string[]"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(() => void)"}},toggleColumnSelection:{defaultValue:null,description:"",name:"toggleColumnSelection",required:!0,type:{name:"(name: string) => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}},facetAliases:{defaultValue:null,description:"",name:"facetAliases",required:!1,type:{name:"Record<string, string>"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/ColumnSelection.tsx#ColumnSelection"]={docgenInfo:ie.__docgenInfo,name:"ColumnSelection",path:"src/lib/containers/table/table-top/ColumnSelection.tsx#ColumnSelection"})}catch{}const Zn="Files may be unavailable because you do not have permission to see them, they have been deleted, or the Dataset has been misconfigured.",eo="Files may be unavailable because you do not have permission to see them or the Dataset was misconfigured.",le=({entity:h})=>{var i,l;const t=h&&Y(h),a={concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",query:{sql:`SELECT * FROM ${h.id}${!h.isLatestVersion&&h.versionNumber?`.${h.versionNumber}`:""}`},entityId:h.id,partMask:_t},{data:n}=Et(a,{enabled:t});if(t&&n&&h){const d=n.queryCount,p=(l=(i=h.items)==null?void 0:i.length)!=null?l:0;if(d===p)return o(k,{});const C=p-d;let f="";return h.isLatestVersion?f=Zn:f=eo,_(we,{className:"SRC-centerContent",style:{marginLeft:10},variant:"smallText1",color:"textSecondary",children:[o(wn,{className:"SRC-color-warning",style:{fontSize:"16px"}}),C.toLocaleString()+" Unavailable",o(Be,{className:"SRC-margin-left-5",markdownText:f,placement:"right"})]})}else return o(k,{})};try{le.displayName="MissingQueryResultsWarning",le.__docgenInfo={description:`If possible, this component will render a warning message if results may be missing from the query due to user permissions or
entities being deleted. If not possible, it will render an empty fragment.`,displayName:"MissingQueryResultsWarning",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Table"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/MissingQueryResultsWarning.tsx#MissingQueryResultsWarning"]={docgenInfo:le.__docgenInfo,name:"MissingQueryResultsWarning",path:"src/lib/containers/MissingQueryResultsWarning.tsx#MissingQueryResultsWarning"})}catch{}const to=window.React,no=[{icon:"search",key:"showSearchBar",tooltipText:"Show / Hide Search Bar"},{icon:"chart",key:"showFacetVisualization",tooltipText:"Show / Hide Visualizations"},{icon:"download",key:"showDownloadConfirmation",tooltipText:"Show options for download"},{icon:Lt,key:"showSqlEditor",tooltipText:"Show / Hide the Advanced Query Editor"}],De=h=>{const{name:t,showColumnSelection:a=!1,hideDownload:n=!1,hideVisualizationsControl:i=!1,hideFacetFilterControl:l=!1,hideQueryCount:d=!1,hideSqlEditorControl:p=!0,customControls:C}=h,{data:f,entity:R,executeQueryRequest:u,getLastQueryRequest:g,getInitQueryRequest:v}=H(),{topLevelControlsState:I,setTopLevelControlsState:m,columnsToShowInTable:T,selectedRowIndices:s,facetAliases:q,setColumnsToShowInTable:r}=ge(),e=w=>{const b={[w]:!I[w]};w==="showSearchBar"&&(b.showDownloadConfirmation=!1),w==="showDownloadConfirmation"&&(b.showSearchBar=!1),m(E=>({...E,...b}))},c=()=>{u(g())},y=w=>{let b=j(T);b.includes(w)?b=b.filter(E=>E!==w):b.push(w),r(b)},S=I==null?void 0:I.showFacetFilter;return o("div",{className:`TopLevelControls ${S?Se:Ce}`,"data-testid":"TopLevelControls",children:_("div",{children:[_("div",{className:"TopLevelControls__querycount",children:[t&&_(k,{children:[_(we,{variant:"sectionTitle",role:"heading",children:[t," ",!d&&o(Wt,{sql:v().query.sql,parens:!0})]}),!d&&R&&o(le,{entity:R})]}),!l&&_("a",{onClick:()=>e("showFacetFilter"),className:"TopLevelControls__querycount__facetFilterLink",children:[o(rt,{type:I.showFacetFilter?"close":"filter"}),_("span",{className:"TopLevelControls__querycount__facetFilterLink__text",children:[I.showFacetFilter?"Hide":"Show"," Facet Menu"]})]})]}),_("div",{className:"TopLevelControls__actions",children:[C&&C.map(w=>{var b;return _("button",{className:`btn SRC-roundBorder SRC-primary-background-color SRC-whiteText ${(b=w.classNames)!=null?b:""}`,style:{marginRight:"5px"},type:"button",onClick:()=>w.onClick({data:f,selectedRowIndices:s,refresh:c}),children:[w.icon,"\xA0",w.buttonText]},w.buttonText)}),no.map(w=>{const{key:b,icon:E,tooltipText:L}=w;return b==="showDownloadConfirmation"&&n||b==="showFacetVisualization"&&i||b==="showSqlEditor"&&p?o(to.Fragment,{},b):b==="showDownloadConfirmation"?o(se,{darkTheme:!0,onDownloadFiles:()=>e(b)},b):o(be,{idForToolTip:b,tooltipText:L,callbackFn:()=>e(b),darkTheme:!0,icon:E},b)}),a&&o(ie,{headers:f==null?void 0:f.selectColumns,isColumnSelected:T,toggleColumnSelection:y,darkTheme:!0,facetAliases:q})]})]})})};try{De.displayName="TopLevelControls",De.__docgenInfo={description:"",displayName:"TopLevelControls",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},hideVisualizationsControl:{defaultValue:null,description:"",name:"hideVisualizationsControl",required:!1,type:{name:"boolean"}},hideFacetFilterControl:{defaultValue:null,description:"",name:"hideFacetFilterControl",required:!1,type:{name:"boolean"}},hideQueryCount:{defaultValue:null,description:"",name:"hideQueryCount",required:!1,type:{name:"boolean"}},hideSqlEditorControl:{defaultValue:null,description:"",name:"hideSqlEditorControl",required:!1,type:{name:"boolean"}},showColumnSelection:{defaultValue:null,description:"",name:"showColumnSelection",required:!1,type:{name:"boolean"}},customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/TopLevelControls.tsx#TopLevelControls"]={docgenInfo:De.__docgenInfo,name:"TopLevelControls",path:"src/lib/containers/table/TopLevelControls.tsx#TopLevelControls"})}catch{}var lt={exports:{}};(function(h,t){(function(n,i){h.exports=i()})(Yt,function(){return(()=>{var a={67:(l,d,p)=>{p.r(d),p.d(d,{default:()=>I});var C=p(887),f=p.n(C);function R(m,T){if(!(m instanceof T))throw new TypeError("Cannot call a class as a function")}function u(m,T,s){return T in m?Object.defineProperty(m,T,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[T]=s,m}var g,v=(g=0,function(){return g++}),I=function m(T){var s=this,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};R(this,m),u(this,"ID","id"),u(this,"PX","px"),u(this,"RESIZABLE","grip-resizable"),u(this,"FLEX","grip-flex"),u(this,"legacyIE",navigator.userAgent.indexOf("Trident/4.0")>0),u(this,"reset",function(r){return s.init(r)}),u(this,"onResize",function(){var r=s.tb;if(r.classList.remove(s.RESIZABLE),r.opt.fixed){r.tableWidth=Number(window.getComputedStyle(r).width.replace(/px/,"")).valueOf();for(var e=0,c=0;c<r.columnCnt;c++)e+=r.columns[c].w;for(var y=0;y<r.columnCnt;y++)r.columns[y].style.width=Math.round(1e3*r.columns[y].w/e)/10+"%",r.columns[y].locked=!0}else s.applyBounds(),r.opt.resizeMode==="flex"&&r.opt.serialize&&s.serializeStore();r.classList.add(s.RESIZABLE),s.syncGrips()}),u(this,"onGripMouseDown",function(r){var e=r.target.parentNode.data,c=s.tb,y=c.grips[e.i],S=r.touches;if(y.ox=S?S[0].pageX:r.pageX,y.l=y.offsetLeft,y.x=y.l,s.createStyle(document.querySelector("head"),"*{cursor:"+c.opt.dragCursor+"!important}"),document.addEventListener("touchmove",s.onGripDrag),document.addEventListener("mousemove",s.onGripDrag),document.addEventListener("touchend",s.onGripDragOver),document.addEventListener("mouseup",s.onGripDragOver),y.classList.add(c.opt.draggingClass),s.grip=y,c.columns[e.i].locked)for(var w,b=0;b<c.columnCnt;b++)(w=c.columns[b]).locked=!1,w.w=Number(window.getComputedStyle(w).width.replace(/px/,"")).valueOf();r.preventDefault()}),u(this,"onGripDrag",function(r){var e=s.grip;if(e){var c=e.t,y=r.touches,S=(y?y[0].pageX:r.pageX)-e.ox+e.l,w=c.opt.minWidth,b=e.i,E=1.5*c.cellSpace+w+c.borderSpace,L=b===c.columnCnt-1,A=b?c.grips[b-1].offsetLeft+c.cellSpace+w:E,N=c.opt.fixed?b===c.columnCnt-1?c.tableWidth-E:c.grips[b+1].offsetLeft-c.cellSpace-w:1/0;if(S=Math.max(A,Math.min(N,S)),e.x=S,e.style.left=S+s.PX,L&&(e.w=c.columns[b].w+S-e.l),c.opt.liveDrag){L?(c.columns[b].style.width=e.w+s.PX,!c.opt.fixed&&c.opt.overflow?c.style.minWidth=c.tableWidth+S-e.l+s.PX:c.tableWidth=Number(window.getComputedStyle(c).width.replace(/px/,"")).valueOf()):s.syncCols(c,b,!1,c.opt),s.syncGrips();var D=c.opt.onDrag;D&&D(r)}r.preventDefault()}}),u(this,"onGripDragOver",function(r){var e=s.grip;document.removeEventListener("touchend",s.onGripDragOver),document.removeEventListener("mouseup",s.onGripDragOver),document.removeEventListener("touchmove",s.onGripDrag),document.removeEventListener("mousemove",s.onGripDrag);var c=document.querySelector("head").lastChild;if(c.parentNode.removeChild(c),e){if(e.classList.remove(e.t.opt.draggingClass),e.x-e.l!=0){var y=e.t,S=y.opt.onResize,w=e.i;if(w===y.columnCnt-1){var b=y.columns[w];b.style.width=e.w+s.PX,b.w=e.w}else s.syncCols(y,w,!0,y.opt);y.opt.fixed||s.applyBounds(),s.syncGrips(),S&&S(r),y.opt.serialize&&s.serializeStore()}s.grip=null}}),u(this,"init",function(r){if(r.disable)return s.destroy();var e=s.tb,c=e.getAttribute(s.ID)||s.RESIZABLE+v();if(!e.matches("table")||e.extended&&!r.partialRefresh)return null;var y=document.querySelector("head");if(s.createStyle(y," .grip-resizable{table-layout:fixed;} .grip-resizable > tbody > tr > td, .grip-resizable > tbody > tr > th{overflow:hidden} .grip-padding > tbody > tr > td, .grip-padding > tbody > tr > th{padding-left:0!important; padding-right:0!important;} .grip-container{ height:0px; position:relative;} .grip-handle{margin-left:-5px; position:absolute; z-index:5; } .grip-handle .grip-resizable{position:absolute;background-color:red;filter:alpha(opacity=1);opacity:0;width:10px;height:100%;cursor: col-resize;top:0px} .grip-lastgrip{position:absolute; width:1px; } .grip-drag{ border-left:1px dotted black;	} .grip-flex{width:auto!important;} .grip-handle.grip-disabledgrip .grip-resizable{cursor:default; display:none;}"),r.hoverCursor&&r.hoverCursor!=="col-resize"){var S=".grip-handle .grip-resizable:hover{cursor:"+r.hoverCursor+"!important}";s.createStyle(y,S)}e.setAttribute(s.ID,c);var w=e.opt;e.opt=s.extendOptions(r);var b=s.getTableHeaders(e);if(s.extendTable(b),r.remoteTable&&r.remoteTable.matches("table")){var E=s.getTableHeaders(e.opt.remoteTable);b.length===E.length?s.extendRemoteTable(e.opt.remoteTable,E,e):console.warn("column count for remote table did not match")}return w}),u(this,"applyBounds",function(){var r=s.tb,e=r.columns.map(function(c){return window.getComputedStyle(c).width});r.style.width=window.getComputedStyle(r).width,r.tableWidth=Number(r.style.width.replace(/px/,"")).valueOf(),r.classList.remove(s.FLEX),r.columns.forEach(function(c,y){c.style.width=e[y],c.w=Number(e[y].replace(/px/,"")).valueOf()}),r.classList.add(s.FLEX)}),u(this,"serializeStore",function(){var r=s.store,e=s.tb;r[e.getAttribute(s.ID)]="";for(var c=0,y=0;y<e.columns.length;y++){var S=window.getComputedStyle(e.columns[y]).width.replace(/px/,"");r[e.getAttribute(s.ID)]+=S+";",c+=Number(S).valueOf()}r[e.getAttribute(s.ID)]+=c.toString(),e.opt.fixed||(r[e.getAttribute(s.ID)]+=";"+window.getComputedStyle(e).width.replace(/px/,""))}),u(this,"syncGrips",function(){var r=s.tb;r.gripContainer.style.width=r.tableWidth+s.PX;for(var e=0;e<r.columnCnt;e++){var c=r.columns[e],y=c.getBoundingClientRect(),S=r.getBoundingClientRect();r.grips[e].style.left=y.left-S.left+c.offsetWidth+r.cellSpace/2+s.PX,r.grips[e].style.height=(r.opt.headerOnly?r.columns[0].offsetHeight:r.offsetHeight)+s.PX}}),u(this,"destroy",function(){var r=s.tb,e=r.getAttribute(s.ID);return e?(s.store[e]="",r.classList.remove(s.RESIZABLE),r.classList.remove(s.FLEX),r.remote&&(r.remote.classList.remove(s.RESIZABLE),r.remote.classList.remove(s.FLEX)),r.gripContainer&&r.gripContainer.parentNode&&r.gripContainer.parentNode.removeChild(r.gripContainer),delete r.extended,r.opt):null}),u(this,"createStyle",function(r,e){var c=f()(e).toString(),y=r.querySelectorAll("style");if(!Array.from(y).filter(function(w){return w.gripid===c}).length){var S=document.createElement("style");S.type="text/css",S.gripid=c,S.styleSheet?S.styleSheet.cssText=e:S.appendChild(document.createTextNode(e)),r.appendChild(S)}}),u(this,"extendOptions",function(r){var e=Object.assign({},m.DEFAULTS,r);switch(e.fixed=!0,e.overflow=!1,e.resizeMode){case"flex":e.fixed=!1;break;case"overflow":e.fixed=!1,e.overflow=!0}return e}),u(this,"getTableHeaders",function(r){var e="#"+r.id,c=Array.from(r.querySelectorAll(e+">thead>tr:nth-of-type(1)>th"));return(c=c.concat(Array.from(r.querySelectorAll(e+">thead>tr:nth-of-type(1)>td")))).length||(c=(c=(c=(c=Array.from(r.querySelectorAll(e+">tbody>tr:nth-of-type(1)>th"))).concat(Array.from(r.querySelectorAll(e+">tr:nth-of-type(1)>th")))).concat(Array.from(r.querySelectorAll(e+">tbody>tr:nth-of-type(1)>td")))).concat(Array.from(r.querySelectorAll(e+">tr:nth-of-type(1)>td")))),s.filterInvisible(c,!1)}),u(this,"filterInvisible",function(r,e){return r.filter(function(c){var y=e?-1:c.offsetWidth,S=e?-1:c.offsetHeight;return!(y===0&&S===0||c.style&&c.style.display&&window.getComputedStyle(c).display==="none")})}),u(this,"extendTable",function(r){var e=s.tb;e.opt.removePadding&&e.classList.add("grip-padding"),e.classList.add(s.RESIZABLE),e.insertAdjacentHTML("beforebegin",'<div class="grip-container"/>'),e.grips=[],e.columns=[],e.tableWidth=Number(window.getComputedStyle(e).width.replace(/px/,"")).valueOf(),e.gripContainer=e.previousElementSibling,e.opt.marginLeft&&(e.gripContainer.style.marginLeft=e.opt.marginLeft),e.opt.marginRight&&(e.gripContainer.style.marginRight=e.opt.marginRight),e.cellSpace=parseInt(s.legacyIE?e.cellSpacing||e.currentStyle.borderSpacing:window.getComputedStyle(e).borderSpacing.split(" ")[0].replace(/px/,""))||2,e.borderSpace=parseInt(s.legacyIE?e.border||e.currentStyle.borderLeftWidth:window.getComputedStyle(e).borderLeftWidth.replace(/px/,""))||1,e.extended=!0,s.createGrips(r)}),u(this,"extendRemoteTable",function(r,e,c){c.opt.removePadding&&r.classList.add("grip-padding"),r.classList.add(s.RESIZABLE),r.getAttribute(s.ID)||r.setAttribute(s.ID,c.getAttribute(s.ID)+"remote"),r.columns=[],e.forEach(function(S,w){var b=e[w];b.w=c.columns[w].w,b.style.width=b.w+s.PX,b.removeAttribute("width"),r.columns.push(b)}),r.tableWidth=c.tableWidth,r.cellSpace=c.cellSpace,r.borderSpace=c.borderSpace;var y=Array.from(r.querySelectorAll("col"));r.columnGrp=s.filterInvisible(y,!0),r.columnGrp.forEach(function(S,w){S.removeAttribute("width"),S.style.width=c.columnGrp[w].style.width}),c.remote=r}),u(this,"createGrips",function(r){var e=s.tb;e.columnGrp=s.filterInvisible(Array.from(e.querySelectorAll("col")),!0),e.columnGrp.forEach(function(S){S.removeAttribute("width")}),e.columnCnt=r.length;var c=!1;s.store[e.getAttribute(s.ID)]&&(s.deserializeStore(r),c=!0),e.opt.widths||(e.opt.widths=[]),r.forEach(function(S,w){var b=r[w],E=e.opt.disabledColumns.indexOf(w)!==-1;s.createDiv(e.gripContainer,"grip-handle");var L=e.gripContainer.lastChild;!E&&e.opt.gripInnerHtml&&(L.innerHTML=e.opt.gripInnerHtml),s.createDiv(L,s.RESIZABLE),w===e.columnCnt-1&&(L.classList.add("grip-lastgrip"),e.opt.fixed&&(L.innerHTML="")),L.addEventListener("touchstart",s.onGripMouseDown,{capture:!0,passive:!0}),L.addEventListener("mousedown",s.onGripMouseDown,!0),E?L.classList.add("grip-disabledgrip"):(L.classList.remove("grip-disabledgrip"),L.addEventListener("touchstart",s.onGripMouseDown,{capture:!0,passive:!0}),L.addEventListener("mousedown",s.onGripMouseDown,!0)),L.t=e,L.i=w,e.opt.widths[w]?b.w=e.opt.widths[w]:b.w=c?Number(b.style.width.replace(/px/,"")).valueOf():Number(window.getComputedStyle(b).width.replace(/px/,"")).valueOf(),b.style.width=b.w+s.PX,b.removeAttribute("width"),L.data={i:w,t:e.getAttribute(s.ID),last:w===e.columnCnt-1},e.grips.push(L),e.columns.push(b)});var y=Array.from(e.querySelectorAll("td"));y.concat(Array.from(e.querySelectorAll("th"))),(y=(y=y.filter(function(S){for(var w=0;w<r.length;w++)if(r[w]===S)return!1;return!0})).filter(function(S){return!(S.querySelectorAll("table th").length||S.querySelectorAll("table td").length)})).forEach(function(S){S.removeAttribute("width")}),e.opt.fixed||(e.removeAttribute("width"),e.classList.add(s.FLEX)),s.syncGrips()}),u(this,"deserializeStore",function(r){var e=s.tb;if(e.columnGrp.forEach(function(w){w.removeAttribute("width")}),e.opt.flush)s.store[e.getAttribute(s.ID)]="";else{var c=s.store[e.getAttribute(s.ID)].split(";"),y=c[e.columnCnt+1];!e.opt.fixed&&y&&(e.style.width=y+s.PX,e.opt.overflow&&(e.style.minWidth=y+s.PX,e.tableWidth=Number(y).valueOf()));for(var S=0;S<e.columnCnt;S++)r[S].style.width=c[S]+s.PX,e.columnGrp[S]&&(e.columnGrp[S].style.width=100*Number(c[S]).valueOf()/Number(c[e.columnCnt]).valueOf()+"%")}}),u(this,"createDiv",function(r,e,c){var y=document.createElement("div");y.classList.add(e),c&&(y.innerHTML=c),r.appendChild(y)}),u(this,"syncCols",function(r,e,c,y){var S=r.remote,w=s.grip.x-s.grip.l,b=r.columns[e],E=r.columns[e+1];if(b&&E){var L=b.w+w,A=E.w-w,N=L+s.PX;if(b.style.width=N,r.columnGrp[e]&&r.columnGrp[e].style.width&&(r.columnGrp[e].style.width=N),S&&(S.columns[e].style.width=N,S.columnGrp[e]&&S.columnGrp[e].style.width&&(S.columnGrp[e].style.width=N)),y.fixed){var D=A+s.PX;E.style.width=D,r.columnGrp[e+1]&&r.columnGrp[e+1].style.width&&(r.columnGrp[e+1].style.width=D),S&&(S.columns[e+1].style.width=D,S.columnGrp[e+1]&&S.columnGrp[e+1].style.width&&(S.columnGrp[e+1].style.width=D))}else y.overflow&&(r.style.minWidth=r.tableWidth+w+s.PX);c&&(b.w=L,E.w=y.fixed?A:E.w,S&&(S.columns[e].w=L,S.columns[e+1].w=y.fixed?A:E.w))}});try{this.store=sessionStorage}catch{this.store={}}this.grip=null,this.tb=T,window.addEventListener("resize",this.onResize),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),this.init(q)};I.DEFAULTS={resizeMode:"fit",draggingClass:"grip-drag",gripInnerHtml:"",liveDrag:!1,minWidth:15,headerOnly:!1,hoverCursor:"col-resize",dragCursor:"col-resize",flush:!1,marginLeft:null,marginRight:null,remoteTable:null,disable:!1,partialRefresh:!1,disabledColumns:[],removePadding:!0,widths:[],serialize:!0,onDrag:null,onResize:null}},887:l=>{l.exports=function(p){for(var C=5381,f=p.length;f;)C=33*C^p.charCodeAt(--f);return C>>>0}}},n={};function i(l){if(n[l])return n[l].exports;var d=n[l]={exports:{}};return a[l](d,d.exports,i),d.exports}return i.n=l=>{var d=l&&l.__esModule?()=>l.default:()=>l;return i.d(d,{a:d}),d},i.d=(l,d)=>{for(var p in d)i.o(d,p)&&!i.o(l,p)&&Object.defineProperty(l,p,{enumerable:!0,get:d[p]})},i.o=(l,d)=>Object.prototype.hasOwnProperty.call(l,d),i.r=l=>{typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},i(67)})()})})(lt);var oo=Kt(lt.exports);const de=h=>{const{entityId:t,entityVersionNumber:a}=h,{accessToken:n}=K(),i=xt();return n?o(k,{children:o(Ae,{title:"Add this file to your Download Cart",placement:"right",enterNextDelay:300,children:o("a",{"data-testid":"AddToDownloadListV2",onClick:async()=>{try{await qt(t,a,n),i.invalidateQueries(["downloadliststatsv2"]);const d=await Dt(n,t,a?a==null?void 0:a.toString():void 0);me(`${d.name} was successfully added to your Download Cart.`,"success")}catch(d){me(`Unable to add the file to your Download Cart. ${d}`,"danger")}},className:"ignoreLink",children:o($,{options:{icon:"addToCart"}})})})}):o(k,{})};try{de.displayName="AddToDownloadListV2",de.__docgenInfo={description:"",displayName:"AddToDownloadListV2",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},entityVersionNumber:{defaultValue:null,description:"",name:"entityVersionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AddToDownloadListV2.tsx#AddToDownloadListV2"]={docgenInfo:de.__docgenInfo,name:"AddToDownloadListV2",path:"src/lib/containers/AddToDownloadListV2.tsx#AddToDownloadListV2"})}catch{}const ao=window.React.useEffect,ro=window.React.useState,ce=h=>{const{accessToken:t}=K(),{entityIdList:a}=h,[n,i]=ro([o(k,{})]),{ref:l,inView:d}=Qe();let p=!0;ao(()=>(d&&C(),()=>{p=!1}),[a,d]);const C=()=>{!a.length||Nt(a,t).then(f=>{if(p){const R=f.results.map(u=>o("p",{children:o(ke,{entity:u,displayTextField:"name"})},u.id));i(R)}}).catch(f=>{console.log("EntityIdList: Error getting entity headers",f)})};return o("span",{ref:l,children:n})};try{ce.displayName="EntityIdList",ce.__docgenInfo={description:"",displayName:"EntityIdList",props:{entityIdList:{defaultValue:null,description:"",name:"entityIdList",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/EntityIdList.tsx#EntityIdList"]={docgenInfo:ce.__docgenInfo,name:"EntityIdList",path:"src/lib/containers/EntityIdList.tsx#EntityIdList"})}catch{}const so=window.React.useEffect,io=window.React.useState,ue=h=>{const{accessToken:t}=K(),{evaluationId:a}=h,[n,i]=io(),{ref:l,inView:d}=Qe();let p=!0;so(()=>(p&&d&&C(),()=>{p=!1}),[a,d]);const C=()=>{!a||Ot(a,t).then(f=>{i(f.name)}).catch(f=>{console.log("EvaluationIdListRenderer: Error getting evaluation queue names",f)})};return o("span",{ref:l,children:n})};try{ue.displayName="EvaluationIdRenderer",ue.__docgenInfo={description:"",displayName:"EvaluationIdRenderer",props:{evaluationId:{defaultValue:null,description:"",name:"evaluationId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/EvaluationIdRenderer.tsx#EvaluationIdRenderer"]={docgenInfo:ue.__docgenInfo,name:"EvaluationIdRenderer",path:"src/lib/containers/EvaluationIdRenderer.tsx#EvaluationIdRenderer"})}catch{}const lo=window.React.useEffect,co=window.React.useState,pe=h=>{const{accessToken:t}=K(),{userIds:a}=h,[n,i]=co(),{ref:l,inView:d}=Qe();let p=!0;lo(()=>(p&&d&&C(),()=>{p=!1}),[a,d]);const C=()=>{!a.length||At(a,t).then(f=>{const R=f.list.map(u=>o(jt,{userProfile:u,className:"SRC-marginFifteen"},u.ownerId));i(R)}).catch(f=>{console.log("UserIdList: Error getting user profiles",f)})};return o("span",{ref:l,children:n})};try{pe.displayName="UserIdList",pe.__docgenInfo={description:"",displayName:"UserIdList",props:{userIds:{defaultValue:null,description:"",name:"userIds",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/UserIdList.tsx#UserIdList"]={docgenInfo:pe.__docgenInfo,name:"UserIdList",path:"src/lib/containers/UserIdList.tsx#UserIdList"})}catch{}const he=({columnType:h,columnValue:t,isBold:a,mapEntityIdToHeader:n,mapUserIdToHeader:i,columnLinkConfig:l,rowIndex:d,columnName:p,selectColumns:C,columnModels:f,rowData:R,rowId:u,rowVersionNumber:g})=>{const{entity:v}=H(),I=(m,T=20)=>!m||m.length<=T;if(!t)return _("p",{className:"SRC-center-text SRC-inactive",children:[" ",cn]});if(l)return o(dn,{value:t,columnName:p,selectColumns:C,columnModels:f,isHeader:!1,labelLink:l,rowData:R});if(v&&(U(v)||Y(v)||at(v))&&(p==="id"||p==="name")&&u&&g){const m=`syn${u.toString()}`;if(Object.prototype.hasOwnProperty.call(n,m))return o("p",{children:o(ke,{entity:n[m],versionNumber:g,className:`${a}`,showIcon:!1,displayTextField:p})})}switch(h){case x.ENTITYID:if(Object.prototype.hasOwnProperty.call(n,t))return o("p",{children:o(ke,{entity:n[t],className:`${a}`,displayTextField:"name"})});break;case x.DATE_LIST:{const m=JSON.parse(t);return _("p",{children:[m.map((T,s)=>_("span",{className:a,children:[new Date(T).toLocaleString(),s!==m.length-1?", ":""]},s))," "]})}case x.BOOLEAN_LIST:{const m=JSON.parse(t);return o("p",{children:m.map((T,s)=>_("span",{className:a,children:[T?"true":"false",s!==m.length-1?", ":""]},s))})}case x.FILEHANDLEID:return o(k,{children:v&&o(st,{associatedObjectId:v.id,associatedObjectType:Ft.TableEntity,fileHandleId:t,displayFileName:!0})});case x.ENTITYID_LIST:{const m=JSON.parse(t);return o(ce,{entityIdList:m})}case x.USERID_LIST:{const m=JSON.parse(t);return o(pe,{userIds:m})}case x.STRING_LIST:case x.INTEGER_LIST:{const m=JSON.parse(t);return o("p",{children:m.map((T,s)=>_("span",{className:a,children:[T,s!==m.length-1?", ":""]},T))})}case x.EVALUATIONID:return o(ue,{evaluationId:t});case x.DATE:return o("p",{className:a,children:new Date(Number(t)).toLocaleString()});case x.USERID:if(Object.prototype.hasOwnProperty.call(i,t)){const{ownerId:m,userName:T}=i[t];if(i[t].isIndividual===!1){const s=T===Ue?"public":"people";return T===Ue?_("span",{children:[o($,{options:{icon:s}})," All registered Synapse users"]}):_("a",{target:"_blank",rel:"noopener noreferrer",href:`${Fe.PORTAL}#!Team:${m}`,children:[o($,{options:{icon:s}})," ",T]})}else return o(Jt,{userProfile:i[t],preSignedURL:i[t].clientPreSignedURL,size:"SMALL USER CARD"})}break;case x.LINK:return o("a",{target:"_blank",rel:"noopener noreferrer",href:t,children:t});case x.STRING:case x.DOUBLE:case x.INTEGER:case x.BOOLEAN:case x.LARGETEXT:return I(t)?_("p",{className:a,children:[" ",t]}):o("div",{className:a,children:o(be,{tooltipText:t,callbackFn:un,idForToolTip:`${p}_${d}`,children:_("p",{className:a,children:[" ",t]})})});default:return console.warn(`ColumnType ${h} has unspecified handler. Rendering the column value.`),o("p",{className:a,children:t})}return o("p",{className:a,children:t})};try{he.displayName="SynapseTableCell",he.__docgenInfo={description:"",displayName:"SynapseTableCell",props:{columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'}]}},columnValue:{defaultValue:null,description:"",name:"columnValue",required:!0,type:{name:"string"}},isBold:{defaultValue:null,description:"",name:"isBold",required:!0,type:{name:"string"}},columnLinkConfig:{defaultValue:null,description:"",name:"columnLinkConfig",required:!1,type:{name:"CardLink | ColumnSpecifiedLink | MarkdownLink"}},mapEntityIdToHeader:{defaultValue:null,description:"",name:"mapEntityIdToHeader",required:!0,type:{name:"Record<string, EntityHeader>"}},mapUserIdToHeader:{defaultValue:null,description:"",name:"mapUserIdToHeader",required:!0,type:{name:"Partial<UserGroupHeader & UserProfile>"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!1,type:{name:"number"}},columnName:{defaultValue:null,description:"",name:"columnName",required:!0,type:{name:"string"}},selectColumns:{defaultValue:null,description:"",name:"selectColumns",required:!1,type:{name:"SelectColumn[]"}},columnModels:{defaultValue:null,description:"",name:"columnModels",required:!1,type:{name:"ColumnModel[]"}},rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"(string | null)[]"}},rowId:{defaultValue:null,description:"",name:"rowId",required:!1,type:{name:"number"}},rowVersionNumber:{defaultValue:null,description:"",name:"rowVersionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/synapse_table_functions/SynapseTableCell.tsx#SynapseTableCell"]={docgenInfo:he.__docgenInfo,name:"SynapseTableCell",path:"src/lib/containers/synapse_table_functions/SynapseTableCell.tsx#SynapseTableCell"})}catch{}const dt=window.SQLParser.lexer,et=(h,...t)=>{var n;const a=[];return(n=h==null?void 0:h.selectColumns)==null||n.forEach((i,l)=>{t.includes(i.columnType)&&a.push(l)}),a},tt=(h,t,a)=>{var i;const n=new Set;return(i=h.queryResult)==null||i.queryResults.rows.forEach(l=>{l.values.forEach((d,p)=>{a.includes(p)&&!Object.prototype.hasOwnProperty.call(t,d)&&d&&n.add(d)})}),n};function uo(h){const t=[];if(rn(h)){const a=dt.tokenize(h),n=a.findIndex(d=>d[0]==="SELECT"),i=a.findIndex(d=>d[0]==="FROM");let l=0;for(let d=n+1;d<i-n-1;d+=1){const p=a[d];p[0]==="FUNCTION"&&p[1].toLowerCase()==="count"?t.push(l):p[0]==="SEPARATOR"&&(l+=1)}}return t}function po(h,t,a){let n=dt.tokenize(t);const i=n.findIndex(u=>u[0]==="SELECT"),l=n.findIndex(u=>u[0]==="FROM"),d=[];let p=0,C=!1;for(let u=i+1;u<l-i-1;u+=1){const g=n[u];g[0]==="FUNCTION"||g[1].toLocaleLowerCase()==="concat"?C=!0:g[0]==="LITERAL"&&!C?d.push({index:p,name:g[1]}):g[0]==="SEPARATOR"&&(p+=1,C=!1)}if(n=n.slice(0,n.findIndex(u=>u[0]==="GROUP")),n.splice(i+1,l-i-1,["STAR","*","1"]),a===void 0)return{synId:"",newSql:""};n.findIndex(u=>u[0]==="WHERE")===-1?n.push(["WHERE","WHERE","1"]):n.push(["CONDITIONAL","AND","1"]),d.forEach((u,g)=>{const v=h.values[u.index];v?n.push(["LITERAL",u.name,"1"],["OPERATOR","=","1"],["STRING",v,"1"],["CONDITIONAL","AND","1"]):n.push(["LITERAL",u.name,"1"],["OPERATOR","IS","1"],["BOOLEAN","null","1"],["CONDITIONAL","AND","1"])}),n.pop();const R=n[n.findIndex(u=>u[0]==="FROM")+1][1];return n.push(["EOF","","1"]),{synId:R,newSql:sn(n)}}const ho=()=>{const{data:h,goToPage:t,pageSize:a,setPageSize:n,currentPage:i}=yt(),l=h==null?void 0:h.queryCount,d=(C,f)=>{t(f)},p=C=>{const f=C.target.value;n(f)};return i==1&&l&&l<10?o(k,{}):_("div",{children:[o(On,{page:i,count:Math.ceil(l/a),color:"secondary",onChange:d,style:{display:"inline-block",float:"left"}}),o(we,{variant:"body1",style:{display:"inline-block"},children:`${l==null?void 0:l.toLocaleString()} total rows /`}),_("select",{name:"page size",onChange:p,style:{padding:"4px",marginLeft:"4px"},value:a,children:[o("option",{value:10,children:"10 per page"}),o("option",{value:25,children:"25 per page"}),o("option",{value:100,children:"100 per page"}),o("option",{value:500,children:"500 per page"})]})]})},Ne=window.React,mo=()=>{const h=K(),t=H(),[a,n]=Ne.useState(!1),[i,l]=Ne.useState(),d=()=>{n(!0);const{getLastQueryRequest:p}=t,C=p(),{sql:f}=C.query,{entityId:R,versionNumber:u}=ln(f),g=u?`.${u}`:"";C.partMask=kt,C.query={sql:`select id from ${R}${g}`},Vt(C,h.accessToken).then(v=>{l(v)}).catch(v=>{console.error(v),me("Unable to query for all IDs","danger")}).finally(()=>{n(!1)})};return Ne.useEffect(()=>{if(i){const{rows:p}=i.queryResult.queryResults,C=p.map(f=>`${f.values[0]}`).join(`
`);navigator.clipboard.writeText(C).then(()=>{me("Successfully copied to clipboard"),l(void 0)})}},[i]),a?o(nn,{size:25}):o(en,{onCopy:()=>{d()}})},nt=window.React,fo={id:"",name:"",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:-1,versionLabel:"",benefactorId:-1,createdBy:"",createdOn:"",modifiedBy:"",modifiedOn:"",isLatestVersion:!0},yo=["","DESC","ASC"],ot={resizeMode:"overflow",partialRefresh:"true",liveDrag:!0,headerOnly:"true"};class Oe extends nt.Component{constructor(t){super(t),this.tableElement=void 0,this.showGroupRowData=a=>{const n=this.props.queryContext.getLastQueryRequest().query,i=po(a,n.sql,this.props.queryContext.data);n.sql=i.newSql;const l=JSON.stringify(n),d=btoa(l);return`${Fe.PORTAL}#!Synapse:${i.synId}/tables/query/${d}`},this.renderTable=(a,n,i,l)=>{var s,q;const d=(q=(s=this.props.queryContext).getLastQueryRequest)==null?void 0:q.call(s),{queryContext:{entity:p},showAccessColumn:C,showDownloadColumn:f,isRowSelectionVisible:R}=this.props,u=p&&(U(p)&&Mt(p)||Y(p)),g=C&&p&&this.isEntityViewOrDataset()&&this.allRowsHaveId(),v=!!this.props.synapseContext.accessToken,I=p&&u&&v&&this.allRowsHaveId(),m=!!(I&&!this.props.hideDownload),T=I&&f;return _("div",{className:"SynapseTable SRC-overflowAuto","data-testid":"SynapseTable",children:[_("table",{ref:r=>this.tableElement=r,className:"table table-striped table-condensed",children:[o("thead",{className:"SRC_bordered",children:o("tr",{children:this.createTableHeader(a,n,i,g,T,m,R,d)})}),o("tbody",{children:this.createTableRows(l,a,g,T,m,R)})]}),o("div",{className:"bootstrap-4-backport",style:{textAlign:"right"},children:o(ho,{})})]})},this.handleColumnSortPress=a=>n=>{let i=j(this.state.columnIconSortState);i.length===0&&(i=Array(this.getLengthOfPropsData()).fill(0));const l=j(this.state.sortedColumnSelection),d=this.findSelectionIndex(l,a.name);d!==-1&&l.splice(d,1),i[a.index]=(i[a.index]+1)%Ge.length,i[a.index]>0&&l.unshift({column:a.name,direction:yo[i[a.index]]});const p=this.props.queryContext.getLastQueryRequest();p.query.sort=l,p.query.offset=0,this.props.queryContext.executeQueryRequest(p),this.setState({columnIconSortState:i,sortedColumnSelection:l})},this.applyChangesFromQueryFilter=a=>{const n=this.props.queryContext.getLastQueryRequest();n.query.selectedFacets=a,n.query.offset=0,this.props.queryContext.executeQueryRequest(n)},this.componentDidMount=this.componentDidMount.bind(this),this.componentWillUnmount=this.componentWillUnmount.bind(this),this.componentDidUpdate=this.componentDidUpdate.bind(this),this.shouldComponentUpdate=this.shouldComponentUpdate.bind(this),this.handleColumnSortPress=this.handleColumnSortPress.bind(this),this.findSelectionIndex=this.findSelectionIndex.bind(this),this.advancedSearch=this.advancedSearch.bind(this),this.getLengthOfPropsData=this.getLengthOfPropsData.bind(this),this.configureFacetDropdown=this.configureFacetDropdown.bind(this),this.enableResize=this.enableResize.bind(this),this.disableResize=this.disableResize.bind(this),this.isEntityViewOrDataset=this.isEntityViewOrDataset.bind(this),this.allRowsHaveId=this.allRowsHaveId.bind(this),this.state={columnIconSortState:[],isExportTableDownloadOpen:!1,isExpanded:!1,isColumnSelectionOpen:!1,sortedColumnSelection:[],mapEntityIdToHeader:{},mapUserIdToHeader:{},isFetchingEntityHeaders:!1},this.getEntityHeadersInData=this.getEntityHeadersInData.bind(this)}componentWillUnmount(){this.disableResize()}componentDidMount(){this.getEntityHeadersInData(!0),this.enableResize()}shouldComponentUpdate(t,a){const{isFetchingEntityHeaders:n,...i}=this.state,{isFetchingEntityHeaders:l,...d}=a,p=!te(this.props,t),C=!te(i,d),f=p||C;return f&&this.disableResize(),f}componentDidUpdate(t,a){te(t.queryContext.data,this.props.queryContext.data)?t.queryContext.entity&&this.props.queryContext.entity&&!te(U(t.queryContext.entity),U(this.props.queryContext.entity))&&this.getEntityHeadersInData(!0):this.getEntityHeadersInData(!1),this.enableResize()}enableResize(){this.resizer?setTimeout(()=>{this.resizer.reset(ot)},1e3):this.tableElement&&this.getLengthOfPropsData()>1&&(this.resizer=new oo(this.tableElement,ot))}disableResize(){this.resizer&&this.resizer.reset({disable:!0})}async getEntityHeadersInData(t){var u,g,v;const{data:a,entity:n}=this.props.queryContext;if(!a||!n)return;if(this.state.isFetchingEntityHeaders&&!t)return;const i=j(this.state.mapEntityIdToHeader),l=j(this.state.mapUserIdToHeader),d=et(a,x.ENTITYID),p=et(a,x.USERID),C=tt(a,i,d);(this.isEntityViewOrDataset()||n&&at(n))&&this.allRowsHaveId()&&((v=(g=(u=a.queryResult)==null?void 0:u.queryResults)==null?void 0:g.rows)!=null?v:[]).forEach(m=>{const T=`syn${m.rowId}`;C.add(T)});const f=tt(a,l,p);if(C.size===0&&f.size===0)return;if(this.setState({isFetchingEntityHeaders:!0}),C.size>0){const I=Array.from(C).map(m=>({targetId:m}));try{I.forEach(s=>{i[s.targetId]=fo});const m=await Pt(I,this.props.synapseContext.accessToken),{results:T}=m;T.forEach(s=>{i[s.id]=s})}catch(m){console.error("Error on retrieving entity header list , ",m)}}const R=[];if(f.size>0){const I=Array.from(f);try{(await $t(I,this.props.synapseContext.accessToken)).children.forEach(T=>{T.isIndividual?R.push(T.ownerId):l[T.ownerId]=T})}catch(m){console.error("Error on getGroupHeaders batch: ",m)}}if(R.length>0)try{(await Zt(R)).list.forEach(m=>{l[m.ownerId]=m})}catch(I){console.error("Error on getUserProfile : ",I)}this.setState({mapEntityIdToHeader:i,mapUserIdToHeader:l,isFetchingEntityHeaders:!1})}render(){var m,T;if(!this.props.queryContext.data&&this.props.queryContext.isLoadingNewBundle)return on;if(!this.props.queryContext.data)return o(k,{});const{queryContext:{data:t},showNoContentAvailableWhenEmpty:a}=this.props,{queryResult:n,columnModels:i=[]}=t,{facets:l=[]}=t,{isExpanded:d,isExportTableDownloadOpen:p}=this.state,C=this.props.queryContext.getLastQueryRequest();let f="";if(!(((T=(m=t.queryResult)==null?void 0:m.queryResults.rows.length)!=null?T:0)>0)&&C.query.offset===0)return C.query.additionalFilters?o(hn,{}):a?o(mn,{}):_("div",{className:"text-center SRCBorderedPanel SRCBorderedPanel--padded2x",children:[Xt,o("div",{style:{marginTop:"20px",fontStyle:"italic"},children:"This table is currently empty"})]});const{rows:u,headers:g}=n.queryResults,v=o("div",{children:this.renderTable(g,i,l,u)}),I=o(k,{children:_("div",{className:f,children:[p&&o(W,{onClose:()=>{this.setState({isExportTableDownloadOpen:!1})},queryBundleRequest:C}),o("div",{children:v})]})});return _(nt.Fragment,{children:[d&&_(Q,{animation:!1,show:!0,onHide:()=>this.setState({isExpanded:!1}),dialogClassName:"modal-90w",backdrop:"static",children:[o(Q.Header,{onHide:()=>this.setState({isExpanded:!1}),closeButton:!0}),o(Q.Body,{children:I})]}),!d&&I]})}allRowsHaveId(){var a,n;const{queryContext:{data:t}}=this.props;return(n=(a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults.rows.every(i=>!!i.rowId))!=null?n:!1}isEntityViewOrDataset(){var a;const{queryContext:{entity:t}}=this.props;return(a=t&&(U(t)||Y(t)))!=null?a:!1}createTableRows(t,a,n,i,l,d){const p=[],{queryContext:{data:C},queryVisualizationContext:{columnsToShowInTable:f,selectedRowIndices:R,setSelectedRowIndices:u},columnLinks:g=[],linkCountToDisaggregatedQuery:v=!1}=this.props,{selectColumns:I=[],columnModels:m=[]}=C,{mapEntityIdToHeader:T,mapUserIdToHeader:s}=this.state,q=uo(this.props.queryContext.getLastQueryRequest().query.sql);return t.forEach((r,e)=>{var E,L,A;const c=(E=r.versionNumber)==null?void 0:E.toString(),y=`syn${r.rowId}`,S=r.values.map((N,D)=>{const F=a[D].name,Z=f.includes(F),ee=g.find(V=>V.matchColumnName===F),ve=this.findSelectionIndex(this.state.sortedColumnSelection,F),Re=q.includes(D)&&v,O=ve===-1?"":"SRC-boldText";return Z?o("td",{className:"SRC_noBorderTop SRC-synapseTableTd",children:Re?o("a",{href:this.showGroupRowData(r),target:"_blank",rel:"noopener noreferrer",children:o("p",{className:O,children:N})}):o(he,{columnType:a[D].columnType,columnValue:N,isBold:O,mapEntityIdToHeader:T,mapUserIdToHeader:s,rowIndex:e,columnLinkConfig:ee,columnName:F,rowData:r.values,selectColumns:I,columnModels:m,rowId:r.rowId,rowVersionNumber:r.versionNumber})},`(${e}${N}${D})`):o("td",{className:"SRC-hidden"},`(${e},${D})`)});n&&S.unshift(o("td",{className:"SRC_noBorderTop",children:o(tn,{entityId:y,entityVersionNumber:c},y)},y));const w=((L=T[y])==null?void 0:L.type)=="org.sagebionetworks.repo.model.FileEntity";i&&S.unshift(o("td",{className:"SRC_noBorderTop direct-download",children:w&&o(st,{associatedObjectId:y,entityVersionNumber:c})},`direct-download-${y}`)),l&&S.unshift(o("td",{className:"SRC_noBorderTop add-to-download-list-v2",children:w&&o(de,{entityId:y,entityVersionNumber:parseInt(c)})},`add-to-download-list-v2-${y}`)),d&&R&&S.unshift(o("td",{className:"SRC_noBorderTop",children:o(pn,{label:"",checked:R.includes(e),onChange:N=>{const D=[...R];if(N)D.push(e);else{const F=D.indexOf(e);F>-1&&D.splice(F,1)}u(D)}})},`(${e},rowSelectColumn)`));const b=o("tr",{children:S},(A=r.rowId)!=null?A:e);p.push(b)}),p}isSortableColumn(t){switch(t){case x.USERID:case x.ENTITYID:case x.FILEHANDLEID:return!1;default:return!0}}createTableHeader(t,a,n,i,l,d,p,C){const{sortedColumnSelection:f,columnIconSortState:R}=this.state,{queryVisualizationContext:{facetAliases:u={},columnsToShowInTable:g},queryContext:{lockedFacet:v}}=this.props,I=t.map((m,T)=>{var q;if(g.includes(m.name)){const r=this.findSelectionIndex(f,m.name)!==-1,e=R[T]===void 0?0:R[T],c=n.findIndex(F=>F.columnName===m.name),y=c!==-1&&n[c].facetType==="enumeration",S=n[c],w=r?"SRC-primary-background-color SRC-anchor-light":"",b=r?"SRC-selected-table-icon tool-icon":"SRC-primary-text-color tool-icon",E=`SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover  ${w}`,L=ze(m.name,u),A=a.find(F=>F.name===m.name),N=m.name.toLowerCase()===((q=v==null?void 0:v.facet)==null?void 0:q.toLowerCase()),D=A&&A.name=="id"&&A.columnType==x.ENTITYID;return o("th",{children:_("div",{className:"SRC-split",children:[o("span",{style:{whiteSpace:"nowrap"},children:L}),_("div",{className:"SRC-centerContent",children:[y&&!N&&this.configureFacetDropdown(S,A,C,u),this.isSortableColumn(m.columnType)&&o("span",{role:"button","aria-label":"sort",tabIndex:0,className:E,onKeyPress:this.handleColumnSortPress({index:T,name:m.name}),onClick:this.handleColumnSortPress({index:T,name:m.name}),children:o(rt,{type:Ge[e],cssClass:b})}),D&&o(mo,{})]})]})},m.name)}else return o("th",{className:"SRC-hidden"},m.name)});return i&&I.unshift(o("th",{children:o("div",{className:"SRC-centerContent",children:o("span",{style:{whiteSpace:"nowrap"},children:"Access"})})},"accessColumn")),l&&I.unshift(o("th",{children:o("div",{className:"SRC-centerContent",children:"\xA0"})},"downloadColumn")),d&&I.unshift(o("th",{"data-testid":"AddToDownloadListV2ColumnHeader",children:o("div",{className:"SRC-centerContent",children:"\xA0"})},"addToV2DownloadListColumn")),p&&I.unshift(o("th",{children:o("div",{className:"SRC-centerContent"})},"rowSelectionColumn")),I}findSelectionIndex(t,a){return t.length!==0?t.findIndex(n=>n.column===a):-1}advancedSearch(t){t&&t.preventDefault();const a=this.props.queryContext.getLastQueryRequest(),{query:n}=a,i=btoa(JSON.stringify(n)),l=a.entityId;window.open(`${Fe.PORTAL}#!Synapse:${l}/tables/query/${i}`,"_blank")}getLengthOfPropsData(){var a,n;const{data:t}=this.props.queryContext;return(n=(a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults.headers.length)!=null?n:0}configureFacetDropdown(t,a,n,i){return o(gt,{containerAs:"Dropdown",facetValues:t.facetValues,columnModel:a,facetAliases:i,onChange:l=>{St(n,t,this.applyChangesFromQueryFilter,l)},onClear:()=>{Ct(n,t,this.applyChangesFromQueryFilter)}})}}try{Oe.displayName="SynapseTable",Oe.__docgenInfo={description:"",displayName:"SynapseTable",props:{synapseContext:{defaultValue:null,description:"",name:"synapseContext",required:!0,type:{name:"SynapseContextType"}},queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},showAccessColumn:{defaultValue:null,description:"",name:"showAccessColumn",required:!1,type:{name:"boolean"}},showDownloadColumn:{defaultValue:null,description:"",name:"showDownloadColumn",required:!1,type:{name:"boolean"}},columnLinks:{defaultValue:null,description:"",name:"columnLinks",required:!1,type:{name:"LabelLinkConfig"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},isRowSelectionVisible:{defaultValue:null,description:"",name:"isRowSelectionVisible",required:!1,type:{name:"boolean"}},linkCountToDisaggregatedQuery:{defaultValue:null,description:`If true, columns created by the COUNT function will render with a link to Synapse that opens the disaggregated query results filtered by the conditions of that row.
Note that this is very brittle and only supports one column at a time. See SWC-6075 for more information. Default false.`,name:"linkCountToDisaggregatedQuery",required:!1,type:{name:"boolean"}},showNoContentAvailableWhenEmpty:{defaultValue:null,description:"",name:"showNoContentAvailableWhenEmpty",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/SynapseTable.tsx#SynapseTable"]={docgenInfo:Oe.__docgenInfo,name:"SynapseTable",path:"src/lib/containers/table/SynapseTable.tsx#SynapseTable"})}catch{}function ua(){const{data:h}=H(),{showLastUpdatedOn:t}=ge();return t&&h&&h.lastUpdatedOn?o("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:_(we,{variant:"body2",children:["Last updated on ",Cn(Sn(h.lastUpdatedOn))]})}):o(k,{})}export{Ee as F,ua as L,W as M,Oe as S,De as T,xe as a,qe as b};
//# sourceMappingURL=LastUpdatedOn.f02a4c60.js.map
