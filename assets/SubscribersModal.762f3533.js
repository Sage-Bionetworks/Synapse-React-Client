import{V as o,X as m,cc as p,cd as I,ce as E,ao as C,cf as M,cg as O,ch as D}from"./index.d78db713.js";import{u as g}from"./useInfiniteQuery.20432a69.js";import{u as A}from"./useMutation.61e704e1.js";import{D as R}from"./EntityChildren.50133102.js";import{r as h,a as f,j as n}from"./jsx-runtime.470fedf8.js";import{U as B}from"./UserCard.81f9cb14.js";import{i as U}from"./SynapseConstants.290eab74.js";import{M as c}from"./Modal.02af6ee8.js";import{B as N}from"./Button.5119f75c.js";function K(e,s){const{accessToken:r}=o();return m(["moderators",e],()=>p(r,e),s)}function z(e,s,r,t,a,i){const{accessToken:l}=o();return g(["forumthread",e,"infinite",s,a,r,t],async u=>I(l,e,u.pageParam,s,r,t,a),{...i,getNextPageParam:(u,d)=>{const S=d.flatMap(b=>b.results).length;if(u.totalNumberOfResults>S)return S}})}var L=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(L||{}),T=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(T||{});function v(e,s){const{accessToken:r}=o();return m(["subscriber",e.objectId,e.objectType],()=>E(r,e),s)}function w(e,s,r){const{accessToken:t}=o();return m([t,"subscription",e,s],async()=>{const i={objectType:s,idList:[e],sortByType:T.OBJECT_ID,sortDirection:R.ASC};return(await D(t,i)).results[0]},r)}function y(e){const s=C(),{accessToken:r}=o();return A(t=>M(r,t),{...e,onSuccess:async(t,a,i)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber",a.objectId,a.objectType]),e!=null&&e.onSuccess&&await e.onSuccess(t,a,i)}})}function k(e){const s=C(),{accessToken:r}=o();return A(t=>O(r,t),{...e,onSuccess:async(t,a,i)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber"]),e!=null&&e.onSuccess&&await e.onSuccess(t,a,i)}})}const F=(e,s)=>{const{data:r,isLoading:t}=w(e,s),{data:a}=v({objectId:e,objectType:s}),{mutate:i,isLoading:l}=y(),{mutate:u,isLoading:d}=k(),S=t||l||d,b=h.exports.useCallback(()=>{r?u(r.subscriptionId):i({objectId:e,objectType:s})},[u,e,s,i,r]);return{isLoading:S,subscription:r,toggleSubscribed:b,subscribers:a}},_=({id:e,objectType:s,showModal:r,handleModal:t})=>{const{subscribers:a}=F(e,s);return f("div",{className:"SubscribersModal",children:[a&&a.subscribers.length>0&&n("a",{onClick:()=>t(!0),children:`Followers (${a.subscribers.length})`}),f(c,{className:"bootstrap-4-backport",show:r,onHide:()=>t(!1),animation:!1,children:[n(c.Header,{closeButton:!0,children:n(c.Title,{children:"Followers"})}),n(c.Body,{children:a&&a.subscribers.map(i=>n(B,{ownerId:i,size:U,showCardOnHover:!0},i))}),n(c.Footer,{children:n(N,{variant:"contained",onClick:()=>t(!1),children:"Ok"})})]})]})};try{_.displayName="SubscribersModal",_.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/discussion_forum/SubscribersModal.tsx#SubscribersModal"]={docgenInfo:_.__docgenInfo,name:"SubscribersModal",path:"src/lib/containers/discussion_forum/SubscribersModal.tsx#SubscribersModal"})}catch{}export{L as S,F as a,_ as b,z as c,K as u};
