import{g as E,n as b,d as w,p as T,e as h,f as C,s as k,c as v,a as c}from"./useUserBundle.b392c93a.js";import{_ as p}from"./objectWithoutPropertiesLoose.d29fb19f.js";import{_ as I}from"./withStyles.4f64abe1.js";import{u as x}from"./useInfiniteQuery.d8a4c81b.js";import{R as L,T as Q,W as U,X as _,Y as q,Z as J,_ as P}from"./index.5cb3fa28.js";import"./assert.11368392.js";import{i as R,e as l}from"./queryKeys.e0d3085f.js";import{p as A,o as D}from"./pick.6ff1a44d.js";const g=["name","description","id","etag","createdOn","modifiedOn","createdBy","modifiedBy","parentId","concreteType","versionNumber","versionLabel","versionComment","isLatestVersion","dataFileHandleId","fileNameOverride","columnIds","scopeIds","linksTo","linksToClassName","repositoryName","isManaged","viewTypeMask","type","alias","items","definingSQL"];var F=function(s){I(r,s);function r(n,e){var t;return t=s.call(this)||this,t.client=n,t.setOptions(e),t.bindMethods(),t.updateResult(),t}var u=r.prototype;return u.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},u.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},u.onUnsubscribe=function(){if(!this.listeners.length){var e;(e=this.currentMutation)==null||e.removeObserver(this)}},u.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};e.type==="success"?t.onSuccess=!0:e.type==="error"&&(t.onError=!0),this.notify(t)},u.getCurrentResult=function(){return this.currentResult},u.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},u.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,p({},this.options,{variables:typeof e!="undefined"?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},u.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:E(),t=p({},e,{isLoading:e.status==="loading",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=t},u.notify=function(e){var t=this;b.batch(function(){t.mutateOptions&&(e.onSuccess?(t.mutateOptions.onSuccess==null||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),t.mutateOptions.onSettled==null||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(t.mutateOptions.onError==null||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),t.mutateOptions.onSettled==null||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach(function(i){i(t.currentResult)})})},r}(w);const d=window.React;function S(s,r,u){var n=d.useRef(!1),e=d.useState(0),t=e[1],i=T(s,r,u),a=h(),o=d.useRef();o.current?o.current.setOptions(i):o.current=new F(a,i);var f=o.current.getCurrentResult();d.useEffect(function(){n.current=!0;var m=o.current.subscribe(b.batchCalls(function(){n.current&&t(function(y){return y+1})}));return function(){n.current=!1,m()}},[]);var O=d.useCallback(function(m,y){o.current.mutate(m,y).catch(C)},[]);if(f.error&&k(void 0,o.current.options.useErrorBoundary,[f.error]))throw f.error;return p({},f,{mutate:O,mutateAsync:f.mutate})}const G=window.React.useEffect,M=window.React.useState;function N(s,r,u){const{accessToken:n}=c();return v(l.version(s,r),()=>U(n,s,r==null?void 0:r.toString()),u)}function $(s){const r=h(),{accessToken:u}=c();return S(n=>Q(n,u),{...s,onSuccess:async(n,e,t)=>{await R(r,n.id),r.setQueryData(l.entity(n.id),n),s!=null&&s.onSuccess&&await s.onSuccess(n,e,t)}})}function tt(s){const r=h(),{accessToken:u}=c();return S(n=>J(u,n),{...s,onSuccess:async(n,e,t)=>{await R(r,e),s!=null&&s.onSuccess&&await s.onSuccess(n,e,t)}})}function et(s,r){const{accessToken:n}=c();return x(l.versions(s),async e=>await P(s,n,e.pageParam,200),{...r,getNextPageParam:(e,t)=>{if(e.results.length>0)return t.length*200}})}function V(s){return A(s,g)}function B(s){return D(s,g)}function st(s,r){const[u,n]=M(),[e,t]=M(),{accessToken:i}=c(),a=v(l.json(s),()=>_(s,i),r);return G(()=>{a.data&&(n(V(a.data)),t(B(a.data)))},[a.data]),{...a,entityMetadata:u,annotations:e}}function nt(s){const r=h(),{accessToken:u}=c();return S(n=>{const e=n.id;return L(e,n,u)},{...s,onSuccess:async(n,e,t)=>{const i=n.id;await R(r,i),r.setQueryData(l.json(i),n),s!=null&&s.onSuccess&&await s.onSuccess(n,e,t)}})}function rt(s,r){const{accessToken:u}=c();return v(l.path(s),()=>q(s,u),r)}export{S as a,tt as b,et as c,st as d,g as e,nt as f,rt as g,$ as h,N as u};
//# sourceMappingURL=useEntity.d360ff4e.js.map
