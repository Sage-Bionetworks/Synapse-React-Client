import{a as n,j as e,F as R,r as h}from"./jsx-runtime.cae1efce.js";import{W as K,c3 as O,a7 as k,cl as j,cm as H,a8 as Y,a9 as $}from"./EntityTypeUtils.02efa7e4.js";import{g as B,B as F}from"./getEndpoint.f1f195f5.js";import{H as U,u as L}from"./HelpPopover.dd19c094.js";import{M as p}from"./Modal.04b387a6.js";import{T as z}from"./Typography.334f7e13.js";import{S as q}from"./Skeleton.5c3ed137.js";import{a as G}from"./Tooltip.017a66bf.js";import{B as W}from"./Button.7727704e.js";import{d as J}from"./ToastMessage.8e99f4ca.js";import{u as Q,S as X}from"./SchemaDrivenAnnotationEditor.cccf0652.js";import{c as Z}from"./useEntity.140994a4.js";import{S as ee}from"./SkeletonTable.ef7abf61.js";import{i as ae}from"./isEmpty.9c14b5b1.js";import{d as g}from"./dayjs.min.12a0da3a.js";import{f as v}from"./DateFormatter.70c7721e.js";import{g as te,a as ne}from"./FileHandleUtils.342c0fdf.js";import{U as V}from"./UserCard.60a81442.js";function I(a){var l;const{copy:i,skeleton:t,...o}=a;return a.skeleton?e(q,{variant:"rectangular",width:150}):e(G,{title:(l=o["data-tip"])!=null?l:"",placement:"top",enterNextDelay:300,children:e(W,{...o,children:i})})}const A=a=>{var i,t,o;return n(p,{className:`FluidModal bootstrap-4-backport ${(i=a.className)!=null?i:""}`,backdrop:"static",animation:!1,show:a.show,onHide:a.onClose,children:[e(p.Header,{closeButton:!0,children:e(p.Title,{children:n(z,{variant:"headline1",component:"span",children:[a.title,a.titlePopoverProps&&e(U,{placement:"right",...a.titlePopoverProps,className:"SRC-margin-left-5 "+((o=(t=a.titlePopoverProps)==null?void 0:t.className)!=null?o:"")})]})})}),e(p.Body,{children:a.children}),n(p.Footer,{children:[a.secondaryActions&&a.secondaryActions.reverse().map((l,s)=>e(I,{variant:"outline",...l},s)),a.primaryAction&&e(I,{variant:"sds-primary",...a.primaryAction})]})]})};try{A.displayName="FluidModal",A.__docgenInfo={description:"Full-screen modal that scales with screen size. Fits requirements defined in SWC-5801",displayName:"FluidModal",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string | Element"}},titlePopoverProps:{defaultValue:null,description:"",name:"titlePopoverProps",required:!1,type:{name:"HelpPopoverProps"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},primaryAction:{defaultValue:null,description:"",name:"primaryAction",required:!1,type:{name:"ModalAction"}},secondaryActions:{defaultValue:null,description:"",name:"secondaryActions",required:!1,type:{name:"ModalAction[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/FluidModal.tsx#FluidModal"]={docgenInfo:A.__docgenInfo,name:"FluidModal",path:"src/lib/containers/FluidModal.tsx#FluidModal"})}catch{}const N=({entityId:a})=>{const{isInExperimentalMode:i}=K(),{entityMetadata:t,annotations:o,isLoading:l}=Z(a),{data:s}=Q(a,{enabled:i});return l?e(ee,{numRows:3,numCols:2}):n(R,{children:[t&&o&&ae(o)?n("div",{className:"placeholder",children:["This"," ",O(k(t.concreteType))," ","has no annotations."]}):null,e("table",{className:"AnnotationsTable",children:n("tbody",{children:[o&&Object.keys(o).map(r=>n("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key",children:r}),e("td",{className:"AnnotationsTable__Row__Value",children:Array.isArray(o[r])?o[r].join(", "):o[r].toString()})]},r)),s&&i?n("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key Schema",children:"Validation Schema"}),e("td",{className:"AnnotationsTable__Row__Value",children:e("a",{href:`${B(F.REPO_ENDPOINT)}repo/v1/schema/type/registered/${s.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:s.jsonSchemaVersionInfo.schemaName})})]}):null]})})]})};try{N.displayName="AnnotationsTable",N.__docgenInfo={description:"",displayName:"AnnotationsTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/metadata/AnnotationsTable.tsx#AnnotationsTable"]={docgenInfo:N.__docgenInfo,name:"AnnotationsTable",path:"src/lib/containers/entity/metadata/AnnotationsTable.tsx#AnnotationsTable"})}catch{}const M=({entityId:a,versionNumber:i})=>{var r,c,y,m,u,_;const{data:t}=L(a,i),o=t&&j(t.entity),l=t?te(t):void 0;let s;return l&&(s=ne(l)),t?e("table",{className:"MetadataTable",children:n("tbody",{children:[n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Name"}),e("td",{className:"MetadataTable__Row__Value",children:(r=t.entity)==null?void 0:r.name})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Type"}),e("td",{className:"MetadataTable__Row__Value",children:O(t.entityType)})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Synapse ID"}),e("td",{className:"MetadataTable__Row__Value",children:(c=t.entity)==null?void 0:c.id})]}),o&&n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Version"}),e("td",{className:"MetadataTable__Row__Value",children:H(t.entity)})]}),s&&n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Storage"}),e("td",{className:"MetadataTable__Row__Value",children:s})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:" Last Modified By"}),n("td",{className:"MetadataTable__Row__Value",children:[e(V,{size:"SMALL USER CARD",ownerId:(y=t.entity)==null?void 0:y.modifiedBy})," ","at ",v(g((m=t.entity)==null?void 0:m.modifiedOn))]})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Created By"}),n("td",{className:"MetadataTable__Row__Value",children:[e(V,{size:"SMALL USER CARD",ownerId:(u=t.entity)==null?void 0:u.createdBy})," ","at ",v(g((_=t.entity)==null?void 0:_.createdOn))]})]})]})}):null};try{M.displayName="MetadataTable",M.__docgenInfo={description:"",displayName:"MetadataTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/metadata/MetadataTable.tsx#MetadataTable"]={docgenInfo:M.__docgenInfo,name:"MetadataTable",path:"src/lib/containers/entity/metadata/MetadataTable.tsx#MetadataTable"})}catch{}var w=(a=>(a.METADATA="METADATA",a.ANNOTATIONS="ANNOTATIONS",a))(w||{});const E=({entityId:a,versionNumber:i,show:t,onClose:o,initialTab:l="METADATA",showTabs:s=!0})=>{const r=h.exports.useRef(null),[c,y]=h.exports.useState(l),[m,u]=h.exports.useState(!1),[_,x]=h.exports.useState(!1),{data:d}=L(a,i),P=d&&d.permissions.canEdit,S=d&&Y(d.entityType),C=S&&d.entity.isLatestVersion;let T,f;return d?window.location.href.includes(a)||(T={skeleton:!1,copy:`Open ${O(d.entityType)}`,onClick:()=>window.open(`${B(F.PORTAL_ENDPOINT)}#!Synapse:${a}`,"_blank","noopener")}):(T={skeleton:!0},f=void 0),c==="ANNOTATIONS"&&(m?(T={copy:"Save Annotations",onClick:()=>{r.current.formElement.dispatchEvent(new CustomEvent("submit",{cancelable:!0,bubbles:!0}))}},f=[{copy:_?"Are you sure? Unsaved changes will be lost":"Cancel",onClick:()=>{_&&u(!1),x(!_)}}]):P&&(f=[{copy:"Edit",disabled:S&&!C,"data-for":"entityModalTooltip","data-tip":S&&!C?"Annotations can only be edited on the latest version":void 0,onClick:()=>{u(!0)}}])),e(R,{children:e(A,{className:`EntityMetadata ${m?"isInEditMode":""}`,title:d?e(p.Title,{children:d.entity.name}):e(q,{width:"40%"}),show:t,onClose:o,primaryAction:T,secondaryActions:f,children:n(R,{children:[s&&!m?e("div",{className:"Tabs",children:Object.keys(w).map(b=>e("div",{className:"Tab",role:"tab",onClick:D=>{D.stopPropagation(),y(w[b])},"aria-selected":b===c,children:b},b))}):null,e("div",{style:c==="ANNOTATIONS"?{}:{display:"none"},children:m?e($,{children:e(X,{entityId:a,formRef:r,onSuccess:()=>{J("Annotations successfully updated.","success"),u(!1)},onCancel:()=>u(!1)})}):e(N,{entityId:a,versionNumber:i})}),e("div",{style:c==="METADATA"?{}:{display:"none"},children:e(M,{entityId:a,versionNumber:i})})]})})})};try{E.displayName="EntityModal",E.__docgenInfo={description:"",displayName:"EntityModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},initialTab:{defaultValue:{value:"EntityModalTabs.METADATA"},description:"",name:"initialTab",required:!1,type:{name:"enum",value:[{value:'"METADATA"'},{value:'"ANNOTATIONS"'}]}},showTabs:{defaultValue:{value:"true"},description:"",name:"showTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/metadata/EntityModal.tsx#EntityModal"]={docgenInfo:E.__docgenInfo,name:"EntityModal",path:"src/lib/containers/entity/metadata/EntityModal.tsx#EntityModal"})}catch{}export{E,A as F,w as a};
