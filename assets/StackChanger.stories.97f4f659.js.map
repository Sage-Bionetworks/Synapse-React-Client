{"version":3,"file":"StackChanger.stories.97f4f659.js","sources":["../../src/lib/containers/StackChanger.tsx"],"sourcesContent":["import { isEqual } from 'lodash-es'\nimport * as React from 'react'\nimport { useEffect, useState } from 'react'\nimport { EndpointObject } from '../utils/functions/getEndpoint'\nimport { getStyleguideStack } from '../utils/SynapseClient'\nimport { STYLEGUIDE_STACK_LOCAL_STORAGE_KEY } from '../utils/SynapseConstants'\nimport { RadioGroup } from './widgets/RadioGroup'\n\ntype Stack = 'production' | 'staging' | 'development'\nconst STACK_MAP: Record<Stack, EndpointObject> = {\n  production: {\n    REPO: 'https://repo-prod.prod.sagebase.org',\n    PORTAL: 'https://www.synapse.org/',\n  },\n  staging: {\n    REPO: 'https://repo-staging.prod.sagebase.org',\n    PORTAL: 'https://staging.synapse.org/',\n  },\n  development: {\n    REPO: 'https://repo-dev.dev.sagebase.org',\n    PORTAL: 'https://portal-dev.dev.sagebase.org/',\n  },\n}\n\nconst StackChanger: React.FC = () => {\n  const [stack, setStack] = useState<Stack>('production')\n\n  useEffect(() => {\n    const stackFromCookie = Object.entries(STACK_MAP).find(entry => {\n      const endpointConfig = entry[1]\n      return isEqual(endpointConfig, getStyleguideStack())\n    })\n\n    if (stackFromCookie) {\n      setStack(stackFromCookie[0] as Stack)\n    } else {\n      setStack('production')\n    }\n  }, [])\n\n  const createStyleguideStackCookie = React.useCallback((stack: Stack) => {\n    const endpointConfig = STACK_MAP[stack]\n    window.localStorage.setItem(\n      STYLEGUIDE_STACK_LOCAL_STORAGE_KEY,\n      JSON.stringify(endpointConfig),\n    )\n    window['SRC'] = {\n      OVERRIDE_ENDPOINT_CONFIG: endpointConfig,\n    }\n  }, [])\n\n  useEffect(() => {\n    createStyleguideStackCookie(stack)\n  }, [createStyleguideStackCookie, stack])\n\n  return (\n    <RadioGroup\n      id={`stack-changer-radio-group`}\n      value={stack}\n      options={[\n        {\n          label: 'Production (synapse.org)',\n          value: 'production',\n        },\n        {\n          label: 'Staging (staging.synapse.org)',\n          value: 'staging',\n        },\n        {\n          label: 'Development (portal-dev.dev.sagebase.org)',\n          value: 'development',\n        },\n      ]}\n      onChange={(value: string) => setStack(value as Stack)}\n    />\n  )\n}\n\nexport default StackChanger\n"],"names":["useEffect","setStack","window","endpointConfig","createStyleguideStackCookie","_jsx","stack"],"mappings":"s4BACA,KAAA,GAAA,OAAA,MACA,EAAA,OAAA,MAAA,kCAOA,EAAA,CAAiD,WAAA,CACnC,KAAA,sCACJ,OAAA,0BACE,EAFE,QAAA,CAIH,KAAA,yCACD,OAAA,8BACE,EAFD,YAAA,CAII,KAAA,oCACL,OAAA,sCACE,CAXqC,EAejD,EAAA,IAAA,CACE,KAAA,CAAA,EAAA,GAAA,EAAA,YAAA,EAEAA,EAAAA,IAAAA,CACE,KAAA,GAAA,OAAA,QAAA,CAAA,EAAA,KAAA,AAAA,GAAA,CACE,KAAA,GAAA,EAAA,GACA,MAAA,GAAA,EAAA,EAAA,CAAA,CAAc,CAAA,EAGhB,AACEC,EADF,AAAA,EACEA,EAAAA,GAEAA,YAFAA,CAGD,EAAA,CAAA,CAAA,EAGH,KAAA,GAAA,EAAA,YAAA,AAAA,GAAA,CACE,KAAA,GAAA,EAAA,GACAC,OAAAA,aAAAA,QAAAA,EAAAA,KAAAA,UAAAA,CAAAA,CAAAA,EAIAA,OAAAA,IAAAA,CAAgB,yBAAA,CACYC,CADZ,EAAA,CAAA,CAAA,EAKlBH,SAAAA,IAAAA,CACEI,EAAAA,CAAAA,CAA2B,EAAA,CAAA,EAAA,CAAA,CAAA,EAG7BC,EAAA,EAAA,CACE,GAAA,4BACO,MAAA,EACEC,QAAAA,CAAAA,CAEL,MAAA,2BACS,MAAA,YACA,EAAA,CAET,MAAA,gCACS,MAAA,SACA,EAAA,CAET,MAAA,4CACS,MAAA,aACA,CAAA,EAXF,SAAA,AAAA,GAAA,EAAA,CAAA,CAc4B,CAAA,CAG1C,EAED,GAAA,GAAA;;;;;;;;;;;;;;;;;;"}