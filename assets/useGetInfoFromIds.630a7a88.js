import{r as g}from"./jsx-runtime.d04151d1.js";import{u as S}from"./use-deep-compare-effect.esm.3b45ff57.js";import{V as O,_ as T,aN as R,c0 as _}from"./EntityTypeUtils.9c2483b3.js";import{u as h,c as k}from"./uniq.485432af.js";import{w as A}from"./without.f73f20c7.js";import{V as y,z as N,x as F,y as D}from"./SynapseConstants.d6ba6a96.js";const b={ownerId:"",firstName:"Unknown",lastName:"Unknown",userName:"Unknown",isIndividual:!1},H={name:"Unknown",id:"unknown",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:0,versionLabel:"placeholder",benefactorId:0,createdOn:"null",modifiedOn:"null",createdBy:"null",modifiedBy:"null",isLatestVersion:!0},v={id:"unknown",etag:"Unknown",name:"Unknown",description:"Unknown",ownerId:"null",createdOn:"null",contentSource:"Unknown",submissionInstructionsMessage:"Unknown",submissionReceiptMessage:"Unknown"},L=async(a,c)=>{const e=await T(a,c),n=a.filter(t=>e.results.map(d=>d.id).indexOf(t.targetId)===-1).map(t=>({...H,id:t.targetId,name:`${t.targetId}`}));return[...e.results,...n]},x=async a=>{const c=(await R(a)).children,i=a.filter(n=>c.map(t=>t.ownerId).indexOf(n)===-1).map(n=>({...b,ownerId:n,name:`Unknown User (${n})`}));return[...c,...i]},P=async(a,c)=>{const e=await _(a,c),n=a.filter(t=>e.results.map(d=>d.id).indexOf(t)===-1).map(t=>({...v,id:t,name:t}));return[...e.results,...n]};function J(a){const{ids:c,type:e}=a,{accessToken:i}=O(),[n,t]=g.exports.useState([]),d=o=>o==="USER_PROFILE"?"ownerId":"id",w=o=>{switch(o){case"USER_PROFILE":return D;case"ENTITY_HEADER":return F;case"EVALUATION_QUEUE":return N;default:return""}},p=n.map(o=>o[d(e)]),U=c.filter(o=>o!==y),I=h(A(U,...p));return g.exports.useEffect(()=>{((l,r)=>{if(!l.length)return;const m=sessionStorage.getItem(w(r));try{const u=m?JSON.parse(m):[],E=u.map(s=>s[d(r)]);for(const s of l)E.includes(s[d(r)])||u.push(s);sessionStorage.setItem(w(r),JSON.stringify(u))}catch{sessionStorage.setItem(w(r),JSON.stringify(l))}})(n,e)},[n,e]),S(()=>{let o=!1;return(async()=>{if(I.length>0)try{const r=Array.from(I),m=e==="ENTITY_HEADER"?r.map(s=>({targetId:s})):r,u=k(m,45),E=[];for(const s of u){let f=[];switch(e){case"USER_PROFILE":f=await x(s);break;case"ENTITY_HEADER":f=await L(s,i);break;case"EVALUATION_QUEUE":f=await P(s,i);break}E.push(...f)}o||t(s=>s.concat(...E))}catch(r){console.error("Error on data retrieval",r)}})(),()=>{o=!0}},[i,e,I]),n}export{J as u};
