import{c as Le,R as we,a as xe,b as Ie,i as Ee,d as be,m as Me,e as Fe,u as le,f as de,M as Ue,S as je,g as H,h as ke}from"./react-router.a49fbac2.js";import{a as ge,_ as Q}from"./withStyles.d50e1a5a.js";import{_ as ue}from"./objectWithoutPropertiesLoose.5e7699d1.js";import{j as e,a as n,F as E}from"./jsx-runtime.00d70968.js";import{f as Be,T as Ve,b4 as He,l as Te,b5 as me,b6 as De,aV as Ke,b7 as Ne,F as $e,b8 as Ye}from"./index.6ac6fc35.js";import{T as d}from"./Typography.e0d7a65e.js";import{I as pe}from"./IconSvg.e3afc045.js";import{S as ee}from"./LoadingScreen.b468edab.js";import"./assert.28421ae9.js";import{h as T}from"./moment.a565bb48.js";import{A as x}from"./AccessApproval.493867d3.js";import{D as I}from"./EntityChildren.50133102.js";import{U as F}from"./UserCard.103461a8.js";import{P as qe}from"./getEndpoint.bb7ded34.js";import{S as k}from"./Sort.1bb6799d.js";import{f as q}from"./DateFormatter.ef532573.js";import{T as he}from"./Table.7797426d.js";import{u as fe}from"./upperFirst.07dbbe8a.js";import{B as _}from"./Button.fda23eee.js";import{S as Ae,u as Ge,a as ze,b as We}from"./AccessSubmission.c859a972.js";import{U as g}from"./UserOrTeamBadge.95414d17.js";import{U as J}from"./UserSearchBoxV2.7fb15184.js";import{A as _e}from"./AccessRequirementSearchBox.a126e498.js";import{c as D,b as Ce}from"./ToastMessage.72011e3e.js";import{o as Se,t as Qe}from"./toLower.004e3a25.js";import{E as Je}from"./EntityTypeUtils.2e1e059f.js";import{E as Xe}from"./EntityFinderModal.be2585f5.js";import{F as Ze}from"./EntityFinder.aa012ef6.js";import{a as er,u as rr,b as tr,c as ar}from"./useGetAccessRequirement.175b0ff9.js";import{E as ir}from"./EntityLink.2d58c874.js";import{I as nr}from"./CalendarWithIconFormGroup.08d53e27.js";import{S as X}from"./ManagedACTAccessRequirementStatus.be369a71.js";import{M as sr}from"./MarkdownSynapse.d883b932.js";import{W as or}from"./WarningModal.8b08a136.js";import{F as cr}from"./FileHandleLink.af421764.js";import{S as w}from"./Skeleton.c897a2bf.js";import"./index.35ce73ec.js";import"./index.440cefe9.js";import"./toConsumableArray.c4898ee4.js";import"./FullWidthAlert.9ae706f1.js";import"./Tooltip.006e7cf4.js";import"./SvgIcon.53be2b5b.js";import"./slicedToArray.e72f11da.js";import"./makeStyles.733638f6.js";import"./index.57d09176.js";import"./InfoOutlined.31277c73.js";import"./Modal.ec8bc390.js";import"./useWaitForDOMRef.064fee4c.js";import"./useWillUnmount.4a16e5cd.js";import"./iframe.ec48e4d2.js";import"./IconCopy.095bf867.js";import"./SkeletonTable.9c89f8b3.js";import"./times.3b46d202.js";import"./toInteger.7d422825.js";import"./Overlay.b3559176.js";import"./usePopperMarginModifiers.0428ddea.js";import"./react-select.esm.73d80da4.js";import"./Select-54ac8379.esm.498ead4f.js";import"./classCallCheck.8304ed06.js";import"./inherits.82916e50.js";import"./useGetInfoFromIds.a1bfd431.js";import"./use-deep-compare-effect.esm.76673280.js";import"./uniq.c37bd06c.js";import"./_cacheHas.3a78be9b.js";import"./_baseDifference.96dac02d.js";import"./_setToArray.a82100c8.js";import"./without.65fb4f50.js";import"./_baseMap.182d8378.js";import"./_baseIsEqual.6385ce8d.js";import"./FileEntity.69b7bd86.js";import"./TypeUtils.a2c41307.js";import"./EntityModal.107fbd0a.js";import"./useEntityBundle.38b0b653.js";import"./HelpPopover.3601bf2a.js";import"./MarkdownPopover.5db4ca4b.js";import"./SchemaDrivenAnnotationEditor.4dee1f1a.js";import"./union.5981aa8f.js";import"./_copyArray.4b650b89.js";import"./ajv.0c368cda.js";import"./isEmpty.060e5fe4.js";import"./lodash.8a515f69.js";import"./Collapse.a100796c.js";import"./groupBy.29d2b88b.js";import"./ExternalFileHandleInterface.55960425.js";import"./pluralize.a0c74801.js";import"./react-sizeme.4b0d4f6e.js";import"./Arrow.c4d06967.js";import"./sqlFunctions.59c64146.js";import"./useGetEntityChildren.b8a28bdc.js";import"./Checkbox.96de280e.js";import"./EntityIcon.6c64fc33.js";import"./SynapseTableConstants.07ecdebd.js";import"./react-intersection-observer.esm.e445ee86.js";import"./LockTwoTone.f1e9a780.js";import"./cloneDeep.ca633d44.js";import"./Dropdown.13d94a98.js";import"./isRequiredForA11y.20ed4857.js";import"./useFavorites.1a27e053.js";import"./index.8ed07549.js";import"./factory.29907778.js";import"./SynapseVideo.3d6e2c0a.js";import"./index.2c7c76ba.js";import"./index.87b84479.js";import"./index.66e0b57e.js";function lr(t,i){const{accessToken:a}=Be();return Ve(["accessApprovalSearch",t],async s=>await He({...t,nextPageToken:s.pageParam},a),{...i,getNextPageParam:s=>s.nextPageToken})}const P=window.React;var dr=function(t){ge(i,t);function i(){for(var s,r=arguments.length,h=new Array(r),o=0;o<r;o++)h[o]=arguments[o];return s=t.call.apply(t,[this].concat(h))||this,s.history=Le(s.props),s}var a=i.prototype;return a.render=function(){return e(we,{history:this.history,children:this.props.children})},i}(P.Component);P.Component;var se=function(i,a){return typeof i=="function"?i(a):i},oe=function(i,a){return typeof i=="string"?Fe(i,null,null,a):i},ve=function(i){return i},O=P.forwardRef;typeof O>"u"&&(O=ve);function ur(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}var mr=O(function(t,i){var a=t.innerRef,s=t.navigate,r=t.onClick,h=ue(t,["innerRef","navigate","onClick"]),o=h.target,l=Q({},h,{onClick:function(p){try{r&&r(p)}catch(A){throw p.preventDefault(),A}!p.defaultPrevented&&p.button===0&&(!o||o==="_self")&&!ur(p)&&(p.preventDefault(),s())}});return ve!==O?l.ref=i||a:l.ref=a,e("a",{...l})}),Pe=O(function(t,i){var a=t.component,s=a===void 0?mr:a,r=t.replace,h=t.to,o=t.innerRef,l=ue(t,["component","replace","to","innerRef"]);return P.createElement(Ie.Consumer,null,function(u){u||Ee(!1);var p=u.history,A=oe(se(h,u.location),u.location),C=A?p.createHref(A):"",f=Q({},l,{href:C,navigate:function(){var b=se(h,u.location),m=be(u.location)===be(oe(b)),c=r||m?p.replace:p.push;c(b)}});return ve!==O?f.ref=i||o:f.innerRef=o,P.createElement(s,f)})}),Oe=function(i){return i},Z=P.forwardRef;typeof Z>"u"&&(Z=Oe);function pr(){for(var t=arguments.length,i=new Array(t),a=0;a<t;a++)i[a]=arguments[a];return i.filter(function(s){return s}).join(" ")}var hr=Z(function(t,i){var a=t["aria-current"],s=a===void 0?"page":a,r=t.activeClassName,h=r===void 0?"active":r,o=t.activeStyle,l=t.className,u=t.exact,p=t.isActive,A=t.location,C=t.sensitive,f=t.strict,R=t.style,b=t.to,m=t.innerRef,c=ue(t,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return P.createElement(Ie.Consumer,null,function(v){v||Ee(!1);var S=A||v.location,y=oe(se(b,S),S),N=y.pathname,B=N&&N.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),L=B?Me(S.pathname,{path:B,exact:u,sensitive:C,strict:f}):null,V=!!(p?p(L,S):L),re=typeof l=="function"?l(V):l,te=typeof R=="function"?R(V):R;V&&(re=pr(re,h),te=Q({},te,o));var ae=Q({"aria-current":V&&s||null,className:re,style:te,to:y},c);return Oe!==Z?ae.ref=i||m:ae.innerRef=m,e(Pe,{...ae})})});const fr=window.React.useEffect,Re=(t,i,a)=>{fr(()=>{const s=setTimeout(()=>t(),a);return()=>clearTimeout(s)},[...i||[],a])},Sr=window.React.useMemo,vr=window.React.useState,Y=({accessorId:t,accessRequirementId:i})=>{var C;const[a,s]=vr({field:x.MODIFIED_ON,direction:I.DESC}),r=Sr(()=>({accessorId:t,accessRequirementId:i,sort:[a]}),[t,i,a]),{data:h,hasNextPage:o,fetchNextPage:l,isLoading:u}=lr(r),p=(C=h==null?void 0:h.pages.flatMap(f=>f.results))!=null?C:[],A=f=>{a.field===f?s({field:f,direction:a.direction===I.DESC?I.ASC:I.DESC}):s({field:f,direction:I.DESC})};return n("div",{className:"AccessApprovalsTable bootstrap-4-backport",children:[n(he,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{children:n("tr",{children:[e("th",{children:"AR ID"}),e("th",{children:"Access Requirement Name"}),e("th",{children:"Submitter"}),e("th",{children:"Status"}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Modified Date"}),e(k,{role:"button",active:a.field===x.MODIFIED_ON,direction:a.field==="MODIFIED_ON"?a.direction==="DESC"?I.DESC:I.ASC:I.DESC,onClick:()=>A(x.MODIFIED_ON)})]})}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Expires"}),e(k,{role:"button",active:a.field===x.EXPIRED_ON,direction:a.field==="EXPIRED_ON"?a.direction==="DESC"?I.DESC:I.ASC:I.DESC,onClick:()=>A(x.EXPIRED_ON)})]})})]})}),e("tbody",{children:p.map(f=>n("tr",{children:[e("td",{children:e("a",{href:`${qe.PORTAL}#!AccessRequirement:AR_ID=${f.accessRequirementId}`,children:f.accessRequirementId})}),e("td",{children:f.accessRequirementName}),e("td",{children:e(F,{size:Te,ownerId:f.submitterId})}),e("td",{children:fe(f.state.toLocaleLowerCase())}),e("td",{children:q(T(f.modifiedOn))}),e("td",{className:`${f.expiredOn?new Date>new Date(f.expiredOn)?"expired":"":"non-expire"} remove-border`,children:f.expiredOn?q(T(f.expiredOn)):"Never"})]},f.id))})]}),u&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!u&&p.length===0&&e(d,{className:"SRC-center-text",variant:"body1",children:"No Results"}),o?e(_,{variant:"outline",onClick:()=>l,children:"Show More"}):""]})};try{Y.displayName="AccessApprovalsTable",Y.__docgenInfo={description:"",displayName:"AccessApprovalsTable",props:{accessorId:{defaultValue:null,description:"",name:"accessorId",required:!0,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AccessApprovalsTable.tsx#AccessApprovalsTable"]={docgenInfo:Y.__docgenInfo,name:"AccessApprovalsTable",path:"src/lib/containers/AccessApprovalsTable.tsx#AccessApprovalsTable"})}catch{}const Rr=window.React.useMemo,br=window.React.useState,U=({showSubmitter:t,showStatus:i,showRequesters:a,accessorId:s,accessRequirementId:r,reviewerId:h,submissionState:o,reviewerFilterType:l})=>{var v;const[u,p]=br({field:Ae.CREATED_ON,direction:I.DESC}),A=Rr(()=>({accessorId:s,accessRequirementId:r,submissionState:o,reviewerId:h,reviewerFilterType:l,sort:[u]}),[s,r,o,h,l,u]),{data:C,hasNextPage:f,fetchNextPage:R,isLoading:b}=Ge(A),m=(v=C==null?void 0:C.pages.flatMap(S=>S.results))!=null?v:[],c=S=>{u.field===S?p({field:S,direction:u.direction==="DESC"?"ASC":"DESC"}):p({field:S,direction:"DESC"})};return n("div",{className:"bootstrap-4-backport AccessSubmissionTable",children:[n(he,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{children:n("tr",{children:[e("th",{children:"REQUEST"}),e("th",{children:"Access Requirement Name"}),t&&e("th",{children:"Submitter"}),i&&e("th",{children:"Status"}),a&&e("th",{children:"Requesters"}),e("th",{children:"Reviewer(s)"}),n("th",{children:["Created Date",e(k,{role:"button",style:{float:"right"},active:u.field==="CREATED_ON","aria-label":"Sort by Created On",direction:u.field==="CREATED_ON"?u.direction==="DESC"?"DESC":"ASC":"DESC",onClick:()=>c(Ae.CREATED_ON)})]})]})}),e("tbody",{children:m.map(S=>n("tr",{children:[e("td",{children:e(Pe,{to:`/Submissions/${S.id}`,children:S.id})}),e("td",{children:S.accessRequirementName}),t&&e("td",{children:e(g,{principalId:S.submitterId})}),i&&e("td",{children:fe(S.state.toLocaleLowerCase())}),a&&n("td",{children:[e(g,{principalId:S.submitterId}),S.accessorChanges.filter(y=>S.submitterId!==y.userId).map(y=>e("li",{children:e(F,{size:Te,ownerId:y.userId,className:"requester"})},y.userId))]}),e("td",{children:S.accessRequirementReviewerIds.length===0?e(g,{principalId:me}):S.accessRequirementReviewerIds.map(y=>e(g,{principalId:y},y))}),e("td",{children:q(T(S.createdOn))})]},S.id))})]}),b&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!b&&m.length==0&&e(d,{className:"SRC-center-text",variant:"body1",children:"No Results"}),f?e(_,{variant:"outline",onClick:()=>R(),children:"Show More"}):""]})};try{U.displayName="AccessRequestSubmissionTable",U.__docgenInfo={description:"",displayName:"AccessRequestSubmissionTable",props:{showSubmitter:{defaultValue:null,description:"",name:"showSubmitter",required:!1,type:{name:"boolean"}},showStatus:{defaultValue:null,description:"",name:"showStatus",required:!1,type:{name:"boolean"}},showRequesters:{defaultValue:null,description:"",name:"showRequesters",required:!1,type:{name:"boolean"}},accessorId:{defaultValue:null,description:"",name:"accessorId",required:!1,type:{name:"string"}},accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!1,type:{name:"string"}},reviewerId:{defaultValue:null,description:"",name:"reviewerId",required:!1,type:{name:"string"}},submissionState:{defaultValue:null,description:"",name:"submissionState",required:!1,type:{name:"enum",value:[{value:'"SUBMITTED"'},{value:'"APPROVED"'},{value:'"REJECTED"'},{value:'"CANCELLED"'}]}},reviewerFilterType:{defaultValue:null,description:"",name:"reviewerFilterType",required:!1,type:{name:"enum",value:[{value:'"ALL"'},{value:'"ACT_ONLY"'},{value:'"DELEGATED_ONLY"'}]}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AccessRequestSubmissionTable.tsx#AccessRequestSubmissionTable"]={docgenInfo:U.__docgenInfo,name:"AccessRequestSubmissionTable",path:"src/lib/containers/AccessRequestSubmissionTable.tsx#AccessRequestSubmissionTable"})}catch{}const Ar=window.React.useCallback,Cr=window.React.useEffect,K=window.React.useState,yr=()=>{const[t,i]=K(),[a,s]=K(""),[r,h]=K({accessorId:a,accessRequirementId:t}),[o,l]=K({showStatus:!0,showSubmitter:!0,accessorId:a,accessRequirementId:t}),u=le(),p=de(),A=500,C=Ar(R=>{s(R||"")},[]);Cr(()=>{(()=>{var m,c;const b=new URLSearchParams(u.search);i((m=b.get("accessRequirementId"))!=null?m:void 0),s((c=b.get("accessorId"))!=null?c:"")})()},[u.search]),Re(()=>{((b,m)=>{const c=new URLSearchParams(Se({accessRequirementId:b,accessorId:m},v=>v===void 0||v===""));p.replace({pathname:u.pathname,search:c.toString()})})(t,a),h({accessorId:a,accessRequirementId:t}),l({showStatus:!0,showSubmitter:!0,accessorId:a,accessRequirementId:t})},[t,a,p,u.pathname],A);const f=()=>n("div",{className:"text-center",children:[e("img",{className:"SearchPlaceholderImage",alt:"Begin searching",src:"https://s3.amazonaws.com/static.synapse.org/images/search-happy.svg"}),e(d,{variant:"body2",children:"Enter a user or team name in the search field above to view their data access history"})]});return n("div",{className:"UserHistoryDashboard bootstrap-4-backport",children:[n("div",{className:"InputPanel",children:[n("div",{children:[e(D,{htmlFor:"user-filter",children:"Select a user to view their access history"}),e(J,{inputId:"user-filter",onChange:C,defaultValue:a,placeholder:"Search for a user name",typeFilter:De.USERS_ONLY})]}),a&&n("div",{children:[e(D,{htmlFor:"arName-filter",children:"Filter by Access Requirement Name"}),e(_e,{inputId:"arName-filter",placeholder:"Search for an Access Requirement Name ",onChange:i})]})]}),a?n(E,{children:[n(d,{variant:"headline3",children:["Submissions including ",e(g,{principalId:a})]}),e(U,{...o}),e(d,{variant:"headline3",children:"Status in Access Requirements"}),e(Y,{...r})]}):e(f,{})]})},wr=window.React,Ir=window.React.useMemo,Er=window.React.useState;function G(t){var m;const{nameContains:i,relatedProjectId:a,reviewerId:s,accessType:r,onCreateNewAccessRequirementClicked:h}=t,[o,l]=Er({field:"CREATED_ON",direction:"DESC"}),u=Ir(()=>({nameContains:i,relatedProjectId:a,reviewerId:s,accessType:r,sort:[o]}),[i,a,s,r,o]),{data:p,hasNextPage:A,fetchNextPage:C,isLoading:f}=er(u),R=(m=p==null?void 0:p.pages.flatMap(c=>c.results))!=null?m:[],b=c=>{o.field===c?l({field:c,direction:o.direction==="DESC"?"ASC":"DESC"}):l({field:c,direction:"DESC"})};return n("div",{className:"bootstrap-4-backport",children:[n("div",{className:"SRC-split",children:[e(d,{variant:"headline3",style:{marginBottom:0},children:"Access Requirements"}),h&&n(_,{variant:"outline",onClick:h,children:[e(pe,{options:{icon:"favTwoTone",padding:"right"}}),"New Access Requirement"]})]}),n("div",{className:"AccessRequirementsTable",children:[n(he,{striped:!0,borderless:!0,bordered:!1,children:[e("thead",{className:"access-requirements-header",children:n("tr",{children:[e("th",{children:"AR ID"}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Access Requirement Name"}),e(k,{role:"button",onClick:()=>b("NAME"),"aria-label":"Sort by Name",active:o.field==="NAME",direction:o.field==="NAME"?o.direction:"DESC"})]})}),e("th",{children:"Related to Projects"}),e("th",{children:"Reviewer"}),e("th",{children:"Last Modified"}),e("th",{children:n("span",{className:"SRC-split",children:[e("span",{children:"Created On"}),e(k,{role:"button",onClick:()=>b("CREATED_ON"),active:o.field==="CREATED_ON","aria-label":"Sort by Created On",direction:o.field==="CREATED_ON"?o.direction:"DESC"})]})})]})}),e("tbody",{children:R.map(c=>n("tr",{children:[e("td",{children:e("a",{href:`${qe.PORTAL}#!AccessRequirement:AR_ID=${c.id}`,children:c.id})}),e("td",{children:c.name}),e("td",{children:c.relatedProjectIds.map(v=>n(wr.Fragment,{children:[e(ir,{entity:v})," ",n("span",{className:"InlineLabel",children:["(",v,")"]}),e("br",{})]},v))}),e("td",{children:c.reviewerIds.length===0?e(g,{principalId:me}):c.reviewerIds.map(v=>e(g,{principalId:v},v))}),e("td",{children:q(T(c.modifiedOn))}),e("td",{children:q(T(c.createdOn))})]},c.id))})]}),f&&e("div",{className:"SRC-center-text",children:e(ee,{size:40})}),!f&&R.length===0&&e(d,{className:"SRC-center-text",variant:"body1",children:"No Results"}),A?e(_,{variant:"outline",onClick:()=>{C()},children:"Show More"}):e(E,{})]})]})}try{G.displayName="AccessRequirementTable",G.__docgenInfo={description:"",displayName:"AccessRequirementTable",props:{nameContains:{defaultValue:null,description:"",name:"nameContains",required:!1,type:{name:"string"}},relatedProjectId:{defaultValue:null,description:"",name:"relatedProjectId",required:!1,type:{name:"string"}},reviewerId:{defaultValue:null,description:"",name:"reviewerId",required:!1,type:{name:"string"}},accessType:{defaultValue:null,description:"",name:"accessType",required:!1,type:{name:"enum",value:[{value:'"CREATE"'},{value:'"READ"'},{value:'"UPDATE"'},{value:'"DELETE"'},{value:'"CHANGE_PERMISSIONS"'},{value:'"DOWNLOAD"'},{value:'"UPLOAD"'},{value:'"PARTICIPATE"'},{value:'"SUBMIT"'},{value:'"READ_PRIVATE_SUBMISSION"'},{value:'"UPDATE_SUBMISSION"'},{value:'"DELETE_SUBMISSION"'},{value:'"TEAM_MEMBERSHIP_UPDATE"'},{value:'"SEND_MESSAGE"'},{value:'"CHANGE_SETTINGS"'},{value:'"MODERATE"'},{value:'"REVIEW_SUBMISSIONS"'}]}},onCreateNewAccessRequirementClicked:{defaultValue:null,description:"",name:"onCreateNewAccessRequirementClicked",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/AccessRequirementTable.tsx#AccessRequirementTable"]={docgenInfo:G.__docgenInfo,name:"AccessRequirementTable",path:"src/lib/containers/dataaccess/AccessRequirementTable.tsx#AccessRequirementTable"})}catch{}const gr=window.React.useCallback,Tr=window.React.useEffect,M=window.React.useState;function z(t){const{onCreateNewAccessRequirementClicked:a}=t,s=le(),r=de(),[h,o]=M(""),[l,u]=M(void 0),[p,A]=M(void 0);Tr(()=>{function c(){var S,y,N;const v=new URLSearchParams(s.search);o((S=v.get("nameContains"))!=null?S:""),u((y=v.get("relatedProjectId"))!=null?y:void 0),A((N=v.get("reviewerId"))!=null?N:void 0)}c()},[s.search]);const[C,f]=M(!1),[R,b]=M({nameContains:h,relatedProjectId:l,reviewerId:p,onCreateNewAccessRequirementClicked:a});Re(()=>{function c(v,S,y){const N=Se({nameContains:v,relatedProjectId:S,reviewerId:y},L=>L===void 0||L===""),B=new URLSearchParams(N);r.replace({pathname:s.pathname,search:B.toString()})}b({nameContains:h,relatedProjectId:l,reviewerId:p,onCreateNewAccessRequirementClicked:a}),c(h,l,p)},[h,l,p,a,r,s.pathname],500);const m=gr(c=>{A(c||void 0)},[]);return n("div",{className:"AccessRequirementDashboard bootstrap-4-backport",children:[e(Xe,{configuration:{initialScope:Ze.ALL_PROJECTS,initialContainer:null,selectMultiple:!1,selectableTypes:[Je.PROJECT]},show:C,onClose:()=>{f(!1)},onCancel:()=>{f(!1)},title:"Select Project to Filter Access Requirements",promptCopy:"Select a project to find Access Requirements that are associated with that project. Access Requirements will be found if the Access Requirement is applied to the project, or if it is applied to any item inside the project.",onConfirm:c=>{u(c[0].targetId),f(!1)},confirmButtonCopy:"Select"}),n("div",{className:"InputPanel",children:[n("div",{children:[e(D,{htmlFor:"ar-name-filter",children:"Filter by Access Requirement Name"}),n(nr,{children:[e(Ce,{id:"ar-name-filter",type:"text",placeholder:"Search for an Access Requirement Name",value:h,onChange:c=>{o(c.target.value)}}),e(pe,{options:{icon:"searchOutlined"}})]})]}),n("div",{children:[e(D,{htmlFor:"project-id-filter",children:"Filter by Project"}),n("div",{className:"ProjectIdInputGroup",children:[e(Ce,{id:"project-id-filter",type:"text",placeholder:"Enter a project SynID",value:l,onChange:c=>{const v=c.target.value;u(v===""?void 0:v)}}),e(_,{variant:"outline",onClick:()=>{f(!0)},children:"Browse"})]})]}),n("div",{children:[e(D,{htmlFor:"reviewer-filter",children:"Filter by Reviewer"}),e(J,{inputId:"reviewer-filter",placeholder:"Search for a username or team name",defaultValue:p,onChange:m})]})]}),e(G,{...R})]})}try{z.displayName="AccessRequirementDashboard",z.__docgenInfo={description:"",displayName:"AccessRequirementDashboard",props:{onCreateNewAccessRequirementClicked:{defaultValue:null,description:"",name:"onCreateNewAccessRequirementClicked",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/AccessRequirementDashboard.tsx#AccessRequirementDashboard"]={docgenInfo:z.__docgenInfo,name:"AccessRequirementDashboard",path:"src/lib/containers/dataaccess/AccessRequirementDashboard.tsx#AccessRequirementDashboard"})}catch{}const ye=window.React.useCallback,Dr=window.React.useEffect,$=window.React.useState,Nr=()=>{const[t,i]=$(),[a,s]=$(),[r,h]=$(),[o,l]=$({accessRequirementId:t,accessorId:a,reviewerId:r,showRequesters:!0,submissionState:X.SUBMITTED}),u=le(),p=de(),A=500;Dr(()=>{(()=>{var m,c,v;const b=new URLSearchParams(u.search);i((m=b.get("accessRequirementId"))!=null?m:void 0),s((c=b.get("accessorId"))!=null?c:void 0),h((v=b.get("reviewerId"))!=null?v:void 0)})()},[u.search]);const C=ye(R=>{s(R||void 0)},[]),f=ye(R=>{h(R||void 0)},[]);return Re(()=>{((b,m,c)=>{const v=new URLSearchParams(Se({accessRequirementId:b,accessorId:m,reviewerId:c},S=>S===void 0||S===""));p.replace({pathname:u.pathname,search:v.toString()})})(t,a,r),l({accessRequirementId:t,accessorId:a,reviewerId:r,showRequesters:!0,submissionState:X.SUBMITTED})},[t,a,r,p,u.pathname],A),n("div",{className:"AccessSubmissionDashboard bootstrap-4-backport",children:[n("div",{className:"InputPanel",children:[n("div",{children:[e(D,{htmlFor:"arId-filter",children:"Filter by Access Requirement Name"}),e(_e,{inputId:"arId-filter",onChange:i,placeholder:"Search for an Access Requirement Name "})]}),n("div",{children:[e(D,{htmlFor:"requester-filter",children:"Filter by Requester"}),e(J,{inputId:"requester-filter",placeholder:"Search for a user name",defaultValue:a,onChange:C,typeFilter:De.USERS_ONLY})]}),n("div",{children:[e(D,{htmlFor:"reviewer-filter",children:"Filter by Reviewer"}),e(J,{inputId:"reviewer-filter",placeholder:"Search for a user or team name",defaultValue:r,onChange:f})]})]}),e(d,{variant:"headline3",children:"Access Request Submissions"}),e(U,{...o})]})},ce=window.React,qr=window.React.useState;function ie(t){const{submissionId:i,fileHandleId:a}=t,s=ce.useMemo(()=>({fileHandleId:a,associateObjectId:i,associateObjectType:$e.DataAccessSubmissionAttachment}),[a,i]);return e(cr,{showDownloadIcon:!0,fileHandleAssociation:s},a)}function _r(t){return e(or,{show:t.show,title:"Approve Request?",modalBody:n(E,{children:[e(d,{variant:"body1",children:"Approving the request will grant access to controlled data."}),e(d,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."})]}),onConfirm:t.onConfirm,onConfirmCallbackArgs:[],onCancel:t.onCancel,confirmButtonText:"Approve"})}function Pr(t){const{data:i}=ar(t.accessRequirementId,{useErrorBoundary:!0});return i?e("div",{className:"AccessRequirementWikiContainer",children:n("div",{className:"AccessRequirementWikiContent",children:[e(d,{variant:"headline1",children:"Access Requirement"}),e("hr",{}),e(sr,{wikiId:i==null?void 0:i.wikiPageId,ownerId:i==null?void 0:i.ownerObjectId,objectType:i==null?void 0:i.ownerObjectType})]})}):e(w,{width:"100%",height:"600px"})}function W(t){var R,b;const{submissionId:i,onRejectClicked:a}=t,s=Ke(),{data:r,refetch:h}=ze(i,{useErrorBoundary:!0}),{mutateAsync:o}=We(),{data:l}=rr(parseInt(r==null?void 0:r.accessRequirementId),{enabled:!!r}),{data:u}=tr(r==null?void 0:r.accessRequirementId,{enabled:!!r,useErrorBoundary:!0}),[p,A]=qr(!1);function C(){var m;return o({submissionId:(m=r==null?void 0:r.id)!=null?m:"",newState:X.APPROVED})}function f(m){var c;return o({submissionId:(c=r==null?void 0:r.id)!=null?c:"",newState:X.REJECTED,rejectedReason:m})}return n("div",{className:"SubmissionPage",children:[e(_r,{show:p,onCancel:()=>{A(!1)},onConfirm:async()=>{try{await C()}catch(m){s(m)}A(!1),h()}}),n("div",{className:"SubmissionSummary",children:[e(d,{variant:"dataFieldKey",children:"Status"}),e(d,{variant:"headline3",children:r?r.state:e(w,{width:100})}),e("br",{}),r?r.state==="SUBMITTED"&&n("div",{className:"bootstrap-4-backport ButtonContainer",children:[e(_,{onClick:()=>{A(!0)},variant:"success",children:"Approve"}),e(_,{onClick:()=>{a(m=>{f(m)})},variant:"danger",children:"Reject"})]}):e(w,{width:200}),e(d,{variant:"dataFieldKey",children:"Access Requirement Name"}),e(d,{variant:"smallText1",children:(R=l==null?void 0:l.name)!=null?R:e(w,{width:100})}),e("br",{}),e(d,{variant:"dataFieldKey",children:"Assigned Reviewer"}),e(d,{variant:"smallText1",children:u!==void 0?u!==null?u.resourceAccess.map(m=>e(g,{principalId:m.principalId},m.principalId)):e(g,{principalId:me}):e(w,{width:100})}),e("br",{}),e(d,{variant:"dataFieldKey",children:"Conditions"}),l?e(d,{variant:"smallText1",children:n("ul",{children:[n("li",{children:["Expiration period:"," ",T.duration(l.expirationPeriod,"milliseconds").asDays()," ","day(s)",l.expirationPeriod===0&&" (no expiration)"]}),l.isCertifiedUserRequired&&e("li",{children:"User must be Certified"}),l.isValidatedProfileRequired&&e("li",{children:"User Profile must be Validated"}),l.isDUCRequired&&e("li",{children:"DUC is required"}),l.isIDURequired&&e("li",{children:"IDU is required"}),l.isIDUPublic&&e("li",{children:"IDU will be made public"}),l.isIRBApprovalRequired&&e("li",{children:"IRB Approval is required"}),l.areOtherAttachmentsRequired&&e("li",{children:"Other attachments are required"})]})}):e(w,{width:100}),e("br",{}),n("div",{className:"SubmissionSummaryGrid",children:[e(d,{variant:"dataFieldKey",children:"Submitted By"}),e(d,{variant:"smallText1",children:r?e(F,{size:"SMALL USER CARD",ownerId:r.submittedBy}):e(w,{width:100})}),e(d,{variant:"dataFieldKey",children:"Submitted On"}),e(d,{variant:"smallText1",children:r?q(T(r.submittedOn)):e(w,{width:100})}),e(d,{variant:"dataFieldKey",children:"Modified By"}),e(d,{variant:"smallText1",children:r?e(F,{size:"SMALL USER CARD",ownerId:r.modifiedBy}):e(w,{width:100})}),e(d,{variant:"dataFieldKey",children:"Modified On"}),e(d,{variant:"smallText1",children:r?q(T(r.modifiedOn)):e(w,{width:100})}),n(d,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${r?` (${r.accessorChanges.length})`:""}`]}),r?r.accessorChanges.map(m=>n(ce.Fragment,{children:[e(d,{className:"Key DataAccessor",variant:"smallText1",children:e("span",{style:{whiteSpace:"nowrap"},children:e(F,{size:"SMALL USER CARD",ownerId:m.userId},m.userId)})}),e(d,{className:"Value DataAccessor",variant:"smallText1",children:fe(Qe(m.type.substring(0,m.type.indexOf("_"))))})]},m.userId)):e(w,{width:100}),e(d,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e(d,{className:"Value",variant:"smallText1",children:r?r.researchProjectSnapshot.institution:e(w,{width:100})}),e(d,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e(d,{className:"Value",variant:"smallText1",children:r?r.researchProjectSnapshot.projectLead:e(w,{width:100})})]})]}),n("div",{className:"SubmissionRightPane",children:[e(Ne,{children:r?e(Pr,{accessRequirementId:r.accessRequirementId}):e(E,{})}),n("div",{children:[(r==null?void 0:r.rejectedReason)&&n(E,{children:[e(d,{variant:"headline1",children:"Reason for rejection given by reviewer"}),e("hr",{}),e(d,{variant:"body1",style:{whiteSpace:"pre-line"},children:r.rejectedReason})]}),e(d,{variant:"headline1",children:"Contents of the Access Request"}),e("hr",{}),((b=r==null?void 0:r.researchProjectSnapshot)==null?void 0:b.intendedDataUseStatement)&&n(E,{children:[e(d,{variant:"headline2",children:"Intended Data Use Statement"}),e(d,{variant:"body1",style:{whiteSpace:"pre-line"},children:r.researchProjectSnapshot.intendedDataUseStatement})]}),e(d,{variant:"headline2",children:"Documents"}),(r==null?void 0:r.ducFileHandleId)&&n(E,{children:[e(d,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e(ie,{submissionId:r.id,fileHandleId:r.ducFileHandleId})]}),(r==null?void 0:r.irbFileHandleId)&&n(E,{children:[e(d,{variant:"smallText2",children:"IRB Approval Letter"}),e(ie,{submissionId:r.id,fileHandleId:r.irbFileHandleId})]}),(r==null?void 0:r.attachments)&&n(E,{children:[e(d,{variant:"smallText2",children:"Other Attachments"}),r.attachments.map(m=>n(ce.Fragment,{children:[e(ie,{submissionId:r.id,fileHandleId:m}),e("br",{})]},m))]})]})]})]})}try{W.displayName="SubmissionPage",W.__docgenInfo={description:"Page for a Data Access Submission that a designated reviewer can view, and choose to approve or reject.",displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}},onRejectClicked:{defaultValue:null,description:'Invoked when a reviewer clicks "Reject". Provides a parameter for an external component to provide a reason for rejection, which will reject the submission when invoked.',name:"onRejectClicked",required:!0,type:{name:"(onReject: (rejectedReason: string) => void) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/SubmissionPage.tsx#SubmissionPage"]={docgenInfo:W.__docgenInfo,name:"SubmissionPage",path:"src/lib/containers/dataaccess/SubmissionPage.tsx#SubmissionPage"})}catch{}const Or=window.React.useCallback;function ne(t){const{href:i,children:a,icon:s}=t;return n(hr,{className:"Tab",role:"tab",to:i,children:[e(pe,{options:{icon:s,padding:"right"}}),e(d,{variant:"buttonLink",children:a})]})}function j(t){const{routerBaseName:i="#!DataAccessManagement:default",useMemoryRouter:a=!1,onRejectSubmissionClicked:s}=t,{data:r,isLoading:h}=Ye(),o=r==null?void 0:r.isACTMember,l=(r==null?void 0:r.isACTMember)||(r==null?void 0:r.isARReviewer),u=Or(p=>a?e(Ue,{...p}):e(dr,{...p}),[a]);return h?e(ee,{size:50}):e(u,{basename:i,children:n("div",{className:"ReviewerDashboard",children:[n("div",{className:"Tabs",role:"tablist",children:[o&&e(ne,{href:"/AccessRequirements",icon:"accessClosed",children:"Access Requirements"}),l&&e(ne,{href:"/Submissions",icon:"discussion",children:"Submissions"}),o&&e(ne,{href:"/UserAccessHistory",icon:"history",children:"User Access History"})]}),e("div",{className:"TabContentContainer",children:e(Ne,{children:n(je,{children:[o&&e(H,{path:"/AccessRequirements",children:e(z,{})}),l&&[e(H,{exact:!0,path:"/Submissions",children:e(Nr,{})},"/Submissions"),e(H,{path:"/Submissions/:id",children:e(Lr,{onRejectSubmissionClicked:s})},"/Submissions/:id")],e(H,{exact:!0,path:"/UserAccessHistory",children:e(yr,{})})]})})})]})})}function Lr(t){const{id:i}=ke();return e(W,{submissionId:i,onRejectClicked:t.onRejectSubmissionClicked})}try{j.displayName="ReviewerDashboard",j.__docgenInfo={description:"",displayName:"ReviewerDashboard",props:{routerBaseName:{defaultValue:null,description:"Used to determine the base path for the component. Default is #!DataAccessManagement:default",name:"routerBaseName",required:!1,type:{name:"string"}},useMemoryRouter:{defaultValue:null,description:"If true use a MemoryRouter, which prevents the browser URL from updating. For demo purposes only.",name:"useMemoryRouter",required:!1,type:{name:"boolean"}},onRejectSubmissionClicked:{defaultValue:null,description:"Used to show the reject submission dialog",name:"onRejectSubmissionClicked",required:!0,type:{name:"(onReject: (reason: string) => void) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/dataaccess/ReviewerDashboard.tsx#ReviewerDashboard"]={docgenInfo:j.__docgenInfo,name:"ReviewerDashboard",path:"src/lib/containers/dataaccess/ReviewerDashboard.tsx#ReviewerDashboard"})}catch{}const Oa={parameters:{storySource:{source:`import React from 'react'
import { ComponentStory, ComponentMeta } from '@storybook/react'

import ReviewerDashboard from './ReviewerDashboard'

// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export
export default {
  title: 'Synapse/Governance/ReviewerDashboard',
  component: ReviewerDashboard,
  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes
  argTypes: {},
} as ComponentMeta<typeof ReviewerDashboard>

// More on component templates: https://storybook.js.org/docs/react/writing-stories/introduction#using-args
const Template: ComponentStory<typeof ReviewerDashboard> = args => (
  <ReviewerDashboard {...args} />
)

export const Demo = Template.bind({})

Demo.args = {
  useMemoryRouter: true,
  routerBaseName: '#!/Other Components/ReviewerDashboard',
}
`,locationsMap:{demo:{startLoc:{col:59,line:15},endLoc:{col:1,line:17},startBody:{col:59,line:15},endBody:{col:1,line:17}}}}},title:"Synapse/Governance/ReviewerDashboard",component:j,argTypes:{}},xr=t=>e(j,{...t}),Mr=xr.bind({});Mr.args={useMemoryRouter:!0,routerBaseName:"#!/Other Components/ReviewerDashboard"};const La=["Demo"];export{Mr as Demo,La as __namedExportsOrder,Oa as default};
