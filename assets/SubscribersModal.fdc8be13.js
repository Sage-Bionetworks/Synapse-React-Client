import{W as o,Y as m,cw as p,cx as I,cy as E,aS as C,cz as M,cA as O,cB as D}from"./EntityTypeUtils.a88da157.js";import{u as R}from"./useInfiniteQuery.e949b068.js";import{u as A}from"./useMutation.7bebd2d5.js";import{D as g}from"./EntityChildren.50133102.js";import{r as h,a as f,j as i}from"./jsx-runtime.7f415a49.js";import{U as B}from"./UserCard.d1f4475d.js";import{h as U}from"./SynapseConstants.d6ba6a96.js";import{M as c}from"./Modal.20d66332.js";import{B as N}from"./Button.7a13a013.js";function z(e,s){const{accessToken:r}=o();return m(["moderators",e],()=>p(r,e),s)}function K(e,s,r,t,a,n){const{accessToken:l}=o();return R(["forumthread",e,"infinite",s,a,r,t],async u=>I(l,e,u.pageParam,s,r,t,a),{...n,getNextPageParam:(u,d)=>{const S=d.flatMap(b=>b.results).length;if(u.totalNumberOfResults>S)return S}})}var w=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(w||{}),T=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(T||{});function L(e,s){const{accessToken:r}=o();return m(["subscriber",e.objectId,e.objectType],()=>E(r,e),s)}function v(e,s,r){const{accessToken:t}=o();return m([t,"subscription",e,s],async()=>{const n={objectType:s,idList:[e],sortByType:T.OBJECT_ID,sortDirection:g.ASC};return(await D(t,n)).results[0]},r)}function y(e){const s=C(),{accessToken:r}=o();return A(t=>M(r,t),{...e,onSuccess:async(t,a,n)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber",a.objectId,a.objectType]),e!=null&&e.onSuccess&&await e.onSuccess(t,a,n)}})}function k(e){const s=C(),{accessToken:r}=o();return A(t=>O(r,t),{...e,onSuccess:async(t,a,n)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber"]),e!=null&&e.onSuccess&&await e.onSuccess(t,a,n)}})}const F=(e,s)=>{const{data:r,isLoading:t}=v(e,s),{data:a}=L({objectId:e,objectType:s}),{mutate:n,isLoading:l}=y(),{mutate:u,isLoading:d}=k(),S=t||l||d,b=h.exports.useCallback(()=>{r?u(r.subscriptionId):n({objectId:e,objectType:s})},[u,e,s,n,r]);return{isLoading:S,subscription:r,toggleSubscribed:b,subscribers:a}},_=({id:e,objectType:s,showModal:r,handleModal:t})=>{const{subscribers:a}=F(e,s);return f("div",{className:"SubscribersModal",children:[a&&a.subscribers.length>0&&i("a",{onClick:()=>t(!0),children:`Followers (${a.subscribers.length})`}),f(c,{className:"bootstrap-4-backport",show:r,onHide:()=>t(!1),animation:!1,children:[i(c.Header,{closeButton:!0,children:i(c.Title,{children:"Followers"})}),i(c.Body,{children:a&&a.subscribers.map(n=>i(B,{ownerId:n,size:U,showCardOnHover:!0},n))}),i(c.Footer,{children:i(N,{variant:"contained",onClick:()=>t(!1),children:"Ok"})})]})]})};try{_.displayName="SubscribersModal",_.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/discussion_forum/SubscribersModal.tsx#SubscribersModal"]={docgenInfo:_.__docgenInfo,name:"SubscribersModal",path:"src/lib/containers/discussion_forum/SubscribersModal.tsx#SubscribersModal"})}catch{}export{w as S,F as a,_ as b,K as c,z as u};
