import{a as n,j as e,F as R,r as h}from"./jsx-runtime.a638b984.js";import{a4 as K,cf as O,ah as k,cD as j,cE as H,ai as Y,aj as $}from"./index.b83134ec.js";import{g as B,B as F}from"./getEndpoint.f1f195f5.js";import{H as U,u as L}from"./AccessRequirementList.41faf05e.js";import{M as p}from"./Modal.b15b7fde.js";import{T as z}from"./Typography.1d6efe32.js";import{S as q}from"./Skeleton.9bd91a4d.js";import{a as G}from"./Tooltip.9be437e1.js";import{B as J}from"./Button.9991ffcd.js";import{d as W}from"./ToastMessage.1f086d0d.js";import{u as Q,S as X}from"./SchemaDrivenAnnotationEditor.fdb7a867.js";import{c as Z}from"./useEntity.4e3ff0bc.js";import{S as ee}from"./SkeletonTable.5915fa08.js";import{i as ae}from"./isEmpty.52a3bb94.js";import{d as g}from"./dayjs.min.101fce52.js";import{f as v}from"./DateFormatter.d4a7e375.js";import{g as te,a as ne}from"./FileHandleUtils.5e9b9263.js";import{U as V}from"./UserCard.48755798.js";function I(a){var l;const{copy:o,skeleton:t,...i}=a;return a.skeleton?e(q,{variant:"rectangular",width:150}):e(G,{title:(l=i["data-tip"])!=null?l:"",placement:"top",enterNextDelay:300,children:e(J,{...i,children:o})})}const A=a=>{var o,t,i;return n(p,{className:`FluidModal bootstrap-4-backport ${(o=a.className)!=null?o:""}`,backdrop:"static",animation:!1,show:a.show,onHide:a.onClose,children:[e(p.Header,{closeButton:!0,children:e(p.Title,{children:n(z,{variant:"headline1",component:"span",children:[a.title,a.titlePopoverProps&&e(U,{placement:"right",...a.titlePopoverProps,className:"SRC-margin-left-5 "+((i=(t=a.titlePopoverProps)==null?void 0:t.className)!=null?i:"")})]})})}),e(p.Body,{children:a.children}),n(p.Footer,{children:[a.secondaryActions&&a.secondaryActions.reverse().map((l,s)=>e(I,{variant:"outline",...l},s)),a.primaryAction&&e(I,{variant:"sds-primary",...a.primaryAction})]})]})};try{A.displayName="FluidModal",A.__docgenInfo={description:"Full-screen modal that scales with screen size. Fits requirements defined in SWC-5801",displayName:"FluidModal",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string | Element"}},titlePopoverProps:{defaultValue:null,description:"",name:"titlePopoverProps",required:!1,type:{name:"HelpPopoverProps"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},primaryAction:{defaultValue:null,description:"",name:"primaryAction",required:!1,type:{name:"ModalAction"}},secondaryActions:{defaultValue:null,description:"",name:"secondaryActions",required:!1,type:{name:"ModalAction[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/FluidModal.tsx#FluidModal"]={docgenInfo:A.__docgenInfo,name:"FluidModal",path:"src/lib/containers/FluidModal.tsx#FluidModal"})}catch{}const N=({entityId:a})=>{const{isInExperimentalMode:o}=K(),{entityMetadata:t,annotations:i,isLoading:l}=Z(a),{data:s}=Q(a,{enabled:o});return l?e(ee,{numRows:3,numCols:2}):n(R,{children:[t&&i&&ae(i)?n("div",{className:"placeholder",children:["This"," ",O(k(t.concreteType))," ","has no annotations."]}):null,e("table",{className:"AnnotationsTable",children:n("tbody",{children:[i&&Object.keys(i).map(r=>n("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key",children:r}),e("td",{className:"AnnotationsTable__Row__Value",children:Array.isArray(i[r])?i[r].join(", "):i[r].toString()})]},r)),s&&o?n("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key Schema",children:"Validation Schema"}),e("td",{className:"AnnotationsTable__Row__Value",children:e("a",{href:`${B(F.REPO_ENDPOINT)}repo/v1/schema/type/registered/${s.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:s.jsonSchemaVersionInfo.schemaName})})]}):null]})})]})};try{N.displayName="AnnotationsTable",N.__docgenInfo={description:"",displayName:"AnnotationsTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/metadata/AnnotationsTable.tsx#AnnotationsTable"]={docgenInfo:N.__docgenInfo,name:"AnnotationsTable",path:"src/lib/containers/entity/metadata/AnnotationsTable.tsx#AnnotationsTable"})}catch{}const M=({entityId:a,versionNumber:o})=>{var r,c,y,m,u,_;const{data:t}=L(a,o),i=t&&j(t.entity),l=t?te(t):void 0;let s;return l&&(s=ne(l)),t?e("table",{className:"MetadataTable",children:n("tbody",{children:[n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Name"}),e("td",{className:"MetadataTable__Row__Value",children:(r=t.entity)==null?void 0:r.name})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Type"}),e("td",{className:"MetadataTable__Row__Value",children:O(t.entityType)})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Synapse ID"}),e("td",{className:"MetadataTable__Row__Value",children:(c=t.entity)==null?void 0:c.id})]}),i&&n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Version"}),e("td",{className:"MetadataTable__Row__Value",children:H(t.entity)})]}),s&&n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Storage"}),e("td",{className:"MetadataTable__Row__Value",children:s})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:" Last Modified By"}),n("td",{className:"MetadataTable__Row__Value",children:[e(V,{size:"SMALL USER CARD",ownerId:(y=t.entity)==null?void 0:y.modifiedBy})," ","at ",v(g((m=t.entity)==null?void 0:m.modifiedOn))]})]}),n("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Created By"}),n("td",{className:"MetadataTable__Row__Value",children:[e(V,{size:"SMALL USER CARD",ownerId:(u=t.entity)==null?void 0:u.createdBy})," ","at ",v(g((_=t.entity)==null?void 0:_.createdOn))]})]})]})}):null};try{M.displayName="MetadataTable",M.__docgenInfo={description:"",displayName:"MetadataTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/metadata/MetadataTable.tsx#MetadataTable"]={docgenInfo:M.__docgenInfo,name:"MetadataTable",path:"src/lib/containers/entity/metadata/MetadataTable.tsx#MetadataTable"})}catch{}var w=(a=>(a.METADATA="METADATA",a.ANNOTATIONS="ANNOTATIONS",a))(w||{});const E=({entityId:a,versionNumber:o,show:t,onClose:i,initialTab:l="METADATA",showTabs:s=!0})=>{const r=h.exports.useRef(null),[c,y]=h.exports.useState(l),[m,u]=h.exports.useState(!1),[_,x]=h.exports.useState(!1),{data:d}=L(a,o),D=d&&d.permissions.canEdit,S=d&&Y(d.entityType),C=S&&d.entity.isLatestVersion;let T,f;return d?window.location.href.includes(a)||(T={skeleton:!1,copy:`Open ${O(d.entityType)}`,onClick:()=>window.open(`${B(F.PORTAL_ENDPOINT)}#!Synapse:${a}`,"_blank","noopener")}):(T={skeleton:!0},f=void 0),c==="ANNOTATIONS"&&(m?(T={copy:"Save Annotations",onClick:()=>{r.current.formElement.dispatchEvent(new CustomEvent("submit",{cancelable:!0,bubbles:!0}))}},f=[{copy:_?"Are you sure? Unsaved changes will be lost":"Cancel",onClick:()=>{_&&u(!1),x(!_)}}]):D&&(f=[{copy:"Edit",disabled:S&&!C,"data-for":"entityModalTooltip","data-tip":S&&!C?"Annotations can only be edited on the latest version":void 0,onClick:()=>{u(!0)}}])),e(R,{children:e(A,{className:`EntityMetadata ${m?"isInEditMode":""}`,title:d?e(p.Title,{children:d.entity.name}):e(q,{width:"40%"}),show:t,onClose:i,primaryAction:T,secondaryActions:f,children:n(R,{children:[s&&!m?e("div",{className:"Tabs",children:Object.keys(w).map(b=>e("div",{className:"Tab",role:"tab",onClick:P=>{P.stopPropagation(),y(w[b])},"aria-selected":b===c,children:b},b))}):null,e("div",{style:c==="ANNOTATIONS"?{}:{display:"none"},children:m?e($,{children:e(X,{entityId:a,formRef:r,onSuccess:()=>{W("Annotations successfully updated.","success"),u(!1)},onCancel:()=>u(!1)})}):e(N,{entityId:a,versionNumber:o})}),e("div",{style:c==="METADATA"?{}:{display:"none"},children:e(M,{entityId:a,versionNumber:o})})]})})})};try{E.displayName="EntityModal",E.__docgenInfo={description:"",displayName:"EntityModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},initialTab:{defaultValue:{value:"EntityModalTabs.METADATA"},description:"",name:"initialTab",required:!1,type:{name:"enum",value:[{value:'"METADATA"'},{value:'"ANNOTATIONS"'}]}},showTabs:{defaultValue:{value:"true"},description:"",name:"showTabs",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/metadata/EntityModal.tsx#EntityModal"]={docgenInfo:E.__docgenInfo,name:"EntityModal",path:"src/lib/containers/entity/metadata/EntityModal.tsx#EntityModal"})}catch{}export{E,A as F,w as a};
