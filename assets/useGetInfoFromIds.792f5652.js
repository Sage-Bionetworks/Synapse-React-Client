import{r as O}from"./jsx-runtime.7bb0e56b.js";import{u as R}from"./use-deep-compare-effect.esm.ccd46efa.js";import{h,az as y,n as U,al as F,aC as _,aB as T}from"./index.cdf5fd1c.js";import{u as D,c as N}from"./uniq.42abbfdd.js";import{w as k}from"./without.5aa1f5f1.js";const L={ownerId:"",firstName:"Unknown",lastName:"Unknown",userName:"Unknown",isIndividual:!1},P={name:"Unknown",id:"unknown",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:0,versionLabel:"placeholder",benefactorId:0,createdOn:"null",modifiedOn:"null",createdBy:"null",modifiedBy:"null",isLatestVersion:!0},A=async(o,c)=>{const n=await U(o,c),t=o.filter(s=>n.results.map(m=>m.id).indexOf(s.targetId)===-1).map(s=>({...P,id:s.targetId,name:`${s.targetId}`}));return[...n.results,...t]},H=async o=>{const c=(await F(o)).children,l=o.filter(t=>c.map(s=>s.ownerId).indexOf(t)===-1).map(t=>({...L,ownerId:t,name:`Unknown User (${t})`}));return[...c,...l]};function B(o){const{ids:c,type:n}=o,{accessToken:l}=h(),[t,s]=O.exports.useState([]),m=e=>e==="USER_PROFILE"?"ownerId":"id",f=e=>e==="USER_PROFILE"?_:T,w=t.map(e=>e[m(n)]),p=c.filter(e=>e!==y),I=D(k(p,...w)),E=(e,i)=>{if(!e.length)return;const a=sessionStorage.getItem(f(i));try{const d=a?JSON.parse(a):[],g=d.map(r=>r[m(i)]);for(const r of e)g.includes(r[m(i)])||d.push(r);sessionStorage.setItem(f(i),JSON.stringify(d))}catch{sessionStorage.setItem(f(i),JSON.stringify(e))}};return R(()=>{let e=!1;return(async()=>{if(I.length>0)try{const a=Array.from(I),d=n==="USER_PROFILE"?a:a.map(u=>({targetId:u})),g=N(d,45),r=[];for(const u of g){const S=n==="USER_PROFILE"?await H(u):await A(u,l);r.push(...S)}e||s(u=>u.concat(...r))}catch(a){console.error("Error on data retrieval",a)}E(t,n)})(),()=>{e=!0}},[l,n,I]),t}export{B as u};
