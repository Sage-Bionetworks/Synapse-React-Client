import{i as me}from"./isEmpty.f18793ff.js";import{j as n,a as u,F as R}from"./jsx-runtime.2e925369.js";import{g as be,B as _e}from"./getEndpoint.0de7fccf.js";import{aZ as re,w as pe,bF as Te,bA as fe,bG as ve,bH as Oe,aV as oe,bI as ye,bz as Ae,bJ as Ee}from"./index.29a7f152.js";import"./assert.f243583f.js";import{S as we}from"./LoadingScreen.56f18e4f.js";import{l as Ve}from"./lodash.80bd72c0.js";import{u as qe}from"./useListState.7f5a3e64.js";import{F as Ne}from"./FullWidthAlert.e7125a09.js";import{a as Fe,C as Re}from"./Collapse.fe074047.js";import{c as W,b as le}from"./toString.8ef640ae.js";import{c as he}from"./createSvgIcon.d78a924b.js";import{B as q}from"./Button.c582ea4c.js";import{g as De,f as xe}from"./groupBy.bee027c2.js";import{h as Le}from"./moment.53181859.js";import{C as Ie}from"./CalendarWithIconFormGroup.068cfebc.js";import{a as ke}from"./use-deep-compare-effect.esm.9d3fc03b.js";import{T as Be}from"./Tooltip.6c95fe7b.js";import{d as Pe}from"./ToastMessage.f82ed562.js";import{_ as te}from"./toConsumableArray.b3669986.js";import{_ as We}from"./classCallCheck.8304ed06.js";import{j as $e}from"./withStyles.8be28b48.js";import{_ as je}from"./inherits.98d6a15d.js";import{a as Ke,m as Ye,_ as Je,d as de,S as He,g as Me,e as Ge,c as Ue}from"./stateManager-845a3300.esm.2aae5abd.js";import{A as j}from"./Alert.eafe86e9.js";import{M as L}from"./Modal.58357e58.js";const Xe=window.React;var ze=he(Xe.createElement("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}));const Ze=window.React;var ge=he(Ze.createElement("path",{d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"}));function Qe(e,t){const{accessToken:a}=pe();return re(fe.boundJSONSchema(e),()=>Te(e,a),t)}function Ut(e,t){const{accessToken:a}=pe();return re(fe.schemaValidationResults(e),()=>ve(e,a),t)}function et(e,t){return re(["schema",e],async()=>(await Oe(e)).validationSchema,t)}const k=e=>{var t;return n("svg",{...e,className:`SRC-add-to-list-icon ${(t=e.className)!=null?t:""}`,style:{...e.style},width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:n("path",{d:"M14 10H2V12H14V10ZM14 6H2V8H14V6ZM18 14V10H16V14H12V16H16V20H18V16H22V14H18ZM2 16H10V14H2V16Z",fill:"#515359"})})};try{k.displayName="AddToList",k.__docgenInfo={description:"",displayName:"AddToList",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/assets/icons/AddToList.tsx#AddToList"]={docgenInfo:k.__docgenInfo,name:"AddToList",path:"src/lib/assets/icons/AddToList.tsx#AddToList"})}catch{}function B(e){const{description:t,required:a,type:i,show:d}=e;return n(Fe,{className:"field-description",in:d,children:n("table",{className:"FieldDescriptionTable",children:u("tbody",{children:[t&&u("tr",{children:[n("th",{children:"Description"}),n("td",{children:t})]}),u("tr",{children:[n("th",{children:"Type"}),n("td",{children:i})]}),u("tr",{children:[n("th",{children:"Required"}),n("td",{children:a?"Yes":"No"})]})]})})})}try{B.displayName="FieldDescriptionTable",B.__docgenInfo={description:"",displayName:"FieldDescriptionTable",props:{type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"string"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}},show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/FieldDescriptionTable.tsx#FieldDescriptionTable"]={docgenInfo:B.__docgenInfo,name:"FieldDescriptionTable",path:"src/lib/containers/entity/annotations/FieldDescriptionTable.tsx#FieldDescriptionTable"})}catch{}const tt=window.JSONSchemaForm.utils,nt=window.React.useEffect,at=window.React.useState;function P(e){var l;const{DescriptionField:t}=e,a=e.schema[tt.ADDITIONAL_PROPERTY_FLAG];nt(()=>{e.items.length===0&&e.onAddClick()},[e]);const[i,d]=at(!1);return u(oe,{className:e.className,children:[u("div",{className:"LabelContainer",children:[u(W,{children:[e.title,e.required&&n("span",{className:"required",children:"*"})]}),!a&&n("button",{"aria-label":"More Info","aria-expanded":i,onClick:o=>{o.preventDefault(),d(!i)},children:n(ge,{className:"HelpButton SRC-primary-text-color"})})]}),e.items&&u(R,{children:[e.items.map((o,c)=>u("div",{className:"array-item",children:[o.children,(a||e.items.length>1)&&n(q,{"aria-label":`Remove ${e.title}[${c}]`,variant:"transparent-primary-500",className:"RemoveButton",disabled:e.disabled,onClick:o.onDropIndexClick(o.index),children:n(Re,{})}),e.canAdd&&c===e.items.length-1&&n(q,{"aria-label":`Add new ${e.title}`,variant:"primary-500",className:"AddButton",onClick:e.onAddClick,type:"button",disabled:e.disabled,children:n(ze,{})})]},o.key)),e.items.length===0&&n("div",{style:{display:"flex"},children:n(q,{variant:"primary-500",onClick:e.onAddClick,type:"button",disabled:e.disabled,children:"Add Value"})})]}),n(B,{required:e.required,type:e.schema.type,description:n(t,{id:`${e.idSchema.$id}__description`,description:(l=e.schema.description)!=null?l:""}),show:i})]})}try{P.displayName="CustomArrayFieldTemplate",P.__docgenInfo={description:`Custom field template for array properties in a react-jsonschema-form component.
Used just to apply custom styling.`,displayName:"CustomArrayFieldTemplate",props:{DescriptionField:{defaultValue:null,description:"",name:"DescriptionField",required:!0,type:{name:"StatelessComponent<{ id: string; description: string | ReactElement<any, string | JSXElementConstructor<any>>; }>"}},TitleField:{defaultValue:null,description:"",name:"TitleField",required:!0,type:{name:"StatelessComponent<{ id: string; title: string; required: boolean; }>"}},canAdd:{defaultValue:null,description:"",name:"canAdd",required:!0,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},idSchema:{defaultValue:null,description:"",name:"idSchema",required:!0,type:{name:"IdSchema<any>"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"{ children: ReactElement<any, string | JSXElementConstructor<any>>; className: string; disabled: boolean; hasMoveDown: boolean; hasMoveUp: boolean; ... 7 more ...; key: string; }[]"}},onAddClick:{defaultValue:null,description:"",name:"onAddClick",required:!0,type:{name:"(event?: any) => void"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"UiSchema"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},formContext:{defaultValue:null,description:"",name:"formContext",required:!0,type:{name:"any"}},formData:{defaultValue:null,description:"",name:"formData",required:!0,type:{name:"T"}},registry:{defaultValue:null,description:"",name:"registry",required:!0,type:{name:"Registry"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomArrayFieldTemplate.tsx#CustomArrayFieldTemplate"]={docgenInfo:P.__docgenInfo,name:"CustomArrayFieldTemplate",path:"src/lib/containers/entity/annotations/CustomArrayFieldTemplate.tsx#CustomArrayFieldTemplate"})}catch{}const it=window.JSONSchemaForm.utils,K=window.React.useEffect,ne=window.React.useState,Se=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/;var Y=(e=>(e.STRING="String",e.INTEGER="Integer",e.FLOAT="Float",e.BOOLEAN="Boolean",e.DATETIME="Datetime",e))(Y||{}),Ce=(e=>(e.TextWidget="TextWidget",e.DateTimeWidget="DateTimeWidget",e.CheckboxWidget="CheckboxWidget",e))(Ce||{});function J(e){return e.every(t=>typeof t=="number"||t==="NaN")?e.every(t=>Number.isInteger(t))?"Integer":"Float":e.every(t=>typeof t=="boolean")?"Boolean":e.every(t=>typeof t=="string")&&e.every(t=>!!Se.exec(t))?"Datetime":"String"}function ae(e,t){switch(t){case"Integer":return e.map(a=>Number.isNaN(Number(a))?void 0:Math.floor(Number(a)));case"Float":return e.map(a=>{const i=parseFloat(a);return Number.isNaN(i)?"NaN":Number.isInteger(i)?i.toFixed(1):i});case"Datetime":return e.map(a=>{if(typeof a=="string"&&Se.exec(a))return a});case"Boolean":return e.map(a=>!!a);case"String":default:return e.map(a=>String(a))}}function H(e){switch(e){case"Datetime":return"DateTimeWidget";case"Boolean":return"CheckboxWidget";case"String":case"Integer":case"Float":default:return"TextWidget"}}function M(e){function t(f){return Array.isArray(f)?f:typeof f=="string"?f.split(",").map(v=>v.trim()):[f]}const{id:a,formData:i,onChange:d,registry:l,schema:o,name:c,onDropPropertyClick:r,uiSchema:S}=e,{list:s,handleListChange:p,handleListRemove:g,appendToList:b,setList:m}=qe(t(i)),[y,_]=ne(J(s)),[h,E]=ne(y),[w,C]=ne("TextWidget");K(()=>{setTimeout(()=>{d(s)},50)},[]),K(()=>{function f(){const v=s.length===0||s.every(V=>V==null||V==""),N=ae(s,h);(v||h!==y)&&Ve.exports.isEqual(s,N)&&_(h)}f()},[h]),K(()=>{function f(){const v=ae(s,h);_(h),C(H(h)),m(v)}f()},[y]),K(()=>{d(s)},[d,s]);const O=it.getWidget(o,Ce[w],l.widgets),T=s.map((f,v)=>{var N,V,D;return{children:n(O,{id:`${c}-${v}`,"aria-label":`${c}-${v}`,schema:o,value:f,onChange:F=>{p(v)(F)},uiSchema:S,required:e.required,disabled:e.disabled,readonly:e.readonly,autofocus:e.autofocus,placeholder:(N=e.placeholder)!=null?N:"",options:{},formContext:e.formContext,onFocus:e.onFocus,onBlur:(F,$)=>{m(ae(s,y)),e.onBlur(F,$)},label:(V=e.title)!=null?V:"",multiple:!0,rawErrors:[],registry:l}),onDropIndexClick:()=>s.length===1?r(c):g(v),className:(D=e.className)!=null?D:"",disabled:e.disabled,hasMoveDown:!1,hasMoveUp:!1,hasRemove:!1,hasToolbar:!1,index:v,onAddIndexClick:()=>()=>{},onReorderClick:()=>()=>{},readonly:e.readonly,key:`${v}`}});return u(R,{children:[u(oe,{className:"col-xs-3",children:[n(W,{htmlFor:`${a}-type`,children:"Type"}),n(le,{as:"select",role:"listbox",disabled:e.disabled,readOnly:e.readonly,value:y,required:!0,id:`${a}-type`,onChange:f=>{E(f.target.value)},children:Object.keys(Y).map(f=>n("option",{value:Y[f],children:Y[f]},f))})]}),n(P,{className:"col-xs-6",onAddClick:()=>b(null),canAdd:!0,title:c,schema:o,items:T,registry:l,DescriptionField:()=>null,TitleField:()=>null,disabled:e.disabled,idSchema:e.idSchema,readonly:e.readonly,required:e.required,uiSchema:e.uiSchema,formContext:e.formContext,formData:e.formData}),y!==h&&n(Ne,{variant:"warning",title:"Data may be lost when converting types",description:`Are you sure you want to convert ${c} from ${y} to ${h}? Current values may be lost on conversion.`,primaryButtonConfig:{text:"Convert",onClick:()=>{_(h)}},secondaryButtonConfig:{text:"Cancel",onClick:()=>{E(y)}},isGlobal:!1})]})}try{J.displayName="guessPropertyType",J.__docgenInfo={description:"",displayName:"guessPropertyType",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/AdditionalPropertiesSchemaField.tsx#guessPropertyType"]={docgenInfo:J.__docgenInfo,name:"guessPropertyType",path:"src/lib/containers/entity/annotations/AdditionalPropertiesSchemaField.tsx#guessPropertyType"})}catch{}try{H.displayName="getWidgetFromPropertyType",H.__docgenInfo={description:"",displayName:"getWidgetFromPropertyType",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/AdditionalPropertiesSchemaField.tsx#getWidgetFromPropertyType"]={docgenInfo:H.__docgenInfo,name:"getWidgetFromPropertyType",path:"src/lib/containers/entity/annotations/AdditionalPropertiesSchemaField.tsx#getWidgetFromPropertyType"})}catch{}try{M.displayName="AdditionalPropertiesSchemaField",M.__docgenInfo={description:`react-jsonschema-form SchemaField override for "additionalProperties" only.
Modifies the data to provide full compatibility with Synapse annotations features.

This component provides these enhancements to the SchemaField:
- Supports selecting a type, and changing the input widget appropriately
- Identifying the type on mount
- Treat all field values as arrays
- When the last array value is removed, remove the entire key from the form.`,displayName:"AdditionalPropertiesSchemaField",props:{onDropPropertyClick:{defaultValue:null,description:"",name:"onDropPropertyClick",required:!0,type:{name:"(key: string) => (event: any) => void"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/AdditionalPropertiesSchemaField.tsx#AdditionalPropertiesSchemaField"]={docgenInfo:M.__docgenInfo,name:"AdditionalPropertiesSchemaField",path:"src/lib/containers/entity/annotations/AdditionalPropertiesSchemaField.tsx#AdditionalPropertiesSchemaField"})}catch{}function rt(e){const t={};return Object.keys(e).forEach(a=>{let i=e[a];Array.isArray(i)?(i=i.filter(d=>d!=null),me(i)||(t[a]=i)):t[a]=i}),t}function se(e){return e.property.startsWith("[")?e.property.substring(2,e.property.length-2):e.property.startsWith(".")?e.property.substring(1):e.property}function ot(e){const t=De(e,a=>a.property);return Object.keys(t).map(a=>{const i=t[a];i.some(o=>o.message==="should match some schema in anyOf")&&i.every(o=>o.message==="should be string"||o.message==="should be equal to constant"?!0:o.message==="should match some schema in anyOf")&&i.length>0&&(i[0].message="should be equal to one of the allowed values",t[a]=[i[0]])}),e=xe(t),e=e.map(a=>{const i=se(a);return ye.includes(i)&&(a.message=`"${i}" is a reserved internal key and cannot be used.`),a}),e}const G=e=>{const{id:t,label:a,children:i,errors:d,help:l,description:o,hidden:c,required:r,displayLabel:S,classNames:s,disabled:p,onKeyChange:g,readonly:b}=e,m="Key";return c?n("div",{className:"hidden",children:i}):n("div",{className:`${s!=null?s:""} container-fluid`,children:u("div",{className:"row form-additional",children:[n("div",{className:"col-xs-3",children:u(oe,{children:[n(W,{id:`${t}-key-label`,htmlFor:`${t}-key`,children:m}),n(le,{type:"text",disabled:p,readOnly:b,defaultValue:a,required:r,id:`${t}-key`,onBlur:y=>{y.preventDefault(),g(y.target.value)}})]})}),S&&n(W,{id:t,children:a}),S&&o?o:null,i,d,l]})})};try{G.displayName="CustomAdditionalPropertiesFieldTemplate",G.__docgenInfo={description:`FieldTemplate override for "additionalProperties" fields to customize the form appearance.

Adapted from 'WrapIfAdditional' in @rsjf/core.`,displayName:"CustomAdditionalPropertiesFieldTemplate",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},classNames:{defaultValue:null,description:"",name:"classNames",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawDescription:{defaultValue:null,description:"",name:"rawDescription",required:!0,type:{name:"string"}},errors:{defaultValue:null,description:"",name:"errors",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawErrors:{defaultValue:null,description:"",name:"rawErrors",required:!0,type:{name:"string[]"}},help:{defaultValue:null,description:"",name:"help",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawHelp:{defaultValue:null,description:"",name:"rawHelp",required:!0,type:{name:"string"}},hidden:{defaultValue:null,description:"",name:"hidden",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},displayLabel:{defaultValue:null,description:"",name:"displayLabel",required:!0,type:{name:"boolean"}},fields:{defaultValue:null,description:"",name:"fields",required:!0,type:{name:"Field[]"}},schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"UiSchema"}},formContext:{defaultValue:null,description:"",name:"formContext",required:!0,type:{name:"any"}},formData:{defaultValue:null,description:"",name:"formData",required:!0,type:{name:"any"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: any) => void"}},onKeyChange:{defaultValue:null,description:"",name:"onKeyChange",required:!0,type:{name:"((value: string) => () => void) & ((newKey: string) => void)"}},onDropPropertyClick:{defaultValue:null,description:"",name:"onDropPropertyClick",required:!0,type:{name:"(value: string) => () => void"}},registry:{defaultValue:null,description:"",name:"registry",required:!0,type:{name:"Registry"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomAdditionalPropertiesFieldTemplate.tsx#CustomAdditionalPropertiesFieldTemplate"]={docgenInfo:G.__docgenInfo,name:"CustomAdditionalPropertiesFieldTemplate",path:"src/lib/containers/entity/annotations/CustomAdditionalPropertiesFieldTemplate.tsx#CustomAdditionalPropertiesFieldTemplate"})}catch{}const U=({id:e,disabled:t,value:a,onChange:i})=>u(le,{id:e,as:"select",disabled:t,value:a===void 0?a:`${a}`,onChange:d=>{const l=d.target.value;l===""?i(void 0):l==="true"?i(!0):l==="false"&&i(!1)},children:[n("option",{value:""}),n("option",{value:"true",children:"true"}),n("option",{value:"false",children:"false"})]});try{U.displayName="CustomBooleanWidget",U.__docgenInfo={description:"Select widget compatible with react-jsonschema-form booleans",displayName:"CustomBooleanWidget",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomBooleanWidget.tsx#CustomBooleanWidget"]={docgenInfo:U.__docgenInfo,name:"CustomBooleanWidget",path:"src/lib/containers/entity/annotations/CustomBooleanWidget.tsx#CustomBooleanWidget"})}catch{}const X=({disabled:e,value:t,onChange:a})=>n(Ie,{disabled:e,value:t?Le(t):"",setterCallback:i=>{i==null||typeof i=="string"?a(i):a(i.toISOString())}});try{X.displayName="CustomDateTimeWidget",X.__docgenInfo={description:"DateTime picker widget compatible with react-jsonschema-form and Synapse Datetime annotations.",displayName:"CustomDateTimeWidget",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomDateTimeWidget.tsx#CustomDateTimeWidget"]={docgenInfo:X.__docgenInfo,name:"CustomDateTimeWidget",path:"src/lib/containers/entity/annotations/CustomDateTimeWidget.tsx#CustomDateTimeWidget"})}catch{}const lt=window.React.useEffect,st=window.React.useState;function z(e){var y;const{id:t,label:a,children:i,errors:d,help:l,hidden:o,required:c,displayLabel:r,formData:S,onChange:s,schema:p}=e;let g=(y=e.description)!=null?y:e.schema.description;const[b,m]=st(!1);return lt(()=>{if(p.type!=="array"&&Array.isArray(S)){const _=S.map(h=>`${h}`).join(", ");setTimeout(()=>{s(_)},50)}},[]),o?n("div",{className:"hidden",children:i}):u(R,{children:[a&&(r||p.type==="boolean")&&u("div",{className:"LabelContainer",children:[u(W,{htmlFor:t,children:[a,c&&n("span",{className:"required",children:"*"})]}),n("button",{"aria-label":"More Info","aria-expanded":b,onClick:_=>{_.preventDefault(),m(!b)},children:n(ge,{className:"HelpButton SRC-primary-text-color"})})]}),i,n(B,{required:c,type:p.type,description:g,show:b}),d,l]})}try{z.displayName="CustomDefaultTemplate",z.__docgenInfo={description:"",displayName:"CustomDefaultTemplate",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},classNames:{defaultValue:null,description:"",name:"classNames",required:!0,type:{name:"string"}},label:{defaultValue:null,description:"",name:"label",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawDescription:{defaultValue:null,description:"",name:"rawDescription",required:!0,type:{name:"string"}},errors:{defaultValue:null,description:"",name:"errors",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawErrors:{defaultValue:null,description:"",name:"rawErrors",required:!0,type:{name:"string[]"}},help:{defaultValue:null,description:"",name:"help",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawHelp:{defaultValue:null,description:"",name:"rawHelp",required:!0,type:{name:"string"}},hidden:{defaultValue:null,description:"",name:"hidden",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},displayLabel:{defaultValue:null,description:"",name:"displayLabel",required:!0,type:{name:"boolean"}},fields:{defaultValue:null,description:"",name:"fields",required:!0,type:{name:"Field[]"}},schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"UiSchema"}},formContext:{defaultValue:null,description:"",name:"formContext",required:!0,type:{name:"any"}},formData:{defaultValue:null,description:"",name:"formData",required:!0,type:{name:"T"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"((value: T) => void) & ((newValue: unknown) => void)"}},onKeyChange:{defaultValue:null,description:"",name:"onKeyChange",required:!0,type:{name:"(value: string) => () => void"}},onDropPropertyClick:{defaultValue:null,description:"",name:"onDropPropertyClick",required:!0,type:{name:"(value: string) => () => void"}},registry:{defaultValue:null,description:"",name:"registry",required:!0,type:{name:"Registry"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomDefaultTemplate.tsx#CustomDefaultTemplate"]={docgenInfo:z.__docgenInfo,name:"CustomDefaultTemplate",path:"src/lib/containers/entity/annotations/CustomDefaultTemplate.tsx#CustomDefaultTemplate"})}catch{}const ue=window.JSONSchemaForm.utils,dt=window.React.useState;function Z(e){const{TitleField:t,DescriptionField:a}=e,[i,d]=dt(new Set);return ke(()=>{if(e.schema.properties){const l=Object.keys(e.schema.properties),o=new Set(l.filter(c=>!e.schema.properties[c][ue.ADDITIONAL_PROPERTY_FLAG]));if(i!=null){const c=Array.from(i).filter(r=>!o.has(r)&&e.formData[r]!=null);c.length>0&&Pe(`The following annotations are no longer specified by the schema and have been converted to Custom Fields: ${c.join(", ")}.`,"warning",{title:"Fields No Longer Specified By Schema"})}d(o)}},[e.schema.properties]),u("fieldset",{id:e.idSchema.$id,children:[(e.uiSchema["ui:title"]||e.title)&&n(t,{id:`${e.idSchema.$id}__title`,title:e.title||e.uiSchema["ui:title"],required:e.required}),e.description&&n(a,{id:`${e.idSchema.$id}__description`,description:e.description}),e.properties.map(l=>n("div",{children:l.content},l.name)),ue.canExpand(e.schema,e.uiSchema,e.formData)&&n("div",{className:"container-fluid",children:n(Be,{title:"Add a new custom field",placement:"top",children:n(q,{variant:"gray",className:"object-property-expand",onClick:e.onAddClick(e.schema),disabled:e.disabled||e.readonly,"aria-label":"Add Custom Field",children:n(k,{})})})})]})}try{Z.displayName="CustomObjectFieldTemplate",Z.__docgenInfo={description:`Basically identical to the default object field template, with a custom button.

See {@link node_modules /@rjsf/core/src/components/fields/ObjectField.js#DefaultObjectFieldTemplate}`,displayName:"CustomObjectFieldTemplate",props:{DescriptionField:{defaultValue:null,description:"",name:"DescriptionField",required:!0,type:{name:"StatelessComponent<{ id: string; description: string | ReactElement<any, string | JSXElementConstructor<any>>; }>"}},TitleField:{defaultValue:null,description:"",name:"TitleField",required:!0,type:{name:"StatelessComponent<{ id: string; title: string; required: boolean; }>"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!0,type:{name:"boolean"}},properties:{defaultValue:null,description:"",name:"properties",required:!0,type:{name:"{ content: ReactElement<any, string | JSXElementConstructor<any>>; name: string; disabled: boolean; readonly: boolean; hidden: boolean; }[]"}},onAddClick:{defaultValue:null,description:"",name:"onAddClick",required:!0,type:{name:"(schema: JSONSchema7) => () => void"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"",name:"required",required:!0,type:{name:"boolean"}},schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"",name:"uiSchema",required:!0,type:{name:"UiSchema"}},idSchema:{defaultValue:null,description:"",name:"idSchema",required:!0,type:{name:"IdSchema<any>"}},formData:{defaultValue:null,description:"",name:"formData",required:!0,type:{name:"Record<string, unknown>"}},formContext:{defaultValue:null,description:"",name:"formContext",required:!0,type:{name:"any"}},registry:{defaultValue:null,description:"",name:"registry",required:!0,type:{name:"Registry"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomObjectFieldTemplate.tsx#CustomObjectFieldTemplate"]={docgenInfo:Z.__docgenInfo,name:"CustomObjectFieldTemplate",path:"src/lib/containers/entity/annotations/CustomObjectFieldTemplate.tsx#CustomObjectFieldTemplate"})}catch{}const ut=window.React.Component;var ce=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,d=String(t).toLowerCase(),l=String(i.getOptionValue(a)).toLowerCase(),o=String(i.getOptionLabel(a)).toLowerCase();return l===d||o===d},ct={formatCreateLabel:function(t){return'Create "'.concat(t,'"')},isValidNewOption:function(t,a,i,d){return!(!t||a.some(function(l){return ce(t,l,d)})||i.some(function(l){return ce(t,l,d)}))},getNewOptionData:function(t,a){return{label:a,value:t,__isNew__:!0}},getOptionValue:Me,getOptionLabel:Ge},mt=Ke({allowCreateWhileLoading:!1,createOptionPosition:"last"},ct),pt=function(t){var a,i;return i=a=function(d){je(o,d);var l=Je(o);function o(c){var r;We(this,o),r=l.call(this,c),r.select=void 0,r.onChange=function(s,p){var g=r.props,b=g.getNewOptionData,m=g.inputValue,y=g.isMulti,_=g.onChange,h=g.onCreateOption,E=g.value,w=g.name;if(p.action!=="select-option")return _(s,p);var C=r.state.newOption,O=Array.isArray(s)?s:[s];if(O[O.length-1]===C){if(h)h(m);else{var T=b(m,m),f={action:"create-option",name:w,option:T};_(y?[].concat(te(de(E)),[T]):T,f)}return}_(s,p)};var S=c.options||[];return r.state={newOption:void 0,options:S},r}return $e(o,[{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"render",value:function(){var r=this,S=this.state.options;return n(t,{...this.props,ref:function(p){r.select=p},options:S,onChange:this.onChange})}}],[{key:"getDerivedStateFromProps",value:function(r,S){var s=r.allowCreateWhileLoading,p=r.createOptionPosition,g=r.formatCreateLabel,b=r.getNewOptionData,m=r.inputValue,y=r.isLoading,_=r.isValidNewOption,h=r.value,E=r.getOptionValue,w=r.getOptionLabel,C=r.options||[],O=S.newOption;return _(m,de(h),C,{getOptionValue:E,getOptionLabel:w})?O=b(m,g(m)):O=void 0,{newOption:O,options:(s||!y)&&O?p==="first"?[O].concat(te(C)):[].concat(te(C),[O]):C}}}]),o}(ut),a.defaultProps=mt,i},ft=pt(He),yt=Ye(ft);const ht=({children:e,...t})=>n(Ue.Control,{...t,className:"form-control",children:e});function gt(e,t){if(e==null)return;const a=t.filter(i=>i.value===e);return a.length>0?a[0]:{value:e,label:e}}const Q=e=>{const{id:t,options:a,value:i,required:d,disabled:l,readonly:o,multiple:c,autofocus:r,onChange:S,onBlur:s,onFocus:p,placeholder:g}=e,{enumOptions:b}=a;return n(yt,{className:"react-select-container",inputId:t,multiple:c,placeholder:g,value:gt(i,b),required:d,isDisabled:l||o,autoFocus:r,onBlur:s&&(()=>s(t,i==null?void 0:i.value)),options:b,onFocus:p&&(()=>p(t,i==null?void 0:i.value)),onChange:m=>S(m==null?void 0:m.value),isClearable:!0,components:{Control:ht},formatCreateLabel:m=>`Set to custom value "${m}"`,styles:{control:m=>({...m,border:"unset",borderColor:"unset",boxShadow:"unset","&:hover":{}}),valueContainer:m=>({...m,padding:"0px"})}})};try{Q.displayName="CustomSelectWidget",Q.__docgenInfo={description:"Select widget compatible with react-jsonschema-form enumerations",displayName:"CustomSelectWidget",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomSelectWidget.tsx#CustomSelectWidget"]={docgenInfo:Q.__docgenInfo,name:"CustomSelectWidget",path:"src/lib/containers/entity/annotations/CustomSelectWidget.tsx#CustomSelectWidget"})}catch{}const ee=e=>{const{BaseInput:t}=e.registry.widgets;let a=null;return(e.schema.type==="number"||e.schema.type==="integer")&&(a="text"),n(t,{...e,options:{...e.options,inputType:a}})};try{ee.displayName="CustomTextWidget",ee.__docgenInfo={description:`This TextWidget is almost identical to the rjsf TextWidget, except we handle numbers like strings to prevent issues if
the actual annotation data is not a string.`,displayName:"CustomTextWidget",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/CustomTextWidget.tsx#CustomTextWidget"]={docgenInfo:ee.__docgenInfo,name:"CustomTextWidget",path:"src/lib/containers/entity/annotations/CustomTextWidget.tsx#CustomTextWidget"})}catch{}const St=window.JSONSchemaForm,I=window.React,Ct=window.React.useEffect,bt=window.React.useRef,_t=ye.reduce((e,t)=>(e[`^${t}$`]={not:{}},e),{}),ie=e=>{var D,F,$;const{entityId:t,schemaId:a,liveValidate:i=!1,onSuccess:d=()=>{},onCancel:l,formRef:o}=e,c=bt(null),[r,S]=I.useState(void 0),[s,p]=I.useState(void 0),[g,b]=I.useState(void 0),[m,y]=I.useState(!1),[_,h]=I.useState(!1),{entityMetadata:E,annotations:w}=Ae(t,{enabled:!!t&&!r,useErrorBoundary:!0});Ct(()=>{w&&S(w)},[w]);const{data:C,isLoading:O}=Qe(t,{enabled:!!t,refetchOnWindowFocus:!1,useErrorBoundary:!0}),{data:T,isLoading:f}=et((D=a!=null?a:C==null?void 0:C.jsonSchemaVersionInfo.$id)!=null?D:"",{enabled:!!a||!!C,select:A=>(delete A.$id,A),useErrorBoundary:!0}),v=O||f,N=Ee({onSuccess:()=>{d()},onError:A=>{b(A),y(!0)}});function V(){N.mutate({...rt(r!=null?r:{}),...E})}return n("div",{className:"bootstrap-4-backport AnnotationEditor",children:v?n("div",{className:"LoadingPlaceholder",children:n(we,{size:30})}):u(R,{children:[E&&C&&u(j,{dismissible:!1,show:!0,variant:"info",transition:!1,children:[n("b",{children:E.name})," requires scientific annotations specified by ",n("b",{children:C.jsonSchemaVersionInfo.$id}),". ",n("b",{children:n("a",{href:`${be(_e.REPO_ENDPOINT)}/repo/v1/schema/type/registered/${C.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:"View required schema (JSON)"})})]}),E&&(!r||me(r))&&C===null&&u(j,{dismissible:!1,show:!0,variant:"info",transition:!1,children:[n("b",{children:E.name})," has no annotations. Click the"," ",n(k,{})," button to annotate."]}),u(St,{className:"AnnotationEditorForm",liveValidate:i,noHtml5Validate:!0,ArrayFieldTemplate:P,ObjectFieldTemplate:Z,FieldTemplate:z,ref:o!=null?o:c,disabled:N.isLoading,ErrorList:()=>null,schema:{...T!=null?T:{},patternProperties:{...(F=T==null?void 0:T.patternProperties)!=null?F:{},..._t},additionalProperties:($=T==null?void 0:T.additionalProperties)!=null?$:!0},uiSchema:{"ui:DuplicateKeySuffixSeparator":"_",additionalProperties:{"ui:field":M,"ui:FieldTemplate":G}},transformErrors:ot,formData:r,onChange:({formData:A})=>{S(A),p(void 0)},onSubmit:({formData:A,errors:x})=>{x&&x.length>0&&p(x),y(!1),S(A),V()},onError:A=>{p(A),s&&t&&h(!0)},widgets:{TextWidget:ee,DateTimeWidget:X,SelectWidget:Q,CheckboxWidget:U},children:[s&&u(j,{className:"ErrorList",dismissible:!1,show:!0,variant:"danger",transition:!1,children:[n("b",{children:"Validation errors found:"}),n("ul",{children:s.map((A,x)=>u("li",{children:[n("b",{children:`${se(A)}: `})," ",`${A.message}`]},x))})]}),g&&u(j,{dismissible:!1,show:m,variant:"danger",transition:!1,children:["Annotations could not be updated: ",g.reason]}),!o&&u(R,{children:[n("hr",{}),u("div",{className:"SaveButtonContainer",children:[n(q,{variant:"primary-500",onClick:()=>{c.current.submit()},children:t?"Save":"Validate"}),l&&u(R,{children:[n("div",{className:"Spacer"}),n(q,{variant:"primary-500",onClick:l,children:"Cancel"})]})]})]})]}),_&&n(Tt,{show:!0,onSave:()=>{V(),h(!1)},onCancel:()=>{h(!1)},errors:s})]})})},Tt=({show:e,onCancel:t,onSave:a,errors:i})=>u(L,{animation:!1,show:e,onHide:t,backdrop:"static",children:[n(L.Header,{closeButton:!0,children:n(L.Title,{children:"Update Annotations"})}),u(L.Body,{children:[n("div",{children:"The following errors exist with the annotations you entered:"}),n("div",{children:n("ul",{children:(i!=null?i:[]).map((d,l)=>u("li",{children:[n("b",{children:`${se(d)}: `})," ",`${d.message}`]},l))})}),n("div",{children:"Are you sure you want to save them?"})]}),u(L.Footer,{children:[n(q,{variant:"default",onClick:t,children:"Cancel"}),n(q,{variant:"primary",onClick:a,children:"Save"})]})]});try{ie.displayName="SchemaDrivenAnnotationEditor",ie.__docgenInfo={description:`Renders a form for editing an entity's annotations. The component also supports supplying just a schema ID,
but work to support annotation flows without an entity (i.e. before creating entities) is not yet complete.`,displayName:"SchemaDrivenAnnotationEditor",props:{entityId:{defaultValue:null,description:"The entity whose annotations should be edited with the form",name:"entityId",required:!1,type:{name:"string"}},schemaId:{defaultValue:null,description:"If no entity ID is supplied, the schema to use for the form",name:"schemaId",required:!1,type:{name:"string"}},formRef:{defaultValue:null,description:"Optionally supply a ref to the form to handle submission externally with `formRef.current.submit()`. If provided, the editor will not render its own submit UI.",name:"formRef",required:!1,type:{name:"RefObject<Form<Record<string, unknown>>>"}},liveValidate:{defaultValue:null,description:"Provide live input validation. This can cause major performance degradation.",name:"liveValidate",required:!1,type:{name:"boolean"}},onSuccess:{defaultValue:null,description:"Invoked after a successful form submission",name:"onSuccess",required:!1,type:{name:"(() => void)"}},onCancel:{defaultValue:null,description:"If defined and formRef is not supplied, shows a 'Cancel' button and runs this effect on click",name:"onCancel",required:!1,type:{name:"(() => void)"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/entity/annotations/SchemaDrivenAnnotationEditor.tsx#SchemaDrivenAnnotationEditor"]={docgenInfo:ie.__docgenInfo,name:"SchemaDrivenAnnotationEditor",path:"src/lib/containers/entity/annotations/SchemaDrivenAnnotationEditor.tsx#SchemaDrivenAnnotationEditor"})}catch{}export{ie as S,Ut as a,Qe as u};
//# sourceMappingURL=SchemaDrivenAnnotationEditor.d389ccdb.js.map
