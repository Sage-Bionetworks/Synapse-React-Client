import{t as Le,x as be,y as Re,z as Ie,A as oe,C as de}from"./index.05abe325.js";import{i as me}from"./EntityTypeUtils.bdce6c7e.js";import{P as Q}from"./getEndpoint.0de7fccf.js";import{S as pe,D as Ne}from"./sqlFunctions.b49ac766.js";import{u as q}from"./unCamelCase.d070537b.js";import{C as X}from"./ColumnType.744125d2.js";import"./assert.c27a8558.js";import{T as Ve}from"./Tooltip.6c95fe7b.js";import{a as fe,I as Oe}from"./index.6f0fba5e.js";import{M as B}from"./MarkdownSynapse.15019ac7.js";import{j as a,a as h,F as C}from"./jsx-runtime.2e925369.js";import{I as ve}from"./IconList.cb09853e.js";import{I as xe,t as Ae}from"./IconSvg.3d20df6f.js";import{U as ce}from"./UserCard.0e7f72e7.js";import{F as ke}from"./FileHandleLink.8083f754.js";import{u as we}from"./react-intersection-observer.m.66de6abb.js";import{i as Ee}from"./isEmpty.93b41982.js";const ue=window.React.useState,qe=window.React.useEffect,H=({type:l,title:e,subTitle:n="",description:t,values:r,secondaryLabelLimit:s,isAlignToLeftNav:i,descriptionConfig:d,href:m,target:c,rgbIndex:f,icon:S})=>{const u=document.querySelector('meta[name="description"]'),[_]=ue(document.title),[g]=ue(u?u.getAttribute("content"):"");return qe(()=>(e&&document.title!==e&&(document.title=e),(t||n)&&(u==null||u.setAttribute("content",t||n)),function(){document.title=_,u==null||u.setAttribute("content",g)})),a("div",{className:`SRC-portalCard SRC-portalCardHeader ${i?"isAlignToLeftNav":""}`,children:a("div",{className:"container-fluid container-full-width",children:a("div",{className:"row",children:a("div",{className:"col-md-offset-1 col-md-10",children:h("div",{className:"SRC-portalCardMain",children:[S,h("div",{style:{width:"100%"},children:[h("div",{className:"SRC-cardContent",style:{marginLeft:"15px"},children:[a("div",{className:"SRC-type",children:l}),a("div",{children:a("h3",{className:"SRC-boldText",style:{margin:"none"},children:m?a("a",{target:c,href:m,className:"highlight-link",children:e}):h("span",{children:[" ",e," "]})})}),n&&h("div",{className:"SRC-author",children:[" ",n," "]}),t&&a("span",{className:"SRC-font-size-base",children:d!=null&&d.isMarkdown?a(B,{markdown:t}):t})]}),a("div",{style:{borderTop:"1px solid rgba(26, 28, 41, 0.2)",marginTop:"15px",paddingTop:"5px"}}),a("div",{className:"SRC-cardContent",children:r&&a(fe,{isHeader:!0,secondaryLabelLimit:s,values:r})})]})]})})})})})};try{H.displayName="HeaderCard",H.__docgenInfo={description:"",displayName:"HeaderCard",props:{rgbIndex:{defaultValue:null,description:"",name:"rgbIndex",required:!1,type:{name:"number"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"string"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},subTitle:{defaultValue:{value:""},description:"",name:"subTitle",required:!1,type:{name:"string"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"string"}},secondaryLabelLimit:{defaultValue:null,description:"",name:"secondaryLabelLimit",required:!1,type:{name:"number"}},values:{defaultValue:null,description:"",name:"values",required:!1,type:{name:"string[][]"}},isAlignToLeftNav:{defaultValue:null,description:"",name:"isAlignToLeftNav",required:!1,type:{name:"boolean"}},descriptionConfig:{defaultValue:null,description:"",name:"descriptionConfig",required:!1,type:{name:"DescriptionConfig"}},href:{defaultValue:null,description:"",name:"href",required:!1,type:{name:"string"}},target:{defaultValue:null,description:"",name:"target",required:!1,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!0,type:{name:"Element"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/HeaderCard.tsx#HeaderCard"]={docgenInfo:H.__docgenInfo,name:"HeaderCard",path:"src/lib/containers/HeaderCard.tsx#HeaderCard"})}catch{}const He=window.React.useEffect,De=window.React.useState,D=l=>{const{fileHandleAssociation:{fileHandleId:e,associateObjectId:n,associateObjectType:t}}=l,{accessToken:r}=Le(),[s,i]=De(),{ref:d,inView:m}=we({triggerOnce:!0,rootMargin:"500px 0px"});return He(()=>{(()=>{e&&n&&t&&m&&be(e,r,t,n,!1).then(f=>{i(f)}).catch(f=>{console.error("Error on retrieving file handle url ",f)})})()},[m,e,n,r,t]),a("span",{ref:d,children:s&&a("img",{src:s,alt:"",className:"ImageFileHandle",loading:"lazy"})})};try{D.displayName="ImageFileHandle",D.__docgenInfo={description:"",displayName:"ImageFileHandle",props:{fileHandleAssociation:{defaultValue:null,description:"",name:"fileHandleAssociation",required:!0,type:{name:"FileHandleAssociation"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/widgets/ImageFileHandle.tsx#ImageFileHandle"]={docgenInfo:D.__docgenInfo,name:"ImageFileHandle",path:"src/lib/containers/widgets/ImageFileHandle.tsx#ImageFileHandle"})}catch{}const J=window.React,W=400,Fe="SRC-short-description",Me="SRC-long-description",F=l=>{let e="";const n=l.split(" ");let t=0;for(;e.length<W&&t<n.length;)e+=`${n[t]} `,t+=1;return e=e.trim(),{previewText:e}},$e=(l,e,n)=>{var r;let t;return l&&e&&(me(l)?t={fileHandleId:e,associateObjectId:(r=l==null?void 0:l.id)!=null?r:"",associateObjectType:oe.TableEntity}:n&&(t={fileHandleId:e,associateObjectId:n,associateObjectType:oe.FileEntity})),t},A=({columnName:l,value:e,selectColumns:n,columnModels:t})=>{if(!e)return{str:"",strList:void 0,columnModelType:void 0};const r=(n==null?void 0:n.find(i=>i.name===l))||(t==null?void 0:t.find(i=>i.name===l));if(r==null?void 0:r.columnType.endsWith("_LIST")){let i=e,d;try{return d=JSON.parse(i),i=d.join(", "),{strList:d,str:i,columnModelType:r==null?void 0:r.columnType}}catch(m){console.error("Could not parse multivalue string ",i," caught err ",m)}}return{str:e,columnModelType:r==null?void 0:r.columnType}},Ge=(l,e,n)=>(e==null?void 0:e.findIndex(t=>t.name===l))||(n==null?void 0:n.findIndex(t=>t.name===l)),M=l=>{const{synapseId:e,version:n}=l;return h("span",{children:[n,"\xA0\xA0",a("a",{target:"_blank",rel:"noopener noreferrer",href:`${Q.PORTAL}#!Synapse:${e}.${n}`,children:"(Show Version History on Synapse)"})]})},$=l=>{const{value:e,columnName:n,labelLink:t,selectColumns:r,columnModels:s,isHeader:i,className:d,rowData:m}=l;if(!e)return a(C,{children:e});const{strList:c,str:f,columnModelType:S}=A({columnName:n,value:e,selectColumns:r,columnModels:s});if(!f)return a(C,{children:f});let u=d;const _={};if(i&&(u=d==null?void 0:d.concat(" ","SRC-lightLink")),S===X.USERID_LIST&&c)return a(C,{children:c.map((y,p)=>h("span",{children:[a(ce,{ownerId:y,size:de,className:u}),p<c.length-1&&",\xA0\xA0"]},y))});if(S===X.USERID&&f)return a(ce,{ownerId:f,size:de,className:u});if(!t)return f.match(pe)?a("a",{target:"_blank",rel:"noopener noreferrer",href:`${Q.PORTAL}#!Synapse:${f}`,className:u,children:f}):a(C,{children:f});let g;if(t.isMarkdown)c?g=a(C,{children:c.map((y,p)=>h("span",{children:[a(B,{renderInline:!0,markdown:y},y),p<c.length-1&&",\xA0\xA0"]},y))}):g=a(B,{renderInline:!0,markdown:e});else{const y=c||f.split(",");if("linkColumnName"in t){const p=Ge(t.linkColumnName,r,s);if(p==null)console.warn(`Could not determine column index of ${t.linkColumnName}`),g=a(C,{children:e});else{const T=m[p];Ee(T)?g=a(C,{children:e}):g=a(C,{children:y.map((o,I)=>h(J.Fragment,{children:[a("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:u,style:_,children:o},o),I<y.length-1&&a("span",{style:{marginRight:4},children:", "})]},o))})}}else g=a(C,{children:y.map((p,T)=>{const{baseURL:o,URLColumnName:I,wrapValueWithParens:P}=t,N=P?`(${p})`:p,V=`/${o}?${I}=${N}`;return h(J.Fragment,{children:[a("a",{href:V,className:u,style:_,children:p},p),T<y.length-1&&a("span",{style:{marginRight:4},children:", "})]},p)})})}return t.tooltipText?a(Ve,{title:t.tooltipText,enterNextDelay:300,children:a("span",{children:g})}):g};class G extends J.Component{constructor(e){super(e),this.getCutoff=n=>{let t="";const r=n.split(" ");let s=0;for(;t.length<W&&s<r.length;)t+=`${r[s]} `,s+=1;return t=t.trim(),{previewText:t}},this.toggleShowMore=()=>{this.setState({hasClickedShowMore:!0})},this.renderTitle=({href:n,target:t,titleSearchHandle:r,title:s})=>n?a("a",{"data-search-handle":r,target:t,href:n,className:"highlight-link",children:s}):h("span",{"data-search-handle":r,children:[" ",s," "]}),this.state={hasClickedShowMore:!1},this.getLinkParams=this.getLinkParams.bind(this),this.getCardLinkHref=this.getCardLinkHref.bind(this),this.renderLongDescription=this.renderLongDescription.bind(this),this.renderShortDescription=this.renderShortDescription.bind(this)}getLinkParams(e,n,t,r){var d;e=e.trim();let s=e,i="_self";return e.match(pe)?s=`${Q.PORTAL}#!Synapse:${e}`:e.match(Ne)?(i="_blank",s=`https://dx.doi.org/${e}`):n?n&&(s=(d=this.getCardLinkHref(n,t,r))!=null?d:""):i="_blank",{href:s,target:i}}getCardLinkHref(e,n,t){if(e){if(!n||!t)throw Error("Must specify CardLink and data for linking to work");const{matchColumnName:r,URLColumnName:s,overrideLinkURLColumnName:i}=e;if(i&&t[i]){const m=t[i],c=n[m];if(c)return c}const d=t[r];if(d===void 0)console.error(`Could not find match for data: ${n} with columnName ${r}`);else{const m=n[d];if(m)return`/${e.baseURL}?${s}=${m}`}}}render(){var le;const{schema:e,data:n,genericCardSchema:t,secondaryLabelLimit:r,selectColumns:s,columnModels:i,iconOptions:d,useTypeColumnForIcon:m=!1,isHeader:c=!1,titleLinkConfig:f,ctaLinkConfig:S,labelLinkConfig:u,facetAliases:_={},descriptionConfig:g,rgbIndex:y,columnIconOptions:p,queryContext:{entity:T}}=this.props,o=t,{hasClickedShowMore:I}=this.state,{link:P="",type:N}=o,V=n[e[o.title]];let O=o.subTitle&&n[e[o.subTitle]];O=(o==null?void 0:o.subTitle)&&A({value:O,columnName:o==null?void 0:o.subTitle,selectColumns:s,columnModels:i}).str;const v=n[e[o.description||""]],he=n[e[o.icon||""]],k=n[e[o.dataTypeIconNames||""]],x=n[e[o.imageFileHandleColumnName||""]],Y=i==null?void 0:i.find(R=>o.link===R.name),ge=Y==null?void 0:Y.columnType,Z=n[e[P]]||"",{href:ee,target:ne}=this.getLinkParams(Z,f,n,e),w=[],{secondaryLabels:ae=[]}=o,ye=T&&!me(T);for(let R=0;R<ae.length;R+=1){const L=ae[R];let b=n[e[L]],j;if(b){if(ye&&L==="currentVersion"){const z=n[e.id];b=M({synapseId:z,version:b}),j="Version"}else{const z=u==null?void 0:u.find(se=>se.matchColumnName===L);b=$({value:b,columnName:L,labelLink:z,isHeader:c,selectColumns:s,columnModels:i,rowData:n}),j=q(L,_)}const Te=[j,b,L];w.push(Te)}}const E=$e(T,x||Z,n[e.id]),te=w.length>0,Ce={marginTop:c?"0px":void 0,marginBottom:c?"0px":void 0,paddingBottom:te||x?void 0:"15px"},re=h(C,{children:[!m&&x&&a("div",{className:"SRC-imageThumbnail",style:{padding:o.thumbnailRequiresPadding?"21px":void 0},children:E&&a(D,{fileHandleAssociation:E})}),!m&&!x&&a("div",{className:"SRC-cardThumbnail",children:a(Oe,{iconOptions:d,value:he,type:N})}),m&&a("div",{className:"SRC-cardThumbnail",children:a(xe,{options:{icon:Ae[n[e.type]]}})})]});if(c)return a(H,{descriptionConfig:g,title:V,subTitle:O,description:v,type:N,icon:re,values:w,href:ee,target:ne,isAlignToLeftNav:!0,secondaryLabelLimit:r,rgbIndex:y});const Se=q(o.title,_),_e=q(o.subTitle,_),ie=q(o.description,_);let K,U;if(S){const R=n[e[S.link]]||"",{href:L,target:b}=this.getLinkParams(R,void 0,n,e);K=L,U=b}return h("div",{style:Ce,className:"SRC-portalCard",children:[h("div",{className:"SRC-portalCardMain",children:[re,h("div",{className:"SRC-cardContent",children:[a("div",{className:"SRC-type",children:N}),((le=p==null?void 0:p.columns)==null?void 0:le.dataType)&&(k==null?void 0:k.length)&&a("div",{style:{marginTop:"20px"},children:a(ve,{iconConfigs:p.columns.dataType,iconNames:JSON.parse(k),useBackground:!0,useTheme:!0})}),a("div",{children:a("h3",{className:"SRC-boldText SRC-blackText",style:{margin:"none"},children:!f&&ge===X.FILEHANDLEID&&E?a(ke,{fileHandleAssociation:E,showDownloadIcon:N!==Re,displayValue:V}):this.renderTitle({href:ee,target:ne,titleSearchHandle:Se,title:V})})}),O&&a("div",{"data-search-handle":_e,className:"SRC-author",children:O}),v&&this.renderShortDescription(v,I,ie,g),v&&this.renderLongDescription(v,I,ie,g),S&&K&&U&&a("div",{className:"SRC-portalCardCTALink bootstrap-4-backport",children:a("a",{target:U,rel:"noopener noreferrer",href:K,children:S.text})})]})]}),te&&a(fe,{isHeader:!1,secondaryLabelLimit:r,values:w,columnIconOptions:p,className:`${x?"hasImage":"hasIcon"}`})]})}renderLongDescription(e,n,t,r){let s=e;r!=null&&r.isMarkdown&&(s=a(B,{markdown:s}));const i=n||(r==null?void 0:r.showFullDescriptionByDefault);return a("div",{className:i?"":"SRC-hidden",children:a("span",{"data-search-handle":t,className:`SRC-font-size-base ${Me}`,children:s})})}renderShortDescription(e,n,t,r){return r!=null&&r.showFullDescriptionByDefault?a(C,{}):h("div",{className:n?"SRC-hidden":"",children:[a("span",{"data-search-handle":t,className:`SRC-font-size-base ${Fe} SRC-short-description`,children:F(e).previewText}),e.length>=W&&a("a",{style:{fontSize:"16px",cursor:"pointer",marginLeft:"5px"},className:"highlight-link",onClick:this.toggleShowMore,children:"...Show More"})]})}}G.contextType=Ie;try{F.displayName="getCutoff",F.__docgenInfo={description:"",displayName:"getCutoff",props:{}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/GenericCard.tsx#getCutoff"]={docgenInfo:F.__docgenInfo,name:"getCutoff",path:"src/lib/containers/GenericCard.tsx#getCutoff"})}catch{}try{A.displayName="getValueOrMultiValue",A.__docgenInfo={description:"",displayName:"getValueOrMultiValue",props:{columnName:{defaultValue:null,description:"",name:"columnName",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string"}},selectColumns:{defaultValue:null,description:"",name:"selectColumns",required:!1,type:{name:"SelectColumn[]"}},columnModels:{defaultValue:null,description:"",name:"columnModels",required:!1,type:{name:"ColumnModel[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/GenericCard.tsx#getValueOrMultiValue"]={docgenInfo:A.__docgenInfo,name:"getValueOrMultiValue",path:"src/lib/containers/GenericCard.tsx#getValueOrMultiValue"})}catch{}try{M.displayName="VersionLabel",M.__docgenInfo={description:"",displayName:"VersionLabel",props:{synapseId:{defaultValue:null,description:"",name:"synapseId",required:!0,type:{name:"string"}},version:{defaultValue:null,description:"",name:"version",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/GenericCard.tsx#VersionLabel"]={docgenInfo:M.__docgenInfo,name:"VersionLabel",path:"src/lib/containers/GenericCard.tsx#VersionLabel"})}catch{}try{$.displayName="SynapseCardLabel",$.__docgenInfo={description:"",displayName:"SynapseCardLabel",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"string"}},columnName:{defaultValue:null,description:"",name:"columnName",required:!0,type:{name:"string"}},labelLink:{defaultValue:null,description:"",name:"labelLink",required:!0,type:{name:"CardLink | ColumnSpecifiedLink | MarkdownLink | undefined"}},selectColumns:{defaultValue:null,description:"",name:"selectColumns",required:!0,type:{name:"SelectColumn[] | undefined"}},columnModels:{defaultValue:null,description:"",name:"columnModels",required:!0,type:{name:"ColumnModel[] | undefined"}},isHeader:{defaultValue:null,description:"",name:"isHeader",required:!0,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/GenericCard.tsx#SynapseCardLabel"]={docgenInfo:$.__docgenInfo,name:"SynapseCardLabel",path:"src/lib/containers/GenericCard.tsx#SynapseCardLabel"})}catch{}try{G.displayName="GenericCard",G.__docgenInfo={description:"Renders a card from a table query",displayName:"GenericCard",props:{selectColumns:{defaultValue:null,description:"",name:"selectColumns",required:!1,type:{name:"SelectColumn[]"}},columnModels:{defaultValue:null,description:"",name:"columnModels",required:!1,type:{name:"ColumnModel[]"}},facetAliases:{defaultValue:null,description:"",name:"facetAliases",required:!1,type:{name:"Record<string, string>"}},iconOptions:{defaultValue:null,description:"",name:"iconOptions",required:!1,type:{name:"IconOptions"}},useTypeColumnForIcon:{defaultValue:null,description:"",name:"useTypeColumnForIcon",required:!1,type:{name:"boolean"}},isHeader:{defaultValue:null,description:"",name:"isHeader",required:!1,type:{name:"boolean"}},isAlignToLeftNav:{defaultValue:null,description:"",name:"isAlignToLeftNav",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"Record<string, number>"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"string[]"}},tableId:{defaultValue:null,description:"",name:"tableId",required:!0,type:{name:"string | undefined"}},columnIconOptions:{defaultValue:null,description:"",name:"columnIconOptions",required:!1,type:{name:"ColumnIconConfigs"}},queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},genericCardSchema:{defaultValue:null,description:"",name:"genericCardSchema",required:!1,type:{name:"GenericCardSchema"}},secondaryLabelLimit:{defaultValue:null,description:"",name:"secondaryLabelLimit",required:!1,type:{name:"number"}},titleLinkConfig:{defaultValue:null,description:"",name:"titleLinkConfig",required:!1,type:{name:"CardLink"}},ctaLinkConfig:{defaultValue:null,description:"",name:"ctaLinkConfig",required:!1,type:{name:"CTACardLink"}},labelLinkConfig:{defaultValue:null,description:"",name:"labelLinkConfig",required:!1,type:{name:"LabelLinkConfig"}},descriptionConfig:{defaultValue:null,description:"",name:"descriptionConfig",required:!1,type:{name:"DescriptionConfig"}},rgbIndex:{defaultValue:null,description:"",name:"rgbIndex",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES!="undefined"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/GenericCard.tsx#GenericCard"]={docgenInfo:G.__docgenInfo,name:"GenericCard",path:"src/lib/containers/GenericCard.tsx#GenericCard"})}catch{}export{G,D as I,$ as S,$e as a,A as g};
//# sourceMappingURL=GenericCard.0c7f20e6.js.map
