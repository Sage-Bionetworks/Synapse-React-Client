import{r as f,a,F as C,j as e}from"./jsx-runtime.1d4416c9.js";import{f as E,bG as ge,bH as he,w as j,A as le,F as we,bI as ye,bJ as Se,bK as _e,v as be,bL as Ce,H as De,E as ve,bM as Ae}from"./index.733ef2d4.js";import{u as ce}from"./useInfiniteQuery.f21582a5.js";import{u as de}from"./react-intersection-observer.esm.c059a8f3.js";import{h as ne}from"./moment.a565bb48.js";import{U as Te}from"./UserCard.8a53ad4c.js";import{S as Re}from"./Sort.d2e23b90.js";import{D as X}from"./EntityChildren.50133102.js";import{P as Ne}from"./getEndpoint.bb7ded34.js";import{I as b}from"./IconSvg.a5337a6a.js";import{T as P}from"./SynapseTableConstants.07ecdebd.js";import{S as Ie}from"./SkeletonTable.944ff781.js";import{e as me,I as ke,D as Ee,f as q,g as Pe,h as Oe,H as oe}from"./CardContainerLogic.6b85104b.js";import{d as re}from"./ToastMessage.97b225d1.js";import{T}from"./Tooltip.514cbe94.js";import{B as Le}from"./LoadingScreen.2244e51f.js";import{D as x}from"./Dropdown.0e10b3ef.js";import{T as Fe}from"./Table.844d1596.js";import{u as qe}from"./useGetDownloadListStatistics.77a66886.js";import{a as xe}from"./useGetAccessRequirement.83dcd0d3.js";import{I as pe}from"./ElementWithTooltip.52728afe.js";import{aj as ee,ai as Be,ah as se,ak as Ve}from"./SynapseConstants.b6aa8bf5.js";import{T as D}from"./Typography.8752acbc.js";import{S as B}from"./Skeleton.5fb82d71.js";import{B as I}from"./Button.52817769.js";import{F as ue}from"./FullWidthAlert.fd7cf951.js";import"./iframe.6e2e208e.js";import"./index.b4915227.js";import"./withStyles.d9b674b1.js";import"./utils.12e9eddb.js";import"./Alert.a029b8a7.js";import"./index.57d09176.js";import"./createWithBsPrefix.e9487138.js";import"./index.35ce73ec.js";import"./isArray.cf5064fd.js";import"./SvgIcon.1ce682e0.js";import"./IconCopy.027a3c44.js";import"./Overlay.12b5a369.js";import"./contains.ed3c5fde.js";import"./usePopperMarginModifiers.ae1274b1.js";import"./hasClass.56fd144a.js";import"./useWaitForDOMRef.9692dd43.js";import"./createSvgIcon.1518894e.js";import"./InfoOutlined.bc9acc28.js";import"./times.c10c287f.js";import"./toInteger.20441ff0.js";import"./isSymbol.48f5f8d1.js";import"./sqlFunctions.cfb3693d.js";import"./RegularExpressions.3cd69849.js";import"./useGetInfoFromIds.023dc351.js";import"./use-deep-compare-effect.esm.550c47db.js";import"./uniq.2cacf64d.js";import"./_baseSlice.50189bc5.js";import"./_cacheHas.45054515.js";import"./without.11794d25.js";import"./uniqueId.b31d8e69.js";import"./_Set.81322f5c.js";import"./_setToArray.a82100c8.js";import"./ColumnType.744125d2.js";import"./EntityIcon.c9f8ea06.js";import"./TypeUtils.a2c41307.js";import"./FacetNav.18a94871.js";import"./queryUtils.ca99dead.js";import"./queryKeys.e0d3085f.js";import"./cloneDeep.118b9836.js";import"./_baseClone.ef28406f.js";import"./_getTag.9cf40ed3.js";import"./NoSearchResults.17c0b8b2.js";import"./NoData.f802ed9a.js";import"./unCamelCase.07e38083.js";import"./useEntity.0c38a2f1.js";import"./useMutation.c45e7ceb.js";import"./pick.3a49f954.js";import"./isEqual.38765cac.js";import"./Checkbox.0b72edd3.js";import"./RadioGroup.28342e68.js";import"./RangeSlider.25c35388.js";import"./factory.7178a034.js";import"./react-sizeme.ec5fe5ee.js";import"./ColorGradient.16f0e0f2.js";import"./colorPalette.8145e2e2.js";import"./Modal.0b4122af.js";import"./inheritsLoose.dffc5cd5.js";import"./usePrevious.4f8ee04e.js";import"./removeClass.27874bcb.js";import"./SelectionCriteriaPill.3410af6c.js";import"./Close.897e58c4.js";import"./react-select.esm.67ba8576.js";import"./Select-54ac8379.esm.c7895ad9.js";import"./CustomSelectWidget.bf3784d7.js";import"./index.browser.e60e72d5.js";import"./WarningModal.a1ce61f8.js";import"./DateFormatter.f8d5f7bf.js";import"./core.esm.2097e0b7.js";import"./isEmpty.74b3e09f.js";import"./union.e1eabe6c.js";import"./isString.c6b3a64b.js";import"./QueryCount.39ca8105.js";import"./ManagedACTAccessRequirementStatus.226b91ad.js";import"./FileUpload.708f4707.js";import"./UserSearchBox.d789c0da.js";import"./index.582f6d03.js";import"./UserOrTeamBadge.f7299049.js";import"./EntityLink.b7bb42bf.js";import"./SynapseVideo.1201d15f.js";import"./IconList.d299fd42.js";import"./UserCardList.41c52d50.js";import"./makeStyles.0711e4e8.js";import"./isRequiredForA11y.20ed4857.js";function Me(t,o,r){const{accessToken:n}=E(),s={concreteType:"org.sagebionetworks.repo.model.download.AvailableFilesRequest"};return t&&(s.sort=[t]),o&&(s.filter=o),ce(["downloadlistv2availablefiles",s],async c=>ge({...s,nextPageToken:c.pageParam},n),{...r,getNextPageParam:c=>c.nextPageToken})}function Ye(t){const{accessToken:o}=E(),r={concreteType:"org.sagebionetworks.repo.model.download.ActionRequiredRequest"};return ce(["downloadlistv2availablefiles",r],async n=>await he({...r,nextPageToken:n.pageParam},o),{...t,getNextPageParam:n=>n.nextPageToken})}function V({entityId:t,version:o}){const[r,n]=f.exports.useState(!1),s=`library(synapser)
synLogin('username','password')

# Obtain a pointer and download the data
${t} <- synGet(entity='${t}'${o?`, version=${o}`:""} ) `,c=`import synapseclient

syn = synapseclient.Synapse()
syn.login('synapse_username','password')

# Obtain a pointer and download the data
${t} = syn.get(entity='${t}'${o?`, version=${o}`:""} )

# Get the path to the local copy of the data file
filepath = ${t}.path`,d=`synapse get ${t} ${o?`--version ${o}`:""}`;return a(C,{children:[e(T,{title:"Programmatic download options",enterNextDelay:P,placement:"left",children:e("span",{children:e("button",{className:"btn-download-icon",onClick:()=>n(!0),children:e(b,{options:{icon:"code"}})})})}),r&&e(me,{show:!0,onClose:()=>n(!1),title:"Download Programmatically",cliCode:d,rCode:s,pythonCode:c})]})}try{V.displayName="DirectProgrammaticDownload",V.__docgenInfo={description:"",displayName:"DirectProgrammaticDownload",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},version:{defaultValue:null,description:"",name:"version",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/DirectProgrammaticDownload.tsx#DirectProgrammaticDownload"]={docgenInfo:V.__docgenInfo,name:"DirectProgrammaticDownload",path:"src/lib/containers/download_list_v2/DirectProgrammaticDownload.tsx#DirectProgrammaticDownload"})}catch{}const Ue="TESTING_TRASH_BTN_CLASS";function M(t){var ie;const{filesStatistics:o,refetchStatistics:r}=t,{accessToken:n}=E(),s=j(),{ref:c,inView:d}=de(),[h,y]=f.exports.useState(!1),[p,S]=f.exports.useState(void 0),[_,l]=f.exports.useState(void 0),{data:g,status:u,isFetchingNextPage:m,isLoading:w,hasNextPage:R,fetchNextPage:W,isError:ae,error:Q,refetch:L}=Me(p,_);f.exports.useEffect(()=>{L&&L()},[o,L]),f.exports.useEffect(()=>{ae&&Q&&s(Q)},[ae,Q,s]);const F=(ie=g==null?void 0:g.pages.flatMap(i=>i.page))!=null?ie:[];f.exports.useEffect(()=>{u==="success"&&!m&&R&&W&&(d||h)?W():!R&&h&&(()=>{const A=F.map(N=>`${N.fileEntityId}.${N.versionNumber}`).join(`
`);navigator.clipboard.writeText(A).then(()=>{re("Successfully copied to clipboard")}),y(!1)})()},[u,m,R,W,d,h,F]);const Z=i=>i?i=="eligibleForPackaging"?"Only Eligible":"Only Ineligible":"All",te=async(i,A,N)=>{try{await ye(i,n),re(`${A} has been removed from your list.`,"success",{title:N}),L(),r()}catch(J){console.error(J)}},v=({columnSortBy:i})=>e("span",{children:S&&e(Re,{role:"button",style:{height:"20px"},active:(p==null?void 0:p.field)===i,direction:(p==null?void 0:p.field)===i?p.direction==="DESC"?X.DESC:X.ASC:X.DESC,onClick:()=>{const A=i===(p==null?void 0:p.field)?p.direction==="ASC"?"DESC":"ASC":"DESC";S({field:i,direction:A})}})}),fe=[void 0,"eligibleForPackaging","ineligibleForPackaging"];return a(C,{children:[e(Le,{show:h}),a("div",{className:"filterFilesContainer",children:[e("span",{className:"filterFilesByText",children:"Filter Files By"}),a(x,{children:[e(x.Toggle,{variant:"gray-primary-500",id:"dropdown-basic",children:Z(_)}),e(x.Menu,{role:"menu",children:fe.map(i=>e(x.Item,{role:"menuitem",onClick:()=>{l(i)},children:Z(i)},`${Z(i)}-filter-option`))})]})]}),F.length>0&&e(C,{children:a(Fe,{striped:!0,responsive:!0,className:"DownloadListTableV2",children:[e("thead",{children:a("tr",{children:[e("th",{}),a("th",{children:["Name",e(v,{columnSortBy:"fileName"})]}),a("th",{children:["Size",e(v,{columnSortBy:"fileSize"})]}),a("th",{children:["SynID",e(ke,{onCopy:()=>{y(!0)}}),e(v,{columnSortBy:"synId"})]}),a("th",{children:["Project",e(v,{columnSortBy:"projectName"})]}),a("th",{children:["Added On",e(v,{columnSortBy:"addedOn"})]}),a("th",{children:["Created By",e(v,{columnSortBy:"createdBy"})]}),a("th",{children:["Created On",e(v,{columnSortBy:"createdOn"})]}),e("th",{className:"stickyColumn",children:"Actions"})]})}),a("tbody",{children:[F.map(i=>{if(i){const A=ne(i.addedOn).format("L LT"),N=ne(i.createdOn).format("L LT");return a("tr",{children:[a("td",{className:i.isEligibleForPackaging?"":"ineligibleForPackagingTd",children:[i.isEligibleForPackaging&&e(T,{title:"Eligible for packaging",enterNextDelay:P,placement:"right",children:e("span",{className:"eligibileIcon",children:e(b,{options:{icon:"packagableFile"}})})}),!i.isEligibleForPackaging&&e(T,{title:"This file is ineligible for Web packaging because it is >100MB, or it is an external link, or it is not stored on Synapse native storage",enterNextDelay:P,placement:"right",children:e("span",{className:"ineligibileIcon",children:e(b,{options:{icon:"warningOutlined"}})})})]}),e("td",{children:e("a",{target:"_blank",rel:"noopener noreferrer",href:`${Ne.PORTAL}#!Synapse:${i.fileEntityId}.${i.versionNumber}`,children:i.fileName})}),e("td",{children:i.fileSizeBytes&&le(i.fileSizeBytes)}),e("td",{children:`${i.fileEntityId}.${i.versionNumber}`}),e("td",{children:i.projectName}),e("td",{children:A}),e("td",{children:e(Te,{size:"SMALL USER CARD",ownerId:i.createdBy})}),e("td",{children:N}),e("td",{className:"stickyColumn",children:a("div",{className:"actionsContainer",children:[e("span",{className:"downloadItem",children:e(Ee,{associatedObjectId:i.fileEntityId,associatedObjectType:we.FileEntity,entityVersionNumber:i.versionNumber.toString(),displayFileName:!1,onClickCallback:J=>{J||te({fileEntityId:i.fileEntityId,versionNumber:i.versionNumber},i.fileName,"File Downloaded")}})}),e("span",{className:"programmaticAccessItem",children:e(V,{entityId:i.fileEntityId,version:i.versionNumber})}),e(T,{title:"Remove from Download List",placement:"left",enterNextDelay:P,children:e("span",{className:"removeItem",children:e("button",{className:Ue,onClick:()=>{te({fileEntityId:i.fileEntityId,versionNumber:i.versionNumber},i.fileName,"File Removed")},children:e(b,{options:{icon:"removeCircle"}})})})})]})})]},i.fileEntityId)}else return!1}),e("tr",{ref:c})]})]})}),w&&e(Ie,{numCols:5,numRows:3})]})}try{M.displayName="DownloadListTable",M.__docgenInfo={description:"",displayName:"DownloadListTable",props:{filesStatistics:{defaultValue:null,description:"",name:"filesStatistics",required:!0,type:{name:"FilesStatisticsResponse"}},refetchStatistics:{defaultValue:null,description:"",name:"refetchStatistics",required:!0,type:{name:"() => Promise<any>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/DownloadListTable.tsx#DownloadListTable"]={docgenInfo:M.__docgenInfo,name:"DownloadListTable",path:"src/lib/containers/download_list_v2/DownloadListTable.tsx#DownloadListTable"})}catch{}function Y(t){const{accessToken:o}=E(),r=new Se({defaultOptions:{queries:{staleTime:50*1e3,retry:!1}}});return o?e(_e,{client:r,children:e(be,{children:t.filesStatistics&&e(M,{...t})})}):e(C,{})}try{Y.displayName="AvailableForDownloadTable",Y.__docgenInfo={description:`Table of the files added to the Download Cart that are currently available for download.
Note that this creates it's own QueryClient, so it's cache does not persist if you remount.`,displayName:"AvailableForDownloadTable",props:{filesStatistics:{defaultValue:null,description:"",name:"filesStatistics",required:!0,type:{name:"FilesStatisticsResponse"}},refetchStatistics:{defaultValue:null,description:"",name:"refetchStatistics",required:!0,type:{name:"() => Promise<any>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/AvailableForDownloadTable.tsx#AvailableForDownloadTable"]={docgenInfo:Y.__docgenInfo,name:"AvailableForDownloadTable",path:"src/lib/containers/download_list_v2/AvailableForDownloadTable.tsx#AvailableForDownloadTable"})}catch{}function U(t){const{numFiles:o,numPackagableFiles:r,numBytes:n}=t,s=o-r,c=o===0;return a("span",{className:"DownloadDetailsV2",children:[e("span",{className:"item",children:!c&&a(C,{children:[" ",o," Files "]})}),a("span",{className:"item",children:[e("span",{className:c?"SRC-inactive":"SRC-primary-text-color",children:e(b,{options:{icon:"packagableFile"}})}),!c&&a(C,{children:[" ",r," Files eligible for packaging "]})]}),n>0&&e(T,{title:"This is the total size of all files in the Download Cart that are available to download.",enterNextDelay:P,placement:"top",children:e("span",{className:"item",children:le(n)})}),s>0&&a("span",{className:"item",children:[e("span",{className:"SRC-warning-color",children:e(b,{options:{icon:"warningOutlined"}})}),!c&&a(C,{children:[" ",s," Files ineligible for packaging "]})]})]})}try{U.displayName="DownloadDetails",U.__docgenInfo={description:"",displayName:"DownloadDetails",props:{numFiles:{defaultValue:null,description:"",name:"numFiles",required:!0,type:{name:"number"}},numPackagableFiles:{defaultValue:null,description:"",name:"numPackagableFiles",required:!0,type:{name:"number"}},numBytes:{defaultValue:null,description:"",name:"numBytes",required:!0,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/DownloadDetails.tsx#DownloadDetails"]={docgenInfo:U.__docgenInfo,name:"DownloadDetails",path:"src/lib/containers/download_list_v2/DownloadDetails.tsx#DownloadDetails"})}catch{}function $(t){const{numFiles:o,numPackagableFiles:r,numBytes:n}=t;return e("div",{children:e(U,{numFiles:o,numPackagableFiles:r,numBytes:n})})}try{$.displayName="DownloadListStats",$.__docgenInfo={description:"",displayName:"DownloadListStats",props:{numFiles:{defaultValue:null,description:"",name:"numFiles",required:!0,type:{name:"number"}},numPackagableFiles:{defaultValue:null,description:"",name:"numPackagableFiles",required:!0,type:{name:"number"}},numBytes:{defaultValue:null,description:"",name:"numBytes",required:!0,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/DownloadListStats.tsx#DownloadListStats"]={docgenInfo:$.__docgenInfo,name:"DownloadListStats",path:"src/lib/containers/download_list_v2/DownloadListStats.tsx#DownloadListStats"})}catch{}const $e="Requires Acceptance of Data-Specific Terms of Use",Ke="Requires Acceptance of Data-Specific Terms of Use",He="Requires Approval of Data-Specific Access Requirements",ze="Access Restricted",K=({accessRequirementId:t,count:o})=>{var S,_,l;const r=j(),{data:n,isFetching:s,isError:c,error:d}=xe(t);f.exports.useEffect(()=>{c&&d&&r(d)},[c,d,r]);const[h,y]=f.exports.useState(!1);let p=e(C,{});if(!c&&!s&&n){let g,u="",m="";switch(n.concreteType){case q.TermsOfUseAccessRequirement:g=$e,u=se,m=(S=n.name)!=null?S:"";break;case q.SelfSignAccessRequirement:{g=Ke;const w=n;w.isValidatedProfileRequired?u=ee:w.isCertifiedUserRequired?u=Be:u=se,m=(_=n.name)!=null?_:"";break}case q.ManagedACTAccessRequirement:case q.ACTAccessRequirement:g=He,u=ee,m=(l=n.name)!=null?l:"";break;case"org.sagebionetworks.repo.model.LockAccessRequirement":g=ze,u=ee,m="Access restricted pending review by Synapse Access and Compliance Team.";break}g&&(p=a("div",{className:"MeetAccessRequirementCard actionRequiredCard",children:[e(pe,{type:u}),a("div",{className:"metadata",children:[e(D,{variant:"headline3",className:"title",children:g}),a("div",{className:"fileCount",children:[o," File(s)"]}),e("div",{className:"description",children:m})]}),e("div",{className:"startButtonContainer",children:e(I,{className:"startButton",variant:"primary",onClick:()=>y(!0),children:"Start"})})]}))}return a(C,{children:[!c&&!s&&p,s&&e(k,{}),h&&n&&e(Pe,{entityId:n.subjectIds[0].id,accessRequirementFromProps:[n],renderAsModal:!0,numberOfFilesAffected:o,onHide:()=>y(!1)})]})},k=()=>a("div",{className:"MeetAccessRequirementCard actionRequiredCard",children:[e(B,{variant:"rect",width:136,height:74}),a("div",{className:"metadata",children:[e("div",{className:"title",children:e(B,{width:320})}),e("div",{className:"fileCount",children:e(B,{width:100})})]}),e("div",{className:"startButtonContainer",children:e(B,{variant:"rect",width:160,height:33})})]});try{K.displayName="MeetAccessRequirementCard",K.__docgenInfo={description:"",displayName:"MeetAccessRequirementCard",props:{accessRequirementId:{defaultValue:null,description:"",name:"accessRequirementId",required:!0,type:{name:"number"}},count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/MeetAccessRequirementCard.tsx#MeetAccessRequirementCard"]={docgenInfo:K.__docgenInfo,name:"MeetAccessRequirementCard",path:"src/lib/containers/download_list_v2/MeetAccessRequirementCard.tsx#MeetAccessRequirementCard"})}catch{}try{k.displayName="LoadingAccessRequirementCard",k.__docgenInfo={description:"",displayName:"LoadingAccessRequirementCard",props:{}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/MeetAccessRequirementCard.tsx#LoadingAccessRequirementCard"]={docgenInfo:k.__docgenInfo,name:"LoadingAccessRequirementCard",path:"src/lib/containers/download_list_v2/MeetAccessRequirementCard.tsx#LoadingAccessRequirementCard"})}catch{}const Ge="Download Permission Required",H=({entityId:t,count:o,onViewSharingSettingsClicked:r})=>{const n=j(),{data:s,isLoading:c,isError:d,error:h}=Oe([{targetId:t}]),y=s==null?void 0:s.results[0];return f.exports.useEffect(()=>{d&&h&&n(h)},[d,h,n]),a(C,{children:[!d&&!c&&a("div",{className:"RequestDownloadCart actionRequiredCard",children:[e(pe,{type:Ve}),a("div",{className:"metadata",children:[e(D,{variant:"headline3",className:"title",children:Ge}),a("div",{className:"fileCount",children:[o," File(s)"]}),a("div",{className:"description",children:["You must be granted the download permission on"," ",e("strong",{children:y==null?void 0:y.name})," in order to download this set of files."]})]}),a("div",{className:"startButtonContainer",children:[e(D,{variant:"smallText1",className:"contactAdminNote",children:"Contact an administrator to request download permission"}),e(I,{className:"startButton",variant:"outline-primary",onClick:()=>{r(t)},children:"View Sharing Settings"})]})]}),c&&e(k,{})]})};try{H.displayName="RequestDownloadCard",H.__docgenInfo={description:"",displayName:"RequestDownloadCard",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},count:{defaultValue:null,description:"",name:"count",required:!0,type:{name:"number"}},onViewSharingSettingsClicked:{defaultValue:null,description:'Invoked when a user clicks "View Sharing Settings" for a set of files that require the Download permission',name:"onViewSharingSettingsClicked",required:!0,type:{name:"(benefactorId: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/RequestDownloadCard.tsx#RequestDownloadCard"]={docgenInfo:H.__docgenInfo,name:"RequestDownloadCard",path:"src/lib/containers/download_list_v2/RequestDownloadCard.tsx#RequestDownloadCard"})}catch{}const z=t=>{var u;const o=j(),{ref:r,inView:n}=de(),{data:s,status:c,isLoading:d,hasNextPage:h,isFetchingNextPage:y,fetchNextPage:p,isError:S,error:_}=Ye();f.exports.useEffect(()=>{S&&_&&o(_)},[S,_,o]),f.exports.useEffect(()=>{c==="success"&&!y&&h&&p&&n&&p()},[c,h,y,p,n]);const l=(u=s==null?void 0:s.pages.flatMap(m=>m.page))!=null?u:[],g=m=>{switch(m.action.concreteType){case"org.sagebionetworks.repo.model.download.MeetAccessRequirement":{const w=m.action;return e(K,{accessRequirementId:w.accessRequirementId,count:m.count},w.accessRequirementId)}case"org.sagebionetworks.repo.model.download.RequestDownload":{const w=m.action;return e(H,{entityId:`syn${w.benefactorId}`,count:m.count,onViewSharingSettingsClicked:t.onViewSharingSettingsClicked},w.benefactorId)}default:return}};return a(C,{children:[l.length>0&&a("div",{className:"DownloadListActionsRequired",children:[l.map(m=>m?g(m):!1),e("div",{ref:r})]}),d&&e(k,{})]})};try{z.displayName="DownloadListActionsRequired",z.__docgenInfo={description:"",displayName:"DownloadListActionsRequired",props:{onViewSharingSettingsClicked:{defaultValue:null,description:'Invoked when a user clicks "View Sharing Settings" for a set of files that require the Download permission',name:"onViewSharingSettingsClicked",required:!0,type:{name:"(benefactorId: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/DownloadListActionsRequired.tsx#DownloadListActionsRequired"]={docgenInfo:z.__docgenInfo,name:"DownloadListActionsRequired",path:"src/lib/containers/download_list_v2/DownloadListActionsRequired.tsx#DownloadListActionsRequired"})}catch{}const je="Please provide a package file name and try again.",G=t=>{const{accessToken:o}=E(),[r,n]=f.exports.useState(!1),[s,c]=f.exports.useState(""),[d,h]=f.exports.useState(),[y,p]=f.exports.useState(void 0),{onPackageCreation:S}=t;return a(C,{children:[e("div",{className:"CreatePackageV2 bootstrap-4-backport",children:a("div",{className:"createPackageStep",children:[e("span",{className:"createPackageTitle",children:"Create your Download Package"}),e("span",{className:"createPackageDescription",children:"Name your download package and select Download Package to get started."}),!r&&!y&&a("div",{className:"inputAndCreateButton",children:[e("input",{onChange:g=>{c(g.currentTarget.value)},type:"text",placeholder:"PackageName",style:{width:"233px"}}),e("span",{className:"zipUI",children:".zip"}),e(I,{variant:s?"primary":"dark",onClick:async g=>{if(g.preventDefault(),!s){h({message:je,variant:"danger"});return}n(!0);try{const u=`${s}.zip`,m=await Ce(u,o);p(m);const{resultFileHandleId:w}=m;try{window.location.href=await De(w,o),c(""),p(void 0),S()}catch(R){console.error("Err on getFileHandleByIdURL = ",R)}}catch(u){h({message:u.reason,variant:"danger"})}finally{n(!1)}},type:"button",style:{marginLeft:20},disabled:!s,children:"Download Package"})]}),r&&a("div",{className:"creatingPackage",children:[e("span",{className:"spinner"}),e("span",{style:{marginLeft:5},children:"Creating package..."})]})]})}),e(ue,{show:!!d,variant:d!=null&&d.variant?d.variant:"success",description:d==null?void 0:d.message,autoCloseAfterDelayInSeconds:10,onClose:()=>{h(void 0)}})]})};try{G.displayName="CreatePackageV2",G.__docgenInfo={description:"",displayName:"CreatePackageV2",props:{onPackageCreation:{defaultValue:null,description:"",name:"onPackageCreation",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/CreatePackageV2.tsx#CreatePackageV2"]={docgenInfo:G.__docgenInfo,name:"CreatePackageV2",path:"src/lib/containers/download_list_v2/CreatePackageV2.tsx#CreatePackageV2"})}catch{}const We=`import synapseclient
syn = synapseclient.login()
dl_list_file_entities = syn.get_download_list()`,Qe="synapse get-download-list",O=t=>{const{accessToken:o}=E(),[r,n]=f.exports.useState(0),[s,c]=f.exports.useState(!1),[d,h]=f.exports.useState(!1),[y,p]=f.exports.useState(!1),[S,_]=f.exports.useState(),{data:l,isLoading:g,isError:u,error:m,refetch:w}=qe();return f.exports.useEffect(()=>{u&&m&&_(m)},[u,m]),f.exports.useEffect(()=>{l&&l.numberOfFilesRequiringAction==0&&n(1)},[l]),S?e(ve,{error:S}):a("div",{className:"DownloadCartPage bootstrap-4-backport",children:[e("div",{children:a("div",{className:"pageHeader",children:[a("div",{className:"grid",children:[e("h3",{className:"pageHeaderTitle",children:"Your Download Cart"}),e(T,{title:"Immediately removes all items from your download list",enterNextDelay:300,placement:"right",children:a("a",{className:"clearDownloadListLink",onClick:async()=>{await Ae(o),w()},children:[e("span",{children:e(b,{options:{icon:"delete",padding:"right"}})}),"Clear Your Download Cart"]})})]}),e(D,{className:"description",variant:"body1",children:"You may find your added files in the tabs below. Any files which require actions before download can be found in the Access Actions Required tab, while any that can be downloaded now can be found in the Download List tab."})]})}),e("div",{className:"tabs-container",children:e("div",{className:"container",children:a("ul",{className:"nav nav-tabs",children:[e("li",{className:`nav-item ${r==0?"active":""}`,"aria-selected":r==0,children:a("button",{onClick:()=>n(0),children:["Access Actions Required",!u&&!g&&l&&e("span",{className:"fileCount",children:l.totalNumberOfFiles-l.numberOfFilesAvailableForDownload})]})}),e("li",{className:`nav-item ${r==1?"active":""}`,"aria-selected":r==1,children:a("button",{onClick:()=>n(1),children:["Download List",!u&&!g&&l&&e("span",{className:"fileCount",children:l.numberOfFilesAvailableForDownload})]})})]})})}),r==0&&!u&&!g&&l&&a("div",{children:[l.numberOfFilesRequiringAction>0&&e("div",{children:e("div",{className:"actionsRequiredContainer container",children:e(z,{...t})})}),l.numberOfFilesRequiringAction===0&&e("div",{className:"placeholder",children:e("div",{children:"No actions are currently required."})})]}),r==1&&!u&&!g&&l&&a("div",{children:[l.numberOfFilesAvailableForDownload>0&&a("div",{className:"DownloadListTabContent",children:[e("div",{className:"subSectionOverviewContainer",children:a("div",{className:"subSectionOverview container",children:[a("div",{children:[a("div",{className:"headlineWithHelp",children:[a(D,{variant:"headline3",children:[e(b,{options:{icon:"packagableFile"}})," Web Download (.ZIP Packages)"]}),e(oe,{markdownText:"This will allow you to create a .zip file that contains eligible files. Files greater that 100 MB, external links, or files which are not stored on Synapse native storage are ineligible. In most cases, ineligible files can be downloaded individually. External links will require navigation to an external site, which may require a seperate login process.",helpUrl:"https://help.synapse.org/docs/Downloading-Data-From-the-Synapse-UI.2004254837.html"})]}),e(D,{variant:"body1",children:a("ul",{children:[e("li",{children:"Eligible files will be added to .ZIP packages of up to 1GB in size"}),e("li",{children:"If you have more than 1GB, you can create multiple packages"}),e("li",{children:"Will only include files which are hosted on Synapse native storage"}),e("li",{children:"Packages include a CSV manifest that contains file annotations and other information for each file"})]})}),a("span",{children:[l.numberOfFilesAvailableForDownloadAndEligibleForPackaging>0&&a(I,{variant:"sds-primary",onClick:()=>{c(!0)},children:[e(b,{options:{icon:"download"}}),"Download As .Zip Packages"]}),l.numberOfFilesAvailableForDownloadAndEligibleForPackaging==0&&e(T,{title:"You cannot create a .zip package because there are no eligible files.",enterNextDelay:300,placement:"top",children:a(I,{variant:"sds-primary",disabled:!0,children:[e(b,{options:{icon:"download"}}),"\xA0Download As .Zip Packages"]})})]})]}),a("div",{children:[a("div",{className:"headlineWithHelp",children:[a(D,{variant:"headline3",children:[e(b,{options:{icon:"code"}})," Programmatic Download"]}),e(oe,{markdownText:"This will provide syntax which you can enter into your programmatic client. It is suitable for large files (>100 MB), for packages > 1GB, and for files which aren\u2019t stored on Synapse native storage (e.g. in a special AWS S3 or Google Cloud bucket).  External links will require navigation to an external site, which may require a separate login process.",helpUrl:"https://help.synapse.org/docs/Downloading-Data-Programmatically.2003796248.html"})]}),e(D,{variant:"body1",children:a("ul",{children:[e("li",{children:"Requires installation of a programmatic client (R, Python, CLI)"}),e("li",{children:"No limit to the file size or the size of the package that can be downloaded"}),e("li",{children:"Will include files which are hosted on and off Synapse native storage"}),e("li",{children:"Packages include a CSV manifest that contains file annotations and other information for each file"})]})}),e("span",{children:a(I,{variant:"sds-primary",onClick:()=>{h(!0)},children:[e(b,{options:{icon:"code"}}),"\xA0Create Programmatic Package"]})})]})]})}),a("div",{className:"availableForDownloadTableContainer container",children:[s&&e(G,{onPackageCreation:()=>{p(!0),w()}}),e($,{numBytes:l.sumOfFileSizesAvailableForDownload,numPackagableFiles:l.numberOfFilesAvailableForDownloadAndEligibleForPackaging,numFiles:l.numberOfFilesAvailableForDownload}),w&&e(Y,{filesStatistics:l,refetchStatistics:w})]})]}),l.numberOfFilesAvailableForDownload===0&&e("div",{className:"placeholder",children:e("div",{children:"Your Download List is currently empty."})})]}),e(ue,{show:y,variant:"success",title:"Package Created",description:"A package has been created with eligible files. The items contained in this .zip file have been removed from your list. If your package is over 1GB, you will need to create multiple packages.",autoCloseAfterDelayInSeconds:10,onClose:()=>{p(!1)}}),d&&e(me,{show:!0,onClose:()=>h(!1),title:"Download Programmatically",pythonCode:We,cliCode:Qe})]})};try{O.displayName="DownloadCartPage",O.__docgenInfo={description:"Show the Download Cart page.",displayName:"DownloadCartPage",props:{onViewSharingSettingsClicked:{defaultValue:null,description:'Invoked when a user clicks "View Sharing Settings" for a set of files that require the Download permission',name:"onViewSharingSettingsClicked",required:!0,type:{name:"(benefactorId: string) => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/download_list_v2/DownloadCartPage.tsx#DownloadCartPage"]={docgenInfo:O.__docgenInfo,name:"DownloadCartPage",path:"src/lib/containers/download_list_v2/DownloadCartPage.tsx#DownloadCartPage"})}catch{}const Xt={parameters:{storySource:{source:`import React from 'react'
import { ComponentStory, ComponentMeta } from '@storybook/react'

import { DownloadCartPage } from './DownloadCartPage'

// More on default export: https://storybook.js.org/docs/react/writing-stories/introduction#default-export
export default {
  title: 'Download/DownloadCartPage',
  component: DownloadCartPage,
  // More on argTypes: https://storybook.js.org/docs/react/api/argtypes
  argTypes: {},
} as ComponentMeta<typeof DownloadCartPage>

// More on component templates: https://storybook.js.org/docs/react/writing-stories/introduction#using-args
const Template: ComponentStory<typeof DownloadCartPage> = args => (
  <DownloadCartPage {...args} />
)
export const Demo = Template.bind({})
`,locationsMap:{demo:{startLoc:{col:58,line:15},endLoc:{col:1,line:17},startBody:{col:58,line:15},endBody:{col:1,line:17}}}}},title:"Download/DownloadCartPage",component:O,argTypes:{}},Ze=t=>e(O,{...t}),ei=Ze.bind({}),ai=["Demo"];export{ei as Demo,ai as __namedExportsOrder,Xt as default};
