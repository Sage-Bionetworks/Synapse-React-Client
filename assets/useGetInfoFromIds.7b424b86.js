import{r as g}from"./jsx-runtime.0db21b62.js";import{u as S}from"./use-deep-compare-effect.esm.f1067dd3.js";import{V as O,_ as T,aM as R,aS as _}from"./index.90ee2b5e.js";import{u as h,c as k}from"./uniq.f7024654.js";import{w as A}from"./without.a296bf52.js";import{V as y,C as F,y as N,z as D}from"./SynapseConstants.290eab74.js";const b={ownerId:"",firstName:"Unknown",lastName:"Unknown",userName:"Unknown",isIndividual:!1},H={name:"Unknown",id:"unknown",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:0,versionLabel:"placeholder",benefactorId:0,createdOn:"null",modifiedOn:"null",createdBy:"null",modifiedBy:"null",isLatestVersion:!0},v={id:"unknown",etag:"Unknown",name:"Unknown",description:"Unknown",ownerId:"null",createdOn:"null",contentSource:"Unknown",submissionInstructionsMessage:"Unknown",submissionReceiptMessage:"Unknown"},L=async(o,c)=>{const e=await T(o,c),n=o.filter(t=>e.results.map(d=>d.id).indexOf(t.targetId)===-1).map(t=>({...H,id:t.targetId,name:`${t.targetId}`}));return[...e.results,...n]},P=async o=>{const c=(await R(o)).children,i=o.filter(n=>c.map(t=>t.ownerId).indexOf(n)===-1).map(n=>({...b,ownerId:n,name:`Unknown User (${n})`}));return[...c,...i]},V=async(o,c)=>{const e=await _(o,c),n=o.filter(t=>e.results.map(d=>d.id).indexOf(t)===-1).map(t=>({...v,id:t,name:t}));return[...e.results,...n]};function J(o){const{ids:c,type:e}=o,{accessToken:i}=O(),[n,t]=g.exports.useState([]),d=a=>a==="USER_PROFILE"?"ownerId":"id",w=a=>{switch(a){case"USER_PROFILE":return D;case"ENTITY_HEADER":return N;case"EVALUATION_QUEUE":return F;default:return""}},p=n.map(a=>a[d(e)]),U=c.filter(a=>a!==y),I=h(A(U,...p));return g.exports.useEffect(()=>{((l,r)=>{if(!l.length)return;const m=sessionStorage.getItem(w(r));try{const u=m?JSON.parse(m):[],E=u.map(s=>s[d(r)]);for(const s of l)E.includes(s[d(r)])||u.push(s);sessionStorage.setItem(w(r),JSON.stringify(u))}catch{sessionStorage.setItem(w(r),JSON.stringify(l))}})(n,e)},[n,e]),S(()=>{let a=!1;return(async()=>{if(I.length>0)try{const r=Array.from(I),m=e==="ENTITY_HEADER"?r.map(s=>({targetId:s})):r,u=k(m,45),E=[];for(const s of u){let f=[];switch(e){case"USER_PROFILE":f=await P(s);break;case"ENTITY_HEADER":f=await L(s,i);break;case"EVALUATION_QUEUE":f=await V(s,i);break}E.push(...f)}a||t(s=>s.concat(...E))}catch(r){console.error("Error on data retrieval",r)}})(),()=>{a=!0}},[i,e,I]),n}export{J as u};
