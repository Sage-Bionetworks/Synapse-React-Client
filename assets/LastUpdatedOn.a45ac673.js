import{b as H,e as ye,i as ge,j as Se,m as ct,n as ut,C as pt,o as ht,p as mt,E as ft,g as yt,h as gt}from"./TotalQueryResults.43f78149.js";import{H as Pe}from"./HelpPopover.a3d033d8.js";import{I as B,S as St}from"./IconSvg.e3afc045.js";import{j as n,a as R,F as k}from"./jsx-runtime.00d70968.js";import{a as Be}from"./Collapse.a100796c.js";import{u as $e,E as be}from"./ElementWithTooltip.b433e11d.js";import{C as L}from"./ColumnType.744125d2.js";import"./assert.5b7ccaee.js";import{C as bt,k as pe}from"./ToastMessage.72011e3e.js";import{cK as Ct,bU as wt,k as vt,cL as Tt,f as Y,p as It,cs as _t,ah as Rt,bk as Et,cM as Lt,W as xt,ct as qt,cc as Dt,az as Nt,cN as Qe,F as Ot,B as At,Y as Ft,bE as ee,H as kt,I as Vt}from"./index.a1e86edf.js";import{l as U,m as Pt,n as W,o as nt,p as Bt}from"./EntityTypeUtils.017b0334.js";import{c as X,j as $t,u as Mt,d as Ne}from"./Tooltip.006e7cf4.js";import{M as Q,a as zt,b as Qt}from"./Modal.ec8bc390.js";import{B as he}from"./Button.fda23eee.js";import{b as Ht}from"./use-deep-compare-effect.esm.357a0ad8.js";import{P as Ut}from"./ProgrammaticInstructionsModal.604c5adb.js";import{D as M}from"./Dropdown.13d94a98.js";import{T as Ce}from"./Typography.e0d7a65e.js";import{Q as Gt}from"./QueryCount.48b937d0.js";import{I as ot}from"./index.b57129f3.js";import{c as j}from"./cloneDeep.4884eaa4.js";import{c as Wt,g as Yt}from"./iframe.11e08736.js";import{N as Kt}from"./NoData.22383cce.js";import{P as Oe}from"./getEndpoint.bb7ded34.js";import{b as jt,U as Xt,g as Zt}from"./UserCard.cc805b61.js";import{D as at,I as Jt}from"./InteractiveCopyIdsIcon.fade1a7f.js";import{H as en}from"./HasAccessV2.a947d0f7.js";import{S as tn,l as nn}from"./LoadingScreen.b468edab.js";import{F as on}from"./core.esm.9edf5e61.js";import{p as an,b as rn,f as sn,a as ln}from"./sqlFunctions.b49ac766.js";import{u as Me}from"./react-intersection-observer.esm.e445ee86.js";import{E as Ae}from"./EntityLink.b6109c38.js";import{S as dn,d as cn,N as un}from"./CardContainerLogic.47cde78e.js";import{N as pn,I as He}from"./SynapseTableConstants.07ecdebd.js";import{n as hn}from"./uniq.1ecb9ae9.js";import{C as mn}from"./Checkbox.96de280e.js";import{b as ze,_ as me,w as rt,h as z,d as Fe,e as Ie}from"./withStyles.d50e1a5a.js";import{d as P}from"./toConsumableArray.c4898ee4.js";import{_ as fn}from"./slicedToArray.e72f11da.js";import{B as yn}from"./ButtonBase.da3c7a65.js";import{h as gn}from"./moment.a565bb48.js";import{f as Sn}from"./DateFormatter.1a517242.js";const bn=X(n("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"}));function Cn(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=p.boundaryCount,a=t===void 0?1:t,o=p.componentName,l=o===void 0?"usePagination":o,d=p.count,i=d===void 0?1:d,h=p.defaultPage,b=h===void 0?1:h,f=p.disabled,v=f===void 0?!1:f,c=p.hideNextButton,g=c===void 0?!1:c,I=p.hidePrevButton,_=I===void 0?!1:I,m=p.onChange,T=p.page,s=p.showFirstButton,q=s===void 0?!1:s,r=p.showLastButton,e=r===void 0?!1:r,u=p.siblingCount,y=u===void 0?1:u,S=ze(p,["boundaryCount","componentName","count","defaultPage","disabled","hideNextButton","hidePrevButton","onChange","page","showFirstButton","showLastButton","siblingCount"]),w=$t({controlled:T,default:b,name:l,state:"page"}),C=fn(w,2),E=C[0],x=C[1],A=function(V,$){T||x($),m&&m(V,$)},N=function(V,$){var lt=$-V+1;return Array.from({length:lt},function(po,dt){return V+dt})},D=N(1,Math.min(a,i)),F=N(Math.max(i-a+1,a+1),i),Z=Math.max(Math.min(E-y,i-a-y*2-1),a+2),J=Math.min(Math.max(E+y,a+y*2+2),F[0]-2),we=[].concat(P(q?["first"]:[]),P(_?[]:["previous"]),P(D),P(Z>a+2?["start-ellipsis"]:a+1<i-a?[a+1]:[]),P(N(Z,J)),P(J<i-a-1?["end-ellipsis"]:i-a>a?[i-a]:[]),P(F),P(g?[]:["next"]),P(e?["last"]:[])),ve=function(V){switch(V){case"first":return 1;case"previous":return E-1;case"next":return E+1;case"last":return i;default:return null}},Te=we.map(function(O){return typeof O=="number"?{onClick:function($){A($,O)},type:"page",page:O,selected:O===E,disabled:v,"aria-current":O===E?"true":void 0}:{onClick:function($){A($,ve(O))},type:O,page:ve(O),selected:!1,disabled:v||O.indexOf("ellipsis")===-1&&(O==="next"||O==="last"?E>=i:E<=1)}});return me({items:Te},S)}const Ue=X(n("path",{d:"M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"})),Ge=X(n("path",{d:"M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"})),We=X(n("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"})),Ye=X(n("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"})),wn=window.React;var vn=function(t){return{root:me({},t.typography.body2,{borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:t.palette.text.primary}),page:{transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:t.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},"&$focusVisible":{backgroundColor:t.palette.action.focus},"&$selected":{backgroundColor:t.palette.action.selected,"&:hover, &$focusVisible":{backgroundColor:z(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:1,color:t.palette.action.disabled,backgroundColor:t.palette.action.selected}},"&$disabled":{opacity:t.palette.action.disabledOpacity}},sizeSmall:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px","& $icon":{fontSize:t.typography.pxToRem(18)}},sizeLarge:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15),"& $icon":{fontSize:t.typography.pxToRem(22)}},textPrimary:{"&$selected":{color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.primary.dark,"@media (hover: none)":{backgroundColor:t.palette.primary.main}},"&$disabled":{color:t.palette.action.disabled}}},textSecondary:{"&$selected":{color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover, &$focusVisible":{backgroundColor:t.palette.secondary.dark,"@media (hover: none)":{backgroundColor:t.palette.secondary.main}},"&$disabled":{color:t.palette.action.disabled}}},outlined:{border:"1px solid ".concat(t.palette.type==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$selected":{"&$disabled":{border:"1px solid ".concat(t.palette.action.disabledBackground)}}},outlinedPrimary:{"&$selected":{color:t.palette.primary.main,border:"1px solid ".concat(z(t.palette.primary.main,.5)),backgroundColor:z(t.palette.primary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:z(t.palette.primary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},outlinedSecondary:{"&$selected":{color:t.palette.secondary.main,border:"1px solid ".concat(z(t.palette.secondary.main,.5)),backgroundColor:z(t.palette.secondary.main,t.palette.action.activatedOpacity),"&:hover, &$focusVisible":{backgroundColor:z(t.palette.secondary.main,t.palette.action.activatedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{color:t.palette.action.disabled}}},rounded:{borderRadius:t.shape.borderRadius},ellipsis:{height:"auto","&$disabled":{opacity:t.palette.action.disabledOpacity}},focusVisible:{},disabled:{},selected:{},icon:{fontSize:t.typography.pxToRem(20),margin:"0 -8px"}}},Tn=wn.forwardRef(function(t,a){var o=t.classes,l=t.className,d=t.color,i=d===void 0?"standard":d,h=t.component,b=t.disabled,f=b===void 0?!1:b,v=t.page,c=t.selected,g=c===void 0?!1:c,I=t.shape,_=I===void 0?"round":I,m=t.size,T=m===void 0?"medium":m,s=t.type,q=s===void 0?"page":s,r=t.variant,e=r===void 0?"text":r,u=ze(t,["classes","className","color","component","disabled","page","selected","shape","size","type","variant"]),y=Mt(),S=y.direction==="rtl"?{previous:Ye,next:We,last:Ue,first:Ge}:{previous:We,next:Ye,first:Ue,last:Ge},w=S[q];return q==="start-ellipsis"||q==="end-ellipsis"?n("div",{ref:a,className:Fe(o.root,o.ellipsis,f&&o.disabled,T!=="medium"&&o["size".concat(Ie(T))]),children:"\u2026"}):R(yn,{ref:a,component:h,disabled:f,focusVisibleClassName:o.focusVisible,className:Fe(o.root,o.page,o[e],o[_],l,i!=="standard"&&o["".concat(e).concat(Ie(i))],f&&o.disabled,g&&o.selected,T!=="medium"&&o["size".concat(Ie(T))]),...u,children:[q==="page"&&v,w?n(w,{className:o.icon}):null]})});const In=rt(vn,{name:"MuiPaginationItem"})(Tn),_n=window.React;var Rn={root:{},ul:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"}};function En(p,t,a){return p==="page"?"".concat(a?"":"Go to ","page ").concat(t):"Go to ".concat(p," page")}var Ln=_n.forwardRef(function(t,a){t.boundaryCount;var o=t.classes,l=t.className,d=t.color,i=d===void 0?"standard":d;t.count,t.defaultPage,t.disabled;var h=t.getItemAriaLabel,b=h===void 0?En:h;t.hideNextButton,t.hidePrevButton,t.onChange,t.page;var f=t.renderItem,v=f===void 0?function(e){return n(In,{...e})}:f,c=t.shape,g=c===void 0?"round":c;t.showFirstButton,t.showLastButton,t.siblingCount;var I=t.size,_=I===void 0?"medium":I,m=t.variant,T=m===void 0?"text":m,s=ze(t,["boundaryCount","classes","className","color","count","defaultPage","disabled","getItemAriaLabel","hideNextButton","hidePrevButton","onChange","page","renderItem","shape","showFirstButton","showLastButton","siblingCount","size","variant"]),q=Cn(me({},t,{componentName:"Pagination"})),r=q.items;return n("nav",{"aria-label":"pagination navigation",className:Fe(o.root,l),ref:a,...s,children:n("ul",{className:o.ul,children:r.map(function(e,u){return n("li",{children:v(me({},e,{color:i,"aria-label":b(e.type,e.page,e.selected),shape:g,size:_,variant:T}))},u)})})})});const xn=rt(Rn,{name:"MuiPagination"})(Ln),qn=window.React.useRef,Dn=window.React.useState,_e=3,Re=({helpMessage:p="This search bar is powered by MySQL Full Text Search.",helpUrl:t})=>{const{executeQueryRequest:a,getLastQueryRequest:o}=H(),{topLevelControlsState:{showSearchBar:l,showFacetFilter:d}}=ye(),[i,h]=Dn(""),b=qn(null),f=c=>{var g;if(c.preventDefault(),i.trim().length<_e)(g=b.current)==null||g.setCustomValidity(`Search term must have a minimum of ${_e} characters`);else{const I=o(),{additionalFilters:_=[]}=I.query,m={concreteType:"org.sagebionetworks.repo.model.table.TextMatchesQueryFilter",searchExpression:i};if(_.find(s=>s.concreteType==m.concreteType&&s.searchExpression==m.searchExpression))return;_.push(m),I.query.additionalFilters=_,a(I),h("")}},v=c=>{var g;(g=b.current)==null||g.setCustomValidity(""),h(c.currentTarget.value)};return n("div",{className:`QueryWrapperSearchInput ${d?ge:Se}`,children:n(Be,{in:l,timeout:{enter:300,exit:300},children:R("div",{className:"QueryWrapperSearchInput__helppopoverwrapper",children:[R("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:f,children:[n("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:n(B,{options:{icon:"search"}})}),n("input",{ref:b,minLength:_e,onChange:v,placeholder:"Enter Search Terms",value:i,type:"text"}),i.length>0&&n("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{h("")},children:n(B,{options:{icon:"close"}})})]}),n("div",{className:"QueryWrapperSearchInput__helppopover",children:n(Pe,{markdownText:p,helpUrl:t,placement:"left"})})]})})})};try{Re.displayName="FullTextSearch",Re.__docgenInfo={description:"",displayName:"FullTextSearch",props:{helpMessage:{defaultValue:{value:"This search bar is powered by MySQL Full Text Search."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:null,description:"",name:"helpUrl",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/FullTextSearch.tsx#FullTextSearch"]={docgenInfo:Re.__docgenInfo,name:"FullTextSearch",path:"src/lib/containers/FullTextSearch.tsx#FullTextSearch"})}catch{}const ke="First line is the columns names.",Ve="Include row metadata (Row Id and Row Version).",fe="Comma Separated Values (CSV)",Ke="Tab Separated Values (TSV)",Nn={title:"Download query results",type:"object",properties:{"File Type":{type:"string",oneOf:[{const:fe,title:fe},{const:Ke,title:Ke}]},Contents:{type:"array",title:"Contents",items:{type:"string",enum:[ke,Ve]},uniqueItems:!0}}},On={"File Type":{"ui:widget":"radio"},Contents:{"ui:widget":"checkboxes"}},An={title:"Download query results",description:"File is ready for download. Select the download button to download the file.",type:"object"},Fn={},kn=[Nn,An],Vn=[On,Fn],Pn=window.React;class G extends Pn.Component{constructor(t){super(t),this.handleSubmit=a=>{this.state.step===0?this.handleDownloadSetup(a):this.onDownload()},this.handleDownloadSetup=a=>{this.setState({isLoading:!0});const{formData:o}=a,l=o["File Type"],d=o.Contents,{queryBundleRequest:i,getLastQueryRequest:h}=this.props,b=l===fe?",":"	",f=d.includes(ke),v=d.includes(Ve),c=i!=null?i:h(),g=c.query.sql,I={sql:g,entityId:an(g),selectedFacets:c.query.selectedFacets,concreteType:"org.sagebionetworks.repo.model.table.DownloadFromTableRequest",writeHeader:f,includeRowIdAndRowVersion:v,csvTableDescriptor:{separator:b},additionalFilters:c.query.additionalFilters};Ct(I,this.context.accessToken).then(_=>{this.setState({isLoading:!1,step:1,data:_})}).catch(_=>{console.log("Error getDownloadFromTableRequest: ",_)})},this.onDownload=()=>{const{data:a}=this.state;wt(a.resultsFileHandleId,this.context.accessToken).then(o=>{window.location.href=o,this.props.onClose()})},this.handleChange=a=>{const{formData:o}=a;this.setState({formData:o})},this.state={isLoading:!1,step:0,formData:{"File Type":fe,Contents:[ke,Ve]}}}render(){const t={position:"absolute",top:10,right:10,zIndex:10},a={height:50,width:50,backgroundSize:50};return n(Q,{animation:!1,show:!0,onHide:this.props.onClose,backdrop:"static",children:R(Q.Body,{children:[n("button",{style:t,onClick:this.props.onClose,children:n(B,{options:{icon:"close"}})}),R(on,{schema:kn[this.state.step],uiSchema:Vn[this.state.step],onChange:this.handleChange,formData:this.state.formData,onSubmit:this.handleSubmit,children:[this.state.isLoading&&n("div",{className:"SRC-centerAndJustifyContent",children:R("div",{className:"SRC-center-text",children:[n("p",{children:" Creating the File "}),n("div",{style:a,className:"spinner"}),n("p",{children:" Loading... "})]})}),R("div",{style:{textAlign:"right"},children:[n(he,{variant:"default",onClick:this.props.onClose,style:{marginRight:"5px"},children:"Cancel"}),n(he,{type:"submit",variant:"primary",children:this.state.step===0?"Next":"Download"})]})]})]})})}}G.contextType=vt;try{G.displayName="ModalDownload",G.__docgenInfo={description:"",displayName:"ModalDownload",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"(...args: any[]) => void"}},includeEntityEtag:{defaultValue:null,description:"",name:"includeEntityEtag",required:!1,type:{name:"boolean"}},queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!1,type:{name:"QueryBundleRequest"}},getLastQueryRequest:{defaultValue:null,description:"",name:"getLastQueryRequest",required:!1,type:{name:"(() => QueryBundleRequest)"}},offset:{defaultValue:null,description:"",name:"offset",required:!1,type:{name:"number"}},limit:{defaultValue:null,description:"",name:"limit",required:!1,type:{name:"number"}},sort:{defaultValue:null,description:"",name:"sort",required:!1,type:{name:"SortItem[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/ModalDownload.tsx#ModalDownload"]={docgenInfo:G.__docgenInfo,name:"ModalDownload",path:"src/lib/containers/ModalDownload.tsx#ModalDownload"})}catch{}const Ee=window.React;class Le extends Ee.Component{constructor(t){var a;super(t),this.handleClickOutsideForm=o=>{var l,d;!((l=this.searchFormRef.current)!=null&&l.contains(o==null?void 0:o.target))&&!((d=this.radioFormRef.current)!=null&&d.contains(o==null?void 0:o.target))&&(this.state.didUpdateRanLast?this.setState({didUpdateRanLast:!1}):this.setState({show:!1}))},this.search=o=>{var I,_,m,T,s,q,r;o.preventDefault();const{searchText:l}=this.state;let{columnName:d}=this.state;const{searchable:i,lockedColumn:h}=this.props;if(d==="")if(i)d=i.filter(e=>e!==(h==null?void 0:h.columnName))[0];else{const e=(m=(_=(I=this.props.queryContext)==null?void 0:I.data)==null?void 0:_.columnModels)==null?void 0:m.filter(u=>u.name!==(h==null?void 0:h.columnName)).filter(u=>this.isSupportedColumn(u));d=(T=e==null?void 0:e[0].name)!=null?T:""}this.setState({show:!1});const{executeQueryRequest:b,getLastQueryRequest:f}=this.props.queryContext,v=f(),{additionalFilters:c=[]}=v.query,g=c.findIndex(e=>!!(ct(e)||ut(e)&&e.columnName===d));if(g===-1){const e=(r=(q=(s=this.props.queryContext)==null?void 0:s.data)==null?void 0:q.columnModels)==null?void 0:r.filter(u=>u.name===d)[0];if(e!=null&&e.columnType.endsWith("_LIST")){const u={columnName:d,function:pt.HAS_LIKE,values:[`%${l}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnMultiValueFunctionQueryFilter"};c.push(u)}else{const u={columnName:d,operator:ht.LIKE,values:[`%${l}%`],concreteType:"org.sagebionetworks.repo.model.table.ColumnSingleValueQueryFilter"};c.push(u)}}else c[g].values.push(`%${l}%`);v.query.additionalFilters=c,b(v)},this.handleChange=o=>{this.setState({searchText:o.currentTarget.value})},this.isSupportedColumn=o=>{switch(o==null?void 0:o.columnType){case L.FILEHANDLEID:case L.ENTITYID:case L.DATE:case L.DATE_LIST:case L.USERID:return!1;default:return!0}},this.isSupportedColumnAndInProps=o=>{if(this.isSupportedColumn(o)){const{searchable:l}=this.props;return l==null?void 0:l.some(d=>d===(o==null?void 0:o.name))}return!1},this.state={show:!1,didUpdateRanLast:!1,searchText:"",columnName:(a=this.props.defaultColumn)!=null?a:""},this.searchFormRef=Ee.createRef(),this.radioFormRef=Ee.createRef()}componentDidMount(){document.addEventListener("click",this.handleClickOutsideForm)}componentDidUpdate(t){var a,o,l,d,i;!((a=t.queryVisualizationContext)!=null&&a.topLevelControlsState.showSearchBar)&&((o=this.props.queryVisualizationContext)==null?void 0:o.topLevelControlsState.showSearchBar)&&(this.setState({show:!0,didUpdateRanLast:!0}),(i=(d=(l=this.searchFormRef)==null?void 0:l.current)==null?void 0:d.querySelector("input"))==null||i.focus())}componentWillUnmount(){document.removeEventListener("click",this.handleClickOutsideForm)}render(){var c;const{searchable:t,lockedColumn:a,queryContext:{data:o},queryVisualizationContext:{topLevelControlsState:l,facetAliases:d}}=this.props,{searchText:i,show:h,columnName:b}=this.state;let f=[];t?f=t.map(g=>{var I;return(I=o==null?void 0:o.columnModels)==null?void 0:I.find(_=>_.name===g)}).filter(this.isSupportedColumnAndInProps).map(g=>g.name):o!=null&&o.columnModels&&(f=(c=o.columnModels)==null?void 0:c.filter(this.isSupportedColumn).map(g=>g.name)),f.length&&(a==null?void 0:a.columnName)&&(f=f.filter(g=>g!==(a==null?void 0:a.columnName)));const v=l==null?void 0:l.showFacetFilter;return R("div",{className:`QueryWrapperSearchInput ${v?ge:Se}`,children:[n(Be,{in:l==null?void 0:l.showSearchBar,children:R("form",{className:"QueryWrapperSearchInput__searchbar",onSubmit:this.search,onClick:()=>{this.setState({show:!0})},ref:this.searchFormRef,children:[n("span",{className:"QueryWrapperSearchInput__searchbar__searchicon",children:n(B,{options:{icon:"search"}})}),n("input",{onChange:this.handleChange,onClick:()=>{this.setState({show:!0})},placeholder:"Enter Search Terms",value:i,type:"text"}),this.state.searchText.length>0&&n("button",{className:"QueryWrapperSearchInput__searchbar__clearbutton",type:"button",onClick:()=>{this.setState({searchText:""})},children:n(B,{options:{icon:"close"}})})]})}),n("div",{className:"QueryWrapperSearchInput__dropdown_pos",children:n(bt,{in:h,classNames:"QueryWrapperSearchInput__animate_dropdown",timeout:{enter:0,exit:300},children:R("form",{ref:this.radioFormRef,className:"QueryWrapperSearchInput__column-select QueryWrapperSearchInput__animate_height",children:[n("p",{className:"deemphasized",children:n("i",{children:" Search In Field: "})}),f.map((g,I)=>{const _=$e(g,d);return n("div",{className:"radio",children:n("label",{children:R("span",{children:[n("input",{id:g,type:"radio",value:g,checked:b===""&&I===0||b===g,onClick:()=>{var T,s,q;(q=(s=(T=this.searchFormRef)==null?void 0:T.current)==null?void 0:s.querySelector("input"))==null||q.focus(),this.setState({columnName:g})}}),n("span",{children:_})]})})},`search-field-${g}-${I}`)})]})})})]})}}try{Le.displayName="Search",Le.__docgenInfo={description:"",displayName:"Search",props:{queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},isQueryWrapperMenuChild:{defaultValue:null,description:"",name:"isQueryWrapperMenuChild",required:!1,type:{name:"boolean"}},defaultColumn:{defaultValue:null,description:"",name:"defaultColumn",required:!1,type:{name:"string"}},searchable:{defaultValue:null,description:"",name:"searchable",required:!1,type:{name:"SearchableColumnsV2"}},lockedColumn:{defaultValue:null,description:"",name:"lockedColumn",required:!1,type:{name:"LockedColumn"}},fullTextSearchHelpURL:{defaultValue:null,description:"",name:"fullTextSearchHelpURL",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/SearchV2.tsx#Search"]={docgenInfo:Le.__docgenInfo,name:"Search",path:"src/lib/containers/SearchV2.tsx#Search"})}catch{}const Bn=window.React.useEffect,$n=window.React.useRef,Mn=window.React.useState,zn="The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients.",Qn="https://help.synapse.org/docs/Searching-Tables-and-Views.2009596168.html#SearchingTablesandViews-UsingAdvancedSearchQueries",xe=({helpMessage:p=zn,helpUrl:t=Qn})=>{const{executeQueryRequest:a,getLastQueryRequest:o}=H(),{topLevelControlsState:{showSqlEditor:l,showFacetFilter:d}}=ye(),[i,h]=Mn(""),b=$n(null);Bn(()=>{var c;if(l){const g=o().query.sql;h(g),(c=b.current)==null||c.focus()}},[l,o]);const f=c=>{c.preventDefault();const g=o();g.query.sql=i,g.query.offset=0,g.query.additionalFilters=[],g.query.selectedFacets=[],a(g)},v=c=>{var g;(g=b.current)==null||g.setCustomValidity(""),h(c.currentTarget.value)};return n("div",{className:`QueryWrapperSqlEditorInput ${d?ge:Se}`,children:n(Be,{in:l,timeout:{enter:300,exit:300},children:R("div",{className:"QueryWrapperSqlEditorInput__helppopoverwrapper",children:[R("form",{className:"QueryWrapperSqlEditorInput__searchbar",onSubmit:f,children:[n(St,{className:"QueryWrapperSqlEditorInput__searchbar__searchicon"}),n("input",{ref:b,onChange:v,placeholder:"Enter Query",value:i,type:"text"})]}),n("div",{className:"QueryWrapperSqlEditorInput__helppopover",children:n(Pe,{markdownText:p,helpUrl:t,placement:"right"})})]})})})};try{xe.displayName="SqlEditor",xe.__docgenInfo={description:"",displayName:"SqlEditor",props:{helpMessage:{defaultValue:{value:"The data within tables and views can be retrieved by using a SQL-like query language either from the web interface or from the programmatic clients."},description:"",name:"helpMessage",required:!1,type:{name:"string"}},helpUrl:{defaultValue:{value:"https://help.synapse.org/docs/Searching-Tables-and-Views.2009596168.html#SearchingTablesandViews-UsingAdvancedSearchQueries"},description:"",name:"helpUrl",required:!1,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/SqlEditor.tsx#SqlEditor"]={docgenInfo:xe.__docgenInfo,name:"SqlEditor",path:"src/lib/containers/SqlEditor.tsx#SqlEditor"})}catch{}const ne=p=>R(Q,{animation:!1,show:!0,onHide:()=>p.onHide(),backdrop:"static",children:[n(Q.Header,{closeButton:!0,children:n("span",{style:{fontWeight:"bold",color:"#515359",fontSize:"1.5em"},children:"Sign In Required"})}),R(zt,{children:[n("p",{children:"Anyone can browse public content on the Synapse website, but in order to download and create content you will need to register for an account using an email address."}),R("p",{children:["To find out more see\xA0",n("a",{href:"https://help.synapse.org/docs/Managing-your-account.2055405596.html",target:"_blank",rel:"noopener noreferrer",children:"User Accounts"}),n("span",{children:" and "}),n("a",{href:"https://help.synapse.org/docs/Synapse-Governance.2004255211.html",rel:"noopener noreferrer",target:"_blank",children:"Governance Overview"}),"."]})]}),R(Qt,{children:[n(he,{variant:"secondary",onClick:()=>p.onHide(),children:"CANCEL"}),n(he,{className:"SRC-SIGN-IN-CLASS",variant:"primary",onClick:()=>p.onHide(),children:"Sign in"})]})]});try{ne.displayName="DownloadLoginModal",ne.__docgenInfo={description:"",displayName:"DownloadLoginModal",props:{showModal:{defaultValue:null,description:"",name:"showModal",required:!1,type:{name:"boolean"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/DownloadLoginModal.tsx#DownloadLoginModal"]={docgenInfo:ne.__docgenInfo,name:"DownloadLoginModal",path:"src/lib/containers/table/table-top/DownloadLoginModal.tsx#DownloadLoginModal"})}catch{}const je=window.React.useMemo,Hn=window.React.useState;function oe({queryBundleRequest:p,queryResultBundle:t,onHide:a}){const[o,l]=Hn("");Ht(()=>{(async()=>{const{query:b}=p,{sql:f,selectedFacets:v=[]}=b,{columnModels:c}=t;c||console.error("Column Models must be included to complete transform sql request");const g={concreteType:"org.sagebionetworks.repo.model.table.TransformSqlWithFacetsRequest",sqlToTransform:f,selectedFacets:v,schema:c};try{const I=await Tt(g),_=I.transformedSql.toUpperCase().indexOf("FROM SYN"),m=`SELECT * ${I.transformedSql.substring(_)}`;l(m)}catch(I){console.error("Error on getTransformSqlWithFacetsRequest ",I)}})()},[p,t]);const d=je(()=>o.replace(/(["`])/g,"\\$1"),[o]),i=je(()=>o.replace(/"/g,'\\"'),[o]);return n(Ut,{show:!0,onClose:a,title:"Download Programmatically",cliNotes:n(k,{children:"This command line code will download Synapse files AND file annotations to your working directory."}),cliCode:`synapse get -q "${d}"`,rNotes:R(k,{children:["This R code will download file annotations only. Use"," ",R("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:["synGet","()"]})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),rCode:`query <- synTableQuery("${i}")
read.table(query$filepath, sep = ",")`,pythonNotes:R(k,{children:["This Python code will download file annotations only. Use"," ",n("a",{target:"_blank",rel:"noopener noreferrer",href:"https://help.synapse.org/docs/Get-Started-with-Downloading-Data.2004254837.html#GetStartedwithDownloadingData-DownloadingFiles",children:"syn.get"})," ","to loop over the list of Synapse IDs from the file annotations to download files."]}),pythonCode:`query = syn.tableQuery("${i}")
query.asDataFrame()`})}try{oe.displayName="ProgrammaticOptions",oe.__docgenInfo={description:"",displayName:"ProgrammaticOptions",props:{queryBundleRequest:{defaultValue:null,description:"",name:"queryBundleRequest",required:!0,type:{name:"QueryBundleRequest"}},queryResultBundle:{defaultValue:null,description:"",name:"queryResultBundle",required:!0,type:{name:"QueryResultBundle"}},onHide:{defaultValue:null,description:"",name:"onHide",required:!0,type:{name:"() => void"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/ProgrammaticTableDownload.tsx#ProgrammaticOptions"]={docgenInfo:oe.__docgenInfo,name:"ProgrammaticOptions",path:"src/lib/containers/table/table-top/ProgrammaticTableDownload.tsx#ProgrammaticOptions"})}catch{}const te=window.React,Un="Add To Download Cart",Gn="download",ae=p=>{const{accessToken:t}=Y(),{entity:a,data:o,getLastQueryRequest:l}=H(),d=l(),[i,h]=te.useState(!1),[b,f]=te.useState(!1),[v,c]=te.useState(!1),{onDownloadFiles:g,darkTheme:I=!0}=p,_=a&&(U(a)&&Pt(a)||W(a)),m=a&&W(a)&&a.isLatestVersion;return R(te.Fragment,{children:[R(M,{as:"span",children:[n(be,{idForToolTip:Gn,tooltipText:"Download Options",size:"lg",darkTheme:I,icon:"download"}),R(M.Menu,{className:"SRC-primary-color-hover-dropdown",alignRight:!0,children:[n(M.Item,{onClick:()=>{f(!0)},children:"Export Table"}),_&&n(Ne,{title:"A draft version of a dataset cannot be added to the Download Cart",placement:"left",enterNextDelay:300,disableHoverListener:!m,children:n(M.Item,{className:m?"ignoreLink":void 0,disabled:m,style:m?{pointerEvents:"auto"}:{},onClick:()=>t?g():h(!0),children:Un})}),n(Ne,{title:"A draft version of a dataset cannot be downloaded programmatically",placement:"left",enterNextDelay:300,disableHoverListener:!m,children:n(M.Item,{className:m?"ignoreLink":void 0,disabled:m,style:m?{pointerEvents:"auto"}:{},onClick:()=>c(!0),children:"Programmatic Options"})})]})]}),i&&n(ne,{showModal:i,onHide:()=>h(!1)}),b&&n(G,{onClose:()=>f(!1),queryBundleRequest:d}),v&&o&&n(oe,{onHide:()=>c(!1),queryBundleRequest:d,queryResultBundle:o})]})};try{ae.displayName="DownloadOptions",ae.__docgenInfo={description:"",displayName:"DownloadOptions",props:{onDownloadFiles:{defaultValue:null,description:"",name:"onDownloadFiles",required:!0,type:{name:"() => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/DownloadOptions.tsx#DownloadOptions"]={docgenInfo:ae.__docgenInfo,name:"DownloadOptions",path:"src/lib/containers/table/table-top/DownloadOptions.tsx#DownloadOptions"})}catch{}const Wn=window.React.useState,Xe="addAndRemoveColumns",re=p=>{const{headers:t,isColumnSelected:a,toggleColumnSelection:o,darkTheme:l,facetAliases:d}=p,[i,h]=Wn(!1),b=(f,v,c)=>{c.source==="rootClose"?h(!1):h(!0)};return R(M,{as:"span",onToggle:(f,v,c)=>b(f,v,c),show:i,drop:"down",children:[n(be,{idForToolTip:Xe,tooltipText:"Show/Hide Columns",icon:l?"columnsdark":"columns",darkTheme:l}),n(M.Menu,{id:`${Xe}-dropdown`,className:"SRC-primary-color-hover-dropdown",alignRight:!0,children:t==null?void 0:t.map(f=>{const{name:v}=f,c=a.includes(v),g={width:"11px",marginRight:"10px",visibility:c?void 0:"hidden"},I=c?"SRC-primary-text-color":"";return R(M.Item,{onClick:()=>o(v),children:[n("span",{className:I,style:g,children:n(B,{options:{icon:"check",size:"14px"}})}),$e(v,d)]},v)})})]})};try{re.displayName="ColumnSelection",re.__docgenInfo={description:"",displayName:"ColumnSelection",props:{headers:{defaultValue:null,description:"",name:"headers",required:!1,type:{name:"SelectColumn[]"}},isColumnSelected:{defaultValue:null,description:"",name:"isColumnSelected",required:!0,type:{name:"string[]"}},show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!1,type:{name:"(() => void)"}},toggleColumnSelection:{defaultValue:null,description:"",name:"toggleColumnSelection",required:!0,type:{name:"(name: string) => void"}},darkTheme:{defaultValue:null,description:"",name:"darkTheme",required:!1,type:{name:"boolean"}},facetAliases:{defaultValue:null,description:"",name:"facetAliases",required:!1,type:{name:"Record<string, string>"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/table-top/ColumnSelection.tsx#ColumnSelection"]={docgenInfo:re.__docgenInfo,name:"ColumnSelection",path:"src/lib/containers/table/table-top/ColumnSelection.tsx#ColumnSelection"})}catch{}const Yn="Files may be unavailable because you do not have permission to see them, they have been deleted, or the Dataset has been misconfigured.",Kn="Files may be unavailable because you do not have permission to see them or the Dataset was misconfigured.",se=({entity:p})=>{var l,d;const t=p&&W(p),a={concreteType:"org.sagebionetworks.repo.model.table.QueryBundleRequest",query:{sql:`SELECT * FROM ${p.id}${!p.isLatestVersion&&p.versionNumber?`.${p.versionNumber}`:""}`},entityId:p.id,partMask:It},{data:o}=_t(a,{enabled:t});if(t&&o&&p){const i=o.queryCount,h=(d=(l=p.items)==null?void 0:l.length)!=null?d:0;if(i===h)return n(k,{});const b=h-i;let f="";return p.isLatestVersion?f=Yn:f=Kn,R(Ce,{className:"SRC-centerContent",style:{marginLeft:10},variant:"smallText1",color:"textSecondary",children:[n(bn,{className:"SRC-color-warning",style:{fontSize:"16px"}}),b.toLocaleString()+" Unavailable",n(Pe,{className:"SRC-margin-left-5",markdownText:f,placement:"right"})]})}else return n(k,{})};try{se.displayName="MissingQueryResultsWarning",se.__docgenInfo={description:`If possible, this component will render a warning message if results may be missing from the query due to user permissions or
entities being deleted. If not possible, it will render an empty fragment.`,displayName:"MissingQueryResultsWarning",props:{entity:{defaultValue:null,description:"",name:"entity",required:!0,type:{name:"Table"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/MissingQueryResultsWarning.tsx#MissingQueryResultsWarning"]={docgenInfo:se.__docgenInfo,name:"MissingQueryResultsWarning",path:"src/lib/containers/MissingQueryResultsWarning.tsx#MissingQueryResultsWarning"})}catch{}const jn=window.React,Xn=[{icon:"search",key:"showSearchBar",tooltipText:"Show / Hide Search Bar"},{icon:"chart",key:"showFacetVisualization",tooltipText:"Show / Hide Visualizations"},{icon:"download",key:"showDownloadConfirmation",tooltipText:"Show options for download"},{icon:Rt,key:"showSqlEditor",tooltipText:"Show / Hide the Advanced Query Editor"}],qe=p=>{const{name:t,showColumnSelection:a=!1,hideDownload:o=!1,hideVisualizationsControl:l=!1,hideFacetFilterControl:d=!1,hideQueryCount:i=!1,hideSqlEditorControl:h=!0,customControls:b}=p,{data:f,entity:v,executeQueryRequest:c,getLastQueryRequest:g,getInitQueryRequest:I}=H(),{topLevelControlsState:_,setTopLevelControlsState:m,columnsToShowInTable:T,selectedRowIndices:s,facetAliases:q,setColumnsToShowInTable:r}=ye(),e=w=>{const C={[w]:!_[w]};w==="showSearchBar"&&(C.showDownloadConfirmation=!1),w==="showDownloadConfirmation"&&(C.showSearchBar=!1),m(E=>({...E,...C}))},u=()=>{c(g())},y=w=>{let C=j(T);C.includes(w)?C=C.filter(E=>E!==w):C.push(w),r(C)},S=_==null?void 0:_.showFacetFilter;return n("div",{className:`TopLevelControls ${S?ge:Se}`,"data-testid":"TopLevelControls",children:R("div",{children:[R("div",{className:"TopLevelControls__querycount",children:[t&&R(k,{children:[R(Ce,{variant:"sectionTitle",role:"heading",children:[t," ",!i&&n(Gt,{sql:I().query.sql,parens:!0})]}),!i&&v&&n(se,{entity:v})]}),!d&&R("a",{onClick:()=>e("showFacetFilter"),className:"TopLevelControls__querycount__facetFilterLink SRC-no-underline-on-hover",children:[n(ot,{type:_.showFacetFilter?"close":"filter"}),R("span",{className:"TopLevelControls__querycount__facetFilterLink__text",children:[_.showFacetFilter?"Hide":"Show"," ","filters"]})]})]}),R("div",{className:"TopLevelControls__actions",children:[b&&b.map(w=>{var C;return R("button",{className:`btn SRC-roundBorder SRC-primary-background-color SRC-whiteText ${(C=w.classNames)!=null?C:""}`,style:{marginRight:"5px"},type:"button",onClick:()=>w.onClick({data:f,selectedRowIndices:s,refresh:u}),children:[w.icon,"\xA0",w.buttonText]},w.buttonText)}),Xn.map(w=>{const{key:C,icon:E,tooltipText:x}=w;return C==="showDownloadConfirmation"&&o||C==="showFacetVisualization"&&l||C==="showSqlEditor"&&h?n(jn.Fragment,{},C):C==="showDownloadConfirmation"?n(ae,{darkTheme:!0,onDownloadFiles:()=>e(C)},C):n(be,{idForToolTip:C,tooltipText:x,callbackFn:()=>e(C),darkTheme:!0,icon:E},C)}),a&&n(re,{headers:f==null?void 0:f.selectColumns,isColumnSelected:T,toggleColumnSelection:y,darkTheme:!0,facetAliases:q})]})]})})};try{qe.displayName="TopLevelControls",qe.__docgenInfo={description:"",displayName:"TopLevelControls",props:{name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},hideVisualizationsControl:{defaultValue:null,description:"",name:"hideVisualizationsControl",required:!1,type:{name:"boolean"}},hideFacetFilterControl:{defaultValue:null,description:"",name:"hideFacetFilterControl",required:!1,type:{name:"boolean"}},hideQueryCount:{defaultValue:null,description:"",name:"hideQueryCount",required:!1,type:{name:"boolean"}},hideSqlEditorControl:{defaultValue:null,description:"",name:"hideSqlEditorControl",required:!1,type:{name:"boolean"}},showColumnSelection:{defaultValue:null,description:"",name:"showColumnSelection",required:!1,type:{name:"boolean"}},customControls:{defaultValue:null,description:"",name:"customControls",required:!1,type:{name:"CustomControl[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/TopLevelControls.tsx#TopLevelControls"]={docgenInfo:qe.__docgenInfo,name:"TopLevelControls",path:"src/lib/containers/table/TopLevelControls.tsx#TopLevelControls"})}catch{}var st={exports:{}};(function(p,t){(function(o,l){p.exports=l()})(Wt,function(){return(()=>{var a={67:(d,i,h)=>{h.r(i),h.d(i,{default:()=>_});var b=h(887),f=h.n(b);function v(m,T){if(!(m instanceof T))throw new TypeError("Cannot call a class as a function")}function c(m,T,s){return T in m?Object.defineProperty(m,T,{value:s,enumerable:!0,configurable:!0,writable:!0}):m[T]=s,m}var g,I=(g=0,function(){return g++}),_=function m(T){var s=this,q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};v(this,m),c(this,"ID","id"),c(this,"PX","px"),c(this,"RESIZABLE","grip-resizable"),c(this,"FLEX","grip-flex"),c(this,"legacyIE",navigator.userAgent.indexOf("Trident/4.0")>0),c(this,"reset",function(r){return s.init(r)}),c(this,"onResize",function(){var r=s.tb;if(r.classList.remove(s.RESIZABLE),r.opt.fixed){r.tableWidth=Number(window.getComputedStyle(r).width.replace(/px/,"")).valueOf();for(var e=0,u=0;u<r.columnCnt;u++)e+=r.columns[u].w;for(var y=0;y<r.columnCnt;y++)r.columns[y].style.width=Math.round(1e3*r.columns[y].w/e)/10+"%",r.columns[y].locked=!0}else s.applyBounds(),r.opt.resizeMode==="flex"&&r.opt.serialize&&s.serializeStore();r.classList.add(s.RESIZABLE),s.syncGrips()}),c(this,"onGripMouseDown",function(r){var e=r.target.parentNode.data,u=s.tb,y=u.grips[e.i],S=r.touches;if(y.ox=S?S[0].pageX:r.pageX,y.l=y.offsetLeft,y.x=y.l,s.createStyle(document.querySelector("head"),"*{cursor:"+u.opt.dragCursor+"!important}"),document.addEventListener("touchmove",s.onGripDrag),document.addEventListener("mousemove",s.onGripDrag),document.addEventListener("touchend",s.onGripDragOver),document.addEventListener("mouseup",s.onGripDragOver),y.classList.add(u.opt.draggingClass),s.grip=y,u.columns[e.i].locked)for(var w,C=0;C<u.columnCnt;C++)(w=u.columns[C]).locked=!1,w.w=Number(window.getComputedStyle(w).width.replace(/px/,"")).valueOf();r.preventDefault()}),c(this,"onGripDrag",function(r){var e=s.grip;if(e){var u=e.t,y=r.touches,S=(y?y[0].pageX:r.pageX)-e.ox+e.l,w=u.opt.minWidth,C=e.i,E=1.5*u.cellSpace+w+u.borderSpace,x=C===u.columnCnt-1,A=C?u.grips[C-1].offsetLeft+u.cellSpace+w:E,N=u.opt.fixed?C===u.columnCnt-1?u.tableWidth-E:u.grips[C+1].offsetLeft-u.cellSpace-w:1/0;if(S=Math.max(A,Math.min(N,S)),e.x=S,e.style.left=S+s.PX,x&&(e.w=u.columns[C].w+S-e.l),u.opt.liveDrag){x?(u.columns[C].style.width=e.w+s.PX,!u.opt.fixed&&u.opt.overflow?u.style.minWidth=u.tableWidth+S-e.l+s.PX:u.tableWidth=Number(window.getComputedStyle(u).width.replace(/px/,"")).valueOf()):s.syncCols(u,C,!1,u.opt),s.syncGrips();var D=u.opt.onDrag;D&&D(r)}r.preventDefault()}}),c(this,"onGripDragOver",function(r){var e=s.grip;document.removeEventListener("touchend",s.onGripDragOver),document.removeEventListener("mouseup",s.onGripDragOver),document.removeEventListener("touchmove",s.onGripDrag),document.removeEventListener("mousemove",s.onGripDrag);var u=document.querySelector("head").lastChild;if(u.parentNode.removeChild(u),e){if(e.classList.remove(e.t.opt.draggingClass),e.x-e.l!=0){var y=e.t,S=y.opt.onResize,w=e.i;if(w===y.columnCnt-1){var C=y.columns[w];C.style.width=e.w+s.PX,C.w=e.w}else s.syncCols(y,w,!0,y.opt);y.opt.fixed||s.applyBounds(),s.syncGrips(),S&&S(r),y.opt.serialize&&s.serializeStore()}s.grip=null}}),c(this,"init",function(r){if(r.disable)return s.destroy();var e=s.tb,u=e.getAttribute(s.ID)||s.RESIZABLE+I();if(!e.matches("table")||e.extended&&!r.partialRefresh)return null;var y=document.querySelector("head");if(s.createStyle(y," .grip-resizable{table-layout:fixed;} .grip-resizable > tbody > tr > td, .grip-resizable > tbody > tr > th{overflow:hidden} .grip-padding > tbody > tr > td, .grip-padding > tbody > tr > th{padding-left:0!important; padding-right:0!important;} .grip-container{ height:0px; position:relative;} .grip-handle{margin-left:-5px; position:absolute; z-index:5; } .grip-handle .grip-resizable{position:absolute;background-color:red;filter:alpha(opacity=1);opacity:0;width:10px;height:100%;cursor: col-resize;top:0px} .grip-lastgrip{position:absolute; width:1px; } .grip-drag{ border-left:1px dotted black;	} .grip-flex{width:auto!important;} .grip-handle.grip-disabledgrip .grip-resizable{cursor:default; display:none;}"),r.hoverCursor&&r.hoverCursor!=="col-resize"){var S=".grip-handle .grip-resizable:hover{cursor:"+r.hoverCursor+"!important}";s.createStyle(y,S)}e.setAttribute(s.ID,u);var w=e.opt;e.opt=s.extendOptions(r);var C=s.getTableHeaders(e);if(s.extendTable(C),r.remoteTable&&r.remoteTable.matches("table")){var E=s.getTableHeaders(e.opt.remoteTable);C.length===E.length?s.extendRemoteTable(e.opt.remoteTable,E,e):console.warn("column count for remote table did not match")}return w}),c(this,"applyBounds",function(){var r=s.tb,e=r.columns.map(function(u){return window.getComputedStyle(u).width});r.style.width=window.getComputedStyle(r).width,r.tableWidth=Number(r.style.width.replace(/px/,"")).valueOf(),r.classList.remove(s.FLEX),r.columns.forEach(function(u,y){u.style.width=e[y],u.w=Number(e[y].replace(/px/,"")).valueOf()}),r.classList.add(s.FLEX)}),c(this,"serializeStore",function(){var r=s.store,e=s.tb;r[e.getAttribute(s.ID)]="";for(var u=0,y=0;y<e.columns.length;y++){var S=window.getComputedStyle(e.columns[y]).width.replace(/px/,"");r[e.getAttribute(s.ID)]+=S+";",u+=Number(S).valueOf()}r[e.getAttribute(s.ID)]+=u.toString(),e.opt.fixed||(r[e.getAttribute(s.ID)]+=";"+window.getComputedStyle(e).width.replace(/px/,""))}),c(this,"syncGrips",function(){var r=s.tb;r.gripContainer.style.width=r.tableWidth+s.PX;for(var e=0;e<r.columnCnt;e++){var u=r.columns[e],y=u.getBoundingClientRect(),S=r.getBoundingClientRect();r.grips[e].style.left=y.left-S.left+u.offsetWidth+r.cellSpace/2+s.PX,r.grips[e].style.height=(r.opt.headerOnly?r.columns[0].offsetHeight:r.offsetHeight)+s.PX}}),c(this,"destroy",function(){var r=s.tb,e=r.getAttribute(s.ID);return e?(s.store[e]="",r.classList.remove(s.RESIZABLE),r.classList.remove(s.FLEX),r.remote&&(r.remote.classList.remove(s.RESIZABLE),r.remote.classList.remove(s.FLEX)),r.gripContainer&&r.gripContainer.parentNode&&r.gripContainer.parentNode.removeChild(r.gripContainer),delete r.extended,r.opt):null}),c(this,"createStyle",function(r,e){var u=f()(e).toString(),y=r.querySelectorAll("style");if(!Array.from(y).filter(function(w){return w.gripid===u}).length){var S=document.createElement("style");S.type="text/css",S.gripid=u,S.styleSheet?S.styleSheet.cssText=e:S.appendChild(document.createTextNode(e)),r.appendChild(S)}}),c(this,"extendOptions",function(r){var e=Object.assign({},m.DEFAULTS,r);switch(e.fixed=!0,e.overflow=!1,e.resizeMode){case"flex":e.fixed=!1;break;case"overflow":e.fixed=!1,e.overflow=!0}return e}),c(this,"getTableHeaders",function(r){var e="#"+r.id,u=Array.from(r.querySelectorAll(e+">thead>tr:nth-of-type(1)>th"));return(u=u.concat(Array.from(r.querySelectorAll(e+">thead>tr:nth-of-type(1)>td")))).length||(u=(u=(u=(u=Array.from(r.querySelectorAll(e+">tbody>tr:nth-of-type(1)>th"))).concat(Array.from(r.querySelectorAll(e+">tr:nth-of-type(1)>th")))).concat(Array.from(r.querySelectorAll(e+">tbody>tr:nth-of-type(1)>td")))).concat(Array.from(r.querySelectorAll(e+">tr:nth-of-type(1)>td")))),s.filterInvisible(u,!1)}),c(this,"filterInvisible",function(r,e){return r.filter(function(u){var y=e?-1:u.offsetWidth,S=e?-1:u.offsetHeight;return!(y===0&&S===0||u.style&&u.style.display&&window.getComputedStyle(u).display==="none")})}),c(this,"extendTable",function(r){var e=s.tb;e.opt.removePadding&&e.classList.add("grip-padding"),e.classList.add(s.RESIZABLE),e.insertAdjacentHTML("beforebegin",'<div class="grip-container"/>'),e.grips=[],e.columns=[],e.tableWidth=Number(window.getComputedStyle(e).width.replace(/px/,"")).valueOf(),e.gripContainer=e.previousElementSibling,e.opt.marginLeft&&(e.gripContainer.style.marginLeft=e.opt.marginLeft),e.opt.marginRight&&(e.gripContainer.style.marginRight=e.opt.marginRight),e.cellSpace=parseInt(s.legacyIE?e.cellSpacing||e.currentStyle.borderSpacing:window.getComputedStyle(e).borderSpacing.split(" ")[0].replace(/px/,""))||2,e.borderSpace=parseInt(s.legacyIE?e.border||e.currentStyle.borderLeftWidth:window.getComputedStyle(e).borderLeftWidth.replace(/px/,""))||1,e.extended=!0,s.createGrips(r)}),c(this,"extendRemoteTable",function(r,e,u){u.opt.removePadding&&r.classList.add("grip-padding"),r.classList.add(s.RESIZABLE),r.getAttribute(s.ID)||r.setAttribute(s.ID,u.getAttribute(s.ID)+"remote"),r.columns=[],e.forEach(function(S,w){var C=e[w];C.w=u.columns[w].w,C.style.width=C.w+s.PX,C.removeAttribute("width"),r.columns.push(C)}),r.tableWidth=u.tableWidth,r.cellSpace=u.cellSpace,r.borderSpace=u.borderSpace;var y=Array.from(r.querySelectorAll("col"));r.columnGrp=s.filterInvisible(y,!0),r.columnGrp.forEach(function(S,w){S.removeAttribute("width"),S.style.width=u.columnGrp[w].style.width}),u.remote=r}),c(this,"createGrips",function(r){var e=s.tb;e.columnGrp=s.filterInvisible(Array.from(e.querySelectorAll("col")),!0),e.columnGrp.forEach(function(S){S.removeAttribute("width")}),e.columnCnt=r.length;var u=!1;s.store[e.getAttribute(s.ID)]&&(s.deserializeStore(r),u=!0),e.opt.widths||(e.opt.widths=[]),r.forEach(function(S,w){var C=r[w],E=e.opt.disabledColumns.indexOf(w)!==-1;s.createDiv(e.gripContainer,"grip-handle");var x=e.gripContainer.lastChild;!E&&e.opt.gripInnerHtml&&(x.innerHTML=e.opt.gripInnerHtml),s.createDiv(x,s.RESIZABLE),w===e.columnCnt-1&&(x.classList.add("grip-lastgrip"),e.opt.fixed&&(x.innerHTML="")),x.addEventListener("touchstart",s.onGripMouseDown,{capture:!0,passive:!0}),x.addEventListener("mousedown",s.onGripMouseDown,!0),E?x.classList.add("grip-disabledgrip"):(x.classList.remove("grip-disabledgrip"),x.addEventListener("touchstart",s.onGripMouseDown,{capture:!0,passive:!0}),x.addEventListener("mousedown",s.onGripMouseDown,!0)),x.t=e,x.i=w,e.opt.widths[w]?C.w=e.opt.widths[w]:C.w=u?Number(C.style.width.replace(/px/,"")).valueOf():Number(window.getComputedStyle(C).width.replace(/px/,"")).valueOf(),C.style.width=C.w+s.PX,C.removeAttribute("width"),x.data={i:w,t:e.getAttribute(s.ID),last:w===e.columnCnt-1},e.grips.push(x),e.columns.push(C)});var y=Array.from(e.querySelectorAll("td"));y.concat(Array.from(e.querySelectorAll("th"))),(y=(y=y.filter(function(S){for(var w=0;w<r.length;w++)if(r[w]===S)return!1;return!0})).filter(function(S){return!(S.querySelectorAll("table th").length||S.querySelectorAll("table td").length)})).forEach(function(S){S.removeAttribute("width")}),e.opt.fixed||(e.removeAttribute("width"),e.classList.add(s.FLEX)),s.syncGrips()}),c(this,"deserializeStore",function(r){var e=s.tb;if(e.columnGrp.forEach(function(w){w.removeAttribute("width")}),e.opt.flush)s.store[e.getAttribute(s.ID)]="";else{var u=s.store[e.getAttribute(s.ID)].split(";"),y=u[e.columnCnt+1];!e.opt.fixed&&y&&(e.style.width=y+s.PX,e.opt.overflow&&(e.style.minWidth=y+s.PX,e.tableWidth=Number(y).valueOf()));for(var S=0;S<e.columnCnt;S++)r[S].style.width=u[S]+s.PX,e.columnGrp[S]&&(e.columnGrp[S].style.width=100*Number(u[S]).valueOf()/Number(u[e.columnCnt]).valueOf()+"%")}}),c(this,"createDiv",function(r,e,u){var y=document.createElement("div");y.classList.add(e),u&&(y.innerHTML=u),r.appendChild(y)}),c(this,"syncCols",function(r,e,u,y){var S=r.remote,w=s.grip.x-s.grip.l,C=r.columns[e],E=r.columns[e+1];if(C&&E){var x=C.w+w,A=E.w-w,N=x+s.PX;if(C.style.width=N,r.columnGrp[e]&&r.columnGrp[e].style.width&&(r.columnGrp[e].style.width=N),S&&(S.columns[e].style.width=N,S.columnGrp[e]&&S.columnGrp[e].style.width&&(S.columnGrp[e].style.width=N)),y.fixed){var D=A+s.PX;E.style.width=D,r.columnGrp[e+1]&&r.columnGrp[e+1].style.width&&(r.columnGrp[e+1].style.width=D),S&&(S.columns[e+1].style.width=D,S.columnGrp[e+1]&&S.columnGrp[e+1].style.width&&(S.columnGrp[e+1].style.width=D))}else y.overflow&&(r.style.minWidth=r.tableWidth+w+s.PX);u&&(C.w=x,E.w=y.fixed?A:E.w,S&&(S.columns[e].w=x,S.columns[e+1].w=y.fixed?A:E.w))}});try{this.store=sessionStorage}catch{this.store={}}this.grip=null,this.tb=T,window.addEventListener("resize",this.onResize),Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),this.init(q)};_.DEFAULTS={resizeMode:"fit",draggingClass:"grip-drag",gripInnerHtml:"",liveDrag:!1,minWidth:15,headerOnly:!1,hoverCursor:"col-resize",dragCursor:"col-resize",flush:!1,marginLeft:null,marginRight:null,remoteTable:null,disable:!1,partialRefresh:!1,disabledColumns:[],removePadding:!0,widths:[],serialize:!0,onDrag:null,onResize:null}},887:d=>{d.exports=function(h){for(var b=5381,f=h.length;f;)b=33*b^h.charCodeAt(--f);return b>>>0}}},o={};function l(d){if(o[d])return o[d].exports;var i=o[d]={exports:{}};return a[d](i,i.exports,l),i.exports}return l.n=d=>{var i=d&&d.__esModule?()=>d.default:()=>d;return l.d(i,{a:i}),i},l.d=(d,i)=>{for(var h in i)l.o(i,h)&&!l.o(d,h)&&Object.defineProperty(d,h,{enumerable:!0,get:i[h]})},l.o=(d,i)=>Object.prototype.hasOwnProperty.call(d,i),l.r=d=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(d,"__esModule",{value:!0})},l(67)})()})})(st);const Zn=Yt(st.exports),ie=p=>{const{entityId:t,entityVersionNumber:a}=p,{accessToken:o}=Y(),l=Et();return o?n(k,{children:n(Ne,{title:"Add this file to your Download Cart",placement:"right",enterNextDelay:300,children:n("a",{"data-testid":"AddToDownloadListV2",onClick:async()=>{try{await Lt(t,a,o),l.invalidateQueries(["downloadliststatsv2"]);const i=await xt(o,t,a?a==null?void 0:a.toString():void 0);pe(`${i.name} was successfully added to your Download Cart.`,"success")}catch(i){pe(`Unable to add the file to your Download Cart. ${i}`,"danger")}},className:"ignoreLink",children:n(B,{options:{icon:"addToCart"}})})})}):n(k,{})};try{ie.displayName="AddToDownloadListV2",ie.__docgenInfo={description:"",displayName:"AddToDownloadListV2",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},entityVersionNumber:{defaultValue:null,description:"",name:"entityVersionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/AddToDownloadListV2.tsx#AddToDownloadListV2"]={docgenInfo:ie.__docgenInfo,name:"AddToDownloadListV2",path:"src/lib/containers/AddToDownloadListV2.tsx#AddToDownloadListV2"})}catch{}const Jn=window.React.useEffect,eo=window.React.useState,le=p=>{const{accessToken:t}=Y(),{entityIdList:a}=p,[o,l]=eo([n(k,{})]),{ref:d,inView:i}=Me();let h=!0;Jn(()=>(i&&b(),()=>{h=!1}),[a,i]);const b=()=>{!a.length||qt(a,t).then(f=>{if(h){const v=f.results.map(c=>n("p",{children:n(Ae,{entity:c,displayTextField:"name"})},c.id));l(v)}}).catch(f=>{console.log("EntityIdList: Error getting entity headers",f)})};return n("span",{ref:d,children:o})};try{le.displayName="EntityIdList",le.__docgenInfo={description:"",displayName:"EntityIdList",props:{entityIdList:{defaultValue:null,description:"",name:"entityIdList",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/EntityIdList.tsx#EntityIdList"]={docgenInfo:le.__docgenInfo,name:"EntityIdList",path:"src/lib/containers/EntityIdList.tsx#EntityIdList"})}catch{}const to=window.React.useEffect,no=window.React.useState,de=p=>{const{accessToken:t}=Y(),{evaluationId:a}=p,[o,l]=no(),{ref:d,inView:i}=Me();let h=!0;to(()=>(h&&i&&b(),()=>{h=!1}),[a,i]);const b=()=>{!a||Dt(a,t).then(f=>{l(f.name)}).catch(f=>{console.log("EvaluationIdListRenderer: Error getting evaluation queue names",f)})};return n("span",{ref:d,children:o})};try{de.displayName="EvaluationIdRenderer",de.__docgenInfo={description:"",displayName:"EvaluationIdRenderer",props:{evaluationId:{defaultValue:null,description:"",name:"evaluationId",required:!0,type:{name:"string"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/EvaluationIdRenderer.tsx#EvaluationIdRenderer"]={docgenInfo:de.__docgenInfo,name:"EvaluationIdRenderer",path:"src/lib/containers/EvaluationIdRenderer.tsx#EvaluationIdRenderer"})}catch{}const oo=window.React.useEffect,ao=window.React.useState,ce=p=>{const{accessToken:t}=Y(),{userIds:a}=p,[o,l]=ao(),{ref:d,inView:i}=Me();let h=!0;oo(()=>(h&&i&&b(),()=>{h=!1}),[a,i]);const b=()=>{!a.length||Nt(a,t).then(f=>{const v=f.list.map(c=>n(jt,{userProfile:c,className:"SRC-marginFifteen"},c.ownerId));l(v)}).catch(f=>{console.log("UserIdList: Error getting user profiles",f)})};return n("span",{ref:d,children:o})};try{ce.displayName="UserIdList",ce.__docgenInfo={description:"",displayName:"UserIdList",props:{userIds:{defaultValue:null,description:"",name:"userIds",required:!0,type:{name:"string[]"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/UserIdList.tsx#UserIdList"]={docgenInfo:ce.__docgenInfo,name:"UserIdList",path:"src/lib/containers/UserIdList.tsx#UserIdList"})}catch{}const ue=({columnType:p,columnValue:t,isBold:a,mapEntityIdToHeader:o,mapUserIdToHeader:l,columnLinkConfig:d,rowIndex:i,columnName:h,selectColumns:b,columnModels:f,rowData:v,rowId:c,rowVersionNumber:g})=>{const{entity:I}=H(),_=(m,T=20)=>!m||m.length<=T;if(!t)return R("p",{className:"SRC-center-text SRC-inactive",children:[" ",pn]});if(d)return n(dn,{value:t,columnName:h,selectColumns:b,columnModels:f,isHeader:!1,labelLink:d,rowData:v});if(I&&(U(I)||W(I)||nt(I))&&(h==="id"||h==="name")&&c&&g){const m=`syn${c.toString()}`;if(Object.prototype.hasOwnProperty.call(o,m))return n("p",{children:n(Ae,{entity:o[m],versionNumber:g,className:`${a}`,showIcon:!1,displayTextField:h})})}switch(p){case L.ENTITYID:if(Object.prototype.hasOwnProperty.call(o,t))return n("p",{children:n(Ae,{entity:o[t],className:`${a}`,displayTextField:"name"})});break;case L.DATE_LIST:{const m=JSON.parse(t);return R("p",{children:[m.map((T,s)=>R("span",{className:a,children:[new Date(T).toLocaleString(),s!==m.length-1?", ":""]},s))," "]})}case L.BOOLEAN_LIST:{const m=JSON.parse(t);return n("p",{children:m.map((T,s)=>R("span",{className:a,children:[T?"true":"false",s!==m.length-1?", ":""]},s))})}case L.FILEHANDLEID:return n(k,{children:I&&n(at,{associatedObjectId:I.id,associatedObjectType:Ot.TableEntity,fileHandleId:t,displayFileName:!0})});case L.ENTITYID_LIST:{const m=JSON.parse(t);return n(le,{entityIdList:m})}case L.USERID_LIST:{const m=JSON.parse(t);return n(ce,{userIds:m})}case L.STRING_LIST:case L.INTEGER_LIST:{const m=JSON.parse(t);return n("p",{children:m.map((T,s)=>R("span",{className:a,children:[T,s!==m.length-1?", ":""]},T))})}case L.EVALUATIONID:return n(de,{evaluationId:t});case L.DATE:return n("p",{className:a,children:new Date(Number(t)).toLocaleString()});case L.USERID:if(Object.prototype.hasOwnProperty.call(l,t)){const{ownerId:m,userName:T}=l[t];if(l[t].isIndividual===!1){const s=T===Qe?"public":"people";return T===Qe?R("span",{children:[n(B,{options:{icon:s}})," All registered Synapse users"]}):R("a",{target:"_blank",rel:"noopener noreferrer",href:`${Oe.PORTAL}#!Team:${m}`,children:[n(B,{options:{icon:s}})," ",T]})}else return n(Xt,{userProfile:l[t],preSignedURL:l[t].clientPreSignedURL,size:"SMALL USER CARD"})}break;case L.LINK:return n("a",{target:"_blank",rel:"noopener noreferrer",href:t,children:t});case L.STRING:case L.DOUBLE:case L.INTEGER:case L.BOOLEAN:case L.LARGETEXT:return _(t)?R("p",{className:a,children:[" ",t]}):n("div",{className:a,children:n(be,{tooltipText:t,callbackFn:hn,idForToolTip:`${h}_${i}`,children:R("p",{className:a,children:[" ",t]})})});default:return console.warn(`ColumnType ${p} has unspecified handler. Rendering the column value.`),n("p",{className:a,children:t})}return n("p",{className:a,children:t})};try{ue.displayName="SynapseTableCell",ue.__docgenInfo={description:"",displayName:"SynapseTableCell",props:{columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'}]}},columnValue:{defaultValue:null,description:"",name:"columnValue",required:!0,type:{name:"string"}},isBold:{defaultValue:null,description:"",name:"isBold",required:!0,type:{name:"string"}},columnLinkConfig:{defaultValue:null,description:"",name:"columnLinkConfig",required:!1,type:{name:"CardLink | ColumnSpecifiedLink | MarkdownLink"}},mapEntityIdToHeader:{defaultValue:null,description:"",name:"mapEntityIdToHeader",required:!0,type:{name:"Record<string, EntityHeader>"}},mapUserIdToHeader:{defaultValue:null,description:"",name:"mapUserIdToHeader",required:!0,type:{name:"Partial<UserGroupHeader & UserProfile>"}},rowIndex:{defaultValue:null,description:"",name:"rowIndex",required:!1,type:{name:"number"}},columnName:{defaultValue:null,description:"",name:"columnName",required:!0,type:{name:"string"}},selectColumns:{defaultValue:null,description:"",name:"selectColumns",required:!1,type:{name:"SelectColumn[]"}},columnModels:{defaultValue:null,description:"",name:"columnModels",required:!1,type:{name:"ColumnModel[]"}},rowData:{defaultValue:null,description:"",name:"rowData",required:!0,type:{name:"(string | null)[]"}},rowId:{defaultValue:null,description:"",name:"rowId",required:!1,type:{name:"number"}},rowVersionNumber:{defaultValue:null,description:"",name:"rowVersionNumber",required:!1,type:{name:"number"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/synapse_table_functions/SynapseTableCell.tsx#SynapseTableCell"]={docgenInfo:ue.__docgenInfo,name:"SynapseTableCell",path:"src/lib/containers/synapse_table_functions/SynapseTableCell.tsx#SynapseTableCell"})}catch{}const it=window.SQLParser.lexer,Ze=(p,...t)=>{var o;const a=[];return(o=p==null?void 0:p.selectColumns)==null||o.forEach((l,d)=>{t.includes(l.columnType)&&a.push(d)}),a},Je=(p,t,a)=>{var l;const o=new Set;return(l=p.queryResult)==null||l.queryResults.rows.forEach(d=>{d.values.forEach((i,h)=>{a.includes(h)&&!Object.prototype.hasOwnProperty.call(t,i)&&i&&o.add(i)})}),o};function ro(p){const t=[];if(rn(p)){const a=it.tokenize(p),o=a.findIndex(i=>i[0]==="SELECT"),l=a.findIndex(i=>i[0]==="FROM");let d=0;for(let i=o+1;i<l-o-1;i+=1){const h=a[i];h[0]==="FUNCTION"&&h[1].toLowerCase()==="count"?t.push(d):h[0]==="SEPARATOR"&&(d+=1)}}return t}function so(p,t,a){let o=it.tokenize(t);const l=o.findIndex(c=>c[0]==="SELECT"),d=o.findIndex(c=>c[0]==="FROM"),i=[];let h=0,b=!1;for(let c=l+1;c<d-l-1;c+=1){const g=o[c];g[0]==="FUNCTION"||g[1].toLocaleLowerCase()==="concat"?b=!0:g[0]==="LITERAL"&&!b?i.push({index:h,name:g[1]}):g[0]==="SEPARATOR"&&(h+=1,b=!1)}if(o=o.slice(0,o.findIndex(c=>c[0]==="GROUP")),o.splice(l+1,d-l-1,["STAR","*","1"]),a===void 0)return{synId:"",newSql:""};o.findIndex(c=>c[0]==="WHERE")===-1?o.push(["WHERE","WHERE","1"]):o.push(["CONDITIONAL","AND","1"]),i.forEach((c,g)=>{const I=p.values[c.index];I?o.push(["LITERAL",c.name,"1"],["OPERATOR","=","1"],["STRING",I,"1"],["CONDITIONAL","AND","1"]):o.push(["LITERAL",c.name,"1"],["OPERATOR","IS","1"],["BOOLEAN","null","1"],["CONDITIONAL","AND","1"])}),o.pop();const v=o[o.findIndex(c=>c[0]==="FROM")+1][1];return o.push(["EOF","","1"]),{synId:v,newSql:sn(o)}}const io=()=>{const{data:p,goToPage:t,pageSize:a,setPageSize:o,currentPage:l}=mt(),d=p==null?void 0:p.queryCount,i=(b,f)=>{t(f)},h=b=>{const f=b.target.value;o(f)};return l==1&&d&&d<10?n(k,{}):R("div",{children:[n(xn,{page:l,count:Math.ceil(d/a),color:"secondary",onChange:i,style:{display:"inline-block",float:"left"}}),n(Ce,{variant:"body1",style:{display:"inline-block"},children:`${d==null?void 0:d.toLocaleString()} total rows /`}),R("select",{name:"page size",onChange:h,style:{padding:"4px",marginLeft:"4px"},value:a,children:[n("option",{value:10,children:"10 per page"}),n("option",{value:25,children:"25 per page"}),n("option",{value:100,children:"100 per page"}),n("option",{value:500,children:"500 per page"})]})]})},K=window.React,lo=()=>{const p=Y(),t=H(),[a,o]=K.useState(!1),[l,d]=K.useState(),[i,h]=K.useState();K.useEffect(()=>(i||h(new AbortController),()=>{i&&i.abort()}),[i]);const b=()=>{o(!0);const{getLastQueryRequest:f}=t,v=f(),{sql:c}=v.query,{entityId:g,versionNumber:I}=ln(c),_=I?`.${I}`:"";v.partMask=At,v.query={sql:`select id from ${g}${_}`},Ft(v,p.accessToken,i==null?void 0:i.signal).then(m=>{d(m)}).catch(m=>{console.error(m),pe("Unable to query for all Synapse IDs to copy","danger")}).finally(()=>{o(!1)})};return K.useEffect(()=>{if(l){const{rows:f}=l.queryResult.queryResults,v=f.map(c=>`${c.values[0]}`).join(`
`);navigator.clipboard.writeText(v).then(()=>{pe("Successfully copied to clipboard"),d(void 0)})}},[l]),a?n(tn,{size:25}):n(Jt,{onCopy:()=>{b()}})},et=window.React,co={id:"",name:"",type:"org.sagebionetworks.repo.model.FileEntity",versionNumber:-1,versionLabel:"",benefactorId:-1,createdBy:"",createdOn:"",modifiedBy:"",modifiedOn:"",isLatestVersion:!0},uo=["","DESC","ASC"],tt={resizeMode:"overflow",partialRefresh:"true",liveDrag:!0,headerOnly:"true"};class De extends et.Component{constructor(t){super(t),this.tableElement=void 0,this.showGroupRowData=a=>{const o=this.props.queryContext.getLastQueryRequest().query,l=so(a,o.sql,this.props.queryContext.data);o.sql=l.newSql;const d=JSON.stringify(o),i=btoa(d);return`${Oe.PORTAL}#!Synapse:${l.synId}/tables/query/${i}`},this.renderTable=(a,o,l,d)=>{var s,q;const i=(q=(s=this.props.queryContext).getLastQueryRequest)==null?void 0:q.call(s),{queryContext:{entity:h},showAccessColumn:b,showDownloadColumn:f,isRowSelectionVisible:v}=this.props,c=h&&(U(h)&&Bt(h)||W(h)),g=b&&h&&this.isEntityViewOrDataset()&&this.allRowsHaveId(),I=!!this.props.synapseContext.accessToken,_=h&&c&&I&&this.allRowsHaveId(),m=!!(_&&!this.props.hideDownload),T=_&&f;return R("div",{className:"SynapseTable SRC-overflowAuto","data-testid":"SynapseTable",children:[R("table",{ref:r=>this.tableElement=r,className:"table table-striped table-condensed",children:[n("thead",{className:"SRC_bordered",children:n("tr",{children:this.createTableHeader(a,o,l,g,T,m,v,i)})}),n("tbody",{children:this.createTableRows(d,a,g,T,m,v)})]}),n("div",{className:"bootstrap-4-backport",style:{textAlign:"right"},children:n(io,{})})]})},this.handleColumnSortPress=a=>o=>{let l=j(this.state.columnIconSortState);l.length===0&&(l=Array(this.getLengthOfPropsData()).fill(0));const d=j(this.state.sortedColumnSelection),i=this.findSelectionIndex(d,a.name);i!==-1&&d.splice(i,1),l[a.index]=(l[a.index]+1)%He.length,l[a.index]>0&&d.unshift({column:a.name,direction:uo[l[a.index]]});const h=this.props.queryContext.getLastQueryRequest();h.query.sort=d,h.query.offset=0,this.props.queryContext.executeQueryRequest(h),this.setState({columnIconSortState:l,sortedColumnSelection:d})},this.applyChangesFromQueryFilter=a=>{const o=this.props.queryContext.getLastQueryRequest();o.query.selectedFacets=a,o.query.offset=0,this.props.queryContext.executeQueryRequest(o)},this.componentDidMount=this.componentDidMount.bind(this),this.componentWillUnmount=this.componentWillUnmount.bind(this),this.componentDidUpdate=this.componentDidUpdate.bind(this),this.shouldComponentUpdate=this.shouldComponentUpdate.bind(this),this.handleColumnSortPress=this.handleColumnSortPress.bind(this),this.findSelectionIndex=this.findSelectionIndex.bind(this),this.advancedSearch=this.advancedSearch.bind(this),this.getLengthOfPropsData=this.getLengthOfPropsData.bind(this),this.configureFacetDropdown=this.configureFacetDropdown.bind(this),this.enableResize=this.enableResize.bind(this),this.disableResize=this.disableResize.bind(this),this.isEntityViewOrDataset=this.isEntityViewOrDataset.bind(this),this.allRowsHaveId=this.allRowsHaveId.bind(this),this.state={columnIconSortState:[],isExportTableDownloadOpen:!1,isExpanded:!1,isColumnSelectionOpen:!1,sortedColumnSelection:[],mapEntityIdToHeader:{},mapUserIdToHeader:{},isFetchingEntityHeaders:!1},this.getEntityHeadersInData=this.getEntityHeadersInData.bind(this)}componentWillUnmount(){this.disableResize()}componentDidMount(){this.getEntityHeadersInData(!0),this.enableResize()}shouldComponentUpdate(t,a){const{isFetchingEntityHeaders:o,...l}=this.state,{isFetchingEntityHeaders:d,...i}=a,h=!ee(this.props,t),b=!ee(l,i),f=h||b;return f&&this.disableResize(),f}componentDidUpdate(t,a){ee(t.queryContext.data,this.props.queryContext.data)?t.queryContext.entity&&this.props.queryContext.entity&&!ee(U(t.queryContext.entity),U(this.props.queryContext.entity))&&this.getEntityHeadersInData(!0):this.getEntityHeadersInData(!1),this.enableResize()}enableResize(){this.resizer?setTimeout(()=>{this.resizer.reset(tt)},1e3):this.tableElement&&this.getLengthOfPropsData()>1&&(this.resizer=new Zn(this.tableElement,tt))}disableResize(){this.resizer&&this.resizer.reset({disable:!0})}async getEntityHeadersInData(t){var c,g,I;const{data:a,entity:o}=this.props.queryContext;if(!a||!o)return;if(this.state.isFetchingEntityHeaders&&!t)return;const l=j(this.state.mapEntityIdToHeader),d=j(this.state.mapUserIdToHeader),i=Ze(a,L.ENTITYID),h=Ze(a,L.USERID),b=Je(a,l,i);(this.isEntityViewOrDataset()||o&&nt(o))&&this.allRowsHaveId()&&((I=(g=(c=a.queryResult)==null?void 0:c.queryResults)==null?void 0:g.rows)!=null?I:[]).forEach(m=>{const T=`syn${m.rowId}`;b.add(T)});const f=Je(a,d,h);if(b.size===0&&f.size===0)return;if(this.setState({isFetchingEntityHeaders:!0}),b.size>0){const _=Array.from(b).map(m=>({targetId:m}));try{_.forEach(s=>{l[s.targetId]=co});const m=await kt(_,this.props.synapseContext.accessToken),{results:T}=m;T.forEach(s=>{l[s.id]=s})}catch(m){console.error("Error on retrieving entity header list , ",m)}}const v=[];if(f.size>0){const _=Array.from(f);try{(await Vt(_,this.props.synapseContext.accessToken)).children.forEach(T=>{T.isIndividual?v.push(T.ownerId):d[T.ownerId]=T})}catch(m){console.error("Error on getGroupHeaders batch: ",m)}}if(v.length>0)try{(await Zt(v)).list.forEach(m=>{d[m.ownerId]=m})}catch(_){console.error("Error on getUserProfile : ",_)}this.setState({mapEntityIdToHeader:l,mapUserIdToHeader:d,isFetchingEntityHeaders:!1})}render(){var m,T;if(!this.props.queryContext.data&&this.props.queryContext.isLoadingNewBundle)return nn;if(!this.props.queryContext.data)return n(k,{});const{queryContext:{data:t},showNoContentAvailableWhenEmpty:a}=this.props,{queryResult:o,columnModels:l=[]}=t,{facets:d=[]}=t,{isExpanded:i,isExportTableDownloadOpen:h}=this.state,b=this.props.queryContext.getLastQueryRequest();let f="";if(!(((T=(m=t.queryResult)==null?void 0:m.queryResults.rows.length)!=null?T:0)>0)&&b.query.offset===0)return b.query.additionalFilters?n(cn,{}):a?n(un,{}):R("div",{className:"text-center SRCBorderedPanel SRCBorderedPanel--padded2x",children:[Kt,n("div",{style:{marginTop:"20px",fontStyle:"italic"},children:"This table is currently empty"})]});const{rows:c,headers:g}=o.queryResults,I=n("div",{children:this.renderTable(g,l,d,c)}),_=n(k,{children:R("div",{className:f,children:[h&&n(G,{onClose:()=>{this.setState({isExportTableDownloadOpen:!1})},queryBundleRequest:b}),n("div",{children:I})]})});return R(et.Fragment,{children:[i&&R(Q,{animation:!1,show:!0,onHide:()=>this.setState({isExpanded:!1}),dialogClassName:"modal-90w",backdrop:"static",children:[n(Q.Header,{onHide:()=>this.setState({isExpanded:!1}),closeButton:!0}),n(Q.Body,{children:_})]}),!i&&_]})}allRowsHaveId(){var a,o;const{queryContext:{data:t}}=this.props;return(o=(a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults.rows.every(l=>!!l.rowId))!=null?o:!1}isEntityViewOrDataset(){var a;const{queryContext:{entity:t}}=this.props;return(a=t&&(U(t)||W(t)))!=null?a:!1}createTableRows(t,a,o,l,d,i){const h=[],{queryContext:{data:b},queryVisualizationContext:{columnsToShowInTable:f,selectedRowIndices:v,setSelectedRowIndices:c},columnLinks:g=[],linkCountToDisaggregatedQuery:I=!1}=this.props,{selectColumns:_=[],columnModels:m=[]}=b,{mapEntityIdToHeader:T,mapUserIdToHeader:s}=this.state,q=ro(this.props.queryContext.getLastQueryRequest().query.sql);return t.forEach((r,e)=>{var E,x,A;const u=(E=r.versionNumber)==null?void 0:E.toString(),y=`syn${r.rowId}`,S=r.values.map((N,D)=>{const F=a[D].name,Z=f.includes(F),J=g.find(V=>V.matchColumnName===F),we=this.findSelectionIndex(this.state.sortedColumnSelection,F),Te=q.includes(D)&&I,O=we===-1?"":"SRC-boldText";return Z?n("td",{className:"SRC_noBorderTop SRC-synapseTableTd",children:Te?n("a",{href:this.showGroupRowData(r),target:"_blank",rel:"noopener noreferrer",children:n("p",{className:O,children:N})}):n(ue,{columnType:a[D].columnType,columnValue:N,isBold:O,mapEntityIdToHeader:T,mapUserIdToHeader:s,rowIndex:e,columnLinkConfig:J,columnName:F,rowData:r.values,selectColumns:_,columnModels:m,rowId:r.rowId,rowVersionNumber:r.versionNumber})},`(${e}${N}${D})`):n("td",{className:"SRC-hidden"},`(${e},${D})`)});o&&S.unshift(n("td",{className:"SRC_noBorderTop",children:n(en,{entityId:y,entityVersionNumber:u},y)},y));const w=((x=T[y])==null?void 0:x.type)=="org.sagebionetworks.repo.model.FileEntity";l&&S.unshift(n("td",{className:"SRC_noBorderTop direct-download",children:w&&n(at,{associatedObjectId:y,entityVersionNumber:u})},`direct-download-${y}`)),d&&S.unshift(n("td",{className:"SRC_noBorderTop add-to-download-list-v2",children:w&&n(ie,{entityId:y,entityVersionNumber:parseInt(u)})},`add-to-download-list-v2-${y}`)),i&&v&&S.unshift(n("td",{className:"SRC_noBorderTop",children:n(mn,{label:"",checked:v.includes(e),onChange:N=>{const D=[...v];if(N)D.push(e);else{const F=D.indexOf(e);F>-1&&D.splice(F,1)}c(D)}})},`(${e},rowSelectColumn)`));const C=n("tr",{children:S},(A=r.rowId)!=null?A:e);h.push(C)}),h}isSortableColumn(t){switch(t){case L.USERID:case L.ENTITYID:case L.FILEHANDLEID:case L.STRING_LIST:case L.INTEGER_LIST:case L.BOOLEAN_LIST:case L.DATE_LIST:case L.USERID_LIST:case L.ENTITYID_LIST:return!1;default:return!0}}createTableHeader(t,a,o,l,d,i,h,b){const{sortedColumnSelection:f,columnIconSortState:v}=this.state,{queryVisualizationContext:{facetAliases:c={},columnsToShowInTable:g},queryContext:{lockedColumn:I}}=this.props,_=t.map((m,T)=>{var q;if(g.includes(m.name)){const r=this.findSelectionIndex(f,m.name)!==-1,e=v[T]===void 0?0:v[T],u=o.findIndex(F=>F.columnName===m.name),y=u!==-1&&o[u].facetType==="enumeration",S=o[u],w=r?"SRC-primary-background-color SRC-anchor-light":"",C=r?"SRC-selected-table-icon tool-icon":"SRC-primary-text-color tool-icon",E=`SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover  ${w}`,x=$e(m.name,c),A=a.find(F=>F.name===m.name),N=m.name.toLowerCase()===((q=I==null?void 0:I.columnName)==null?void 0:q.toLowerCase()),D=A&&A.name=="id"&&A.columnType==L.ENTITYID;return n("th",{children:R("div",{className:"SRC-split",children:[n("span",{style:{whiteSpace:"nowrap"},children:x}),R("div",{className:"SRC-centerContent",children:[y&&!N&&this.configureFacetDropdown(S,A,b,c),this.isSortableColumn(m.columnType)&&n("span",{role:"button","aria-label":"sort",tabIndex:0,className:E,onKeyPress:this.handleColumnSortPress({index:T,name:m.name}),onClick:this.handleColumnSortPress({index:T,name:m.name}),children:n(ot,{type:He[e],cssClass:C})}),D&&n(lo,{})]})]})},m.name)}else return n("th",{className:"SRC-hidden"},m.name)});return l&&_.unshift(n("th",{children:n("div",{className:"SRC-centerContent",children:n("span",{style:{whiteSpace:"nowrap"},children:"Access"})})},"accessColumn")),d&&_.unshift(n("th",{children:n("div",{className:"SRC-centerContent",children:"\xA0"})},"downloadColumn")),i&&_.unshift(n("th",{"data-testid":"AddToDownloadListV2ColumnHeader",children:n("div",{className:"SRC-centerContent",children:"\xA0"})},"addToV2DownloadListColumn")),h&&_.unshift(n("th",{children:n("div",{className:"SRC-centerContent"})},"rowSelectionColumn")),_}findSelectionIndex(t,a){return t.length!==0?t.findIndex(o=>o.column===a):-1}advancedSearch(t){t&&t.preventDefault();const a=this.props.queryContext.getLastQueryRequest(),{query:o}=a,l=btoa(JSON.stringify(o)),d=a.entityId;window.open(`${Oe.PORTAL}#!Synapse:${d}/tables/query/${l}`,"_blank")}getLengthOfPropsData(){var a,o;const{data:t}=this.props.queryContext;return(o=(a=t==null?void 0:t.queryResult)==null?void 0:a.queryResults.headers.length)!=null?o:0}configureFacetDropdown(t,a,o,l){return n(ft,{containerAs:"Dropdown",facetValues:t.facetValues,columnModel:a,facetAliases:l,onChange:d=>{yt(o,t,this.applyChangesFromQueryFilter,d)},onClear:()=>{gt(o,t,this.applyChangesFromQueryFilter)}})}}try{De.displayName="SynapseTable",De.__docgenInfo={description:"",displayName:"SynapseTable",props:{synapseContext:{defaultValue:null,description:"",name:"synapseContext",required:!0,type:{name:"SynapseContextType"}},queryContext:{defaultValue:null,description:"",name:"queryContext",required:!0,type:{name:"QueryContextType"}},queryVisualizationContext:{defaultValue:null,description:"",name:"queryVisualizationContext",required:!0,type:{name:"QueryVisualizationContextType"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},showAccessColumn:{defaultValue:null,description:"",name:"showAccessColumn",required:!1,type:{name:"boolean"}},showDownloadColumn:{defaultValue:null,description:"",name:"showDownloadColumn",required:!1,type:{name:"boolean"}},columnLinks:{defaultValue:null,description:"",name:"columnLinks",required:!1,type:{name:"LabelLinkConfig"}},hideDownload:{defaultValue:null,description:"",name:"hideDownload",required:!1,type:{name:"boolean"}},isRowSelectionVisible:{defaultValue:null,description:"",name:"isRowSelectionVisible",required:!1,type:{name:"boolean"}},linkCountToDisaggregatedQuery:{defaultValue:null,description:`If true, columns created by the COUNT function will render with a link to Synapse that opens the disaggregated query results filtered by the conditions of that row.
Note that this is very brittle and only supports one column at a time. See SWC-6075 for more information. Default false.`,name:"linkCountToDisaggregatedQuery",required:!1,type:{name:"boolean"}},showNoContentAvailableWhenEmpty:{defaultValue:null,description:"",name:"showNoContentAvailableWhenEmpty",required:!1,type:{name:"boolean"}}}},typeof STORYBOOK_REACT_CLASSES<"u"&&(STORYBOOK_REACT_CLASSES["src/lib/containers/table/SynapseTable.tsx#SynapseTable"]={docgenInfo:De.__docgenInfo,name:"SynapseTable",path:"src/lib/containers/table/SynapseTable.tsx#SynapseTable"})}catch{}function ta(){const{data:p}=H(),{showLastUpdatedOn:t}=ye();return t&&p&&p.lastUpdatedOn?n("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end"},children:R(Ce,{variant:"body2",children:["Last updated on ",Sn(gn(p.lastUpdatedOn))]})}):n(k,{})}export{Re as F,ta as L,G as M,De as S,qe as T,Le as a,xe as b};
